/*! For license information please see 2.7d577553.chunk.js.LICENSE.txt */
(this.webpackJsonpfox=this.webpackJsonpfox||[]).push([[2],[function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",(function(){return i}))},function(t,e,n){"use strict";function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function r(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}n.d(e,"a",(function(){return r}))},function(t,e,n){"use strict";function i(t,e){return i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},i(t,e)}function r(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&i(t,e)}n.d(e,"a",(function(){return r}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var i=n(7);var r=n(17);function a(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,a=Object(i.a)(t);if(e){var o=Object(i.a)(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return Object(r.a)(this,n)}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var i=n(12);function r(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=Object(i.a)(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,a=function(){};return{s:a,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,l=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return s=t.done,t},e:function(t){l=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(l)throw o}}}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return b})),n.d(e,"b",(function(){return w})),n.d(e,"c",(function(){return k})),n.d(e,"d",(function(){return x})),n.d(e,"e",(function(){return S})),n.d(e,"f",(function(){return C})),n.d(e,"g",(function(){return O})),n.d(e,"h",(function(){return E})),n.d(e,"i",(function(){return A})),n.d(e,"j",(function(){return P})),n.d(e,"k",(function(){return j})),n.d(e,"l",(function(){return T})),n.d(e,"m",(function(){return R})),n.d(e,"n",(function(){return D})),n.d(e,"o",(function(){return M})),n.d(e,"p",(function(){return L})),n.d(e,"q",(function(){return B}));var i=n(17);var r=n(12);function a(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t)){var n=[],i=!0,r=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(i=(o=s.next()).done)&&(n.push(o.value),!e||n.length!==e);i=!0);}catch(l){r=!0,a=l}finally{try{i||null==s.return||s.return()}finally{if(r)throw a}}return n}}(t,e)||Object(r.a)(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var o=n(11),s=n(8),l=n(7),u=n(9),c=n.n(u),h=n(13);function d(t){return function(t){if(Array.isArray(t))return Object(h.a)(t)}(t)||function(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||Object(r.a)(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var f=n(4),p=n(2),v=n(3),g=n(0),y=n(1),m={4662:function(t,e,n){n(3430);var i=n(8791);t.exports=i("Array","sort")},8343:function(t,e,n){n(4769);var i=n(9276);t.exports=i.Object.keys},7111:function(t,e,n){var i=n(6733),r=n(9821);t.exports=function(t){if(i(t))return t;throw TypeError(r(t)+" is not a function")}},1176:function(t,e,n){var i=n(5052);t.exports=function(t){if(i(t))return t;throw TypeError(String(t)+" is not an object")}},9540:function(t,e,n){var i=n(905),r=n(4237),a=n(3231),o=function(t){return function(e,n,o){var s,l=i(e),u=r(l.length),c=a(o,u);if(t&&n!=n){for(;u>c;)if((s=l[c++])!=s)return!0}else for(;u>c;c++)if((t||c in l)&&l[c]===n)return t||c||0;return!t&&-1}};t.exports={includes:o(!0),indexOf:o(!1)}},6038:function(t,e,n){var i=n(4229);t.exports=function(t,e){var n=[][t];return!!n&&i((function(){n.call(null,e||function(){throw 1},1)}))}},3867:function(t){var e=Math.floor,n=function(t,e){for(var n,i,r=t.length,a=1;a<r;){for(i=a,n=t[a];i&&e(t[i-1],n)>0;)t[i]=t[--i];i!==a++&&(t[i]=n)}return t},i=function(t,e,n){for(var i=t.length,r=e.length,a=0,o=0,s=[];a<i||o<r;)a<i&&o<r?s.push(n(t[a],e[o])<=0?t[a++]:e[o++]):s.push(a<i?t[a++]:e[o++]);return s};t.exports=function t(r,a){var o=r.length,s=e(o/2);return o<8?n(r,a):i(t(r.slice(0,s),a),t(r.slice(s),a),a)}},7079:function(t){var e={}.toString;t.exports=function(t){return e.call(t).slice(8,-1)}},1589:function(t,e,n){var i=n(1601),r=n(6733),a=n(7079),o=n(95)("toStringTag"),s="Arguments"==a(function(){return arguments}());t.exports=i?a:function(t){var e,n,i;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(n){}}(e=Object(t),o))?n:s?a(e):"Object"==(i=a(e))&&r(e.callee)?"Arguments":i}},7081:function(t,e,n){var i=n(816),r=n(4826),a=n(7933),o=n(1787);t.exports=function(t,e){for(var n=r(e),s=o.f,l=a.f,u=0;u<n.length;u++){var c=n[u];i(t,c)||s(t,c,l(e,c))}}},5762:function(t,e,n){var i=n(7400),r=n(1787),a=n(5358);t.exports=i?function(t,e,n){return r.f(t,e,a(1,n))}:function(t,e,n){return t[e]=n,t}},5358:function(t){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},7400:function(t,e,n){var i=n(4229);t.exports=!i((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},2635:function(t,e,n){var i=n(9859),r=n(5052),a=i.document,o=r(a)&&r(a.createElement);t.exports=function(t){return o?a.createElement(t):{}}},2671:function(t,e,n){var i=n(598).match(/firefox\/(\d+)/i);t.exports=!!i&&+i[1]},8506:function(t,e,n){var i=n(598);t.exports=/MSIE|Trident/.test(i)},598:function(t,e,n){var i=n(1333);t.exports=i("navigator","userAgent")||""},6358:function(t,e,n){var i,r,a=n(9859),o=n(598),s=a.process,l=a.Deno,u=s&&s.versions||l&&l.version,c=u&&u.v8;c?r=(i=c.split("."))[0]<4?1:i[0]+i[1]:o&&(!(i=o.match(/Edge\/(\d+)/))||i[1]>=74)&&(i=o.match(/Chrome\/(\d+)/))&&(r=i[1]),t.exports=r&&+r},9811:function(t,e,n){var i=n(598).match(/AppleWebKit\/(\d+)\./);t.exports=!!i&&+i[1]},8791:function(t,e,n){var i=n(9859),r=n(7636),a=Function.call;t.exports=function(t,e,n){return r(a,i[t].prototype[e],n)}},3837:function(t){t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},3103:function(t,e,n){var i=n(9859),r=n(7933).f,a=n(5762),o=n(7487),s=n(2079),l=n(7081),u=n(6541);t.exports=function(t,e){var n,c,h,d,f,p=t.target,v=t.global,g=t.stat;if(n=v?i:g?i[p]||s(p,{}):(i[p]||{}).prototype)for(c in e){if(d=e[c],h=t.noTargetGet?(f=r(n,c))&&f.value:n[c],!u(v?c:p+(g?".":"#")+c,t.forced)&&void 0!==h){if(typeof d===typeof h)continue;l(d,h)}(t.sham||h&&h.sham)&&a(d,"sham",!0),o(n,c,d,t)}}},4229:function(t){t.exports=function(t){try{return!!t()}catch(e){return!0}}},7636:function(t,e,n){var i=n(7111);t.exports=function(t,e,n){if(i(t),void 0===e)return t;switch(n){case 0:return function(){return t.call(e)};case 1:return function(n){return t.call(e,n)};case 2:return function(n,i){return t.call(e,n,i)};case 3:return function(n,i,r){return t.call(e,n,i,r)}}return function(){return t.apply(e,arguments)}}},1805:function(t,e,n){var i=n(7400),r=n(816),a=Function.prototype,o=i&&Object.getOwnPropertyDescriptor,s=r(a,"name"),l=s&&"something"===function(){}.name,u=s&&(!i||i&&o(a,"name").configurable);t.exports={EXISTS:s,PROPER:l,CONFIGURABLE:u}},1333:function(t,e,n){var i=n(9859),r=n(6733),a=function(t){return r(t)?t:void 0};t.exports=function(t,e){return arguments.length<2?a(i[t]):i[t]&&i[t][e]}},5300:function(t,e,n){var i=n(7111);t.exports=function(t,e){var n=t[e];return null==n?void 0:i(n)}},9859:function(t,e,n){var i=function(t){return t&&t.Math==Math&&t};t.exports=i("object"==typeof globalThis&&globalThis)||i("object"==typeof window&&window)||i("object"==typeof self&&self)||i("object"==typeof n.g&&n.g)||function(){return this}()||Function("return this")()},816:function(t,e,n){var i=n(2991),r={}.hasOwnProperty;t.exports=Object.hasOwn||function(t,e){return r.call(i(t),e)}},5977:function(t){t.exports={}},4394:function(t,e,n){var i=n(7400),r=n(4229),a=n(2635);t.exports=!i&&!r((function(){return 7!=Object.defineProperty(a("div"),"a",{get:function(){return 7}}).a}))},9337:function(t,e,n){var i=n(4229),r=n(7079),a="".split;t.exports=i((function(){return!Object("z").propertyIsEnumerable(0)}))?function(t){return"String"==r(t)?a.call(t,""):Object(t)}:Object},8511:function(t,e,n){var i=n(6733),r=n(5353),a=Function.toString;i(r.inspectSource)||(r.inspectSource=function(t){return a.call(t)}),t.exports=r.inspectSource},6407:function(t,e,n){var i,r,a,o=n(8694),s=n(9859),l=n(5052),u=n(5762),c=n(816),h=n(5353),d=n(4399),f=n(5977),p="Object already initialized",v=s.WeakMap;if(o||h.state){var g=h.state||(h.state=new v),y=g.get,m=g.has,_=g.set;i=function(t,e){if(m.call(g,t))throw new TypeError(p);return e.facade=t,_.call(g,t,e),e},r=function(t){return y.call(g,t)||{}},a=function(t){return m.call(g,t)}}else{var b=d("state");f[b]=!0,i=function(t,e){if(c(t,b))throw new TypeError(p);return e.facade=t,u(t,b,e),e},r=function(t){return c(t,b)?t[b]:{}},a=function(t){return c(t,b)}}t.exports={set:i,get:r,has:a,enforce:function(t){return a(t)?r(t):i(t,{})},getterFor:function(t){return function(e){var n;if(!l(e)||(n=r(e)).type!==t)throw TypeError("Incompatible receiver, "+t+" required");return n}}}},6733:function(t){t.exports=function(t){return"function"===typeof t}},6541:function(t,e,n){var i=n(4229),r=n(6733),a=/#|\.prototype\./,o=function(t,e){var n=l[s(t)];return n==c||n!=u&&(r(e)?i(e):!!e)},s=o.normalize=function(t){return String(t).replace(a,".").toLowerCase()},l=o.data={},u=o.NATIVE="N",c=o.POLYFILL="P";t.exports=o},5052:function(t,e,n){var i=n(6733);t.exports=function(t){return"object"===typeof t?null!==t:i(t)}},4231:function(t){t.exports=!1},9395:function(t,e,n){var i=n(6733),r=n(1333),a=n(6969);t.exports=a?function(t){return"symbol"==typeof t}:function(t){var e=r("Symbol");return i(e)&&Object(t)instanceof e}},3839:function(t,e,n){var i=n(6358),r=n(4229);t.exports=!!Object.getOwnPropertySymbols&&!r((function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&i&&i<41}))},8694:function(t,e,n){var i=n(9859),r=n(6733),a=n(8511),o=i.WeakMap;t.exports=r(o)&&/native code/.test(a(o))},1787:function(t,e,n){var i=n(7400),r=n(4394),a=n(1176),o=n(9310),s=Object.defineProperty;e.f=i?s:function(t,e,n){if(a(t),e=o(e),a(n),r)try{return s(t,e,n)}catch(i){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(t[e]=n.value),t}},7933:function(t,e,n){var i=n(7400),r=n(9195),a=n(5358),o=n(905),s=n(9310),l=n(816),u=n(4394),c=Object.getOwnPropertyDescriptor;e.f=i?c:function(t,e){if(t=o(t),e=s(e),u)try{return c(t,e)}catch(n){}if(l(t,e))return a(!r.f.call(t,e),t[e])}},8151:function(t,e,n){var i=n(140),r=n(3837).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return i(t,r)}},894:function(t,e){e.f=Object.getOwnPropertySymbols},140:function(t,e,n){var i=n(816),r=n(905),a=n(9540).indexOf,o=n(5977);t.exports=function(t,e){var n,s=r(t),l=0,u=[];for(n in s)!i(o,n)&&i(s,n)&&u.push(n);for(;e.length>l;)i(s,n=e[l++])&&(~a(u,n)||u.push(n));return u}},5632:function(t,e,n){var i=n(140),r=n(3837);t.exports=Object.keys||function(t){return i(t,r)}},9195:function(t,e){var n={}.propertyIsEnumerable,i=Object.getOwnPropertyDescriptor,r=i&&!n.call({1:2},1);e.f=r?function(t){var e=i(this,t);return!!e&&e.enumerable}:n},2914:function(t,e,n){var i=n(6733),r=n(5052);t.exports=function(t,e){var n,a;if("string"===e&&i(n=t.toString)&&!r(a=n.call(t)))return a;if(i(n=t.valueOf)&&!r(a=n.call(t)))return a;if("string"!==e&&i(n=t.toString)&&!r(a=n.call(t)))return a;throw TypeError("Can't convert object to primitive value")}},4826:function(t,e,n){var i=n(1333),r=n(8151),a=n(894),o=n(1176);t.exports=i("Reflect","ownKeys")||function(t){var e=r.f(o(t)),n=a.f;return n?e.concat(n(t)):e}},9276:function(t,e,n){var i=n(9859);t.exports=i},7487:function(t,e,n){var i=n(9859),r=n(6733),a=n(816),o=n(5762),s=n(2079),l=n(8511),u=n(6407),c=n(1805).CONFIGURABLE,h=u.get,d=u.enforce,f=String(String).split("String");(t.exports=function(t,e,n,l){var u,h=!!l&&!!l.unsafe,p=!!l&&!!l.enumerable,v=!!l&&!!l.noTargetGet,g=l&&void 0!==l.name?l.name:e;r(n)&&("Symbol("===String(g).slice(0,7)&&(g="["+String(g).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),(!a(n,"name")||c&&n.name!==g)&&o(n,"name",g),(u=d(n)).source||(u.source=f.join("string"==typeof g?g:""))),t!==i?(h?!v&&t[e]&&(p=!0):delete t[e],p?t[e]=n:o(t,e,n)):p?t[e]=n:s(e,n)})(Function.prototype,"toString",(function(){return r(this)&&h(this).source||l(this)}))},8885:function(t){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on "+t);return t}},2079:function(t,e,n){var i=n(9859);t.exports=function(t,e){try{Object.defineProperty(i,t,{value:e,configurable:!0,writable:!0})}catch(n){i[t]=e}return e}},4399:function(t,e,n){var i=n(3036),r=n(1441),a=i("keys");t.exports=function(t){return a[t]||(a[t]=r(t))}},5353:function(t,e,n){var i=n(9859),r=n(2079),a="__core-js_shared__",o=i[a]||r(a,{});t.exports=o},3036:function(t,e,n){var i=n(4231),r=n(5353);(t.exports=function(t,e){return r[t]||(r[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.18.1",mode:i?"pure":"global",copyright:"\xa9 2021 Denis Pushkarev (zloirock.ru)"})},3231:function(t,e,n){var i=n(6051),r=Math.max,a=Math.min;t.exports=function(t,e){var n=i(t);return n<0?r(n+e,0):a(n,e)}},905:function(t,e,n){var i=n(9337),r=n(8885);t.exports=function(t){return i(r(t))}},6051:function(t){var e=Math.ceil,n=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?n:e)(t)}},4237:function(t,e,n){var i=n(6051),r=Math.min;t.exports=function(t){return t>0?r(i(t),9007199254740991):0}},2991:function(t,e,n){var i=n(8885);t.exports=function(t){return Object(i(t))}},2066:function(t,e,n){var i=n(5052),r=n(9395),a=n(5300),o=n(2914),s=n(95)("toPrimitive");t.exports=function(t,e){if(!i(t)||r(t))return t;var n,l=a(t,s);if(l){if(void 0===e&&(e="default"),n=l.call(t,e),!i(n)||r(n))return n;throw TypeError("Can't convert object to primitive value")}return void 0===e&&(e="number"),o(t,e)}},9310:function(t,e,n){var i=n(2066),r=n(9395);t.exports=function(t){var e=i(t,"string");return r(e)?e:String(e)}},1601:function(t,e,n){var i={};i[n(95)("toStringTag")]="z",t.exports="[object z]"===String(i)},3326:function(t,e,n){var i=n(1589);t.exports=function(t){if("Symbol"===i(t))throw TypeError("Cannot convert a Symbol value to a string");return String(t)}},9821:function(t){t.exports=function(t){try{return String(t)}catch(e){return"Object"}}},1441:function(t){var e=0,n=Math.random();t.exports=function(t){return"Symbol("+String(void 0===t?"":t)+")_"+(++e+n).toString(36)}},6969:function(t,e,n){var i=n(3839);t.exports=i&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},95:function(t,e,n){var i=n(9859),r=n(3036),a=n(816),o=n(1441),s=n(3839),l=n(6969),u=r("wks"),c=i.Symbol,h=l?c:c&&c.withoutSetter||o;t.exports=function(t){return a(u,t)&&(s||"string"==typeof u[t])||(s&&a(c,t)?u[t]=c[t]:u[t]=h("Symbol."+t)),u[t]}},3430:function(t,e,n){var i=n(3103),r=n(7111),a=n(2991),o=n(4237),s=n(3326),l=n(4229),u=n(3867),c=n(6038),h=n(2671),d=n(8506),f=n(6358),p=n(9811),v=[],g=v.sort,y=l((function(){v.sort(void 0)})),m=l((function(){v.sort(null)})),_=c("sort"),b=!l((function(){if(f)return f<70;if(!(h&&h>3)){if(d)return!0;if(p)return p<603;var t,e,n,i,r="";for(t=65;t<76;t++){switch(e=String.fromCharCode(t),t){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(i=0;i<47;i++)v.push({k:e+i,v:n})}for(v.sort((function(t,e){return e.v-t.v})),i=0;i<v.length;i++)e=v[i].k.charAt(0),r.charAt(r.length-1)!==e&&(r+=e);return"DGBEFHACIJK"!==r}}));i({target:"Array",proto:!0,forced:y||!m||!_||!b},{sort:function(t){void 0!==t&&r(t);var e=a(this);if(b)return void 0===t?g.call(e):g.call(e,t);var n,i,l=[],c=o(e.length);for(i=0;i<c;i++)i in e&&l.push(e[i]);for(l=u(l,function(t){return function(e,n){return void 0===n?-1:void 0===e?1:void 0!==t?+t(e,n)||0:s(e)>s(n)?1:-1}}(t)),n=l.length,i=0;i<n;)e[i]=l[i++];for(;i<c;)delete e[i++];return e}})},4769:function(t,e,n){var i=n(3103),r=n(2991),a=n(5632);i({target:"Object",stat:!0,forced:n(4229)((function(){a(1)}))},{keys:function(t){return a(r(t))}})},1388:function(t,e,n){n.d(e,{Z:function(){return s}});var i=n(272),r=n.n(i),a=n(2609),o=n.n(a)()(r());o.push([t.id,"/* Buttons styles start */\r\n\r\nbutton#excalibur-play {\r\n  display: inline-block;\r\n  position: relative;\r\n  z-index: 999;\r\n  border-radius: 6px;\r\n  border: none;\r\n  /*border: 3px solid;\r\n    border-color: white;\r\n    box-shadow: 0 0 10px #ccc;*/\r\n  padding: 1rem 1.5rem 1rem 4rem;\r\n  margin: 0;\r\n  text-decoration: none;\r\n  background: #00b233;\r\n  color: #ffffff;\r\n  font-family: sans-serif;\r\n  font-size: 2rem;\r\n  white-space: nowrap;\r\n  line-height: 1;\r\n  cursor: pointer;\r\n  text-align: center;\r\n  transition: background 250ms ease-in-out, transform 150ms ease;\r\n  -webkit-appearance: none;\r\n  -moz-appearance: none;\r\n\r\n  -webkit-animation: excalibur-button-fadein 200ms; /* Safari, Chrome and Opera > 12.1 */\r\n  -moz-animation: excalibur-button-fadein 200ms; /* Firefox < 16 */\r\n  -ms-animation: excalibur-button-fadein 200ms; /* Internet Explorer */\r\n  -o-animation: excalibur-button-fadein 200ms; /* Opera < 12.1 */\r\n  animation: excalibur-button-fadein 200ms;\r\n}\r\n\r\n/*\r\nbutton#excalibur-play {\r\n  display: none;\r\n}*/\r\n\r\nbutton#excalibur-play:after {\r\n  position: absolute;\r\n  content: '';\r\n  border: 8px solid;\r\n  border-color: transparent transparent transparent white;\r\n  left: 35px;\r\n  top: 24px;\r\n  width: 0;\r\n  height: 0;\r\n}\r\n\r\nbutton#excalibur-play:before {\r\n  position: absolute;\r\n  content: '';\r\n  border: 3px solid;\r\n  left: 19px;\r\n  top: 14px;\r\n  border-radius: 20px;\r\n  width: 30px;\r\n  height: 30px;\r\n}\r\n\r\nbutton#excalibur-play:hover,\r\nbutton#excalibur-play:focus {\r\n  background: #00982c;\r\n}\r\n\r\nbutton#excalibur-play:focus {\r\n  outline: 1px solid #fff;\r\n  outline-offset: -4px;\r\n}\r\n\r\nbutton#excalibur-play:active {\r\n  transform: scale(0.99);\r\n}\r\n\r\n@keyframes excalibur-button-fadein {\r\n  from {\r\n    opacity: 0;\r\n  }\r\n  to {\r\n    opacity: 1;\r\n  }\r\n}\r\n\r\n/* Firefox < 16 */\r\n@-moz-keyframes excalibur-button-fadein {\r\n  from {\r\n    opacity: 0;\r\n  }\r\n  to {\r\n    opacity: 1;\r\n  }\r\n}\r\n\r\n/* Safari, Chrome and Opera > 12.1 */\r\n@-webkit-keyframes excalibur-button-fadein {\r\n  from {\r\n    opacity: 0;\r\n  }\r\n  to {\r\n    opacity: 1;\r\n  }\r\n}\r\n\r\n/* Internet Explorer */\r\n@-ms-keyframes excalibur-button-fadein {\r\n  from {\r\n    opacity: 0;\r\n  }\r\n  to {\r\n    opacity: 1;\r\n  }\r\n}\r\n\r\n/* Opera < 12.1 */\r\n@-o-keyframes excalibur-button-fadein {\r\n  from {\r\n    opacity: 0;\r\n  }\r\n  to {\r\n    opacity: 1;\r\n  }\r\n}\r\n","",{version:3,sources:["webpack://./Loader.css"],names:[],mappings:"AAAA,yBAAyB;;AAEzB;EACE,qBAAqB;EACrB,kBAAkB;EAClB,YAAY;EACZ,kBAAkB;EAClB,YAAY;EACZ;;+BAE6B;EAC7B,8BAA8B;EAC9B,SAAS;EACT,qBAAqB;EACrB,mBAAmB;EACnB,cAAc;EACd,uBAAuB;EACvB,eAAe;EACf,mBAAmB;EACnB,cAAc;EACd,eAAe;EACf,kBAAkB;EAClB,8DAA8D;EAC9D,wBAAwB;EACxB,qBAAqB;;EAErB,gDAAgD,EAAE,oCAAoC;EACtF,6CAA6C,EAAE,iBAAiB;EAChE,4CAA4C,EAAE,sBAAsB;EACpE,2CAA2C,EAAE,iBAAiB;EAC9D,wCAAwC;AAC1C;;AAEA;;;EAGE;;AAEF;EACE,kBAAkB;EAClB,WAAW;EACX,iBAAiB;EACjB,uDAAuD;EACvD,UAAU;EACV,SAAS;EACT,QAAQ;EACR,SAAS;AACX;;AAEA;EACE,kBAAkB;EAClB,WAAW;EACX,iBAAiB;EACjB,UAAU;EACV,SAAS;EACT,mBAAmB;EACnB,WAAW;EACX,YAAY;AACd;;AAEA;;EAEE,mBAAmB;AACrB;;AAEA;EACE,uBAAuB;EACvB,oBAAoB;AACtB;;AAEA;EACE,sBAAsB;AACxB;;AAEA;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF;;AAEA,iBAAiB;AACjB;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF;;AAEA,oCAAoC;AACpC;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF;;AAEA,sBAAsB;AACtB;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF;;AAEA,iBAAiB;AACjB;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF",sourcesContent:["/* Buttons styles start */\r\n\r\nbutton#excalibur-play {\r\n  display: inline-block;\r\n  position: relative;\r\n  z-index: 999;\r\n  border-radius: 6px;\r\n  border: none;\r\n  /*border: 3px solid;\r\n    border-color: white;\r\n    box-shadow: 0 0 10px #ccc;*/\r\n  padding: 1rem 1.5rem 1rem 4rem;\r\n  margin: 0;\r\n  text-decoration: none;\r\n  background: #00b233;\r\n  color: #ffffff;\r\n  font-family: sans-serif;\r\n  font-size: 2rem;\r\n  white-space: nowrap;\r\n  line-height: 1;\r\n  cursor: pointer;\r\n  text-align: center;\r\n  transition: background 250ms ease-in-out, transform 150ms ease;\r\n  -webkit-appearance: none;\r\n  -moz-appearance: none;\r\n\r\n  -webkit-animation: excalibur-button-fadein 200ms; /* Safari, Chrome and Opera > 12.1 */\r\n  -moz-animation: excalibur-button-fadein 200ms; /* Firefox < 16 */\r\n  -ms-animation: excalibur-button-fadein 200ms; /* Internet Explorer */\r\n  -o-animation: excalibur-button-fadein 200ms; /* Opera < 12.1 */\r\n  animation: excalibur-button-fadein 200ms;\r\n}\r\n\r\n/*\r\nbutton#excalibur-play {\r\n  display: none;\r\n}*/\r\n\r\nbutton#excalibur-play:after {\r\n  position: absolute;\r\n  content: '';\r\n  border: 8px solid;\r\n  border-color: transparent transparent transparent white;\r\n  left: 35px;\r\n  top: 24px;\r\n  width: 0;\r\n  height: 0;\r\n}\r\n\r\nbutton#excalibur-play:before {\r\n  position: absolute;\r\n  content: '';\r\n  border: 3px solid;\r\n  left: 19px;\r\n  top: 14px;\r\n  border-radius: 20px;\r\n  width: 30px;\r\n  height: 30px;\r\n}\r\n\r\nbutton#excalibur-play:hover,\r\nbutton#excalibur-play:focus {\r\n  background: #00982c;\r\n}\r\n\r\nbutton#excalibur-play:focus {\r\n  outline: 1px solid #fff;\r\n  outline-offset: -4px;\r\n}\r\n\r\nbutton#excalibur-play:active {\r\n  transform: scale(0.99);\r\n}\r\n\r\n@keyframes excalibur-button-fadein {\r\n  from {\r\n    opacity: 0;\r\n  }\r\n  to {\r\n    opacity: 1;\r\n  }\r\n}\r\n\r\n/* Firefox < 16 */\r\n@-moz-keyframes excalibur-button-fadein {\r\n  from {\r\n    opacity: 0;\r\n  }\r\n  to {\r\n    opacity: 1;\r\n  }\r\n}\r\n\r\n/* Safari, Chrome and Opera > 12.1 */\r\n@-webkit-keyframes excalibur-button-fadein {\r\n  from {\r\n    opacity: 0;\r\n  }\r\n  to {\r\n    opacity: 1;\r\n  }\r\n}\r\n\r\n/* Internet Explorer */\r\n@-ms-keyframes excalibur-button-fadein {\r\n  from {\r\n    opacity: 0;\r\n  }\r\n  to {\r\n    opacity: 1;\r\n  }\r\n}\r\n\r\n/* Opera < 12.1 */\r\n@-o-keyframes excalibur-button-fadein {\r\n  from {\r\n    opacity: 0;\r\n  }\r\n  to {\r\n    opacity: 1;\r\n  }\r\n}\r\n"],sourceRoot:""}]);var s=o},2609:function(t){t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n="",i="undefined"!==typeof e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),i&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),i&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n})).join("")},e.i=function(t,n,i,r,a){"string"===typeof t&&(t=[[null,t,void 0]]);var o={};if(i)for(var s=0;s<this.length;s++){var l=this[s][0];null!=l&&(o[l]=!0)}for(var u=0;u<t.length;u++){var c=[].concat(t[u]);i&&o[c[0]]||("undefined"!==typeof a&&("undefined"===typeof c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=a),n&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=n):c[2]=n),r&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=r):c[4]="".concat(r)),e.push(c))}},e}},272:function(t){t.exports=function(t){var e=t[1],n=t[3];if(!n)return e;if("function"===typeof btoa){var i=btoa(unescape(encodeURIComponent(JSON.stringify(n)))),r="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(i),a="/*# ".concat(r," */"),o=n.sources.map((function(t){return"/*# sourceURL=".concat(n.sourceRoot||"").concat(t," */")}));return[e].concat(o).concat([a]).join("\n")}return[e].join("\n")}}},_={};function n(t){var e=_[t];if(void 0!==e)return e.exports;var i=_[t]={id:t,exports:{}};return m[t](i,i.exports,n),i.exports}n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,{a:e}),e},n.d=function(t,e){for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}(),n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};e={};!function(){n.d(e,{fWn:function(){return Hi},Ia8:function(){return Ci},hLI:function(){return Wi},yyv:function(){return Ur},tX5:function(){return ye},vtX:function(){return Gi},r7K:function(){return ci},lCh:function(){return fr},fwF:function(){return Rr},sce:function(){return yr},_c7:function(){return mr},KUs:function(){return Ar},Ajp:function(){return hn},RDh:function(){return Ji},_H9:function(){return Ve},Ulf:function(){return mo},mxs:function(){return Bi},OmD:function(){return oi},kBf:function(){return dt},C4F:function(){return On},NQt:function(){return Ta},JjN:function(){return Ra},V1s:function(){return sr},Xz7:function(){return zt},bLd:function(){return tr},Cdc:function(){return wi},FKn:function(){return $n},wTW:function(){return fn},ab2:function(){return Zn},GfZ:function(){return Yn},YMS:function(){return Xn},oyv:function(){return ai},aUb:function(){return Jn},SdD:function(){return ve},JUv:function(){return In},jEj:function(){return Ga},TFq:function(){return ei},HDU:function(){return fe},R_y:function(){return de},ydN:function(){return Cn},_N2:function(){return Er},t50:function(){return pe},s$$:function(){return Tr},v2G:function(){return _n},Ilk:function(){return ut},H_9:function(){return Xr},s9i:function(){return qr},ksl:function(){return Lr},wA2:function(){return Rn},R_p:function(){return qn},IQ$:function(){return Fe},I5F:function(){return j},X8$:function(){return Pr},FR6:function(){return he},U8o:function(){return ce},kbG:function(){return Tn},oeJ:function(){return si},iS_:function(){return me},cGG:function(){return Kr},skb:function(){return Nr},SLU:function(){return on},RdJ:function(){return Qn},gU7:function(){return Sn},LSk:function(){return zi},Nmp:function(){return Xe},d1Y:function(){return nn},xrL:function(){return Wn},sRW:function(){return Gn},cmV:function(){return So},N0Q:function(){return Li},q8b:function(){return xi},ynB:function(){return ni},jT9:function(){return rr},wAz:function(){return Dr},D4V:function(){return Ba},N6H:function(){return we},W1A:function(){return be},JHW:function(){return pi},v2K:function(){return _r},pBf:function(){return xe},GMl:function(){return Bt},zW2:function(){return t},B0K:function(){return Ka},Nv7:function(){return Ma},C_p:function(){return ln},MUA:function(){return ke},xqU:function(){return _e},peG:function(){return w},pTp:function(){return Fi},vUK:function(){return O},j9l:function(){return Ni},Zxw:function(){return Ua},Hdx:function(){return Ge},Z$d:function(){return He},o$7:function(){return Zr},Zm$:function(){return Nt},$QH:function(){return Vt},i78:function(){return Gt},h6u:function(){return ie},hts:function(){return ne},j88:function(){return te},VME:function(){return ee},nt:function(){return lo},Ukr:function(){return wa},zsu:function(){return Dt},oA6:function(){return _i},TVh:function(){return Mr},TwZ:function(){return yi},GTT:function(){return mi},xxj:function(){return Ir},XdK:function(){return se},cXo:function(){return Ze},Dm5:function(){return ge},IIB:function(){return m},zI0:function(){return En},SKZ:function(){return Ut},__J:function(){return Va},Dvr:function(){return k},Tf9:function(){return h},RI$:function(){return or},x12:function(){return Kn},aNw:function(){return kn},xwn:function(){return ir},dNK:function(){return nr},ini:function(){return S},YdH:function(){return A},y3G:function(){return pt},l57:function(){return ct},xn0:function(){return Ia},t2V:function(){return Ui},ZyS:function(){return wo},uxB:function(){return Fn},cpd:function(){return Or},fiy:function(){return Ai},$XZ:function(){return Pi},uqK:function(){return za},STE:function(){return Na},y$z:function(){return zn},sOq:function(){return Nn},Sqs:function(){return po},hpZ:function(){return Br},Vol:function(){return Fr},wIZ:function(){return Pn},cBi:function(){return Qr},mgq:function(){return vo},YVA:function(){return ii},Kgp:function(){return wt},HH$:function(){return ue},M_d:function(){return Zt},rgh:function(){return qt},Ra6:function(){return Jt},KhR:function(){return Wt},BS5:function(){return Yt},xhz:function(){return le},xOq:function(){return Kt},a9j:function(){return Xt},bHk:function(){return $t},CgK:function(){return Ht},cuY:function(){return Qt},kvE:function(){return Un},JDb:function(){return xo},Cbi:function(){return bo},AE_:function(){return wr},ctO:function(){return kr},OLH:function(){return ar},kky:function(){return D},nSF:function(){return It},zHn:function(){return Vn},zwx:function(){return jr},AeJ:function(){return bi},hLz:function(){return di},D9g:function(){return vr},wA:function(){return Oi},jhr:function(){return Ei},GVs:function(){return un},_zO:function(){return Se},w6$:function(){return Ti},mhV:function(){return ji},MOD:function(){return Si},kwd:function(){return Di},Lmr:function(){return Ri},xsS:function(){return Wr},lLr:function(){return cn},Z$r:function(){return T},IXb:function(){return Xi},SMj:function(){return ja},bnF:function(){return ri},MFA:function(){return P},$XC:function(){return yo},$uU:function(){return oo},jyi:function(){return qe},E03:function(){return an},V6q:function(){return rn},nVo:function(){return er},F6N:function(){return ho},ad3:function(){return re},xP7:function(){return dr},Odq:function(){return xr},Zif:function(){return ur},ZGJ:function(){return Dn},xvT:function(){return Ha},PHM:function(){return We},KwO:function(){return Yi},B7y:function(){return Ki},SFp:function(){return _},Uvn:function(){return Bn},OFT:function(){return Hn},xzN:function(){return hr},H6j:function(){return ae},ZrN:function(){return b},OWs:function(){return ot},dF9:function(){return jn},VHo:function(){return oe},R$E:function(){return io},q3I:function(){return Sr},Pab:function(){return U},uZ5:function(){return I},McK:function(){return E},k0b:function(){return gi},hnT:function(){return Qa},RSJ:function(){return to},Mku:function(){return $a},h90:function(){return no},rms:function(){return eo},ErP:function(){return Za},aVg:function(){return Ja},lPc:function(){return Ya},Z8E:function(){return hi},NNA:function(){return pr},yFn:function(){return gr},lNv:function(){return fi},MZQ:function(){return tt},FUM:function(){return rt},vdf:function(){return z},iaL:function(){return N},w6H:function(){return $},Q4c:function(){return nt},Uxb:function(){return H},Yr5:function(){return W},Bhw:function(){return st}});var t={};n.r(t),n.d(t,{ActivateEvent:function(){return ye},CollisionEndEvent:function(){return ve},CollisionPostSolveEvent:function(){return fe},CollisionPreSolveEvent:function(){return de},CollisionStartEvent:function(){return pe},ContactEndEvent:function(){return he},ContactStartEvent:function(){return ce},DeactivateEvent:function(){return me},EnterTriggerEvent:function(){return we},EnterViewPortEvent:function(){return be},EventTypes:function(){return Bt},ExitTriggerEvent:function(){return ke},ExitViewPortEvent:function(){return _e},GameEvent:function(){return Nt},GameStartEvent:function(){return Vt},GameStopEvent:function(){return Gt},GamepadAxisEvent:function(){return ie},GamepadButtonEvent:function(){return ne},GamepadConnectEvent:function(){return te},GamepadDisconnectEvent:function(){return ee},HiddenEvent:function(){return se},InitializeEvent:function(){return ge},KillEvent:function(){return Ut},PostCollisionEvent:function(){return ue},PostDebugDrawEvent:function(){return Zt},PostDrawEvent:function(){return qt},PostFrameEvent:function(){return Jt},PostKillEvent:function(){return Wt},PostUpdateEvent:function(){return Yt},PreCollisionEvent:function(){return le},PreDebugDrawEvent:function(){return Kt},PreDrawEvent:function(){return Xt},PreFrameEvent:function(){return $t},PreKillEvent:function(){return Ht},PreUpdateEvent:function(){return Qt},SubscribeEvent:function(){return re},UnsubscribeEvent:function(){return ae},VisibleEvent:function(){return oe}});var r={};n.r(r),n.d(r,{Colorize:function(){return Pe},Darken:function(){return Te},Desaturate:function(){return De},Fill:function(){return Me},Grayscale:function(){return Oe},Invert:function(){return Ee},Lighten:function(){return je},Opacity:function(){return Ae},Saturate:function(){return Re}});var u={};n.r(u),n.d(u,{circle:function(){return mn},line:function(){return pn},point:function(){return vn},roundRect:function(){return yn},vector:function(){return gn}});var h={};n.r(h),n.d(h,{Animation:function(){return $e},CanvasDrawComponent:function(){return vi},CanvasDrawingSystem:function(){return zr},Effects:function(){return r},Polygon:function(){return qa},Sprite:function(){return Ue},SpriteFont:function(){return en},SpriteSheet:function(){return tn},Texture:function(){return Be}});var m={};n.r(m),n.d(m,{Axes:function(){return Ea},Buttons:function(){return Ca},Gamepad:function(){return Pa},Gamepads:function(){return Sa},KeyEvent:function(){return ea},Keyboard:function(){return na},Keys:function(){return Vr},NativePointerButton:function(){return ia},Pointer:function(){return ua},PointerButton:function(){return aa},PointerCancelEvent:function(){return ma},PointerDownEvent:function(){return pa},PointerDragEvent:function(){return da},PointerEnterEvent:function(){return ga},PointerEvent:function(){return ca},PointerEventFactory:function(){return ha},PointerLeaveEvent:function(){return ya},PointerMoveEvent:function(){return va},PointerScope:function(){return Jr},PointerType:function(){return Yr},PointerUpEvent:function(){return fa},Pointers:function(){return xa},WheelDeltaMode:function(){return sa},WheelEvent:function(){return _a},createPointerEventByName:function(){return ba}});var _={};n.r(_),n.d(_,{CapturePointer:function(){return ui},OffscreenCulling:function(){return li}});var b={};n.r(b),n.d(b,{Collection:function(){return Q},ConsoleAppender:function(){return j},DrawUtil:function(){return u},EasingFunctions:function(){return xi},LogLevel:function(){return S},Logger:function(){return A},Observable:function(){return zn},ScreenAppender:function(){return T},TwoPI:function(){return M},addItemToArray:function(){return G},base64Encode:function(){return B},canonicalizeAngle:function(){return U},clamp:function(){return I},contains:function(){return q},delay:function(){return J},extend:function(){return L},fail:function(){return Y},getOppositeSide:function(){return K},getPosition:function(){return V},getSideFromDirection:function(){return Z},nullish:function(){return F},randomInRange:function(){return z},randomIntInRange:function(){return N},range:function(){return $},removeItemFromArray:function(){return X},toDegrees:function(){return H},toRadians:function(){return W}});var w,k;n(4662),n(8343);function x(){if("undefined"===typeof window&&(window={audioContext:function(){}}),"undefined"===typeof window||window.requestAnimationFrame||(window.requestAnimationFrame=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setInterval(t,1e3/60)}),"undefined"===typeof window||window.cancelAnimationFrame||(window.cancelAnimationFrame=window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||function(){}),"undefined"!==typeof window&&!window.AudioContext){if(window.webkitAudioContext){var t=window.webkitAudioContext.prototype.decodeAudioData;window.webkitAudioContext.prototype.decodeAudioData=function(e){var n=this;return new Promise((function(i,r){t.call(n,e,i,r)}))}}window.AudioContext=window.AudioContext||window.webkitAudioContext||window.mozAudioContext||window.msAudioContext||window.oAudioContext}"undefined"===typeof window||window.devicePixelRatio||(window.devicePixelRatio=window.devicePixelRatio||1)}!function(t){t.WebGL="use-webgl"}(w||(w={})),function(t){t.Canvas="use-canvas-context",t.LegacyDrawing="use-legacy-drawing"}(k||(k={}));var S,C,O=function(){function t(){Object(g.a)(this,t)}return Object(y.a)(t,null,[{key:"freeze",value:function(){t._FROZEN=!0}},{key:"_reset",value:function(){t._FROZEN=!1,t._FLAGS={}}},{key:"useWebGL",value:function(){t.enable(w.WebGL)}},{key:"useCanvasGraphicsContext",value:function(){t.enable(k.Canvas)}},{key:"useLegacyDrawing",value:function(){t.enable(k.LegacyDrawing)}},{key:"enable",value:function(e){if(this._FROZEN)throw Error("Feature flags can only be enabled before Engine constructor time");t._FLAGS[e]=!0}},{key:"disable",value:function(e){if(this._FROZEN)throw Error("Feature flags can only be disabled before Engine constructor time");t._FLAGS[e]=!1}},{key:"isEnabled",value:function(e){return!!t._FLAGS[e]}},{key:"show",value:function(){return Object.keys(t._FLAGS)}}]),t}();function E(t,e){return{type:t,value:e}}O._FROZEN=!1,O._FLAGS={},(C=S||(S={}))[C.Debug=0]="Debug",C[C.Info=1]="Info",C[C.Warn=2]="Warn",C[C.Error=3]="Error",C[C.Fatal=4]="Fatal";var A=function(){function t(){if(Object(g.a)(this,t),this._appenders=[],this.defaultLevel=S.Info,t._INSTANCE)throw new Error("Logger is a singleton");return t._INSTANCE=this,t._INSTANCE.addAppender(new j),t._INSTANCE}return Object(y.a)(t,[{key:"addAppender",value:function(t){this._appenders.push(t)}},{key:"clearAppenders",value:function(){this._appenders.length=0}},{key:"_log",value:function(t,e){null==t&&(t=this.defaultLevel);for(var n=this._appenders.length,i=0;i<n;i++)t>=this.defaultLevel&&this._appenders[i].log(t,e)}},{key:"debug",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this._log(S.Debug,e)}},{key:"info",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this._log(S.Info,e)}},{key:"warn",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this._log(S.Warn,e)}},{key:"error",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this._log(S.Error,e)}},{key:"fatal",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this._log(S.Fatal,e)}}],[{key:"getInstance",value:function(){return null==t._INSTANCE&&(t._INSTANCE=new t),t._INSTANCE}}]),t}();A._INSTANCE=null;var P,j=function(){function t(){Object(g.a)(this,t)}return Object(y.a)(t,[{key:"log",value:function(t,e){if(console||console.log||!console.warn||!console.error){var n=[];n.unshift.apply(n,e),n.unshift("["+S[t]+"] : "),t<S.Warn?console.log.apply?console.log.apply(console,n):console.log(n.join(" ")):t<S.Error?console.warn.apply?console.warn.apply(console,n):console.warn(n.join(" ")):console.error.apply?console.error.apply(console,n):console.error(n.join(" "))}}}]),t}(),T=function(){function t(e,n){Object(g.a)(this,t),this._messages=[],this._canvas=document.createElement("canvas"),this._canvas.width=e||window.innerWidth,this._canvas.height=n||window.innerHeight,this._canvas.style.position="absolute",this._ctx=this._canvas.getContext("2d"),document.body.appendChild(this._canvas)}return Object(y.a)(t,[{key:"log",value:function(t,e){var n=e.join(",");this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._messages.unshift("["+S[t]+"] : "+n);for(var i=10,r=1,a=0;a<this._messages.length;a++)this._ctx.fillStyle="rgba(255,255,255,"+r.toFixed(2)+")",this._ctx.fillText(this._messages[a],200,i),i+=10,r=r>0?r-.05:0}}]),t}(),R=4294967295,D=function(){function t(e){Object(g.a)(this,t),this.seed=e,this._lowerMask=2147483647,this._upperMask=2147483648,this._w=32,this._n=624,this._m=397,this._a=2567483615,this._u=11,this._s=7,this._b=2636928640,this._t=15,this._c=4022730752,this._l=18,this._f=1812433253,this._mt=new Array(this._n),this._mt[0]=(e||Date.now())>>>0;for(var n=1;n<this._n;n++){var i=this._mt[n-1]^this._mt[n-1]>>>this._w-2;this._mt[n]=(this._f*((4294901760&i)>>>16)<<16)+this._f*(65535&i)+n>>>0}this._index=this._n}return Object(y.a)(t,[{key:"_twist",value:function(){for(var t=[0,this._a],e=0,n=0;n<this._n-this._m;n++)e=this._mt[n]&this._upperMask|this._mt[n+1]&this._lowerMask,this._mt[n]=this._mt[n+this._m]^e>>>1^t[1&e]&R;for(;n<this._n-1;n++)e=this._mt[n]&this._upperMask|this._mt[n+1]&this._lowerMask,this._mt[n]=this._mt[n+(this._m-this._n)]^e>>>1^t[1&e]&R;e=this._mt[this._n-1]&this._upperMask|this._mt[0]&this._lowerMask,this._mt[this._n-1]=this._mt[this._m-1]^e>>>1^t[1&e]&R,this._index=0}},{key:"nextInt",value:function(){this._index>=this._n&&this._twist();var t=this._mt[this._index++];return t^=t>>>this._u,t^=t<<this._s&this._b,t^=t<<this._t&this._c,(t^=t>>>this._l)>>>0}},{key:"next",value:function(){return this.nextInt()*(1/4294967296)}},{key:"floating",value:function(t,e){return(e-t)*this.next()+t}},{key:"integer",value:function(t,e){return Math.floor((e-t+1)*this.next()+t)}},{key:"bool",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.5;return this.next()<=t}},{key:"pickOne",value:function(t){return t[this.integer(0,t.length-1)]}},{key:"pickSet",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return n?this._pickSetWithDuplicates(t,e):this._pickSetWithoutDuplicates(t,e)}},{key:"_pickSetWithoutDuplicates",value:function(t,e){if(e>t.length||e<0)throw new Error("Invalid number of elements to pick, must pick a value 0 < n <= length");if(e===t.length)return t;for(var n=new Array(e),i=0,r=t.slice(0);i<e;){var a=this.integer(0,r.length-1);n[i++]=r[a],r.splice(a,1)}return n}},{key:"_pickSetWithDuplicates",value:function(t,e){if(e<0)throw new Error("Invalid number of elements to pick, must pick a value 0 <= n < MAX_INT");for(var n=new Array(e),i=0;i<e;i++)n[i]=this.pickOne(t);return n}},{key:"shuffle",value:function(t){for(var e=t.slice(0),n=null,i=0;i<e.length-2;i++){var r=this.integer(i,e.length-1);n=e[i],e[i]=e[r],e[r]=n}return e}},{key:"range",value:function(t,e,n){for(var i=new Array(t),r=0;r<t;r++)i[r]=this.integer(e,n);return i}},{key:"d4",value:function(){return this.integer(1,4)}},{key:"d6",value:function(){return this.integer(1,6)}},{key:"d8",value:function(){return this.integer(1,8)}},{key:"d10",value:function(){return this.integer(1,10)}},{key:"d12",value:function(){return this.integer(1,12)}},{key:"d20",value:function(){return this.integer(1,20)}}]),t}();!function(t){t.None="None",t.Top="Top",t.Bottom="Bottom",t.Left="Left",t.Right="Right"}(P||(P={})),function(t){t.getOpposite=function(e){return e===t.Top?t.Bottom:e===t.Bottom?t.Top:e===t.Left?t.Right:e===t.Right?t.Left:t.None},t.fromDirection=function(e){for(var n=[ot.Left,ot.Right,ot.Up,ot.Down],i=[t.Left,t.Right,t.Top,t.Bottom],r=-Number.MAX_VALUE,a=-1,o=0;o<n.length;o++)n[o].dot(e)>r&&(r=n[o].dot(e),a=o);return i[a]}}(P||(P={}));var M=2*Math.PI;function L(){var t={},e=!1,n=0,i=arguments.length;"[object Boolean]"===Object.prototype.toString.call(arguments[0])&&(e=arguments[0],n++);var r="function"===typeof Object.assign,a=null;for(a=r?Object.assign:function(n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e&&"[object Object]"===Object.prototype.toString.call(n[i])?t[i]=L(!0,t[i],n[i]):t[i]=n[i])};n<i;n++){var o=arguments[n];r?a(t,o):a(o)}return t}function B(t){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n="",i=0;i<t.length;){var r=255&t.charCodeAt(i++),a=255&t.charCodeAt(i++),o=255&t.charCodeAt(i++),s=r>>2,l=(3&r)<<4|a>>4,u=void 0,c=void 0;isNaN(a)?u=c=64:(u=(15&a)<<2|o>>6,c=isNaN(o)?64:63&o),n+=e.charAt(s)+e.charAt(l)+e.charAt(u)+e.charAt(c)}return n}function F(t,e){return null!==t&&void 0!==t?t:e}function I(t,e,n){return Math.min(Math.max(e,t),n)}function z(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new D;return n?n.floating(t,e):t+Math.random()*(e-t)}function N(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new D;return n?n.integer(t,e):Math.round(z(t,e))}function U(t){var e=t;if(t>M)for(;e>M;)e-=M;if(t<0)for(;e<0;)e+=M;return e}function H(t){return 180/Math.PI*t}function W(t){return t/180*Math.PI}function V(t){var e=0,n=0;return function t(n){e+=n.offsetLeft,n.offsetParent&&t(n.offsetParent)}(t),function t(e){n+=e.offsetTop,e.offsetParent&&t(e.offsetParent)}(t),new ot(e,n)}function G(t,e){return-1===e.indexOf(t)&&(e.push(t),!0)}function X(t,e){var n;return(n=e.indexOf(t))>-1&&(e.splice(n,1),!0)}function q(t,e){for(var n=0;n<t.length;n++)if(t[n]===e)return!0;return!1}function K(t){return t===P.Top?P.Bottom:t===P.Bottom?P.Top:t===P.Left?P.Right:t===P.Right?P.Left:P.None}function Z(t){for(var e=[ot.Left,ot.Right,ot.Up,ot.Down],n=[P.Left,P.Right,P.Top,P.Bottom],i=-Number.MAX_VALUE,r=-1,a=0;a<e.length;a++)e[a].dot(t)>i&&(i=e[a].dot(t),r=a);return n[r]}var Q=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t.DefaultSize;Object(g.a)(this,t),this._internalArray=null,this._endPointer=0,this._internalArray=new Array(e)}return Object(y.a)(t,[{key:"_resize",value:function(){for(var t=2*this._internalArray.length,e=new Array(t),n=this.count(),i=0;i<n;i++)e[i]=this._internalArray[i];delete this._internalArray,this._internalArray=e}},{key:"push",value:function(t){return this._endPointer===this._internalArray.length&&this._resize(),this._internalArray[this._endPointer++]=t}},{key:"pop",value:function(){return this._endPointer=this._endPointer-1<0?0:this._endPointer-1,this._internalArray[this._endPointer]}},{key:"count",value:function(){return this._endPointer}},{key:"clear",value:function(){this._endPointer=0}},{key:"internalSize",value:function(){return this._internalArray.length}},{key:"elementAt",value:function(t){if(t>=this.count())throw new Error("Invalid index "+t);return this._internalArray[t]}},{key:"insert",value:function(t,e){return t>=this.count()&&this._resize(),this._internalArray[t]=e}},{key:"remove",value:function(t){var e=this.count();if(0===e)throw new Error("Invalid parameter "+t);for(var n=this._internalArray[t],i=t;i<e;i++)this._internalArray[i]=this._internalArray[i+1];return this._endPointer--,n}},{key:"removeElement",value:function(t){var e=this._internalArray.indexOf(t);this.remove(e)}},{key:"toArray",value:function(){return this._internalArray.slice(0,this._endPointer)}},{key:"forEach",value:function(t){for(var e=0,n=this.count();e<n;e++)t.call(this,this._internalArray[e],e)}},{key:"map",value:function(t){for(var e=this.count(),n=0;n<e;n++)this._internalArray[n]=t.call(this,this._internalArray[n],n)}}]),t}();function Y(t){throw new Error(t)}Q.DefaultSize=200;var $=function(t,e){return Array.from(new Array(e-t+1),(function(e,n){return n+t}))};function J(t){return new Promise((function(e){setTimeout((function(){e()}),t)}))}var tt=5,et={},nt=function(){for(var t in et)et[t]=0},it=function(t,e){var n=O.isEnabled("suppress-obsolete-message");et[t]<tt&&!n&&(A.getInstance().warn(t),console.trace&&e.showStackTrace&&console.trace()),et[t]++};function rt(t){return t=L({},{message:"This feature will be removed in future versions of Excalibur.",alternateMethod:null,showStackTrack:!1},t),function(e,n,i){if(i&&"function"!==typeof i.value&&"function"!==typeof i.get&&"function"!==typeof i.set)throw new SyntaxError("Only classes/functions/getters/setters can be marked as obsolete");var r="".concat(e.name||"").concat(e.name&&n?".":"").concat(n||""),a="".concat(r," is marked obsolete: ").concat(t.message)+(t.alternateMethod?" Use ".concat(t.alternateMethod," instead"):"");et[a]||(et[a]=0);var o=i?Object.assign({},i):e;if(!i){var s=function(e){Object(p.a)(i,e);var n=Object(v.a)(i);function i(){Object(g.a)(this,i),it(a,t);for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];return n.call.apply(n,[this].concat(r))}return i}(o);return s}return i&&i.value?(o.value=function(){return it(a,t),i.value.apply(this,arguments)},o):(i&&i.get&&(o.get=function(){return it(a,t),i.get.apply(this,arguments)}),i&&i.set&&(o.set=function(){return it(a,t),i.set.apply(this,arguments)}),o)}}var at=function(t,e,n,i){var r,a=arguments.length,o=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,n,o):r(e,n))||o);return a>3&&o&&Object.defineProperty(e,n,o),o},ot=function(){function t(e,n){Object(g.a)(this,t),this._x=0,this._y=0,this._x=e,this._y=n}return Object(y.a)(t,[{key:"x",get:function(){return this._x},set:function(t){this._x=t}},{key:"y",get:function(){return this._y},set:function(t){this._y=t}},{key:"setTo",value:function(t,e){this.x=t,this.y=e}},{key:"equals",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.001;return Math.abs(this.x-t.x)<=e&&Math.abs(this.y-t.y)<=e}},{key:"distance",value:function(e){return e||(e=t.Zero),Math.sqrt(Math.pow(this.x-e.x,2)+Math.pow(this.y-e.y,2))}},{key:"squareDistance",value:function(e){return e||(e=t.Zero),Math.pow(this.x-e.x,2)+Math.pow(this.y-e.y,2)}},{key:"magnitude",value:function(){return this.distance()}},{key:"size",get:function(){return this.distance()},set:function(t){var e=this.normalize().scale(t);this.setTo(e.x,e.y)}},{key:"normalize",value:function(){var e=this.distance();return e>0?new t(this.x/e,this.y/e):new t(0,1)}},{key:"average",value:function(t){return this.add(t).scale(.5)}},{key:"scale",value:function(e){return e instanceof t?new t(this.x*e.x,this.y*e.y):new t(this.x*e,this.y*e)}},{key:"add",value:function(e){return new t(this.x+e.x,this.y+e.y)}},{key:"sub",value:function(e){return new t(this.x-e.x,this.y-e.y)}},{key:"addEqual",value:function(t){return this.setTo(this.x+t.x,this.y+t.y),this}},{key:"subEqual",value:function(t){return this.setTo(this.x-t.x,this.y-t.y),this}},{key:"scaleEqual",value:function(t){return this.setTo(this.x*t,this.y*t),this}},{key:"dot",value:function(t){return this.x*t.x+this.y*t.y}},{key:"cross",value:function(e){return e instanceof t?this.x*e.y-this.y*e.x:"number"===typeof e?new t(e*this.y,-e*this.x):void 0}},{key:"perpendicular",value:function(){return new t(this.y,-this.x)}},{key:"normal",value:function(){return this.perpendicular().normalize()}},{key:"negate",value:function(){return this.scale(-1)}},{key:"toAngle",value:function(){return Math.atan2(this.y,this.x)}},{key:"rotate",value:function(e,n){n||(n=new t(0,0));var i=Math.sin(e),r=Math.cos(e);return new t(r*(this.x-n.x)-i*(this.y-n.y)+n.x,i*(this.x-n.x)+r*(this.y-n.y)+n.y)}},{key:"clone",value:function(){return new t(this.x,this.y)}},{key:"toString",value:function(t){return t?"(".concat(this.x.toFixed(t),", ").concat(this.y.toFixed(t),")"):"(".concat(this.x,", ").concat(this.y,")")}}],[{key:"Zero",get:function(){return new t(0,0)}},{key:"One",get:function(){return new t(1,1)}},{key:"Half",get:function(){return new t(.5,.5)}},{key:"Up",get:function(){return new t(0,-1)}},{key:"Down",get:function(){return new t(0,1)}},{key:"Left",get:function(){return new t(-1,0)}},{key:"Right",get:function(){return new t(1,0)}},{key:"fromAngle",value:function(e){return new t(Math.cos(e),Math.sin(e))}},{key:"isValid",value:function(t){return null!==t&&void 0!==t&&(!isNaN(t.x)&&!isNaN(t.y)&&(t.x!==1/0&&t.y!==1/0&&t.x!==-1/0&&t.y!==-1/0))}},{key:"distance",value:function(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}},{key:"cross",value:function(e,n){return new t(-e*n.y,e*n.x)}}]),t}();function st(t,e){return new ot(t,e)}at([rt({message:"will be removed in favour of `.size` in version 0.25.0"})],ot.prototype,"magnitude",null);var lt=function(t,e,n,i){var r,a=arguments.length,o=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,n,o):r(e,n))||o);return a>3&&o&&Object.defineProperty(e,n,o),o},ut=function(){function t(e,n,i,r){Object(g.a)(this,t),this.r=e,this.g=n,this.b=i,this.a=null!=r?r:1}return Object(y.a)(t,[{key:"lighten",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1,e=ht.fromRGBA(this.r,this.g,this.b,this.a);return e.l+=(1-e.l)*t,e.toRGBA()}},{key:"darken",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1,e=ht.fromRGBA(this.r,this.g,this.b,this.a);return e.l-=e.l*t,e.toRGBA()}},{key:"saturate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1,e=ht.fromRGBA(this.r,this.g,this.b,this.a);return e.s+=e.s*t,e.toRGBA()}},{key:"desaturate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1,e=ht.fromRGBA(this.r,this.g,this.b,this.a);return e.s-=e.s*t,e.toRGBA()}},{key:"multiply",value:function(e){return new t(e.r/255*this.r/255*255,e.g/255*this.g/255*255,e.b/255*this.b/255*255,e.a*this.a)}},{key:"mulitiply",value:function(t){return this.multiply(t)}},{key:"screen",value:function(t){var e=t.invert(),n=t.invert();return e.multiply(n).invert()}},{key:"invert",value:function(){return new t(255-this.r,255-this.g,255-this.b,1-this.a)}},{key:"average",value:function(e){return new t((e.r+this.r)/2,(e.g+this.g)/2,(e.b+this.b)/2,(e.a+this.a)/2)}},{key:"equal",value:function(t){return this.toString()===t.toString()}},{key:"toString",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"rgb";switch(t){case"rgb":return this.toRGBA();case"hsl":return this.toHSLA();case"hex":return this.toHex();default:throw new Error("Invalid Color format")}}},{key:"_componentToHex",value:function(t){var e=t.toString(16);return 1===e.length?"0"+e:e}},{key:"toHex",value:function(){return"#"+this._componentToHex(this.r)+this._componentToHex(this.g)+this._componentToHex(this.b)}},{key:"toRGBA",value:function(){var t=String(this.r.toFixed(0))+", "+String(this.g.toFixed(0))+", "+String(this.b.toFixed(0));return void 0!==this.a||null!==this.a?"rgba("+t+", "+String(this.a)+")":"rgb("+t+")"}},{key:"toHSLA",value:function(){return ht.fromRGBA(this.r,this.g,this.b,this.a).toString()}},{key:"fillStyle",value:function(){return this.toString()}},{key:"clone",value:function(){return new t(this.r,this.g,this.b,this.a)}}],[{key:"fromRGB",value:function(e,n,i,r){return new t(e,n,i,r)}},{key:"fromRGBString",value:function(e){var n;if(n=e.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\)/i)){var i=parseInt(n[1],10),r=parseInt(n[2],10),a=parseInt(n[3],10),o=1;return n[4]&&(o=parseFloat(n[4])),new t(i,r,a,o)}throw new Error("Invalid rgb/a string: "+e)}},{key:"fromHex",value:function(e){var n;if(n=e.match(/^#?([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})?$/i)){var i=parseInt(n[1],16),r=parseInt(n[2],16),a=parseInt(n[3],16),o=1;return n[4]&&(o=parseInt(n[4],16)/255),new t(i,r,a,o)}throw new Error("Invalid hex string: "+e)}},{key:"fromHSL",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=new ht(t,e,n,i);return r.toRGBA()}},{key:"Black",get:function(){return t.fromHex("#000000")}},{key:"White",get:function(){return t.fromHex("#FFFFFF")}},{key:"Gray",get:function(){return t.fromHex("#808080")}},{key:"LightGray",get:function(){return t.fromHex("#D3D3D3")}},{key:"DarkGray",get:function(){return t.fromHex("#A9A9A9")}},{key:"Yellow",get:function(){return t.fromHex("#FFFF00")}},{key:"Orange",get:function(){return t.fromHex("#FFA500")}},{key:"Red",get:function(){return t.fromHex("#FF0000")}},{key:"Vermilion",get:function(){return t.fromHex("#FF5B31")}},{key:"Vermillion",get:function(){return t.Vermilion}},{key:"Rose",get:function(){return t.fromHex("#FF007F")}},{key:"Magenta",get:function(){return t.fromHex("#FF00FF")}},{key:"Violet",get:function(){return t.fromHex("#7F00FF")}},{key:"Blue",get:function(){return t.fromHex("#0000FF")}},{key:"Azure",get:function(){return t.fromHex("#007FFF")}},{key:"Cyan",get:function(){return t.fromHex("#00FFFF")}},{key:"Viridian",get:function(){return t.fromHex("#59978F")}},{key:"Green",get:function(){return t.fromHex("#00FF00")}},{key:"Chartreuse",get:function(){return t.fromHex("#7FFF00")}},{key:"Transparent",get:function(){return t.fromHex("#FFFFFF00")}},{key:"ExcaliburBlue",get:function(){return t.fromHex("#176BAA")}}]),t}();lt([rt({message:"Alias for incorrect spelling used in older versions, use multiply instead, will be removed in v0.25.0"})],ut.prototype,"mulitiply",null),lt([rt({message:"Alias for incorrect spelling used in older versions",alternateMethod:"Vermilion"})],ut,"Vermillion",null);var ct,ht=function(){function t(e,n,i,r){Object(g.a)(this,t),this.h=e,this.s=n,this.l=i,this.a=r}return Object(y.a)(t,[{key:"toRGBA",value:function(){var e,n,i;if(0===this.s)e=n=i=this.l;else{var r=this.l<.5?this.l*(1+this.s):this.l+this.s-this.l*this.s,a=2*this.l-r;e=t.hue2rgb(a,r,this.h+1/3),n=t.hue2rgb(a,r,this.h),i=t.hue2rgb(a,r,this.h-1/3)}return new ut(255*e,255*n,255*i,this.a)}},{key:"toString",value:function(){var t=this.h.toFixed(0),e=this.s.toFixed(0),n=this.l.toFixed(0),i=this.a.toFixed(0);return"hsla(".concat(t,", ").concat(e,", ").concat(n,", ").concat(i,")")}}],[{key:"hue2rgb",value:function(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+(e-t)*(2/3-n)*6:t}},{key:"fromRGBA",value:function(e,n,i,r){e/=255,n/=255,i/=255;var a,o,s=Math.max(e,n,i),l=Math.min(e,n,i),u=(s+l)/2;if(s===l)a=o=0;else{var c=s-l;switch(o=u>.5?c/(2-s-l):c/(s+l),s){case e:a=(n-i)/c+(n<i?6:0);break;case n:a=(i-e)/c+2;break;case i:a=(e-n)/c+4}a/=6}return new t(a,o,u,r)}}]),t}(),dt=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;Object(g.a)(this,t),"object"===typeof e?(this.left=e.left,this.top=e.top,this.right=e.right,this.bottom=e.bottom):"number"===typeof e&&(this.left=e,this.top=n,this.right=i,this.bottom=r)}return Object(y.a)(t,[{key:"width",get:function(){return this.right-this.left}},{key:"height",get:function(){return this.bottom-this.top}},{key:"hasZeroDimensions",value:function(){return 0===this.width||0===this.height}},{key:"center",get:function(){return new ot((this.left+this.right)/2,(this.top+this.bottom)/2)}},{key:"translate",value:function(e){return new t(this.left+e.x,this.top+e.y,this.right+e.x,this.bottom+e.y)}},{key:"rotate",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ot.Zero,i=this.getPoints().map((function(t){return t.rotate(e,n)}));return t.fromPoints(i)}},{key:"scale",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ot.Zero,i=this.translate(n);return new t(i.left*e.x,i.top*e.y,i.right*e.x,i.bottom*e.y)}},{key:"transform",value:function(e){var n=this.getPoints().map((function(t){return e.multv(t)}));return t.fromPoints(n)}},{key:"getPerimeter",value:function(){return 2*(this.width+this.height)}},{key:"getPoints",value:function(){var t=[];return t.push(new ot(this.left,this.top)),t.push(new ot(this.right,this.top)),t.push(new ot(this.right,this.bottom)),t.push(new ot(this.left,this.bottom)),t}},{key:"rayCast",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,n=-1/0,i=1/0,r=0===t.dir.x?Number.MAX_VALUE:1/t.dir.x,a=0===t.dir.y?Number.MAX_VALUE:1/t.dir.y,o=(this.left-t.pos.x)*r,s=(this.right-t.pos.x)*r;n=Math.min(o,s),i=Math.max(o,s);var l=(this.top-t.pos.y)*a,u=(this.bottom-t.pos.y)*a;return n=Math.max(n,Math.min(l,u)),(i=Math.min(i,Math.max(l,u)))>=Math.max(0,n)&&n<e}},{key:"rayCastTime",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,n=-1/0,i=1/0,r=0===t.dir.x?Number.MAX_VALUE:1/t.dir.x,a=0===t.dir.y?Number.MAX_VALUE:1/t.dir.y,o=(this.left-t.pos.x)*r,s=(this.right-t.pos.x)*r;n=Math.min(o,s),i=Math.max(o,s);var l=(this.top-t.pos.y)*a,u=(this.bottom-t.pos.y)*a;return n=Math.max(n,Math.min(l,u)),(i=Math.min(i,Math.max(l,u)))>=Math.max(0,n)&&n<e?n:-1}},{key:"contains",value:function(e){return e instanceof ot?this.left<=e.x&&this.top<=e.y&&this.bottom>=e.y&&this.right>=e.x:e instanceof t&&(this.left<e.left&&this.top<e.top&&e.bottom<this.bottom&&e.right<this.right)}},{key:"combine",value:function(e){return new t(Math.min(this.left,e.left),Math.min(this.top,e.top),Math.max(this.right,e.right),Math.max(this.bottom,e.bottom))}},{key:"dimensions",get:function(){return new ot(this.width,this.height)}},{key:"intersect",value:function(t){var e=this.combine(t);if(e.width<t.width+this.width&&e.height<t.height+this.height&&!e.dimensions.equals(t.dimensions)&&!e.dimensions.equals(this.dimensions)){var n=0;n=this.right>=t.left&&this.right<=t.right?t.left-this.right:t.right-this.left;var i=0;return i=this.top<=t.bottom&&this.top>=t.top?t.bottom-this.top:t.top-this.bottom,Math.abs(n)<Math.abs(i)?new ot(n,0):new ot(0,i)}if(e.dimensions.equals(t.dimensions)||e.dimensions.equals(this.dimensions)){var r=0;r=this.width-t.width>=0?this.right-t.right<=t.left-this.left?t.left-this.right:t.right-this.left:t.right-this.right<=this.left-t.left?this.left-t.right:this.right-t.left;var a=0;return a=this.height-t.height>=0?this.bottom-t.bottom<=t.top-this.top?t.top-this.bottom:t.bottom-this.top:t.bottom-this.bottom<=this.top-t.top?this.top-t.bottom:this.bottom-t.top,Math.abs(r)<Math.abs(a)?new ot(r,0):new ot(0,a)}return null}},{key:"intersectWithSide",value:function(e){var n=this.intersect(e);return t.getSideFromIntersection(n)}},{key:"debugDraw",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ut.Yellow;t.strokeStyle=e.toString(),t.strokeRect(this.left,this.top,this.width,this.height)}},{key:"draw",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ut.Yellow;t.debug.drawRect(this.left,this.top,this.width,this.height,{color:e})}}],[{key:"getSideFromIntersection",value:function(t){return t&&t?Math.abs(t.x)>Math.abs(t.y)?t.x<0?P.Right:P.Left:t.y<0?P.Bottom:P.Top:P.None}},{key:"fromPoints",value:function(e){for(var n=1/0,i=1/0,r=-1/0,a=-1/0,o=0;o<e.length;o++)e[o].x<n&&(n=e[o].x),e[o].x>r&&(r=e[o].x),e[o].y<i&&(i=e[o].y),e[o].y>a&&(a=e[o].y);return new t(n,i,r,a)}},{key:"fromDimension",value:function(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ot.Half,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:ot.Zero;return new t(-e*i.x+r.x,-n*i.y+r.y,e-e*i.x+r.x,n-n*i.y+r.y)}}]),t}();!function(t){t[t.X=12]="X",t[t.Y=13]="Y"}(ct||(ct={}));var ft=function(t){return 0===t?0:t<0?-1:1},pt=function(){function t(){Object(g.a)(this,t),this.data=new Float32Array(16),this._scaleSignX=1,this._scaleSignY=1}return Object(y.a)(t,[{key:"clone",value:function(){var e=new t;return e.data[0]=this.data[0],e.data[1]=this.data[1],e.data[2]=this.data[2],e.data[3]=this.data[3],e.data[4]=this.data[4],e.data[5]=this.data[5],e.data[6]=this.data[6],e.data[7]=this.data[7],e.data[8]=this.data[8],e.data[9]=this.data[9],e.data[10]=this.data[10],e.data[11]=this.data[11],e.data[12]=this.data[12],e.data[13]=this.data[13],e.data[14]=this.data[14],e.data[15]=this.data[15],e}},{key:"multv",value:function(t){return t instanceof ot?new ot(t.x*this.data[0]+t.y*this.data[4]+0*this.data[6]+1*this.data[12],t.x*this.data[1]+t.y*this.data[5]+0*this.data[9]+1*this.data[13]):[t[0]*this.data[0]+t[1]*this.data[4]+0*this.data[6]+1*this.data[12],t[0]*this.data[1]+t[1]*this.data[5]+0*this.data[9]+1*this.data[13]]}},{key:"multm",value:function(e){var n=new t,i=this.data[0],r=this.data[1],a=this.data[2],o=this.data[3],s=this.data[4],l=this.data[5],u=this.data[6],c=this.data[7],h=this.data[8],d=this.data[9],f=this.data[10],p=this.data[11],v=this.data[12],g=this.data[13],y=this.data[14],m=this.data[15],_=e.data[0],b=e.data[1],w=e.data[2],k=e.data[3],x=e.data[4],S=e.data[5],C=e.data[6],O=e.data[7],E=e.data[8],A=e.data[9],P=e.data[10],j=e.data[11],T=e.data[12],R=e.data[13],D=e.data[14],M=e.data[15];n.data[0]=i*_+s*b+h*w+v*k,n.data[1]=r*_+l*b+d*w+g*k,n.data[2]=a*_+u*b+f*w+y*k,n.data[3]=o*_+c*b+p*w+m*k,n.data[4]=i*x+s*S+h*C+v*O,n.data[5]=r*x+l*S+d*C+g*O,n.data[6]=a*x+u*S+f*C+y*O,n.data[7]=o*x+c*S+p*C+m*O,n.data[8]=i*E+s*A+h*P+v*j,n.data[9]=r*E+l*A+d*P+g*j,n.data[10]=a*E+u*A+f*P+y*j,n.data[11]=o*E+c*A+p*P+m*j,n.data[12]=i*T+s*R+h*D+v*M,n.data[13]=r*T+l*R+d*D+g*M,n.data[14]=a*T+u*R+f*D+y*M,n.data[15]=o*T+c*R+p*D+m*M;var L=this.getScale();return n._scaleSignX=ft(L.x)*ft(n._scaleSignX),n._scaleSignY=ft(L.y)*ft(n._scaleSignY),n}},{key:"translate",value:function(t,e){var n=this.data[0],i=this.data[1],r=this.data[2],a=this.data[3],o=this.data[4],s=this.data[5],l=this.data[6],u=this.data[7],c=this.data[8],h=this.data[9],d=this.data[10],f=this.data[11],p=this.data[12],v=this.data[13],g=this.data[14],y=this.data[15];return this.data[12]=n*t+o*e+0*c+1*p,this.data[13]=i*t+s*e+0*h+1*v,this.data[14]=r*t+l*e+0*d+1*g,this.data[15]=a*t+u*e+0*f+1*y,this}},{key:"setPosition",value:function(t,e){this.data[12]=t,this.data[13]=e}},{key:"getPosition",value:function(){return st(this.data[12],this.data[13])}},{key:"rotate",value:function(t){var e=this.data[0],n=this.data[1],i=this.data[2],r=this.data[3],a=this.data[4],o=this.data[5],s=this.data[6],l=this.data[7],u=Math.sin(t),c=Math.cos(t);return this.data[0]=c*e+u*a,this.data[1]=c*n+u*o,this.data[2]=c*i+u*s,this.data[3]=c*r+u*l,this.data[4]=c*a-u*e,this.data[5]=c*o-u*n,this.data[6]=c*s-u*i,this.data[7]=c*l-u*r,this}},{key:"scale",value:function(t,e){var n=this.data[0],i=this.data[1],r=this.data[2],a=this.data[3],o=this.data[4],s=this.data[5],l=this.data[6],u=this.data[7];return this.data[0]=n*t,this.data[1]=i*t,this.data[2]=r*t,this.data[3]=a*t,this.data[4]=o*e,this.data[5]=s*e,this.data[6]=l*e,this.data[7]=u*e,this}},{key:"setRotation",value:function(t){var e=this.getScale(),n=Math.sin(t),i=Math.cos(t);this.data[0]=i*e.x,this.data[1]=n*e.y,this.data[4]=-n*e.x,this.data[5]=i*e.y}},{key:"getRotation",value:function(){return U(Math.atan2(this.data[1]/this.getScaleY(),this.data[0]/this.getScaleX()))}},{key:"getScaleX",value:function(){var t=st(this.data[0],this.data[4]).size;return this._scaleSignX*t}},{key:"getScaleY",value:function(){var t=st(this.data[1],this.data[5]).size;return this._scaleSignY*t}},{key:"getScale",value:function(){return st(this.getScaleX(),this.getScaleY())}},{key:"setScaleX",value:function(t){this._scaleSignX=ft(t);var e=st(this.data[0]*this._scaleSignX,this.data[4]*this._scaleSignX).normalize();this.data[0]=e.x*t,this.data[4]=e.y*t}},{key:"setScaleY",value:function(t){this._scaleSignY=ft(t);var e=st(this.data[1]*this._scaleSignY,this.data[5]*this._scaleSignY).normalize();this.data[1]=e.x*t,this.data[5]=e.y*t}},{key:"setScale",value:function(t){this.setScaleX(t.x),this.setScaleY(t.y)}},{key:"getBasisDeterminant",value:function(){return this.data[0]*this.data[5]-this.data[1]*this.data[4]}},{key:"getAffineInverse",value:function(){var e=1/this.getBasisDeterminant(),n=this.data[0],i=this.data[4],r=this.data[1],a=this.data[5],o=t.identity();o.data[0]=a*e,o.data[1]=-r*e,o.data[4]=-i*e,o.data[5]=n*e;var s=this.data[12],l=this.data[13];return o.data[12]=-(s*o.data[0]+l*o.data[4]),o.data[13]=-(s*o.data[1]+l*o.data[5]),o}},{key:"isIdentity",value:function(){return 1===this.data[0]&&0===this.data[1]&&0===this.data[2]&&0===this.data[3]&&0===this.data[4]&&1===this.data[5]&&0===this.data[6]&&0===this.data[7]&&0===this.data[8]&&0===this.data[9]&&1===this.data[10]&&0===this.data[11]&&0===this.data[12]&&0===this.data[13]&&0===this.data[14]&&1===this.data[15]}},{key:"toString",value:function(){return"\n[".concat(this.data[0]," ").concat(this.data[4]," ").concat(this.data[8]," ").concat(this.data[12],"]\n[").concat(this.data[1]," ").concat(this.data[5]," ").concat(this.data[9]," ").concat(this.data[13],"]\n[").concat(this.data[2]," ").concat(this.data[6]," ").concat(this.data[10]," ").concat(this.data[14],"]\n[").concat(this.data[3]," ").concat(this.data[7]," ").concat(this.data[11]," ").concat(this.data[15],"]\n")}}],[{key:"ortho",value:function(e,n,i,r,a,o){var s=new t;return s.data[0]=2/(n-e),s.data[1]=0,s.data[2]=0,s.data[3]=0,s.data[4]=0,s.data[5]=2/(r-i),s.data[6]=0,s.data[7]=0,s.data[8]=0,s.data[9]=0,s.data[10]=-2/(o-a),s.data[11]=0,s.data[12]=-(n+e)/(n-e),s.data[13]=-(r+i)/(r-i),s.data[14]=-(o+a)/(o-a),s.data[15]=1,s}},{key:"identity",value:function(){var e=new t;return e.data[0]=1,e.data[1]=0,e.data[2]=0,e.data[3]=0,e.data[4]=0,e.data[5]=1,e.data[6]=0,e.data[7]=0,e.data[8]=0,e.data[9]=0,e.data[10]=1,e.data[11]=0,e.data[12]=0,e.data[13]=0,e.data[14]=0,e.data[15]=1,e}},{key:"translation",value:function(e,n){var i=t.identity();return i.data[12]=e,i.data[13]=n,i}},{key:"scale",value:function(e,n){var i=t.identity();return i.data[0]=e,i.data[5]=n,i.data[10]=1,i.data[15]=1,i}},{key:"rotation",value:function(e){var n=t.identity();return n.data[0]=Math.cos(e),n.data[4]=-Math.sin(e),n.data[1]=Math.sin(e),n.data[5]=Math.cos(e),n}}]),t}(),vt=function(){function t(){Object(g.a)(this,t),this._transforms=[],this._currentTransform=pt.identity()}return Object(y.a)(t,[{key:"save",value:function(){this._transforms.push(this._currentTransform),this._currentTransform=this._currentTransform.clone()}},{key:"restore",value:function(){this._currentTransform=this._transforms.pop()}},{key:"translate",value:function(t,e){return this._currentTransform.translate(t,e)}},{key:"rotate",value:function(t){return this._currentTransform.rotate(t)}},{key:"scale",value:function(t,e){return this._currentTransform.scale(t,e)}},{key:"current",get:function(){return this._currentTransform},set:function(t){this._currentTransform=t}}]),t}(),gt=function(){function t(){Object(g.a)(this,t),this._states=[],this._currentState=this._getDefaultState()}return Object(y.a)(t,[{key:"_getDefaultState",value:function(){return{opacity:1}}},{key:"_cloneState",value:function(){return{opacity:this._currentState.opacity}}},{key:"save",value:function(){this._states.push(this._currentState),this._currentState=this._cloneState()}},{key:"restore",value:function(){this._currentState=this._states.pop()}},{key:"current",get:function(){return this._currentState}}]),t}(),yt=function(){function t(e,n,i){Object(g.a)(this,t),this._gl=e,this._vertexSource=n,this._fragmentSource=i,this.program=null,this.uniforms={},this.attributes={},this.layout=[],this.compile(e)}return Object(y.a)(t,[{key:"_createProgram",value:function(t,e,n){var i=t.createProgram();if(null===i)throw Error("Could not create graphics shader program");if(t.attachShader(i,e),t.attachShader(i,n),t.linkProgram(i),!t.getProgramParameter(i,t.LINK_STATUS))throw Error("Could not link the program: [".concat(t.getProgramInfoLog(i),"]"));return i}},{key:"_compileShader",value:function(t,e,n){var i=t.createShader(n);if(null===i)throw Error("Could not build shader: [".concat(e,"]"));if(t.shaderSource(i,e),t.compileShader(i),!t.getShaderParameter(i,t.COMPILE_STATUS))throw Error("Could not compile shader [".concat(t.getShaderInfoLog(i),"]"));return i}},{key:"compile",value:function(t){var e=this._compileShader(t,this._vertexSource,t.VERTEX_SHADER),n=this._compileShader(t,this._fragmentSource,t.FRAGMENT_SHADER),i=this._createProgram(t,e,n);return this.program=i}},{key:"addUniformMatrix",value:function(t,e){if(!e)throw Error("Shader Uniform Matrix '".concat(t,"' was set to null or undefined"));var n=this._gl;this.uniforms[t]={name:t,type:"matrix",location:n.getUniformLocation(this.program,t),data:e}}},{key:"addUniformIntegerArray",value:function(t,e){if(!e)throw Error("Shader Uniform Integery Array '".concat(t,"' was set to null or undefined"));var n=this._gl;this.uniforms[t]={name:t,type:"numbers",location:n.getUniformLocation(this.program,t),data:e}}},{key:"addAttribute",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=this._gl,a=r.getAttribLocation(this.program,t);this.attributes[t]={name:t,size:e,glType:n,normalized:i,location:a},this.layout.push(this.attributes[t])}},{key:"vertexAttributeSize",get:function(){var t,e=0,n=Object(f.a)(this.layout);try{for(n.s();!(t=n.n()).done;){e+=t.value.size}}catch(i){n.e(i)}finally{n.f()}return e}},{key:"totalVertexSizeBytes",get:function(){var t,e=0,n=Object(f.a)(this.layout);try{for(n.s();!(t=n.n()).done;){var i=t.value,r=1;if(i.glType===this._gl.FLOAT)r=4;else r=1;e+=r*i.size}}catch(a){n.e(a)}finally{n.f()}return e}},{key:"getAttributeSize",value:function(t){var e=1;if(this.attributes[t].glType===this._gl.FLOAT)e=4;else e=1;return e*this.attributes[t].size}},{key:"use",value:function(){var t=this._gl;t.useProgram(this.program);var e,n=0,i=Object(f.a)(this.layout);try{for(i.s();!(e=i.n()).done;){var r=e.value;t.vertexAttribPointer(r.location,r.size,r.glType,r.normalized,this.totalVertexSizeBytes,n),t.enableVertexAttribArray(r.location),n+=this.getAttributeSize(r.name)}}catch(s){i.e(s)}finally{i.f()}for(var a in this.uniforms){var o=this.uniforms[a];switch(o.type){case"matrix":t.uniformMatrix4fv(o.location,!1,o.data);break;case"numbers":t.uniform1iv(o.location,o.data)}}}}]),t}(),mt=function(){function t(e){Object(g.a)(this,t),this.max=e,this._pool=void 0,this.commands=[]}return Object(y.a)(t,[{key:"isFull",value:function(){return this.commands.length>=this.max}},{key:"canAdd",value:function(){return!this.isFull()}},{key:"add",value:function(t){this.commands.push(t)}},{key:"dispose",value:function(){return this.commands.length=0,this}}]),t}(),_t=function(){function t(){Object(g.a)(this,t)}return Object(y.a)(t,null,[{key:"clear",value:function(){t.DrawCallCount=0,t.DrawnImagesCount=0}}]),t}();_t.DrawCallCount=0,_t.DrawnImagesCount=0;var bt,wt=function(){function t(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100;Object(g.a)(this,t),this.builder=e,this.recycler=n,this.maxObjects=i,this.totalAllocations=0,this.index=0,this.objects=[],this._logger=A.getInstance()}return Object(y.a)(t,[{key:"using",value:function(t){var e=t(this);return e?this.done.apply(this,d(e)):this.done()}},{key:"borrow",value:function(t){t(this.get()),this.index--}},{key:"get",value:function(){this.index===this.maxObjects&&(this._logger.warn("Max pooled objects reached, possible memory leak? Doubling"),this.maxObjects=2*this.maxObjects);for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];if(this.objects[this.index])return this.recycler.apply(this,[this.objects[this.index++]].concat(e));this.totalAllocations++;var i=this.objects[this.index++]=this.builder.apply(this,e);return i._pool=this,i}},{key:"done",value:function(){this.index=0;for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var i=0,r=e;i<r.length;i++){var a=r[i],o=this.objects.indexOf(a);this.objects[o]=this.builder(),this.objects[o]._pool=this,this.totalAllocations++,a._pool=void 0}return e}}]),t}(),kt=function(){function t(e){var n,i,r,a=this;Object(g.a)(this,t),this.priority=0,this._buffer=null,this._maxCommandsPerBatch=2e3,this._batches=[],this._gl=e.gl;var o=e.command;this._verticesPerCommand=null!==(n=null===e||void 0===e?void 0:e.verticesPerCommand)&&void 0!==n?n:1,this._maxCommandsPerBatch=null!==(i=null===e||void 0===e?void 0:e.maxCommandsPerBatch)&&void 0!==i?i:this._maxCommandsPerBatch;var s=null!==(r=null===e||void 0===e?void 0:e.batchFactory)&&void 0!==r?r:function(){return new mt(a._maxCommandsPerBatch)};this.commands=new wt((function(){return new o}),(function(t){return t.dispose()}),this._maxCommandsPerBatch),this._batchPool=new wt(s,(function(t){return t.dispose()}),100)}return Object(y.a)(t,[{key:"init",value:function(){var t=this._gl;this.shader=this.buildShader(t),this._vertices=new Float32Array(this.shader.vertexAttributeSize*this._verticesPerCommand*this._maxCommandsPerBatch),this._buffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this._buffer),t.bufferData(t.ARRAY_BUFFER,this._vertices,t.DYNAMIC_DRAW)}},{key:"vertexSize",get:function(){return this.shader.vertexAttributeSize}},{key:"addCommand",value:function(t){0===this._batches.length&&this._batches.push(this._batchPool.get());var e=this._batches[this._batches.length-1];if(e.canAdd())e.add(t);else{var n=this._batchPool.get();n.add(t),this._batches.push(n)}}},{key:"render",value:function(){var t=this._gl;t.bindBuffer(t.ARRAY_BUFFER,this._buffer),this.shader.use();var e,n=0,i=0,r=Object(f.a)(this._batches);try{for(r.s();!(e=r.n()).done;){var a=e.value,o=this.buildBatchVertices(this._vertices,a);t.bufferSubData(t.ARRAY_BUFFER,0,this._vertices),this.renderBatch(t,a,o),i+=a.commands.length,n++}}catch(s){r.e(s)}finally{r.f()}this.commands.done(),this._batchPool.done(),this._batches.length=0,_t.DrawCallCount+=n,_t.DrawnImagesCount+=i}}]),t}(),xt=function(){function t(){Object(g.a)(this,t),this.color=ut.Black,this.start=ot.Zero,this.end=ot.Zero}return Object(y.a)(t,[{key:"dispose",value:function(){return this.color.r=0,this.color.g=0,this.color.b=0,this.color.a=1,this.start.setTo(0,0),this.end.setTo(0,0),this}}]),t}(),St=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t,i){var r;return Object(g.a)(this,n),(r=e.call(this,{gl:t,command:xt,verticesPerCommand:2}))._contextInfo=i,r.init(),r}return Object(y.a)(n,[{key:"buildShader",value:function(t){var e=new yt(t,"attribute vec4 a_position;\r\nattribute vec4 a_color;\r\n\r\nvarying lowp vec4 v_color;\r\n\r\nuniform mat4 u_matrix;\r\n\r\n\r\nvoid main() {\r\n   // Set the vertex position using the ortho transform matrix\r\n   gl_Position = u_matrix * a_position;\r\n\r\n   // Passthrough the color\r\n   v_color = a_color;\r\n}","precision mediump float;\r\n\r\n// Color\r\nvarying lowp vec4 v_color;\r\n\r\n\r\nvoid main() {\r\n  gl_FragColor = v_color;\r\n}");return e.addAttribute("a_position",2,t.FLOAT),e.addAttribute("a_color",4,t.FLOAT),e.addUniformMatrix("u_matrix",this._contextInfo.matrix.data),e}},{key:"addLine",value:function(t,e,n){var i=this.commands.get();i.start=this._contextInfo.transform.current.multv(t),i.end=this._contextInfo.transform.current.multv(e),i.color.r=n.r,i.color.g=n.g,i.color.b=n.b,i.color.a=i.color.a*this._contextInfo.state.current.opacity,this.addCommand(i)}},{key:"buildBatchVertices",value:function(t,e){var n,i=0,r=Object(f.a)(e.commands);try{for(r.s();!(n=r.n()).done;){var a=n.value;t[i++]=a.start.x,t[i++]=a.start.y,t[i++]=a.color.r/255,t[i++]=a.color.g/255,t[i++]=a.color.b/255,t[i++]=a.color.a,t[i++]=a.end.x,t[i++]=a.end.y,t[i++]=a.color.r/255,t[i++]=a.color.g/255,t[i++]=a.color.b/255,t[i++]=a.color.a}}catch(o){r.e(o)}finally{r.f()}return i/this.vertexSize}},{key:"renderBatch",value:function(t,e,n){t.drawArrays(t.LINES,0,n)}}]),n}(kt);!function(t){t.Image="image",t.Line="line",t.Rectangle="rectangle",t.Circle="circle"}(bt||(bt={}));var Ct=function(){function t(e,n,i,r,a,o,s,l,u){Object(g.a)(this,t),this._pool=void 0,this.snapToPixel=!0,this.type=bt.Image,this.opacity=1,this.width=0,this.height=0,this.dest=[0,0],this.view=[0,0,0,0],this._geom=[[0,0],[0,0],[0,0],[0,0],[0,0],[0,0]],this.init(e,n,i,r,a,o,s,l,u)}return Object(y.a)(t,[{key:"init",value:function(t,e,n,i,r,a,o,s,l){this.type=bt.Image,this.image=t,this.width=(null===t||void 0===t?void 0:t.width)||i||0,this.height=(null===t||void 0===t?void 0:t.height)||r||0,this.view=[0,0,null!==i&&void 0!==i?i:null===t||void 0===t?void 0:t.width,null!==r&&void 0!==r?r:null===t||void 0===t?void 0:t.height],this.dest=[e,n],void 0!==a&&void 0!==o&&void 0!==s&&void 0!==l&&(this.view=[e,n,null!==i&&void 0!==i?i:null===t||void 0===t?void 0:t.width,null!==r&&void 0!==r?r:null===t||void 0===t?void 0:t.height],this.dest=[a,o],this.width=s,this.height=l);var u=0;if(this._geom[u++]=[this.dest[0],this.dest[1]],this._geom[u++]=[this.dest[0],this.dest[1]+this.height],this._geom[u++]=[this.dest[0]+this.width,this.dest[1]],this._geom[u++]=[this.dest[0]+this.width,this.dest[1]],this._geom[u++]=[this.dest[0],this.dest[1]+this.height],this._geom[u++]=[this.dest[0]+this.width,this.dest[1]+this.height],this.snapToPixel){var c,h=Object(f.a)(this._geom);try{for(h.s();!(c=h.n()).done;){var d=c.value;d[0]=~~d[0],d[1]=~~d[1]}}catch(p){h.e(p)}finally{h.f()}}return this}},{key:"initRect",value:function(t,e,n,i){this.type=bt.Rectangle,this.color=t,this.width=n,this.height=i;var r=0;if(this._geom[r++]=[e.x,e.y],this._geom[r++]=[e.x,e.y+this.height],this._geom[r++]=[e.x+this.width,e.y],this._geom[r++]=[e.x+this.width,e.y],this._geom[r++]=[e.x,e.y+this.height],this._geom[r++]=[e.x+this.width,e.y+this.height],this.snapToPixel){var a,o=Object(f.a)(this._geom);try{for(o.s();!(a=o.n()).done;){var s=a.value;s[0]=~~s[0],s[1]=~~s[1]}}catch(l){o.e(l)}finally{o.f()}}return this}},{key:"initLine",value:function(t,e,n,i){this.type=bt.Line,this.color=t;var r=n.sub(e).normalize().perpendicular(),a=i/2,o=r.scale(a).add(e),s=r.scale(-a).add(e),l=r.scale(a).add(n),u=r.scale(-a).add(n),c=0;if(this._geom[c++]=[o.x,o.y],this._geom[c++]=[l.x,l.y],this._geom[c++]=[s.x,s.y],this._geom[c++]=[s.x,s.y],this._geom[c++]=[l.x,l.y],this._geom[c++]=[u.x,u.y],this.snapToPixel){var h,d=Object(f.a)(this._geom);try{for(d.s();!(h=d.n()).done;){var p=h.value;p[0]=~~p[0],p[1]=~~p[1]}}catch(v){d.e(v)}finally{d.f()}}return this}},{key:"initCircle",value:function(t,e,n){this.type=bt.Circle,this.color=n;var i=t.add(st(-e,-e)),r=t.add(st(e,-e)),a=t.add(st(e,e)),o=t.add(st(-e,e)),s=0;if(this._geom[s++]=[i.x,i.y],this._geom[s++]=[r.x,r.y],this._geom[s++]=[o.x,o.y],this._geom[s++]=[o.x,o.y],this._geom[s++]=[r.x,r.y],this._geom[s++]=[a.x,a.y],this.snapToPixel){var l,u=Object(f.a)(this._geom);try{for(u.s();!(l=u.n()).done;){var c=l.value;c[0]=~~c[0],c[1]=~~c[1]}}catch(h){u.e(h)}finally{u.f()}}return this}},{key:"dispose",value:function(){this.image=null,this.width=0,this.height=0,this.view=[0,0,0,0],this.dest=[0,0];var t=0;return this._geom[t++]=[this.dest[0],this.dest[1]],this._geom[t++]=[this.dest[0],this.dest[1]+this.height],this._geom[t++]=[this.dest[0]+this.width,this.dest[1]],this._geom[t++]=[this.dest[0]+this.width,this.dest[1]],this._geom[t++]=[this.dest[0],this.dest[1]+this.height],this._geom[t++]=[this.dest[0]+this.width,this.dest[1]+this.height],this}},{key:"applyTransform",value:function(t,e){if(t)for(var n=0;n<this._geom.length;n++)this._geom[n]=t.multv(this._geom[n]),this.snapToPixel&&(this._geom[n]=[~~this._geom[n][0],~~this._geom[n][1]]);this.opacity=e}},{key:"geometry",get:function(){return this._geom}}]),t}();function Ot(t){return 0===(t&t-1)}function Et(t){return Ot(t)?t:function(t){--t;for(var e=1;e<32;e<<=1)t|=t>>e;return t+1}(t)}var At=function(){function t(){Object(g.a)(this,t)}return Object(y.a)(t,null,[{key:"registerContext",value:function(e){t._GL=e}},{key:"get",value:function(e){return t._TEXTURE_MAP.get(e)}},{key:"has",value:function(e){return t._TEXTURE_MAP.has(e)}},{key:"load",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=t._GL;if(!i)return null;var r=null;if(t.has(e)&&(r=t.get(e)),r){if(n){i.bindTexture(i.TEXTURE_2D,r);var a=t.toPowerOfTwoImage(e);i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,a)}return r}r=i.createTexture();var o=t.toPowerOfTwoImage(e);return i.bindTexture(i.TEXTURE_2D,r),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.NEAREST),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,o),t._TEXTURE_MAP.set(e,r),r}},{key:"toPowerOfTwoImage",value:function(e){var n=t._POT_CANVAS,i=t._POT_CTX;return Ot(e.width)&&Ot(e.height)||(n.width=Et(e.width),n.height=Et(e.height),i.imageSmoothingEnabled=!1,i.clearRect(0,0,n.width,n.height),i.drawImage(e,0,0,e.width,e.height),e=n),e}}]),t}();At._POT_CANVAS=document.createElement("canvas"),At._POT_CTX=At._POT_CANVAS.getContext("2d"),At._TEXTURE_MAP=new Map;var Pt=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t,i){var r;return Object(g.a)(this,n),(r=e.call(this,t)).maxDraws=t,r.maxTextures=i,r.textures=[],r.commands=[],r._graphicMap={},r}return Object(y.a)(n,[{key:"isFull",value:function(){return this.commands.length>=this.maxDraws||this.textures.length>=this.maxTextures}},{key:"canAdd",value:function(){return!(this.commands.length>=this.maxDraws)&&this.textures.length<this.maxTextures}},{key:"_isCommandFull",value:function(){return this.commands.length>=this.maxDraws}},{key:"_isTextureFull",value:function(){return this.textures.length>=this.maxTextures}},{key:"_wouldAddTexture",value:function(t){return!this._graphicMap[t.image.id]}},{key:"maybeAdd",value:function(t){return(!this._isCommandFull()&&!this._isTextureFull()||!this._wouldAddTexture(t))&&(this.add(t),!0)}},{key:"add",value:function(t){if(t.type===bt.Image){var e=At.load(t.image);-1===this.textures.indexOf(e)&&this.textures.push(e)}this.commands.push(t)}},{key:"bindTextures",value:function(t){for(var e=0;e<this.maxTextures;e++)t.activeTexture(t.TEXTURE0+e),t.bindTexture(t.TEXTURE_2D,this.textures[e]||this.textures[0])}},{key:"getBatchTextureId",value:function(t){return t.image?this.textures.indexOf(At.get(t.image)):-1}},{key:"dispose",value:function(){return this.clear(),this}},{key:"clear",value:function(){this.commands.length=0,this.textures.length=0,this._graphicMap={}}}]),n}(mt),jt=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t,i){var r;return Object(g.a)(this,n),(r=e.call(this,{gl:t,command:Ct,verticesPerCommand:6,maxCommandsPerBatch:2e3,batchFactory:function(){return new Pt(2e3,t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS))}}))._contextInfo=i,At.registerContext(t),r.init(),r}return Object(y.a)(n,[{key:"buildShader",value:function(t){var e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),n=new yt(t,"attribute vec4 a_position;\r\n\r\n// Opacity \r\nattribute float a_opacity;\r\nvarying float v_opacity;\r\n\r\nattribute vec4 a_color;\r\nvarying vec4 v_color;\r\n\r\n// UV coordinate\r\nattribute vec2 a_texcoord;\r\nvarying vec2 v_texcoord;\r\n\r\n// Texture number\r\nattribute lowp float a_textureIndex;\r\nvarying lowp float v_textureIndex;\r\n\r\nuniform mat4 u_matrix;\r\n\r\n\r\nvoid main() {\r\n   // Set the vertex position using the ortho transform matrix\r\n   gl_Position = u_matrix * a_position;\r\n\r\n   // Pass through the Opacity to the fragment shader\r\n   v_opacity = a_opacity;\r\n   // Pass through the UV coord to the fragment shader\r\n   v_texcoord = a_texcoord;\r\n   // Pass through the texture number to the fragment shader\r\n   v_textureIndex = a_textureIndex;\r\n   // Pass through the color to the fragment shader\r\n   v_color = a_color;\r\n}",this._transformFragmentSource("#ifdef GL_OES_standard_derivatives\r\n#extension GL_OES_standard_derivatives : enable\r\n#endif\r\nprecision mediump float;\r\n\r\n// UV coord\r\nvarying vec2 v_texcoord;\r\n\r\n// Texture index\r\nvarying lowp float v_textureIndex;\r\n\r\n// Color coord to blend with image\r\nvarying lowp vec4 v_color;\r\n\r\n// Opacity\r\nvarying float v_opacity;\r\n\r\nuniform sampler2D u_textures[%%count%%];\r\n\r\nfloat circle(in vec2 st, in float radius) {\r\n  vec2 dist = st - vec2(0.5);\r\n  float r = dot(dist, dist) * 4.0;\r\n  float delta = fwidth(r);\r\n  return 1.0 - smoothstep(radius - delta, radius + delta, r);\r\n}\r\n\r\nvoid main() {\r\n  float r = 0.0, delta = 0.0, alpha = 1.0;\r\n   // In order to support the most efficient sprite batching, we have multiple\r\n   // textures loaded into the gpu (usually 8) this picker logic skips over textures\r\n   // that do not apply to a particular sprite.\r\n\r\n   vec4 color;\r\n   // -1 If there is no texture to sample we are drawing a solid geometry (rectangles)\r\n   if (v_textureIndex == -1.0) {\r\n     color = v_color;\r\n     color.w = color.w * v_opacity;\r\n   // -2 If there is no texture we are drawing a circle\r\n   } else if (v_textureIndex == -2.0) {\r\n     color = v_color;\r\n     color.a = color.a * circle(v_texcoord, .95);\r\n   } else {\r\n     // GLSL is templated out to pick the right texture and set the vec4 color\r\n      %%texture_picker%%\r\n   }\r\n   color.w = color.w * v_opacity;\r\n   gl_FragColor = color;\r\n}",e));return n.addAttribute("a_position",3,t.FLOAT),n.addAttribute("a_texcoord",2,t.FLOAT),n.addAttribute("a_textureIndex",1,t.FLOAT),n.addAttribute("a_opacity",1,t.FLOAT),n.addAttribute("a_color",4,t.FLOAT),n.addUniformMatrix("u_matrix",this._contextInfo.matrix.data),n.addUniformIntegerArray("u_textures",d(Array(e)).map((function(t,e){return e}))),n}},{key:"_transformFragmentSource",value:function(t,e){for(var n=t.replace("%%count%%",e.toString()),i="",r=0;r<e;r++)i+=0===r?"if (v_textureIndex <= ".concat(r,".5) {\n"):"   else if (v_textureIndex <= ".concat(r,".5) {\n"),i+="      color = texture2D(u_textures[".concat(r,"], v_texcoord);\n"),i+="   }\n";return n=n.replace("%%texture_picker%%",i)}},{key:"addCircle",value:function(t,e,n){var i=this.commands.get().initCircle(t,e,n);i.applyTransform(this._contextInfo.transform.current,this._contextInfo.state.current.opacity),this.addCommand(i)}},{key:"addRectangle",value:function(t,e,n,i){var r=this.commands.get().initRect(t,e,n,i);r.applyTransform(this._contextInfo.transform.current,this._contextInfo.state.current.opacity),this.addCommand(r)}},{key:"addLine",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=this.commands.get().initLine(t,e,n,i);r.applyTransform(this._contextInfo.transform.current,this._contextInfo.state.current.opacity),this.addCommand(r)}},{key:"addImage",value:function(t,e,n,i,r,a,o,s,l){var u=this.commands.get().init(t,e,n,i,r,a,o,s,l);u.applyTransform(this._contextInfo.transform.current,this._contextInfo.state.current.opacity),this.addCommand(u)}},{key:"renderBatch",value:function(t,e,n){e.bindTextures(t),t.drawArrays(t.TRIANGLES,0,n)}},{key:"buildBatchVertices",value:function(t,e){var n,i,r,a=0,o=0,s=0,l=0,u=0,c=1,h=1,d=0,p=ut.Transparent,v=Object(f.a)(e.commands);try{for(v.s();!(r=v.n()).done;){var g=r.value;o=g.view[0],s=g.view[1],l=g.view[2],u=g.view[3],c=Et((null===(n=g.image)||void 0===n?void 0:n.width)||g.width),h=Et((null===(i=g.image)||void 0===i?void 0:i.height)||g.height),d=e.getBatchTextureId(g),g.type!==bt.Line&&g.type!==bt.Rectangle||(d=-1,p=g.color),g.type===bt.Circle&&(d=-2,p=g.color);var y=o/c,m=s/h,_=(o+l)/c,b=(s+u)/h;-2===d&&(y=0,m=0,_=1,b=1),t[a++]=g.geometry[0][0],t[a++]=g.geometry[0][1],t[a++]=0,t[a++]=y,t[a++]=m,t[a++]=d,t[a++]=g.opacity,t[a++]=p.r/255,t[a++]=p.g/255,t[a++]=p.b/255,t[a++]=p.a,t[a++]=g.geometry[1][0],t[a++]=g.geometry[1][1],t[a++]=0,t[a++]=y,t[a++]=b,t[a++]=d,t[a++]=g.opacity,t[a++]=p.r/255,t[a++]=p.g/255,t[a++]=p.b/255,t[a++]=p.a,t[a++]=g.geometry[2][0],t[a++]=g.geometry[2][1],t[a++]=0,t[a++]=_,t[a++]=m,t[a++]=d,t[a++]=g.opacity,t[a++]=p.r/255,t[a++]=p.g/255,t[a++]=p.b/255,t[a++]=p.a,t[a++]=g.geometry[3][0],t[a++]=g.geometry[3][1],t[a++]=0,t[a++]=_,t[a++]=m,t[a++]=d,t[a++]=g.opacity,t[a++]=p.r/255,t[a++]=p.g/255,t[a++]=p.b/255,t[a++]=p.a,t[a++]=g.geometry[4][0],t[a++]=g.geometry[4][1],t[a++]=0,t[a++]=y,t[a++]=b,t[a++]=d,t[a++]=g.opacity,t[a++]=p.r/255,t[a++]=p.g/255,t[a++]=p.b/255,t[a++]=p.a,t[a++]=g.geometry[5][0],t[a++]=g.geometry[5][1],t[a++]=0,t[a++]=_,t[a++]=b,t[a++]=d,t[a++]=g.opacity,t[a++]=p.r/255,t[a++]=p.g/255,t[a++]=p.b/255,t[a++]=p.a}}catch(w){v.e(w)}finally{v.f()}return a/this.vertexSize}}]),n}(kt),Tt=function(){function t(){Object(g.a)(this,t),this.point=ot.Zero,this.color=ut.Black,this.size=1}return Object(y.a)(t,[{key:"dispose",value:function(){return this.point.setTo(0,0),this.color.r=0,this.color.g=0,this.color.b=0,this.color.a=1,this.size=1,this}}]),t}(),Rt=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t,i){var r;return Object(g.a)(this,n),(r=e.call(this,{gl:t,command:Tt,verticesPerCommand:1}))._contextInfo=i,r.init(),r}return Object(y.a)(n,[{key:"buildShader",value:function(t){t.getExtension("OES_standard_derivatives");var e=new yt(t,"attribute vec4 a_position;\r\nattribute vec4 a_color;\r\nattribute float a_size;\r\nvarying lowp vec4 v_color;\r\nuniform mat4 u_matrix;\r\n\r\nvoid main() {\r\n  gl_Position = u_matrix * a_position;\r\n  gl_PointSize = a_size * 2.0;\r\n  v_color = a_color;\r\n}","#ifdef GL_OES_standard_derivatives\r\n#extension GL_OES_standard_derivatives : enable\r\n#endif\r\n\r\nprecision mediump float;\r\nvarying lowp vec4 v_color;\r\n\r\nvoid main() {\r\n  float r = 0.0, delta = 0.0, alpha = 1.0;\r\n  vec2 cxy = 2.0 * gl_PointCoord - 1.0;\r\n  r = dot(cxy, cxy);\r\n  \r\n#ifdef GL_OES_standard_derivatives\r\n  delta = fwidth(r);\r\n  alpha = 1.0 - smoothstep(1.0 - delta, 1.0 + delta, r);\r\n#else\r\n  if (r > 1.0) {\r\n    discard;\r\n  }\r\n#endif\r\n  gl_FragColor = vec4(v_color.rgb, v_color.a * alpha);\r\n}");return e.addAttribute("a_position",2,t.FLOAT),e.addAttribute("a_color",4,t.FLOAT),e.addAttribute("a_size",1,t.FLOAT),e.addUniformMatrix("u_matrix",this._contextInfo.matrix.data),e}},{key:"addPoint",value:function(t,e,n){var i=this.commands.get();i.point=this._contextInfo.transform.current.multv(t),i.color.r=e.r,i.color.g=e.g,i.color.b=e.b,i.color.a=e.a*this._contextInfo.state.current.opacity,i.size=n*Math.max(this._contextInfo.transform.current.getScaleX(),this._contextInfo.transform.current.getScaleY()),this.addCommand(i)}},{key:"buildBatchVertices",value:function(t,e){var n,i=0,r=Object(f.a)(e.commands);try{for(r.s();!(n=r.n()).done;){var a=n.value;t[i++]=a.point.x,t[i++]=a.point.y,t[i++]=a.color.r/255,t[i++]=a.color.g/255,t[i++]=a.color.b/255,t[i++]=a.color.a,t[i++]=a.size}}catch(o){r.e(o)}finally{r.f()}return i/this.vertexSize}},{key:"renderBatch",value:function(t,e,n){t.drawArrays(t.POINTS,0,n)}}]),n}(kt),Dt=function(){function t(e){var n,i,r,a,o,s;Object(g.a)(this,t),this.id=t._ID++,this.showDebug=!1,this.flipHorizontal=!1,this.flipVertical=!1,this.rotation=0,this.opacity=1,this.scale=ot.One,this.origin=null,this._width=0,this._height=0,e&&(this.origin=null!==(n=e.origin)&&void 0!==n?n:this.origin,this.flipHorizontal=null!==(i=e.flipHorizontal)&&void 0!==i?i:this.flipHorizontal,this.flipVertical=null!==(r=e.flipVertical)&&void 0!==r?r:this.flipVertical,this.rotation=null!==(a=e.rotation)&&void 0!==a?a:this.rotation,this.opacity=null!==(o=e.opacity)&&void 0!==o?o:this.opacity,this.scale=null!==(s=e.scale)&&void 0!==s?s:this.scale)}return Object(y.a)(t,[{key:"cloneGraphicOptions",value:function(){return{origin:this.origin?this.origin.clone():null,flipHorizontal:this.flipHorizontal,flipVertical:this.flipVertical,rotation:this.rotation,opacity:this.opacity,scale:this.scale?this.scale.clone():null}}},{key:"width",get:function(){return Math.abs(this._width*this.scale.x)},set:function(t){this._width=t}},{key:"height",get:function(){return Math.abs(this._height*this.scale.y)},set:function(t){this._height=t}},{key:"localBounds",get:function(){return dt.fromDimension(this.width,this.height,ot.Zero)}},{key:"draw",value:function(t,e,n){this._preDraw(t,e,n),this._drawImage(t,0,0),this._postDraw(t)}},{key:"_preDraw",value:function(t,e,n){t.save(),t.translate(e,n),t.scale(Math.abs(this.scale.x),Math.abs(this.scale.y)),this._rotate(t),this._flip(t),t.opacity=t.opacity*this.opacity}},{key:"_rotate",value:function(t){var e,n=this.scale.x>0?1:-1,i=this.scale.y>0?1:-1,r=null!==(e=this.origin)&&void 0!==e?e:st(this.width/2,this.height/2);t.translate(r.x,r.y),t.rotate(this.rotation),t.scale(n,i),t.translate(-r.x,-r.y)}},{key:"_flip",value:function(t){this.flipHorizontal&&(t.translate(this.width/this.scale.x,0),t.scale(-1,1)),this.flipVertical&&(t.translate(0,this.height/this.scale.y),t.scale(1,-1))}},{key:"_postDraw",value:function(t){this.showDebug&&t.debug.drawRect(0,0,this.width,this.height),t.restore()}}]),t}();function Mt(t,e){return t&&void 0===t.__isProxy?new Proxy(t,{set:function(t,n,i){return t[n]!==i&&(t[n]=i,"string"===typeof n&&"_"!==n[0]&&e(t)),!0},get:function(t,e){return"__isProxy"===e||t[e]}}):t}function Lt(t,e){return t&&void 0===t.__isProxy?new Proxy(t,{set:function(t,n,i){return t[n]=i,"string"===typeof n&&"_"!==n[0]&&e(t),!0},get:function(t,e){return"__isProxy"===e||t[e]}}):t}Dt._ID=0;var Bt,Ft,It=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t){var i,r,a,o,s,l,u,c;Object(g.a)(this,n),(i=e.call(this,t))._dirty=!0,i._smoothing=!1,i._color=Mt(ut.Black,(function(){return i.flagDirty()})),i._lineWidth=1,i._lineDash=[],i._padding=0,t&&(i.color=null!==(r=t.color)&&void 0!==r?r:ut.Black,i.strokeColor=null===t||void 0===t?void 0:t.strokeColor,i.smoothing=null!==(a=t.smoothing)&&void 0!==a?a:i.smoothing,i.lineWidth=null!==(o=t.lineWidth)&&void 0!==o?o:i.lineWidth,i.lineDash=null!==(s=t.lineDash)&&void 0!==s?s:i.lineDash,i.padding=null!==(l=t.padding)&&void 0!==l?l:i.padding),i._bitmap=document.createElement("canvas");var h=null!==(u=null===t||void 0===t?void 0:t.width)&&void 0!==u?u:i._bitmap.width,d=null!==(c=null===t||void 0===t?void 0:t.height)&&void 0!==c?c:i._bitmap.height;i.width=Et(h),i.height=Et(d);var f=i._bitmap.getContext("2d");if(!f)throw new Error("Browser does not support 2d canvas drawing, cannot create Raster graphic");return i._ctx=f,i}return Object(y.a)(n,[{key:"cloneRasterOptions",value:function(){return{color:this.color?this.color.clone():null,strokeColor:this.strokeColor?this.strokeColor.clone():null,smoothing:this.smoothing,lineWidth:this.lineWidth,lineDash:this.lineDash,padding:this.padding}}},{key:"dirty",get:function(){return this._dirty}},{key:"flagDirty",value:function(){this._dirty=!0}},{key:"width",get:function(){return this._getTotalWidth()},set:function(t){this._bitmap.width=t,this._originalWidth=t,this.flagDirty()}},{key:"height",get:function(){return this._getTotalHeight()},set:function(t){this._bitmap.height=t,this._originalHeight=t,this.flagDirty()}},{key:"_getTotalWidth",value:function(){var t;return(null!==(t=this._originalWidth)&&void 0!==t?t:this._bitmap.width)+2*this.padding}},{key:"_getTotalHeight",value:function(){var t;return(null!==(t=this._originalHeight)&&void 0!==t?t:this._bitmap.height)+2*this.padding}},{key:"localBounds",get:function(){return dt.fromDimension(this._getTotalWidth()*this.scale.x,this._getTotalHeight()*this.scale.y,ot.Zero)}},{key:"smoothing",get:function(){return this._smoothing},set:function(t){this._smoothing=t,this.flagDirty()}},{key:"color",get:function(){return this._color},set:function(t){var e,n=this;(null===(e=this._color)||void 0===e?void 0:e.equal(t))||this.flagDirty(),this._color=Mt(t,(function(){return n.flagDirty()}))}},{key:"strokeColor",get:function(){return this._strokeColor},set:function(t){var e,n=this;(null===(e=this._strokeColor)||void 0===e?void 0:e.equal(t))||this.flagDirty(),this._strokeColor=Mt(t,(function(){return n.flagDirty()}))}},{key:"lineWidth",get:function(){return this._lineWidth},set:function(t){this._lineWidth=t,this.flagDirty()}},{key:"lineDash",get:function(){return this._lineDash},set:function(t){this._lineDash=t,this.flagDirty()}},{key:"padding",get:function(){return this._padding},set:function(t){this._padding=t,this.flagDirty()}},{key:"rasterize",value:function(){this._dirty=!1,this._ctx.clearRect(0,0,this._getTotalWidth(),this._getTotalHeight()),this._ctx.save(),this._applyRasterProperites(this._ctx),this.execute(this._ctx),this._ctx.restore(),At.load(this._bitmap,!0)}},{key:"_applyRasterProperites",value:function(t){var e,n,i;this._bitmap.width=this._getTotalWidth(),this._bitmap.height=this._getTotalHeight(),t.translate(this.padding,this.padding),t.imageSmoothingEnabled=this.smoothing,t.lineWidth=this.lineWidth,t.setLineDash(null!==(e=this.lineDash)&&void 0!==e?e:t.getLineDash()),t.strokeStyle=null===(n=this.strokeColor)||void 0===n?void 0:n.toString(),t.fillStyle=null===(i=this.color)||void 0===i?void 0:i.toString()}},{key:"_drawImage",value:function(t,e,n){this._dirty&&this.rasterize(),t.drawImage(this._bitmap,e,n)}}]),n}(Dt),zt=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t){var i;return Object(g.a)(this,n),(i=e.call(this,t))._options=t,i}return Object(y.a)(n,[{key:"ctx",get:function(){return this._ctx}},{key:"clone",value:function(){return new n(Object.assign(Object.assign(Object.assign({},this._options),this.cloneGraphicOptions()),this.cloneRasterOptions()))}},{key:"execute",value:function(t){var e,n;(null===(e=this._options)||void 0===e?void 0:e.draw)&&(null===(n=this._options)||void 0===n||n.draw(t)),this._options.cache||this.flagDirty()}}]),n}(It);(Ft=Bt||(Bt={})).Kill="kill",Ft.PreKill="prekill",Ft.PostKill="postkill",Ft.PreDraw="predraw",Ft.PostDraw="postdraw",Ft.PreDebugDraw="predebugdraw",Ft.PostDebugDraw="postdebugdraw",Ft.PreUpdate="preupdate",Ft.PostUpdate="postupdate",Ft.PreFrame="preframe",Ft.PostFrame="postframe",Ft.PreCollision="precollision",Ft.CollisionStart="collisionstart",Ft.CollisionEnd="collisionend",Ft.PostCollision="postcollision",Ft.Initialize="initialize",Ft.Activate="activate",Ft.Deactivate="deactivate",Ft.ExitViewport="exitviewport",Ft.EnterViewport="enterviewport",Ft.ExitTrigger="exit",Ft.EnterTrigger="enter",Ft.Connect="connect",Ft.Disconnect="disconnect",Ft.Button="button",Ft.Axis="axis",Ft.Subscribe="subscribe",Ft.Unsubscribe="unsubscribe",Ft.Visible="visible",Ft.Hidden="hidden",Ft.Start="start",Ft.Stop="stop",Ft.PointerUp="pointerup",Ft.PointerDown="pointerdown",Ft.PointerMove="pointermove",Ft.PointerEnter="pointerenter",Ft.PointerLeave="pointerleave",Ft.PointerCancel="pointercancel",Ft.PointerWheel="pointerwheel",Ft.Up="up",Ft.Down="down",Ft.Move="move",Ft.Enter="enter",Ft.Leave="leave",Ft.Cancel="cancel",Ft.Wheel="wheel",Ft.Press="press",Ft.Release="release",Ft.Hold="hold",Ft.PointerDragStart="pointerdragstart",Ft.PointerDragEnd="pointerdragend",Ft.PointerDragEnter="pointerdragenter",Ft.PointerDragLeave="pointerdragleave",Ft.PointerDragMove="pointerdragmove";var Nt=function(){function t(){Object(g.a)(this,t),this._bubbles=!0}return Object(y.a)(t,[{key:"bubbles",get:function(){return this._bubbles},set:function(t){this._bubbles=t}},{key:"stopPropagation",value:function(){this.bubbles=!1}}]),t}(),Ut=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t){var i;return Object(g.a)(this,n),(i=e.call(this)).target=t,i}return n}(Nt),Ht=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t){var i;return Object(g.a)(this,n),(i=e.call(this)).target=t,i}return n}(Nt),Wt=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t){var i;return Object(g.a)(this,n),(i=e.call(this)).target=t,i}return n}(Nt),Vt=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t){var i;return Object(g.a)(this,n),(i=e.call(this)).target=t,i}return n}(Nt),Gt=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t){var i;return Object(g.a)(this,n),(i=e.call(this)).target=t,i}return n}(Nt),Xt=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t,i,r){var a;return Object(g.a)(this,n),(a=e.call(this)).ctx=t,a.delta=i,a.target=r,a}return n}(Nt),qt=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t,i,r){var a;return Object(g.a)(this,n),(a=e.call(this)).ctx=t,a.delta=i,a.target=r,a}return n}(Nt),Kt=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t,i){var r;return Object(g.a)(this,n),(r=e.call(this)).ctx=t,r.target=i,r}return n}(Nt),Zt=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t,i){var r;return Object(g.a)(this,n),(r=e.call(this)).ctx=t,r.target=i,r}return n}(Nt),Qt=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t,i,r){var a;return Object(g.a)(this,n),(a=e.call(this)).engine=t,a.delta=i,a.target=r,a}return n}(Nt),Yt=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t,i,r){var a;return Object(g.a)(this,n),(a=e.call(this)).engine=t,a.delta=i,a.target=r,a}return n}(Nt),$t=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t,i){var r;return Object(g.a)(this,n),(r=e.call(this)).engine=t,r.prevStats=i,r.target=t,r}return n}(Nt),Jt=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t,i){var r;return Object(g.a)(this,n),(r=e.call(this)).engine=t,r.stats=i,r.target=t,r}return n}(Nt),te=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t,i){var r;return Object(g.a)(this,n),(r=e.call(this)).index=t,r.gamepad=i,r.target=i,r}return n}(Nt),ee=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t,i){var r;return Object(g.a)(this,n),(r=e.call(this)).index=t,r.gamepad=i,r.target=i,r}return n}(Nt),ne=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t,i,r){var a;return Object(g.a)(this,n),(a=e.call(this)).button=t,a.value=i,a.target=r,a}return n}(Nt),ie=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t,i,r){var a;return Object(g.a)(this,n),(a=e.call(this)).axis=t,a.value=i,a.target=r,a}return n}(Nt),re=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t,i){var r;return Object(g.a)(this,n),(r=e.call(this)).topic=t,r.handler=i,r}return n}(Nt),ae=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t,i){var r;return Object(g.a)(this,n),(r=e.call(this)).topic=t,r.handler=i,r}return n}(Nt),oe=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t){var i;return Object(g.a)(this,n),(i=e.call(this)).target=t,i}return n}(Nt),se=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t){var i;return Object(g.a)(this,n),(i=e.call(this)).target=t,i}return n}(Nt),le=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t,i,r,a){var o;return Object(g.a)(this,n),(o=e.call(this)).other=i,o.side=r,o.intersection=a,o.target=t,o}return n}(Nt),ue=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t,i,r,a){var o;return Object(g.a)(this,n),(o=e.call(this)).other=i,o.side=r,o.intersection=a,o.target=t,o}return Object(y.a)(n,[{key:"actor",get:function(){return this.target},set:function(t){this.target=t}}]),n}(Nt),ce=function t(e,n,i){Object(g.a)(this,t),this.target=e,this.other=n,this.contact=i},he=function t(e,n){Object(g.a)(this,t),this.target=e,this.other=n},de=function t(e,n,i,r,a){Object(g.a)(this,t),this.target=e,this.other=n,this.side=i,this.intersection=r,this.contact=a},fe=function t(e,n,i,r,a){Object(g.a)(this,t),this.target=e,this.other=n,this.side=i,this.intersection=r,this.contact=a},pe=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t,i,r){var a;return Object(g.a)(this,n),(a=e.call(this)).other=i,a.contact=r,a.target=t,a}return Object(y.a)(n,[{key:"actor",get:function(){return this.target},set:function(t){this.target=t}}]),n}(Nt),ve=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t,i){var r;return Object(g.a)(this,n),(r=e.call(this)).other=i,r.target=t,r}return Object(y.a)(n,[{key:"actor",get:function(){return this.target},set:function(t){this.target=t}}]),n}(Nt),ge=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t,i){var r;return Object(g.a)(this,n),(r=e.call(this)).engine=t,r.target=i,r}return n}(Nt),ye=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t,i){var r;return Object(g.a)(this,n),(r=e.call(this)).oldScene=t,r.target=i,r}return n}(Nt),me=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t,i){var r;return Object(g.a)(this,n),(r=e.call(this)).newScene=t,r.target=i,r}return n}(Nt),_e=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t){var i;return Object(g.a)(this,n),(i=e.call(this)).target=t,i}return n}(Nt),be=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t){var i;return Object(g.a)(this,n),(i=e.call(this)).target=t,i}return n}(Nt),we=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t,i){var r;return Object(g.a)(this,n),(r=e.call(this)).target=t,r.actor=i,r}return n}(Nt),ke=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t,i){var r;return Object(g.a)(this,n),(r=e.call(this)).target=t,r.actor=i,r}return n}(Nt),xe=function(){function t(e){Object(g.a)(this,t),this._handlers={},this._wiredEventDispatchers=[],this._target=e}return Object(y.a)(t,[{key:"clear",value:function(){this._handlers={},this._wiredEventDispatchers=[]}},{key:"emit",value:function(t,e){if(t){t=t.toLowerCase();var n,i,r=this._target;e||(e=new Nt);try{e.target||(e.target=r)}catch(a){}if(this._handlers[t])for(n=0,i=this._handlers[t].length;n<i;n++)this._handlers[t][n].call(r,e);for(n=0,i=this._wiredEventDispatchers.length;n<i;n++)this._wiredEventDispatchers[n].emit(t,e)}}},{key:"on",value:function(t,e){t=t.toLowerCase(),this._handlers[t]||(this._handlers[t]=[]),this._handlers[t].push(e),"unsubscribe"!==t&&"subscribe"!==t&&this.emit("subscribe",new re(t,e))}},{key:"off",value:function(t,e){t=t.toLowerCase();var n=this._handlers[t];if(n)if(e){var i=n.indexOf(e);this._handlers[t].splice(i,1)}else this._handlers[t].length=0;"unsubscribe"!==t&&"subscribe"!==t&&this.emit("unsubscribe",new ae(t,e))}},{key:"once",value:function(t,e){var n=this;this.on(t,(function(i){var r=i||new Nt;try{r.target=r.target||n._target}catch(a){}n.off(t,e),e.call(r.target,r)}))}},{key:"wire",value:function(t){t._wiredEventDispatchers.push(this)}},{key:"unwire",value:function(t){var e=t._wiredEventDispatchers.indexOf(this);e>-1&&t._wiredEventDispatchers.splice(e,1)}}]),t}(),Se=function(){function t(e,n){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];Object(g.a)(this,t),this.path=e,this.responseType=n,this.bustCache=i,this.data=null,this.logger=A.getInstance(),this.events=new xe(this)}return Object(y.a)(t,[{key:"isLoaded",value:function(){return null!==this.data}},{key:"_cacheBust",value:function(t){return/\?\w*=\w*/.test(t)?t+="&__="+Date.now():t+="?__="+Date.now(),t}},{key:"load",value:function(){var t=this;return new Promise((function(e,n){if(null!==t.data)return t.logger.debug("Already have data for resource",t.path),t.events.emit("complete",t.data),void e(t.data);var i=new XMLHttpRequest;i.open("GET",t.bustCache?t._cacheBust(t.path):t.path,!0),i.responseType=t.responseType,i.addEventListener("loadstart",(function(e){return t.events.emit("loadstart",e)})),i.addEventListener("progress",(function(e){return t.events.emit("progress",e)})),i.addEventListener("error",(function(e){return t.events.emit("error",e)})),i.addEventListener("load",(function(e){return t.events.emit("load",e)})),i.addEventListener("load",(function(){if(0!==i.status&&200!==i.status)return t.logger.error("Failed to load resource ",t.path," server responded with error code",i.status),t.events.emit("error",i.response),void n(new Error(i.statusText));t.data=i.response,t.events.emit("complete",t.data),t.logger.debug("Completed loading resource",t.path),e(t.data)})),i.send()}))}}]),t}(),Ce=function(t,e,n,i){var r,a=arguments.length,o=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,n,o):r(e,n))||o);return a>3&&o&&Object.defineProperty(e,n,o),o},Oe=function(){function t(){Object(g.a)(this,t)}return Object(y.a)(t,[{key:"updatePixel",value:function(t,e,n){var i=4*(t+e*n.width),r=n.data,a=(r[i+0]+r[i+1]+r[i+2])/3;r[i+0]=a,r[i+1]=a,r[i+2]=a}}]),t}();Oe=Ce([rt({message:"Grayscale will be removed in v0.26.0"})],Oe);var Ee=function(){function t(){Object(g.a)(this,t)}return Object(y.a)(t,[{key:"updatePixel",value:function(t,e,n){var i=4*(t+e*n.width),r=n.data;r[i+0]=255-r[i+0],r[i+1]=255-r[i+1],r[i+2]=255-r[i+2]}}]),t}();Ee=Ce([rt({message:"Invert will be removed in v0.26.0"})],Ee);var Ae=function(){function t(e){Object(g.a)(this,t),this.opacity=e}return Object(y.a)(t,[{key:"updatePixel",value:function(t,e,n){var i=4*(t+e*n.width),r=n.data;0!==r[i+3]&&(r[i+3]=Math.round(this.opacity*r[i+3]))}}]),t}();Ae=Ce([rt({message:"Opacity will be removed in v0.26.0"})],Ae);var Pe=function(){function t(e){Object(g.a)(this,t),this.color=e}return Object(y.a)(t,[{key:"updatePixel",value:function(t,e,n){var i=4*(t+e*n.width),r=n.data;0!==r[i+3]&&(r[i+0]=(r[i+0]+this.color.r)/2,r[i+1]=(r[i+1]+this.color.g)/2,r[i+2]=(r[i+2]+this.color.b)/2)}}]),t}();Pe=Ce([rt({message:"Colorize will be removed in v0.26.0"})],Pe);var je=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1;Object(g.a)(this,t),this.factor=e}return Object(y.a)(t,[{key:"updatePixel",value:function(t,e,n){var i=4*(t+e*n.width),r=n.data,a=ut.fromRGB(r[i+0],r[i+1],r[i+2],r[i+3]).lighten(this.factor);r[i+0]=a.r,r[i+1]=a.g,r[i+2]=a.b,r[i+3]=a.a}}]),t}();je=Ce([rt({message:"Lighten will be removed in v0.26.0"})],je);var Te=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1;Object(g.a)(this,t),this.factor=e}return Object(y.a)(t,[{key:"updatePixel",value:function(t,e,n){var i=4*(t+e*n.width),r=n.data,a=ut.fromRGB(r[i+0],r[i+1],r[i+2],r[i+3]).darken(this.factor);r[i+0]=a.r,r[i+1]=a.g,r[i+2]=a.b,r[i+3]=a.a}}]),t}();Te=Ce([rt({message:"Darken will be removed v0.26.0"})],Te);var Re=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1;Object(g.a)(this,t),this.factor=e}return Object(y.a)(t,[{key:"updatePixel",value:function(t,e,n){var i=4*(t+e*n.width),r=n.data,a=ut.fromRGB(r[i+0],r[i+1],r[i+2],r[i+3]).saturate(this.factor);r[i+0]=a.r,r[i+1]=a.g,r[i+2]=a.b,r[i+3]=a.a}}]),t}();Re=Ce([rt({message:"Saturate will be removed in v0.26.0"})],Re);var De=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1;Object(g.a)(this,t),this.factor=e}return Object(y.a)(t,[{key:"updatePixel",value:function(t,e,n){var i=4*(t+e*n.width),r=n.data,a=ut.fromRGB(r[i+0],r[i+1],r[i+2],r[i+3]).desaturate(this.factor);r[i+0]=a.r,r[i+1]=a.g,r[i+2]=a.b,r[i+3]=a.a}}]),t}();De=Ce([rt({message:"Desaturate will be removed in v0.26.0"})],De);var Me=function(){function t(e){Object(g.a)(this,t),this.color=e}return Object(y.a)(t,[{key:"updatePixel",value:function(t,e,n){var i=4*(t+e*n.width),r=n.data;0!==r[i+3]&&(r[i+0]=this.color.r,r[i+1]=this.color.g,r[i+2]=this.color.b)}}]),t}();Me=Ce([rt({message:"Fill will be removed in v0.26.0"})],Me);var Le=function(t,e,n,i){return new(n||(n=Promise))((function(r,a){function o(t){try{l(i.next(t))}catch(e){a(e)}}function s(t){try{l(i.throw(t))}catch(e){a(e)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}l((i=i.apply(t,e||[])).next())}))},Be=function(){function t(e){var n=this,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];Object(g.a)(this,t),this.path=e,this.bustCache=i,this._sprite=null,this.loaded=new Promise((function(t){n._loadedResolve=t})),this._resource=new Se(e,"blob",i),this._sprite=new Ue(this,0,0,0,0)}return Object(y.a)(t,[{key:"image",get:function(){return this.data}},{key:"isLoaded",value:function(){return!!this.data}},{key:"load",value:function(){return Le(this,void 0,void 0,c.a.mark((function t(){var e,n,i;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,this.path.includes("data:image/")){t.next=8;break}return t.next=4,this._resource.load();case 4:n=t.sent,e=URL.createObjectURL(n),t.next=9;break;case 8:e=this.path;case 9:return(i=new Image).src=e,t.next=13,i.decode();case 13:this.data=i,this.width=this._sprite.width=i.naturalWidth,this.height=this._sprite.height=i.naturalHeight,this._sprite=new Ue(this,0,0,this.width,this.height),t.next=23;break;case 19:return t.prev=19,t.t0=t.catch(0),t.next=23,Promise.reject("Error loading texture");case 23:return this._loadedResolve(this.data),t.abrupt("return",this.data);case 25:case"end":return t.stop()}}),t,this,[[0,19]])})))}},{key:"asSprite",value:function(){return this._sprite}}]),t}();function Fe(t){return function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(){var t;Object(g.a)(this,n);for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];t=e.call.apply(e,[this].concat(r));var o=r.filter((function(t){return void 0!==t})).length;return 1!==o||!r[0]||"object"!==typeof r[0]||r[0]instanceof Array||t.assign(r[0]),t}return Object(y.a)(n,[{key:"assign",value:function(t){for(var e in t)"function"!==typeof this[e]&&(this[e]=t[e])}}]),n}(t)}var Ie=function(t,e,n,i){var r,a=arguments.length,o=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,n,o):r(e,n))||o);return a>3&&o&&Object.defineProperty(e,n,o),o},ze=function(t,e,n,i){return new(n||(n=Promise))((function(r,a){function o(t){try{l(i.next(t))}catch(e){a(e)}}function s(t){try{l(i.throw(t))}catch(e){a(e)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}l((i=i.apply(t,e||[])).next())}))},Ne=function(){function t(e,n,i,r,a){Object(g.a)(this,t),this.x=0,this.y=0,this.rotation=0,this.anchor=ot.Half,this.offset=ot.Zero,this.scale=ot.One,this.drawAroundAnchor=!1,this.logger=A.getInstance(),this.flipVertical=!1,this.flipHorizontal=!1,this.effects=[],this.width=0,this.height=0,this._spriteCanvas=null,this._spriteCtx=null,this._pixelData=null,this._pixelsLoaded=!1,this._dirtyEffect=!0,this._opacity=1;var o=e;if(e&&!(e instanceof Be)&&(n=0|e.x,i=0|e.y,r=0|e.width,a=0|e.height,!(o=e.image))){throw new Error("An image texture is required to construct a sprite")}this.x=n||0,this.y=i||0,this.texture=o,this._spriteCanvas=document.createElement("canvas"),this._spriteCanvas.width=r,this._spriteCanvas.height=a,this._spriteCtx=this._spriteCanvas.getContext("2d"),this._initPixelsFromTexture(),this.width=r,this.height=a}return Object(y.a)(t,[{key:"drawWidth",get:function(){return Math.abs(this.width*this.scale.x)}},{key:"drawHeight",get:function(){return Math.abs(this.height*this.scale.y)}},{key:"_initPixelsFromTexture",value:function(){return ze(this,void 0,void 0,c.a.mark((function t(){var e;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.texture.loaded;case 3:e=t.sent,this.width=this.width||e.naturalWidth,this.height=this.height||e.naturalHeight,this._spriteCanvas.width=this._spriteCanvas.width||e.naturalWidth,this._spriteCanvas.height=this._spriteCanvas.height||e.naturalHeight,this._loadPixels(),this._dirtyEffect=!0,t.next=15;break;case 12:t.prev=12,t.t0=t.catch(0),this.logger.error("Error loading texture ",this.texture.path,t.t0);case 15:case"end":return t.stop()}}),t,this,[[0,12]])})))}},{key:"_loadPixels",value:function(){if(this.texture.isLoaded()&&!this._pixelsLoaded){var t=this.texture.image.naturalWidth||0,e=this.texture.image.naturalHeight||0;if(this.width>t&&this.logger.warn("The sprite width ".concat(this.width," exceeds the width \n                              ").concat(t," of the backing texture ").concat(this.texture.path)),this.width<=0||t<=0)throw new Error("The width of a sprite cannot be 0 or negative, sprite width: ".concat(this.width,", original width: ").concat(t));if(this.height>e&&this.logger.warn("The sprite height ".concat(this.height," exceeds the height \n                              ").concat(e," of the backing texture ").concat(this.texture.path)),this.height<=0||e<=0)throw new Error("The height of a sprite cannot be 0 or negative, sprite height: ".concat(this.height,", original height: ").concat(e));this._flushTexture(),this._pixelsLoaded=!0}}},{key:"_flushTexture",value:function(){var t=this.texture.image.naturalWidth||0,e=this.texture.image.naturalHeight||0;this._spriteCtx.clearRect(0,0,this.width,this.height),this._spriteCtx.drawImage(this.texture.image,I(this.x,0,t),I(this.y,0,e),I(this.width,0,t),I(this.height,0,e),0,0,this.width,this.height)}},{key:"opacity",value:function(t){this._opacity=t}},{key:"grayscale",value:function(){this.addEffect(new Oe)}},{key:"invert",value:function(){this.addEffect(new Ee)}},{key:"fill",value:function(t){this.addEffect(new Me(t))}},{key:"colorize",value:function(t){this.addEffect(new Pe(t))}},{key:"lighten",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1;this.addEffect(new je(t))}},{key:"darken",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1;this.addEffect(new Te(t))}},{key:"saturate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1;this.addEffect(new Re(t))}},{key:"desaturate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1;this.addEffect(new De(t))}},{key:"addEffect",value:function(t){this.effects.push(t),this.texture.isLoaded()&&this._pixelsLoaded?this._applyEffects():this._dirtyEffect=!0}},{key:"removeEffect",value:function(t){var e=-1;(e="number"===typeof t?t:this.effects.indexOf(t))<0||e>=this.effects.length||(this.effects.splice(e,1),this.texture.isLoaded()&&this._pixelsLoaded?this._applyEffects():this._dirtyEffect=!0)}},{key:"_applyEffects",value:function(){if(this._flushTexture(),this.effects.length>0){this._pixelData=this._spriteCtx.getImageData(0,0,this.width,this.height);for(var t=this.effects.length,e=0;e<t;e++)for(var n=0;n<this.height;n++)for(var i=0;i<this.width;i++)this.effects[e].updatePixel(i,n,this._pixelData);this._spriteCtx.clearRect(0,0,this.width,this.height),this._spriteCtx.putImageData(this._pixelData,0,0)}this._dirtyEffect=!1}},{key:"clearEffects",value:function(){this.effects.length=0,this._applyEffects()}},{key:"reset",value:function(){}},{key:"debugDraw",value:function(t,e,n){t.save(),t.translate(e,n),t.rotate(this.rotation);var i=this.drawWidth*this.anchor.x,r=this.drawHeight*this.anchor.y;t.strokeStyle=ut.Black.toString(),t.strokeRect(-i,-r,this.drawWidth,this.drawHeight),t.restore()}},{key:"draw",value:function(t,e,n){t instanceof CanvasRenderingContext2D?this._drawWithOptions({ctx:t,x:e,y:n}):this._drawWithOptions(t)}},{key:"_drawWithOptions",value:function(t){var e,n,i,r,a,o,s,l,u,c=Object.assign(Object.assign({},t),{rotation:null!==(e=t.rotation)&&void 0!==e?e:this.rotation,drawWidth:null!==(n=t.drawWidth)&&void 0!==n?n:this.width,drawHeight:null!==(i=t.drawHeight)&&void 0!==i?i:this.height,flipHorizontal:null!==(r=t.flipHorizontal)&&void 0!==r?r:this.flipHorizontal,flipVertical:null!==(a=t.flipVertical)&&void 0!==a?a:this.flipVertical,anchor:null!==(o=t.anchor)&&void 0!==o?o:this.anchor,offset:null!==(s=t.offset)&&void 0!==s?s:this.offset,opacity:(null!==(l=t.opacity)&&void 0!==l?l:1)*(null!==(u=this._opacity)&&void 0!==u?u:1)}),h=c.ctx,d=c.x,f=c.y,p=c.rotation,v=c.drawWidth,g=c.drawHeight,y=c.anchor,m=c.offset,_=c.opacity,b=c.flipHorizontal,w=c.flipVertical;this._dirtyEffect&&this._applyEffects();var k=v*y.x+m.x,x=g*y.y+m.y,S=this.scale.x>0?1:-1,C=this.scale.y>0?1:-1;h.save(),h.translate(d,f),h.scale(Math.abs(this.scale.x),Math.abs(this.scale.y)),this.drawAroundAnchor&&h.translate(-k,-x),h.translate(k,x),h.rotate(p),h.scale(S,C),h.translate(-k,-x),b&&(h.translate(v,0),h.scale(-1,1)),w&&(h.translate(0,g),h.scale(1,-1));var O=h.globalAlpha;h.globalAlpha=_,h.drawImage(this._spriteCanvas,0,0,this.width,this.height,0,0,this.width,this.height),h.globalAlpha=O,h.restore()}},{key:"clone",value:function(){var t=new Ue(this.texture,this.x,this.y,this.width,this.height);t.anchor=this.anchor.clone(),t.scale=this.scale.clone(),t.rotation=this.rotation,t.flipHorizontal=this.flipHorizontal,t.flipVertical=this.flipVertical;for(var e=this.effects.length,n=0;n<e;n++)t.addEffect(this.effects[n]);return t}}]),t}(),Ue=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t,i,r,a,o){return Object(g.a)(this,n),e.call(this,t,i,r,a,o)}return n}(Fe(Ne));Ue=Ie([rt({message:"Label.clearTextShadow will be removed in v0.26.0",alternateMethod:"Use Label.font.shadow"})],Ue);var He,We,Ve,Ge,Xe,qe=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t){var i,r,a;Object(g.a)(this,n),(i=e.call(this,t)).image=t.image;var o=t.width,s=t.height;return i.sourceView=null!==(r=t.sourceView)&&void 0!==r?r:{x:0,y:0,width:null!==o&&void 0!==o?o:0,height:null!==s&&void 0!==s?s:0},i.destSize=null!==(a=t.destSize)&&void 0!==a?a:{width:null!==o&&void 0!==o?o:0,height:null!==s&&void 0!==s?s:0},i._updateSpriteDimensions(),i.image.ready.then((function(){i._updateSpriteDimensions()})),i}return Object(y.a)(n,[{key:"_updateSpriteDimensions",value:function(){var t,e,n,i,r,a,o=this.image,s=o.width,l=o.height;this.sourceView.width=(null===(t=this.sourceView)||void 0===t?void 0:t.width)||s,this.sourceView.height=(null===(e=this.sourceView)||void 0===e?void 0:e.height)||l,this.destSize.width=(null===(n=this.destSize)||void 0===n?void 0:n.width)||(null===(i=this.sourceView)||void 0===i?void 0:i.width)||s,this.destSize.height=(null===(r=this.destSize)||void 0===r?void 0:r.height)||(null===(a=this.sourceView)||void 0===a?void 0:a.height)||l,this.width=Math.ceil(this.destSize.width),this.height=Math.ceil(this.destSize.height)}},{key:"_preDraw",value:function(t,e,i){this.image.isLoaded()&&this._updateSpriteDimensions(),Object(s.a)(Object(l.a)(n.prototype),"_preDraw",this).call(this,t,e,i)}},{key:"_drawImage",value:function(t,e,n){this.image.isLoaded()&&(this._updateSpriteDimensions(),t.drawImage(this.image.image,this.sourceView.x,this.sourceView.y,this.sourceView.width,this.sourceView.height,e,n,this.destSize.width,this.destSize.height))}},{key:"clone",value:function(){return new n(Object.assign({image:this.image,sourceView:Object.assign({},this.sourceView),destSize:Object.assign({},this.destSize)},this.cloneGraphicOptions()))}}],[{key:"from",value:function(t){return new n({image:t})}},{key:"fromLegacySprite",value:function(t){var e=t.texture;return new n({image:Ze.fromLegacyTexture(e),sourceView:{x:t.x,y:t.y,width:t.width,height:t.height}})}},{key:"toLegacySprite",value:function(t){var e=t.image,n=new Be(e.path);return n.data=e.image,new Ue(n,t.sourceView.x,t.sourceView.y,t.sourceView.width,t.sourceView.height)}}]),n}(Dt),Ke=function(t,e,n,i){return new(n||(n=Promise))((function(r,a){function o(t){try{l(i.next(t))}catch(e){a(e)}}function s(t){try{l(i.throw(t))}catch(e){a(e)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}l((i=i.apply(t,e||[])).next())}))},Ze=function(){function t(e){var n=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Object(g.a)(this,t),this.path=e,this._logger=A.getInstance(),this.data=new Image,this._resource=new Se(e,"blob",i),(e.endsWith(".svg")||e.endsWith(".gif"))&&this._logger.warn("Image type is not fully supported, you may have mixed results ".concat(e,". Fully supported: jpg, bmp, and png")),this.ready=new Promise((function(t){n._loadedResolve=t}))}return Object(y.a)(t,[{key:"width",get:function(){return this.image.naturalWidth}},{key:"height",get:function(){return this.image.naturalHeight}},{key:"isLoaded",value:function(){return!!this.data.src}},{key:"image",get:function(){return this.data}},{key:"load",value:function(){return Ke(this,void 0,void 0,c.a.mark((function t(){var e,n,i;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.isLoaded()){t.next=2;break}return t.abrupt("return",this.data);case 2:if(t.prev=2,this.path.includes("data:image/")){t.next=10;break}return t.next=6,this._resource.load();case 6:n=t.sent,e=URL.createObjectURL(n),t.next=11;break;case 10:e=this.path;case 11:return(i=new Image).src=e,t.next=15,i.decode();case 15:this.data=i,t.next=21;break;case 18:throw t.prev=18,t.t0=t.catch(2),"Error loading ImageSource from path '".concat(this.path,"' with error [").concat(t.t0.message,"]");case 21:return this._loadedResolve(this.data),t.abrupt("return",this.data);case 23:case"end":return t.stop()}}),t,this,[[2,18]])})))}},{key:"toSprite",value:function(){return qe.from(this)}},{key:"unload",value:function(){this.data=new Image}}],[{key:"fromLegacyTexture",value:function(e){var n=new t(e.path);return e.isLoaded()?n.data=e.data:e.loaded.then((function(){n.data=e.data})),n}}]),t}(),Qe=function(t,e,n,i){var r,a=arguments.length,o=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,n,o):r(e,n))||o);return a>3&&o&&Object.defineProperty(e,n,o),o},Ye=function(){function t(e,n,i,r){Object(g.a)(this,t),this.sprites=[],this.currentFrame=0,this._timeLeftInFrame=0,this._idempotencyToken=-1,this.anchor=ot.Zero,this.rotation=0,this.scale=ot.One,this.loop=!0,this.freezeFrame=-1,this.flipVertical=!1,this.flipHorizontal=!1,this.drawWidth=0,this.drawHeight=0,this.width=0,this.height=0,this._opacity=1;var a=e;if(e&&!(e instanceof Ba)){var o=e;a=o.engine,n=o.sprites,i=o.speed,r=o.loop}this.sprites=n,this.speed=i,this._engine=a,this._timeLeftInFrame=this.speed,null!=r&&(this.loop=r),n&&n[0]&&(this.drawHeight=n[0]?n[0].drawHeight:0,this.drawWidth=n[0]?n[0].drawWidth:0,this.width=n[0]?n[0].width:0,this.height=n[0]?n[0].height:0,this.freezeFrame=n.length-1)}return Object(y.a)(t,[{key:"opacity",value:function(t){this._opacity=t}},{key:"grayscale",value:function(){this.addEffect(new Oe)}},{key:"invert",value:function(){this.addEffect(new Ee)}},{key:"fill",value:function(t){this.addEffect(new Me(t))}},{key:"colorize",value:function(t){this.addEffect(new Pe(t))}},{key:"lighten",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1;this.addEffect(new je(t))}},{key:"darken",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1;this.addEffect(new Te(t))}},{key:"saturate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1;this.addEffect(new Re(t))}},{key:"desaturate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1;this.addEffect(new De(t))}},{key:"addEffect",value:function(t){for(var e in this.sprites)this.sprites[e].addEffect(t)}},{key:"removeEffect",value:function(t){for(var e in this.sprites)this.sprites[e].removeEffect(t)}},{key:"clearEffects",value:function(){for(var t in this.sprites)this.sprites[t].clearEffects()}},{key:"_setAnchor",value:function(t){for(var e in this.sprites)this.sprites[e].anchor.setTo(t.x,t.y)}},{key:"_setRotation",value:function(t){for(var e in this.sprites)this.sprites[e].rotation=t}},{key:"_setScale",value:function(t){for(var e in this.sprites)this.sprites[e].scale=t}},{key:"reset",value:function(){this.currentFrame=0}},{key:"isDone",value:function(){return!this.loop&&this.currentFrame>=this.sprites.length}},{key:"tick",value:function(t,e){if(this._idempotencyToken!==e){this._idempotencyToken=e,this._timeLeftInFrame-=t,this._timeLeftInFrame<=0&&(this.currentFrame=this.loop?(this.currentFrame+1)%this.sprites.length:this.currentFrame+1,this._timeLeftInFrame=this.speed),this._updateValues();var n=this.sprites[this.currentFrame];n&&(this.width=n.width,this.height=n.height,this.drawWidth=n.drawWidth,this.drawHeight=n.drawHeight)}}},{key:"_updateValues",value:function(){this._setAnchor(this.anchor),this._setRotation(this.rotation),this._setScale(this.scale)}},{key:"skip",value:function(t){this.currentFrame=(this.currentFrame+t)%this.sprites.length}},{key:"draw",value:function(t,e,n){t instanceof CanvasRenderingContext2D?this._drawWithOptions({ctx:t,x:e,y:n}):this._drawWithOptions(t)}},{key:"_drawWithOptions",value:function(t){var e,n,i,r,a,o,s,l,u,c=Object.assign(Object.assign({},t),{rotation:null!==(e=t.rotation)&&void 0!==e?e:this.rotation,drawWidth:null!==(n=t.drawWidth)&&void 0!==n?n:this.drawWidth,drawHeight:null!==(i=t.drawHeight)&&void 0!==i?i:this.drawHeight,flipHorizontal:null!==(r=t.flipHorizontal)&&void 0!==r?r:this.flipHorizontal,flipVertical:null!==(a=t.flipVertical)&&void 0!==a?a:this.flipVertical,anchor:null!==(o=t.anchor)&&void 0!==o?o:this.anchor,opacity:(null!==(s=t.opacity)&&void 0!==s?s:1)*(null!==(l=this._opacity)&&void 0!==l?l:1)});this._updateValues(),this.currentFrame<this.sprites.length&&(u=this.sprites[this.currentFrame]).draw(c),-1!==this.freezeFrame&&this.currentFrame>=this.sprites.length&&(u=this.sprites[I(this.freezeFrame,0,this.sprites.length-1)]).draw(c),u&&(this.drawWidth=u.drawWidth,this.drawHeight=u.drawHeight)}},{key:"play",value:function(t,e){this.reset(),this._engine.playAnimation(this,t,e)}}]),t}(),$e=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t,i,r,a){return Object(g.a)(this,n),e.call(this,t,i,r,a)}return n}(Fe(Ye));$e=Qe([rt({message:"Animation will be removed in v0.26.0",alternateMethod:"Use Graphics.Animation"})],$e),function(t){t.Em="em",t.Rem="rem",t.Px="px",t.Pt="pt",t.Percent="%"}(He||(He={})),function(t){t.Left="left",t.Right="right",t.Center="center",t.Start="start",t.End="end"}(We||(We={})),function(t){t.Top="top",t.Hanging="hanging",t.Middle="middle",t.Alphabetic="alphabetic",t.Ideographic="ideographic",t.Bottom="bottom"}(Ve||(Ve={})),function(t){t.Normal="normal",t.Italic="italic",t.Oblique="oblique"}(Ge||(Ge={})),function(t){t.LeftToRight="ltr",t.RightToLeft="rtl"}(Xe||(Xe={}));var Je=function(t,e,n,i){var r,a=arguments.length,o=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,n,o):r(e,n))||o);return a>3&&o&&Object.defineProperty(e,n,o),o},tn=function(){function t(e,n,i,r,a,o){Object(g.a)(this,t),this._sprites=[],this._image=null,this._columns=0,this._rows=0,this._spWidth=0,this._spHeight=0,this._spacing=0;var s=!1;if(e instanceof Array?this._sprites=e:(!e||e instanceof Be?(this._image=e,this._columns=n,this._rows=i,this._spWidth=r,this._spHeight=a,this._spacing=o||0):(this._columns=e.columns,this._rows=e.rows,this._spWidth=e.spWidth,this._spHeight=e.spHeight,this._image=e.image,this._spacing=e.spacing||0),this._sprites=new Array(this._columns*this._rows),s=!0),this.image instanceof Be){var l=!1,u=!1;if(this.image.isLoaded()){if(l=this.spWidth*this.columns>this.image.image.naturalWidth,u=this.spHeight*this.rows>this.image.image.naturalHeight,l)throw new RangeError("SpriteSheet specified is wider, "+"".concat(this.columns," cols x ").concat(this.spWidth," pixels > ").concat(this.image.image.naturalWidth," ")+"pixels than image width");if(u)throw new RangeError("SpriteSheet specified is taller, "+"".concat(this.rows," rows x ").concat(this.spHeight," pixels > ").concat(this.image.image.naturalHeight," ")+"pixels than image height")}}if(s)for(var c=this.getSpacingDimensions(),h=0;h<this.rows;h++)for(var d=0;d<this.columns;d++)this._sprites[d+h*this.columns]=new Ue(this.image,d*this.spWidth+c.margin*d+c.left,h*this.spHeight+c.margin*h+c.top,this.spWidth,this.spHeight)}return Object(y.a)(t,[{key:"spacing",get:function(){return this._spacing}},{key:"sprites",get:function(){return d(this._sprites)}},{key:"image",get:function(){return this._image}},{key:"columns",get:function(){return this._columns}},{key:"rows",get:function(){return this._rows}},{key:"spWidth",get:function(){return this._spWidth}},{key:"spHeight",get:function(){return this._spHeight}},{key:"getSpacingDimensions",value:function(){var t,e,n;return"number"===typeof this.spacing?{left:this.spacing,top:this.spacing,margin:this.spacing}:{left:null!==(t=this.spacing.left)&&void 0!==t?t:0,top:null!==(e=this.spacing.top)&&void 0!==e?e:0,margin:null!==(n=this.spacing.margin)&&void 0!==n?n:0}}},{key:"getAnimationByIndices",value:function(t,e,n){var i=this,r=e.map((function(t){return i.sprites[t]}));return r=r.map((function(t){return t.clone()})),new $e(t,r,n)}},{key:"getAnimationBetween",value:function(t,e,n,i){var r=this.sprites.slice(e,n);return r=r.map((function(t){return t.clone()})),new $e(t,r,i)}},{key:"getAnimationForAll",value:function(t,e){var n=this.sprites.map((function(t){return t.clone()}));return new $e(t,n,e)}},{key:"getSprite",value:function(t){if(t>=0&&t<this.sprites.length)return this.sprites[t];throw new Error("Invalid index: "+t)}},{key:"getAnimationByCoords",value:function(t,e,n){for(var i=0,r=0,a=new Array(e.length),o=0;o<e.length;o++){var s=e[o];s.image=s.image||this.image,i=Math.max(i,s.drawWidth),r=Math.max(r,s.drawHeight),a[o]=new Ue(s)}var l=new $e(t,a,n);return l.drawWidth=i,l.drawHeight=r,l}}]),t}(),en=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t,i,r,a,o,s,l,u){var c;return Object(g.a)(this,n),(c=e.call(this,t instanceof Be?{image:t,spWidth:s,spHeight:l,rows:o,columns:a,spacing:u||0}:t))._currentColor=ut.Black,c._currentOpacity=1,c._spriteRecord={},c._textShadowOn=!1,c._textShadowDirty=!0,c._textShadowColor=ut.Black,c._textShadowSprites={},c._shadowOffsetX=5,c._shadowOffsetY=5,!t||t instanceof Be||(i=t.alphabet,r=t.caseInsensitive),c.alphabet=i,c.caseInsensitive=r,c._spriteRecord=c.getTextSprites(),c}return Object(y.a)(n,[{key:"getTextSprites",value:function(){for(var t={},e=0;e<this.alphabet.length;e++){var n=this.alphabet[e];this.caseInsensitive&&(n=n.toLowerCase()),t[n]=this.sprites[e].clone()}return t}},{key:"setTextShadow",value:function(t,e,n){for(var i in this._textShadowOn=!0,this._shadowOffsetX=t,this._shadowOffsetY=e,this._textShadowColor=n.clone(),this._textShadowDirty=!0,this._spriteRecord)this._textShadowSprites[i]=this._spriteRecord[i].clone()}},{key:"useTextShadow",value:function(t){this._textShadowOn=t,t&&this.setTextShadow(5,5,this._textShadowColor)}},{key:"draw",value:function(t,e,n,i,r){if(r=this._parseOptions(r),this._currentColor.toString()!==r.color.toString()||this._currentOpacity!==r.opacity)for(var a in this._currentOpacity=r.opacity,this._currentColor=r.color,this._spriteRecord)this._spriteRecord[a].clearEffects(),this._spriteRecord[a].fill(r.color),this._spriteRecord[a].opacity(r.opacity);if(this._textShadowOn&&this._textShadowDirty&&this._textShadowColor){for(var o in this._textShadowSprites)this._textShadowSprites[o].clearEffects(),this._textShadowSprites[o].addEffect(new Me(this._textShadowColor.clone()));this._textShadowDirty=!1}var s=this.sprites[0],l=s.height,u=r.fontSize/l,c=e.length*s.width*u+e.length*r.letterSpacing,h=n;r.textAlign===We.Left||r.textAlign===We.Start?h=n:r.textAlign===We.Right||r.textAlign===We.End?h=n-c:r.textAlign===We.Center&&(h=n-c/2);var d=i-l*u;r.baseAlign===Ve.Top||r.baseAlign===Ve.Hanging?d=i:r.baseAlign===Ve.Ideographic||r.baseAlign===Ve.Bottom||r.baseAlign===Ve.Alphabetic?d=i-l*u:r.baseAlign===Ve.Middle&&(d=i-l*u/2);for(var f=0;f<e.length;f++){var p=e[f];this.caseInsensitive&&(p=p.toLowerCase());try{this._textShadowOn&&(this._textShadowSprites[p].drawAroundAnchor=!1,this._textShadowSprites[p].scale=st(u,u),this._textShadowSprites[p].draw(t,h+this._shadowOffsetX,d+this._shadowOffsetY));var v=this._spriteRecord[p];v.drawAroundAnchor=!1,v.scale=st(u,u),v.draw(t,h,d),h+=v.drawWidth+r.letterSpacing}catch(g){A.getInstance().error("SpriteFont Error drawing char ".concat(p))}}}},{key:"_parseOptions",value:function(t){return{fontSize:t.fontSize||10,letterSpacing:t.letterSpacing||0,color:t.color||ut.Black,textAlign:void 0===typeof t.textAlign?We.Left:t.textAlign,baseAlign:void 0===typeof t.baseAlign?Ve.Bottom:t.baseAlign,maxWidth:t.maxWidth||-1,opacity:t.opacity||0}}}]),n}(tn);en=Je([rt({message:"SpriteSheet will be removed in v0.26.0",alternateMethod:"Use Graphics.SpriteSheet"})],en);var nn,rn=function(){function t(e){Object(g.a)(this,t),this._logger=A.getInstance(),this.sprites=[];var n=e.sprites,i=e.rows,r=e.columns;this.sprites=n,this.rows=null!==i&&void 0!==i?i:1,this.columns=null!==r&&void 0!==r?r:this.sprites.length}return Object(y.a)(t,[{key:"getSprite",value:function(t,e){if(t>=this.columns||t<0)return this._logger.warn("No sprite exists in the SpriteSheet at (".concat(t,", ").concat(e,"), x: ").concat(t," should be between 0 and ").concat(this.columns-1)),null;if(e>=this.rows||e<0)return this._logger.warn("No sprite exists in the SpriteSheet at (".concat(t,", ").concat(e,"), y: ").concat(e," should be between 0 and ").concat(this.rows-1)),null;var n=t+e*this.columns;return this.sprites[n]}}],[{key:"fromLegacySpriteSheet",value:function(e){return new t({sprites:e.sprites.map((function(t){return qe.fromLegacySprite(t)}))})}},{key:"toLegacySpriteSheet",value:function(t){var e=t.sprites.map((function(t){return qe.toLegacySprite(t)}));return new tn(e)}},{key:"fromImageSource",value:function(e){var n,i=[];e.spacing=null!==(n=e.spacing)&&void 0!==n?n:{};for(var r=e.image,a=e.grid,o=a.rows,s=a.columns,l=a.spriteWidth,u=a.spriteHeight,c=e.spacing,h=c.originOffset,d=c.margin,f=Object.assign({x:0,y:0},h),p=Object.assign({x:0,y:0},d),v=0;v<s;v++)for(var g=0;g<o;g++)i[v+g*s]=new qe({image:r,sourceView:{x:v*l+p.x*v+f.x,y:g*u+p.y*g+f.y,width:l,height:u},destSize:{height:u,width:l}});return new t({sprites:i,rows:o,columns:s})}}]),t}(),an=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t){var i;Object(g.a)(this,n),(i=e.call(this,t))._text="",i._dirty=!0,i.alphabet="",i.shadow=null,i.caseInsensitive=!1,i.spacing=0,i._logger=A.getInstance(),i._sprites=[];var r=t.alphabet,a=t.spriteSheet,o=t.caseInsensitive,s=t.spacing,l=t.shadow;return i.alphabet=r,i.spriteSheet=a,i.caseInsensitive=null!==o&&void 0!==o?o:i.caseInsensitive,i.spacing=null!==s&&void 0!==s?s:i.spacing,i.shadow=null!==l&&void 0!==l?l:i.shadow,i.spriteSheet.sprites[0].image.ready.then((function(){i._updateDimensions()})),i}return Object(y.a)(n,[{key:"_getCharacterSprites",value:function(t){if(!this._dirty)return this._sprites;for(var e=[],n=this.caseInsensitive?t.toLocaleLowerCase():t,i=this.caseInsensitive?this.alphabet.toLocaleLowerCase():this.alphabet,r=0;r<n.length;r++){var a=n[r],o=i.indexOf(a);-1===o&&(o=0,this._logger.warn("SpriteFont - Cannot find letter '".concat(a,"' in configured alphabet '").concat(i,"'")));var s=this.spriteSheet.sprites[o];s?e.push(s):this._logger.warn("SpriteFont - Cannot find sprite for '".concat(a,"' at index '").concat(o,"' in configured SpriteSheet"))}return this._dirty=!1,this._sprites=e}},{key:"_updateDimensions",value:function(){var t,e=this._getCharacterSprites(this._text),n=0,i=0,r=Object(f.a)(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;n+=a.width+this.spacing,i=Math.max(i,a.height)}}catch(o){r.e(o)}finally{r.f()}this.width=n,this.height=i}},{key:"updateText",value:function(t){this._text!==t&&(this._dirty=!0,this._text=t,this._updateDimensions())}},{key:"_preDraw",value:function(t,e,i){this._updateDimensions(),Object(s.a)(Object(l.a)(n.prototype),"_preDraw",this).call(this,t,e,i)}},{key:"_drawImage",value:function(t,e,n){var i,r=0,a=Object(f.a)(this._getCharacterSprites(this._text));try{for(a.s();!(i=a.n()).done;){var o=i.value;o.draw(t,e+r,n),r+=o.width+this.spacing}}catch(s){a.e(s)}finally{a.f()}}},{key:"render",value:function(t,e,n,i){this._text!==e&&(this._dirty=!0,this._text=e),this.shadow&&(t.save(),t.translate(this.shadow.offset.x,this.shadow.offset.y),this.draw(t,n,i),t.restore()),this.draw(t,n,i)}},{key:"clone",value:function(){return new n({alphabet:this.alphabet,spriteSheet:this.spriteSheet,spacing:this.spacing})}}],[{key:"fromLegacySpriteFont",value:function(t){var e=t.sprites.map(qe.fromLegacySprite);return new n({alphabet:t.alphabet,spacing:0,caseInsensitive:t.caseInsensitive,spriteSheet:new rn({sprites:e})})}}]),n}(Dt),on=function(){function t(){Object(g.a)(this,t),this.fontSheet="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAAwCAYAAAD+f6R/AAAAAXNSR0IArs4c6QAABcJJREFUeJztnemu7CgMhGE07//KmT9NhrAFVzkQndQntXRP3/bCZkwCSQhCCCGEEEIIIYQQQog/TRz953Ecx/nDGIe/vdNhlc9tIz605Fk/ZmWfsO1hn9Gxuv1KHbvb3iL/VN+d1WORbyr7yR/5b9M4vjNeqko6jPJHq5wGHU151o9J2Udse9hndCxuv0rH7rY3yD/Wdyf13MrnQeDfkZIUSGKM4ff3cWN82pEZuTyQGX2IxeyR63va//8VNCYCq+1yEkLtWyagXv1P1r1H+110gP3PzT4gT8uW/mdQ8mUG8E9DqOz4MS9ICKGbXpS2BpnIrRzYeS96cll08INlCMl2/glzdcfazuuPqQO03lmqrBHsf272Q6NODXj6zzZIJd/LAHYTg3Mays5gBi7ZR27fOgs0yj8rm36DLMFiPgkAdXHKOwUQeMCQ/adSh/qBQrT/tPxbAwA9+DOZEILPAATSuHMgTv7+Auk/df2lHPCZLvMSLJe34LkEQ9PwXF1SRTllMYgvIaflqyVAjLGbsiCDcOK76jflxZ+sINPyROc5071yKWK5CJTV3dMp6+tBlyCtNlhAq/+XbWoBDcRNXYBMzD4VvQygSuPYC2jGGaSSOxXfy3dTUEsanIvNeepm38N/hssSALTPZnAXfwIYRJn2b7UBcw0FKX+nDdAMpm2j9WVnxrUa7TXaVAca/B+TgaAVh6R/rH0P/5m01dt/RLYViJn+w/bhVX2P7f/duqom5qb02pRLCLGIMgBU1wCEEN9BAUCID6MAIMSHUQAQ4sMoAAjxYRQAhPgwd1uB0fuZ7H3cnn2P+9mr/Pe4B8/eB/fwP4eRtci/0f6OfTCPt/9oHwC6G6y19RHZDumxmwzR4eE/s/2Tte/q/+XLdc9DeJ19diesQc/j7Z8fCe4tAS4CxZ7sp7eiJi7HiZmjmOTGJs+93CbS3nP0XIPH3vW8/qz6QPnX2QdsV/1uw/iZYvg8ACeHd28rpPzfNfhL+7vkw/4Ou9s+Onhbv91elpKZ48Dl6bzpwwibHigRArf+Ptk9+L3Y1Q5OB4LgCeSBw1iuB3GeJh1/HrX/zF0A9Mk+u45zMkc3r4rWPomma5+p/514LB+Zo93MErJ1JHxXPzByGa/licRYVKbpeQCoQ6Q8yxuCwJF9IPsoDkHAo/3Tx26cvA4EtJ/n04w8QOq/mrR7ddfLAC5BYFNlVI/0CnOVUflOpvJUQMx9AIMIW/nWDM67/qw0+95v9goBqD9j+72u/KD9U89IbnQbMIR2Zbneh5zUY7Hdk7XIP3UffVb+r+wDYAZLq+1n1+C7y3/ny2r7p5yeByDEh9HzAIQQJwoAQnwYBQAhPowCgBBjoNu3hNxSFACE6INuKvPajPZ4EFEAEKINcybGYzOd247WEd3TgA2jlmjEyrd+j9hvfVbD2PWQ3ZmGlu2HyO8og8eBuNUvNYWoDgMVpwHTJoLWdz1Y+ZYOy5uF7t6PPruZxANrud1lQXkP0jsGz/Yz+vGGMuygFyhSPcJnc1pMnQZElc+cRnoAlxdTvoDuK7puqF7uCQy+3fyFMiA02/vJQHh7DQDogMPTSGFNA56HTzbZ9yAfBOb1Zyo3qGM3MfMZ3f76huXf6xlmAHknMlLNXsBBBvbljIz9Uyz5Y5TzIBLR/qy/rNyrZ8+L/0BZ0m+tgXD0OK5XZxC/9P7I/g4hVFvzXf1/6i5A7+3AlijMPBLMZfCvuAp7A9rY56ApHitmLQc7c8bOv6ftAxlM9Xp35nkEK7nJetBsaMhtAAAuOLQGXwhh2dXQnn1rZ/a42BI3dL7L+jkFAbQddwdA9Ah35yMKhgEgVT46EFh5D4jz+OgavNKxeBCd1wDSJ/97oR8eoJkLi9t9/BDgDHTJ5NE7Dnzechh914OVv9M1K9PCqsfqb88XVg9qN9lm6nG176UPu+zn17GOxuO0vOWEEC/j+LFKTgghlvEfYJaLS+SA2O0AAAAASUVORK5CYII=",this.size=16,this.load()}return Object(y.a)(t,[{key:"load",value:function(){var t=this;return this._imageSource=new Ze(this.fontSheet),this._imageSource.load().then((function(){t._spriteSheet=rn.fromImageSource({image:t._imageSource,grid:{rows:3,columns:16,spriteWidth:16,spriteHeight:16}}),t._spriteFont=new an({alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ,!'&.\"?-()+ ",caseInsensitive:!0,spriteSheet:t._spriteSheet,spacing:-6})}))}},{key:"write",value:function(t,e,n){this._imageSource.isLoaded()&&this._spriteFont.render(t,e,n.x,n.y)}}]),t}(),sn=function(){function t(e){Object(g.a)(this,t),this._webglCtx=e,this._debugText=new on}return Object(y.a)(t,[{key:"drawRect",value:function(t,e,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{color:ut.Black};this.drawLine(st(t,e),st(t+n,e),Object.assign({},r)),this.drawLine(st(t+n,e),st(t+n,e+i),Object.assign({},r)),this.drawLine(st(t+n,e+i),st(t,e+i),Object.assign({},r)),this.drawLine(st(t,e+i),st(t,e),Object.assign({},r))}},{key:"drawLine",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{color:ut.Black};this._webglCtx.__lineRenderer.addLine(t,e,n.color)}},{key:"drawPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{color:ut.Black,size:5};this._webglCtx.__pointRenderer.addPoint(t,e.color,e.size)}},{key:"drawText",value:function(t,e){this._debugText.write(this._webglCtx,t,e)}}]),t}(),ln=function(){function t(e){Object(g.a)(this,t),this._transform=new vt,this._state=new gt,this.snapToPixel=!0,this.smoothing=!1,this.backgroundColor=ut.ExcaliburBlue,this.debug=new sn(this);var n=e.canvasElement,i=e.enableTransparency,r=e.smoothing,a=e.snapToPixel,o=e.backgroundColor;this.__gl=n.getContext("webgl",{antialias:null!==r&&void 0!==r?r:this.smoothing,premultipliedAlpha:!1,alpha:null===i||void 0===i||i,depth:!0,powerPreference:"high-performance"}),this.snapToPixel=null!==a&&void 0!==a?a:this.snapToPixel,this.smoothing=null!==r&&void 0!==r?r:this.smoothing,this.backgroundColor=null!==o&&void 0!==o?o:this.backgroundColor,this._init()}return Object(y.a)(t,[{key:"opacity",get:function(){return this._state.current.opacity},set:function(t){this._state.current.opacity=t}},{key:"width",get:function(){return this.__gl.canvas.width}},{key:"height",get:function(){return this.__gl.canvas.height}},{key:"checkIfResolutionSupported",value:function(t){var e=this.__gl,n=e.getParameter(e.MAX_TEXTURE_SIZE)/4,i=!0;return(t.width>n||t.height>n)&&(i=!1),i}},{key:"_init",value:function(){var t=this.__gl;this._ortho=pt.ortho(0,t.canvas.width,t.canvas.height,0,400,-400),t.viewport(0,0,t.canvas.width,t.canvas.height),t.clearColor(this.backgroundColor.r/255,this.backgroundColor.g/255,this.backgroundColor.b/255,this.backgroundColor.a),t.clear(t.COLOR_BUFFER_BIT),t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA),this.__pointRenderer=new Rt(t,{matrix:this._ortho,transform:this._transform,state:this._state}),this.__lineRenderer=new St(t,{matrix:this._ortho,transform:this._transform,state:this._state}),this.__imageRenderer=new jt(t,{matrix:this._ortho,transform:this._transform,state:this._state}),this._canvas=new zt({width:t.canvas.width,height:t.canvas.height}),this.__ctx=this._canvas.ctx}},{key:"resetTransform",value:function(){this._transform.current=pt.identity()}},{key:"updateViewport",value:function(){var t=this.__gl;this._ortho=this._ortho=pt.ortho(0,t.canvas.width,t.canvas.height,0,400,-400),this.__pointRenderer.shader.addUniformMatrix("u_matrix",this._ortho.data),this.__lineRenderer.shader.addUniformMatrix("u_matrix",this._ortho.data),this.__imageRenderer.shader.addUniformMatrix("u_matrix",this._ortho.data),this._canvas.width=t.canvas.width,this._canvas.height=t.canvas.height}},{key:"drawImage",value:function(t,e,n,i,r,a,o,s,l){if(0!==i&&0!==r&&0!==s&&0!==l&&0!==t.width&&0!==t.height)return t?void this.__imageRenderer.addImage(t,e,n,i,r,a,o,s,l):(A.getInstance().warn("Cannot draw a null or undefined image"),void(console.trace&&console.trace()))}},{key:"drawLine",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;this.__imageRenderer.addLine(n,t,e,i)}},{key:"drawRectangle",value:function(t,e,n,i){this.__imageRenderer.addRectangle(i,t,e,n)}},{key:"drawCircle",value:function(t,e,n){this.__imageRenderer.addCircle(t,e,n)}},{key:"save",value:function(){this._transform.save(),this._state.save()}},{key:"restore",value:function(){this._transform.restore(),this._state.restore()}},{key:"translate",value:function(t,e){this._transform.translate(this.snapToPixel?~~t:t,this.snapToPixel?~~e:e)}},{key:"rotate",value:function(t){this._transform.rotate(t)}},{key:"scale",value:function(t,e){this._transform.scale(t,e)}},{key:"transform",value:function(t){this._transform.current=t}},{key:"clear",value:function(){var t=this.__gl;t.clearColor(this.backgroundColor.r/255,this.backgroundColor.g/255,this.backgroundColor.b/255,this.backgroundColor.a),t.clear(t.COLOR_BUFFER_BIT),_t.clear()}},{key:"flush",value:function(){var t=this.__gl;t.viewport(0,0,t.canvas.width,t.canvas.height),this.__imageRenderer.render(),this.__lineRenderer.render(),this.__pointRenderer.render()}}]),t}();!function(t){t.Fixed="Fixed",t.FitScreen="FitScreen",t.FillScreen="FillScreen",t.FitContainer="FitContainer",t.FillContainer="FillContainer",t.Position="Position"}(nn||(nn={}));var un=function(){function t(){Object(g.a)(this,t)}return Object(y.a)(t,null,[{key:"SVGA",get:function(){return{width:800,height:600}}},{key:"Standard",get:function(){return{width:1920,height:1080}}},{key:"Atari2600",get:function(){return{width:160,height:192}}},{key:"GameBoy",get:function(){return{width:160,height:144}}},{key:"GameBoyAdvance",get:function(){return{width:240,height:160}}},{key:"NintendoDS",get:function(){return{width:256,height:192}}},{key:"NES",get:function(){return{width:256,height:224}}},{key:"SNES",get:function(){return{width:256,height:244}}}]),t}(),cn=function(){function t(e){var n,i,r,a=this;Object(g.a)(this,t),this._antialiasing=!0,this._resolutionStack=[],this._viewportStack=[],this._pixelRatioOverride=null,this._isFullScreen=!1,this._isDisposed=!1,this._logger=A.getInstance(),this._fullscreenChangeHandler=function(){a._isFullScreen=!a._isFullScreen,a._logger.debug("Fullscreen Change",a._isFullScreen)},this._pixelRatioChangeHandler=function(){a._logger.debug("Pixel Ratio Change",window.devicePixelRatio),a._devicePixelRatio=a._calculateDevicePixelRatio(),a.applyResolutionAndViewport()},this._resizeHandler=function(){var t=a.parent;a._logger.debug("View port resized"),a._setResolutionAndViewportByDisplayMode(t),a.applyResolutionAndViewport()},this._devicePixelRatio=this._calculateDevicePixelRatio(),this._alreadyWarned=!1,this.viewport=e.viewport,this.resolution=null!==(n=e.resolution)&&void 0!==n?n:Object.assign({},this.viewport),this._displayMode=null!==(i=e.displayMode)&&void 0!==i?i:nn.Fixed,this._canvas=e.canvas,this._ctx=e.context,this._antialiasing=null!==(r=e.antialiasing)&&void 0!==r?r:this._antialiasing,this._browser=e.browser,this._position=e.position,this._pixelRatioOverride=e.pixelRatio,this._applyDisplayMode(),this._mediaQueryList=this._browser.window.nativeComponent.matchMedia("(resolution: ".concat(window.devicePixelRatio,"dppx)")),this._mediaQueryList.addEventListener("change",this._pixelRatioChangeHandler),this._canvas.addEventListener("fullscreenchange",this._fullscreenChangeHandler),this.applyResolutionAndViewport()}return Object(y.a)(t,[{key:"dispose",value:function(){this._isDisposed||(this._isDisposed=!0,this._browser.window.off("resize",this._resizeHandler),this._resizeObserver&&this._resizeObserver.disconnect(),this.parent.removeEventListener("resize",this._resizeHandler),this._mediaQueryList.removeEventListener("change",this._pixelRatioChangeHandler),this._canvas.removeEventListener("fullscreenchange",this._fullscreenChangeHandler))}},{key:"_calculateDevicePixelRatio",value:function(){return window.devicePixelRatio<1?1:window.devicePixelRatio||1}},{key:"pixelRatio",get:function(){return this._pixelRatioOverride?this._pixelRatioOverride:this._devicePixelRatio}},{key:"isHiDpi",get:function(){return 1!==this.pixelRatio}},{key:"displayMode",get:function(){return this._displayMode}},{key:"canvas",get:function(){return this._canvas}},{key:"parent",get:function(){return this.displayMode===nn.FillContainer||this.displayMode===nn.FitContainer?this.canvas.parentElement||document.body:window}},{key:"resolution",get:function(){return this._resolution},set:function(t){this._resolution=t}},{key:"viewport",get:function(){return this._viewport?this._viewport:this._resolution},set:function(t){this._viewport=t}},{key:"aspectRatio",get:function(){return this._resolution.width/this._resolution.height}},{key:"scaledWidth",get:function(){return this._resolution.width*this.pixelRatio}},{key:"scaledHeight",get:function(){return this._resolution.height*this.pixelRatio}},{key:"setCurrentCamera",value:function(t){this._camera=t}},{key:"pushResolutionAndViewport",value:function(){this._resolutionStack.push(this.resolution),this._viewportStack.push(this.viewport),this.resolution=Object.assign({},this.resolution),this.viewport=Object.assign({},this.viewport)}},{key:"peekViewport",value:function(){return this._viewportStack[this._viewportStack.length-1]}},{key:"peekResolution",value:function(){return this._resolutionStack[this._resolutionStack.length-1]}},{key:"popResolutionAndViewport",value:function(){this.resolution=this._resolutionStack.pop(),this.viewport=this._viewportStack.pop()}},{key:"applyResolutionAndViewport",value:function(){(this._canvas.width=this.scaledWidth,this._canvas.height=this.scaledHeight,this._ctx instanceof ln)&&(this._ctx.checkIfResolutionSupported({width:this.scaledWidth,height:this.scaledHeight})||this._alreadyWarned||(this._alreadyWarned=!0,this._logger.warn("The currently configured resolution (".concat(this.resolution.width,"x").concat(this.resolution.height,")")+" is too large for the platform WebGL implementation, this may work but cause WebGL rendering to behave oddly. Try reducing the resolution or disabling Hi DPI scaling to avoid this (read more here https://excaliburjs.com/docs/screens#understanding-viewport--resolution).")));this._antialiasing?this._canvas.style.imageRendering="auto":(this._canvas.style.imageRendering="pixelated",""===this._canvas.style.imageRendering&&(this._canvas.style.imageRendering="crisp-edges")),this._canvas.style.width=this.viewport.width+"px",this._canvas.style.height=this.viewport.height+"px",this._ctx.updateViewport(),this._ctx.resetTransform(),this._ctx.scale(this.pixelRatio,this.pixelRatio),this._ctx.smoothing=this._antialiasing}},{key:"antialiasing",get:function(){return this._antialiasing},set:function(t){this._antialiasing=t,this._ctx.smoothing=this._antialiasing}},{key:"isFullScreen",get:function(){return this._isFullScreen}},{key:"goFullScreen",value:function(){return this._canvas.requestFullscreen()}},{key:"exitFullScreen",value:function(){return document.exitFullscreen()}},{key:"pageToScreenCoordinates",value:function(t){var e=t.x,n=t.y;if(this._isFullScreen||(e-=V(this._canvas).x,n-=V(this._canvas).y),this._isFullScreen)if(window.innerWidth/this.aspectRatio<window.innerHeight){var i=window.innerWidth/this.aspectRatio;n=(n-(window.innerHeight-i)/2)/i*this.viewport.height,e=e/window.innerWidth*this.viewport.width}else{var r=window.innerHeight*this.aspectRatio;e=(e-(window.innerWidth-r)/2)/r*this.viewport.width,n=n/window.innerHeight*this.viewport.height}return e=e/this.viewport.width*this.resolution.width,n=n/this.viewport.height*this.resolution.height,new ot(e,n)}},{key:"screenToPageCoordinates",value:function(t){var e=t.x,n=t.y;if(e=e/this.resolution.width*this.viewport.width,n=n/this.resolution.height*this.viewport.height,this._isFullScreen)if(window.innerWidth/this.aspectRatio<window.innerHeight){var i=window.innerWidth/this.aspectRatio,r=(window.innerHeight-i)/2;n=n/this.viewport.height*i+r,e=e/this.viewport.width*window.innerWidth}else{var a=window.innerHeight*this.aspectRatio,o=(window.innerWidth-a)/2;e=e/this.viewport.width*a+o,n=n/this.viewport.height*window.innerHeight}return this._isFullScreen||(e+=V(this._canvas).x,n+=V(this._canvas).y),new ot(e,n)}},{key:"screenToWorldCoordinates",value:function(t){var e,n,i,r,a=t.x,o=t.y;return a=a/this.resolution.width*this.drawWidth,o=o/this.resolution.height*this.drawHeight,a-=this.halfDrawWidth,o-=this.halfDrawHeight,a+=null!==(n=null===(e=this._camera)||void 0===e?void 0:e.x)&&void 0!==n?n:0,o+=null!==(r=null===(i=this._camera)||void 0===i?void 0:i.y)&&void 0!==r?r:0,new ot(a,o)}},{key:"worldToScreenCoordinates",value:function(t){var e,n,i,r,a=t.x,o=t.y;return a-=null!==(n=null===(e=this._camera)||void 0===e?void 0:e.x)&&void 0!==n?n:0,o-=null!==(r=null===(i=this._camera)||void 0===i?void 0:i.y)&&void 0!==r?r:0,a+=this.halfDrawWidth,o+=this.halfDrawHeight,a=a/this.drawWidth*this.resolution.width,o=o/this.drawHeight*this.resolution.height,new ot(a,o)}},{key:"pageToWorldCoordinates",value:function(t){var e=this.pageToScreenCoordinates(t);return this.screenToWorldCoordinates(e)}},{key:"worldToPageCoordinates",value:function(t){var e=this.worldToScreenCoordinates(t);return this.screenToPageCoordinates(e)}},{key:"getWorldBounds",value:function(){var t=this.screenToWorldCoordinates(ot.Zero).x,e=this.screenToWorldCoordinates(ot.Zero).y,n=t+this.drawWidth,i=e+this.drawHeight;return new dt(t,e,n,i)}},{key:"canvasWidth",get:function(){return this.canvas.width}},{key:"halfCanvasWidth",get:function(){return this.canvas.width/2}},{key:"canvasHeight",get:function(){return this.canvas.height}},{key:"halfCanvasHeight",get:function(){return this.canvas.height/2}},{key:"drawWidth",get:function(){return this._camera?this.resolution.width/this._camera.zoom:this.resolution.width}},{key:"halfDrawWidth",get:function(){return this.drawWidth/2}},{key:"drawHeight",get:function(){return this._camera?this.resolution.height/this._camera.zoom:this.resolution.height}},{key:"halfDrawHeight",get:function(){return this.drawHeight/2}},{key:"center",get:function(){return st(this.halfDrawWidth,this.halfDrawHeight)}},{key:"_computeFit",value:function(){document.body.style.margin="0px",document.body.style.overflow="hidden";var t=this.aspectRatio,e=0,n=0;window.innerWidth/t<window.innerHeight?(e=window.innerWidth,n=window.innerWidth/t):(e=window.innerHeight*t,n=window.innerHeight),this.viewport={width:e,height:n}}},{key:"_computeFitContainer",value:function(){var t=this.aspectRatio,e=0,n=0,i=this.canvas.parentElement;i.clientWidth/t<i.clientHeight?(e=i.clientWidth,n=i.clientWidth/t):(e=i.clientHeight*t,n=i.clientHeight),this.viewport={width:e,height:n}}},{key:"_applyDisplayMode",value:function(){var t=this;this.displayMode===nn.Position?this._initializeDisplayModePosition(this._position):(this._setResolutionAndViewportByDisplayMode(this.parent),this.parent instanceof Window?this._browser.window.on("resize",this._resizeHandler):(this._resizeObserver=new ResizeObserver((function(){t._resizeHandler()})),this._resizeObserver.observe(this.parent)),this.parent.addEventListener("resize",this._resizeHandler))}},{key:"_setResolutionAndViewportByDisplayMode",value:function(t){this.displayMode===nn.FillContainer&&(this.resolution={width:t.clientWidth,height:t.clientHeight},this.viewport=this.resolution),this.displayMode===nn.FillScreen&&(document.body.style.margin="0px",document.body.style.overflow="hidden",this.resolution={width:t.innerWidth,height:t.innerHeight},this.viewport=this.resolution),this.displayMode===nn.FitScreen&&this._computeFit(),this.displayMode===nn.FitContainer&&this._computeFitContainer()}},{key:"_initializeDisplayModePosition",value:function(t){if(!t)throw new Error("DisplayMode of Position was selected but no position option was given");if(this.canvas.style.display="block",this.canvas.style.position="absolute","string"===typeof t){var e=t.split(" ");switch(e[0]){case"top":this.canvas.style.top="0px";break;case"bottom":this.canvas.style.bottom="0px";break;case"middle":this.canvas.style.top="50%";var n=-this.halfDrawHeight;this.canvas.style.marginTop=n.toString();break;default:throw new Error("Invalid Position Given")}if(e[1])switch(e[1]){case"left":this.canvas.style.left="0px";break;case"right":this.canvas.style.right="0px";break;case"center":this.canvas.style.left="50%";var i=-this.halfDrawWidth;this.canvas.style.marginLeft=i.toString();break;default:throw new Error("Invalid Position Given")}}else t.top&&("number"===typeof t.top?this.canvas.style.top=t.top.toString()+"px":this.canvas.style.top=t.top),t.right&&("number"===typeof t.right?this.canvas.style.right=t.right.toString()+"px":this.canvas.style.right=t.right),t.bottom&&("number"===typeof t.bottom?this.canvas.style.bottom=t.bottom.toString()+"px":this.canvas.style.bottom=t.bottom),t.left&&("number"===typeof t.left?this.canvas.style.left=t.left.toString()+"px":this.canvas.style.left=t.left)}}]),t}(),hn=function(){function t(){Object(g.a)(this,t)}return Object(y.a)(t,null,[{key:"create",value:function(){return this._INSTANCE||(window.AudioContext||window.webkitAudioContext)&&(this._INSTANCE=new AudioContext),this._INSTANCE}}]),t}();hn._INSTANCE=null;var dn=function(){function t(){Object(g.a)(this,t)}return Object(y.a)(t,null,[{key:"unlock",value:function(){return new Promise((function(e,n){if(t._UNLOCKED||!hn.create())return e(!0);var i=setTimeout((function(){A.getInstance().warn("Excalibur was unable to unlock the audio context, audio probably will not play in this browser."),e(!1)}),200),r=hn.create();r.resume().then((function(){var n=r.createBuffer(1,1,22050),a=r.createBufferSource(),o=!1;a.buffer=n,a.connect(r.destination),a.onended=function(){return o=!0},a.start(0),setTimeout((function(){!function(t){return!!t.playbackState}(a)?(r.currentTime>0||o)&&(t._UNLOCKED=!0):a.playbackState!==a.PLAYING_STATE&&a.playbackState!==a.FINISHED_STATE||(t._UNLOCKED=!0)}),0),clearTimeout(i),e(!0)}),(function(){n()}))}))}},{key:"isUnlocked",value:function(){return this._UNLOCKED}}]),t}();dn._UNLOCKED=!1;var fn=function(){function t(){Object(g.a)(this,t),this.eventDispatcher=new xe(this)}return Object(y.a)(t,[{key:"on",value:function(t,e){this.eventDispatcher.on(t,e)}},{key:"off",value:function(t,e){this.eventDispatcher.off(t,e)}},{key:"emit",value:function(t,e){this.eventDispatcher.emit(t,e)}},{key:"once",value:function(t,e){this.eventDispatcher.once(t,e)}}]),t}();function pn(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ut.Red,n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0,a=arguments.length>5?arguments[5]:void 0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"butt";t.beginPath(),t.lineWidth=o,t.lineCap=s,t.strokeStyle=e.toString(),t.moveTo(n,i),t.lineTo(r,a),t.closePath(),t.stroke()}function vn(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ut.Red,n=arguments.length>2?arguments[2]:void 0;t.beginPath(),t.strokeStyle=e.toString(),t.arc(n.x,n.y,5,0,2*Math.PI),t.closePath(),t.stroke()}function gn(t,e,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,a=e?e.toString():"blue",o=i.scale(r);t.beginPath(),t.strokeStyle=a,t.moveTo(n.x,n.y),t.lineTo(n.x+o.x,n.y+o.y),t.closePath(),t.stroke()}function yn(t,e,n,i,r){var a,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:5,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:ut.White,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;if("number"===typeof o)a={tl:o,tr:o,br:o,bl:o};else{var u={tl:0,tr:0,br:0,bl:0};for(var c in u)if(u.hasOwnProperty(c)){var h=c;a[h]=o[h]||u[h]}}t.beginPath(),t.moveTo(e+a.tl,n),t.lineTo(e+i-a.tr,n),t.quadraticCurveTo(e+i,n,e+i,n+a.tr),t.lineTo(e+i,n+r-a.br),t.quadraticCurveTo(e+i,n+r,e+i-a.br,n+r),t.lineTo(e+a.bl,n+r),t.quadraticCurveTo(e,n+r,e,n+r-a.bl),t.lineTo(e,n+a.tl),t.quadraticCurveTo(e,n,e+a.tl,n),t.closePath(),l&&(t.fillStyle=l.toString(),t.fill()),s&&(t.strokeStyle=s.toString(),t.stroke())}function mn(t,e,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:ut.White,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;t.beginPath(),t.arc(e,n,i,0,2*Math.PI),t.closePath(),a&&(t.fillStyle=a.toString(),t.fill()),r&&(t.strokeStyle=r.toString(),t.stroke())}var _n,bn=n(1388),wn=function(t,e,n,i){return new(n||(n=Promise))((function(r,a){function o(t){try{l(i.next(t))}catch(e){a(e)}}function s(t){try{l(i.throw(t))}catch(e){a(e)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}l((i=i.apply(t,e||[])).next())}))},kn=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t){var i;return Object(g.a)(this,n),(i=e.call(this)).canvas=new zt({smoothing:!0,draw:i.draw.bind(Object(o.a)(i))}),i._resourceList=[],i._index=0,i._playButtonShown=!1,i._resourceCount=0,i._numLoaded=0,i._progressCounts={},i._totalCounts={},i.logo="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAdQAAAB2CAYAAABxhGI9AAAACXBIWXMAAAsSAAALEgHS3X78AAAKnUlEQVR42u3dP2wjSx0H8N8hJIonIRmJjsq0SBR+BQ1dcqKhe0lD77SvSwpKkJKGPulpktfRIMUdEqKIqV57rpAokM4dbSiyq7ONPTP7x39ifz7SFbnEnp3xer47O7uzH15fXwMA6OYHmgAABCoACFQAEKgAgEAFAIEKAAIVAAQqACBQAUCgAoBABQCBCgAIVAAQqAAgUAFAoAIAAhUABCoACFQAEKgAgECFLbmOiNeFf2PbAyz68Pr6qhUgbRwR92v+/zwiJrYHMEKFMmcN///UtgcQqFBk1PD/97U9Qx8VCFSgu4EmAIEKAAIVAAQqACBQ4Z25jojP8eX+0WtNAgIVaOY+Im5j+eKh24h41jQgUIEyZ7F5NaPU7wCBCiwYd/w9cOB+qAlgJ3KLLow0EV198803RWvJfvfddx+0lhEqHKu5JgAjVCBvlhmFzjQRXUekHz9+TP79y8uLRjNChXfvoePvAYEKxNtj1e42/O5JoIJABcrdRMRVLM+X3kTEpaaB988cKuzWg9EobTWdMx0Oly8uN4dqhAoARqgnaN3arHfqu7OyH8ItKLVB/P+CEfMTHyGPY3npx1m8zWGDEeoBfUk/xdti57dr/r1Wv2+6EPow3tZ5rRdS72s1neuF97xvWd+XTH0/V+UMttDWqbI/r2nrxfp+jv2uSjSO7S+OXy/A/3lN+9xX5T5HxEUPZZ0tfB71+w57eJ/HFu+z+jkv1u92YX9fbI/HhX3JA9rp5MPr66tWaG9UfUGbrHIzi7cLUyYFf/tpTady03EEeL8mUJ6i7MKYNvWNqr4Pe2jradXO60LrvPAz2PQ5RPX684ah8dxD+2zantnCgVipSVV+m/tgB9W2DDq2Sx/vM95wcHhZhWVJm8yrv58cSgfTdc70+++/X/r522+/tUKSEepBqo+om4ZLPerMjUwuNnQCtx1GWJtee1FwdD5uWd86xLs8UaVt2aNEO1/saZ/Z5rYMW4zq6v34rGV9Bg3q2eZ9SkeNm9qwyUh30OPIHYFKx5FG03C7znSOqYBq+qW/zpQ3anH037TNHluG6f0WPsPhHvab4QFty7ogOeuxDYcNy2/zu2214WNYWxmBurNO8bGn97pNBOO8xy/9uCorZZ4I2r4C7aJgO7ZV9iE49Dm6NvOWx+pWE9CUq3zbdTp9doz38TbXtzqH9RT5CyWe422OaZoZGeZCabrhPQY9HjwsjpTvCg4YtlE2+Ta/j2bzn8fqrDqgm+6yUHOmAvWUjAtGhbNYvsBknDnqH1Qhc7VmxHgeb/NbudA5j/UXlYwif2p6luhAc9teu1npiHKnDs8if6tCm7JLX3NKpgttXe9ruc9mHMd7a83iwdxF5vt8tutARaCeklRnNK9C8WnNF7geJQ4T4XG3JhSnVdilQrG+yOnrlVHfsEGYzhNBn7Lu6tS7+HJafJQ4EMiNlNqWXZ9WPvVgnVYHG5M1ByDXkT6leX2EgTqJtyt45yv7S2qO3sEZjZhDLXeR+YKdJ0Zdk8QocvH9N732KrNtq+FZ/zzIHABcJrYpd+Xv14lOd5ap76SgrduW/VTQ1qcQpqnbgu4ifZvUMNpd9XuoZmvCtPaQ2Y/BCHVLgbrJTeRPDdVf6pfMKDU2fOkHmVFFfXr3MsouLsnNvV5kRoe5+s431PeuoKPqWnaurY/ZPBEeqwceN4l96iwO6H7Mjq4y7VGPVNe10VaZMzVCPVWpI/Z6FZbcv5fMqGCU+dLfFGzj58jP8+bCdJCo7yzKTwdOF0bu9Ug7V4c+yz7FJfYeGoysUss0HssIdVZwYLDujMqlESoCdTtGsZtbHnJBeNdDSJSs0jTKdMJN1HNX54Wv7bvsU9NkVJVa13dX+/wuArV0X/l5RHyo/lnfF4G6p6DrS0kHdtXhy35TGErDPYZUn2WfWqDOo/lVqdMD2O/hKJhD7S/odukymq9s02QN4EEPR/zbaOumZc+r15zK1Zqznl9jsfiemTM1QmV3HUuTkedlg9HIQzRbUD93dfC+2tpj2fIHEH2+RqCCQH13gZq7hWXTNpVu19OB1fc9nQ0AKOKUb5lU0P1kDyOneoWk0lOZ9cIP0x7qu8+2BhCoR2wYu1+e7DmaXzBSsu5vaX1ne2zrpmUPTmxf7PM1Dm4y/vC7ny7Nif7+z/9ZmtM0Z3panPLtPmra9f16bcK0Dpbnwk43Vd/RHtu6zfNQTy1QBy3aqG2g9nVmxml+BOoJyT3NpWmn9xhfFnu4bvDa+44BXhqqfdf3uUF9+yz77AT31Yue2mjecYQ62NLfgkA9ghHqLNEhNem4H1c6vdyDxhf/bpz5m4coW/c39wi6VH2bPtHlcaV9cvXts+zxCe6rTeqc2ndL7uGd93QwM9bFcAzMoZZ7SgTBbWx+asui61h/iq1+RmjqdbnQXQ3T1DNQ63V/U9ucqm/pMzPb1rePsk/1iTOjgvatR4W3Lc8ULB78pELyrnAfeTcj1NU509/86mfJ33/8+Mf00a05UyPUEw7UVCeWG/WNEiExyHRMt5ltW30izUPk18ytt7lNfc8i//DvtvXto+ySA5BjljsLUF8lPkqMPEtW1JomDsiGBZ9Byb4NAvUITSN9GuwsIj6t6UTOqk7jJREkmzqli8xIs96udSO20sX0H1vW92IL9e1a9rgqVyf91gbPsTy9UD9n9lOkT8k+RfkFR5PMNqxOcdSf32PBvg3vilO+zdxE+okx9Wm0ph36XYsRZCpMF993GOk5qvqB3Dct6jvssb67KvuUNJ3frw92bhr8/STSF0JdRPMLpUCgnsgo9S76PZ246ZFk1wWvK5m3vVoYvW1Sz7nN91jfXbQ1ZQc7TW6HeaoOalypG/8/p/rP1aNAc6ZHzSnfdqPUPhdy2PQw6Nz9gSVhuhiqueUHR3uu7y7K3rdDX4u46ZrPbUa0IFBZ0seKQ3XQTRt2vm3W/a2DbNKys++rvm3ep6+y1x2UdP3bWU9lzra47U1GmlctX/sQ23t+aOlByLTh/4NAPaCRxtcdO5HLSJ/6vNtCwGx67VPmPbvWd1q9frKHtp4kAqRJ2HR9j762JfX3bZ//elPtj13PPDx1+D5tqk/Xi6NO8SHz7MmH19dXrdBNfVFP6T2PT1UHNit87/t4m5+aRH+nQBdvqyhZDKJLfZs8h7XPsqdV2ZOV+tanKB8aln0dyxdAXbV4j4gvt4oMOrbP6vbU73NW7TMlbdTnPrWpfqXfh9HKZ9vke7KuTeZRNtXRSe6+1FV//ce/ln5eXfsXgcqXzr6+9261M3moOoa7E6nvTZTfy7iNsmfb7kjfgXGsvxe0vihsEts9HTquPpt1q1vtahu2TqAiUAEEKj0zhwoARqgAu/OnX/442WH+9xc/Wvr58re/Tr7f41/+ZsRqhAoACFQAEKgAcHjMoQJskJsz/eqrr5Z+vvr7v5fmQFevAl5lztQIFQAQqAAgUAHgIJlDBdhgdQ41N2eKESoAIFABQKACwFEwhwoARqgAIFABQKACAAIVAAQqAAhUABCoAIBABQCBCgACFQAEKgAgUAFAoAKAQAUAgQoACFQAEKgAIFABQKACAAIVAAQqAAhUABCoAIBABQCBCgACFQAQqAAgUAFAoAKAQAUAlvwPcFDns1DsH4sAAAAASUVORK5CYII=",i.logoWidth=468,i.logoHeight=118,i.loadingBarColor=ut.White,i.backgroundColor="#176BAA",i.suppressPlayButton=!1,i._playButtonStyles=bn.Z.toString(),i.playButtonText="Play game",i.startButtonFactory=function(){var t=document.getElementById("excalibur-play");return t||(t=document.createElement("button")),t.id="excalibur-play",t.textContent=i.playButtonText,t.style.display="none",t},t&&i.addResources(t),i}return Object(y.a)(n,[{key:"_image",get:function(){return this._imageElement||(this._imageElement=new Image,this._imageElement.src=this.logo),this._imageElement}},{key:"playButtonRootElement",get:function(){return this._playButtonRootElement}},{key:"playButtonElement",get:function(){return this._playButtonElement}},{key:"_playButton",get:function(){var t=document.getElementById("excalibur-play-root");return t&&(this._playButtonRootElement=t),this._playButtonRootElement||(this._playButtonRootElement=document.createElement("div"),this._playButtonRootElement.id="excalibur-play-root",this._playButtonRootElement.style.position="absolute",document.body.appendChild(this._playButtonRootElement)),this._styleBlock||(this._styleBlock=document.createElement("style"),this._styleBlock.textContent=this._playButtonStyles,document.head.appendChild(this._styleBlock)),this._playButtonElement||(this._playButtonElement=this.startButtonFactory(),this._playButtonRootElement.appendChild(this._playButtonElement)),this._playButtonElement}},{key:"wireEngine",value:function(t){this._engine=t,this.canvas.width=this._engine.canvas.width,this.canvas.height=this._engine.canvas.height}},{key:"addResource",value:function(t){var e=this._index++;this._resourceList.push(t),this._progressCounts[e]=0,this._totalCounts[e]=1,this._resourceCount++}},{key:"addResources",value:function(t){for(var e=0,n=t.length;e<n;e++)this.addResource(t[e])}},{key:"isLoaded",value:function(){return this._numLoaded===this._resourceCount}},{key:"showPlayButton",value:function(){var t,e=this;if(this.suppressPlayButton)return this.hidePlayButton(),Promise.resolve();var n=function(){e._positionPlayButton()};(null===(t=this._engine)||void 0===t?void 0:t.browser)&&this._engine.browser.window.on("resize",n),this._playButtonShown=!0,this._playButton.style.display="block",document.body.addEventListener("keyup",(function(t){"Enter"===t.key&&e._playButton.click()}));var i=new Promise((function(t){var i=function(i){var r;i.stopPropagation(),e.hidePlayButton(),(null===(r=e._engine)||void 0===r?void 0:r.browser)&&e._engine.browser.window.off("resize",n),t()};e._playButton.addEventListener("click",i),e._playButton.addEventListener("touchend",i),e._playButton.addEventListener("pointerup",i)}));return i}},{key:"hidePlayButton",value:function(){this._playButtonShown=!1,this._playButton.style.display="none"}},{key:"dispose",value:function(){this._playButtonRootElement.parentElement&&(this._playButtonRootElement.removeChild(this._playButtonElement),document.body.removeChild(this._playButtonRootElement),document.head.removeChild(this._styleBlock),this._playButtonRootElement=null,this._playButtonElement=null,this._styleBlock=null)}},{key:"update",value:function(t,e){}},{key:"load",value:function(){return wn(this,void 0,void 0,c.a.mark((function t(){var e=this;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all(this._resourceList.map((function(t){return t.load().finally((function(){e._numLoaded++}))})));case 2:return t.next=4,J(200);case 4:return t.next=6,this.showPlayButton();case 6:return t.next=8,dn.unlock();case 8:return t.abrupt("return",this.data=this._resourceList);case 9:case"end":return t.stop()}}),t,this)})))}},{key:"markResourceComplete",value:function(){this._numLoaded++}},{key:"progress",get:function(){return this._resourceCount>0?I(this._numLoaded,0,this._resourceCount)/this._resourceCount:1}},{key:"_positionPlayButton",value:function(){var t=this._engine.screen.viewport.height,e=this._engine.screen.viewport.width;if(this._playButtonRootElement){var n=this._engine.canvas.offsetLeft,i=this._engine.canvas.offsetTop,r=this._playButton.clientWidth,a=this._playButton.clientHeight;this.playButtonPosition?(this._playButtonRootElement.style.left="".concat(this.playButtonPosition.x,"px"),this._playButtonRootElement.style.top="".concat(this.playButtonPosition.y,"px")):(this._playButtonRootElement.style.left="".concat(n+e/2-r/2,"px"),this._playButtonRootElement.style.top="".concat(i+t/2-a/2+100,"px"))}}},{key:"draw",value:function(t){var e=this._engine.canvasHeight/this._engine.pixelRatio,n=this._engine.canvasWidth/this._engine.pixelRatio;this._positionPlayButton(),t.fillStyle=this.backgroundColor,t.fillRect(0,0,n,e);var i=e/2,r=Math.min(this.logoWidth,.75*n),a=n/2-r/2;this.logoPosition&&(a=this.logoPosition.x,i=this.logoPosition.y);var o=Math.floor(r*(this.logoHeight/this.logoWidth)),s=this._engine.getAntialiasing();if(this._engine.setAntialiasing(!0),this.logoPosition?t.drawImage(this._image,0,0,this.logoWidth,this.logoHeight,a,i,r,o):t.drawImage(this._image,0,0,this.logoWidth,this.logoHeight,a,i-o-20,r,o),this.suppressPlayButton||!this._playButtonShown){var l=a,u=i;this.loadingBarPosition&&(l=this.loadingBarPosition.x,u=this.loadingBarPosition.y),t.lineWidth=2,yn(t,l,u,r,20,10,this.loadingBarColor);var c=r*this.progress-10;yn(t,l+5,u+5,c>10?c:10,10,5,null,this.loadingBarColor),this._engine.setAntialiasing(s)}else this._engine.setAntialiasing(s)}}]),n}(fn),xn={webgl:"WebGL",webaudio:"WebAudio",gamepadapi:"Gamepad API"},Sn=function(){function t(){Object(g.a)(this,t),this._features=null,this.failedTests=[],this._criticalTests={canvasSupport:function(){var t=document.createElement("canvas");return!(!t.getContext||!t.getContext("2d"))},arrayBufferSupport:function(){var t=new XMLHttpRequest;t.open("GET","/");try{t.responseType="arraybuffer"}catch(e){return!1}return"arraybuffer"===t.responseType},dataUrlSupport:function(){return 0===document.createElement("canvas").toDataURL("image/png").indexOf("data:image/png")},objectUrlSupport:function(){return"URL"in window&&"revokeObjectURL"in URL&&"createObjectURL"in URL},rgbaSupport:function(){var t=document.createElement("a").style;return t.cssText="background-color:rgba(150,255,150,.5)",(""+t.backgroundColor).indexOf("rgba")>-1}},this._warningTest={webAudioSupport:function(){return!!(window.AudioContext||window.webkitAudioContext||window.mozAudioContext||window.msAudioContext||window.oAudioContext)},webglSupport:function(){var t=document.createElement("canvas");return!(!t.getContext||!t.getContext("webgl"))}},this._features=this._loadBrowserFeatures()}return Object(y.a)(t,[{key:"getBrowserFeatures",value:function(){return null===this._features&&(this._features=this._loadBrowserFeatures()),this._features}},{key:"logBrowserFeatures",value:function(){for(var t="%cSUPPORTED BROWSER FEATURES\n==========================%c\n",e=["font-weight: bold; color: navy","font-weight: normal; color: inherit"],n=this.getBrowserFeatures(),i=0,r=Object.keys(xn);i<r.length;i++){var a=r[i];n[a]?(t+="(%c\u2713%c)",e.push("font-weight: bold; color: green"),e.push("font-weight: normal; color: inherit")):(t+="(%c\u2717%c)",e.push("font-weight: bold; color: red"),e.push("font-weight: normal; color: inherit")),t+=" "+xn[a]+"\n"}e.unshift(t),console.log.apply(console,e)}},{key:"_loadBrowserFeatures",value:function(){var t=this;return{canvas:t._criticalTests.canvasSupport(),arraybuffer:t._criticalTests.arrayBufferSupport(),dataurl:t._criticalTests.dataUrlSupport(),objecturl:t._criticalTests.objectUrlSupport(),rgba:t._criticalTests.rgbaSupport(),webaudio:t._warningTest.webAudioSupport(),webgl:t._warningTest.webglSupport(),gamepadapi:!!navigator.getGamepads}}},{key:"test",value:function(){var t=!1;for(var e in this._criticalTests)this._criticalTests[e].call(this)||(this.failedTests.push(e),A.getInstance().error("Critical browser feature missing, Excalibur requires:",e),t=!0);if(t)return!1;for(var n in this._warningTest)this._warningTest[n]()||A.getInstance().warn("Warning browser feature missing, Excalibur will have reduced performance:",n);return!0}}]),t}();!function(t){t.PreventCollision="PreventCollision",t.Passive="Passive",t.Active="Active",t.Fixed="Fixed"}(_n||(_n={}));var Cn,On,En,An=function(t,e,n,i){var r,a=arguments.length,o=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,n,o):r(e,n))||o);return a>3&&o&&Object.defineProperty(e,n,o),o};!function(t){t.Arcade="arcade",t.Realistic="realistic"}(Cn||(Cn={})),function(t){t[t.DynamicAABBTree=0]="DynamicAABBTree"}(On||(On={})),function(t){t[t.Euler=0]="Euler"}(En||(En={}));var Pn=function(){function t(){Object(g.a)(this,t)}return Object(y.a)(t,null,[{key:"gravity",get:function(){return t.acc},set:function(e){t.acc=e}},{key:"useArcadePhysics",value:function(){t.collisionResolutionStrategy=Cn.Arcade}},{key:"useRealisticPhysics",value:function(){t.collisionResolutionStrategy=Cn.Realistic}},{key:"dynamicTreeVelocityMultiplyer",get:function(){return t.dynamicTreeVelocityMultiplier},set:function(e){t.dynamicTreeVelocityMultiplier=e}}]),t}();Pn.acc=new ot(0,0),Pn.enabled=!0,Pn.broadphaseStrategy=On.DynamicAABBTree,Pn.collisionResolutionStrategy=Cn.Arcade,Pn.defaultMass=10,Pn.integrator=En.Euler,Pn.dynamicTreeVelocityMultiplier=2,Pn.boundsPadding=5,Pn.positionIterations=3,Pn.velocityIterations=8,Pn.slop=1,Pn.steeringFactor=.2,Pn.warmStart=!0,Pn.bodiesCanSleepByDefault=!1,Pn.surfaceEpsilon=.1,Pn.sleepEpsilon=.07,Pn.wakeThreshold=3*Pn.sleepEpsilon,Pn.sleepBias=.9,Pn.checkForFastBodies=!0,Pn.disableMinimumSpeedForFastBody=!1,An([rt({message:"Alias for incorrect spelling used in older versions, will be removed in v0.25.0",alternateMethod:"dynamicTreeVelocityMultiplier"})],Pn,"dynamicTreeVelocityMultiplyer",null);var jn=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t){var i;return Object(g.a)(this,n),(i=e.call(this,0,0))._getX=t.getX,i._getY=t.getY,i._setX=t.setX,i._setY=t.setY,i}return Object(y.a)(n,[{key:"x",get:function(){return this._x=this._getX()},set:function(t){this._setX(t),this._x=t}},{key:"y",get:function(){return this._y=this._getY()},set:function(t){this._setY(t),this._y=t}}]),n}(ot);var Tn,Rn=function(){function t(){Object(g.a)(this,t),this.owner=null}return Object(y.a)(t,[{key:"clone",value:function(){var t,e=new this.constructor;for(var n in this)if(this.hasOwnProperty(n)){var i=this[n];(null===(t=i)||void 0===t?void 0:t.clone)&&"owner"!==n&&"clone"!==n?e[n]=i.clone():e[n]=i}return e}}]),t}(),Dn=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t,i){var r;return Object(g.a)(this,n),(r=e.call(this)).type=t,r.value=i,r}return n}(Rn),Mn=function(t){var e=t;return new jn({setX:function(t){e.data[ct.X]=t},setY:function(t){e.data[ct.Y]=t},getX:function(){return e.data[ct.X]},getY:function(){return e.data[ct.Y]}})},Ln=function(t){var e=t;return new jn({setX:function(t){e.setScaleX(t)},setY:function(t){e.setScaleY(t)},getX:function(){return e.getScaleX()},getY:function(){return e.getScaleY()}})};!function(t){t.World="world",t.Screen="screen"}(Tn||(Tn={}));var Bn=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(){var t;return Object(g.a)(this,n),(t=e.apply(this,arguments)).type="ex.transform",t._dirty=!1,t.matrix=pt.identity().translate(0,0).rotate(0).scale(1,1),t._position=Mn(t.matrix),t._rotation=0,t._scale=Ln(t.matrix),t.coordPlane=Tn.World,t.z=0,t}return Object(y.a)(n,[{key:"_recalculate",value:function(){this._rotation=this.matrix.getRotation(),this._dirty=!1}},{key:"getGlobalMatrix",value:function(){return this.parent?this.parent.getGlobalMatrix().multm(this.matrix):this.matrix}},{key:"getGlobalTransform",value:function(){return{pos:this.globalPos,scale:this.globalScale,rotation:this.globalRotation,z:this.z,coordPlane:this.coordPlane}}},{key:"parent",get:function(){var t,e;return null===(e=null===(t=null===this||void 0===this?void 0:this.owner)||void 0===t?void 0:t.parent)||void 0===e?void 0:e.get(n)}},{key:"pos",get:function(){return this._dirty&&this._recalculate(),this._position},set:function(t){this.matrix.setPosition(t.x,t.y),this._dirty=!0}},{key:"dirty",get:function(){var t;return(null===(t=null===this||void 0===this?void 0:this.owner)||void 0===t?void 0:t.parent)&&this.parent.dirty||this._dirty}},{key:"globalPos",get:function(){var t=this,e=this.getGlobalMatrix();return new jn({getX:function(){return e.data[ct.X]},getY:function(){return e.data[ct.Y]},setX:function(n){var i;if(t.parent){var r=a(null===(i=t.parent)||void 0===i?void 0:i.getGlobalMatrix().getAffineInverse().multv([n,e.data[ct.Y]]),1)[0];t.matrix.data[ct.X]=r}else t.matrix.data[ct.X]=n},setY:function(n){var i;if(t.parent){var r=a(null===(i=t.parent)||void 0===i?void 0:i.getGlobalMatrix().getAffineInverse().multv([e.data[ct.X],n]),2)[1];t.matrix.data[ct.Y]=r}else t.matrix.data[ct.Y]=n}})},set:function(t){var e=this.parent;this.pos=e?e.getGlobalMatrix().getAffineInverse().multv(t):t}},{key:"rotation",get:function(){return this._dirty&&this._recalculate(),this._rotation},set:function(t){this.matrix.setRotation(t),this._dirty=!0}},{key:"globalRotation",get:function(){return this.getGlobalMatrix().getRotation()},set:function(t){var e=this.parent;this.rotation=e?t-e.globalRotation:t}},{key:"scale",get:function(){return this._dirty&&this._recalculate(),this._scale},set:function(t){this.matrix.setScale(t),this._dirty=!0}},{key:"globalScale",get:function(){var t=this,e=this.getGlobalMatrix();return new jn({getX:function(){return e.getScaleX()},getY:function(){return e.getScaleY()},setX:function(e){if(t.parent){var n=t.parent.globalScale.x;t.matrix.setScaleX(e/n)}else t.matrix.setScaleX(e)},setY:function(e){if(t.parent){var n=t.parent.globalScale.y;t.matrix.setScaleY(e/n)}else t.matrix.setScaleY(e)}})},set:function(t){var e=this.parent;this.scale=e?st(t.x/e.globalScale.x,t.y/e.globalScale.y):t}},{key:"apply",value:function(t){return this.matrix.multv(t)}},{key:"applyInverse",value:function(t){return this.matrix.getAffineInverse().multv(t)}}]),n}(Rn),Fn=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(){var t;return Object(g.a)(this,n),(t=e.apply(this,arguments)).type="ex.motion",t.vel=ot.Zero,t.acc=ot.Zero,t.scaleFactor=ot.Zero,t.angularVelocity=0,t.torque=0,t.inertia=1,t}return n}(Rn),In=function(){function t(e,n,i){Object(g.a)(this,t),this._name=e,this._category=n,this._mask=i}return Object(y.a)(t,[{key:"name",get:function(){return this._name}},{key:"category",get:function(){return this._category}},{key:"mask",get:function(){return this._mask}},{key:"canCollide",value:function(t){return 0!==(this.category&t.mask)&&0!==(t.category&this.mask)}},{key:"invert",value:function(){return new t("~("+this.name+")",~this.category,~this.mask)}}],[{key:"combine",value:function(e){var n=e.map((function(t){return t.name})).join("+"),i=e.reduce((function(t,e){return e.category|t}),0);return new t(n,i,~i)}},{key:"collidesWith",value:function(e){return t.combine(e).invert()}}]),t}();In.All=new In("Collide with all groups",-1,-1);var zn=function(){function t(){Object(g.a)(this,t),this.observers=[],this.subscriptions=[]}return Object(y.a)(t,[{key:"register",value:function(t){this.observers.push(t)}},{key:"subscribe",value:function(t){this.subscriptions.push(t)}},{key:"unregister",value:function(t){var e=this.observers.indexOf(t);-1!==e&&this.observers.splice(e,1)}},{key:"unsubscribe",value:function(t){var e=this.subscriptions.indexOf(t);-1!==e&&this.subscriptions.splice(e,1)}},{key:"notifyAll",value:function(t){this.observers.forEach((function(e){return e.notify(t)})),this.subscriptions.forEach((function(e){return e(t)}))}},{key:"clear",value:function(){this.observers.length=0,this.subscriptions.length=0}}]),t}(),Nn=function(){function t(e,n){Object(g.a)(this,t),this.colliderA=e,this.colliderB=n,this.id=null,this.id=t.calculatePairHash(e.id,n.id)}return Object(y.a)(t,[{key:"canCollide",get:function(){var e=this.colliderA,n=this.colliderB;return t.canCollide(e,n)}},{key:"collide",value:function(){return this.colliderA.collide(this.colliderB)}},{key:"hasCollider",value:function(t){return t===this.colliderA||t===this.colliderB}}],[{key:"canCollide",value:function(t,e){var n,i,r=null===(n=null===t||void 0===t?void 0:t.owner)||void 0===n?void 0:n.get(oi),a=null===(i=null===e||void 0===e?void 0:e.owner)||void 0===i?void 0:i.get(oi);return!(!r||!a)&&(!!r.group.canCollide(a.group)&&((r.collisionType!==_n.Fixed||a.collisionType!==_n.Fixed)&&(a.collisionType!==_n.PreventCollision&&r.collisionType!==_n.PreventCollision&&!(!r.active||!a.active))))}},{key:"calculatePairHash",value:function(t,e){return t.value<e.value?"#".concat(t.value,"+").concat(e.value):"#".concat(e.value,"+").concat(t.value)}}]),t}(),Un=function(){function t(e,n){Object(g.a)(this,t),this.min=e,this.max=n}return Object(y.a)(t,[{key:"overlaps",value:function(t){return this.max>t.min&&t.max>this.min}},{key:"getOverlap",value:function(t){return this.overlaps(t)?this.max>t.max?t.max-this.min:this.max-t.min:0}}]),t}(),Hn=function(){function t(e){Object(g.a)(this,t),this.parent=e,this.parent=e||null,this.data=null,this.bounds=new dt,this.left=null,this.right=null,this.height=0}return Object(y.a)(t,[{key:"isLeaf",value:function(){return!this.left&&!this.right}}]),t}(),Wn=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new dt(-Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE);Object(g.a)(this,t),this.worldBounds=e,this.root=null,this.nodes={}}return Object(y.a)(t,[{key:"_insert",value:function(t){if(null===this.root)return this.root=t,void(this.root.parent=null);for(var e=t.bounds,n=this.root;!n.isLeaf();){var i=n.left,r=n.right,a=n.bounds.getPerimeter(),o=n.bounds.combine(e).getPerimeter(),s=2*o,l=2*(o-a),u=0,c=e.combine(i.bounds),h=void 0;i.isLeaf()?u=c.getPerimeter()+l:(h=i.bounds.getPerimeter(),u=c.getPerimeter()-h+l);var d=0,f=e.combine(r.bounds);if(r.isLeaf()?d=f.getPerimeter()+l:(h=r.bounds.getPerimeter(),d=f.getPerimeter()-h+l),s<u&&s<d)break;n=u<d?i:r}var p=n.parent,v=new Hn(p);v.bounds=e.combine(n.bounds),v.height=n.height+1,null!==p?(p.left===n?p.left=v:p.right=v,v.left=n,v.right=t,n.parent=v,t.parent=v):(v.left=n,v.right=t,n.parent=v,t.parent=v,this.root=v);for(var g=t.parent;g;){if(!(g=this._balance(g)).left)throw new Error("Parent of current leaf cannot have a null left child"+g);if(!g.right)throw new Error("Parent of current leaf cannot have a null right child"+g);g.height=1+Math.max(g.left.height,g.right.height),g.bounds=g.left.bounds.combine(g.right.bounds),g=g.parent}}},{key:"_remove",value:function(t){if(t!==this.root){var e,n=t.parent,i=n.parent;if(e=n.left===t?n.right:n.left,i){i.left===n?i.left=e:i.right=e,e.parent=i;for(var r=i;r;)(r=this._balance(r)).bounds=r.left.bounds.combine(r.right.bounds),r.height=1+Math.max(r.left.height,r.right.height),r=r.parent}else this.root=e,e.parent=null}else this.root=null}},{key:"trackCollider",value:function(t){var e=new Hn;e.data=t,e.bounds=t.bounds,e.bounds.left-=2,e.bounds.top-=2,e.bounds.right+=2,e.bounds.bottom+=2,this.nodes[t.id.value]=e,this._insert(e)}},{key:"updateCollider",value:function(t){var e,n=this.nodes[t.id.value];if(!n)return!1;var i=t.bounds;if(!this.worldBounds.contains(i))return A.getInstance().warn("Collider with id "+t.id.value+" is outside the world bounds and will no longer be tracked for physics"),this.untrackCollider(t),!1;if(n.bounds.contains(i))return!1;if(this._remove(n),i.left-=Pn.boundsPadding,i.top-=Pn.boundsPadding,i.right+=Pn.boundsPadding,i.bottom+=Pn.boundsPadding,t.owner){var r=null===(e=t.owner)||void 0===e?void 0:e.get(oi);if(r){var a=32*r.vel.x/1e3*Pn.dynamicTreeVelocityMultiplier,o=32*r.vel.y/1e3*Pn.dynamicTreeVelocityMultiplier;a<0?i.left+=a:i.right+=a,o<0?i.top+=o:i.bottom+=o}}return n.bounds=i,this._insert(n),!0}},{key:"untrackCollider",value:function(t){var e=this.nodes[t.id.value];e&&(this._remove(e),this.nodes[t.id.value]=null,delete this.nodes[t.id.value])}},{key:"_balance",value:function(t){if(null===t)throw new Error("Cannot balance at null node");if(t.isLeaf()||t.height<2)return t;var e=t.left,n=t.right,i=t,r=e,a=n,o=e.left,s=e.right,l=n.left,u=n.right,c=a.height-r.height;if(c>1)return a.left=i,a.parent=i.parent,i.parent=a,a.parent?a.parent.left===i?a.parent.left=a:a.parent.right=a:this.root=a,l.height>u.height?(a.right=l,i.right=u,u.parent=i,i.bounds=r.bounds.combine(u.bounds),a.bounds=i.bounds.combine(l.bounds),i.height=1+Math.max(r.height,u.height),a.height=1+Math.max(i.height,l.height)):(a.right=u,i.right=l,l.parent=i,i.bounds=r.bounds.combine(l.bounds),a.bounds=i.bounds.combine(u.bounds),i.height=1+Math.max(r.height,l.height),a.height=1+Math.max(i.height,u.height)),a;if(c<-1){if(r.left=i,r.parent=i.parent,i.parent=r,r.parent)if(r.parent.left===i)r.parent.left=r;else{if(r.parent.right!==i)throw"Error rotating Dynamic Tree";r.parent.right=r}else this.root=r;return o.height>s.height?(r.right=o,i.left=s,s.parent=i,i.bounds=a.bounds.combine(s.bounds),r.bounds=i.bounds.combine(o.bounds),i.height=1+Math.max(a.height,s.height),r.height=1+Math.max(i.height,o.height)):(r.right=s,i.left=o,o.parent=i,i.bounds=a.bounds.combine(o.bounds),r.bounds=i.bounds.combine(s.bounds),i.height=1+Math.max(a.height,o.height),r.height=1+Math.max(i.height,s.height)),r}return t}},{key:"getHeight",value:function(){return null===this.root?0:this.root.height}},{key:"query",value:function(t,e){var n=t.bounds;!function i(r){if(r&&r.bounds.intersect(n)){if(!r.isLeaf()||r.data===t)return i(r.left)||i(r.right);if(e.call(t,r.data))return!0}return!1}(this.root)}},{key:"rayCastQuery",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,n=arguments.length>2?arguments[2]:void 0,i=function i(r){if(r&&r.bounds.rayCast(t,e)){if(!r.isLeaf())return i(r.left)||i(r.right);if(n.call(t,r.data))return!0}return!1};i(this.root)}},{key:"getNodes",value:function(){return function t(e){return e?[e].concat(t(e.left),t(e.right)):[]}(this.root)}},{key:"debug",value:function(t){!function e(n){n&&(n.isLeaf()?n.bounds.draw(t,ut.Green):n.bounds.draw(t,ut.White),n.left&&e(n.left),n.right&&e(n.right))}(this.root)}}]),t}(),Vn=function(){function t(e,n){Object(g.a)(this,t),this.pos=e,this.dir=n.normalize()}return Object(y.a)(t,[{key:"intersect",value:function(t){var e=t.begin.sub(this.pos);if(0===this.dir.cross(t.getSlope())&&0!==e.cross(this.dir))return-1;var n=this.dir.cross(t.getSlope());if(0===n)return-1;var i=e.cross(t.getSlope())/n;if(i>=0){var r=e.cross(this.dir)/n/t.getLength();if(r>=0&&r<=1)return i}return-1}},{key:"intersectPoint",value:function(t){var e=this.intersect(t);return e<0?null:this.getPoint(e)}},{key:"getPoint",value:function(t){return this.pos.add(this.dir.scale(t))}}]),t}(),Gn=function(){function t(){Object(g.a)(this,t),this._dynamicCollisionTree=new Wn,this._collisions=new Set,this._collisionPairCache=[],this._colliders=[]}return Object(y.a)(t,[{key:"getColliders",value:function(){return this._colliders}},{key:"track",value:function(t){if(t)if(t instanceof qn){var e,n=t.getColliders(),i=Object(f.a)(n);try{for(i.s();!(e=i.n()).done;){var r=e.value;r.owner=t.owner,this._colliders.push(r),this._dynamicCollisionTree.trackCollider(r)}}catch(a){i.e(a)}finally{i.f()}}else this._colliders.push(t),this._dynamicCollisionTree.trackCollider(t);else A.getInstance().warn("Cannot track null collider")}},{key:"untrack",value:function(t){if(t)if(t instanceof qn){var e,n=t.getColliders(),i=Object(f.a)(n);try{for(i.s();!(e=i.n()).done;){var r=e.value,a=this._colliders.indexOf(r);-1!==a&&this._colliders.splice(a,1),this._dynamicCollisionTree.untrackCollider(r)}}catch(s){i.e(s)}finally{i.f()}}else{var o=this._colliders.indexOf(t);-1!==o&&this._colliders.splice(o,1),this._dynamicCollisionTree.untrackCollider(t)}else A.getInstance().warn("Cannot untrack a null collider")}},{key:"_shouldGenerateCollisionPair",value:function(t,e){if(null!==t.id&&null!==e.id&&t.id===e.id||null!==t.owner&&null!==e.owner&&t.owner===e.owner)return!1;var n=Nn.calculatePairHash(t.id,e.id);return!this._collisions.has(n)&&(!t.localBounds.hasZeroDimensions()&&!e.localBounds.hasZeroDimensions()&&Nn.canCollide(t,e))}},{key:"broadphase",value:function(t,e,n){var i,r=this,a=e/1e3,o=t.filter((function(t){var e,n,i=null===(e=t.owner)||void 0===e?void 0:e.get(oi);return(null===(n=t.owner)||void 0===n?void 0:n.active)&&i.collisionType!==_n.PreventCollision}));this._collisionPairCache=[],this._collisions.clear();for(var s=0,l=o.length;s<l;s++)i=o[s],this._dynamicCollisionTree.query(i,(function(t){if(r._shouldGenerateCollisionPair(i,t)){var e=new Nn(i,t);r._collisions.add(e.id),r._collisionPairCache.push(e)}return!1}));if(n&&(n.physics.pairs=this._collisionPairCache.length),Pn.checkForFastBodies){var u,c=Object(f.a)(o);try{var h=function(){var t=u.value,e=t.owner.get(oi);if(e.collisionType!==_n.Active)return"continue";var i=e.vel.size*a+.5*e.acc.size*a*a,o=Math.min(t.bounds.height,t.bounds.width);if(Pn.disableMinimumSpeedForFastBody||i>o/2){n&&n.physics.fastBodies++;var s,l=e.pos.sub(e.oldPos),c=t.center,h=t.getFurthestPoint(e.vel),d=h.sub(l),f=new Vn(d,e.vel);f.pos=f.pos.add(f.dir.scale(-2*Pn.surfaceEpsilon));var p=new ot(1/0,1/0);if(r._dynamicCollisionTree.rayCastQuery(f,i+2*Pn.surfaceEpsilon,(function(e){if(t!==e&&Nn.canCollide(t,e)){var n=e.rayCast(f,i+10*Pn.surfaceEpsilon);if(n){var r=n.sub(d);r.size<p.size&&(p=r,s=e)}}return!1})),s&&ot.isValid(p)){var v=new Nn(t,s);r._collisions.has(v.id)||(r._collisions.add(v.id),r._collisionPairCache.push(v));var g=c.sub(h);e.pos=d.add(g).add(p).add(f.dir.scale(10*Pn.surfaceEpsilon)),t.update(e.transform),n&&n.physics.fastBodyCollisions++}}};for(c.s();!(u=c.n()).done;)h()}catch(d){c.e(d)}finally{c.f()}}return this._collisionPairCache}},{key:"narrowphase",value:function(t,e){for(var n=[],i=0;i<t.length;i++){var r=t[i].collide();if(n=n.concat(r),e&&r.length>0){var a,o=Object(f.a)(r);try{for(o.s();!(a=o.n()).done;){var s=a.value;e.physics.contacts.set(s.id,s)}}catch(l){o.e(l)}finally{o.f()}}}return e&&(e.physics.collisions+=n.length),n}},{key:"update",value:function(t){for(var e=0,n=t.length,i=0;i<n;i++)this._dynamicCollisionTree.updateCollider(t[i])&&e++;return e}},{key:"debug",value:function(t){this._dynamicCollisionTree.debug(t)}}]),t}(),Xn=function(){function t(){Object(g.a)(this,t),this.id=E("collider",t._ID++),this.events=new xe(this)}return Object(y.a)(t,[{key:"touching",value:function(t){return!!this.collide(t)}}]),t}();Xn._ID=0;var qn=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t){var i;Object(g.a)(this,n),(i=e.call(this))._collisionProcessor=new Gn,i._dynamicAABBTree=new Wn,i._colliders=[];var r,a=Object(f.a)(t);try{for(a.s();!(r=a.n()).done;){var o=r.value;i.addCollider(o)}}catch(s){a.e(s)}finally{a.f()}return i}return Object(y.a)(n,[{key:"clearColliders",value:function(){this._colliders=[]}},{key:"addCollider",value:function(t){this.events.wire(t.events),this._colliders.push(t),this._collisionProcessor.track(t),this._dynamicAABBTree.trackCollider(t)}},{key:"removeCollider",value:function(t){this.events.unwire(t.events),X(t,this._colliders),this._collisionProcessor.untrack(t),this._dynamicAABBTree.untrackCollider(t)}},{key:"getColliders",value:function(){return this._colliders}},{key:"worldPos",get:function(){var t,e;return null!==(e=null===(t=this._transform)||void 0===t?void 0:t.pos)&&void 0!==e?e:ot.Zero}},{key:"center",get:function(){var t,e;return null!==(e=null===(t=this._transform)||void 0===t?void 0:t.pos)&&void 0!==e?e:ot.Zero}},{key:"bounds",get:function(){var t,e,n=this.getColliders();return n.reduce((function(t,e){return t.combine(e.bounds)}),null!==(e=null===(t=n[0])||void 0===t?void 0:t.bounds)&&void 0!==e?e:(new dt).translate(this.worldPos))}},{key:"localBounds",get:function(){var t,e,n=this.getColliders();return n.reduce((function(t,e){return t.combine(e.localBounds)}),null!==(e=null===(t=n[0])||void 0===t?void 0:t.localBounds)&&void 0!==e?e:new dt)}},{key:"axes",get:function(){var t,e=this.getColliders(),n=[],i=Object(f.a)(e);try{for(i.s();!(t=i.n()).done;){var r=t.value;n=n.concat(r.axes)}}catch(a){i.e(a)}finally{i.f()}return n}},{key:"getFurthestPoint",value:function(t){var e,n=this.getColliders(),i=[],r=Object(f.a)(n);try{for(r.s();!(e=r.n()).done;){var a=e.value;i.push(a.getFurthestPoint(t))}}catch(d){r.e(d)}finally{r.f()}for(var o=i[0],s=-Number.MAX_VALUE,l=0,u=i;l<u.length;l++){var c=u[l],h=c.dot(t);h>s&&(o=c,s=h)}return o}},{key:"getInertia",value:function(t){var e,n=this.getColliders(),i=0,r=Object(f.a)(n);try{for(r.s();!(e=r.n()).done;){i+=e.value.getInertia(t)}}catch(a){r.e(a)}finally{r.f()}return i}},{key:"collide",value:function(t){var e=this,i=[t];t instanceof n&&(i=t.getColliders());var r,a=[],o=Object(f.a)(i);try{var s=function(){var t=r.value;e._dynamicAABBTree.query(t,(function(e){return a.push(new Nn(t,e)),!1}))};for(o.s();!(r=o.n()).done;)s()}catch(d){o.e(d)}finally{o.f()}for(var l=[],u=0,c=a;u<c.length;u++){var h=c[u];l=l.concat(h.collide())}return l}},{key:"getClosestLineBetween",value:function(t){var e=this.getColliders(),i=[];if(t instanceof n){var r,a=t.getColliders(),o=Object(f.a)(e);try{for(o.s();!(r=o.n()).done;){var s,l=r.value,u=Object(f.a)(a);try{for(u.s();!(s=u.n()).done;){var c=s.value,h=l.getClosestLineBetween(c);h&&i.push(h)}}catch(x){u.e(x)}finally{u.f()}}}catch(x){o.e(x)}finally{o.f()}}else{var d,p=Object(f.a)(e);try{for(p.s();!(d=p.n()).done;){var v=d.value,g=t.getClosestLineBetween(v);g&&i.push(g)}}catch(x){p.e(x)}finally{p.f()}}if(i.length){var y,m=i[0].getLength(),_=i[0],b=Object(f.a)(i);try{for(b.s();!(y=b.n()).done;){var w=y.value,k=w.getLength();k<m&&(m=k,_=w)}}catch(x){b.e(x)}finally{b.f()}return _}return null}},{key:"contains",value:function(t){var e,n=this.getColliders(),i=Object(f.a)(n);try{for(i.s();!(e=i.n()).done;){if(e.value.contains(t))return!0}}catch(r){i.e(r)}finally{i.f()}return!1}},{key:"rayCast",value:function(t,e){var n,i=this.getColliders(),r=[],a=Object(f.a)(i);try{for(a.s();!(n=a.n()).done;){var o=n.value.rayCast(t,e);o&&r.push(o)}}catch(p){a.e(p)}finally{a.f()}if(r.length){var s,l=r[0],u=l.dot(t.dir),c=Object(f.a)(r);try{for(c.s();!(s=c.n()).done;){var h=s.value,d=t.dir.dot(h);d<u&&(l=h,u=d)}}catch(p){c.e(p)}finally{c.f()}return l}return null}},{key:"project",value:function(t){var e,n=this.getColliders(),i=[],r=Object(f.a)(n);try{for(r.s();!(e=r.n()).done;){var a=e.value.project(t);a&&i.push(a)}}catch(c){r.e(c)}finally{r.f()}if(i.length){var o,s=new Un(i[0].min,i[0].max),l=Object(f.a)(i);try{for(l.s();!(o=l.n()).done;){var u=o.value;s.min=Math.min(u.min,s.min),s.max=Math.max(u.max,s.max)}}catch(c){l.e(c)}finally{l.f()}return s}return null}},{key:"update",value:function(t){if(t){var e,n=this.getColliders(),i=Object(f.a)(n);try{for(i.s();!(e=i.n()).done;){var r=e.value;r.owner=this.owner,r.update(t)}}catch(a){i.e(a)}finally{i.f()}}}},{key:"draw",value:function(t,e,n){var i,r=this.getColliders(),a=Object(f.a)(r);try{for(a.s();!(i=a.n()).done;){i.value.draw(t,e,n)}}catch(o){a.e(o)}finally{a.f()}}},{key:"debug",value:function(t,e){var n,i=this.getColliders(),r=Object(f.a)(i);try{for(r.s();!(n=r.n()).done;){n.value.debug(t,e)}}catch(a){r.e(a)}finally{r.f()}}},{key:"debugDraw",value:function(t,e){var n,i=this.getColliders(),r=Object(f.a)(i);try{for(r.s();!(n=r.n()).done;){n.value.draw(t,e)}}catch(a){r.e(a)}finally{r.f()}}},{key:"clone",value:function(){return new n(this._colliders.map((function(t){return t.clone()})))}}]),n}(Xn),Kn=function(){function t(e,n){Object(g.a)(this,t),this.begin=e,this.end=n}return Object(y.a)(t,[{key:"slope",get:function(){return(this.end.y-this.begin.y)/(this.end.x-this.begin.x)}},{key:"intercept",get:function(){return this.begin.y-this.slope*this.begin.x}},{key:"normal",value:function(){return this.end.sub(this.begin).normal()}},{key:"dir",value:function(){return this.end.sub(this.begin)}},{key:"getPoints",value:function(){return[this.begin,this.end]}},{key:"getSlope",value:function(){var t=this.begin,e=this.end,n=t.distance(e);return e.sub(t).scale(1/n)}},{key:"getEdge",value:function(){var t=this.begin;return this.end.sub(t)}},{key:"getLength",value:function(){var t=this.begin,e=this.end;return t.distance(e)}},{key:"midpoint",get:function(){return this.begin.add(this.end).scale(.5)}},{key:"flip",value:function(){return new t(this.end,this.begin)}},{key:"below",value:function(t){return(this.end.x-this.begin.x)*(t.y-this.begin.y)-(this.end.y-this.begin.y)*(t.x-this.begin.x)>=0}},{key:"clip",value:function(e,n){var i=e,r=(i=i.normalize()).dot(this.begin)-n,a=i.dot(this.end)-n,o=[];if(r<=0&&o.push(this.begin),a<=0&&o.push(this.end),r*a<0){var s=r/(r-a);o.push(this.begin.add(this.end.sub(this.begin).scale(s)))}return 2!==o.length?null:new t(o[0],o[1])}},{key:"distanceToPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t.x,i=t.y,r=this.getLength(),a=this.end.y-this.begin.y,o=this.end.x-this.begin.x,s=(a*n-o*i+this.end.x*this.begin.y-this.end.y*this.begin.x)/r;return e?s:Math.abs(s)}},{key:"findVectorToPoint",value:function(t){var e=this.begin.sub(t),n=this.getSlope();return e.sub(n.scale(e.dot(n)))}},{key:"findPoint",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.slope,i=this.intercept;if(null!==t)return new ot(t,n*t+i);if(null!==e)return new ot((e-i)/n,e);throw new Error("You must provide an X or a Y value")}},{key:"hasPoint",value:function(){var t,e=0;if("number"===typeof arguments[0]&&"number"===typeof arguments[1])t=new ot(arguments[0],arguments[1]),e=arguments[2]||0;else{if(!(arguments[0]instanceof ot))throw"Could not determine the arguments for Vector.hasPoint";t=arguments[0],e=arguments[1]||0}var n=t.x-this.begin.x,i=t.y-this.begin.y,r=this.end.x-this.begin.x,a=this.end.y-this.begin.y,o=n*a-i*r;return!(Math.abs(o)>e)&&(Math.abs(r)>=Math.abs(a)?r>0?this.begin.x<=t.x&&t.x<=this.end.x:this.end.x<=t.x&&t.x<=this.begin.x:a>0?this.begin.y<=t.y&&t.y<=this.end.y:this.end.y<=t.y&&t.y<=this.begin.y)}}]),t}();function Zn(t,e,n,i){var r=t.sub(n),a=e.dot(e),o=e.dot(i),s=i.dot(i),l=e.dot(r),u=i.dot(r),c=a*s-o*o,h=c,d=c;if(0===c||c<=.01){var f=l/o;return new Kn(t,n.add(i.scale(f)))}var p=o*u-s*l,v=a*u-o*l;return p<0?(p=0,v=u,d=s):p>h&&(p=h,v=u+o,d=s),v<0?(v=0,-l<0?p=0:-l>a?p=h:(p=-l,h=a)):v>d&&(v=d,-l+o<0?p=0:-l+o>a?p=h:(p=-l+o,h=a)),p=Math.abs(p)<.001?0:p/h,v=Math.abs(v)<.001?0:v/d,new Kn(t.add(e.scale(p)),n.add(i.scale(v)))}var Qn,Yn={PolygonPolygonClosestLine:function(t,e){var n=e.worldPos,i=n.sub(t.worldPos),r=i.negate(),a=new Vn(t.worldPos,i),o=new Vn(n,r),s=t.rayCast(a).add(a.dir.scale(.1)),l=e.rayCast(o).add(o.dir.scale(.1)),u=t.getClosestFace(s),c=e.getClosestFace(l);return Zn(u.face.begin,u.face.getEdge(),c.face.begin,c.face.getEdge())},PolygonEdgeClosestLine:function(t,e){var n=e.worldPos.sub(t.worldPos),i=new Vn(t.worldPos,n),r=t.rayCast(i).add(i.dir.scale(.1)),a=t.getClosestFace(r),o=a.face.begin,s=a.face.getEdge(),l=e.asLine();return Zn(o,s,l.begin,l.getEdge())},PolygonCircleClosestLine:function(t,e){var n=e.worldPos,i=n.sub(t.worldPos),r=new Vn(t.worldPos,i.normalize()),a=t.rayCast(r).add(r.dir.scale(.1)),o=t.getClosestFace(a),s=o.face.begin,l=o.face.getEdge(),u=(l.x*(n.x-s.x)+l.y*(n.y-s.y))/(l.x*l.x+l.y*l.y);u>1?u=1:u<0&&(u=0);var c=Math.sqrt(Math.pow(s.x+l.x*u-n.x,2)+Math.pow(s.y+l.y*u-n.y,2))-e.radius,h=(s.x+l.x*u-n.x)*e.radius/(e.radius+c),d=(s.y+l.y*u-n.y)*e.radius/(e.radius+c);return new Kn(l.scale(u).add(s),new ot(n.x+h,n.y+d))},CircleCircleClosestLine:function(t,e){var n=e.worldPos.sub(t.worldPos),i=t.worldPos.sub(e.worldPos),r=new Vn(t.worldPos,n),a=new Vn(e.worldPos,i),o=t.rayCast(r),s=e.rayCast(a);return new Kn(o,s)},CircleEdgeClosestLine:function(t,e){var n=t.worldPos,i=e.asLine(),r=i.begin,a=i.getEdge(),o=(a.x*(n.x-r.x)+a.y*(n.y-r.y))/(a.x*a.x+a.y*a.y);o>1?o=1:o<0&&(o=0);var s=Math.sqrt(Math.pow(r.x+a.x*o-n.x,2)+Math.pow(r.y+a.y*o-n.y,2))-t.radius,l=(r.x+a.x*o-n.x)*t.radius/(t.radius+s),u=(r.y+a.y*o-n.y)*t.radius/(t.radius+s);return new Kn(a.scale(o).add(r),new ot(n.x+l,n.y+u))},EdgeEdgeClosestLine:function(t,e){var n=t.asLine(),i=n.begin,r=n.getEdge(),a=e.asLine();return Zn(i,r,a.begin,a.getEdge())}},$n=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t){var i;return Object(g.a)(this,n),(i=e.call(this)).offset=ot.Zero,i.offset=t.offset||ot.Zero,i.radius=t.radius||0,i}return Object(y.a)(n,[{key:"worldPos",get:function(){var t,e;return this.offset.add(null!==(e=null===(t=this._transform)||void 0===t?void 0:t.pos)&&void 0!==e?e:ot.Zero)}},{key:"clone",value:function(){return new n({offset:this.offset.clone(),radius:this.radius})}},{key:"center",get:function(){var t,e;return this.offset.add(null!==(e=null===(t=this._transform)||void 0===t?void 0:t.pos)&&void 0!==e?e:ot.Zero)}},{key:"contains",value:function(t){var e,n;return(null!==(n=null===(e=this._transform)||void 0===e?void 0:e.pos)&&void 0!==n?n:this.offset).distance(t)<=this.radius}},{key:"rayCast",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,n=this.center,i=t.dir,r=t.pos,a=Math.sqrt(Math.pow(i.dot(r.sub(n)),2)-Math.pow(r.sub(n).distance(),2)+Math.pow(this.radius,2));if(a<0)return null;var o=0;if(0===a)return(o=-i.dot(r.sub(n)))>0&&o<e?t.getPoint(o):null;var s=-i.dot(r.sub(n))+a,l=-i.dot(r.sub(n))-a,u=[];s>=0&&u.push(s),l>=0&&u.push(l);var c=Math.min.apply(Math,u);return c<=e?t.getPoint(c):null}},{key:"getClosestLineBetween",value:function(t){if(t instanceof n)return Yn.CircleCircleClosestLine(this,t);if(t instanceof ii)return Yn.PolygonCircleClosestLine(t,this).flip();if(t instanceof ni)return Yn.CircleEdgeClosestLine(this,t).flip();throw new Error("Polygon could not collide with unknown CollisionShape ".concat(typeof t))}},{key:"collide",value:function(t){if(t instanceof n)return ei.CollideCircleCircle(this,t);if(t instanceof ii)return ei.CollideCirclePolygon(this,t);if(t instanceof ni)return ei.CollideCircleEdge(this,t);throw new Error("Circle could not collide with unknown CollisionShape ".concat(typeof t))}},{key:"getFurthestPoint",value:function(t){return this.center.add(t.normalize().scale(this.radius))}},{key:"getFurthestLocalPoint",value:function(t){return t.normalize().scale(this.radius)}},{key:"bounds",get:function(){var t,e=this._transform,n=null!==(t=null===e||void 0===e?void 0:e.globalPos)&&void 0!==t?t:ot.Zero;return new dt(this.offset.x+n.x-this.radius,this.offset.y+n.y-this.radius,this.offset.x+n.x+this.radius,this.offset.y+n.y+this.radius)}},{key:"localBounds",get:function(){return new dt(this.offset.x-this.radius,this.offset.y-this.radius,this.offset.x+this.radius,this.offset.y+this.radius)}},{key:"axes",get:function(){return[]}},{key:"getInertia",value:function(t){return t*this.radius*this.radius/2}},{key:"update",value:function(t){this._transform=t}},{key:"project",value:function(t){var e=[],n=this.center.dot(t);return e.push(n),e.push(n+this.radius),e.push(n-this.radius),new Un(Math.min.apply(Math,e),Math.max.apply(Math,e))}},{key:"draw",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ut.Green,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ot.Zero,i=n.add(this.offset);t.beginPath(),t.fillStyle=e.toString(),t.arc(i.x,i.y,this.radius,0,2*Math.PI),t.closePath(),t.fill()}},{key:"debug",value:function(t,e){var n=this._transform,i=(null===n||void 0===n?void 0:n.globalPos)?null===n||void 0===n?void 0:n.globalPos.add(this.offset):this.offset;t.drawCircle(i,this.radius,e)}},{key:"debugDraw",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ut.Green,n=this._transform,i=n?n.pos.add(this.offset):this.offset,r=n?n.rotation:0;t.beginPath(),t.strokeStyle=e.toString(),t.arc(i.x,i.y,this.radius,0,2*Math.PI),t.closePath(),t.stroke(),t.beginPath(),t.moveTo(i.x,i.y),t.lineTo(Math.cos(r)*this.radius+i.x,Math.sin(r)*this.radius+i.y),t.closePath(),t.stroke()}}]),n}(Xn),Jn=function(){function t(e,n,i,r,a,o,s,l){Object(g.a)(this,t),this._canceled=!1,this.colliderA=e,this.colliderB=n,this.mtv=i,this.normal=r,this.tangent=a,this.points=o,this.localPoints=s,this.info=l,this.id=Nn.calculatePairHash(e.id,n.id)}return Object(y.a)(t,[{key:"matchAwake",value:function(){var t=this.colliderA.owner.get(oi),e=this.colliderB.owner.get(oi);t&&e&&t.sleeping!==e.sleeping&&(t.sleeping&&t.collisionType!==_n.Fixed&&e.sleepMotion>=Pn.wakeThreshold&&t.setSleeping(!1),e.sleeping&&e.collisionType!==_n.Fixed&&t.sleepMotion>=Pn.wakeThreshold&&e.setSleeping(!1))}},{key:"isCanceled",value:function(){return this._canceled}},{key:"cancel",value:function(){this._canceled=!0}}]),t}(),ti=function(){function t(){Object(g.a)(this,t)}return Object(y.a)(t,null,[{key:"findPolygonPolygonSeparation",value:function(t,e){for(var n=-Number.MAX_VALUE,i=null,r=null,a=-1,o=null,s=t.getSides(),l=t.getLocalSides(),u=0;u<s.length;u++){var c=s[u],h=c.normal(),d=e.getFurthestPoint(h.negate()),f=c.distanceToPoint(d,!0);f>n&&(n=f,i=c,r=h,a=u,o=d)}return{collider:t,separation:r?n:99,axis:r,side:i,localSide:l[a],sideId:a,point:o,localPoint:r?e.getFurthestLocalPoint(r.negate()):null}}},{key:"findCirclePolygonSeparation",value:function(t,e){var n=e.axes,i=e.center.sub(t.worldPos),r=e.getFurthestPoint(i.negate());n.push(r.sub(t.worldPos).normalize());for(var a=Number.MAX_VALUE,o=null,s=-1,l=0;l<n.length;l++){var u=e.project(n[l]),c=t.project(n[l]),h=u.getOverlap(c);if(h<=0)return null;h<a&&(a=h,o=n[l],s=l)}return s<0?null:o.normalize().scale(a)}}]),t}(),ei={CollideCircleCircle:function(t,e){var n=t.worldPos,i=e.worldPos,r=t.radius+e.radius,a=n.distance(i);if(a>r)return[];var o=r-a,s=i.sub(n).normalize(),l=s.perpendicular(),u=s.scale(o),c=t.getFurthestPoint(s),h=t.getFurthestLocalPoint(s);return[new Jn(t,e,u,s,l,[c],[h],{collider:t,separation:o,axis:s,point:c})]},CollideCirclePolygon:function(t,e){var n,i,r=ti.findCirclePolygonSeparation(t,e);if(!r)return[];var a=r.dot(e.center.sub(t.center));r=a<0?r.negate():r;var o=t.getFurthestPoint(r),s=(null!==(i=null===(n=t.owner)||void 0===n?void 0:n.get(Bn))&&void 0!==i?i:new Bn).applyInverse(o),l=r.normalize(),u={collider:t,separation:-r.size,axis:l,point:o,localPoint:s,side:e.findSide(l.negate()),localSide:e.findLocalSide(l.negate())};return[new Jn(t,e,r,l,l.perpendicular(),[o],[s],u)]},CollideCircleEdge:function(t,e){var n=t.center,i=e.asLine(),r=i.end.sub(i.begin),a=r.dot(i.end.sub(n)),o=r.dot(n.sub(i.begin)),s=e.asLine(),l=e.asLocalLine();if(o<=0){var u=i.begin.sub(n),c=u.dot(u);if(c>t.radius*t.radius)return[];var h=u.normalize(),d=t.radius-Math.sqrt(c),f={collider:t,separation:d,axis:h,point:s.begin,side:s,localSide:l};return[new Jn(t,e,h.scale(d),h,h.perpendicular(),[s.begin],[l.begin],f)]}if(a<=0){var p=i.end.sub(n),v=p.dot(p);if(v>t.radius*t.radius)return[];var g=p.normalize(),y=t.radius-Math.sqrt(v),m={collider:t,separation:y,axis:g,point:s.end,side:s,localSide:l};return[new Jn(t,e,g.scale(y),g,g.perpendicular(),[s.end],[l.end],m)]}var _=r.dot(r),b=i.begin.scale(a).add(i.end.scale(o)).scale(1/_),w=n.sub(b),k=w.dot(w);if(k>t.radius*t.radius)return[];var x=r.perpendicular();x.dot(n.sub(i.begin))<0&&(x.x=-x.x,x.y=-x.y),x=x.normalize();var S=t.radius-Math.sqrt(k),C=x.scale(S),O={collider:t,separation:S,axis:x,point:b,side:s,localSide:l};return[new Jn(t,e,C,x.negate(),x.negate().perpendicular(),[b],[b.sub(e.worldPos)],O)]},CollideEdgeEdge:function(){return[]},CollidePolygonEdge:function(t,e){var n,i=t.center,r=e.center.sub(i).normalize(),a=new ii({points:[e.begin,e.end,e.end.add(r.scale(100)),e.begin.add(r.scale(100))],offset:e.offset});a.owner=e.owner,(null===(n=e.owner)||void 0===n?void 0:n.get(Bn))&&a.update(e.owner.get(Bn));var o=this.CollidePolygonPolygon(t,a);return o.length&&(o[0].colliderB=e,o[0].id=Nn.calculatePairHash(t.id,e.id)),o},CollidePolygonPolygon:function(t,e){var n,i,r,a,o=ti.findPolygonPolygonSeparation(t,e);if(o.separation>0)return[];var s=ti.findPolygonPolygonSeparation(e,t);if(s.separation>0)return[];var l=o.separation>s.separation?o:s,u=(l.collider===t?e:t).findSide(l.axis.negate()),c=l.side,h=c.dir().normalize(),d=u.clip(h.negate(),-h.dot(c.begin)),f=null;if(d&&(f=d.clip(h,h.dot(c.end))),f){var p=f.getPoints().filter((function(t){return c.below(t)})),v=l.axis,g=v.perpendicular();e.worldPos.sub(t.worldPos).dot(v)<0&&(g=(v=v.negate()).perpendicular());var y=[];if(l.collider===t){var m=null!==(i=null===(n=e.owner)||void 0===n?void 0:n.get(Bn))&&void 0!==i?i:new Bn;y=p.map((function(t){return m.applyInverse(t)}))}else{var _=null!==(a=null===(r=t.owner)||void 0===r?void 0:r.get(Bn))&&void 0!==a?a:new Bn;y=p.map((function(t){return _.applyInverse(t)}))}return[new Jn(t,e,v.scale(-l.separation),v,g,p,y,l)]}return[]},FindContactSeparation:function(t,e){var n,i,r,a,o,s,l,u=t.colliderA,c=null!==(i=null===(n=t.colliderA.owner)||void 0===n?void 0:n.get(Bn))&&void 0!==i?i:new Bn,h=t.colliderB,d=null!==(a=null===(r=t.colliderB.owner)||void 0===r?void 0:r.get(Bn))&&void 0!==a?a:new Bn;if(u instanceof $n&&h instanceof $n)return-(u.radius+h.radius-c.pos.distance(d.pos));if(u instanceof ii&&h instanceof ii&&t.info.localSide)return t.info.collider===u?(o=new Kn(c.apply(t.info.localSide.begin),c.apply(t.info.localSide.end)),s=d.apply(e)):(o=new Kn(d.apply(t.info.localSide.begin),d.apply(t.info.localSide.end)),s=c.apply(e)),o.distanceToPoint(s,!0);if(u instanceof ii&&h instanceof $n||h instanceof ii&&u instanceof $n){var f=c.apply(e);if(t.info.side)return t.info.side.distanceToPoint(f,!0)}if((u instanceof ni&&h instanceof ii||h instanceof ni&&u instanceof ii)&&(l=t.info.collider===u?d.apply(e):c.apply(e),t.info.side))return t.info.side.distanceToPoint(l,!0);if(u instanceof $n&&h instanceof ni||h instanceof $n&&u instanceof ni){var p,v=d.apply(e);u instanceof $n&&(p=u.getFurthestPoint(t.normal));var g=v.distance(p);if(t.info.side)return g>0?-g:0}return 0}},ni=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t){var i,r;return Object(g.a)(this,n),(i=e.call(this)).begin=t.begin||ot.Zero,i.end=t.end||ot.Zero,i.offset=null!==(r=t.offset)&&void 0!==r?r:ot.Zero,i}return Object(y.a)(n,[{key:"clone",value:function(){return new n({begin:this.begin.clone(),end:this.end.clone()})}},{key:"worldPos",get:function(){var t,e=this._transform;return null!==(t=null===e||void 0===e?void 0:e.globalPos.add(this.offset))&&void 0!==t?t:this.offset}},{key:"center",get:function(){return this.begin.average(this.end).add(this._getBodyPos())}},{key:"_getBodyPos",value:function(){var t,e=this._transform;return null!==(t=null===e||void 0===e?void 0:e.globalPos)&&void 0!==t?t:ot.Zero}},{key:"_getTransformedBegin",value:function(){var t=this._transform,e=t?t.globalRotation:0;return this.begin.rotate(e).add(this._getBodyPos())}},{key:"_getTransformedEnd",value:function(){var t=this._transform,e=t?t.globalRotation:0;return this.end.rotate(e).add(this._getBodyPos())}},{key:"getSlope",value:function(){var t=this._getTransformedBegin(),e=this._getTransformedEnd(),n=t.distance(e);return e.sub(t).scale(1/n)}},{key:"getLength",value:function(){var t=this._getTransformedBegin(),e=this._getTransformedEnd();return t.distance(e)}},{key:"contains",value:function(){return!1}},{key:"rayCast",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,n=this._getTransformedBegin().sub(t.pos);if(0===t.dir.cross(this.getSlope())&&0!==n.cross(t.dir))return null;var i=t.dir.cross(this.getSlope());if(0===i)return null;var r=n.cross(this.getSlope())/i;if(r>=0&&r<=e){var a=n.cross(t.dir)/i/this.getLength();if(a>=0&&a<=1)return t.getPoint(r)}return null}},{key:"getClosestLineBetween",value:function(t){if(t instanceof $n)return Yn.CircleEdgeClosestLine(t,this);if(t instanceof ii)return Yn.PolygonEdgeClosestLine(t,this).flip();if(t instanceof n)return Yn.EdgeEdgeClosestLine(this,t);throw new Error("Polygon could not collide with unknown CollisionShape ".concat(typeof t))}},{key:"collide",value:function(t){if(t instanceof $n)return ei.CollideCircleEdge(t,this);if(t instanceof ii)return ei.CollidePolygonEdge(t,this);if(t instanceof n)return ei.CollideEdgeEdge();throw new Error("Edge could not collide with unknown CollisionShape ".concat(typeof t))}},{key:"getFurthestPoint",value:function(t){var e=this._getTransformedBegin(),n=this._getTransformedEnd();return t.dot(e)>0?e:n}},{key:"_boundsFromBeginEnd",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;return new dt(Math.min(t.x,e.x)-n,Math.min(t.y,e.y)-n,Math.max(t.x,e.x)+n,Math.max(t.y,e.y)+n)}},{key:"bounds",get:function(){var t=this._getTransformedBegin(),e=this._getTransformedEnd();return this._boundsFromBeginEnd(t,e)}},{key:"localBounds",get:function(){return this._boundsFromBeginEnd(this.begin,this.end)}},{key:"asLine",value:function(){return new Kn(this._getTransformedBegin(),this._getTransformedEnd())}},{key:"asLocalLine",value:function(){return new Kn(this.begin,this.end)}},{key:"axes",get:function(){var t=this._getTransformedEnd().sub(this._getTransformedBegin()).normal(),e=[];return e.push(t),e.push(t.negate()),e.push(t.normal()),e.push(t.normal().negate()),e}},{key:"getInertia",value:function(t){var e=this.end.sub(this.begin).distance()/2;return t*e*e}},{key:"update",value:function(t){this._transform=t}},{key:"project",value:function(t){for(var e=[],n=[this._getTransformedBegin(),this._getTransformedEnd()],i=n.length,r=0;r<i;r++)e.push(n[r].dot(t));return new Un(Math.min.apply(Math,e),Math.max.apply(Math,e))}},{key:"draw",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ut.Green,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ot.Zero,i=this.begin.add(n),r=this.end.add(n);t.strokeStyle=e.toString(),t.beginPath(),t.moveTo(i.x,i.y),t.lineTo(r.x,r.y),t.closePath(),t.stroke()}},{key:"debug",value:function(t,e){var n=this._getTransformedBegin(),i=this._getTransformedEnd();t.drawLine(n,i,e,2),t.drawCircle(n,2,e),t.drawCircle(i,2,e)}},{key:"debugDraw",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ut.Red,n=this._getTransformedBegin(),i=this._getTransformedEnd();t.strokeStyle=e.toString(),t.beginPath(),t.moveTo(n.x,n.y),t.lineTo(i.x,i.y),t.closePath(),t.stroke()}}]),n}(Xn),ii=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t){var i,r;Object(g.a)(this,n),(i=e.call(this))._transformedPoints=[],i._axes=[],i._sides=[],i._localSides=[],i.offset=null!==(r=t.offset)&&void 0!==r?r:ot.Zero;var a=!!t.clockwiseWinding;return i.points=(a?t.points.reverse():t.points)||[],i._calculateTransformation(),i}return Object(y.a)(n,[{key:"clone",value:function(){return new n({offset:this.offset.clone(),points:this.points.map((function(t){return t.clone()}))})}},{key:"worldPos",get:function(){return this._transform?this._transform.pos.add(this.offset):this.offset}},{key:"center",get:function(){return this.bounds.center}},{key:"_calculateTransformation",value:function(){var t=this._transform,e=t?t.globalPos.add(this.offset):this.offset,n=t?t.globalRotation:0,i=t?t.globalScale:ot.One,r=this.points.length;this._transformedPoints.length=0;for(var a=0;a<r;a++)this._transformedPoints[a]=this.points[a].scale(i).rotate(n).add(e)}},{key:"getTransformedPoints",value:function(){return this._calculateTransformation(),this._transformedPoints}},{key:"getSides",value:function(){if(this._sides.length)return this._sides;for(var t=[],e=this.getTransformedPoints(),n=e.length,i=0;i<n;i++)t.push(new Kn(e[i],e[(i+1)%n]));return this._sides=t,this._sides}},{key:"getLocalSides",value:function(){if(this._localSides.length)return this._localSides;for(var t=[],e=this.points,n=e.length,i=0;i<n;i++)t.push(new Kn(e[i],e[(i+1)%n]));return this._localSides=t,this._localSides}},{key:"findSide",value:function(t){for(var e=this.getSides(),n=e[0],i=-Number.MAX_VALUE,r=0;r<e.length;r++){var a=e[r],o=a.normal().dot(t);o>i&&(n=a,i=o)}return n}},{key:"findLocalSide",value:function(t){for(var e=this.getLocalSides(),n=e[0],i=-Number.MAX_VALUE,r=0;r<e.length;r++){var a=e[r],o=a.normal().dot(t);o>i&&(n=a,i=o)}return n}},{key:"axes",get:function(){if(this._axes.length)return this._axes;var t=this.getSides().map((function(t){return t.normal()}));return this._axes=t,this._axes}},{key:"update",value:function(t){this._transform=t,this._sides.length=0,this._localSides.length=0,this._axes.length=0,this._transformedPoints.length=0,this.getTransformedPoints(),this.getSides(),this.getLocalSides()}},{key:"contains",value:function(t){var e=new Vn(t,new ot(1,0));return this.getSides().reduce((function(t,n){return e.intersect(n)>=0?t+1:t}),0)%2!==0}},{key:"getClosestLineBetween",value:function(t){if(t instanceof $n)return Yn.PolygonCircleClosestLine(this,t);if(t instanceof n)return Yn.PolygonPolygonClosestLine(this,t);if(t instanceof ni)return Yn.PolygonEdgeClosestLine(this,t);throw new Error("Polygon could not collide with unknown CollisionShape ".concat(typeof t))}},{key:"collide",value:function(t){if(t instanceof $n)return ei.CollideCirclePolygon(t,this);if(t instanceof n)return ei.CollidePolygonPolygon(this,t);if(t instanceof ni)return ei.CollidePolygonEdge(this,t);throw new Error("Polygon could not collide with unknown CollisionShape ".concat(typeof t))}},{key:"getFurthestPoint",value:function(t){for(var e=this.getTransformedPoints(),n=null,i=-Number.MAX_VALUE,r=0;r<e.length;r++){var a=t.dot(e[r]);a>i&&(i=a,n=e[r])}return n}},{key:"getFurthestLocalPoint",value:function(t){for(var e=this.points,n=e[0],i=-Number.MAX_VALUE,r=0;r<e.length;r++){var a=t.dot(e[r]);a>i&&(i=a,n=e[r])}return n}},{key:"getClosestFace",value:function(t){for(var e=this.getSides(),n=Number.POSITIVE_INFINITY,i=-1,r=-1,a=0;a<e.length;a++){var o=e[a].distanceToPoint(t);o<n&&(n=o,i=a,r=o)}return-1!==i?{distance:e[i].normal().scale(r),face:e[i]}:null}},{key:"bounds",get:function(){var t,e,n,i=this._transform,r=null!==(t=null===i||void 0===i?void 0:i.globalScale)&&void 0!==t?t:ot.One,a=null!==(e=null===i||void 0===i?void 0:i.globalRotation)&&void 0!==e?e:0,o=(null!==(n=null===i||void 0===i?void 0:i.globalPos)&&void 0!==n?n:ot.Zero).add(this.offset);return this.localBounds.scale(r).rotate(a).translate(o)}},{key:"localBounds",get:function(){return dt.fromPoints(this.points)}},{key:"getInertia",value:function(t){for(var e=0,n=0,i=0;i<this.points.length;i++){var r=(i+1)%this.points.length,a=this.points[r].cross(this.points[i]);e+=a*(this.points[i].dot(this.points[i])+this.points[i].dot(this.points[r])+this.points[r].dot(this.points[r])),n+=a}return t/6*(e/n)}},{key:"rayCast",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,n=this.getSides(),i=n.length,r=Number.MAX_VALUE,a=-1,o=0;o<i;o++){var s=t.intersect(n[o]);s>=0&&s<r&&s<=e&&(r=s,a=o)}return a>=0?t.getPoint(r):null}},{key:"project",value:function(t){for(var e=this.getTransformedPoints(),n=e.length,i=Number.MAX_VALUE,r=-Number.MAX_VALUE,a=0;a<n;a++){var o=e[a].dot(t);i=Math.min(i,o),r=Math.max(r,o)}return new Un(i,r)}},{key:"draw",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ut.Green,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ot.Zero,i=n.add(this.offset);t.beginPath(),t.fillStyle=e.toString();var r=this.points[0].add(i);t.moveTo(r.x,r.y),this.points.map((function(t){return t.add(i)})).forEach((function(e){t.lineTo(e.x,e.y)})),t.lineTo(r.x,r.y),t.closePath(),t.fill()}},{key:"debug",value:function(t,e){for(var n=this.getTransformedPoints()[0],i=[n].concat(d(this.getTransformedPoints()),[n]),r=0;r<i.length-1;r++)t.drawLine(i[r],i[r+1],e,2),t.drawCircle(i[r],2,e),t.drawCircle(i[r+1],2,e)}},{key:"debugDraw",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ut.Red;t.beginPath(),t.strokeStyle=e.toString();var n=this.getTransformedPoints()[0];t.moveTo(n.x,n.y),this.getTransformedPoints().forEach((function(e){t.lineTo(e.x,e.y)})),t.lineTo(n.x,n.y),t.closePath(),t.stroke()}}]),n}(Xn),ri=function(){function t(){Object(g.a)(this,t)}return Object(y.a)(t,null,[{key:"Box",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ot.Half,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:ot.Zero;return new ii({points:new dt(-t*n.x,-e*n.y,t-t*n.x,e-e*n.y).getPoints(),offset:i})}},{key:"Polygon",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ot.Zero;return new ii({points:t,offset:n,clockwiseWinding:e})}},{key:"Circle",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ot.Zero;return new $n({radius:t,offset:e})}},{key:"Edge",value:function(t,e){return new ni({begin:t,end:e})}},{key:"Capsule",value:function(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ot.Zero,r=A.getInstance();e===n&&r.warn("A capsule collider with equal width and height is a circle, consider using a ex.Shape.Circle or ex.CircleCollider");var a=n>=e;if(a){var o=new qn([t.Circle(e/2,st(0,-n/2+e/2).add(i)),t.Box(e,n-e,ot.Half,i),t.Circle(e/2,st(0,n/2-e/2).add(i))]);return o}var s=new qn([t.Circle(n/2,st(-e/2+n/2,0).add(i)),t.Box(e-n,n,ot.Half,i),t.Circle(n/2,st(e/2-n/2,0).add(i))]);return s}}]),t}(),ai=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t){var i;return Object(g.a)(this,n),(i=e.call(this)).type="ex.collider",i.events=new xe(Object(o.a)(i)),i.$colliderAdded=new zn,i.$colliderRemoved=new zn,i.set(t),i}return Object(y.a)(n,[{key:"get",value:function(){return this._collider}},{key:"set",value:function(t){return this.clear(),t&&(this._collider=t,this._collider.owner=this.owner,this.events.wire(t.events),this.$colliderAdded.notifyAll(t),this.update()),t}},{key:"clear",value:function(){this._collider&&(this.events.unwire(this._collider.events),this.$colliderRemoved.notifyAll(this._collider),this._collider.owner=null,this._collider=null)}},{key:"bounds",get:function(){var t,e;return null!==(e=null===(t=this._collider)||void 0===t?void 0:t.bounds)&&void 0!==e?e:new dt}},{key:"localBounds",get:function(){var t,e;return null!==(e=null===(t=this._collider)||void 0===t?void 0:t.localBounds)&&void 0!==e?e:new dt}},{key:"update",value:function(){var t,e=null===(t=this.owner)||void 0===t?void 0:t.get(Bn);this._collider&&(this._collider.owner=this.owner,e&&this._collider.update(e))}},{key:"collide",value:function(t){var e=this,n=this._collider,i=t._collider;if(!n||!i)return[];var r=!1;if(i instanceof qn&&(n=i,i=this._collider,r=!0),this._collider){var a=n.collide(i);return a?(r&&a.forEach((function(n){n.mtv=n.mtv.negate(),n.normal=n.normal.negate(),n.tangent=n.normal.perpendicular(),n.colliderA=e._collider,n.colliderB=t._collider})),a):[]}return[]}},{key:"onAdd",value:function(t){this._collider&&this.update(),this.events.on("precollision",(function(e){var n=e;t.events.emit("precollision",new le(n.target.owner,n.other.owner,n.side,n.intersection))})),this.events.on("postcollision",(function(e){var n=e;t.events.emit("postcollision",new ue(n.target.owner,n.other.owner,n.side,n.intersection))})),this.events.on("collisionstart",(function(e){var n=e;t.events.emit("collisionstart",new pe(n.target.owner,n.other.owner,n.contact))})),this.events.on("collisionend",(function(e){var n=e;t.events.emit("collisionend",new ve(n.target.owner,n.other.owner))}))}},{key:"onRemove",value:function(){this.events.clear(),this.$colliderRemoved.notifyAll(this._collider)}},{key:"useBoxCollider",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ot.Half,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:ot.Zero,r=ri.Box(t,e,n,i);return this.set(r)}},{key:"usePolygonCollider",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ot.Zero,n=ri.Polygon(t,!1,e);return this.set(n)}},{key:"useCircleCollider",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ot.Zero,n=ri.Circle(t,e);return this.set(n)}},{key:"useEdgeCollider",value:function(t,e){var n=ri.Edge(t,e);return this.set(n)}},{key:"useCompositeCollider",value:function(t){return this.set(new qn(t))}}]),n}(Rn);!function(t){t.Rotation="rotation",t.X="x",t.Y="y"}(Qn||(Qn={}));var oi=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t){var i,r,a,s;return Object(g.a)(this,n),(i=e.call(this)).type="ex.body",i.dependencies=[Bn,Fn],i.id=E("body",n._ID++),i.events=new xe(Object(o.a)(i)),i.collisionType=_n.PreventCollision,i.group=In.All,i.mass=Pn.defaultMass,i.sleepMotion=5*Pn.sleepEpsilon,i.canSleep=Pn.bodiesCanSleepByDefault,i._sleeping=!1,i.bounciness=.2,i.friction=.99,i.useGravity=!0,i.limitDegreeOfFreedom=[],i.oldPos=new ot(0,0),i.oldVel=new ot(0,0),i.oldAcc=ot.Zero,i.oldRotation=0,i.oldScale=ot.One,t&&(i.collisionType=null!==(r=t.type)&&void 0!==r?r:i.collisionType,i.group=null!==(a=t.group)&&void 0!==a?a:i.group,i.useGravity=null!==(s=t.useGravity)&&void 0!==s?s:i.useGravity),i}return Object(y.a)(n,[{key:"inverseMass",get:function(){return this.collisionType===_n.Fixed?0:1/this.mass}},{key:"sleeping",get:function(){return this._sleeping}},{key:"setSleeping",value:function(t){this._sleeping=t,t?(this.vel=ot.Zero,this.acc=ot.Zero,this.angularVelocity=0,this.sleepMotion=0):this.sleepMotion=5*Pn.sleepEpsilon}},{key:"updateMotion",value:function(){this._sleeping&&this.setSleeping(!0);var t=this.vel.size*this.vel.size+Math.abs(this.angularVelocity*this.angularVelocity),e=Pn.sleepBias;this.sleepMotion=e*this.sleepMotion+(1-e)*t,this.sleepMotion=I(this.sleepMotion,0,10*Pn.sleepEpsilon),this.canSleep&&this.sleepMotion<Pn.sleepEpsilon&&this.setSleeping(!0)}},{key:"inertia",get:function(){var t=this.owner.get(ai);return(null===t||void 0===t?void 0:t.get())?t.get().getInertia(this.mass):0}},{key:"inverseInertia",get:function(){return this.collisionType===_n.Fixed?0:1/this.inertia}},{key:"active",get:function(){var t;return!!(null===(t=this.owner)||void 0===t?void 0:t.active)}},{key:"center",get:function(){return this.pos}},{key:"transform",get:function(){var t;return null===(t=this.owner)||void 0===t?void 0:t.get(Bn)}},{key:"motion",get:function(){var t;return null===(t=this.owner)||void 0===t?void 0:t.get(Fn)}},{key:"pos",get:function(){return this.transform.globalPos},set:function(t){this.transform.globalPos=t}},{key:"vel",get:function(){return this.motion.vel},set:function(t){this.motion.vel=t}},{key:"acc",get:function(){return this.motion.acc},set:function(t){this.motion.acc=t}},{key:"torque",get:function(){return this.motion.torque},set:function(t){this.motion.torque=t}},{key:"rotation",get:function(){return this.transform.globalRotation},set:function(t){this.transform.globalRotation=t}},{key:"scale",get:function(){return this.transform.globalScale},set:function(t){this.transform.globalScale=t}},{key:"sx",get:function(){return this.motion.scaleFactor.x},set:function(t){this.motion.scaleFactor.x=t}},{key:"sy",get:function(){return this.motion.scaleFactor.y},set:function(t){this.motion.scaleFactor.y=t}},{key:"rx",get:function(){return this.motion.angularVelocity},set:function(t){this.motion.angularVelocity=t}},{key:"angularVelocity",get:function(){return this.motion.angularVelocity},set:function(t){this.motion.angularVelocity=t}},{key:"applyImpulse",value:function(t,e){if(this.collisionType===_n.Active){var n=e.scale(this.inverseMass);if(this.limitDegreeOfFreedom.includes(Qn.X)&&(n.x=0),this.limitDegreeOfFreedom.includes(Qn.Y)&&(n.y=0),this.vel.addEqual(n),!this.limitDegreeOfFreedom.includes(Qn.Rotation)){var i=t.sub(this.pos);this.angularVelocity+=this.inverseInertia*i.cross(e)}}}},{key:"applyLinearImpulse",value:function(t){if(this.collisionType===_n.Active){var e=t.scale(this.inverseMass);this.limitDegreeOfFreedom.includes(Qn.X)&&(e.x=0),this.limitDegreeOfFreedom.includes(Qn.Y)&&(e.y=0),this.vel=this.vel.add(e)}}},{key:"applyAngularImpulse",value:function(t,e){if(this.collisionType===_n.Active&&!this.limitDegreeOfFreedom.includes(Qn.Rotation)){var n=t.sub(this.pos);this.angularVelocity+=this.inverseInertia*n.cross(e)}}},{key:"captureOldTransform",value:function(){this.oldVel.setTo(this.vel.x,this.vel.y),this.oldPos.setTo(this.pos.x,this.pos.y),this.oldAcc.setTo(this.acc.x,this.acc.y),this.oldScale.setTo(this.scale.x,this.scale.y),this.oldRotation=this.rotation}},{key:"debugDraw",value:function(t){}}]),n}(Rn);oi._ID=0;var si=function(){function t(){Object(g.a)(this,t),this._topLeft=new ot(0,0),this._topRight=new ot(0,0),this._bottomLeft=new ot(0,0),this._bottomRight=new ot(0,0)}return Object(y.a)(t,[{key:"isSpriteOffScreen",value:function(t,e){var n=t.currentDrawing.drawWidth,i=t.currentDrawing.drawHeight,r=t.rotation,a=t.center,o=t.getGlobalPos();this._topLeft=st(o.x-n/2,o.y-i/2),this._topLeft=this._topLeft.rotate(r,a),this._topRight=st(o.x+n/2,o.y-i/2),this._topRight=this._topRight.rotate(r,a),this._bottomLeft=st(o.x-n/2,o.y+i/2),this._bottomLeft=this._bottomLeft.rotate(r,a),this._bottomRight=st(o.x+n/2,o.y+i/2),this._bottomRight=this._bottomRight.rotate(r,a);var s=e.worldToScreenCoordinates(this._topLeft),l=e.worldToScreenCoordinates(this._topRight),u=e.worldToScreenCoordinates(this._bottomLeft),c=e.worldToScreenCoordinates(this._bottomRight);this._xCoords=[],this._yCoords=[],this._xCoords.push(s.x,l.x,u.x,c.x),this._yCoords.push(s.y,l.y,u.y,c.y),this._xMin=Math.min.apply(null,this._xCoords),this._yMin=Math.min.apply(null,this._yCoords),this._xMax=Math.max.apply(null,this._xCoords),this._yMax=Math.max.apply(null,this._yCoords);var h=e.screenToWorldCoordinates(new ot(this._xMin,this._yMin)),d=e.screenToWorldCoordinates(new ot(this._xMax,this._yMax));this._xMinWorld=h.x,this._yMinWorld=h.y,this._xMaxWorld=d.x,this._yMaxWorld=d.y;var f=[new ot(this._xMin,this._yMin),new ot(this._xMax,this._yMin),new ot(this._xMin,this._yMax),new ot(this._xMax,this._yMax)];if(f[0].x<0&&f[1].x>e.canvas.clientWidth&&(f[0].y>0||f[2].y<e.canvas.clientHeight))return!1;if(f[0].y<0&&f[2].y>e.canvas.clientHeight&&(f[1].x>0||f[0].x<e.canvas.clientWidth))return!1;for(var p=0;p<f.length;p++)if(f[p].x>0&&f[p].y>0&&f[p].x<e.canvas.clientWidth&&f[p].y<e.canvas.clientHeight)return!1;return!0}},{key:"debugDraw",value:function(t){t.beginPath(),t.strokeStyle=ut.White.toString(),t.rect(this._xMinWorld,this._yMinWorld,this._xMaxWorld-this._xMinWorld,this._yMaxWorld-this._yMinWorld),t.stroke(),t.fillStyle=ut.Red.toString(),t.beginPath(),t.arc(this._topLeft.x,this._topLeft.y,5,0,2*Math.PI),t.closePath(),t.fill(),t.fillStyle=ut.Green.toString(),t.beginPath(),t.arc(this._topRight.x,this._topRight.y,5,0,2*Math.PI),t.closePath(),t.fill(),t.fillStyle=ut.Blue.toString(),t.beginPath(),t.arc(this._bottomLeft.x,this._bottomLeft.y,5,0,2*Math.PI),t.closePath(),t.fill(),t.fillStyle=ut.Magenta.toString(),t.beginPath(),t.arc(this._bottomRight.x,this._bottomRight.y,5,0,2*Math.PI),t.closePath(),t.fill()}}]),t}(),li=function(){function t(){Object(g.a)(this,t),this.cullingBox=new si}return Object(y.a)(t,[{key:"update",value:function(t,e){var n=t.eventDispatcher,i=!0;null!=t.currentDrawing&&(i=this.cullingBox.isSpriteOffScreen(t,e));var r=!1;e&&e.currentScene&&e.currentScene.camera&&e.currentScene.camera.viewport&&!t.parent&&(r=!e.currentScene.camera.viewport.intersect(t.collider.bounds)),t.isOffScreen?r&&i||(n.emit("enterviewport",new be(t)),t.removeComponent("offscreen")):r&&i&&(n.emit("exitviewport",new _e(t)),t.addComponent(new Dn("offscreen")))}}]),t}(),ui=function(){function t(){Object(g.a)(this,t)}return Object(y.a)(t,[{key:"update",value:function(t,e){t.enableCapturePointer&&(t.isKilled()||e.input.pointers.checkAndUpdateActorUnderPointer(t))}}]),t}(),ci=function t(e){Object(g.a)(this,t),this.data=e,this.type="Component Added"};function hi(t){return!!t&&"Component Added"===t.type}var di=function t(e){Object(g.a)(this,t),this.data=e,this.type="Component Removed"};function fi(t){return!!t&&"Component Removed"===t.type}var pi=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t,i){var r;if(Object(g.a)(this,n),(r=e.call(this)).id=n._ID++,r._name="anonymous",r.active=!0,r._componentsToRemove=[],r._componentTypeToInstance=new Map,r._componentStringToInstance=new Map,r._tagsMemo=[],r._typesMemo=[],r.componentAdded$=new zn,r.componentRemoved$=new zn,r._parent=null,r.childrenAdded$=new zn,r.childrenRemoved$=new zn,r._children=[],r._isInitialized=!1,r._setName(i),t){var a,o=Object(f.a)(t);try{for(o.s();!(a=o.n()).done;){var s=a.value;r.addComponent(s)}}catch(l){o.e(l)}finally{o.f()}}return r}return Object(y.a)(n,[{key:"_setName",value:function(t){t&&(this._name=t)}},{key:"name",get:function(){return this._name}},{key:"events",get:function(){return this.eventDispatcher}},{key:"kill",value:function(){this.active=!1}},{key:"isKilled",value:function(){return!this.active}},{key:"tags",get:function(){return this._tagsMemo}},{key:"hasTag",value:function(t){return this.tags.includes(t)}},{key:"addTag",value:function(t){return this.addComponent(new Dn(t))}},{key:"removeTag",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.removeComponent(t,e)}},{key:"types",get:function(){return this._typesMemo}},{key:"_rebuildMemos",value:function(){this._tagsMemo=Array.from(this._componentStringToInstance.values()).filter((function(t){return t instanceof Dn})).map((function(t){return t.type})),this._typesMemo=Array.from(this._componentStringToInstance.keys())}},{key:"getComponents",value:function(){return Array.from(this._componentStringToInstance.values())}},{key:"_notifyAddComponent",value:function(t){this._rebuildMemos();var e=new ci({component:t,entity:this});this.componentAdded$.notifyAll(e)}},{key:"_notifyRemoveComponent",value:function(t){var e=new di({component:t,entity:this});this.componentRemoved$.notifyAll(e),this._rebuildMemos()}},{key:"parent",get:function(){return this._parent}},{key:"children",get:function(){return this._children}},{key:"unparent",value:function(){this._parent&&(this._parent.removeChild(this),this._parent=null)}},{key:"addChild",value:function(t){if(null!==t.parent)throw new Error("Entity already has a parent, cannot add without unparenting");if(this.getAncestors().includes(t))throw new Error("Cycle detected, cannot add entity");return this._children.push(t),t._parent=this,this.childrenAdded$.notifyAll(t),this}},{key:"removeChild",value:function(t){return t.parent===this&&(X(t,this._children),t._parent=null,this.childrenRemoved$.notifyAll(t)),this}},{key:"removeAllChildren",value:function(){var t=this;return this.children.forEach((function(e){t.removeChild(e)})),this}},{key:"getAncestors",value:function(){for(var t=[this],e=this.parent;e;)t.push(e),e=e.parent;return t.reverse()}},{key:"getDescendants",value:function(){for(var t=[this],e=[this];e.length>0;){var n=e.pop();e=e.concat(n.children),t=t.concat(n.children)}return t}},{key:"clone",value:function(){var t,e=new n,i=Object(f.a)(this.types);try{for(i.s();!(t=i.n()).done;){var r=t.value;e.addComponent(this.get(r).clone())}}catch(l){i.e(l)}finally{i.f()}var a,o=Object(f.a)(this.children);try{for(o.s();!(a=o.n()).done;){var s=a.value;e.addChild(s.clone())}}catch(l){o.e(l)}finally{o.f()}return e}},{key:"addTemplate",value:function(t){var e,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=Object(f.a)(t.getComponents());try{for(i.s();!(e=i.n()).done;){var r=e.value;this.addComponent(r.clone(),n)}}catch(l){i.e(l)}finally{i.f()}var a,o=Object(f.a)(t.children);try{for(o.s();!(a=o.n()).done;){var s=a.value;this.addChild(s.clone().addTemplate(s))}}catch(l){o.e(l)}finally{o.f()}return this}},{key:"addComponent",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.has(t.type)){if(!e)return this;this.removeComponent(t)}if(t.dependencies&&t.dependencies.length){var n,i=Object(f.a)(t.dependencies);try{for(i.s();!(n=i.n()).done;){var r=n.value;this.addComponent(new r)}}catch(o){i.e(o)}finally{i.f()}}t.owner=this;var a=t.constructor;return this._componentTypeToInstance.set(a,t),this._componentStringToInstance.set(t.type,t),t.onAdd&&t.onAdd(this),this._notifyAddComponent(t),this}},{key:"removeComponent",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e?"string"===typeof t?this._removeComponentByType(t):t instanceof Rn&&this._removeComponentByType(t.type):this._componentsToRemove.push(t),this}},{key:"_removeComponentByType",value:function(t){if(this.has(t)){var e=this.get(t);e.owner=null,e.onRemove&&e.onRemove(this);var n=e.constructor;this._componentTypeToInstance.delete(n),this._componentStringToInstance.delete(e.type),this._notifyRemoveComponent(e)}}},{key:"processComponentRemoval",value:function(){var t,e=Object(f.a)(this._componentsToRemove);try{for(e.s();!(t=e.n()).done;){var n=t.value,i="string"===typeof n?n:n.type;this._removeComponentByType(i)}}catch(r){e.e(r)}finally{e.f()}this._componentsToRemove.length=0}},{key:"has",value:function(t){return"string"===typeof t?this._componentStringToInstance.has(t):this._componentTypeToInstance.has(t)}},{key:"get",value:function(t){return"string"===typeof t?this._componentStringToInstance.get(t):this._componentTypeToInstance.get(t)}},{key:"isInitialized",get:function(){return this._isInitialized}},{key:"_initialize",value:function(t){this.isInitialized||(this.onInitialize(t),Object(s.a)(Object(l.a)(n.prototype),"emit",this).call(this,"initialize",new ge(t,this)),this._isInitialized=!0)}},{key:"_preupdate",value:function(t,e){this.emit("preupdate",new Qt(t,e,this)),this.onPreUpdate(t,e)}},{key:"_postupdate",value:function(t,e){this.emit("postupdate",new Yt(t,e,this)),this.onPostUpdate(t,e)}},{key:"onInitialize",value:function(t){}},{key:"onPreUpdate",value:function(t,e){}},{key:"onPostUpdate",value:function(t,e){}},{key:"update",value:function(t,e){this._initialize(t),this._preupdate(t,e);var n,i=Object(f.a)(this.children);try{for(i.s();!(n=i.n()).done;){n.value.update(t,e)}}catch(r){i.e(r)}finally{i.f()}this._postupdate(t,e)}}]),n}(fn);pi._ID=0;var vi=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t){var i,r;return Object(g.a)(this,n),(i=e.call(this)).draw=t,i.type="ex.canvas",i.draw=null!==(r=i.draw)&&void 0!==r?r:function(){},i}return n}(Rn);function gi(t){return!!t.tick}var yi=function(){function t(e,n){Object(g.a)(this,t),this._options=e,this._graphics=n,this.graphics=[]}return Object(y.a)(t,[{key:"name",get:function(){return this._options.name}},{key:"hide",value:function(t){if(t){var e=null;e=t instanceof Dt?t:this._graphics.getGraphic(t),this.graphics=this.graphics.filter((function(t){return t.graphic!==e}))}else this.graphics.length=0}},{key:"show",value:function(t,e){var n;return e=Object.assign({},e),t instanceof Dt?n=this._graphics.copyGraphics?t.clone():t:(n=this._graphics.getGraphic(t))||A.getInstance().error("No such graphic added to component named ".concat(t,". These named graphics are available: "),this._graphics.getNames()),n?(this.graphics.push({graphic:n,options:e}),n):null}},{key:"use",value:function(t,e){return e=Object.assign({},e),this.hide(),this.show(t,e)}},{key:"order",get:function(){return this._options.order},set:function(t){this._options.order=t}},{key:"offset",get:function(){var t;return null!==(t=this._options.offset)&&void 0!==t?t:ot.Zero},set:function(t){this._options.offset=t}},{key:"currentKeys",get:function(){var t;return null!==(t=this.name)&&void 0!==t?t:"anonymous"}}]),t}(),mi=function(){function t(e){Object(g.a)(this,t),this._component=e,this._layers=[],this._layerMap={},this.default=new yi({name:"default",order:0},e),this._maybeAddLayer(this.default)}return Object(y.a)(t,[{key:"create",value:function(t){var e=new yi(t,this._component);return this._maybeAddLayer(e)}},{key:"get",value:function(t){return t?this._getLayer(t):this._layers}},{key:"currentKeys",value:function(){var t,e=[],n=Object(f.a)(this._layers);try{for(n.s();!(t=n.n()).done;){var i=t.value;e.push(i.currentKeys)}}catch(r){n.e(r)}finally{n.f()}return e}},{key:"has",value:function(t){return t in this._layerMap}},{key:"_maybeAddLayer",value:function(t){return this._layerMap[t.name]?this._layerMap[t.name]:(this._layerMap[t.name]=t,this._layers.push(t),this._layers.sort((function(t,e){return t.order-e.order})),t)}},{key:"_getLayer",value:function(t){return this._layerMap[t]}}]),t}(),_i=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t){var i;Object(g.a)(this,n),(i=e.call(this)).type="ex.graphics",i._graphics={},i.visible=!0,i.opacity=1,i.offset=ot.Zero,i.anchor=ot.Half,i.copyGraphics=!1,i._bounds=null;var r=t=Object.assign({visible:i.visible},t),a=r.current,s=r.anchor,l=r.opacity,u=r.visible,c=r.graphics,h=r.offset,d=r.copyGraphics,f=r.onPreDraw,p=r.onPostDraw;return i._graphics=c||{},i.offset=null!==h&&void 0!==h?h:i.offset,i.opacity=null!==l&&void 0!==l?l:i.opacity,i.anchor=null!==s&&void 0!==s?s:i.anchor,i.copyGraphics=null!==d&&void 0!==d?d:i.copyGraphics,i.onPreDraw=null!==f&&void 0!==f?f:i.onPreDraw,i.onPostDraw=null!==p&&void 0!==p?p:i.onPostDraw,i.visible=!!u,i.layers=new mi(Object(o.a)(i)),a&&i._graphics[a]&&i.show(i._graphics[a]),i}return Object(y.a)(n,[{key:"getGraphic",value:function(t){return this._graphics[t]}},{key:"getNames",value:function(){return Object.keys(this._graphics)}},{key:"current",get:function(){return this.layers.default.graphics}},{key:"graphics",get:function(){return this._graphics}},{key:"add",value:function(t,e){var n="default",i=null;return"string"===typeof t?(n=t,i=e):i=t,this._graphics[n]=this.copyGraphics?i.clone():i,"default"===n&&this.show("default"),i}},{key:"show",value:function(t,e){return this.layers.default.show(t,e)}},{key:"use",value:function(t,e){return this.layers.default.use(t,e)}},{key:"hide",value:function(t){this.layers.default.hide(t)}},{key:"localBounds",get:function(){if(this._bounds)return this._bounds;var t,e=new dt,n=Object(f.a)(this.layers.get());try{for(n.s();!(t=n.n()).done;){var i,r=t.value,a=Object(f.a)(r.graphics);try{for(a.s();!(i=a.n()).done;){var o=i.value,s=o.graphic,l=o.options,u=this.anchor,c=this.offset;(null===l||void 0===l?void 0:l.anchor)&&(u=l.anchor),(null===l||void 0===l?void 0:l.offset)&&(c=l.offset);var h=s.localBounds,d=-h.width*s.scale.x*u.x+c.x,p=-h.height*s.scale.y*u.y+c.y;e=null===s||void 0===s?void 0:s.localBounds.translate(st(d+r.offset.x,p+r.offset.y)).combine(e)}}catch(v){a.e(v)}finally{a.f()}}}catch(v){n.e(v)}finally{n.f()}return e},set:function(t){this._bounds=t}},{key:"update",value:function(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=Object(f.a)(this.layers.get());try{for(i.s();!(e=i.n()).done;){var r,a=e.value,o=Object(f.a)(a.graphics);try{for(o.s();!(r=o.n()).done;){var s=r.value.graphic;gi(s)&&(null===s||void 0===s||s.tick(t,n))}}catch(l){o.e(l)}finally{o.f()}}}catch(l){i.e(l)}finally{i.f()}}}]),n}(Rn),bi=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t){var i;return Object(g.a)(this,n),(i=e.call(this,t)).width=t.width,i.height=t.height,i.rasterize(),i}return Object(y.a)(n,[{key:"clone",value:function(){return new n(Object.assign(Object.assign({width:this.width,height:this.height},this.cloneGraphicOptions()),this.cloneRasterOptions()))}},{key:"execute",value:function(t){this.color&&t.fillRect(0,0,this.width,this.height),this.strokeColor&&t.strokeRect(0,0,this.width,this.height)}}]),n}(It),wi=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t){var i,r;return Object(g.a)(this,n),(i=e.call(this,t))._radius=0,i.padding=null!==(r=t.padding)&&void 0!==r?r:2,i.radius=t.radius,i.rasterize(),i}return Object(y.a)(n,[{key:"radius",get:function(){return this._radius},set:function(t){this._radius=t,this.width=2*this._radius,this.height=2*this._radius,this.flagDirty()}},{key:"clone",value:function(){return new n(Object.assign(Object.assign({radius:this.radius},this.cloneGraphicOptions()),this.cloneRasterOptions()))}},{key:"execute",value:function(t){this.radius>0&&(t.beginPath(),t.arc(this.radius,this.radius,this.radius,0,2*Math.PI),this.color&&t.fill(),this.strokeColor&&t.stroke())}}]),n}(It),ki=function(t,e,n,i){var r,a=arguments.length,o=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,n,o):r(e,n))||o);return a>3&&o&&Object.defineProperty(e,n,o),o},xi=function(){function t(){Object(g.a)(this,t)}return Object(y.a)(t,null,[{key:"CreateReversibleEasingFunction",value:function(t){return function(e,n,i,r){return i<n?n-(t(e,i,n,r)-i):t(e,n,i,r)}}},{key:"CreateReversableEasingFunction",value:function(e){return t.CreateReversibleEasingFunction(e)}},{key:"CreateVectorEasingFunction",value:function(t){return function(e,n,i,r){return new ot(t(e,n.x,i.x,r),t(e,n.y,i.y,r))}}}]),t}();xi.Linear=xi.CreateReversibleEasingFunction((function(t,e,n,i){return(n-=e)*t/i+e})),xi.EaseInQuad=xi.CreateReversibleEasingFunction((function(t,e,n,i){return(n-=e)*(t/=i)*t+e})),xi.EaseOutQuad=xi.CreateReversibleEasingFunction((function(t,e,n,i){return-(n-=e)*(t/=i)*(t-2)+e})),xi.EaseInOutQuad=xi.CreateReversibleEasingFunction((function(t,e,n,i){return n-=e,(t/=i/2)<1?n/2*t*t+e:-n/2*(--t*(t-2)-1)+e})),xi.EaseInCubic=xi.CreateReversibleEasingFunction((function(t,e,n,i){return(n-=e)*(t/=i)*t*t+e})),xi.EaseOutCubic=xi.CreateReversibleEasingFunction((function(t,e,n,i){return t/=i,(n-=e)*(--t*t*t+1)+e})),xi.EaseInOutCubic=xi.CreateReversibleEasingFunction((function(t,e,n,i){return n-=e,(t/=i/2)<1?n/2*t*t*t+e:n/2*((t-=2)*t*t+2)+e})),ki([rt({message:"Alias for incorrect spelling used in older versions, will be removed in v0.25.0",alternateMethod:"CreateReversibleEasingFunction"})],xi,"CreateReversableEasingFunction",null);var Si,Ci=function(){function t(e){Object(g.a)(this,t),this._actions=[],this._completedActions=[],this._entity=e}return Object(y.a)(t,[{key:"add",value:function(t){this._actions.push(t)}},{key:"remove",value:function(t){var e=this._actions.indexOf(t);this._actions.splice(e,1)}},{key:"clearActions",value:function(){this._actions.length=0,this._completedActions.length=0,this._currentAction&&this._currentAction.stop()}},{key:"getActions",value:function(){return this._actions.concat(this._completedActions)}},{key:"hasNext",value:function(){return this._actions.length>0}},{key:"isComplete",value:function(){return 0===this._actions.length}},{key:"reset",value:function(){this._actions=this.getActions();for(var t=this._actions.length,e=0;e<t;e++)this._actions[e].reset();this._completedActions=[]}},{key:"update",value:function(t){this._actions.length>0&&(this._currentAction=this._actions[0],this._currentAction.update(t),this._currentAction.isComplete(this._entity)&&this._completedActions.push(this._actions.shift()))}}]),t}(),Oi=function(){function t(e,n,i){Object(g.a)(this,t),this._stopped=!1,this._repeatBuilder=n,this._repeatContext=new Hi(e),this._actionQueue=this._repeatContext.getQueue(),this._repeat=i,this._originalRepeat=i,this._repeatBuilder(this._repeatContext),this._repeat--}return Object(y.a)(t,[{key:"update",value:function(t){this._actionQueue.isComplete()&&(this._actionQueue.clearActions(),this._repeatBuilder(this._repeatContext),this._repeat--),this._actionQueue.update(t)}},{key:"isComplete",value:function(){return this._stopped||this._repeat<=0&&this._actionQueue.isComplete()}},{key:"stop",value:function(){this._stopped=!0}},{key:"reset",value:function(){this._repeat=this._originalRepeat}}]),t}(),Ei=function(){function t(e,n){Object(g.a)(this,t),this._stopped=!1,this._repeatBuilder=n,this._repeatContext=new Hi(e),this._actionQueue=this._repeatContext.getQueue(),this._repeatBuilder(this._repeatContext)}return Object(y.a)(t,[{key:"update",value:function(t){this._stopped||(this._actionQueue.isComplete()&&(this._actionQueue.clearActions(),this._repeatBuilder(this._repeatContext)),this._actionQueue.update(t))}},{key:"isComplete",value:function(){return this._stopped}},{key:"stop",value:function(){this._stopped=!0,this._actionQueue.clearActions()}},{key:"reset",value:function(){}}]),t}(),Ai=function(){function t(e,n,i,r){if(Object(g.a)(this,t),this._started=!1,this._stopped=!1,this._entity=e,this._tx=e.get(Bn),this._motion=e.get(Fn),this._speed=r,this._offset=new ot(n,i),r<=0)throw A.getInstance().error("Attempted to moveBy with speed less than or equal to zero : "+r),new Error("Speed must be greater than 0 pixels per second")}return Object(y.a)(t,[{key:"update",value:function(t){this._started||(this._started=!0,this._start=new ot(this._tx.pos.x,this._tx.pos.y),this._end=this._start.add(this._offset),this._distance=this._offset.size,this._dir=this._end.sub(this._start).normalize()),this.isComplete(this._entity)?(this._tx.pos=st(this._end.x,this._end.y),this._motion.vel=st(0,0)):this._motion.vel=this._dir.scale(this._speed)}},{key:"isComplete",value:function(t){var e=t.get(Bn);return this._stopped||e.pos.distance(this._start)>=this._distance}},{key:"stop",value:function(){this._motion.vel=st(0,0),this._stopped=!0}},{key:"reset",value:function(){this._started=!1}}]),t}(),Pi=function(){function t(e,n,i,r){Object(g.a)(this,t),this.entity=e,this._started=!1,this._stopped=!1,this._tx=e.get(Bn),this._motion=e.get(Fn),this._end=new ot(n,i),this._speed=r}return Object(y.a)(t,[{key:"update",value:function(t){this._started||(this._started=!0,this._start=new ot(this._tx.pos.x,this._tx.pos.y),this._distance=this._start.distance(this._end),this._dir=this._end.sub(this._start).normalize());var e=this._dir.scale(this._speed);this._motion.vel=st(e.x,e.y),this.isComplete(this.entity)&&(this._tx.pos=st(this._end.x,this._end.y),this._motion.vel=st(0,0))}},{key:"isComplete",value:function(t){var e=t.get(Bn);return this._stopped||new ot(e.pos.x,e.pos.y).distance(this._start)>=this._distance}},{key:"stop",value:function(){this._motion.vel=st(0,0),this._stopped=!0}},{key:"reset",value:function(){this._started=!1}}]),t}();!function(t){t[t.ShortestPath=0]="ShortestPath",t[t.LongestPath=1]="LongestPath",t[t.Clockwise=2]="Clockwise",t[t.CounterClockwise=3]="CounterClockwise"}(Si||(Si={}));var ji=function(){function t(e,n,i,r){Object(g.a)(this,t),this._started=!1,this._stopped=!1,this._tx=e.get(Bn),this._motion=e.get(Fn),this._end=n,this._speed=i,this._rotationType=r||Si.ShortestPath}return Object(y.a)(t,[{key:"update",value:function(t){if(!this._started){this._started=!0,this._start=this._tx.rotation,this._currentNonCannonAngle=this._tx.rotation;var e=Math.abs(this._end-this._start),n=M-e;switch(e>n?(this._shortDistance=n,this._longDistance=e):(this._shortDistance=e,this._longDistance=n),this._shortestPathIsPositive=(this._start-this._end+M)%M>=Math.PI,this._rotationType){case Si.ShortestPath:this._distance=this._shortDistance,this._shortestPathIsPositive?this._direction=1:this._direction=-1;break;case Si.LongestPath:this._distance=this._longDistance,this._shortestPathIsPositive?this._direction=-1:this._direction=1;break;case Si.Clockwise:this._direction=1,this._shortestPathIsPositive?this._distance=this._shortDistance:this._distance=this._longDistance;break;case Si.CounterClockwise:this._direction=-1,this._shortestPathIsPositive?this._distance=this._longDistance:this._distance=this._shortDistance}}this._motion.angularVelocity=this._direction*this._speed,this._currentNonCannonAngle+=this._direction*this._speed*(t/1e3),this.isComplete()&&(this._tx.rotation=this._end,this._motion.angularVelocity=0,this._stopped=!0)}},{key:"isComplete",value:function(){var t=Math.abs(this._currentNonCannonAngle-this._start);return this._stopped||t>=Math.abs(this._distance)}},{key:"stop",value:function(){this._motion.angularVelocity=0,this._stopped=!0}},{key:"reset",value:function(){this._started=!1}}]),t}(),Ti=function(){function t(e,n,i,r){Object(g.a)(this,t),this._started=!1,this._stopped=!1,this._tx=e.get(Bn),this._motion=e.get(Fn),this._speed=i,this._offset=n,this._rotationType=r||Si.ShortestPath}return Object(y.a)(t,[{key:"update",value:function(t){if(!this._started){this._started=!0,this._start=this._tx.rotation,this._currentNonCannonAngle=this._tx.rotation,this._end=this._start+this._offset;var e=Math.abs(this._end-this._start),n=M-e;switch(e>n?(this._shortDistance=n,this._longDistance=e):(this._shortDistance=e,this._longDistance=n),this._shortestPathIsPositive=(this._start-this._end+M)%M>=Math.PI,this._rotationType){case Si.ShortestPath:this._distance=this._shortDistance,this._shortestPathIsPositive?this._direction=1:this._direction=-1;break;case Si.LongestPath:this._distance=this._longDistance,this._shortestPathIsPositive?this._direction=-1:this._direction=1;break;case Si.Clockwise:this._direction=1,this._shortDistance>=0?this._distance=this._shortDistance:this._distance=this._longDistance;break;case Si.CounterClockwise:this._direction=-1,this._shortDistance<=0?this._distance=this._shortDistance:this._distance=this._longDistance}}this._motion.angularVelocity=this._direction*this._speed,this._currentNonCannonAngle+=this._direction*this._speed*(t/1e3),this.isComplete()&&(this._tx.rotation=this._end,this._motion.angularVelocity=0,this._stopped=!0)}},{key:"isComplete",value:function(){var t=Math.abs(this._currentNonCannonAngle-this._start);return this._stopped||t>=Math.abs(this._distance)}},{key:"stop",value:function(){this._motion.angularVelocity=0,this._stopped=!0}},{key:"reset",value:function(){this._started=!1}}]),t}(),Ri=function(){function t(e,n,i,r,a){Object(g.a)(this,t),this._started=!1,this._stopped=!1,this._tx=e.get(Bn),this._motion=e.get(Fn),this._endX=n,this._endY=i,this._speedX=r,this._speedY=a}return Object(y.a)(t,[{key:"update",value:function(t){if(this._started||(this._started=!0,this._startX=this._tx.scale.x,this._startY=this._tx.scale.y,this._distanceX=Math.abs(this._endX-this._startX),this._distanceY=Math.abs(this._endY-this._startY)),Math.abs(this._tx.scale.x-this._startX)>=this._distanceX)this._motion.scaleFactor.x=0;else{var e=this._endY<this._startY?-1:1;this._motion.scaleFactor.x=this._speedX*e}if(Math.abs(this._tx.scale.y-this._startY)>=this._distanceY)this._motion.scaleFactor.y=0;else{var n=this._endY<this._startY?-1:1;this._motion.scaleFactor.y=this._speedY*n}this.isComplete()&&(this._tx.scale=st(this._endX,this._endY),this._motion.scaleFactor.x=0,this._motion.scaleFactor.y=0)}},{key:"isComplete",value:function(){return this._stopped||Math.abs(this._tx.scale.y-this._startX)>=this._distanceX&&Math.abs(this._tx.scale.y-this._startY)>=this._distanceY}},{key:"stop",value:function(){this._motion.scaleFactor.x=0,this._motion.scaleFactor.y=0,this._stopped=!0}},{key:"reset",value:function(){this._started=!1}}]),t}(),Di=function(){function t(e,n,i,r){Object(g.a)(this,t),this._started=!1,this._stopped=!1,this._tx=e.get(Bn),this._motion=e.get(Fn),this._offset=new ot(n,i),this._speedX=this._speedY=r}return Object(y.a)(t,[{key:"update",value:function(t){this._started||(this._started=!0,this._startScale=this._tx.scale.clone(),this._endScale=this._startScale.add(this._offset),this._distanceX=Math.abs(this._endScale.x-this._startScale.x),this._distanceY=Math.abs(this._endScale.y-this._startScale.y),this._directionX=this._endScale.x<this._startScale.x?-1:1,this._directionY=this._endScale.y<this._startScale.y?-1:1),this._motion.scaleFactor.x=this._speedX*this._directionX,this._motion.scaleFactor.y=this._speedY*this._directionY,this.isComplete()&&(this._tx.scale=this._endScale,this._motion.scaleFactor.x=0,this._motion.scaleFactor.y=0)}},{key:"isComplete",value:function(){return this._stopped||Math.abs(this._tx.scale.x-this._startScale.x)>=this._distanceX&&Math.abs(this._tx.scale.y-this._startScale.y)>=this._distanceY}},{key:"stop",value:function(){this._motion.scaleFactor.x=0,this._motion.scaleFactor.y=0,this._stopped=!0}},{key:"reset",value:function(){this._started=!1}}]),t}(),Mi=function(){function t(e){Object(g.a)(this,t),this._method=null,this._hasBeenCalled=!1,this._method=e}return Object(y.a)(t,[{key:"update",value:function(t){this._method(),this._hasBeenCalled=!0}},{key:"isComplete",value:function(){return this._hasBeenCalled}},{key:"reset",value:function(){this._hasBeenCalled=!1}},{key:"stop",value:function(){this._hasBeenCalled=!0}}]),t}(),Li=function(){function t(e,n,i,r,a){Object(g.a)(this,t),this.easingFcn=a,this._currentLerpTime=0,this._lerpDuration=1e3,this._lerpStart=new ot(0,0),this._lerpEnd=new ot(0,0),this._initialized=!1,this._stopped=!1,this._distance=0,this._tx=e.get(Bn),this._motion=e.get(Fn),this._lerpDuration=r,this._lerpEnd=new ot(n,i)}return Object(y.a)(t,[{key:"_initialize",value:function(){this._lerpStart=new ot(this._tx.pos.x,this._tx.pos.y),this._currentLerpTime=0,this._distance=this._lerpStart.distance(this._lerpEnd)}},{key:"update",value:function(t){this._initialized||(this._initialize(),this._initialized=!0),this._currentLerpTime+=t;var e=this._tx.pos.x,n=this._tx.pos.y;this._currentLerpTime<this._lerpDuration?(e=this._lerpEnd.x<this._lerpStart.x?this._lerpStart.x-(this.easingFcn(this._currentLerpTime,this._lerpEnd.x,this._lerpStart.x,this._lerpDuration)-this._lerpEnd.x):this.easingFcn(this._currentLerpTime,this._lerpStart.x,this._lerpEnd.x,this._lerpDuration),n=this._lerpEnd.y<this._lerpStart.y?this._lerpStart.y-(this.easingFcn(this._currentLerpTime,this._lerpEnd.y,this._lerpStart.y,this._lerpDuration)-this._lerpEnd.y):this.easingFcn(this._currentLerpTime,this._lerpStart.y,this._lerpEnd.y,this._lerpDuration),this._motion.vel=st((e-this._tx.pos.x)/(t/1e3),(n-this._tx.pos.y)/(t/1e3))):(this._tx.pos=st(this._lerpEnd.x,this._lerpEnd.y),this._motion.vel=ot.Zero)}},{key:"isComplete",value:function(t){return this._stopped||new ot(t.pos.x,t.pos.y).distance(this._lerpStart)>=this._distance}},{key:"reset",value:function(){this._initialized=!1}},{key:"stop",value:function(){this._motion.vel=st(0,0),this._stopped=!0}}]),t}(),Bi=function(){function t(e,n,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;Object(g.a)(this,t),this._timeVisible=0,this._timeNotVisible=0,this._elapsedTime=0,this._totalTime=0,this._stopped=!1,this._started=!1,this._graphics=e.get(_i),this._timeVisible=n,this._timeNotVisible=i,this._duration=(n+i)*r}return Object(y.a)(t,[{key:"update",value:function(t){this._started||(this._started=!0),this._graphics&&(this._elapsedTime+=t,this._totalTime+=t,this._graphics.visible&&this._elapsedTime>=this._timeVisible&&(this._graphics.visible=!1,this._elapsedTime=0),!this._graphics.visible&&this._elapsedTime>=this._timeNotVisible&&(this._graphics.visible=!0,this._elapsedTime=0),this.isComplete()&&(this._graphics.visible=!0))}},{key:"isComplete",value:function(){return this._stopped||this._totalTime>=this._duration}},{key:"stop",value:function(){this._graphics&&(this._graphics.visible=!0),this._stopped=!0}},{key:"reset",value:function(){this._started=!1,this._elapsedTime=0,this._totalTime=0}}]),t}(),Fi=function(){function t(e,n,i){Object(g.a)(this,t),this._multiplier=1,this._started=!1,this._stopped=!1,this._graphics=e.get(_i),this._endOpacity=n,this._speed=i}return Object(y.a)(t,[{key:"update",value:function(t){this._graphics&&(this._started||(this._started=!0,this._endOpacity<this._graphics.opacity?this._multiplier=-1:this._multiplier=1),this._speed>0&&(this._graphics.opacity+=this._multiplier*(Math.abs(this._graphics.opacity-this._endOpacity)*t)/this._speed),this._speed-=t,this.isComplete()&&(this._graphics.opacity=this._endOpacity),A.getInstance().debug("[Action fade] Actor opacity:",this._graphics.opacity))}},{key:"isComplete",value:function(){return this._stopped||Math.abs(this._graphics.opacity-this._endOpacity)<.05}},{key:"stop",value:function(){this._stopped=!0}},{key:"reset",value:function(){this._started=!1}}]),t}(),Ii=function(){function t(e){Object(g.a)(this,t),this._elapsedTime=0,this._started=!1,this._stopped=!1,this._delay=e}return Object(y.a)(t,[{key:"update",value:function(t){this._started||(this._started=!0),this._elapsedTime+=t}},{key:"isComplete",value:function(){return this._stopped||this._elapsedTime>=this._delay}},{key:"stop",value:function(){this._stopped=!0}},{key:"reset",value:function(){this._elapsedTime=0,this._started=!1}}]),t}(),zi=function(){function t(e){Object(g.a)(this,t),this._stopped=!1,this._entity=e}return Object(y.a)(t,[{key:"update",value:function(t){this._entity.get(Wi).clearActions(),this._entity.kill(),this._stopped=!0}},{key:"isComplete",value:function(){return this._stopped}},{key:"stop",value:function(){}},{key:"reset",value:function(){}}]),t}(),Ni=function(){function t(e,n,i){Object(g.a)(this,t),this._started=!1,this._stopped=!1,this._tx=e.get(Bn),this._motion=e.get(Fn),this._followTx=n.get(Bn),this._followMotion=n.get(Fn),this._current=new ot(this._tx.pos.x,this._tx.pos.y),this._end=new ot(this._followTx.pos.x,this._followTx.pos.y),this._maximumDistance=void 0!==i?i:this._current.distance(this._end),this._speed=0}return Object(y.a)(t,[{key:"update",value:function(t){this._started||(this._started=!0,this._distanceBetween=this._current.distance(this._end),this._dir=this._end.sub(this._current).normalize());var e=Math.sqrt(Math.pow(this._followMotion.vel.x,2)+Math.pow(this._followMotion.vel.y,2));if(0!==e&&(this._speed=e),this._current=st(this._tx.pos.x,this._tx.pos.y),this._end=st(this._followTx.pos.x,this._followTx.pos.y),this._distanceBetween=this._current.distance(this._end),this._dir=this._end.sub(this._current).normalize(),this._distanceBetween>=this._maximumDistance){var n=this._dir.scale(this._speed);this._motion.vel=st(n.x,n.y)}else this._motion.vel=st(0,0);this.isComplete()&&(this._tx.pos=st(this._end.x,this._end.y),this._motion.vel=st(0,0))}},{key:"stop",value:function(){this._motion.vel=st(0,0),this._stopped=!0}},{key:"isComplete",value:function(){return this._stopped}},{key:"reset",value:function(){this._started=!1}}]),t}(),Ui=function(){function t(e,n,i){Object(g.a)(this,t),this._started=!1,this._stopped=!1,this._speedWasSpecified=!1,this._tx=e.get(Bn),this._motion=e.get(Fn),this._meetTx=n.get(Bn),this._meetMotion=n.get(Fn),this._current=new ot(this._tx.pos.x,this._tx.pos.y),this._end=new ot(this._meetTx.pos.x,this._meetTx.pos.y),this._speed=i||0,void 0!==i&&(this._speedWasSpecified=!0)}return Object(y.a)(t,[{key:"update",value:function(t){this._started||(this._started=!0,this._distanceBetween=this._current.distance(this._end),this._dir=this._end.sub(this._current).normalize());var e=Math.sqrt(Math.pow(this._meetMotion.vel.x,2)+Math.pow(this._meetMotion.vel.y,2));0===e||this._speedWasSpecified||(this._speed=e),this._current=st(this._tx.pos.x,this._tx.pos.y),this._end=st(this._meetTx.pos.x,this._meetTx.pos.y),this._distanceBetween=this._current.distance(this._end),this._dir=this._end.sub(this._current).normalize();var n=this._dir.scale(this._speed);this._motion.vel=st(n.x,n.y),this.isComplete()&&(this._tx.pos=st(this._end.x,this._end.y),this._motion.vel=st(0,0))}},{key:"isComplete",value:function(){return this._stopped||this._distanceBetween<=1}},{key:"stop",value:function(){this._motion.vel=st(0,0),this._stopped=!0}},{key:"reset",value:function(){this._started=!1}}]),t}(),Hi=function(){function t(e){Object(g.a)(this,t),this._entity=e,this._queue=new Ci(e)}return Object(y.a)(t,[{key:"getQueue",value:function(){return this._queue}},{key:"update",value:function(t){this._queue.update(t)}},{key:"clearActions",value:function(){this._queue.clearActions()}},{key:"easeTo",value:function(){for(var t,e,n=0,i=0,r=0,a=xi.Linear,o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];return s[0]instanceof ot?(n=s[0].x,i=s[0].y,r=s[1],a=null!==(t=s[2])&&void 0!==t?t:a):(n=s[0],i=s[1],r=s[2],a=null!==(e=s[3])&&void 0!==e?e:a),this._queue.add(new Li(this._entity,n,i,r,a)),this}},{key:"moveTo",value:function(t,e,n){var i=0,r=0,a=0;return t instanceof ot?(i=t.x,r=t.y,a=e):(i=t,r=e,a=n),this._queue.add(new Pi(this._entity,i,r,a)),this}},{key:"moveBy",value:function(t,e,n){var i=0,r=0,a=0;return t instanceof ot?(i=t.x,r=t.y,a=e):(i=t,r=e,a=n),this._queue.add(new Ai(this._entity,i,r,a)),this}},{key:"rotateTo",value:function(t,e,n){return this._queue.add(new ji(this._entity,t,e,n)),this}},{key:"rotateBy",value:function(t,e,n){return this._queue.add(new Ti(this._entity,t,e,n)),this}},{key:"scaleTo",value:function(t,e,n,i){var r=1,a=1,o=0,s=0;return t instanceof ot&&e instanceof ot&&(r=t.x,a=t.y,o=e.x,s=e.y),"number"===typeof t&&"number"===typeof e&&(r=t,a=e,o=n,s=i),this._queue.add(new Ri(this._entity,r,a,o,s)),this}},{key:"scaleBy",value:function(t,e,n){var i=1,r=1;return t instanceof ot&&(i=t.x,r=t.y,n=e),"number"===typeof t&&"number"===typeof e&&(i=t,r=e),this._queue.add(new Di(this._entity,i,r,n)),this}},{key:"blink",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return this._queue.add(new Bi(this._entity,t,e,n)),this}},{key:"fade",value:function(t,e){return this._queue.add(new Fi(this._entity,t,e)),this}},{key:"delay",value:function(t){return this._queue.add(new Ii(t)),this}},{key:"die",value:function(){return this._queue.add(new zi(this._entity)),this}},{key:"callMethod",value:function(t){return this._queue.add(new Mi(t)),this}},{key:"repeat",value:function(t,e){return e?(this._queue.add(new Oi(this._entity,t,e)),this):(this.repeatForever(t),this)}},{key:"repeatForever",value:function(t){return this._queue.add(new Ei(this._entity,t)),this}},{key:"follow",value:function(t,e){return void 0===e?this._queue.add(new Ni(this._entity,t)):this._queue.add(new Ni(this._entity,t,e)),this}},{key:"meet",value:function(t,e){return void 0===e?this._queue.add(new Ui(this._entity,t)):this._queue.add(new Ui(this._entity,t,e)),this}},{key:"asPromise",value:function(){return this.toPromise()}},{key:"toPromise",value:function(){var t=this;return new Promise((function(e){t._queue.add(new Mi((function(){e()})))}))}}]),t}(),Wi=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(){var t;return Object(g.a)(this,n),(t=e.apply(this,arguments)).type="ex.actions",t.dependencies=[Bn,Fn],t}return Object(y.a)(n,[{key:"onAdd",value:function(t){this._ctx=new Hi(t)}},{key:"onRemove",value:function(){this._ctx=null}},{key:"getQueue",value:function(){var t;return null===(t=this._ctx)||void 0===t?void 0:t.getQueue()}},{key:"update",value:function(t){var e;return null===(e=this._ctx)||void 0===e?void 0:e.update(t)}},{key:"clearActions",value:function(){var t;null===(t=this._ctx)||void 0===t||t.clearActions()}},{key:"easeTo",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this._ctx.easeTo.apply(this._ctx,e)}},{key:"moveTo",value:function(t,e,n){return this._ctx.moveTo.apply(this._ctx,[t,e,n])}},{key:"moveBy",value:function(t,e,n){return this._ctx.moveBy.apply(this._ctx,[t,e,n])}},{key:"rotateTo",value:function(t,e,n){return this._ctx.rotateTo(t,e,n)}},{key:"rotateBy",value:function(t,e,n){return this._ctx.rotateBy(t,e,n)}},{key:"scaleTo",value:function(t,e,n,i){return this._ctx.scaleTo.apply(this._ctx,[t,e,n,i])}},{key:"scaleBy",value:function(t,e,n){return this._ctx.scaleBy.apply(this._ctx,[t,e,n])}},{key:"blink",value:function(t,e,n){return this._ctx.blink(t,e,n)}},{key:"fade",value:function(t,e){return this._ctx.fade(t,e)}},{key:"delay",value:function(t){return this._ctx.delay(t)}},{key:"die",value:function(){return this._ctx.die()}},{key:"callMethod",value:function(t){return this._ctx.callMethod(t)}},{key:"repeat",value:function(t,e){return this._ctx.repeat(t,e)}},{key:"repeatForever",value:function(t){return this._ctx.repeatForever(t)}},{key:"follow",value:function(t,e){return this._ctx.follow(t,e)}},{key:"meet",value:function(t,e){return this._ctx.meet(t,e)}},{key:"asPromise",value:function(){return this.toPromise()}},{key:"toPromise",value:function(){return this._ctx.toPromise()}}]),n}(Rn),Vi=function(t,e,n,i){var r,a=arguments.length,o=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,n,o):r(e,n))||o);return a>3&&o&&Object.defineProperty(e,n,o),o};var Gi=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t){var i;Object(g.a)(this,n),(i=e.call(this))._anchor=Mt(ot.Half,(function(t){return i._handleAnchorChange(t)})),i.logger=A.getInstance(),i.scene=null,i.frames={},i.currentDrawing=null,i._draggable=!1,i._dragging=!1,i._pointerDragStartHandler=function(){i._dragging=!0},i._pointerDragEndHandler=function(){i._dragging=!1},i._pointerDragMoveHandler=function(t){i._dragging&&(i.pos=t.pointer.lastWorldPos)},i._pointerDragLeaveHandler=function(t){i._dragging&&(i.pos=t.pointer.lastWorldPos)},i.traits=[],i.enableCapturePointer=!1,i.capturePointer={captureMoveEvents:!1,captureDragEvents:!1},i._capturePointerEvents=["pointerup","pointerdown","pointermove","pointerenter","pointerleave","pointerdragstart","pointerdragend","pointerdragmove","pointerdragenter","pointerdragleave"],i._captureMoveEvents=["pointermove","pointerenter","pointerleave","pointerdragmove","pointerdragenter","pointerdragleave"],i._captureDragEvents=["pointerdragstart","pointerdragend","pointerdragmove","pointerdragenter","pointerdragleave"];var r=Object.assign({},t),a=r.name,o=r.x,s=r.y,l=r.pos,u=r.scale,c=r.width,h=r.height,d=r.radius,f=r.collider,p=r.vel,v=r.acc,y=r.rotation,m=r.angularVelocity,_=r.z,b=r.color,w=r.visible,x=r.anchor,S=r.collisionType,C=r.collisionGroup;return i._setName(a),i.anchor=null!==x&&void 0!==x?x:n.defaults.anchor.clone(),i.addComponent(new Bn),i.pos=null!==l&&void 0!==l?l:st(null!==o&&void 0!==o?o:0,null!==s&&void 0!==s?s:0),i.rotation=null!==y&&void 0!==y?y:0,i.scale=null!==u&&void 0!==u?u:st(1,1),i.z=null!==_&&void 0!==_?_:0,i.addComponent(new _i),i.addComponent(new vi((function(t,e){return i.draw(t,e)}))),i.addComponent(new Fn),i.vel=null!==p&&void 0!==p?p:ot.Zero,i.acc=null!==v&&void 0!==v?v:ot.Zero,i.angularVelocity=null!==m&&void 0!==m?m:0,i.addComponent(new Wi),i.addComponent(new oi),i.body.collisionType=null!==S&&void 0!==S?S:_n.Passive,C&&(i.body.group=C),f?i.addComponent(new ai(f)):d?i.addComponent(new ai(ri.Circle(d,i.anchor))):c>0&&h>0?i.addComponent(new ai(ri.Box(c,h,i.anchor))):i.addComponent(new ai),i.graphics.visible=null===w||void 0===w||w,b&&(i.color=b,c&&h?i.graphics.add(new bi({color:b,width:c,height:h})):d&&i.graphics.add(new wi({color:b,radius:d}))),O.isEnabled(k.LegacyDrawing)&&i.traits.push(new li),i.traits.push(new ui),i}return Object(y.a)(n,[{key:"body",get:function(){return this.get(oi)}},{key:"transform",get:function(){return this.get(Bn)}},{key:"motion",get:function(){return this.get(Fn)}},{key:"graphics",get:function(){return this.get(_i)}},{key:"collider",get:function(){return this.get(ai)}},{key:"actions",get:function(){return this.get(Wi)}},{key:"pos",get:function(){return this.transform.pos},set:function(t){this.transform.pos=t.clone()}},{key:"oldPos",get:function(){return this.body.oldPos},set:function(t){this.body.oldPos.setTo(t.x,t.y)}},{key:"vel",get:function(){return this.motion.vel},set:function(t){this.motion.vel=t.clone()}},{key:"oldVel",get:function(){return this.body.oldVel},set:function(t){this.body.oldVel.setTo(t.x,t.y)}},{key:"acc",get:function(){return this.motion.acc},set:function(t){this.motion.acc=t.clone()}},{key:"oldAcc",get:function(){return this.body.oldAcc},set:function(t){this.body.oldAcc.setTo(t.x,t.y)}},{key:"rotation",get:function(){return this.transform.rotation},set:function(t){this.transform.rotation=t}},{key:"angularVelocity",get:function(){return this.motion.angularVelocity},set:function(t){this.motion.angularVelocity=t}},{key:"scale",get:function(){return this.get(Bn).scale},set:function(t){this.get(Bn).scale=t}},{key:"anchor",get:function(){return this._anchor},set:function(t){var e=this;this._anchor=Mt(t,(function(t){return e._handleAnchorChange(t)})),this._handleAnchorChange(t)}},{key:"_handleAnchorChange",value:function(t){this.graphics&&(this.graphics.anchor=t)}},{key:"isOffScreen",get:function(){return this.hasTag("offscreen")}},{key:"visible",get:function(){return this.graphics.visible},set:function(t){this.graphics.visible=t}},{key:"opacity",get:function(){return this.graphics.opacity},set:function(t){this.graphics.opacity=t}},{key:"draggable",get:function(){return this._draggable},set:function(t){t&&(t&&!this._draggable?(this.on("pointerdragstart",this._pointerDragStartHandler),this.on("pointerdragend",this._pointerDragEndHandler),this.on("pointerdragmove",this._pointerDragMoveHandler),this.on("pointerdragleave",this._pointerDragLeaveHandler)):!t&&this._draggable&&(this.off("pointerdragstart",this._pointerDragStartHandler),this.off("pointerdragend",this._pointerDragEndHandler),this.off("pointerdragmove",this._pointerDragMoveHandler),this.off("pointerdragleave",this._pointerDragLeaveHandler)),this._draggable=t)}},{key:"color",get:function(){return this._color},set:function(t){this._color=t.clone()}},{key:"onInitialize",value:function(t){}},{key:"_initialize",value:function(t){Object(s.a)(Object(l.a)(n.prototype),"_initialize",this).call(this,t);var e,i=Object(f.a)(this.children);try{for(i.s();!(e=i.n()).done;){e.value._initialize(t)}}catch(r){i.e(r)}finally{i.f()}}},{key:"_checkForPointerOptIn",value:function(t){if(t){var e=t.toLowerCase();-1!==this._capturePointerEvents.indexOf(e)&&(this.enableCapturePointer=!0,-1!==this._captureMoveEvents.indexOf(e)&&(this.capturePointer.captureMoveEvents=!0),-1!==this._captureDragEvents.indexOf(e)&&(this.capturePointer.captureDragEvents=!0))}}},{key:"on",value:function(t,e){this._checkForPointerOptIn(t),Object(s.a)(Object(l.a)(n.prototype),"on",this).call(this,t,e)}},{key:"once",value:function(t,e){this._checkForPointerOptIn(t),Object(s.a)(Object(l.a)(n.prototype),"once",this).call(this,t,e)}},{key:"off",value:function(t,e){Object(s.a)(Object(l.a)(n.prototype),"off",this).call(this,t,e)}},{key:"_prekill",value:function(t){Object(s.a)(Object(l.a)(n.prototype),"emit",this).call(this,"prekill",new Ht(this)),this.onPreKill(t)}},{key:"onPreKill",value:function(t){}},{key:"_postkill",value:function(t){Object(s.a)(Object(l.a)(n.prototype),"emit",this).call(this,"postkill",new Wt(this)),this.onPostKill(t)}},{key:"onPostKill",value:function(t){}},{key:"kill",value:function(){this.scene?(this._prekill(this.scene),this.emit("kill",new Ut(this)),Object(s.a)(Object(l.a)(n.prototype),"kill",this).call(this),this._postkill(this.scene)):this.logger.warn("Cannot kill actor, it was never added to the Scene")}},{key:"unkill",value:function(){this.active=!0}},{key:"isKilled",value:function(){return!this.active}},{key:"setDrawing",value:function(t){t=t.toString(),this.currentDrawing!==this.frames[t]&&(null!=this.frames[t]?(this.frames[t].reset(),this.currentDrawing=this.frames[t]):A.getInstance().error("the specified drawing key ".concat(t," does not exist"))),this.currentDrawing&&this.currentDrawing instanceof $e&&this.currentDrawing.tick(0)}},{key:"addDrawing",value:function(){2===arguments.length?(this.frames[arguments[0]]=arguments[1],this.currentDrawing||(this.currentDrawing=arguments[1])):(arguments[0]instanceof Ue&&this.addDrawing("default",arguments[0]),arguments[0]instanceof Be&&this.addDrawing("default",arguments[0].asSprite()))}},{key:"z",get:function(){return this.get(Bn).z},set:function(t){this.get(Bn).z=t}},{key:"getZIndex",value:function(){return this.get(Bn).z}},{key:"setZIndex",value:function(t){this.get(Bn).z=t}},{key:"center",get:function(){return new ot(this.pos.x+this.width/2-this.anchor.x*this.width,this.pos.y+this.height/2-this.anchor.y*this.height)}},{key:"width",get:function(){return this.collider.localBounds.width*this.getGlobalScale().x}},{key:"height",get:function(){return this.collider.localBounds.height*this.getGlobalScale().y}},{key:"getGlobalRotation",value:function(){return this.get(Bn).globalRotation}},{key:"getGlobalPos",value:function(){return this.get(Bn).globalPos}},{key:"getGlobalScale",value:function(){return this.get(Bn).globalScale}},{key:"contains",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=st(t,e),r=this.get(ai);r.update();var a=r.get();if(!a)return!1;var o=a.contains(i);return n?o||this.children.some((function(n){return n.contains(t,e,!0)})):o}},{key:"within",value:function(t,e){var n=this.get(ai),i=t.get(ai),r=n.get(),a=i.get();return!(!r||!a)&&r.getClosestLineBetween(a).getLength()<=e}},{key:"update",value:function(t,e){this._initialize(t),this._preupdate(t,e);var n=this.currentDrawing;n&&n instanceof $e&&n.tick(e,t.stats.currFrame.id);var i,r=Object(f.a)(this.traits);try{for(r.s();!(i=r.n()).done;){i.value.update(this,t,e)}}catch(a){r.e(a)}finally{r.f()}this._postupdate(t,e)}},{key:"onPreUpdate",value:function(t,e){}},{key:"onPostUpdate",value:function(t,e){}},{key:"_preupdate",value:function(t,e){this.emit("preupdate",new Qt(t,e,this)),this.onPreUpdate(t,e)}},{key:"_postupdate",value:function(t,e){this.emit("postupdate",new Qt(t,e,this)),this.onPostUpdate(t,e)}},{key:"draw",value:function(t,e){var n;if(t.save(),this.currentDrawing){t.translate(-this.width*this.anchor.x,-this.height*this.anchor.y),this._predraw(t,e);var i=this.currentDrawing,r=(this.width-i.width*i.scale.x)*this.anchor.x,a=(this.height-i.height*i.scale.y)*this.anchor.y;this.currentDrawing.draw({ctx:t,x:r,y:a,opacity:this.graphics.opacity})}else if(this._predraw(t,e),this.color&&this.collider){var o=this.get(ai);o.update(),o&&!o.bounds.hasZeroDimensions()&&(t.globalAlpha=this.graphics.opacity,null===(n=o.get())||void 0===n||n.draw(t,this.color,st(0,0)))}t.restore(),this._postdraw(t,e)}},{key:"onPreDraw",value:function(t,e){}},{key:"onPostDraw",value:function(t,e){}},{key:"_predraw",value:function(t,e){this.emit("predraw",new Xt(t,e,this)),this.onPreDraw(t,e)}},{key:"_postdraw",value:function(t,e){this.emit("postdraw",new Xt(t,e,this)),this.onPostDraw(t,e)}},{key:"debugDraw",value:function(t){}}]),n}(pi);Gi.defaults={anchor:ot.Half},Vi([rt({message:"Actor.visible will be removed in v0.26.0",alternateMethod:"Use Actor.graphics.visible"})],Gi.prototype,"visible",null),Vi([rt({message:"Actor.opacity will be removed in v0.26.0",alternateMethod:"Use Actor.graphics.opacity"})],Gi.prototype,"opacity",null),Vi([rt({message:"Actor.setDrawing will be removed in v0.26.0",alternateMethod:"Use Actor.graphics.show() or Actor.graphics.use()"})],Gi.prototype,"setDrawing",null),Vi([rt({message:"Actor.addDrawing will be removed in v0.26.0",alternateMethod:"Use Actor.graphics.add()"})],Gi.prototype,"addDrawing",null),Vi([rt({message:"Actor.getZIndex will be removed in v0.26.0",alternateMethod:"Use Actor.transform.z or Actor.z"})],Gi.prototype,"getZIndex",null),Vi([rt({message:"Actor.setZIndex will be removed in v0.26.0",alternateMethod:"Use Actor.transform.z or Actor.z"})],Gi.prototype,"setZIndex",null);var Xi=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t){var i;return Object(g.a)(this,n),(i=e.call(this,Object.assign({},t))).get(Bn).coordPlane=Tn.Screen,i.traits=[],i.traits.push(new ui),i.anchor=st(0,0),i.body.collisionType=_n.PreventCollision,i.collider.useBoxCollider(i.width,i.height,i.anchor),i.enableCapturePointer=!0,i}return Object(y.a)(n,[{key:"_initialize",value:function(t){this._engine=t,Object(s.a)(Object(l.a)(n.prototype),"_initialize",this).call(this,t)}},{key:"contains",value:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(i)return Object(s.a)(Object(l.a)(n.prototype),"contains",this).call(this,t,e);var r=this._engine.worldToScreenCoordinates(new ot(t,e));return Object(s.a)(Object(l.a)(n.prototype),"contains",this).call(this,r.x,r.y)}}]),n}(Gi),qi=function(t,e,n,i){var r,a=arguments.length,o=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,n,o):r(e,n))||o);return a>3&&o&&Object.defineProperty(e,n,o),o},Ki=function(){function t(e,n,i,r){if(Object(g.a)(this,t),this._logger=A.getInstance(),this.id=0,this._elapsedTime=0,this._totalTimeAlive=0,this._running=!1,this._numberOfTicks=0,this.interval=10,this.repeats=!1,this.maxNumberOfRepeats=-1,this._complete=!1,this.scene=null,"function"!==typeof e){var a=e;e=a.fcn,n=a.interval,i=a.repeats,r=a.numberOfRepeats}if(r&&r>=0&&(this.maxNumberOfRepeats=r,!i))throw new Error("repeats must be set to true if numberOfRepeats is set");this.id=t._MAX_ID++,this.interval=n||this.interval,this.repeats=i||this.repeats,this._callbacks=[],e&&this.on(e)}return Object(y.a)(t,[{key:"complete",get:function(){return this._complete}},{key:"on",value:function(t){this._callbacks.push(t)}},{key:"off",value:function(t){var e=this._callbacks.indexOf(t);this._callbacks.splice(e,1)}},{key:"update",value:function(t){var e=this;this._running&&(this._totalTimeAlive+=t,this._elapsedTime+=t,this.maxNumberOfRepeats>-1&&this._numberOfTicks>=this.maxNumberOfRepeats&&(this._complete=!0,this._running=!1,this._elapsedTime=0),!this.complete&&this._elapsedTime>=this.interval&&(this._callbacks.forEach((function(t){t.call(e)})),this._numberOfTicks++,this.repeats||(this._complete=!0,this._running=!1),this._elapsedTime=0))}},{key:"reset",value:function(t,e){if(t&&t>=0&&(this.interval=t),this.maxNumberOfRepeats&&this.maxNumberOfRepeats>=0&&(this.maxNumberOfRepeats=e,!this.repeats))throw new Error("repeats must be set to true if numberOfRepeats is set");this._complete=!1,this._elapsedTime=0,this._numberOfTicks=0}},{key:"timesRepeated",get:function(){return this._numberOfTicks}},{key:"getTimeRunning",value:function(){return this._totalTimeAlive}},{key:"timeToNextAction",get:function(){return this.complete?0:this.interval-this._elapsedTime}},{key:"timeElapsedTowardNextAction",get:function(){return this._elapsedTime}},{key:"isRunning",get:function(){return this._running}},{key:"pause",value:function(){return this._running=!1,this}},{key:"unpause",value:function(){this._running=!0}},{key:"resume",value:function(){return this._running=!0,this}},{key:"start",value:function(){return this.scene||this._logger.warn("Cannot start a timer not part of a scene, timer wont start until added"),this._running=!0,this.complete&&(this._complete=!1,this._elapsedTime=0,this._numberOfTicks=0),this}},{key:"stop",value:function(){return this._running=!1,this._elapsedTime=0,this._numberOfTicks=0,this}},{key:"cancel",value:function(){this.pause(),this.scene&&this.scene.cancelTimer(this)}}]),t}();Ki._MAX_ID=0,qi([rt({message:"Will be removed in v0.26.0",alternateMethod:"Use Timer.resume()"})],Ki.prototype,"unpause",null);var Zi=function(t,e,n,i){var r,a=arguments.length,o=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,n,o):r(e,n))||o);return a>3&&o&&Object.defineProperty(e,n,o),o},Qi=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t,i,r,a,s,l){var u;if(Object(g.a)(this,n),(u=e.call(this))._token=0,u._onScreenXStart=0,u._onScreenXEnd=9999,u._onScreenYStart=0,u._onScreenYEnd=9999,u._spriteSheets={},u._legacySpriteMap=new Map,u.logger=A.getInstance(),u.data=[],u._rows=[],u._cols=[],u.visible=!0,u.isOffscreen=!1,u._dirty=!0,t&&"object"===typeof t){var c=t;t=c.x,i=c.y,r=c.cellWidth,a=c.cellHeight,s=c.rows,l=c.cols}u.addComponent(new Bn),u.addComponent(new Fn),u.addComponent(new oi({type:_n.Fixed})),u.addComponent(new vi((function(t,e){return u.draw(t,e)}))),u.addComponent(new _i({onPostDraw:function(t,e){return u.draw(t,e)}})),u.addComponent(new ai),u._transform=u.get(Bn),u._motion=u.get(Fn),u._collider=u.get(ai),u._composite=u._collider.useCompositeCollider([]),u.x=t,u.y=i,u.cellWidth=r,u.cellHeight=a,u.rows=s,u.cols=l,u.data=new Array(s*l),u._rows=new Array(s),u._cols=new Array(l);for(var h=[],d=0;d<l;d++){for(var f=0;f<s;f++){var p=new tr(d*r+t,f*a+i,r,a,d+f*l);p.map=Object(o.a)(u),u.data[d+f*l]=p,h.push(p),u._rows[f]||(u._rows[f]=[]),u._rows[f].push(p)}u._cols[d]=h,h=[]}return u.get(_i).localBounds=new dt({left:0,top:0,right:u.cols*u.cellWidth,bottom:u.rows*u.cellHeight}),u}return Object(y.a)(n,[{key:"flagDirty",value:function(){this._dirty=!0}},{key:"x",get:function(){var t;return null!==(t=this._transform.pos.x)&&void 0!==t?t:0},set:function(t){var e;(null===(e=this._transform)||void 0===e?void 0:e.pos)&&(this.get(Bn).pos=st(t,this.y))}},{key:"y",get:function(){var t,e;return null!==(e=null===(t=this._transform)||void 0===t?void 0:t.pos.y)&&void 0!==e?e:0},set:function(t){var e;(null===(e=this._transform)||void 0===e?void 0:e.pos)&&(this._transform.pos=st(this.x,t))}},{key:"z",get:function(){var t;return null!==(t=this._transform.z)&&void 0!==t?t:0},set:function(t){this._transform&&(this._transform.z=t)}},{key:"rotation",get:function(){var t,e;return null!==(e=null===(t=this._transform)||void 0===t?void 0:t.rotation)&&void 0!==e?e:0},set:function(t){var e;(null===(e=this._transform)||void 0===e?void 0:e.rotation)&&(this._transform.rotation=t)}},{key:"scale",get:function(){var t,e;return null!==(e=null===(t=this._transform)||void 0===t?void 0:t.scale)&&void 0!==e?e:ot.One},set:function(t){var e;(null===(e=this._transform)||void 0===e?void 0:e.scale)&&(this._transform.scale=t)}},{key:"pos",get:function(){return this._transform.pos},set:function(t){this._transform.pos=t}},{key:"vel",get:function(){return this._motion.vel},set:function(t){this._motion.vel=t}},{key:"on",value:function(t,e){Object(s.a)(Object(l.a)(n.prototype),"on",this).call(this,t,e)}},{key:"_initialize",value:function(t){Object(s.a)(Object(l.a)(n.prototype),"_initialize",this).call(this,t)}},{key:"registerSpriteSheet",value:function(t,e){this._spriteSheets[t]=e instanceof rn?e:rn.fromLegacySpriteSheet(e)}},{key:"_updateColliders",value:function(){this._composite.clearColliders();for(var t,e=[],n=0;n<this.cols;n++){for(var i=0;i<this.rows;i++){0===i&&(t=null);var r=this.data[n+i*this.cols];r.solid?t=t?t.combine(r.bounds):r.bounds:(t&&e.push(t),t=null)}if(t){var a=e[e.length-1];a&&a.top===t.top&&a.bottom===t.bottom?e[e.length-1]=a.combine(t):e.push(t)}}this._composite=this._collider.useCompositeCollider([]);for(var o=0,s=e;o<s.length;o++){var l=s[o],u=ri.Box(l.width,l.height,ot.Zero,st(l.left-this.pos.x,l.top-this.pos.y));u.owner=this,this._composite.addCollider(u)}this._collider.update()}},{key:"getCellByIndex",value:function(t){return this.data[t]}},{key:"getCell",value:function(t,e){return t<0||e<0||t>=this.cols||e>=this.rows?null:this.data[t+e*this.cols]}},{key:"getCellByPoint",value:function(t,e){t=Math.floor((t-this.pos.x)/this.cellWidth),e=Math.floor((e-this.pos.y)/this.cellHeight);var n=this.getCell(t,e);return t>=0&&e>=0&&t<this.cols&&e<this.rows&&n?n:null}},{key:"getRows",value:function(){return this._rows}},{key:"getColumns",value:function(){return this._cols}},{key:"onPreUpdate",value:function(t,e){}},{key:"onPostUpdate",value:function(t,e){}},{key:"update",value:function(t,e){this.onPreUpdate(t,e),this.emit("preupdate",new Qt(t,e,this)),this._dirty&&(this._dirty=!1,this._updateColliders()),this._token++;var n=t.getWorldBounds(),i=st(n.left,n.top),r=st(n.right,n.bottom);this._onScreenXStart=Math.max(Math.floor((i.x-this.x)/this.cellWidth)-2,0),this._onScreenYStart=Math.max(Math.floor((i.y-this.y)/this.cellHeight)-2,0),this._onScreenXEnd=Math.max(Math.floor((r.x-this.x)/this.cellWidth)+2,0),this._onScreenYEnd=Math.max(Math.floor((r.y-this.y)/this.cellHeight)+2,0),this._transform.pos=st(this.x,this.y),this.onPostUpdate(t,e),this.emit("postupdate",new Yt(t,e,this))}},{key:"draw",value:function(t,e){this.emit("predraw",new Xt(t,e,this));for(var n,i,r,a=this._onScreenXStart,o=Math.min(this._onScreenXEnd,this.cols),s=this._onScreenYStart,l=Math.min(this._onScreenYEnd,this.rows);a<o;a++){for(;s<l;s++)for(i=0,r=(n=this.getCell(a,s).graphics).length;i<r;i++){var u=n[i];u&&(t instanceof CanvasRenderingContext2D?u instanceof qe&&(this._legacySpriteMap.has(u)||this._legacySpriteMap.set(u,qe.toLegacySprite(u)),this._legacySpriteMap.get(u).draw(t,a*this.cellWidth,s*this.cellHeight)):(gi(u)&&(null===u||void 0===u||u.tick(e,this._token)),u.draw(t,a*this.cellWidth,s*this.cellHeight)))}s=this._onScreenYStart}this.emit("postdraw",new qt(t,e,this))}}]),n}(pi);Zi([rt({message:"No longer used, will be removed in v0.26.0"})],Qi.prototype,"registerSpriteSheet",null);var Yi=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t,i,r,a,o,s){return Object(g.a)(this,n),e.call(this,t,i,r,a,o,s)}return n}(Fe(Qi)),$i=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t,i,r,a,o){var s,l=arguments.length>5&&void 0!==arguments[5]&&arguments[5],u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:[];if(Object(g.a)(this,n),(s=e.call(this))._solid=!1,s.graphics=[],s.data=new Map,t&&"object"===typeof t){var c=t;t=c.x,i=c.y,r=c.width,a=c.height,o=c.index,l=c.solid,u=c.sprites}return s.x=t,s.y=i,s.width=r,s.height=a,s.index=o,s.solid=l,s.graphics=u,s._bounds=new dt(s.x,s.y,s.x+s.width,s.y+s.height),s}return Object(y.a)(n,[{key:"solid",get:function(){return this._solid},set:function(t){var e;null===(e=this.map)||void 0===e||e.flagDirty(),this._solid=t}},{key:"bounds",get:function(){return this._bounds}},{key:"center",get:function(){return new ot(this.x+this.width/2,this.y+this.height/2)}},{key:"pushSprite",value:function(t){this.addGraphic(t)}},{key:"addGraphic",value:function(t){t instanceof Ue?this.graphics.push(qe.fromLegacySprite(t)):this.graphics.push(t)}},{key:"removeGraphic",value:function(t){X(t,this.graphics)}},{key:"clearGraphics",value:function(){this.graphics.length=0}}]),n}(pi);Zi([rt({message:"Will be removed in v0.26.0",alternateMethod:"addSprite"})],$i.prototype,"pushSprite",null);var Ji,tr=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t,i,r,a,o,s,l){return Object(g.a)(this,n),e.call(this,t,i,r,a,o,s,l)}return n}(Fe($i)),er=function(){function t(e){Object(g.a)(this,t),this.camera=e}return Object(y.a)(t,[{key:"lockToActor",value:function(t){this.camera.addStrategy(new nr(t))}},{key:"lockToActorAxis",value:function(t,e){this.camera.addStrategy(new ir(t,e))}},{key:"elasticToActor",value:function(t,e,n){this.camera.addStrategy(new rr(t,e,n))}},{key:"radiusAroundActor",value:function(t,e){this.camera.addStrategy(new ar(t,e))}},{key:"limitCameraBounds",value:function(t){this.camera.addStrategy(new or(t))}}]),t}();!function(t){t[t.X=0]="X",t[t.Y=1]="Y"}(Ji||(Ji={}));var nr=function t(e){Object(g.a)(this,t),this.target=e,this.action=function(t,e,n,i){return t.center}},ir=function t(e,n){var i=this;Object(g.a)(this,t),this.target=e,this.axis=n,this.action=function(t,e,n,r){var a=t.center,o=e.getFocus();return i.axis===Ji.X?new ot(a.x,o.y):new ot(o.x,a.y)}},rr=function t(e,n,i){var r=this;Object(g.a)(this,t),this.target=e,this.cameraElasticity=n,this.cameraFriction=i,this.action=function(t,e,n,i){var a=t.center,o=e.getFocus(),s=e.vel.clone(),l=a.sub(o).scale(r.cameraElasticity),u=(s=s.add(l)).scale(-1).scale(r.cameraFriction);return s=s.add(u),o=o.add(s)}},ar=function t(e,n){var i=this;Object(g.a)(this,t),this.target=e,this.radius=n,this.action=function(t,e,n,r){var a=t.center,o=e.getFocus(),s=a.sub(o),l=s.size;if(l>=i.radius){var u=l-i.radius;return o.add(s.normalize().scale(u))}return o}},or=function t(e){var n=this;Object(g.a)(this,t),this.target=e,this.boundSizeChecked=!1,this.action=function(t,e,i,r){var a=e.getFocus();n.boundSizeChecked||((t.bottom-t.top<i.drawHeight||t.right-t.left<i.drawWidth)&&A.getInstance().warn("Camera bounds should not be smaller than the engine viewport"),n.boundSizeChecked=!0);var o=a.x,s=a.y;return a.x<t.left+i.halfDrawWidth?o=t.left+i.halfDrawWidth:a.x>t.right-i.halfDrawWidth&&(o=t.right-i.halfDrawWidth),a.y<t.top+i.halfDrawHeight?s=t.top+i.halfDrawHeight:a.y>t.bottom-i.halfDrawHeight&&(s=t.bottom-i.halfDrawHeight),st(o,s)}},sr=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(){var t;return Object(g.a)(this,n),(t=e.apply(this,arguments))._cameraStrategies=[],t.strategy=new er(Object(o.a)(t)),t._z=1,t.dz=0,t.az=0,t.rotation=0,t.rx=0,t._posChanged=!1,t._pos=Lt(ot.Zero,(function(){return t._posChanged=!0})),t.vel=ot.Zero,t.acc=ot.Zero,t._cameraMoving=!1,t._currentLerpTime=0,t._lerpDuration=1e3,t._lerpStart=null,t._lerpEnd=null,t._isShaking=!1,t._shakeMagnitudeX=0,t._shakeMagnitudeY=0,t._shakeDuration=0,t._elapsedShakeTime=0,t._xShake=0,t._yShake=0,t._isZooming=!1,t._zoomStart=1,t._zoomEnd=1,t._currentZoomTime=0,t._zoomDuration=0,t._zoomEasing=xi.EaseInOutCubic,t._easing=xi.EaseInOutCubic,t._halfWidth=0,t._halfHeight=0,t._viewport=null,t._isInitialized=!1,t}return Object(y.a)(n,[{key:"zoom",get:function(){return this._z},set:function(t){this._z=t,this._engine&&(this._halfWidth=this._engine.halfDrawWidth,this._halfHeight=this._engine.halfDrawHeight)}},{key:"angularVelocity",get:function(){return this.rx},set:function(t){this.rx=t}},{key:"pos",get:function(){return this._pos},set:function(t){var e=this;this._pos=Lt(t,(function(){return e._posChanged=!0})),this._posChanged=!0}},{key:"x",get:function(){return this.pos.x},set:function(t){this._follow||this._cameraMoving||(this.pos=st(t,this.pos.y))}},{key:"y",get:function(){return this.pos.y},set:function(t){this._follow||this._cameraMoving||(this.pos=st(this.pos.x,t))}},{key:"dx",get:function(){return this.vel.x},set:function(t){this.vel=st(t,this.vel.y)}},{key:"dy",get:function(){return this.vel.y},set:function(t){this.vel=st(this.vel.x,t)}},{key:"ax",get:function(){return this.acc.x},set:function(t){this.acc=st(t,this.acc.y)}},{key:"ay",get:function(){return this.acc.y},set:function(t){this.acc=st(this.acc.x,t)}},{key:"getFocus",value:function(){return this.pos}},{key:"move",value:function(t,e){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:xi.EaseInOutCubic;if("function"!==typeof i)throw"Please specify an EasingFunction";return this._follow?Promise.reject(t):(this._lerpPromise&&this._lerpResolve&&this._lerpResolve(t),this._lerpPromise=new Promise((function(t){n._lerpResolve=t})),this._lerpStart=this.getFocus().clone(),this._lerpDuration=e,this._lerpEnd=t,this._currentLerpTime=0,this._cameraMoving=!0,this._easing=i,this._lerpPromise)}},{key:"shake",value:function(t,e,n){this._isShaking=!0,this._shakeMagnitudeX=t,this._shakeMagnitudeY=e,this._shakeDuration=n}},{key:"zoomOverTime",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:xi.EaseInOutCubic;return this._zoomPromise=new Promise((function(t){e._zoomResolve=t})),n?(this._isZooming=!0,this._zoomEasing=i,this._currentZoomTime=0,this._zoomDuration=n,this._zoomStart=this.zoom,this._zoomEnd=t,this._zoomPromise):(this._isZooming=!1,this.zoom=t,Promise.resolve(!0))}},{key:"viewport",get:function(){return this._viewport?this._viewport:new dt(0,0,0,0)}},{key:"addStrategy",value:function(t){this._cameraStrategies.push(t)}},{key:"removeStrategy",value:function(t){X(t,this._cameraStrategies)}},{key:"clearAllStrategies",value:function(){this._cameraStrategies.length=0}},{key:"_preupdate",value:function(t,e){this.emit("preupdate",new Qt(t,e,this)),this.onPreUpdate(t,e)}},{key:"onPreUpdate",value:function(t,e){}},{key:"_postupdate",value:function(t,e){this.emit("postupdate",new Yt(t,e,this)),this.onPostUpdate(t,e)}},{key:"onPostUpdate",value:function(t,e){}},{key:"isInitialized",get:function(){return this._isInitialized}},{key:"_initialize",value:function(t){if(!this.isInitialized){this._engine=t;var e=this._engine.screen.resolution,i=st(e.width/2,e.height/2);if(!this._engine.loadingComplete){var r=this._engine.screen.peekResolution();r&&(i=st(r.width/2,r.height/2))}this._halfWidth=i.x,this._halfHeight=i.x,this._posChanged||(this.pos=i),this.onInitialize(t),Object(s.a)(Object(l.a)(n.prototype),"emit",this).call(this,"initialize",new ge(t,this)),this._isInitialized=!0}}},{key:"onInitialize",value:function(t){}},{key:"on",value:function(t,e){Object(s.a)(Object(l.a)(n.prototype),"on",this).call(this,t,e)}},{key:"off",value:function(t,e){Object(s.a)(Object(l.a)(n.prototype),"off",this).call(this,t,e)}},{key:"once",value:function(t,e){Object(s.a)(Object(l.a)(n.prototype),"once",this).call(this,t,e)}},{key:"update",value:function(t,e){if(this._initialize(t),this._preupdate(t,e),this.pos=this.pos.add(this.vel.scale(e/1e3)),this.zoom+=this.dz*e/1e3,this.vel=this.vel.add(this.acc.scale(e/1e3)),this.dz+=this.az*e/1e3,this.rotation+=this.angularVelocity*e/1e3,this._isZooming)if(this._currentZoomTime<this._zoomDuration){var n=(0,this._zoomEasing)(this._currentZoomTime,this._zoomStart,this._zoomEnd,this._zoomDuration);this.zoom=n,this._currentZoomTime+=e}else this._isZooming=!1,this.zoom=this._zoomEnd,this._currentZoomTime=0,this._zoomResolve(!0);if(this._cameraMoving)if(this._currentLerpTime<this._lerpDuration){var i=xi.CreateVectorEasingFunction(this._easing)(this._currentLerpTime,this._lerpStart,this._lerpEnd,this._lerpDuration);this.pos=i,this._currentLerpTime+=e}else{this.pos=this._lerpEnd;var r=this._lerpEnd.clone();this._lerpStart=null,this._lerpEnd=null,this._currentLerpTime=0,this._cameraMoving=!1,this._lerpResolve(r)}this._isDoneShaking()?(this._isShaking=!1,this._elapsedShakeTime=0,this._shakeMagnitudeX=0,this._shakeMagnitudeY=0,this._shakeDuration=0,this._xShake=0,this._yShake=0):(this._elapsedShakeTime+=e,this._xShake=1+(Math.random()*this._shakeMagnitudeX|0),this._yShake=1+(Math.random()*this._shakeMagnitudeY|0));var a,o=Object(f.a)(this._cameraStrategies);try{for(o.s();!(a=o.n()).done;){var s=a.value;this.pos=s.action.call(s,s.target,this,t,e)}}catch(l){o.e(l)}finally{o.f()}this._viewport=new dt(this.x-this._halfWidth,this.y-this._halfHeight,this.x+this._halfWidth,this.y+this._halfHeight),this._postupdate(t,e)}},{key:"draw",value:function(t){var e=0,n=0;t instanceof CanvasRenderingContext2D?(e=t.canvas.width,n=t.canvas.height):(e=t.width,n=t.height);var i=this.getFocus(),r=this._engine?this._engine.pixelRatio:1,a=this.zoom,o=e/a/r,s=n/a/r;t.scale(a,a),t.translate(-i.x+o/2+this._xShake,-i.y+s/2+this._yShake)}},{key:"debugDraw",value:function(t){}},{key:"_isDoneShaking",value:function(){return!this._isShaking||this._elapsedShakeTime>=this._shakeDuration}}]),n}(fn);function lr(t){return t instanceof Xi}var ur,cr={pos:ot.Zero,width:10,height:10,visible:!1,action:function(){},filter:function(){return!0},repeat:-1},hr=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t){var i;return Object(g.a)(this,n),(i=e.call(this,{x:t.pos.x,y:t.pos.y,width:t.width,height:t.height})).action=function(){},i.filter=function(){return!0},i.repeat=-1,t=L({},cr,t),i.filter=t.filter||i.filter,i.repeat=t.repeat||i.repeat,i.action=t.action||i.action,t.target&&(i.target=t.target),i.graphics.visible=t.visible,i.body.collisionType=_n.Passive,i.eventDispatcher=new xe(Object(o.a)(i)),i.events.on("collisionstart",(function(t){i.filter(t.other)&&(i.emit("enter",new we(Object(o.a)(i),t.other)),i._dispatchAction(),0===i.repeat&&i.kill())})),i.events.on("collisionend",(function(t){i.filter(t.other)&&i.emit("exit",new ke(Object(o.a)(i),t.other))})),i}return Object(y.a)(n,[{key:"target",get:function(){return this._target},set:function(t){this._target=t,this.filter=function(e){return e===t}}},{key:"_initialize",value:function(t){Object(s.a)(Object(l.a)(n.prototype),"_initialize",this).call(this,t)}},{key:"_dispatchAction",value:function(){0!==this.repeat&&(this.action.call(this),this.repeat--)}},{key:"debugDraw",value:function(t){Object(s.a)(Object(l.a)(n.prototype),"debugDraw",this).call(this,t),t.save(),t.translate(this.pos.x,this.pos.y);var e=this.collider.bounds,i=this.getGlobalPos();e.left=e.left-i.x,e.right=e.right-i.x,e.top=e.top-i.y,e.bottom=e.bottom-i.y,t.fillStyle=ut.Violet.toString(),t.strokeStyle=ut.Violet.toString(),t.fillText("Trigger",10,10),e.debugDraw(t),t.restore()}}]),n}(Gi);!function(t){t.Update="update",t.Draw="draw"}(ur||(ur={}));var dr=function(){function t(){Object(g.a)(this,t),this.priority=0}return Object(y.a)(t,[{key:"notify",value:function(t){}}]),t}(),fr=function t(e){Object(g.a)(this,t),this.data=e,this.type="Entity Added"};function pr(t){return!!t&&"Entity Added"===t.type}var vr=function t(e){Object(g.a)(this,t),this.data=e,this.type="Entity Removed"};function gr(t){return!!t&&"Entity Removed"===t.type}var yr,mr,_r=function(){function t(e){Object(g.a)(this,t),this._world=e,this.entities=[],this._entityIndex={},this._entitiesToRemove=[]}return Object(y.a)(t,[{key:"updateEntities",value:function(t,e){var n,i=Object(f.a)(this.entities);try{for(i.s();!(n=i.n()).done;){var r=n.value;r.update(t.engine,e),r.active||this.removeEntity(r)}}catch(a){i.e(a)}finally{i.f()}}},{key:"findEntitiesForRemoval",value:function(){var t,e=Object(f.a)(this.entities);try{for(e.s();!(t=e.n()).done;){var n=t.value;n.active||this.removeEntity(n)}}catch(i){e.e(i)}finally{e.f()}}},{key:"notify",value:function(t){hi(t)&&this._world.queryManager.addEntity(t.data.entity),fi(t)&&this._world.queryManager.removeComponent(t.data.entity,t.data.component)}},{key:"addEntity",value:function(t){var e=this;t.active=!0,t&&!this._entityIndex[t.id]&&(this._entityIndex[t.id]=t,this.entities.push(t),this._world.queryManager.addEntity(t),t.componentAdded$.register(this),t.componentRemoved$.register(this),t.children.forEach((function(t){return e.addEntity(t)})),t.childrenAdded$.register({notify:function(t){e.addEntity(t)}}),t.childrenRemoved$.register({notify:function(t){e.removeEntity(t,!1)}}))}},{key:"removeEntity",value:function(t){var e,n=this,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=0;r=t instanceof pi?t.id:t;var a=this._entityIndex[r];a&&a.active&&a.kill(),a&&i?this._entitiesToRemove.push(a):(delete this._entityIndex[r],a&&(X(a,this.entities),this._world.queryManager.removeEntity(a),a.componentAdded$.unregister(this),a.componentRemoved$.unregister(this),a.children.forEach((function(t){return n.removeEntity(t,i)})),a.childrenAdded$.clear(),a.childrenRemoved$.clear(),(null===(e=this._world.context)||void 0===e?void 0:e.engine)&&this._world.context.engine.stats.currFrame.actors.killed++))}},{key:"processEntityRemovals",value:function(){var t,e=Object(f.a)(this._entitiesToRemove);try{for(e.s();!(t=e.n()).done;){var n=t.value;n.active||this.removeEntity(n,!1)}}catch(i){e.e(i)}finally{e.f()}}},{key:"processComponentRemovals",value:function(){var t,e=Object(f.a)(this.entities);try{for(e.s();!(t=e.n()).done;){t.value.processComponentRemoval()}}catch(n){e.e(n)}finally{e.f()}}},{key:"getById",value:function(t){return this._entityIndex[t]}},{key:"getByName",value:function(t){return this.entities.filter((function(e){return e.name===t}))}},{key:"clear",value:function(){var t,e=Object(f.a)(this.entities);try{for(e.s();!(t=e.n()).done;){var n=t.value;this.removeEntity(n)}}catch(i){e.e(i)}finally{e.f()}}}]),t}(),br=function(t){return d(t).sort((function(t,e){return t.localeCompare(e)})).join("+")},wr=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t){var i;return Object(g.a)(this,n),(i=e.call(this))._entities=[],t[0]instanceof Function?i.types=t.map((function(t){return(new t).type})):i.types=t,i}return Object(y.a)(n,[{key:"key",get:function(){return this._key?this._key:this._key=br(this.types)}},{key:"getEntities",value:function(t){return t&&this._entities.sort(t),this._entities}},{key:"addEntity",value:function(t){!q(this._entities,t)&&this.matches(t)&&(this._entities.push(t),this.notifyAll(new fr(t)))}},{key:"removeEntity",value:function(t){X(t,this._entities)&&this.notifyAll(new vr(t))}},{key:"clear",value:function(){this._entities.length=0;var t,e=Object(f.a)(this.observers);try{for(e.s();!(t=e.n()).done;){var n=t.value;this.unregister(n)}}catch(i){e.e(i)}finally{e.f()}}},{key:"matches",value:function(t){var e=[];e=t instanceof pi?t.types:t;var n,i=!0,r=Object(f.a)(this.types);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(i=i&&e.indexOf(a)>-1,!i)return!1}}catch(o){r.e(o)}finally{r.f()}return i}},{key:"contain",value:function(t){return this.types.indexOf(t)>-1}}]),n}(zn),kr=function(){function t(e){Object(g.a)(this,t),this._world=e,this._queries={}}return Object(y.a)(t,[{key:"_addQuery",value:function(t){this._queries[br(t.types)]=t;var e,n=Object(f.a)(this._world.entityManager.entities);try{for(n.s();!(e=n.n()).done;){var i=e.value;t.addEntity(i)}}catch(r){n.e(r)}finally{n.f()}}},{key:"maybeRemoveQuery",value:function(t){0===t.observers.length&&(t.clear(),delete this._queries[br(t.types)])}},{key:"addEntity",value:function(t){for(var e in this._queries)this._queries[e]&&this._queries[e].addEntity(t)}},{key:"removeComponent",value:function(t,e){for(var n in this._queries)this._queries[n].contain(e.type)&&this._queries[n].removeEntity(t)}},{key:"removeEntity",value:function(t){for(var e in this._queries)this._queries[e].removeEntity(t)}},{key:"createQuery",value:function(t){var e=this.getQuery(t);if(e)return e;var n=new wr(t);return this._addQuery(n),n}},{key:"getQuery",value:function(t){var e=br(t);return this._queries[e]?this._queries[e]:null}}]),t}(),xr=function(){function t(e){Object(g.a)(this,t),this._world=e,this.systems=[],this.initialized=!1}return Object(y.a)(t,[{key:"get",value:function(t){return this.systems.find((function(e){return e instanceof t}))}},{key:"addSystem",value:function(t){if(!t.types||0===t.types.length)throw new Error("Attempted to add a System without any types");var e=this._world.queryManager.createQuery(t.types);this.systems.push(t),this.systems.sort((function(t,e){return t.priority-e.priority})),e.register(t),this.initialized&&t.initialize&&t.initialize(this._world.context)}},{key:"removeSystem",value:function(t){X(t,this.systems);var e=this._world.queryManager.getQuery(t.types);e&&(e.unregister(t),this._world.queryManager.maybeRemoveQuery(e))}},{key:"updateSystems",value:function(t,e,n){if(!this.initialized){this.initialized=!0;var i,r=Object(f.a)(this.systems);try{for(r.s();!(i=r.n()).done;){var a=i.value;a.initialize&&a.initialize(this._world.context)}}catch(b){r.e(b)}finally{r.f()}}var o,s=this.systems.filter((function(e){return e.systemType===t})),l=Object(f.a)(s);try{for(l.s();!(o=l.n()).done;){var u=o.value;u.preupdate&&u.preupdate(e,n)}}catch(b){l.e(b)}finally{l.f()}var c,h=Object(f.a)(s);try{for(h.s();!(c=h.n()).done;){var d=c.value,p=this._world.queryManager.getQuery(d.types).getEntities(d.sort);if(e instanceof Wr){var v,g=Object(f.a)(p);try{for(g.s();!(v=g.n()).done;){v.value._initialize(null===e||void 0===e?void 0:e.engine)}}catch(b){g.e(b)}finally{g.f()}}d.update(p,n)}}catch(b){h.e(b)}finally{h.f()}var y,m=Object(f.a)(s);try{for(m.s();!(y=m.n()).done;){var _=y.value;_.postupdate&&_.postupdate(e,n)}}catch(b){m.e(b)}finally{m.f()}}},{key:"clear",value:function(){var t,e=Object(f.a)(this.systems);try{for(e.s();!(t=e.n()).done;){var n=t.value;this.removeSystem(n)}}catch(i){e.e(i)}finally{e.f()}}}]),t}(),Sr=function(){function t(e){Object(g.a)(this,t),this.context=e,this.queryManager=new kr(this),this.entityManager=new _r(this),this.systemManager=new xr(this)}return Object(y.a)(t,[{key:"update",value:function(t,e){t===ur.Update&&this.entityManager.updateEntities(this.context,e),this.systemManager.updateSystems(t,this.context,e),this.entityManager.findEntitiesForRemoval(),this.entityManager.processComponentRemovals(),this.entityManager.processEntityRemovals()}},{key:"add",value:function(t){t instanceof pi&&this.entityManager.addEntity(t),t instanceof dr&&this.systemManager.addSystem(t)}},{key:"remove",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t instanceof pi&&this.entityManager.removeEntity(t,e),t instanceof dr&&this.systemManager.removeSystem(t)}},{key:"clearEntities",value:function(){this.entityManager.clear()}},{key:"clearSystems",value:function(){this.systemManager.clear()}}]),t}(),Cr=function(){function t(){Object(g.a)(this,t)}return Object(y.a)(t,null,[{key:"integrate",value:function(t,e,n,i){var r=i/1e3;e.vel.addEqual(n.scale(r)),t.pos.addEqual(e.vel.scale(r)).addEqual(n.scale(.5*r*r)),e.angularVelocity+=e.torque*(1/e.inertia)*r,t.rotation+=e.angularVelocity*r,t.scale.addEqual(e.scaleFactor.scale(r))}}]),t}(),Or=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(){var t;return Object(g.a)(this,n),(t=e.apply(this,arguments)).types=["ex.transform","ex.motion"],t.systemType=ur.Update,t.priority=-1,t}return Object(y.a)(n,[{key:"update",value:function(t,e){var n,i,r,a=Object(f.a)(t);try{for(a.s();!(r=a.n()).done;){var o=r.value;n=o.get(Bn),i=o.get(Fn);var s=o.get(oi);if(!(null===s||void 0===s?void 0:s.sleeping)){var l=i.acc.clone();(null===s||void 0===s?void 0:s.collisionType)===_n.Active&&(null===s||void 0===s?void 0:s.useGravity)&&l.addEqual(Pn.gravity),null===s||void 0===s||s.captureOldTransform(),Cr.integrate(n,i,l,e)}}}catch(u){a.e(u)}finally{a.f()}}},{key:"debugDraw",value:function(t){}}]),n}(dr),Er=function(){function t(){Object(g.a)(this,t)}return Object(y.a)(t,[{key:"solve",value:function(t){return this.preSolve(t),t=t.filter((function(t){return!t.isCanceled()})),this.solveVelocity(t),this.solvePosition(t),this.postSolve(t),t}}]),t}(),Ar=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(){return Object(g.a)(this,n),e.apply(this,arguments)}return Object(y.a)(n,[{key:"preSolve",value:function(t){var e,n=Object(f.a)(t);try{for(n.s();!(e=n.n()).done;){var i=e.value,r=P.fromDirection(i.mtv),a=i.mtv.negate();i.colliderA.events.emit("precollision",new le(i.colliderA,i.colliderB,r,a)),i.colliderB.events.emit("precollision",new le(i.colliderB,i.colliderA,P.getOpposite(r),a.negate()))}}catch(o){n.e(o)}finally{n.f()}}},{key:"postSolve",value:function(t){var e,n,i,r=Object(f.a)(t);try{for(r.s();!(i=r.n()).done;){var a=i.value,o=a.colliderA,s=a.colliderB,l=null===(e=o.owner)||void 0===e?void 0:e.get(oi),u=null===(n=s.owner)||void 0===n?void 0:n.get(oi);if(!l||!u||l.collisionType!==_n.Passive&&u.collisionType!==_n.Passive){var c=P.fromDirection(a.mtv),h=a.mtv.negate();a.colliderA.events.emit("postcollision",new ue(a.colliderA,a.colliderB,c,h)),a.colliderB.events.emit("postcollision",new ue(a.colliderB,a.colliderA,P.getOpposite(c),h.negate()))}}}catch(d){r.e(d)}finally{r.f()}}},{key:"solvePosition",value:function(t){var e,n,i,r=Object(f.a)(t);try{for(r.s();!(i=r.n()).done;){var a=i.value,o=a.mtv,s=a.colliderA,l=a.colliderB,u=null===(e=s.owner)||void 0===e?void 0:e.get(oi),c=null===(n=l.owner)||void 0===n?void 0:n.get(oi);if(u&&c){if(u.collisionType===_n.Passive||c.collisionType===_n.Passive)continue;u.collisionType===_n.Active&&c.collisionType===_n.Active&&(o=o.scale(.5)),u.collisionType===_n.Active&&(u.pos.x-=o.x,u.pos.y-=o.y),c.collisionType===_n.Active&&(c.pos.x+=o.x,c.pos.y+=o.y)}}}catch(h){r.e(h)}finally{r.f()}}},{key:"solveVelocity",value:function(t){var e,n,i,r=Object(f.a)(t);try{for(r.s();!(i=r.n()).done;){var a=i.value,o=a.colliderA,s=a.colliderB,l=null===(e=o.owner)||void 0===e?void 0:e.get(oi),u=null===(n=s.owner)||void 0===n?void 0:n.get(oi);if(l&&u){if(l.collisionType===_n.Passive||u.collisionType===_n.Passive)continue;var c=a.normal,h=c.negate();if(l.collisionType===_n.Active){var d=c.scale(c.dot(l.vel.negate()));l.vel=l.vel.add(d)}if(u.collisionType===_n.Active){var p=h.scale(h.dot(u.vel.negate()));u.vel=u.vel.add(p)}}}}catch(v){r.e(v)}finally{r.f()}}}]),n}(Er),Pr=function(){function t(e,n,i){Object(g.a)(this,t),this.point=e,this.local=n,this.contact=i,this.normalImpulse=0,this.tangentImpulse=0,this.normalMass=0,this.tangentMass=0,this.aToContact=new ot(0,0),this.bToContact=new ot(0,0),this.update()}return Object(y.a)(t,[{key:"update",value:function(){var t,e,n=null===(t=this.contact.colliderA.owner)||void 0===t?void 0:t.get(oi),i=null===(e=this.contact.colliderB.owner)||void 0===e?void 0:e.get(oi);if(n&&i){var r=this.contact.normal,a=this.contact.tangent;this.aToContact=this.point.sub(n.pos),this.bToContact=this.point.sub(i.pos);var o=this.aToContact.cross(r),s=this.bToContact.cross(r);this.normalMass=n.inverseMass+i.inverseMass+n.inverseInertia*o*o+i.inverseInertia*s*s;var l=this.aToContact.cross(a),u=this.bToContact.cross(a);this.tangentMass=n.inverseMass+i.inverseMass+n.inverseInertia*l*l+i.inverseInertia*u*u}return this}},{key:"getRelativeVelocity",value:function(){var t,e,n=null===(t=this.contact.colliderA.owner)||void 0===t?void 0:t.get(oi),i=null===(e=this.contact.colliderB.owner)||void 0===e?void 0:e.get(oi);if(n&&i){var r=n.vel.add(ot.cross(n.angularVelocity,this.aToContact));return i.vel.add(ot.cross(i.angularVelocity,this.bToContact)).sub(r)}return ot.Zero}}]),t}(),jr=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(){var t;return Object(g.a)(this,n),(t=e.apply(this,arguments)).lastFrameContacts=new Map,t.idToContactConstraint=new Map,t}return Object(y.a)(n,[{key:"getContactConstraints",value:function(t){var e;return null!==(e=this.idToContactConstraint.get(t))&&void 0!==e?e:[]}},{key:"preSolve",value:function(t){var e,n,i,r,a=Object(f.a)(t);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=P.fromDirection(o.mtv);o.colliderA.events.emit("precollision",new le(o.colliderA,o.colliderB,s,o.mtv)),o.colliderA.events.emit("beforecollisionresolve",new de(o.colliderA,o.colliderB,s,o.mtv,o)),o.colliderB.events.emit("precollision",new le(o.colliderB,o.colliderA,P.getOpposite(s),o.mtv.negate())),o.colliderB.events.emit("beforecollisionresolve",new de(o.colliderB,o.colliderA,P.getOpposite(s),o.mtv.negate(),o)),o.matchAwake()}}catch(H){a.e(H)}finally{a.f()}var l,u=Array.from(this.idToContactConstraint.keys()),c=Object(f.a)(t);try{for(c.s();!(l=c.n()).done;){var h=l.value,d=u.indexOf(h.id);d>-1&&u.splice(d,1);var p=null!==(e=this.idToContactConstraint.get(h.id))&&void 0!==e?e:[],v=0,g=h.colliderA.owner.get(oi),y=h.colliderB.owner.get(oi);if(g&&y){var m,_=Object(f.a)(h.points);try{for(_.s();!(m=_.n()).done;){var b=m.value,w=h.normal,k=h.tangent,x=b.sub(g.pos),S=b.sub(y.pos),C=x.cross(w),O=S.cross(w),E=g.inverseMass+y.inverseMass+g.inverseInertia*C*C+y.inverseInertia*O*O,A=x.cross(k),j=S.cross(k),T=g.inverseMass+y.inverseMass+g.inverseInertia*A*A+y.inverseInertia*j*j;p[v]&&(null===(i=null===(n=p[v])||void 0===n?void 0:n.point)||void 0===i?void 0:i.squareDistance(b))<4?(p[v].point=b,p[v].local=h.localPoints[v]):p[v]=new Pr(b,h.localPoints[v],h),p[v].aToContact=x,p[v].bToContact=S,p[v].normalMass=E,p[v].tangentMass=T,v++}}catch(H){_.e(H)}finally{_.f()}}this.idToContactConstraint.set(h.id,p)}}catch(H){c.e(H)}finally{c.f()}for(var R=0,D=u;R<D.length;R++){var M=D[R];this.idToContactConstraint.delete(M)}if(Pn.warmStart)this.warmStart(t);else{var L,B=Object(f.a)(t);try{for(B.s();!(L=B.n()).done;){var F,I=L.value,z=this.getContactConstraints(I.id),N=Object(f.a)(z);try{for(N.s();!(F=N.n()).done;){var U=F.value;U.normalImpulse=0,U.tangentImpulse=0}}catch(H){N.e(H)}finally{N.f()}}}catch(H){B.e(H)}finally{B.f()}}}},{key:"postSolve",value:function(t){var e,n=Object(f.a)(t);try{for(n.s();!(e=n.n()).done;){var i=e.value,r=i.colliderA.owner.get(oi),a=i.colliderB.owner.get(oi);if(r&&a){if(r.collisionType===_n.Passive||a.collisionType===_n.Passive)continue;r.updateMotion(),a.updateMotion()}var o=P.fromDirection(i.mtv);i.colliderA.events.emit("postcollision",new ue(i.colliderA,i.colliderB,o,i.mtv)),i.colliderA.events.emit("aftercollisionresolve",new fe(i.colliderA,i.colliderB,o,i.mtv,i)),i.colliderB.events.emit("postcollision",new ue(i.colliderB,i.colliderA,P.getOpposite(o),i.mtv.negate())),i.colliderB.events.emit("aftercollisionresolve",new fe(i.colliderB,i.colliderA,P.getOpposite(o),i.mtv.negate(),i))}}catch(c){n.e(c)}finally{n.f()}this.lastFrameContacts.clear();var s,l=Object(f.a)(t);try{for(l.s();!(s=l.n()).done;){var u=s.value;this.lastFrameContacts.set(u.id,u)}}catch(c){l.e(c)}finally{l.f()}}},{key:"warmStart",value:function(t){var e,n,i,r,a=Object(f.a)(t);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=null===(e=o.colliderA.owner)||void 0===e?void 0:e.get(oi),l=null===(n=o.colliderB.owner)||void 0===n?void 0:n.get(oi);if(s&&l){var u,c=null!==(i=this.idToContactConstraint.get(o.id))&&void 0!==i?i:[],h=Object(f.a)(c);try{for(h.s();!(u=h.n()).done;){var d=u.value;if(Pn.warmStart){var p=o.normal.scale(d.normalImpulse),v=o.tangent.scale(d.tangentImpulse),g=p.add(v);s.applyImpulse(d.point,g.negate()),l.applyImpulse(d.point,g)}else d.normalImpulse=0,d.tangentImpulse=0}}catch(y){h.e(y)}finally{h.f()}}}}catch(y){a.e(y)}finally{a.f()}}},{key:"solvePosition",value:function(t){for(var e,n,i,r=0;r<Pn.positionIterations;r++){var a,o=Object(f.a)(t);try{for(o.s();!(a=o.n()).done;){var s=a.value,l=null===(e=s.colliderA.owner)||void 0===e?void 0:e.get(oi),u=null===(n=s.colliderB.owner)||void 0===n?void 0:n.get(oi);if(l&&u){if(l.collisionType===_n.Passive||u.collisionType===_n.Passive)continue;var c,h=null!==(i=this.idToContactConstraint.get(s.id))&&void 0!==i?i:[],d=Object(f.a)(h);try{for(d.s();!(c=d.n()).done;){var p=c.value,v=s.normal,g=ei.FindContactSeparation(s,p.local),y=Pn.steeringFactor,m=I(y*(g+Pn.slop),-5,0),_=v.scale(-m/p.normalMass);l.collisionType===_n.Active&&(l.pos=l.pos.add(_.negate().scale(l.inverseMass)),l.rotation-=p.aToContact.cross(_)*l.inverseInertia),u.collisionType===_n.Active&&(u.pos=u.pos.add(_.scale(u.inverseMass)),u.rotation+=p.bToContact.cross(_)*u.inverseInertia)}}catch(b){d.e(b)}finally{d.f()}}}}catch(b){o.e(b)}finally{o.f()}}}},{key:"solveVelocity",value:function(t){for(var e,n,i,r=0;r<Pn.velocityIterations;r++){var a,o=Object(f.a)(t);try{for(o.s();!(a=o.n()).done;){var s=a.value,l=null===(e=s.colliderA.owner)||void 0===e?void 0:e.get(oi),u=null===(n=s.colliderB.owner)||void 0===n?void 0:n.get(oi);if(l&&u){if(l.collisionType===_n.Passive||u.collisionType===_n.Passive)continue;var c,h=l.bounciness*u.bounciness,d=Math.min(l.friction,u.friction),p=null!==(i=this.idToContactConstraint.get(s.id))&&void 0!==i?i:[],v=Object(f.a)(p);try{for(v.s();!(c=v.n()).done;){var g=c.value,y=-g.getRelativeVelocity().dot(s.tangent)/g.tangentMass,m=d*g.normalImpulse,_=I(g.tangentImpulse+y,-m,m);y=_-g.tangentImpulse,g.tangentImpulse=_;var b=s.tangent.scale(y);l.applyImpulse(g.point,b.negate()),u.applyImpulse(g.point,b)}}catch(E){v.e(E)}finally{v.f()}var w,k=Object(f.a)(p);try{for(k.s();!(w=k.n()).done;){var x=w.value,S=-(1+h)*x.getRelativeVelocity().dot(s.normal)/x.normalMass,C=Math.max(x.normalImpulse+S,0);S=C-x.normalImpulse,x.normalImpulse=C;var O=s.normal.scale(S);l.applyImpulse(x.point,O.negate()),u.applyImpulse(x.point,O)}}catch(E){k.e(E)}finally{k.f()}}}}catch(E){o.e(E)}finally{o.f()}}}}]),n}(Er),Tr=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(){var t;return Object(g.a)(this,n),(t=e.apply(this,arguments)).types=["ex.transform","ex.motion","ex.collider"],t.systemType=ur.Update,t.priority=-1,t._realisticSolver=new jr,t._arcadeSolver=new Ar,t._processor=new Gn,t._lastFrameContacts=new Map,t._currentFrameContacts=new Map,t._trackCollider=function(e){return t._processor.track(e)},t._untrackCollider=function(e){return t._processor.untrack(e)},t}return Object(y.a)(n,[{key:"notify",value:function(t){if(pr(t)){var e=t.data.get(ai);e.$colliderAdded.subscribe(this._trackCollider),e.$colliderRemoved.subscribe(this._untrackCollider);var n=e.get();n&&this._processor.track(n)}else{var i=t.data.get(ai),r=i.get();i&&r&&this._processor.untrack(r)}}},{key:"initialize",value:function(t){this._engine=t.engine}},{key:"update",value:function(t,e){var n,i=this;if(Pn.enabled){var r,a=[],o=Object(f.a)(t);try{for(o.s();!(r=o.n()).done;){var s=r.value.get(ai),l=null===s||void 0===s?void 0:s.get();s&&(null===(n=s.owner)||void 0===n?void 0:n.active)&&l&&(s.update(),l instanceof qn?a=a.concat(l.getColliders()):a.push(l))}}catch(h){o.e(h)}finally{o.f()}this._processor.update(a);var u=this._processor.broadphase(a,e);this._currentFrameContacts.clear();var c=this._processor.narrowphase(u,this._engine.debug.stats.currFrame);(c=this.getSolver().solve(c)).forEach((function(t){return i._currentFrameContacts.set(t.id,t)})),this.runContactStartEnd(),this._lastFrameContacts.clear(),this._lastFrameContacts=new Map(this._currentFrameContacts)}}},{key:"getSolver",value:function(){return Pn.collisionResolutionStrategy===Cn.Realistic?this._realisticSolver:this._arcadeSolver}},{key:"debug",value:function(t){this._processor.debug(t)}},{key:"runContactStartEnd",value:function(){var t,e=Object(f.a)(this._currentFrameContacts);try{for(e.s();!(t=e.n()).done;){var n=a(t.value,2),i=n[0],r=n[1];if(!this._lastFrameContacts.has(i)){var o=r.colliderA,s=r.colliderB;o.events.emit("collisionstart",new pe(o,s,r)),o.events.emit("contactstart",new ce(o,s,r)),s.events.emit("collisionstart",new pe(s,o,r)),s.events.emit("contactstart",new ce(s,o,r))}}}catch(g){e.e(g)}finally{e.f()}var l,u=Object(f.a)(this._lastFrameContacts);try{for(u.s();!(l=u.n()).done;){var c=a(l.value,2),h=c[0],d=c[1];if(!this._currentFrameContacts.has(h)){var p=d.colliderA,v=d.colliderB;p.events.emit("collisionend",new ve(p,v)),p.events.emit("contactend",new he(p,v)),v.events.emit("collisionend",new ve(v,p)),v.events.emit("contactend",new he(v,p))}}}catch(g){u.e(g)}finally{u.f()}}}]),n}(dr);!function(t){t.Forward="forward",t.Backward="backward"}(yr||(yr={})),function(t){t.End="end",t.Loop="loop",t.PingPong="pingpong",t.Freeze="freeze"}(mr||(mr={}));var Rr=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t){var i,r,a;return Object(g.a)(this,n),(i=e.call(this,t)).events=new xe(Object(o.a)(i)),i.frames=[],i.strategy=mr.Loop,i.frameDuration=100,i.timeScale=1,i._idempotencyToken=-1,i._firstTick=!0,i._currentFrame=0,i._timeLeftInFrame=0,i._direction=1,i._done=!1,i._playing=!0,i._reversed=!1,i.frames=t.frames,i.strategy=null!==(r=t.strategy)&&void 0!==r?r:i.strategy,i.frameDuration=t.totalDuration?t.totalDuration/i.frames.length:null!==(a=t.frameDuration)&&void 0!==a?a:i.frameDuration,t.reverse&&i.reverse(),i.goToFrame(0),i}return Object(y.a)(n,[{key:"clone",value:function(){return new n(Object.assign({frames:this.frames.map((function(t){return Object.assign({},t)})),frameDuration:this.frameDuration,reverse:this._reversed,strategy:this.strategy},this.cloneGraphicOptions()))}},{key:"currentFrame",get:function(){return this._currentFrame>=0&&this._currentFrame<this.frames.length?this.frames[this._currentFrame]:null}},{key:"currentFrameIndex",get:function(){return this._currentFrame}},{key:"isPlaying",get:function(){return this._playing}},{key:"reverse",value:function(){this.frames=this.frames.slice().reverse(),this._reversed=!this._reversed}},{key:"direction",get:function(){return!(!this._reversed||1!==this._direction)?yr.Backward:yr.Forward}},{key:"play",value:function(){this._playing=!0}},{key:"pause",value:function(){this._playing=!1,this._firstTick=!0}},{key:"reset",value:function(){this._done=!1,this._firstTick=!0,this._currentFrame=0}},{key:"canFinish",get:function(){switch(this.strategy){case mr.End:case mr.Freeze:return!0;default:return!1}}},{key:"done",get:function(){return this._done}},{key:"goToFrame",value:function(t){var e,n;this._currentFrame=t,this._timeLeftInFrame=this.frameDuration;var i=this.frames[this._currentFrame];i&&!this._done&&(this._timeLeftInFrame=(null===i||void 0===i?void 0:i.duration)||this.frameDuration,this.width=null===(e=i.graphic)||void 0===e?void 0:e.width,this.height=null===(n=i.graphic)||void 0===n?void 0:n.height,this.events.emit("frame",i))}},{key:"_nextFrame",value:function(){var t=this._currentFrame;if(this._done)return t;var e=-1;switch(this.strategy){case mr.Loop:0===(e=(t+1)%this.frames.length)&&this.events.emit("loop",this);break;case mr.End:(e=t+1)>=this.frames.length&&(this._done=!0,this._currentFrame=this.frames.length,this.events.emit("end",this));break;case mr.Freeze:(e=I(t+1,0,this.frames.length-1))>=this.frames.length-1&&(this._done=!0,this.events.emit("end",this));break;case mr.PingPong:t+this._direction>=this.frames.length&&(this._direction=-1,this.events.emit("loop",this)),t+this._direction<0&&(this._direction=1,this.events.emit("loop",this)),e=t+this._direction%this.frames.length}return e}},{key:"tick",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._idempotencyToken!==e&&(this._idempotencyToken=e,this._playing&&(this._firstTick&&(this._firstTick=!1,this.events.emit("frame",this.currentFrame)),this._timeLeftInFrame-=t*this.timeScale,this._timeLeftInFrame<=0&&this.goToFrame(this._nextFrame()),this._updateDimensions()))}},{key:"_updateDimensions",value:function(){var t,e;this.currentFrame&&(this.width=null===(t=this.currentFrame.graphic)||void 0===t?void 0:t.width,this.height=null===(e=this.currentFrame.graphic)||void 0===e?void 0:e.height)}},{key:"_drawImage",value:function(t,e,n){this.currentFrame&&this.currentFrame.graphic.draw(t,e,n)}}],[{key:"fromSpriteSheet",value:function(t,e,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:mr.Loop,a=t.sprites.length-1,o=e.filter((function(t){return t<0||t>a}));return o.length&&n._LOGGER.warn("Indices into SpriteSheet were provided that don't exist: ".concat(o.join(",")," no frame will be shown")),new n({frames:t.sprites.filter((function(t,n){return e.indexOf(n)>-1})).map((function(t){return{graphic:t,duration:i}})),strategy:r})}},{key:"toLegacyAnimation",value:function(t,e){var n=e.frames.map((function(t){return qe.toLegacySprite(t.graphic)}));return new $e({sprites:n,loop:e.strategy===mr.Loop,freezeFrame:e.strategy===mr.Freeze?n.length-1:void 0,speed:e.frameDuration,engine:t})}}]),n}(Dt);Rr._LOGGER=A.getInstance();var Dr,Mr=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t){var i;return Object(g.a)(this,n),(i=e.call(this,t)).members=[],i.members=t.members,i._updateDimensions(),i}return Object(y.a)(n,[{key:"clone",value:function(){return new n(Object.assign({members:d(this.members)},this.cloneGraphicOptions()))}},{key:"_updateDimensions",value:function(){var t,e=new dt,n=Object(f.a)(this.members);try{for(n.s();!(t=n.n()).done;){var i=t.value,r=i.graphic,a=i.pos;e=r.localBounds.translate(a).combine(e)}}catch(o){n.e(o)}finally{n.f()}return this.width=e.width,this.height=e.height,e}},{key:"localBounds",get:function(){var t,e=new dt,n=Object(f.a)(this.members);try{for(n.s();!(t=n.n()).done;){var i=t.value,r=i.graphic,a=i.pos;e=r.localBounds.translate(a).combine(e)}}catch(o){n.e(o)}finally{n.f()}return e}},{key:"_isAnimationOrGroup",value:function(t){return t instanceof Rr||t instanceof n}},{key:"tick",value:function(t,e){var n,i=Object(f.a)(this.members);try{for(i.s();!(n=i.n()).done;){var r=n.value.graphic;this._isAnimationOrGroup(r)&&r.tick(t,e)}}catch(a){i.e(a)}finally{i.f()}}},{key:"reset",value:function(){var t,e=Object(f.a)(this.members);try{for(e.s();!(t=e.n()).done;){var n=t.value.graphic;this._isAnimationOrGroup(n)&&n.reset()}}catch(i){e.e(i)}finally{e.f()}}},{key:"_preDraw",value:function(t,e,i){this._updateDimensions(),Object(s.a)(Object(l.a)(n.prototype),"_preDraw",this).call(this,t,e,i)}},{key:"_drawImage",value:function(t,e,n){var i,r=Object(f.a)(this.members);try{for(r.s();!(i=r.n()).done;){var a=i.value;t.save(),t.translate(e,n),a.graphic.draw(t,a.pos.x,a.pos.y),this.showDebug&&t.debug.drawRect(0,0,this.width,this.height),t.restore()}}catch(o){r.e(o)}finally{r.f()}}}]),n}(Dt);!function(t){t[t.Circle=0]="Circle",t[t.Rectangle=1]="Rectangle"}(Dr||(Dr={}));var Lr,Br=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t,i,r,a,o,s,l,u,c,h){return Object(g.a)(this,n),e.call(this,t,i,r,a,o,s,l,u,c,h)}return n}(Fe(function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t,i,r,a,o,s,l,u,c,h){var d;Object(g.a)(this,n),(d=e.call(this)).position=new ot(0,0),d.velocity=new ot(0,0),d.acceleration=new ot(0,0),d.particleRotationalVelocity=0,d.currentRotation=0,d.focus=null,d.focusAccel=0,d.opacity=1,d.beginColor=ut.White,d.endColor=ut.White,d.life=300,d.fadeFlag=!1,d._rRate=1,d._gRate=1,d._bRate=1,d._aRate=0,d._currentColor=ut.White,d.emitter=null,d.particleSize=5,d.particleSprite=null,d.sizeRate=0,d.elapsedMultiplier=0,d.visible=!0,d.isOffscreen=!1;var f=t;if(f&&!(t instanceof Fr)){var p=t;f=p.emitter,i=p.life,r=p.opacity,o=p.endColor,a=p.beginColor,s=p.position,l=p.velocity,u=p.acceleration,c=p.startSize,h=p.endSize}return d.emitter=f,d.life=i||d.life,d.opacity=r||d.opacity,d.endColor=o||d.endColor.clone(),d.beginColor=a||d.beginColor.clone(),d._currentColor=d.beginColor.clone(),d.position=(s||d.position).add(d.emitter.pos),d.velocity=l||d.velocity,d.acceleration=u||d.acceleration,d._rRate=(d.endColor.r-d.beginColor.r)/d.life,d._gRate=(d.endColor.g-d.beginColor.g)/d.life,d._bRate=(d.endColor.b-d.beginColor.b)/d.life,d._aRate=d.opacity/d.life,d.startSize=c||0,d.endSize=h||0,d.endSize>0&&d.startSize>0&&(d.sizeRate=(d.endSize-d.startSize)/d.life,d.particleSize=d.startSize),d.addComponent(d.transform=new Bn),d.addComponent(new vi((function(t){return d.draw(t)}))),d.addComponent(d.graphics=new _i),d.transform.pos=d.position,d.transform.rotation=d.currentRotation,d.transform.scale=st(1,1),d.particleSprite?(d.graphics.opacity=d.opacity,d.graphics.use(qe.fromLegacySprite(d.particleSprite))):d.graphics.onPostDraw=function(t){t.save(),d.graphics.opacity=d.opacity;var e=d._currentColor.clone();e.a=1,t.debug.drawPoint(st(0,0),{color:e,size:d.particleSize}),t.restore()},d}return Object(y.a)(n,[{key:"kill",value:function(){this.emitter.removeParticle(this)}},{key:"update",value:function(t,e){if(this.life=this.life-e,this.elapsedMultiplier=this.elapsedMultiplier+e,this.life<0&&this.kill(),this.fadeFlag&&(this.opacity=I(this._aRate*this.life,1e-4,1)),this.startSize>0&&this.endSize>0&&(this.particleSize=I(this.sizeRate*e+this.particleSize,Math.min(this.startSize,this.endSize),Math.max(this.startSize,this.endSize))),this._currentColor.r=I(this._currentColor.r+this._rRate*e,0,255),this._currentColor.g=I(this._currentColor.g+this._gRate*e,0,255),this._currentColor.b=I(this._currentColor.b+this._bRate*e,0,255),this._currentColor.a=I(this.opacity,1e-4,1),this.focus){var n=this.focus.sub(this.position).normalize().scale(this.focusAccel).scale(e/1e3);this.velocity=this.velocity.add(n)}else this.velocity=this.velocity.add(this.acceleration.scale(e/1e3));this.position=this.position.add(this.velocity.scale(e/1e3)),this.particleRotationalVelocity&&(this.currentRotation=(this.currentRotation+this.particleRotationalVelocity*e/1e3)%(2*Math.PI)),this.transform.pos=this.position,this.transform.rotation=this.currentRotation,this.transform.scale=st(1,1),this.graphics.opacity=this.opacity}},{key:"draw",value:function(t){if(this.particleSprite)return this.particleSprite.opacity(this.opacity),void this.particleSprite.draw(t,0,0);t.save(),this._currentColor.a=I(this.opacity,1e-4,1),t.fillStyle=this._currentColor.toString(),t.beginPath(),t.arc(0,0,this.particleSize,0,2*Math.PI),t.fill(),t.closePath(),t.restore()}}]),n}(pi))),Fr=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t){var i,r,a;Object(g.a)(this,n),(i=e.call(this,{width:null!==(r=t.width)&&void 0!==r?r:0,height:null!==(a=t.height)&&void 0!==a?a:0}))._particlesToEmit=0,i.numParticles=0,i.isEmitting=!0,i.particles=[],i.deadParticles=[],i.minVel=0,i.maxVel=0,i.acceleration=new ot(0,0),i.minAngle=0,i.maxAngle=0,i.emitRate=1,i.particleLife=2e3,i.fadeFlag=!1,i.focus=null,i.focusAccel=null,i.startSize=null,i.endSize=null,i.minSize=5,i.maxSize=5,i.beginColor=ut.White,i.endColor=ut.White,i._og=null,i._sprite=null,i.emitterType=Dr.Rectangle,i.radius=0,i.particleRotationalVelocity=0,i.randomRotation=!1;var o=Object.assign({},t),s=o.x,l=o.y,u=o.pos,c=o.isEmitting,h=o.minVel,d=o.maxVel,f=o.acceleration,p=o.minAngle,v=o.maxAngle,y=o.emitRate,m=o.particleLife,_=o.opacity,b=o.fadeFlag,w=o.focus,k=o.focusAccel,x=o.startSize,S=o.endSize,C=o.minSize,O=o.maxSize,E=o.beginColor,A=o.endColor,P=o.particleSprite,j=o.emitterType,T=o.radius,R=o.particleRotationalVelocity,M=o.randomRotation,L=o.random;i.pos=null!==u&&void 0!==u?u:st(null!==s&&void 0!==s?s:0,null!==l&&void 0!==l?l:0),i.isEmitting=null!==c&&void 0!==c?c:i.isEmitting,i.minVel=null!==h&&void 0!==h?h:i.minVel,i.maxVel=null!==d&&void 0!==d?d:i.maxVel,i.acceleration=null!==f&&void 0!==f?f:i.acceleration,i.minAngle=null!==p&&void 0!==p?p:i.minAngle,i.maxAngle=null!==v&&void 0!==v?v:i.maxAngle,i.emitRate=null!==y&&void 0!==y?y:i.emitRate,i.particleLife=null!==m&&void 0!==m?m:i.particleLife,i.opacity=null!==_&&void 0!==_?_:i.opacity,i.fadeFlag=null!==b&&void 0!==b?b:i.fadeFlag,i.focus=null!==w&&void 0!==w?w:i.focus,i.focusAccel=null!==k&&void 0!==k?k:i.focusAccel,i.startSize=null!==x&&void 0!==x?x:i.startSize,i.endSize=null!==S&&void 0!==S?S:i.endSize,i.minSize=null!==C&&void 0!==C?C:i.minSize,i.maxSize=null!==O&&void 0!==O?O:i.maxSize,i.beginColor=null!==E&&void 0!==E?E:i.beginColor,i.endColor=null!==A&&void 0!==A?A:i.endColor,i.particleSprite=null!==P&&void 0!==P?P:i.particleSprite,i.emitterType=null!==j&&void 0!==j?j:i.emitterType,i.radius=null!==T&&void 0!==T?T:i.radius,i.particleRotationalVelocity=null!==R&&void 0!==R?R:i.particleRotationalVelocity,i.randomRotation=null!==M&&void 0!==M?M:i.randomRotation,i.body.collisionType=_n.PreventCollision,i.random=null!==L&&void 0!==L?L:new D;for(var B=0;B<i.traits.length;B++)i.traits[B]instanceof li&&i.traits.splice(B,1);return i}return Object(y.a)(n,[{key:"opacity",get:function(){return Object(s.a)(Object(l.a)(n.prototype),"graphics",this).opacity},set:function(t){Object(s.a)(Object(l.a)(n.prototype),"graphics",this).opacity=t}},{key:"particleSprite",get:function(){return this._og},set:function(t){this._og=t,t&&(this._sprite=qe.fromLegacySprite(t))}},{key:"removeParticle",value:function(t){this.deadParticles.push(t)}},{key:"emitParticles",value:function(t){for(var e,n=0;n<t;n++){var i=this._createParticle();this.particles.push(i),(null===(e=null===this||void 0===this?void 0:this.scene)||void 0===e?void 0:e.world)&&this.scene.world.add(i)}}},{key:"clearParticles",value:function(){this.particles.length=0}},{key:"_createParticle",value:function(){var t=0,e=0,n=z(this.minAngle,this.maxAngle,this.random),i=z(this.minVel,this.maxVel,this.random),r=this.startSize||z(this.minSize,this.maxSize,this.random),a=i*Math.cos(n),o=i*Math.sin(n);if(this.emitterType===Dr.Rectangle)t=z(0,this.width,this.random),e=z(0,this.height,this.random);else if(this.emitterType===Dr.Circle){var s=z(0,this.radius,this.random);t=s*Math.cos(n),e=s*Math.sin(n)}var l=new Br(this,this.particleLife,this.opacity,this.beginColor,this.endColor,new ot(t,e),new ot(a,o),this.acceleration,this.startSize,this.endSize);return l.fadeFlag=this.fadeFlag,l.particleSize=r,this.particleSprite&&(l.particleSprite=this.particleSprite,l.graphics.opacity=this.opacity,l.graphics.use(this._sprite)),l.particleRotationalVelocity=this.particleRotationalVelocity,this.randomRotation&&(l.currentRotation=z(0,2*Math.PI,this.random)),this.focus&&(l.focus=this.focus.add(new ot(this.pos.x,this.pos.y)),l.focusAccel=this.focusAccel),l}},{key:"update",value:function(t,e){var i;Object(s.a)(Object(l.a)(n.prototype),"update",this).call(this,t,e),this.isEmitting&&(this._particlesToEmit+=this.emitRate*(e/1e3),this._particlesToEmit>1&&(this.emitParticles(Math.floor(this._particlesToEmit)),this._particlesToEmit=this._particlesToEmit-Math.floor(this._particlesToEmit)));for(var r=0;r<this.deadParticles.length;r++)X(this.deadParticles[r],this.particles),(null===(i=null===this||void 0===this?void 0:this.scene)||void 0===i?void 0:i.world)&&this.scene.world.remove(this.deadParticles[r],!1);this.deadParticles.length=0}},{key:"draw",value:function(t){this.particles.forEach((function(e){return e.draw(t)}))}},{key:"debugDraw",value:function(t){Object(s.a)(Object(l.a)(n.prototype),"debugDraw",this).call(this,t),t.fillStyle=ut.Black.toString(),t.fillText("Particles: "+this.particles.length,this.pos.x,this.pos.y+20),this.focus&&(t.fillRect(this.focus.x+this.pos.x,this.focus.y+this.pos.y,3,3),pn(t,ut.Yellow,this.focus.x+this.pos.x,this.focus.y+this.pos.y,this.center.x,this.center.y),t.fillText("Focus",this.focus.x+this.pos.x,this.focus.y+this.pos.y))}}]),n}(Gi),Ir=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(){var t;return Object(g.a)(this,n),(t=e.apply(this,arguments)).types=["ex.transform","ex.graphics"],t.systemType=ur.Draw,t.priority=0,t._token=0,t}return Object(y.a)(n,[{key:"initialize",value:function(t){this._graphicsContext=t.engine.graphicsContext,this._camera=t.camera,this._engine=t.engine}},{key:"sort",value:function(t,e){return t.get(Bn).z-e.get(Bn).z}},{key:"update",value:function(t,e){var n,i;this._clearScreen(),this._token++;var r,a=Object(f.a)(t);try{for(a.s();!(r=a.n()).done;){var o=r.value;n=o.get(Bn),i=o.get(_i);var s=this._isOffscreen(n,i);if(s&&!o.hasTag("offscreen")&&(o.eventDispatcher.emit("exitviewport",new _e(o)),o.addComponent(new Dn("offscreen"))),!s&&o.hasTag("offscreen")&&(o.eventDispatcher.emit("enterviewport",new be(o)),o.removeComponent("offscreen")),!s){this._pushCameraTransform(n),this._graphicsContext.save(),i.update(e,this._token),this._applyTransform(o),i.onPreDraw&&i.onPreDraw(this._graphicsContext,e);var l=o instanceof Br?o.opacity:1;this._graphicsContext.opacity=i.opacity*l,this._drawGraphicsComponent(i),i.onPostDraw&&i.onPostDraw(this._graphicsContext,e),this._graphicsContext.restore(),this._popCameraTransform(n)}}}catch(u){a.e(u)}finally{a.f()}this._graphicsContext.flush(),this._engine.stats.currFrame.graphics.drawnImages=_t.DrawnImagesCount,this._engine.stats.currFrame.graphics.drawCalls=_t.DrawCallCount}},{key:"_clearScreen",value:function(){this._graphicsContext.clear()}},{key:"_isOffscreen",value:function(t,e){return t.coordPlane===Tn.World&&!this._camera.viewport.intersect(e.localBounds.transform(t.getGlobalMatrix()))}},{key:"_drawGraphicsComponent",value:function(t){var e,n;if(t.visible){var i,r=Object(f.a)(t.layers.get());try{for(r.s();!(i=r.n()).done;){var a,o=i.value,s=Object(f.a)(o.graphics);try{for(s.s();!(a=s.n()).done;){var l=a.value,u=l.graphic,c=l.options,h=t.anchor,d=t.offset;(null===c||void 0===c?void 0:c.anchor)&&(h=c.anchor),(null===c||void 0===c?void 0:c.offset)&&(d=c.offset);var p=-u.width*h.x+d.x,v=-u.height*h.y+d.y;if(null===u||void 0===u||u.draw(this._graphicsContext,p+o.offset.x,v+o.offset.y),(null===(e=this._engine)||void 0===e?void 0:e.isDebug)&&this._engine.debug.graphics.showBounds){var g=st(p+o.offset.x,v+o.offset.y);if(u instanceof Mr){var y,m=Object(f.a)(u.members);try{for(m.s();!(y=m.n()).done;){var _=y.value;null===(n=_.graphic)||void 0===n||n.localBounds.translate(g.add(_.pos)).draw(this._graphicsContext,this._engine.debug.graphics.boundsColor)}}catch(b){m.e(b)}finally{m.f()}}else null===u||void 0===u||u.localBounds.translate(g).draw(this._graphicsContext,this._engine.debug.graphics.boundsColor)}}}catch(b){s.e(b)}finally{s.f()}}}catch(b){r.e(b)}finally{r.f()}}}},{key:"_applyTransform",value:function(t){var e,n=t.getAncestors(),i=Object(f.a)(n);try{for(i.s();!(e=i.n()).done;){var r=e.value,a=null===r||void 0===r?void 0:r.get(Bn);a&&(this._graphicsContext.translate(a.pos.x,a.pos.y),this._graphicsContext.scale(a.scale.x,a.scale.y),this._graphicsContext.rotate(a.rotation))}}catch(o){i.e(o)}finally{i.f()}}},{key:"_pushCameraTransform",value:function(t){t.coordPlane===Tn.World&&(this._graphicsContext.save(),this._camera&&this._camera.draw(this._graphicsContext))}},{key:"_popCameraTransform",value:function(t){t.coordPlane===Tn.World&&this._graphicsContext.restore()}}]),n}(dr),zr=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(){var t;return Object(g.a)(this,n),(t=e.apply(this,arguments)).types=["ex.transform","ex.canvas"],t.systemType=ur.Draw,t.priority=-1,t}return Object(y.a)(n,[{key:"initialize",value:function(t){this._ctx=t.engine.ctx,this._engine=t.engine,this._camera=t.camera}},{key:"sort",value:function(t,e){return t.get(Bn).z-e.get(Bn).z}},{key:"update",value:function(t,e){var n,i,r,a,o;this._clearScreen();for(var s=t.length,l=0;l<s;l++){var u=null===(r=null===(i=null===(n=t[l])||void 0===n?void 0:n.graphics)||void 0===i?void 0:i.visible)||void 0===r||r,c=t[l].isOffScreen;u&&!c&&(a=t[l].get(Bn),o=t[l].get(vi),this._ctx.save(),this._pushCameraTransform(a),this._ctx.save(),this._applyTransform(t[l]),o.draw(this._ctx,e),this._ctx.restore(),this._popCameraTransform(a),this._ctx.restore()),this._engine.isDebug&&(this._ctx.save(),this._pushCameraTransform(a),this._ctx.strokeStyle="yellow",t[l].debugDraw(this._ctx),this._popCameraTransform(a),this._ctx.restore())}this._engine.isDebug&&(this._ctx.save(),this._camera.draw(this._ctx),this._camera.debugDraw(this._ctx),this._ctx.restore()),this._engine.stats.currFrame.graphics.drawnImages=_t.DrawnImagesCount,this._engine.stats.currFrame.graphics.drawCalls=_t.DrawCallCount}},{key:"_applyTransform",value:function(t){var e,n=t.getAncestors(),i=Object(f.a)(n);try{for(i.s();!(e=i.n()).done;){var r=e.value,a=null===r||void 0===r?void 0:r.get(Bn);a&&(this._ctx.translate(a.pos.x,a.pos.y),this._ctx.rotate(a.rotation),this._ctx.scale(a.scale.x,a.scale.y))}}catch(o){i.e(o)}finally{i.f()}}},{key:"_clearScreen",value:function(){this._ctx.clearRect(0,0,this._ctx.canvas.width,this._ctx.canvas.height),this._ctx.fillStyle=this._engine.backgroundColor.toString(),this._ctx.fillRect(0,0,this._ctx.canvas.width,this._ctx.canvas.height)}},{key:"_pushCameraTransform",value:function(t){t.coordPlane===Tn.World&&(this._ctx.save(),this._camera&&this._camera.draw(this._ctx))}},{key:"_popCameraTransform",value:function(t){t.coordPlane===Tn.World&&this._ctx.restore()}}]),n}(dr),Nr=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(){var t;return Object(g.a)(this,n),(t=e.apply(this,arguments)).types=["ex.transform"],t.systemType=ur.Draw,t.priority=999,t}return Object(y.a)(n,[{key:"initialize",value:function(t){this._graphicsContext=t.engine.graphicsContext,this._camera=t.camera,this._engine=t.engine,this._collisionSystem=t.world.systemManager.get(Tr)}},{key:"update",value:function(t,e){var n,i;if(this._engine.isDebug){var r,o,s,l,u,c,h,d,p=this._engine.debug.filter,v=this._engine.debug.entity,g=this._engine.debug.transform,y=this._engine.debug.motion,m=this._engine.debug.collider,_=this._engine.debug.physics,b=this._engine.debug.graphics,w=this._engine.debug.body,k=this._engine.debug.camera,x=Object(f.a)(t);try{for(x.s();!(d=x.n()).done;){var S=d.value;if(!S.hasTag("offscreen")&&!(S instanceof Br)){if(p.useFilter){if(!(0===p.ids.length||p.ids.includes(S.id)))continue;if(!(""===p.nameQuery||S.name.includes(p.nameQuery)))continue}var C=ot.Zero,O=st(0,16);if(r=S.id,o=S.name,s=S.get(Bn),this._pushCameraTransform(s),this._graphicsContext.save(),this._applyTransform(S),s&&((g.showAll||g.showPosition)&&(this._graphicsContext.debug.drawPoint(ot.Zero,{size:2,color:g.positionColor}),this._graphicsContext.debug.drawText("pos".concat(s.pos.toString(2)),C),C=C.add(O)),(v.showAll||v.showId)&&(this._graphicsContext.debug.drawText("id(".concat(r,") ").concat(s.parent?"child of id("+(null===(i=null===(n=s.parent)||void 0===n?void 0:n.owner)||void 0===i?void 0:i.id)+")":""),C),C=C.add(O)),(v.showAll||v.showName)&&(this._graphicsContext.debug.drawText("name(".concat(o,")"),C),C=C.add(O)),(g.showAll||g.showRotation)&&(this._graphicsContext.drawLine(ot.Zero,ot.fromAngle(s.rotation).scale(50).add(ot.Zero),g.rotationColor,2),this._graphicsContext.debug.drawText("rot deg(".concat(H(s.rotation).toFixed(2),")"),C),C=C.add(O)),(g.showAll||g.showScale)&&this._graphicsContext.drawLine(ot.Zero,s.scale.add(ot.Zero),g.scaleColor,2)),c=S.get(_i))if(b.showAll||b.showBounds)c.localBounds.draw(this._graphicsContext,b.boundsColor);if((h=S.get(oi))&&((w.showAll||w.showCollisionGroup)&&(this._graphicsContext.debug.drawText("collision group(".concat(h.group.name,")"),C),C=C.add(O)),(w.showAll||w.showCollisionType)&&(this._graphicsContext.debug.drawText("collision type(".concat(h.collisionType,")"),C),C=C.add(O)),(w.showAll||w.showMass)&&(this._graphicsContext.debug.drawText("mass(".concat(h.mass,")"),C),C=C.add(O)),(w.showAll||w.showMotion)&&(this._graphicsContext.debug.drawText("motion(".concat(h.sleepMotion,")"),C),C=C.add(O)),(w.showAll||w.showSleeping)&&(this._graphicsContext.debug.drawText("sleeping(".concat(h.canSleep?h.sleeping:"cant sleep",")"),C),C=C.add(O))),this._graphicsContext.restore(),(l=S.get(Fn))&&((y.showAll||y.showVelocity)&&(this._graphicsContext.debug.drawText("vel".concat(l.vel.toString(2)),C.add(s.globalPos)),this._graphicsContext.drawLine(s.globalPos,s.globalPos.add(l.vel),y.velocityColor,2),C=C.add(O)),(y.showAll||y.showAcceleration)&&this._graphicsContext.drawLine(s.globalPos,s.globalPos.add(l.acc),y.accelerationColor,2)),u=S.get(ai)){var E=u.get();if((m.showAll||m.showGeometry)&&E&&E.debug(this._graphicsContext,m.geometryColor),m.showAll||m.showBounds)if(E instanceof qn){var A,P=E.getColliders(),j=Object(f.a)(P);try{for(j.s();!(A=j.n()).done;){var T=A.value,R=T.bounds,D=st(R.left,R.top);this._graphicsContext.debug.drawRect(D.x,D.y,R.width,R.height,{color:m.boundsColor}),(m.showAll||m.showOwner)&&this._graphicsContext.debug.drawText("owner id(".concat(T.owner.id,")"),D)}}catch(q){j.e(q)}finally{j.f()}u.bounds.draw(this._graphicsContext,m.boundsColor)}else if(E){var M=u.bounds,L=st(M.left,M.top);this._graphicsContext.debug.drawRect(L.x,L.y,M.width,M.height,{color:m.boundsColor}),(m.showAll||m.showOwner)&&this._graphicsContext.debug.drawText("owner id(".concat(u.owner.id,")"),L)}}this._popCameraTransform(s)}}}catch(q){x.e(q)}finally{x.f()}if(this._graphicsContext.save(),this._camera.draw(this._graphicsContext),(_.showAll||_.showBroadphaseSpacePartitionDebug)&&this._collisionSystem.debug(this._graphicsContext),_.showAll||_.showCollisionContacts||_.showCollisionNormals){var B,F=Object(f.a)(this._engine.debug.stats.currFrame.physics.contacts);try{for(F.s();!(B=F.n()).done;){var I=a(B.value,2),z=(I[0],I[1]);if(_.showAll||_.showCollisionContacts){var N,U=Object(f.a)(z.points);try{for(U.s();!(N=U.n()).done;){var W=N.value;this._graphicsContext.debug.drawPoint(W,{size:5,color:_.collisionContactColor})}}catch(q){U.e(q)}finally{U.f()}}if(_.showAll||_.showCollisionNormals){var V,G=Object(f.a)(z.points);try{for(G.s();!(V=G.n()).done;){var X=V.value;this._graphicsContext.debug.drawLine(X,z.normal.scale(30).add(X),{color:_.collisionNormalColor})}}catch(q){G.e(q)}finally{G.f()}}}}catch(q){F.e(q)}finally{F.f()}}this._graphicsContext.restore(),k&&(this._graphicsContext.save(),this._camera.draw(this._graphicsContext),(k.showAll||k.showFocus)&&this._graphicsContext.drawCircle(this._camera.pos,4,k.focusColor),(k.showAll||k.showZoom)&&this._graphicsContext.debug.drawText("zoom(".concat(this._camera.zoom,")"),this._camera.pos),this._graphicsContext.restore()),this._graphicsContext.flush()}}},{key:"_applyTransform",value:function(t){var e,n=t.getAncestors(),i=Object(f.a)(n);try{for(i.s();!(e=i.n()).done;){var r=e.value,a=null===r||void 0===r?void 0:r.get(Bn);a&&(this._graphicsContext.translate(a.pos.x,a.pos.y),this._graphicsContext.scale(a.scale.x,a.scale.y),this._graphicsContext.rotate(a.rotation))}}catch(o){i.e(o)}finally{i.f()}}},{key:"_pushCameraTransform",value:function(t){t.coordPlane===Tn.World&&(this._graphicsContext.save(),this._camera&&this._camera.draw(this._graphicsContext))}},{key:"_popCameraTransform",value:function(t){t.coordPlane===Tn.World&&this._graphicsContext.restore()}}]),n}(dr),Ur=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(){var t;return Object(g.a)(this,n),(t=e.apply(this,arguments)).types=["ex.actions"],t.systemType=ur.Update,t.priority=-1,t}return Object(y.a)(n,[{key:"update",value:function(t,e){var n,i=Object(f.a)(t);try{for(i.s();!(n=i.n()).done;){n.value.get(Wi).update(e)}}catch(r){i.e(r)}finally{i.f()}}}]),n}(dr),Hr=function(t,e,n,i){var r,a=arguments.length,o=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,n,o):r(e,n))||o);return a>3&&o&&Object.defineProperty(e,n,o),o},Wr=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(){var t;return Object(g.a)(this,n),(t=e.call(this))._logger=A.getInstance(),t.camera=new sr,t.world=new Sr(Object(o.a)(t)),t._isInitialized=!1,t._timers=[],t._cancelQueue=[],t.world.add(new Ur),t.world.add(new Or),t.world.add(new Tr),O.isEnabled(k.LegacyDrawing)?t.world.add(new zr):t.world.add(new Ir),t.world.add(new Nr),t}return Object(y.a)(n,[{key:"actors",get:function(){return this.world.entityManager.entities.filter((function(t){return t instanceof Gi}))}},{key:"entities",get:function(){return this.world.entityManager.entities}},{key:"triggers",get:function(){return this.world.entityManager.entities.filter((function(t){return t instanceof hr}))}},{key:"tileMaps",get:function(){return this.world.entityManager.entities.filter((function(t){return t instanceof Yi}))}},{key:"screenElements",get:function(){return this.actors.filter((function(t){return t instanceof Xi}))}},{key:"on",value:function(t,e){Object(s.a)(Object(l.a)(n.prototype),"on",this).call(this,t,e)}},{key:"once",value:function(t,e){Object(s.a)(Object(l.a)(n.prototype),"once",this).call(this,t,e)}},{key:"off",value:function(t,e){Object(s.a)(Object(l.a)(n.prototype),"off",this).call(this,t,e)}},{key:"onInitialize",value:function(t){}},{key:"onActivate",value:function(t,e){}},{key:"onDeactivate",value:function(t,e){}},{key:"onPreUpdate",value:function(t,e){}},{key:"onPostUpdate",value:function(t,e){}},{key:"onPreDraw",value:function(t,e){}},{key:"onPostDraw",value:function(t,e){}},{key:"_initializeChildren",value:function(){var t,e=Object(f.a)(this.entities);try{for(e.s();!(t=e.n()).done;){t.value._initialize(this.engine)}}catch(n){e.e(n)}finally{e.f()}}},{key:"isInitialized",get:function(){return this._isInitialized}},{key:"_initialize",value:function(t){this.isInitialized||(this.engine=t,this.camera._initialize(t),this.onInitialize.call(this,t),this._initializeChildren(),this._logger.debug("Scene.onInitialize",this,t),this.eventDispatcher.emit("initialize",new ge(t,this)),this._isInitialized=!0)}},{key:"_activate",value:function(t,e){this._logger.debug("Scene.onActivate",this),this.onActivate(t,e)}},{key:"_deactivate",value:function(t,e){this._logger.debug("Scene.onDeactivate",this),this.onDeactivate(t,e)}},{key:"_preupdate",value:function(t,e){this.emit("preupdate",new Qt(t,e,this)),this.onPreUpdate(t,e)}},{key:"_postupdate",value:function(t,e){this.emit("postupdate",new Yt(t,e,this)),this.onPostUpdate(t,e)}},{key:"_predraw",value:function(t,e){this.emit("predraw",new Xt(t,e,this)),this.onPreDraw(t,e)}},{key:"_postdraw",value:function(t,e){this.emit("postdraw",new qt(t,e,this)),this.onPostDraw(t,e)}},{key:"update",value:function(t,e){var n,i;for(this._preupdate(t,e),this.camera&&this.camera.update(t,e),n=0,i=this._cancelQueue.length;n<i;n++)this.removeTimer(this._cancelQueue[n]);this._cancelQueue.length=0;var r,a=Object(f.a)(this._timers);try{for(a.s();!(r=a.n()).done;){r.value.update(e)}}catch(o){a.e(o)}finally{a.f()}this.world.update(ur.Update,e),this._collectActorStats(t),t.input.pointers.dispatchPointerEvents(),this._postupdate(t,e)}},{key:"draw",value:function(t,e){var n;this._predraw(t,e),this.world.update(ur.Draw,e),(null===(n=this.engine)||void 0===n?void 0:n.isDebug)&&this.debugDraw(t),this._postdraw(t,e)}},{key:"debugDraw",value:function(t){this.emit("predebugdraw",new Kt(t,this)),this.emit("postdebugdraw",new Zt(t,this))}},{key:"contains",value:function(t){return this.actors.indexOf(t)>-1}},{key:"add",value:function(t){this.emit("entityadded",{target:t}),this.world.add(t),t.scene=this,t instanceof Ki&&(q(this._timers,t)||this.addTimer(t))}},{key:"remove",value:function(t){t instanceof pi&&(this.emit("entityremoved",{target:t}),this.world.remove(t)),t instanceof Ki&&this.removeTimer(t)}},{key:"addScreenElement",value:function(t){this.add(t)}},{key:"removeScreenElement",value:function(t){this.remove(t)}},{key:"addTileMap",value:function(t){this.world.add(t)}},{key:"removeTileMap",value:function(t){this.world.remove(t)}},{key:"addTimer",value:function(t){return this._timers.push(t),t.scene=this,t}},{key:"removeTimer",value:function(t){var e=this._timers.indexOf(t);return-1!==e&&this._timers.splice(e,1),t}},{key:"cancelTimer",value:function(t){return this._cancelQueue.push(t),t}},{key:"isTimerActive",value:function(t){return this._timers.indexOf(t)>-1&&!t.complete}},{key:"isCurrentScene",value:function(){return!!this.engine&&this.engine.currentScene===this}},{key:"_collectActorStats",value:function(t){var e,n=this.actors.filter((function(t){return t instanceof Xi})),i=Object(f.a)(n);try{for(i.s();!(e=i.n()).done;){e.value;t.stats.currFrame.actors.ui++}}catch(u){i.e(u)}finally{i.f()}var r,a=Object(f.a)(this.actors);try{for(a.s();!(r=a.n()).done;){var o=r.value;t.stats.currFrame.actors.alive++;var s,l=Object(f.a)(o.children);try{for(l.s();!(s=l.n()).done;){lr(s.value)?t.stats.currFrame.actors.ui++:t.stats.currFrame.actors.alive++}}catch(u){l.e(u)}finally{l.f()}}}catch(u){a.e(u)}finally{a.f()}}}]),n}(fn);Hr([rt({message:"Will be removed in excalibur v0.26.0",alternateMethod:"ScreenElements now are normal actors with a Transform Coordinate Plane of Screen"})],Wr.prototype,"screenElements",null),Hr([rt({message:"Will be removed in excalibur v0.26.0",alternateMethod:"Use Scene.add"})],Wr.prototype,"addScreenElement",null),Hr([rt({message:"Will be removed in excalibur v0.26.0",alternateMethod:"Use Scene.remove"})],Wr.prototype,"removeScreenElement",null),Hr([rt({message:"Will be removed in excalibur v0.26.0",alternateMethod:"Use Scene.add"})],Wr.prototype,"addTileMap",null),Hr([rt({message:"Will be removed in excalibur v0.26.0",alternateMethod:"Use Scene.remove"})],Wr.prototype,"removeTileMap",null),function(t){t[t.Protanope=0]="Protanope",t[t.Deuteranope=1]="Deuteranope",t[t.Tritanope=2]="Tritanope"}(Lr||(Lr={}));var Vr,Gr,Xr=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Lr.Protanope;Object(g.a)(this,t),this.engine=e,this.simulate=n,this.colorMode=i,this._vertexShader="attribute vec2 a_position;attribute vec2 a_texCoord;uniform vec2 u_resolution;varying vec2 v_texCoord;void main() {vec2 zeroToOne = a_position / u_resolution;vec2 zeroToTwo = zeroToOne * 2.0;vec2 clipSpace = zeroToTwo - 1.0;gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);v_texCoord = a_texCoord;}",this._fragmentShader="precision mediump float;uniform sampler2D u_image;varying vec2 v_texCoord;void main() {vec4 o =  texture2D(u_image, v_texCoord);float L = (17.8824 * o.r) + (43.5161 * o.g) + (4.11935 * o.b);float M = (3.45565 * o.r) + (27.1554 * o.g) + (3.86714 * o.b);float S = (0.0299566 * o.r) + (0.184309 * o.g) + (1.46709 * o.b);//MODE CODE//vec4 error;error.r = (0.0809444479 * l) + (-0.130504409 * m) + (0.116721066 * s);error.g = (-0.0102485335 * l) + (0.0540193266 * m) + (-0.113614708 * s);error.b = (-0.000365296938 * l) + (-0.00412161469 * m) + (0.693511405 * s);error.a = 1.0;vec4 diff = o - error;vec4 correction;correction.r = 0.0;correction.g =  (diff.r * 0.7) + (diff.g * 1.0);correction.b =  (diff.r * 0.7) + (diff.b * 1.0);correction = o + correction;correction.a = o.a;//SIMULATE//}",this._internalCanvas=document.createElement("canvas"),this._internalCanvas.width=e.drawWidth,this._internalCanvas.height=e.drawHeight,this._gl=this._internalCanvas.getContext("webgl",{preserveDrawingBuffer:!0}),this._program=this._gl.createProgram();var r=this._getShader("Fragment",this._getFragmentShaderByMode(i)),a=this._getShader("Vertex",this._vertexShader);this._gl.attachShader(this._program,a),this._gl.attachShader(this._program,r),this._gl.linkProgram(this._program),this._gl.getProgramParameter(this._program,this._gl.LINK_STATUS)||A.getInstance().error("Unable to link shader program!"),this._gl.useProgram(this._program)}return Object(y.a)(t,[{key:"_getFragmentShaderByMode",value:function(t){var e="";return t===Lr.Protanope?e="float l = 0.0 * L + 2.02344 * M + -2.52581 * S;float m = 0.0 * L + 1.0 * M + 0.0 * S;float s = 0.0 * L + 0.0 * M + 1.0 * S;":t===Lr.Deuteranope?e="float l = 1.0 * L + 0.0 * M + 0.0 * S;float m = 0.494207 * L + 0.0 * M + 1.24827 * S;float s = 0.0 * L + 0.0 * M + 1.0 * S;":t===Lr.Tritanope&&(e="float l = 1.0 * L + 0.0 * M + 0.0 * S;float m = 0.0 * L + 1.0 * M + 0.0 * S;float s = -0.395913 * L + 0.801109 * M + 0.0 * S;"),this.simulate?this._fragmentShader=this._fragmentShader.replace("//SIMULATE//","gl_FragColor = error.rgba;"):this._fragmentShader=this._fragmentShader.replace("//SIMULATE//","gl_FragColor = correction.rgba;"),this._fragmentShader.replace("//MODE CODE//",e)}},{key:"_setRectangle",value:function(t,e,n,i){var r=t,a=t+n,o=e,s=e+i;this._gl.bufferData(this._gl.ARRAY_BUFFER,new Float32Array([r,o,a,o,r,s,r,s,a,o,a,s]),this._gl.STATIC_DRAW)}},{key:"_getShader",value:function(t,e){var n;return"Fragment"===t?n=this._gl.createShader(this._gl.FRAGMENT_SHADER):"Vertex"===t?n=this._gl.createShader(this._gl.VERTEX_SHADER):A.getInstance().error("Error unknown shader type",t),this._gl.shaderSource(n,e),this._gl.compileShader(n),this._gl.getShaderParameter(n,this._gl.COMPILE_STATUS)?n:(A.getInstance().error("Unable to compile shader!",this._gl.getShaderInfoLog(n)),null)}},{key:"process",value:function(t,e){var n=this._gl.getAttribLocation(this._program,"a_position"),i=this._gl.getAttribLocation(this._program,"a_texCoord"),r=this._gl.createBuffer();this._gl.bindBuffer(this._gl.ARRAY_BUFFER,r),this._gl.bufferData(this._gl.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),this._gl.STATIC_DRAW),this._gl.enableVertexAttribArray(i),this._gl.vertexAttribPointer(i,2,this._gl.FLOAT,!1,0,0);var a=this._gl.createTexture();this._gl.bindTexture(this._gl.TEXTURE_2D,a),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,this._gl.NEAREST),this._gl.pixelStorei(this._gl.UNPACK_FLIP_Y_WEBGL,1),this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.RGBA,this._gl.RGBA,this._gl.UNSIGNED_BYTE,t);var o=this._gl.getUniformLocation(this._program,"u_resolution");this._gl.uniform2f(o,this._internalCanvas.width,this._internalCanvas.height);var s=this._gl.createBuffer();this._gl.bindBuffer(this._gl.ARRAY_BUFFER,s),this._gl.enableVertexAttribArray(n),this._gl.vertexAttribPointer(n,2,this._gl.FLOAT,!1,0,0),this._setRectangle(0,0,t.width,t.height),this._gl.drawArrays(this._gl.TRIANGLES,0,6);var l=new Uint8Array(t.width*t.height*4);this._gl.readPixels(0,0,t.width,t.height,this._gl.RGBA,this._gl.UNSIGNED_BYTE,l),t.data.set(l),e.putImageData(t,0,0)}}]),t}(),qr=function(){function t(e){Object(g.a)(this,t),this._engine=e}return Object(y.a)(t,[{key:"correct",value:function(t){this._engine.postProcessors.push(new Xr(this._engine,!1,t))}},{key:"simulate",value:function(t){this._engine.postProcessors.push(new Xr(this._engine,!0,t))}}]),t}(),Kr=function t(e){Object(g.a)(this,t),this.stats={currFrame:new Zr,prevFrame:new Zr},this.filter={useFilter:!1,nameQuery:"",ids:[]},this.entity={showAll:!1,showId:!0,showName:!1},this.transform={showAll:!1,showPosition:!1,positionColor:ut.Yellow,showScale:!1,scaleColor:ut.Green,showRotation:!1,rotationColor:ut.Blue},this.graphics={showAll:!1,showBounds:!0,boundsColor:ut.Yellow},this.collider={showAll:!1,showBounds:!0,boundsColor:ut.Blue,showOwner:!1,showGeometry:!0,geometryColor:ut.Green},this.physics={showAll:!1,showBroadphaseSpacePartitionDebug:!1,showCollisionNormals:!1,collisionNormalColor:ut.Cyan,showCollisionContacts:!0,collisionContactColor:ut.Red},this.motion={showAll:!1,showVelocity:!1,velocityColor:ut.Yellow,showAcceleration:!1,accelerationColor:ut.Red},this.body={showAll:!1,showCollisionGroup:!1,showCollisionType:!1,showSleeping:!1,showMotion:!1,showMass:!1},this.camera={showAll:!1,showFocus:!1,focusColor:ut.Red,showZoom:!1},this._engine=e,this.colorBlindMode=new qr(this._engine)},Zr=function(){function t(){Object(g.a)(this,t),this._id=0,this._delta=0,this._fps=0,this._actorStats={alive:0,killed:0,ui:0,get remaining(){return this.alive-this.killed},get total(){return this.remaining+this.ui}},this._durationStats={update:0,draw:0,get total(){return this.update+this.draw}},this._physicsStats=new Qr,this._graphicsStats={drawCalls:0,drawnImages:0}}return Object(y.a)(t,[{key:"reset",value:function(t){t?(this.id=t.id,this.delta=t.delta,this.fps=t.fps,this.actors.alive=t.actors.alive,this.actors.killed=t.actors.killed,this.actors.ui=t.actors.ui,this.duration.update=t.duration.update,this.duration.draw=t.duration.draw,this._physicsStats.reset(t.physics),this.graphics.drawCalls=t.graphics.drawCalls,this.graphics.drawnImages=t.graphics.drawnImages):(this.id=this.delta=this.fps=0,this.actors.alive=this.actors.killed=this.actors.ui=0,this.duration.update=this.duration.draw=0,this._physicsStats.reset(),this.graphics.drawnImages=this.graphics.drawCalls=0)}},{key:"clone",value:function(){var e=new t;return e.reset(this),e}},{key:"id",get:function(){return this._id},set:function(t){this._id=t}},{key:"delta",get:function(){return this._delta},set:function(t){this._delta=t}},{key:"fps",get:function(){return this._fps},set:function(t){this._fps=t}},{key:"actors",get:function(){return this._actorStats}},{key:"duration",get:function(){return this._durationStats}},{key:"physics",get:function(){return this._physicsStats}},{key:"graphics",get:function(){return this._graphicsStats}}]),t}(),Qr=function(){function t(){Object(g.a)(this,t),this._pairs=0,this._collisions=0,this._contacts=new Map,this._fastBodies=0,this._fastBodyCollisions=0,this._broadphase=0,this._narrowphase=0}return Object(y.a)(t,[{key:"reset",value:function(t){t?(this.pairs=t.pairs,this.collisions=t.collisions,this.contacts=t.contacts,this.fastBodies=t.fastBodies,this.fastBodyCollisions=t.fastBodyCollisions,this.broadphase=t.broadphase,this.narrowphase=t.narrowphase):(this.pairs=this.collisions=this.fastBodies=0,this.fastBodyCollisions=this.broadphase=this.narrowphase=0,this.contacts.clear())}},{key:"clone",value:function(){var e=new t;return e.reset(this),e}},{key:"pairs",get:function(){return this._pairs},set:function(t){this._pairs=t}},{key:"collisions",get:function(){return this._collisions},set:function(t){this._collisions=t}},{key:"contacts",get:function(){return this._contacts},set:function(t){this._contacts=t}},{key:"fastBodies",get:function(){return this._fastBodies},set:function(t){this._fastBodies=t}},{key:"fastBodyCollisions",get:function(){return this._fastBodyCollisions},set:function(t){this._fastBodyCollisions=t}},{key:"broadphase",get:function(){return this._broadphase},set:function(t){this._broadphase=t}},{key:"narrowphase",get:function(){return this._narrowphase},set:function(t){this._narrowphase=t}}]),t}();(Gr=Vr||(Vr={})).Num0="Numpad0",Gr.Num1="Numpad1",Gr.Num2="Numpad2",Gr.Num3="Numpad3",Gr.Num4="Numpad4",Gr.Num5="Numpad5",Gr.Num6="Numpad6",Gr.Num7="Numpad7",Gr.Num8="Numpad8",Gr.Num9="Numpad9",Gr.NumAdd="NumpadAdd",Gr.NumSubtract="NumpadSubtract",Gr.NumMultiply="NumpadMultiply",Gr.NumDivide="NumpadDivide",Gr.NumDecimal="NumpadDecimal",Gr.Numpad0="Numpad0",Gr.Numpad1="Numpad1",Gr.Numpad2="Numpad2",Gr.Numpad3="Numpad3",Gr.Numpad4="Numpad4",Gr.Numpad5="Numpad5",Gr.Numpad6="Numpad6",Gr.Numpad7="Numpad7",Gr.Numpad8="Numpad8",Gr.Numpad9="Numpad9",Gr.NumpadAdd="NumpadAdd",Gr.NumpadSubtract="NumpadSubtract",Gr.NumpadMultiply="NumpadMultiply",Gr.NumpadDivide="NumpadDivide",Gr.NumpadDecimal="NumpadDecimal",Gr.NumLock="NumLock",Gr.ShiftLeft="ShiftLeft",Gr.ShiftRight="ShiftRight",Gr.AltLeft="AltLeft",Gr.AltRight="AltRight",Gr.Key0="Digit0",Gr.Key1="Digit1",Gr.Key2="Digit2",Gr.Key3="Digit3",Gr.Key4="Digit4",Gr.Key5="Digit5",Gr.Key6="Digit6",Gr.Key7="Digit7",Gr.Key8="Digit8",Gr.Key9="Digit9",Gr.Digit0="Digit0",Gr.Digit1="Digit1",Gr.Digit2="Digit2",Gr.Digit3="Digit3",Gr.Digit4="Digit4",Gr.Digit5="Digit5",Gr.Digit6="Digit6",Gr.Digit7="Digit7",Gr.Digit8="Digit8",Gr.Digit9="Digit9",Gr.A="KeyA",Gr.B="KeyB",Gr.C="KeyC",Gr.D="KeyD",Gr.E="KeyE",Gr.F="KeyF",Gr.G="KeyG",Gr.H="KeyH",Gr.I="KeyI",Gr.J="KeyJ",Gr.K="KeyK",Gr.L="KeyL",Gr.M="KeyM",Gr.N="KeyN",Gr.O="KeyO",Gr.P="KeyP",Gr.Q="KeyQ",Gr.R="KeyR",Gr.S="KeyS",Gr.T="KeyT",Gr.U="KeyU",Gr.V="KeyV",Gr.W="KeyW",Gr.X="KeyX",Gr.Y="KeyY",Gr.Z="KeyZ",Gr.KeyA="KeyA",Gr.KeyB="KeyB",Gr.KeyC="KeyC",Gr.KeyD="KeyD",Gr.KeyE="KeyE",Gr.KeyF="KeyF",Gr.KeyG="KeyG",Gr.KeyH="KeyH",Gr.KeyI="KeyI",Gr.KeyJ="KeyJ",Gr.KeyK="KeyK",Gr.KeyL="KeyL",Gr.KeyM="KeyM",Gr.KeyN="KeyN",Gr.KeyO="KeyO",Gr.KeyP="KeyP",Gr.KeyQ="KeyQ",Gr.KeyR="KeyR",Gr.KeyS="KeyS",Gr.KeyT="KeyT",Gr.KeyU="KeyU",Gr.KeyV="KeyV",Gr.KeyW="KeyW",Gr.KeyX="KeyX",Gr.KeyY="KeyY",Gr.KeyZ="KeyZ",Gr.Semicolon="Semicolon",Gr.Quote="Quote",Gr.Comma="Comma",Gr.Minus="Minus",Gr.Period="Period",Gr.Slash="Slash",Gr.Equal="Equal",Gr.BracketLeft="BracketLeft",Gr.Backslash="Backslash",Gr.BracketRight="BracketRight",Gr.Backquote="Backquote",Gr.Up="ArrowUp",Gr.Down="ArrowDown",Gr.Left="ArrowLeft",Gr.Right="ArrowRight",Gr.ArrowUp="ArrowUp",Gr.ArrowDown="ArrowDown",Gr.ArrowLeft="ArrowLeft",Gr.ArrowRight="ArrowRight",Gr.Space="Space",Gr.Esc="Escape",Gr.Escape="Escape";var Yr,$r,Jr,ta,ea=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t,i,r){var a;return Object(g.a)(this,n),(a=e.call(this)).key=t,a.value=i,a.originalEvent=r,a}return n}(Nt),na=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(){var t;return Object(g.a)(this,n),(t=e.call(this))._keys=[],t._keysUp=[],t._keysDown=[],t}return Object(y.a)(n,[{key:"on",value:function(t,e){Object(s.a)(Object(l.a)(n.prototype),"on",this).call(this,t,e)}},{key:"init",value:function(t){var e=this;if(!t)try{var n=function(){};window.top.addEventListener("blur",n),window.top.removeEventListener("blur",n),t=window.top}catch(i){t=window,A.getInstance().warn("Failed to bind to keyboard events to top frame. If you are trying to embed Excalibur in a cross-origin iframe, keyboard events will not fire.")}t.addEventListener("blur",(function(){e._keys.length=0})),t.addEventListener("keyup",(function(t){var n=t.code,i=e._keys.indexOf(n);e._keys.splice(i,1),e._keysUp.push(n);var r=new ea(n,t.key,t);e.eventDispatcher.emit("up",r),e.eventDispatcher.emit("release",r)})),t.addEventListener("keydown",(function(t){var n=t.code;if(-1===e._keys.indexOf(n)){e._keys.push(n),e._keysDown.push(n);var i=new ea(n,t.key,t);e.eventDispatcher.emit("down",i),e.eventDispatcher.emit("press",i)}}))}},{key:"update",value:function(){this._keysDown.length=0,this._keysUp.length=0;for(var t=0;t<this._keys.length;t++)this.eventDispatcher.emit("hold",new ea(this._keys[t]))}},{key:"getKeys",value:function(){return this._keys}},{key:"wasPressed",value:function(t){return this._keysDown.indexOf(t)>-1}},{key:"isHeld",value:function(t){return this._keys.indexOf(t)>-1}},{key:"wasReleased",value:function(t){return this._keysUp.indexOf(t)>-1}}]),n}(fn);($r=Yr||(Yr={})).Touch="Touch",$r.Mouse="Mouse",$r.Pen="Pen",$r.Unknown="Unknown",(ta=Jr||(Jr={})).Canvas="Canvas",ta.Document="Document";var ia,ra,aa,oa,sa,la,ua=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(){var t;return Object(g.a)(this,n),(t=e.call(this)).id=n._MAX_ID++,t._isDown=!1,t._wasDown=!1,t._actorsUnderPointer={length:0},t._actors=[],t._actorsLastFrame=[],t._actorsNoLongerUnderPointer=[],t._actorSortingFcn=function(t,e){return t.z===e.z?e.id-t.id:e.z-t.z},t.lastPagePos=null,t.lastScreenPos=null,t.lastWorldPos=null,t.dragTarget=null,t.on("move",t._onPointerMove),t.on("down",t._onPointerDown),t.on("up",t._onPointerUp),t}return Object(y.a)(n,[{key:"isDragging",get:function(){return this._isDown}},{key:"isDragStart",get:function(){return!this._wasDown&&this._isDown}},{key:"isDragEnd",get:function(){return this._wasDown&&!this._isDown}},{key:"hasActorsUnderPointer",get:function(){return!!this._actorsUnderPointer.length}},{key:"on",value:function(t,e){Object(s.a)(Object(l.a)(n.prototype),"on",this).call(this,t,e)}},{key:"once",value:function(t,e){Object(s.a)(Object(l.a)(n.prototype),"once",this).call(this,t,e)}},{key:"off",value:function(t,e){Object(s.a)(Object(l.a)(n.prototype),"off",this).call(this,t,e)}},{key:"update",value:function(){this._wasDown&&!this._isDown?this._wasDown=!1:!this._wasDown&&this._isDown&&(this._wasDown=!0),this._actorsLastFrame=d(this._actors),this._actorsNoLongerUnderPointer=[]}},{key:"addActorUnderPointer",value:function(t){this.isActorAliveUnderPointer(t)||(this._actorsUnderPointer[t.id]=t,this._actorsUnderPointer.length+=1,this._actors.push(t)),this._actors.sort(this._actorSortingFcn)}},{key:"removeActorUnderPointer",value:function(t){this.isActorAliveUnderPointer(t)&&(delete this._actorsUnderPointer[t.id],this._actorsUnderPointer.length-=1,X(t,this._actors),this._actorsNoLongerUnderPointer.push(t))}},{key:"getActorsUnderPointer",value:function(){return this._actors}},{key:"getActorsUnderPointerLastFrame",value:function(){return this._actorsLastFrame}},{key:"getActorsForEvents",value:function(){return this._actors.concat(this._actorsLastFrame).filter((function(t,e,n){return n.indexOf(t)===e})).sort(this._actorSortingFcn)}},{key:"checkActorUnderPointer",value:function(t){return!!this.lastWorldPos&&t.contains(this.lastWorldPos.x,this.lastWorldPos.y,!lr(t))}},{key:"wasActorUnderPointer",value:function(t){return this._actorsLastFrame.indexOf(t)>-1}},{key:"isActorAliveUnderPointer",value:function(t){return!(t.isKilled()||!t.scene||!this._actorsUnderPointer.hasOwnProperty(t.id.toString()))}},{key:"_onPointerMove",value:function(t){this.lastPagePos=new ot(t.pagePos.x,t.pagePos.y),this.lastScreenPos=new ot(t.screenPos.x,t.screenPos.y),this.lastWorldPos=new ot(t.worldPos.x,t.worldPos.y)}},{key:"_onPointerDown",value:function(t){this.lastPagePos=new ot(t.pagePos.x,t.pagePos.y),this.lastScreenPos=new ot(t.screenPos.x,t.screenPos.y),this.lastWorldPos=new ot(t.worldPos.x,t.worldPos.y),this._isDown=!0}},{key:"_onPointerUp",value:function(t){this._isDown=!1,this.dragTarget=null}}]),n}(fn);ua._MAX_ID=0,(ra=ia||(ia={}))[ra.NoButton=-1]="NoButton",ra[ra.Left=0]="Left",ra[ra.Middle=1]="Middle",ra[ra.Right=2]="Right",ra[ra.Unknown=3]="Unknown",(oa=aa||(aa={})).Left="Left",oa.Middle="Middle",oa.Right="Right",oa.Unknown="Unknown",oa.NoButton="NoButton",(la=sa||(sa={})).Pixel="Pixel",la.Line="Line",la.Page="Page";var ca=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t,i,r,a,o,s){var l;return Object(g.a)(this,n),(l=e.call(this)).coordinates=t,l.pointer=i,l.index=r,l.pointerType=a,l.button=o,l.ev=s,l._canceled=!1,l}return Object(y.a)(n,[{key:"name",get:function(){return this._name}},{key:"worldPos",get:function(){return this.coordinates.worldPos.clone()}},{key:"pagePos",get:function(){return this.coordinates.pagePos.clone()}},{key:"screenPos",get:function(){return this.coordinates.screenPos.clone()}},{key:"pos",get:function(){return this.coordinates.worldPos.clone()}},{key:"cancel",value:function(){this._canceled=!0}},{key:"isCanceled",value:function(){return this._canceled}},{key:"propagate",value:function(t){this.doAction(t),this.bubbles&&!this.isCanceled()&&t.parent&&this.propagate(t.parent)}},{key:"doAction",value:function(t){t&&(this._onActionStart(t),t.emit(this._name,this),this._onActionEnd(t))}},{key:"_onActionStart",value:function(t){}},{key:"_onActionEnd",value:function(t){}}]),n}(Nt),ha=function(){function t(e){Object(g.a)(this,t),this._pointerEventType=e}return Object(y.a)(t,[{key:"create",value:function(t,e,n,i,r,a){return new this._pointerEventType(t,e,n,i,r,a)}}]),t}(),da=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(){return Object(g.a)(this,n),e.apply(this,arguments)}return n}(ca),fa=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(){var t;return Object(g.a)(this,n),(t=e.apply(this,arguments))._name="pointerup",t}return Object(y.a)(n,[{key:"_onActionEnd",value:function(t){this.pointer.isDragEnd&&t.capturePointer.captureDragEvents&&t.eventDispatcher.emit("pointerdragend",this)}}]),n}(ca),pa=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(){var t;return Object(g.a)(this,n),(t=e.apply(this,arguments))._name="pointerdown",t}return Object(y.a)(n,[{key:"_onActionEnd",value:function(t){this.pointer.isDragStart&&t.capturePointer.captureDragEvents&&t.eventDispatcher.emit("pointerdragstart",this)}}]),n}(ca),va=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(){var t;return Object(g.a)(this,n),(t=e.apply(this,arguments))._name="pointermove",t}return Object(y.a)(n,[{key:"propagate",value:function(t){this.pointer.isActorAliveUnderPointer(t)&&(this.doAction(t),this.bubbles&&!this.isCanceled()&&t.parent&&this.propagate(t.parent))}},{key:"_onActionStart",value:function(t){t.capturePointer.captureMoveEvents&&this.pointer.isDragging&&t.capturePointer.captureDragEvents&&t.eventDispatcher.emit("pointerdragmove",this)}}]),n}(ca),ga=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(){var t;return Object(g.a)(this,n),(t=e.apply(this,arguments))._name="pointerenter",t}return Object(y.a)(n,[{key:"_onActionStart",value:function(t){t.capturePointer.captureMoveEvents}},{key:"_onActionEnd",value:function(t){this.pointer.isDragging&&t.capturePointer.captureDragEvents&&t.eventDispatcher.emit("pointerdragenter",this)}}]),n}(ca),ya=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(){var t;return Object(g.a)(this,n),(t=e.apply(this,arguments))._name="pointerleave",t}return Object(y.a)(n,[{key:"_onActionStart",value:function(t){t.capturePointer.captureMoveEvents}},{key:"_onActionEnd",value:function(t){this.pointer.isDragging&&t.capturePointer.captureDragEvents&&t.eventDispatcher.emit("pointerdragleave",this)}}]),n}(ca),ma=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(){var t;return Object(g.a)(this,n),(t=e.apply(this,arguments))._name="pointercancel",t}return n}(ca),_a=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t,i,r,a,o,s,l,u,c,h,d,f){var p;return Object(g.a)(this,n),(p=e.call(this)).x=t,p.y=i,p.pageX=r,p.pageY=a,p.screenX=o,p.screenY=s,p.index=l,p.deltaX=u,p.deltaY=c,p.deltaZ=h,p.deltaMode=d,p.ev=f,p._isCanceled=!1,p}return Object(y.a)(n,[{key:"cancel",value:function(){this._isCanceled=!0}},{key:"isCanceled",value:function(){return this._isCanceled}}]),n}(Nt);function ba(t,e,n,i,r,a,o){var s;switch(t){case"up":s=new ha(fa);break;case"down":s=new ha(pa);break;case"move":s=new ha(va);break;case"cancel":s=new ha(ma);break;case"enter":s=new ha(ga);break;case"leave":s=new ha(ya)}return s.create(e,n,i,r,a,o)}var wa=function(){function t(e,n,i){Object(g.a)(this,t),this.worldPos=e,this.pagePos=n,this.screenPos=i}return Object(y.a)(t,null,[{key:"fromPagePosition",value:function(e,n,i){var r,a;3===arguments.length?(r=new ot(e,n),a=i):((r=e).x,r.y,a=n);var o=a.screen.pageToScreenCoordinates(r),s=a.screen.screenToWorldCoordinates(o);return new t(s,r,o)}}]),t}(),ka=-1/40,xa=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t){var i;return Object(g.a)(this,n),(i=e.call(this))._pointerDown=[],i._pointerUp=[],i._pointerMove=[],i._pointerCancel=[],i._wheel=[],i._pointers=[],i._activePointers=[],i._engine=t,i._pointers.push(new ua),i._activePointers=[-1],i.primary=i._pointers[0],i}return Object(y.a)(n,[{key:"on",value:function(t,e){Object(s.a)(Object(l.a)(n.prototype),"on",this).call(this,t,e)}},{key:"init",value:function(t){(t=t||this._engine.canvas).addEventListener("touchstart",this._handleTouchEvent("down",this._pointerDown)),t.addEventListener("touchend",this._handleTouchEvent("up",this._pointerUp)),t.addEventListener("touchmove",this._handleTouchEvent("move",this._pointerMove)),t.addEventListener("touchcancel",this._handleTouchEvent("cancel",this._pointerCancel)),window.PointerEvent?(this._engine.canvas.style.touchAction="none",t.addEventListener("pointerdown",this._handlePointerEvent("down",this._pointerDown)),t.addEventListener("pointerup",this._handlePointerEvent("up",this._pointerUp)),t.addEventListener("pointermove",this._handlePointerEvent("move",this._pointerMove)),t.addEventListener("pointercancel",this._handlePointerEvent("cancel",this._pointerCancel))):window.MSPointerEvent?(this._engine.canvas.style.msTouchAction="none",t.addEventListener("MSPointerDown",this._handlePointerEvent("down",this._pointerDown)),t.addEventListener("MSPointerUp",this._handlePointerEvent("up",this._pointerUp)),t.addEventListener("MSPointerMove",this._handlePointerEvent("move",this._pointerMove)),t.addEventListener("MSPointerCancel",this._handlePointerEvent("cancel",this._pointerCancel))):(t.addEventListener("mousedown",this._handleMouseEvent("down",this._pointerDown)),t.addEventListener("mouseup",this._handleMouseEvent("up",this._pointerUp)),t.addEventListener("mousemove",this._handleMouseEvent("move",this._pointerMove)));var e={passive:!(this._engine.pageScrollPreventionMode===ja.All||this._engine.pageScrollPreventionMode===ja.Canvas)};"onwheel"in document.createElement("div")?t.addEventListener("wheel",this._handleWheelEvent("wheel",this._wheel),e):void 0!==document.onmousewheel?t.addEventListener("mousewheel",this._handleWheelEvent("wheel",this._wheel),e):t.addEventListener("MozMousePixelScroll",this._handleWheelEvent("wheel",this._wheel),e)}},{key:"triggerEvent",value:function(t,e){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ia.Left,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"mouse",a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=0,s=0;e instanceof wa?(o=e.pagePos.x,s=e.pagePos.y,n=e):(o=e.x,s=e.y,n=new wa(e.clone(),e.clone(),e.clone()));var l={pageX:o,pageY:s,pointerId:a,pointerType:r,button:i,preventDefault:function(){}};switch(t){case"move":this._handlePointerEvent(t,this._pointerMove,n)(l);break;case"down":this._handlePointerEvent(t,this._pointerDown,n)(l);break;case"up":this._handlePointerEvent(t,this._pointerUp,n)(l);break;case"cancel":this._handlePointerEvent(t,this._pointerCancel,n)(l)}var u,c=Object(f.a)(this._engine.currentScene.actors);try{for(c.s();!(u=c.n()).done;){var h=u.value,d=h.traits.filter((function(t){return t instanceof ui}))[0];d&&d.update(h,this._engine,1)}}catch(p){c.e(p)}finally{c.f()}this.dispatchPointerEvents(),this.update()}},{key:"update",value:function(){this._pointerUp.length=0,this._pointerDown.length=0,this._pointerMove.length=0,this._pointerCancel.length=0,this._wheel.length=0;for(var t=0;t<this._pointers.length;t++)this._pointers[t].update()}},{key:"at",value:function(t){if(t>=this._pointers.length)for(var e=this._pointers.length-1,n=t;e<n;e++)this._pointers.push(new ua),this._activePointers.push(-1);return this._pointers[t]}},{key:"count",value:function(){return this._pointers.length}},{key:"checkAndUpdateActorUnderPointer",value:function(t){var e,n=Object(f.a)(this._pointers);try{for(n.s();!(e=n.n()).done;){var i=e.value;i.checkActorUnderPointer(t)?i.addActorUnderPointer(t):i.removeActorUnderPointer(t)}}catch(r){n.e(r)}finally{n.f()}}},{key:"_dispatchWithBubble",value:function(t){var e,n=Object(f.a)(t);try{for(n.s();!(e=n.n()).done;){var i,r=e.value,a=Object(f.a)(r.pointer.getActorsForEvents());try{for(a.s();!(i=a.n()).done;){var o=i.value;if(r.isCanceled()||r.propagate(o),!r.bubbles||r.isCanceled())break}}catch(s){a.e(s)}finally{a.f()}}}catch(s){n.e(s)}finally{n.f()}}},{key:"_dispatchPointerLeaveEvents",value:function(){var t,e={},n=[],i=Object(f.a)(this._pointerMove);try{for(i.s();!(t=i.n()).done;){var r,a=t.value,o=Object(f.a)(a.pointer.getActorsForEvents());try{for(o.s();!(r=o.n()).done;){var s=r.value;if(!e[a.pointer.id+"+"+s.id]&&a.pointer.wasActorUnderPointer(s)&&!a.pointer.isActorAliveUnderPointer(s)&&!a.isCanceled()){e[a.pointer.id+"+"+s.id]=a;var l=ba("leave",new wa(a.worldPos,a.pagePos,a.screenPos),a.pointer,a.index,a.pointerType,a.button,a.ev);l.propagate(s),n.push(l)}}}catch(u){o.e(u)}finally{o.f()}}}catch(u){i.e(u)}finally{i.f()}return n}},{key:"_dispatchPointerEnterEvents",value:function(){var t,e={},n=[],i=Object(f.a)(this._pointerMove);try{for(i.s();!(t=i.n()).done;){var r,a=t.value,o=Object(f.a)(a.pointer.getActorsForEvents());try{for(o.s();!(r=o.n()).done;){var s=r.value;if(!e[a.pointer.id]&&!a.pointer.wasActorUnderPointer(s)&&a.pointer.isActorAliveUnderPointer(s)&&!a.isCanceled()){e[a.pointer.id]=a;var l=ba("enter",new wa(a.worldPos,a.pagePos,a.screenPos),a.pointer,a.index,a.pointerType,a.button,a.ev);l.propagate(s),n.push(l),a.pointer.isDragging&&(a.pointer.dragTarget=s)}}}catch(u){o.e(u)}finally{o.f()}}}catch(u){i.e(u)}finally{i.f()}return n}},{key:"dispatchPointerEvents",value:function(){this._dispatchWithBubble(this._pointerDown),this._dispatchWithBubble(this._pointerUp),this._dispatchWithBubble(this._pointerMove),this._dispatchPointerLeaveEvents(),this._dispatchPointerEnterEvents(),this._dispatchWithBubble(this._pointerCancel);var t,e=Object(f.a)(this._wheel);try{for(e.s();!(t=e.n()).done;){var n,i=t.value,r=Object(f.a)(this._pointers[i.index].getActorsUnderPointer());try{for(r.s();!(n=r.n()).done;){var a=n.value;if(this._propagateWheelPointerEvent(a,i),!i.bubbles||i.isCanceled())break}}catch(o){r.e(o)}finally{r.f()}}}catch(o){e.e(o)}finally{e.f()}}},{key:"_propagateWheelPointerEvent",value:function(t,e){t.emit("pointerwheel",e),e.bubbles&&!e.isCanceled()&&t.parent&&this._propagateWheelPointerEvent(t.parent,e)}},{key:"_handleMouseEvent",value:function(t,e){var n=this;return function(i){i.preventDefault();var r=n.at(0),a=wa.fromPagePosition(i.pageX,i.pageY,n._engine),o=ba(t,a,r,0,Yr.Mouse,n._nativeButtonToPointerButton(i.button),i);e.push(o),r.eventDispatcher.emit(t,o)}}},{key:"_handleTouchEvent",value:function(t,e){var n=this;return function(i){i.preventDefault();for(var r=0,a=i.changedTouches.length;r<a;r++){var o=n._pointers.length>1?n._getPointerIndex(i.changedTouches[r].identifier):0;if(-1!==o){var s=n.at(o),l=wa.fromPagePosition(i.changedTouches[r].pageX,i.changedTouches[r].pageY,n._engine),u=ba(t,l,s,o,Yr.Touch,aa.Unknown,i);e.push(u),s.eventDispatcher.emit(t,u),n.emit(t,u),n._pointers.length>1&&("up"===t?n._activePointers[o]=-1:"down"===t&&(n._activePointers[o]=i.changedTouches[r].identifier))}}}}},{key:"_handlePointerEvent",value:function(t,e,n){var i=this;return function(r){r.preventDefault();var a=i._pointers.length>1?i._getPointerIndex(r.pointerId):0;if(-1!==a){var o=i.at(a),s=n||wa.fromPagePosition(r.pageX,r.pageY,i._engine),l=ba(t,s,o,a,i._stringToPointerType(r.pointerType),i._nativeButtonToPointerButton(r.button),r);e.push(l),o.eventDispatcher.emit(t,l),i.emit(t,l),i._pointers.length>1&&("up"===t?i._activePointers[a]=-1:"down"===t&&(i._activePointers[a]=r.pointerId))}}}},{key:"_handleWheelEvent",value:function(t,e){var n=this;return function(i){(n._engine.pageScrollPreventionMode===ja.All||n._engine.pageScrollPreventionMode===ja.Canvas&&i.target===n._engine.canvas)&&i.preventDefault();var r=n._engine.screen.pageToScreenCoordinates(st(i.pageX,i.pageY)),a=n._engine.screen.screenToWorldCoordinates(r),o=i.deltaX||i.wheelDeltaX*ka||0,s=i.deltaY||i.wheelDeltaY*ka||i.wheelDelta*ka||i.detail||0,l=i.deltaZ||0,u=sa.Pixel;i.deltaMode&&(1===i.deltaMode?u=sa.Line:2===i.deltaMode&&(u=sa.Page));var c=new _a(a.x,a.y,i.pageX,i.pageY,r.x,r.y,0,o,s,l,u,i);e.push(c),n.at(0).eventDispatcher.emit(t,c),n.emit(t,c)}}},{key:"_getPointerIndex",value:function(t){var e;if((e=this._activePointers.indexOf(t))>-1)return e;for(var n=0;n<this._activePointers.length;n++)if(-1===this._activePointers[n])return n;return-1}},{key:"_nativeButtonToPointerButton",value:function(t){switch(t){case ia.NoButton:return aa.NoButton;case ia.Left:return aa.Left;case ia.Middle:return aa.Middle;case ia.Right:return aa.Right;case ia.Unknown:return aa.Unknown;default:return Y(t)}}},{key:"_stringToPointerType",value:function(t){switch(t){case"touch":return Yr.Touch;case"mouse":return Yr.Mouse;case"pen":return Yr.Pen;default:return Yr.Unknown}}}]),n}(fn),Sa=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(){var t;return Object(g.a)(this,n),(t=e.call(this)).enabled=!1,t.supported=!!navigator.getGamepads,t._gamePadTimeStamps=[0,0,0,0],t._oldPads=[],t._pads=[],t._initSuccess=!1,t._navigator=navigator,t._minimumConfiguration=null,t}return Object(y.a)(n,[{key:"init",value:function(){this.supported&&(this._initSuccess||(this._oldPads=this._clonePads(this._navigator.getGamepads()),this._oldPads.length&&this._oldPads[0]&&(this._initSuccess=!0)))}},{key:"setMinimumGamepadConfiguration",value:function(t){this._enableAndUpdate(),this._minimumConfiguration=t}},{key:"_enableAndUpdate",value:function(){this.enabled||(this.enabled=!0,this.update())}},{key:"_isGamepadValid",value:function(t){if(!this._minimumConfiguration)return!0;if(!t)return!1;var e=t.axes.filter((function(t){return void 0!==typeof t})).length,n=t.buttons.filter((function(t){return void 0!==typeof t})).length;return e>=this._minimumConfiguration.axis&&n>=this._minimumConfiguration.buttons&&t.connected}},{key:"on",value:function(t,e){this._enableAndUpdate(),Object(s.a)(Object(l.a)(n.prototype),"on",this).call(this,t,e)}},{key:"off",value:function(t,e){this._enableAndUpdate(),Object(s.a)(Object(l.a)(n.prototype),"off",this).call(this,t,e)}},{key:"update",value:function(){if(this.enabled&&this.supported){this.init();for(var t=this._navigator.getGamepads(),e=0;e<t.length;e++)if(t[e]){if(!this.at(e).connected&&this._isGamepadValid(t[e])&&this.eventDispatcher.emit("connect",new te(e,this.at(e))),this.at(e).connected=!0,!t[e].timestamp||t[e].timestamp!==this._gamePadTimeStamps[e]){this._gamePadTimeStamps[e]=t[e].timestamp,this.at(e).navigatorGamepad=t[e];var n=void 0,i=void 0,r=void 0,a=void 0,o=void 0;for(n in Ca)"number"===typeof(i=Ca[n])&&t[e].buttons[i]&&(o=t[e].buttons[i].value)!==this._oldPads[e].getButton(i)&&(t[e].buttons[i].pressed?(this.at(e).updateButton(i,o),this.at(e).eventDispatcher.emit("button",new ne(i,o,this.at(e)))):this.at(e).updateButton(i,0));for(r in Ea)"number"===typeof(a=Ea[r])&&(o=t[e].axes[a])!==this._oldPads[e].getAxes(a)&&(this.at(e).updateAxes(a,o),this.at(e).eventDispatcher.emit("axis",new ie(a,o,this.at(e))));this._oldPads[e]=this._clonePad(t[e])}}else{var s=this.at(e);s.connected&&this.eventDispatcher.emit("disconnect",new ee(e,s)),s.connected=!1}}}},{key:"at",value:function(t){if(this._enableAndUpdate(),t>=this._pads.length)for(var e=this._pads.length-1,n=t;e<n;e++)this._pads.push(new Pa),this._oldPads.push(new Pa);return this._pads[t]}},{key:"getValidGamepads",value:function(){this._enableAndUpdate();for(var t=[],e=0;e<this._pads.length;e++)this._isGamepadValid(this.at(e).navigatorGamepad)&&this.at(e).connected&&t.push(this.at(e));return t}},{key:"count",value:function(){return this._pads.filter((function(t){return t.connected})).length}},{key:"_clonePads",value:function(t){for(var e=[],n=0,i=t.length;n<i;n++)e.push(this._clonePad(t[n]));return e}},{key:"_clonePad",value:function(t){var e,n,i=new Pa;if(!t)return i;for(e=0,n=t.buttons.length;e<n;e++)t.buttons[e]&&i.updateButton(e,t.buttons[e].value);for(e=0,n=t.axes.length;e<n;e++)i.updateAxes(e,t.axes[e]);return i}}]),n}(fn);Sa.MinAxisMoveThreshold=.05;var Ca,Oa,Ea,Aa,Pa=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(){var t;Object(g.a)(this,n),(t=e.call(this)).connected=!1,t._buttons=new Array(16),t._axes=new Array(4);for(var i=0;i<t._buttons.length;i++)t._buttons[i]=0;for(var r=0;r<t._axes.length;r++)t._axes[r]=0;return t}return Object(y.a)(n,[{key:"isButtonPressed",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this._buttons[t]>=e}},{key:"getButton",value:function(t){return this._buttons[t]}},{key:"getAxes",value:function(t){var e=this._axes[t];return Math.abs(e)<Sa.MinAxisMoveThreshold?0:e}},{key:"updateButton",value:function(t,e){this._buttons[t]=e}},{key:"updateAxes",value:function(t,e){this._axes[t]=e}}]),n}(fn);(Oa=Ca||(Ca={}))[Oa.Face1=0]="Face1",Oa[Oa.Face2=1]="Face2",Oa[Oa.Face3=2]="Face3",Oa[Oa.Face4=3]="Face4",Oa[Oa.LeftBumper=4]="LeftBumper",Oa[Oa.RightBumper=5]="RightBumper",Oa[Oa.LeftTrigger=6]="LeftTrigger",Oa[Oa.RightTrigger=7]="RightTrigger",Oa[Oa.Select=8]="Select",Oa[Oa.Start=9]="Start",Oa[Oa.LeftStick=10]="LeftStick",Oa[Oa.RightStick=11]="RightStick",Oa[Oa.DpadUp=12]="DpadUp",Oa[Oa.DpadDown=13]="DpadDown",Oa[Oa.DpadLeft=14]="DpadLeft",Oa[Oa.DpadRight=15]="DpadRight",(Aa=Ea||(Ea={}))[Aa.LeftStickX=0]="LeftStickX",Aa[Aa.LeftStickY=1]="LeftStickY",Aa[Aa.RightStickX=2]="RightStickX",Aa[Aa.RightStickY=3]="RightStickY";var ja,Ta=function(){function t(e){Object(g.a)(this,t),this.nativeComponent=e,this._paused=!1,this._nativeHandlers={}}return Object(y.a)(t,[{key:"on",value:function(t,e){this._nativeHandlers[t]&&this.off(t,this._nativeHandlers[t]),this._nativeHandlers[t]=this._decorate(e),this.nativeComponent.addEventListener(t,this._nativeHandlers[t])}},{key:"off",value:function(t,e){e||(e=this._nativeHandlers[t]),this.nativeComponent.removeEventListener(t,e),this._nativeHandlers[t]=null}},{key:"_decorate",value:function(t){var e=this;return function(n){e._paused||t(n)}}},{key:"pause",value:function(){this._paused=!0}},{key:"resume",value:function(){this._paused=!1}},{key:"clear",value:function(){for(var t in this._nativeHandlers)this.off(t)}}]),t}(),Ra=function(){function t(e,n){Object(g.a)(this,t),this._windowGlobal=e,this._documentGlobal=n,this._windowComponent=new Ta(this._windowGlobal),this._documentComponent=new Ta(this._documentGlobal)}return Object(y.a)(t,[{key:"window",get:function(){return this._windowComponent}},{key:"document",get:function(){return this._documentComponent}},{key:"pause",value:function(){this.window.pause(),this.document.pause()}},{key:"resume",value:function(){this.window.resume(),this.document.resume()}},{key:"clear",value:function(){this.window.clear(),this.document.clear()}}]),t}(),Da=function(){function t(e){Object(g.a)(this,t),this._ex=e,this._debugText=new on}return Object(y.a)(t,[{key:"drawRect",value:function(t,e,n,i){this._ex.__ctx.save(),this._ex.__ctx.strokeStyle="red",this._ex.__ctx.strokeRect(this._ex.snapToPixel?~~t:t,this._ex.snapToPixel?~~e:e,this._ex.snapToPixel?~~n:n,this._ex.snapToPixel?~~i:i),this._ex.__ctx.restore()}},{key:"drawLine",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{color:ut.Black};this._ex.__ctx.save(),this._ex.__ctx.beginPath(),this._ex.__ctx.strokeStyle=n.color.toString(),this._ex.__ctx.moveTo(this._ex.snapToPixel?~~t.x:t.x,this._ex.snapToPixel?~~t.y:t.y),this._ex.__ctx.lineTo(this._ex.snapToPixel?~~e.x:e.x,this._ex.snapToPixel?~~e.y:e.y),this._ex.__ctx.lineWidth=2,this._ex.__ctx.stroke(),this._ex.__ctx.closePath(),this._ex.__ctx.restore()}},{key:"drawPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{color:ut.Black,size:5};this._ex.__ctx.save(),this._ex.__ctx.beginPath(),this._ex.__ctx.fillStyle=e.color.toString(),this._ex.__ctx.arc(this._ex.snapToPixel?~~t.x:t.x,this._ex.snapToPixel?~~t.y:t.y,e.size,0,2*Math.PI),this._ex.__ctx.fill(),this._ex.__ctx.closePath(),this._ex.__ctx.restore()}},{key:"drawText",value:function(t,e){this._debugText.write(this._ex,t,e)}}]),t}(),Ma=function(){function t(e){Object(g.a)(this,t),this.backgroundColor=ut.ExcaliburBlue,this._state=new gt,this.snapToPixel=!0,this.debug=new Da(this);var n=e.canvasElement,i=e.enableTransparency,r=e.snapToPixel,a=e.smoothing,o=e.backgroundColor;this.__ctx=n.getContext("2d",{alpha:null===i||void 0===i||i}),this.backgroundColor=null!==o&&void 0!==o?o:this.backgroundColor,this.snapToPixel=null!==r&&void 0!==r?r:this.snapToPixel,this.smoothing=null!==a&&void 0!==a?a:this.smoothing}return Object(y.a)(t,[{key:"width",get:function(){return this.__ctx.canvas.width}},{key:"height",get:function(){return this.__ctx.canvas.height}},{key:"opacity",get:function(){return this._state.current.opacity},set:function(t){this._state.current.opacity=t}},{key:"smoothing",get:function(){return this.__ctx.imageSmoothingEnabled},set:function(t){this.__ctx.imageSmoothingEnabled=t}},{key:"resetTransform",value:function(){this.__ctx.resetTransform()}},{key:"updateViewport",value:function(){}},{key:"drawImage",value:function(t,e,n,i,r,a,o,s,l){var u=this;if(0!==i&&0!==r&&0!==s&&0!==l&&0!==t.width&&0!==t.height){this.__ctx.globalAlpha=this.opacity;var c=[t,e,n,i,r,a,o,s,l].filter((function(t){return void 0!==t})).map((function(t){return"number"===typeof t&&u.snapToPixel?~~t:t}));this.__ctx.drawImage.apply(this.__ctx,c),_t.DrawCallCount++,_t.DrawnImagesCount=1}}},{key:"drawLine",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;this.__ctx.save(),this.__ctx.beginPath(),this.__ctx.strokeStyle=n.toString(),this.__ctx.moveTo(this.snapToPixel?~~t.x:t.x,this.snapToPixel?~~t.y:t.y),this.__ctx.lineTo(this.snapToPixel?~~e.x:e.x,this.snapToPixel?~~e.y:e.y),this.__ctx.lineWidth=i,this.__ctx.stroke(),this.__ctx.closePath(),this.__ctx.restore()}},{key:"drawRectangle",value:function(t,e,n,i){this.__ctx.save(),this.__ctx.fillStyle=i.toString(),this.__ctx.fillRect(this.snapToPixel?~~t.x:t.x,this.snapToPixel?~~t.y:t.y,this.snapToPixel?~~e:e,this.snapToPixel?~~n:n),this.__ctx.restore()}},{key:"drawCircle",value:function(t,e,n){this.__ctx.save(),this.__ctx.beginPath(),this.__ctx.fillStyle=n.toString(),this.__ctx.arc(this.snapToPixel?~~t.x:t.x,this.snapToPixel?~~t.y:t.y,e,0,2*Math.PI),this.__ctx.fill(),this.__ctx.closePath(),this.__ctx.restore()}},{key:"save",value:function(){this.__ctx.save()}},{key:"restore",value:function(){this.__ctx.restore()}},{key:"translate",value:function(t,e){this.__ctx.translate(this.snapToPixel?~~t:t,this.snapToPixel?~~e:e)}},{key:"rotate",value:function(t){this.__ctx.rotate(t)}},{key:"scale",value:function(t,e){this.__ctx.scale(t,e)}},{key:"clear",value:function(){this.__ctx.clearRect(0,0,this.width,this.height),this.__ctx.fillStyle=this.backgroundColor.toString(),this.__ctx.fillRect(0,0,this.width,this.height),_t.clear()}},{key:"flush",value:function(){}}]),t}(),La=function(t,e,n,i){var r,a=arguments.length,o=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,n,o):r(e,n))||o);return a>3&&o&&Object.defineProperty(e,n,o),o};x(),function(t){t[t.None=0]="None",t[t.Canvas=1]="Canvas",t[t.All=2]="All"}(ja||(ja={}));var Ba=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t){var r,a,s,l;Object(g.a)(this,n),(r=e.call(this))._hasStarted=!1,r.postProcessors=[],r.scenes={},r._animations=[],r._suppressPlayButton=!1,r.pauseAudioWhenHidden=!0,r._isDebug=!1,r.debugColor=new ut(255,255,255),r.enableCanvasTransparency=!0,r.onFatalException=function(t){A.getInstance().fatal(t)},r._timescale=1,r._isLoading=!1,r._isInitialized=!1,r._deferredGoTo=null,r._loadingComplete=!1,t=Object.assign(Object.assign({},n._DEFAULT_ENGINE_OPTIONS),t),O.freeze(),r.browser=new Ra(window,document);var u=new Sn;if(!t.suppressMinimumBrowserFeatureDetection&&!(r._compatible=u.test())){var c=document.createElement("div");if(c.innerText="Sorry, your browser does not support all the features needed for Excalibur",document.body.appendChild(c),u.failedTests.forEach((function(t){var e=document.createElement("div");e.innerText="Browser feature missing "+t,document.body.appendChild(e)})),t.canvasElementId){var h=document.getElementById(t.canvasElementId);h&&h.parentElement.removeChild(h)}return Object(i.a)(r)}r._compatible=!0,console.log&&!t.suppressConsoleBootMessage&&(console.log("%cPowered by Excalibur.js (v".concat(So,")"),"background: #176BAA; color: white; border-radius: 5px; padding: 15px; font-size: 1.5em; line-height: 80px;"),console.log("\n      /| ________________\nO|===|* >________________>\n      \\|"),console.log("Visit","http://excaliburjs.com","for more information")),t.suppressPlayButton&&(r._suppressPlayButton=!0),r._logger=A.getInstance(),r._logger.defaultLevel===S.Debug&&u.logBrowserFeatures(),r._logger.debug("Building engine..."),r.canvasElementId=t.canvasElementId,t.canvasElementId?(r._logger.debug("Using Canvas element specified: "+t.canvasElementId),r.canvas=document.getElementById(t.canvasElementId)):t.canvasElement?(r._logger.debug("Using Canvas element specified:",t.canvasElement),r.canvas=t.canvasElement):(r._logger.debug("Using generated canvas element"),r.canvas=document.createElement("canvas"));var d=null!==(a=t.displayMode)&&void 0!==a?a:nn.Fixed;if(t.width&&t.height||t.viewport?(void 0===t.displayMode&&(d=nn.Fixed),r._logger.debug("Engine viewport is size "+t.width+" x "+t.height)):t.displayMode||(r._logger.debug("Engine viewport is fit"),d=nn.FitScreen),O.isEnabled(k.Canvas)){var f=new Ma({canvasElement:r.canvas,enableTransparency:r.enableCanvasTransparency,smoothing:t.antialiasing,backgroundColor:t.backgroundColor,snapToPixel:t.snapToPixel});r.graphicsContext=f,r.ctx=f.__ctx}else{var p=new ln({canvasElement:r.canvas,enableTransparency:r.enableCanvasTransparency,smoothing:t.antialiasing,backgroundColor:t.backgroundColor,snapToPixel:t.snapToPixel});r.graphicsContext=p,r.ctx=p.__ctx}return r.screen=new cn({canvas:r.canvas,context:r.graphicsContext,antialiasing:null===(s=t.antialiasing)||void 0===s||s,browser:r.browser,viewport:null!==(l=t.viewport)&&void 0!==l?l:t.width&&t.height?{width:t.width,height:t.height}:un.SVGA,resolution:t.resolution,displayMode:d,position:t.position,pixelRatio:t.suppressHiDPIScaling?1:null}),t.backgroundColor&&(r.backgroundColor=t.backgroundColor.clone()),r.enableCanvasTransparency=t.enableCanvasTransparency,r._loader=new kn,r.debug=new Kr(Object(o.a)(r)),r._initialize(t),r.rootScene=r.currentScene=new Wr,r.addScene("root",r.rootScene),r}return Object(y.a)(n,[{key:"canvasWidth",get:function(){return this.screen.canvasWidth}},{key:"halfCanvasWidth",get:function(){return this.screen.halfCanvasWidth}},{key:"canvasHeight",get:function(){return this.screen.canvasHeight}},{key:"halfCanvasHeight",get:function(){return this.screen.halfCanvasHeight}},{key:"drawWidth",get:function(){return this.screen.drawWidth}},{key:"halfDrawWidth",get:function(){return this.screen.halfDrawWidth}},{key:"drawHeight",get:function(){return this.screen.drawHeight}},{key:"halfDrawHeight",get:function(){return this.screen.halfDrawHeight}},{key:"isHiDpi",get:function(){return this.screen.isHiDpi}},{key:"stats",get:function(){return this.debug.stats}},{key:"isFullscreen",get:function(){return this.screen.isFullScreen}},{key:"displayMode",get:function(){return this.screen.displayMode}},{key:"pixelRatio",get:function(){return this.screen.pixelRatio}},{key:"isDebug",get:function(){return this._isDebug}},{key:"on",value:function(t,e){Object(s.a)(Object(l.a)(n.prototype),"on",this).call(this,t,e)}},{key:"once",value:function(t,e){Object(s.a)(Object(l.a)(n.prototype),"once",this).call(this,t,e)}},{key:"off",value:function(t,e){Object(s.a)(Object(l.a)(n.prototype),"off",this).call(this,t,e)}},{key:"getWorldBounds",value:function(){return this.screen.getWorldBounds()}},{key:"timescale",get:function(){return this._timescale},set:function(t){t<=0?A.getInstance().error("Cannot set engine.timescale to a value of 0 or less than 0."):this._timescale=t}},{key:"playAnimation",value:function(t,e,n){this._animations.push(new Fa(t,e,n))}},{key:"addTileMap",value:function(t){this.currentScene.addTileMap(t)}},{key:"removeTileMap",value:function(t){this.currentScene.removeTileMap(t)}},{key:"addTimer",value:function(t){return this.currentScene.addTimer(t)}},{key:"removeTimer",value:function(t){return this.currentScene.removeTimer(t)}},{key:"addScene",value:function(t,e){this.scenes[t]&&this._logger.warn("Scene",t,"already exists overwriting"),this.scenes[t]=e}},{key:"removeScene",value:function(t){if(t instanceof Wr)for(var e in this.scenes)this.scenes.hasOwnProperty(e)&&this.scenes[e]===t&&delete this.scenes[e];"string"===typeof t&&delete this.scenes[t]}},{key:"add",value:function(t){2!==arguments.length?this._deferredGoTo&&this.scenes[this._deferredGoTo]?this.scenes[this._deferredGoTo].add(t):this.currentScene.add(t):this.addScene(arguments[0],arguments[1])}},{key:"remove",value:function(t){t instanceof pi&&this.currentScene.remove(t),t instanceof Wr&&this.removeScene(t),"string"===typeof t&&this.removeScene(t)}},{key:"goToScene",value:function(t){if(this.isInitialized)if(this.scenes[t]){var e=this.currentScene,n=this.scenes[t];this._logger.debug("Going to scene:",t),this.currentScene.isInitialized&&(this.currentScene._deactivate.apply(this.currentScene,[e,n]),this.currentScene.eventDispatcher.emit("deactivate",new me(n,this.currentScene))),this.currentScene=n,this.screen.setCurrentCamera(n.camera),this.currentScene._initialize(this),this.currentScene._activate.apply(this.currentScene,[e,n]),this.currentScene.eventDispatcher.emit("activate",new ye(e,this.currentScene))}else this._logger.error("Scene",t,"does not exist!");else this._deferredGoTo=t}},{key:"screenToWorldCoordinates",value:function(t){return this.screen.screenToWorldCoordinates(t)}},{key:"worldToScreenCoordinates",value:function(t){return this.screen.worldToScreenCoordinates(t)}},{key:"_initialize",value:function(t){var e,n,i=this;this.pageScrollPreventionMode=t.scrollPreventionMode,this.input={keyboard:new na,pointers:new xa(this),gamepads:new Sa},this.input.keyboard.init(),this.input.pointers.init(t&&t.pointerScope===Jr.Document?document:this.canvas),this.input.gamepads.init(),"undefined"!==typeof document.hidden?(e="hidden",n="visibilitychange"):"msHidden"in document?(e="msHidden",n="msvisibilitychange"):"webkitHidden"in document&&(e="webkitHidden",n="webkitvisibilitychange"),this.browser.document.on(n,(function(){document[e]?(i.eventDispatcher.emit("hidden",new se(i)),i._logger.debug("Window hidden")):(i.eventDispatcher.emit("visible",new oe(i)),i._logger.debug("Window visible"))})),this.canvasElementId||t.canvasElement||document.body.appendChild(this.canvas)}},{key:"onInitialize",value:function(t){}},{key:"setAntialiasing",value:function(t){this.screen.antialiasing=t}},{key:"getAntialiasing",value:function(){return this.screen.antialiasing}},{key:"isInitialized",get:function(){return this._isInitialized}},{key:"_overrideInitialize",value:function(t){this.isInitialized||(this.onInitialize(t),Object(s.a)(Object(l.a)(n.prototype),"emit",this).call(this,"initialize",new ge(t,this)),this._isInitialized=!0,this._deferredGoTo?this.goToScene(this._deferredGoTo):this.goToScene("root"))}},{key:"_update",value:function(t){if(this._isLoading)return this._loader.update(this,t),this.input.keyboard.update(),this.input.pointers.update(),void this.input.gamepads.update();this._overrideInitialize(this),this._preupdate(t),this.currentScene.update(this,t),this._animations=this._animations.filter((function(t){return!t.animation.isDone()})),this.input.keyboard.update(),this.input.pointers.update(),this.input.gamepads.update(),this._postupdate(t)}},{key:"_preupdate",value:function(t){this.emit("preupdate",new Qt(this,t,this)),this.onPreUpdate(this,t)}},{key:"onPreUpdate",value:function(t,e){}},{key:"_postupdate",value:function(t){this.emit("postupdate",new Yt(this,t,this)),this.onPostUpdate(this,t)}},{key:"onPostUpdate",value:function(t,e){}},{key:"_draw",value:function(t){var e=this.ctx;if(this._predraw(e,t),this._isLoading)return this._loader.canvas.draw(this.graphicsContext,0,0),void this.graphicsContext.flush();this.graphicsContext.backgroundColor=this.backgroundColor,this.currentScene.draw(this.ctx,t);for(var n=0,i=this._animations.length;n<i;n++)this._animations[n].animation.draw(e,this._animations[n].x,this._animations[n].y);if(this.isDebug){this.ctx.font="Consolas",this.ctx.fillStyle=this.debugColor.toString();for(var r=this.input.keyboard.getKeys(),a=0;a<r.length;a++)this.ctx.fillText(r[a].toString()+" : "+(Vr[r[a]]?Vr[r[a]]:"Not Mapped"),100,10*a+10);this.ctx.fillText("FPS:"+this.stats.currFrame.fps.toFixed(2).toString(),10,10)}for(var o=0;o<this.postProcessors.length;o++)this.postProcessors[o].process(this.ctx.getImageData(0,0,this.canvasWidth,this.canvasHeight),this.ctx);this._postdraw(e,t)}},{key:"_predraw",value:function(t,e){this.emit("predraw",new Xt(t,e,this)),this.onPreDraw(t,e)}},{key:"onPreDraw",value:function(t,e){}},{key:"_postdraw",value:function(t,e){this.emit("postdraw",new qt(t,e,this)),this.onPostDraw(t,e)}},{key:"onPostDraw",value:function(t,e){}},{key:"showDebug",value:function(t){this._isDebug=t}},{key:"toggleDebug",value:function(){return this._isDebug=!this._isDebug,this._isDebug}},{key:"loadingComplete",get:function(){return this._loadingComplete}},{key:"start",value:function(t){var e,i=this;return this._compatible?(this.screen.pushResolutionAndViewport(),this.screen.resolution=this.screen.viewport,this.screen.applyResolutionAndViewport(),this.graphicsContext.updateViewport(),t?(this._loader=t,this._loader.suppressPlayButton=this._suppressPlayButton||this._loader.suppressPlayButton,this._loader.wireEngine(this),e=this.load(this._loader)):e=Promise.resolve(),e.then((function(){i.screen.popResolutionAndViewport(),i.screen.applyResolutionAndViewport(),i.graphicsContext.updateViewport(),i.emit("start",new Vt(i)),i._loadingComplete=!0})),this._hasStarted||(this._hasStarted=!0,this._logger.debug("Starting game..."),this.browser.resume(),n.createMainLoop(this,window.requestAnimationFrame,Date.now)(),this._logger.debug("Game started")),e):Promise.reject("Excalibur is incompatible with your browser")}},{key:"stop",value:function(){this._hasStarted&&(this.emit("stop",new Gt(this)),this.browser.pause(),this._hasStarted=!1,this._logger.debug("Game stopped"))}},{key:"isPaused",value:function(){return!this._hasStarted}},{key:"screenshot",value:function(){var t=new Image,e=this.canvas.toDataURL("image/png");return t.src=e,t}},{key:"load",value:function(t){var e=this;return new Promise((function(n){e._isLoading=!0,t.load().then((function(){e._suppressPlayButton?setTimeout((function(){e._isLoading=!1,n()}),500):(e._isLoading=!1,n())}))}))}}],[{key:"createMainLoop",value:function(t,e,n){var i=n();return function r(){if(t._hasStarted)try{t._requestId=e(r),t.emit("preframe",new $t(t,t.stats.prevFrame));var a=n(),o=Math.floor(a-i)||1;o>200&&(o=1);var s=o*t.timescale,l=t.stats.prevFrame.id+1;t.stats.currFrame.reset(),t.stats.currFrame.id=l,t.stats.currFrame.delta=s,t.stats.currFrame.fps=1/(s/1e3);var u=n();t._update(s);var c=n();t._draw(s);var h=n();t.stats.currFrame.duration.update=c-u,t.stats.currFrame.duration.draw=h-c,i=a,t.emit("postframe",new Jt(t,t.stats.currFrame)),t.stats.prevFrame.reset(t.stats.currFrame)}catch(d){window.cancelAnimationFrame(t._requestId),t.stop(),t.onFatalException(d)}}}}]),n}(fn);Ba._DEFAULT_ENGINE_OPTIONS={width:0,height:0,enableCanvasTransparency:!0,canvasElementId:"",canvasElement:void 0,snapToPixel:!1,pointerScope:Jr.Canvas,suppressConsoleBootMessage:null,suppressMinimumBrowserFeatureDetection:null,suppressHiDPIScaling:null,suppressPlayButton:null,scrollPreventionMode:ja.Canvas,backgroundColor:ut.fromHex("#2185d0")},La([rt({message:"Will be removed in excalibur v0.26.0",alternateMethod:"Use Actor.graphics"})],Ba.prototype,"playAnimation",null);var Fa=function t(e,n,i){Object(g.a)(this,t),this.animation=e,this.x=n,this.y=i};Fa=La([rt({message:"Will be removed in excalibur v0.26.0"})],Fa);var Ia=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t){var i,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"MediaEvent";return Object(g.a)(this,n),(i=e.call(this)).target=t,i._name=r,i}return Object(y.a)(n,[{key:"bubbles",get:function(){return!1},set:function(t){}},{key:"_path",get:function(){return null},set:function(t){}},{key:"stopPropagation",value:function(){}},{key:"action",value:function(){}},{key:"propagate",value:function(){}},{key:"layPath",value:function(t){}}]),n}(Nt),za=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t,i){var r;return Object(g.a)(this,n),(r=e.call(this,t,"NativeSoundEvent")).track=i,r}return n}(Ia),Na=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t,i){var r;return Object(g.a)(this,n),(r=e.call(this,t,"NativeSoundProcessedEvent"))._processedData=i,r.data=r._processedData,r}return n}(Ia),Ua=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(){var t,i,r,a,o,s,l,u,c,h,d,f,p,v=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(g.a)(this,n),(t=e.call(this,v)).quality=2,t.family="sans-serif",t.style=Ge.Normal,t.bold=!1,t.unit=He.Px,t.textAlign=We.Left,t.baseAlign=Ve.Alphabetic,t.direction=Xe.LeftToRight,t.size=10,t.shadow=null,t._textBounds=new dt,t._textWidth=0,t._textHeight=0,t.family=null!==(i=null===v||void 0===v?void 0:v.family)&&void 0!==i?i:t.family,t.style=null!==(r=null===v||void 0===v?void 0:v.style)&&void 0!==r?r:t.style,t.bold=null!==(a=null===v||void 0===v?void 0:v.bold)&&void 0!==a?a:t.bold,t.size=null!==(o=null===v||void 0===v?void 0:v.size)&&void 0!==o?o:t.size,t.unit=null!==(s=null===v||void 0===v?void 0:v.unit)&&void 0!==s?s:t.unit,t.textAlign=null!==(l=null===v||void 0===v?void 0:v.textAlign)&&void 0!==l?l:t.textAlign,t.baseAlign=null!==(u=null===v||void 0===v?void 0:v.baseAlign)&&void 0!==u?u:t.baseAlign,t.direction=null!==(c=null===v||void 0===v?void 0:v.direction)&&void 0!==c?c:t.direction,t.quality=null!==(h=null===v||void 0===v?void 0:v.quality)&&void 0!==h?h:t.quality,(null===v||void 0===v?void 0:v.shadow)&&(t.shadow={},t.shadow.blur=null!==(d=v.shadow.blur)&&void 0!==d?d:t.shadow.blur,t.shadow.offset=null!==(f=v.shadow.offset)&&void 0!==f?f:t.shadow.offset,t.shadow.color=null!==(p=v.shadow.color)&&void 0!==p?p:t.shadow.color),t.flagDirty(),t}return Object(y.a)(n,[{key:"clone",value:function(){return new n(Object.assign(Object.assign(Object.assign({},this.cloneGraphicOptions()),this.cloneRasterOptions()),{size:this.size,unit:this.unit,family:this.family,style:this.style,bold:this.bold,textAlign:this.textAlign,baseAlign:this.baseAlign,direction:this.direction,shadow:this.shadow?{blur:this.shadow.blur,offset:this.shadow.offset,color:this.shadow.color}:null}))}},{key:"fontString",get:function(){return"".concat(this.style," ").concat(this.bold?"bold":""," ").concat(this.size).concat(this.unit," ").concat(this.family)}},{key:"width",get:function(){return this._textWidth},set:function(t){this._textWidth=t}},{key:"height",get:function(){var t,e,n=null!==(e=null===(t=this._lines)||void 0===t?void 0:t.length)&&void 0!==e?e:1;return this._textHeight*n},set:function(t){var e,n,i=null!==(n=null===(e=this._lines)||void 0===e?void 0:e.length)&&void 0!==n?n:1;this._textHeight=t/i}},{key:"_rasterWidth",get:function(){return this._bitmap.width}},{key:"_rasterHeight",get:function(){return this._bitmap.height}},{key:"_halfRasterWidth",get:function(){return Math.floor(this._bitmap.width/2)}},{key:"_halfRasterHeight",get:function(){return Math.floor(this._bitmap.height/2)}},{key:"localBounds",get:function(){return this._textBounds}},{key:"_drawImage",value:function(t,e,n){this.dirty&&this.rasterize(),t.drawImage(this._bitmap,0,0,this._rasterWidth,this._rasterHeight,e-this._rasterWidth/this.quality/2,n-this._rasterHeight/this.quality/2,this._rasterWidth/this.quality,this._rasterHeight/this.quality)}},{key:"_rotate",value:function(t){var e,n=null!==(e=this.origin)&&void 0!==e?e:this._textBounds.center;t.translate(n.x,n.y),t.rotate(this.rotation),t.translate(-n.x,-n.y)}},{key:"_flip",value:function(t){this.flipHorizontal&&(t.translate(this._textBounds.width/this.scale.x,0),t.scale(-1,1)),this.flipVertical&&(t.translate(0,-this._textBounds.height/2/this.scale.y),t.scale(1,-1))}},{key:"updateText",value:function(t){this._text!==t&&(this._text=t,this._lines=this._text.split("\n"),this._updateDimensions(),this.flagDirty())}},{key:"_updateDimensions",value:function(){if(this._text){this._applyFont(this._ctx);var t=this._lines.reduce((function(t,e){return t.length>e.length?t:e})),e=this._ctx.measureText(t);this._textWidth=Math.abs(e.actualBoundingBoxLeft)+Math.abs(e.actualBoundingBoxRight),this._textHeight=Math.abs(e.actualBoundingBoxAscent)+Math.abs(e.actualBoundingBoxDescent);var n=this._textHeight*this._lines.length;this._bitmap.width=2*(this._textWidth+2*this.padding)*this.quality,this._bitmap.height=2*(n+2*this.padding)*this.quality;var i=n-Math.abs(e.actualBoundingBoxAscent);this._textBounds=new dt({left:0-Math.abs(e.actualBoundingBoxLeft)-this.padding,top:0-Math.abs(e.actualBoundingBoxAscent)-this.padding,bottom:0+i+this.padding,right:0+Math.abs(e.actualBoundingBoxRight)+this.padding})}}},{key:"_preDraw",value:function(t,e,i){this.dirty&&this._updateDimensions(),Object(s.a)(Object(l.a)(n.prototype),"_preDraw",this).call(this,t,e,i)}},{key:"_postDraw",value:function(t){this.showDebug&&t.debug.drawRect(-this._halfRasterWidth,-this._halfRasterHeight,this._rasterWidth,this._rasterHeight),t.restore()}},{key:"_applyFont",value:function(t){t.translate(this.padding+this._halfRasterWidth,this.padding+this._halfRasterHeight),t.scale(this.quality,this.quality),t.textAlign=this.textAlign,t.textBaseline=this.baseAlign,t.font=this.fontString,t.direction=this.direction,this.shadow&&(t.shadowColor=this.shadow.color.toString(),t.shadowBlur=this.shadow.blur,t.shadowOffsetX=this.shadow.offset.x,t.shadowOffsetY=this.shadow.offset.y)}},{key:"execute",value:function(t){if(this._text){this._applyRasterProperites(t),this._applyFont(t);for(var e=this._textHeight,n=0;n<this._lines.length;n++){var i=this._lines[n];this.color&&t.fillText(i,0,n*e),this.strokeColor&&t.strokeText(i,0,n*e)}this.showDebug&&(pn(t,ut.Red,-this._halfRasterWidth,0,this._halfRasterWidth,0,2),pn(t,ut.Red,0,-this._halfRasterHeight,0,this._halfRasterHeight,2))}}},{key:"render",value:function(t,e,n,i){this.updateText(e),this.draw(t,n,i)}}]),n}(It),Ha=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t){var i,r,a;return Object(g.a)(this,n),(i=e.call(this,t))._text="",i.font=null!==(r=t.font)&&void 0!==r?r:new Ua,i.color=null!==(a=t.color)&&void 0!==a?a:i.color,i.text=t.text,i}return Object(y.a)(n,[{key:"clone",value:function(){return new n({text:this.text.slice(),color:this.color.clone(),font:this.font.clone()})}},{key:"text",get:function(){return this._text},set:function(t){this._text=t,this.font.updateText(t)}},{key:"color",get:function(){return this.font instanceof Ua?this.font.color:ut.Black},set:function(t){this.font instanceof Ua&&(this.font.color=t)}},{key:"font",get:function(){return this._font},set:function(t){this._font=t instanceof Ua?Mt(t,(function(t){return t.flagDirty()})):t}},{key:"width",get:function(){return this.font.width}},{key:"height",get:function(){return this.font.height}},{key:"localBounds",get:function(){return this.font.localBounds}},{key:"_rotate",value:function(t){}},{key:"_flip",value:function(t){}},{key:"_drawImage",value:function(t,e,n){this.font instanceof Ua&&(this.font.color=this.color),this.font.flipHorizontal=this.flipHorizontal,this.font.flipVertical=this.flipVertical,this.font.scale=this.scale,this.font.rotation=this.rotation,this.font.origin=this.origin,this.font.opacity=this.opacity,this.font.render(t,this._text,e,n)}}]),n}(Dt),Wa=function(t,e,n,i){var r,a=arguments.length,o=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,n,o):r(e,n))||o);return a>3&&o&&Object.defineProperty(e,n,o),o},Va=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t){var i;Object(g.a)(this,n),(i=e.call(this,t)).font=new Ua,i._text=new Ha({text:"",font:i.font}),i.letterSpacing=0,i.caseInsensitive=!0;var r=t.text,a=t.pos,o=t.x,s=t.y,l=t.spriteFont,u=t.font,c=t.color;i.pos=null!==a&&void 0!==a?a:o&&s?st(o,s):i.pos,i.text=null!==r&&void 0!==r?r:i.text,i.spriteFont=null!==l&&void 0!==l?l:i.spriteFont,i.font=null!==u&&void 0!==u?u:i.font,i.color=null!==c&&void 0!==c?c:i.color;var h=i.get(_i);return h.anchor=ot.Zero,h.use(i._text),i}return Object(y.a)(n,[{key:"text",get:function(){return this._text.text},set:function(t){this._text.text=t}},{key:"color",get:function(){return this._text.color},set:function(t){this._text.color=t}},{key:"opacity",get:function(){return this._text.opacity},set:function(t){this._text.opacity=t}},{key:"bold",get:function(){return this.font.bold},set:function(t){this.font.bold=t}},{key:"fontFamily",get:function(){return this.font.family},set:function(t){this.font.family=t}},{key:"fontSize",get:function(){return this.font.size},set:function(t){this.font.size=t}},{key:"fontStyle",get:function(){return this.font.style},set:function(t){this.font.style=t}},{key:"fontUnit",get:function(){return this.font.unit},set:function(t){this.font.unit=t}},{key:"textAlign",get:function(){return this.font.textAlign},set:function(t){this.font.textAlign=t}},{key:"baseAlign",get:function(){return this.font.baseAlign},set:function(t){this.font.baseAlign=t}},{key:"spriteFont",get:function(){return this._legacySpriteFont},set:function(t){if(t){if(t instanceof en)return this._legacySpriteFont=t,this._spriteFont=an.fromLegacySpriteFont(t),void(this._text.font=this._spriteFont);this._spriteFont=t,this._text.font=this._spriteFont}}},{key:"_initialize",value:function(t){Object(s.a)(Object(l.a)(n.prototype),"_initialize",this).call(this,t),this._graphicsContext=t.graphicsContext}},{key:"getTextWidth",value:function(){return this._text.width}},{key:"setTextShadow",value:function(t,e,n){this.font.shadow={offset:st(t,e),blur:2,color:n}}},{key:"useTextShadow",value:function(t){this.spriteFont&&this.spriteFont.useTextShadow(t)}},{key:"clearTextShadow",value:function(){this.font.shadow=null}},{key:"draw",value:function(t,e){var n=this._graphicsContext;this._text.draw(n,0,0)}}]),n}(Gi);Wa([rt({message:"Label.bold will be removed in v0.26.0",alternateMethod:"Use Label.font.bold"})],Va.prototype,"bold",null),Wa([rt({message:"Label.fontFamily will be removed in v0.26.0",alternateMethod:"Use Label.font.family"})],Va.prototype,"fontFamily",null),Wa([rt({message:"Label.fontSize will be removed in v0.26.0",alternateMethod:"Use Label.font.size"})],Va.prototype,"fontSize",null),Wa([rt({message:"Label.fontStyle will be removed in v0.26.0",alternateMethod:"Use Lable.font.style"})],Va.prototype,"fontStyle",null),Wa([rt({message:"Label.fontUnit will be removed in v0.26.0",alternateMethod:"Use Label.font.unit"})],Va.prototype,"fontUnit",null),Wa([rt({message:"Label.textAlign will be removed in v0.26.0",alternateMethod:"Use Label.font.textAlign"})],Va.prototype,"textAlign",null),Wa([rt({message:"Label.baseAlign will be removed in v0.26.0",alternateMethod:"Use Label.font.baseAlign"})],Va.prototype,"baseAlign",null),Wa([rt()],Va.prototype,"spriteFont",null),Wa([rt({message:"Label.setTextShadow will be removed in v0.26.0",alternateMethod:"Use Label.font.shadow"})],Va.prototype,"setTextShadow",null),Wa([rt({message:"Label.useTextShadow will be removed in v0.26.0",alternateMethod:"Use Label.font.shadow"})],Va.prototype,"useTextShadow",null),Wa([rt({message:"Label.clearTextShadow will be removed in v0.26.0",alternateMethod:"Use Label.font.shadow"})],Va.prototype,"clearTextShadow",null);var Ga=function(){function t(){Object(g.a)(this,t)}return Object(y.a)(t,null,[{key:"create",value:function(t,e){if(this._CURRENT_GROUP>this._MAX_GROUPS)throw new Error("Cannot have more than ".concat(this._MAX_GROUPS," collision groups"));if(this._GROUPS.get(t))throw new Error("Collision group ".concat(t," already exists"));var n=new In(t,this._CURRENT_BIT,void 0!==e?e:~this._CURRENT_BIT);return this._CURRENT_BIT=this._CURRENT_BIT<<1|0,this._CURRENT_GROUP++,this._GROUPS.set(t,n),n}},{key:"groups",get:function(){return Array.from(this._GROUPS.values())}},{key:"groupByName",value:function(t){return this._GROUPS.get(t)}},{key:"reset",value:function(){this._GROUPS=new Map,this._CURRENT_BIT=this._STARTING_BIT,this._CURRENT_GROUP=1}}]),t}();Ga._STARTING_BIT=1,Ga._MAX_GROUPS=32,Ga._CURRENT_GROUP=1,Ga._CURRENT_BIT=Ga._STARTING_BIT,Ga._GROUPS=new Map;var Xa=function(t,e,n,i){var r,a=arguments.length,o=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,n,o):r(e,n))||o);return a>3&&o&&Object.defineProperty(e,n,o),o},qa=function(){function t(e){Object(g.a)(this,t),this.lineWidth=5,this.filled=!1,this._points=[],this.anchor=ot.Zero,this.offset=ot.Zero,this.rotation=0,this.scale=ot.One,this.opacity=1,this._points=e;var n=this._points.reduce((function(t,e){return Math.min(t,e.x)}),0),i=this._points.reduce((function(t,e){return Math.max(t,e.x)}),0);this.drawWidth=i-n;var r=this._points.reduce((function(t,e){return Math.min(t,e.y)}),0),a=this._points.reduce((function(t,e){return Math.max(t,e.y)}),0);this.drawHeight=a-r,this.height=this.drawHeight,this.width=this.drawWidth}return Object(y.a)(t,[{key:"addEffect",value:function(){}},{key:"removeEffect",value:function(){}},{key:"clearEffects",value:function(){}},{key:"reset",value:function(){}},{key:"draw",value:function(t,e,n){t instanceof CanvasRenderingContext2D?this._drawWithOptions({ctx:t,x:e,y:n}):this._drawWithOptions(t)}},{key:"_drawWithOptions",value:function(t){var e,n,i,r,a,o,s,l,u,c=Object.assign(Object.assign({},t),{rotation:null!==(e=t.rotation)&&void 0!==e?e:this.rotation,drawWidth:null!==(n=t.drawWidth)&&void 0!==n?n:this.drawWidth,drawHeight:null!==(i=t.drawHeight)&&void 0!==i?i:this.drawHeight,flipHorizontal:null!==(r=t.flipHorizontal)&&void 0!==r?r:this.flipHorizontal,flipVertical:null!==(a=t.flipVertical)&&void 0!==a?a:this.flipVertical,anchor:null!==(o=t.anchor)&&void 0!==o?o:this.anchor,offset:null!==(s=t.offset)&&void 0!==s?s:this.offset,opacity:(null!==(l=t.opacity)&&void 0!==l?l:1)*(null!==(u=this.opacity)&&void 0!==u?u:1)}),h=c.ctx,d=c.x,f=c.y,p=c.rotation,v=c.drawWidth,g=c.drawHeight,y=c.anchor,m=c.offset,_=c.opacity,b=c.flipHorizontal,w=c.flipVertical,k=v*y.x+m.x+d,x=g*y.y+m.y+f;h.save(),h.translate(k,x),h.scale(this.scale.x,this.scale.y),h.rotate(p),h.beginPath(),h.lineWidth=this.lineWidth;var S=this._points[0];h.moveTo(S.x,S.y);for(var C=0,O=this._points.length;C<O;C++)h.lineTo(this._points[C].x,this._points[C].y);h.lineTo(S.x,S.y),h.closePath(),this.filled&&(h.fillStyle=this.fillColor.toString(),h.fill()),h.strokeStyle=this.lineColor.toString(),b&&(h.translate(v,0),h.scale(-1,1)),w&&(h.translate(0,g),h.scale(1,-1));var E=h.globalAlpha;h.globalAlpha=_,h.stroke(),h.globalAlpha=E,h.restore()}}]),t}();qa=Xa([rt({message:"Polygon will be removed in v0.26.0",alternateMethod:"Use Graphics.Polygon"})],qa);var Ka=function t(){Object(g.a)(this,t)};function Za(t){return!!t._initialize}function Qa(t){return!!t.onInitialize}function Ya(t){return!!t._preupdate}function $a(t){return!!t.onPreUpdate}function Ja(t){return!!t.onPostUpdate}function to(t){return!!t.onPostUpdate}function eo(t){return!!t.onPreDraw}function no(t){return!!t.onPostDraw}Ka.type={any:"",blob:"blob",json:"json",text:"text",document:"document",arraybuffer:"arraybuffer"};var io=function(){function t(e){Object(g.a)(this,t),this._src=e,this._volume=1,this._duration=void 0,this._loop=!1,this._isPlaying=!1,this._isPaused=!1,this._audioContext=hn.create(),this._volumeNode=this._audioContext.createGain(),this._currentOffset=0,this._createNewBufferSource()}return Object(y.a)(t,[{key:"loop",get:function(){return this._loop},set:function(t){this._loop=t,this._instance&&(this._instance.loop=t,this._wireUpOnEnded())}},{key:"volume",get:function(){return this._volume},set:function(t){t=I(t,0,1),this._volume=t,this._isPlaying&&this._volumeNode.gain.setTargetAtTime?this._volumeNode.gain.setTargetAtTime(t,this._audioContext.currentTime,.1):this._volumeNode.gain.value=t}},{key:"duration",get:function(){return this._duration},set:function(t){this._duration=t}},{key:"_playbackRate",get:function(){return this._instance?1/(this._instance.playbackRate.value||1):null}},{key:"isPlaying",value:function(){return this._isPlaying}},{key:"play",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};return this._isPaused&&(this._resumePlayBack(),t()),this._isPlaying||(this._startPlayBack(),t()),this._playingPromise}},{key:"pause",value:function(){this._isPlaying&&(this._isPaused=!0,this._isPlaying=!1,this._instance.stop(0),this._setPauseOffset())}},{key:"stop",value:function(){this._isPlaying&&(this._isPlaying=!1,this._isPaused=!1,this._currentOffset=0,this._instance.stop(0),this._instance.onended||this._handleOnEnded())}},{key:"_startPlayBack",value:function(){var t=this;this._isPlaying=!0,this._isPaused=!1,this._playingPromise=new Promise((function(e){t._playingResolve=e})),this._instance||this._createNewBufferSource(),this._rememberStartTime(),this._volumeNode.connect(this._audioContext.destination),this._instance.start(0,0),this._currentOffset=0,this._wireUpOnEnded()}},{key:"_resumePlayBack",value:function(){if(this._isPaused){this._isPaused=!1,this._isPlaying=!0,this._instance.onended=null,this._createNewBufferSource();var t=this._playbackRate*this._src.duration,e=this._currentOffset%t;this._rememberStartTime(-1e3*e),this._instance.start(0,e),this._wireUpOnEnded()}}},{key:"_wireUpOnEnded",value:function(){var t=this;this.loop||(this._instance.onended=function(){return t._handleOnEnded()})}},{key:"_handleOnEnded",value:function(){this._isPaused||(this._isPlaying=!1,this._playingResolve(!0))}},{key:"_rememberStartTime",value:function(t){this._startTime=(new Date).getTime()+(0|t)}},{key:"_setPauseOffset",value:function(){this._currentOffset=((new Date).getTime()-this._startTime)*this._playbackRate/1e3}},{key:"_createNewBufferSource",value:function(){this._instance=this._audioContext.createBufferSource(),this._instance.buffer=this._src,this._instance.loop=this.loop,this._instance.playbackRate.setValueAtTime(1,0),this._instance.connect(this._volumeNode)}}]),t}();function ro(t){try{var e=new Audio,n=t.match(/.*\.([A-Za-z0-9]+)$/)[1];return!!e.canPlayType("audio/"+n)}catch(i){return A.getInstance().warn("Cannot determine audio support, assuming no support for the Audio Tag",i),!1}}var ao=function(t,e,n,i){return new(n||(n=Promise))((function(r,a){function o(t){try{l(i.next(t))}catch(e){a(e)}}function s(t){try{l(i.throw(t))}catch(e){a(e)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}l((i=i.apply(t,e||[])).next())}))},oo=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(){var t;Object(g.a)(this,n),(t=e.call(this)).logger=A.getInstance(),t._loop=!1,t._volume=1,t._duration=void 0,t._isStopped=!1,t._isPaused=!1,t._tracks=[],t._wasPlayingOnHidden=!1,t._audioContext=hn.create(),t._resource=new Se("",Ka.type.arraybuffer);for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];for(var o=0,s=r;o<s.length;o++){var l=s[o];if(ro(l)){t.path=l;break}}return t.path||(t.logger.warn("This browser does not support any of the audio files specified:",r.join(", ")),t.logger.warn("Attempting to use",r[0]),t.path=r[0]),t}return Object(y.a)(n,[{key:"loop",get:function(){return this._loop},set:function(t){this._loop=t;var e,n=Object(f.a)(this._tracks);try{for(n.s();!(e=n.n()).done;){e.value.loop=this._loop}}catch(i){n.e(i)}finally{n.f()}this.logger.debug("Set loop for all instances of sound",this.path,"to",this._loop)}},{key:"volume",get:function(){return this._volume},set:function(t){this._volume=t;var e,n=Object(f.a)(this._tracks);try{for(n.s();!(e=n.n()).done;){e.value.volume=this._volume}}catch(i){n.e(i)}finally{n.f()}this.emit("volumechange",new za(this)),this.logger.debug("Set loop for all instances of sound",this.path,"to",this._volume)}},{key:"duration",get:function(){return this._duration}},{key:"instances",get:function(){return this._tracks}},{key:"path",get:function(){return this._resource.path},set:function(t){this._resource.path=t}},{key:"isLoaded",value:function(){return!!this.data}},{key:"load",value:function(){return ao(this,void 0,void 0,c.a.mark((function t(){var e,n;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.data){t.next=2;break}return t.abrupt("return",this.data);case 2:return t.next=4,this._resource.load();case 4:return e=t.sent,t.next=7,this.decodeAudio(e.slice(0));case 7:return n=t.sent,this._duration="object"===typeof n?n.duration:void 0,this.emit("processed",new Na(this,n)),t.abrupt("return",this.data=n);case 11:case"end":return t.stop()}}),t,this)})))}},{key:"decodeAudio",value:function(t){return ao(this,void 0,void 0,c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this._audioContext.decodeAudioData(t.slice(0));case 3:case 11:return e.abrupt("return",e.sent);case 6:return e.prev=6,e.t0=e.catch(0),this.logger.error("Unable to decode  this browser may not fully support this format, or the file may be corrupt, if this is an mp3 try removing id3 tags and album art from the file."),e.next=11,Promise.reject();case 12:case"end":return e.stop()}}),e,this,[[0,6]])})))}},{key:"wireEngine",value:function(t){var e=this;t&&(this._engine=t,this._engine.on("hidden",(function(){t.pauseAudioWhenHidden&&e.isPlaying()&&(e._wasPlayingOnHidden=!0,e.pause())})),this._engine.on("visible",(function(){t.pauseAudioWhenHidden&&e._wasPlayingOnHidden&&(e.play(),e._wasPlayingOnHidden=!1)})),this._engine.on("start",(function(){e._isStopped=!1})),this._engine.on("stop",(function(){e.stop(),e._isStopped=!0})))}},{key:"instanceCount",value:function(){return this._tracks.length}},{key:"isPlaying",value:function(){return this._tracks.some((function(t){return t.isPlaying()}))}},{key:"play",value:function(t){return this.isLoaded()?this._isStopped?(this.logger.warn("Cannot start playing. Engine is in a stopped state."),Promise.resolve(!1)):(this.volume=t||this.volume,this._isPaused?this._resumePlayback():this._startPlayback()):(this.logger.warn("Cannot start playing. Resource",this.path,"is not loaded yet"),Promise.resolve(!0))}},{key:"pause",value:function(){if(this.isPlaying()){var t,e=Object(f.a)(this._tracks);try{for(e.s();!(t=e.n()).done;){t.value.pause()}}catch(n){e.e(n)}finally{e.f()}this._isPaused=!0,this.emit("pause",new za(this)),this.logger.debug("Paused all instances of sound",this.path)}}},{key:"stop",value:function(){var t,e=Object(f.a)(this._tracks);try{for(e.s();!(t=e.n()).done;){t.value.stop()}}catch(n){e.e(n)}finally{e.f()}this.emit("stop",new za(this)),this._isPaused=!1,this._tracks.length=0,this.logger.debug("Stopped all instances of sound",this.path)}},{key:"getTrackId",value:function(t){return this._tracks.indexOf(t)}},{key:"_resumePlayback",value:function(){return ao(this,void 0,void 0,c.a.mark((function t(){var e,n,i,r;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this._isPaused){t.next=9;break}e=[],n=Object(f.a)(this._tracks);try{for(n.s();!(i=n.n()).done;)r=i.value,e.push(r.play())}catch(a){n.e(a)}finally{n.f()}return this._isPaused=!1,this.emit("resume",new za(this)),this.logger.debug("Resuming paused instances for sound",this.path,this._tracks),t.next=9,Promise.all(e);case 9:return t.abrupt("return",!0);case 10:case"end":return t.stop()}}),t,this)})))}},{key:"_startPlayback",value:function(){return ao(this,void 0,void 0,c.a.mark((function t(){var e,n,i=this;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._getTrackInstance(this.data);case 2:return e=t.sent,t.next=5,e.play((function(){i.emit("playbackstart",new za(i,e)),i.logger.debug("Playing new instance for sound",i.path)}));case 5:return n=t.sent,this.emit("playbackend",new za(this,e)),this._tracks.splice(this.getTrackId(e),1),t.abrupt("return",n);case 9:case"end":return t.stop()}}),t,this)})))}},{key:"_getTrackInstance",value:function(t){var e=new io(t);return e.loop=this.loop,e.volume=this.volume,e.duration=this.duration,this._tracks.push(e),e}}]),n}(fn),so=function(t,e,n,i){return new(n||(n=Promise))((function(r,a){function o(t){try{l(i.next(t))}catch(e){a(e)}}function s(t){try{l(i.throw(t))}catch(e){a(e)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}l((i=i.apply(t,e||[])).next())}))},lo=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ut.Magenta,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];Object(g.a)(this,t),this.path=e,this.color=n,this.bustCache=i,this._stream=null,this._gif=null,this._textures=[],this._animation=null,this._transparentColor=null,this._resource=new Se(e,"arraybuffer",i),this._transparentColor=n}return Object(y.a)(t,[{key:"load",value:function(){return so(this,void 0,void 0,c.a.mark((function t(){var e,n;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._resource.load();case 2:return e=t.sent,this._stream=new ho(e),this._gif=new po(this._stream,this._transparentColor),n=this._gif.images.map((function(t){return new Ze(t.src,!1)})),t.next=8,Promise.all(n.map((function(t){return t.load()})));case 8:return t.abrupt("return",this.data=this._textures=n);case 9:case"end":return t.stop()}}),t,this)})))}},{key:"isLoaded",value:function(){return!!this.data}},{key:"toLegacySprite",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return qe.toLegacySprite(this.toSprite(t))}},{key:"toLegacySpriteSheet",value:function(){return rn.toLegacySpriteSheet(this.toSpriteSheet())}},{key:"toLegacyAnimation",value:function(t,e){return Rr.toLegacyAnimation(t,this.toAnimation(e))}},{key:"toSprite",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=this._textures[t].toSprite();return e}},{key:"toSpriteSheet",value:function(){var t=this._textures.map((function(t){return t.toSprite()}));return new rn({sprites:t})}},{key:"toAnimation",value:function(t){var e=this.toSpriteSheet(),n=e.sprites.length;return this._animation=Rr.fromSpriteSheet(e,$(0,n),t),this._animation}},{key:"readCheckBytes",get:function(){return this._gif.checkBytes}}]),t}(),uo=function(t){return t.reduce((function(t,e){return 2*t+e}),0)},co=function(t){for(var e=[],n=7;n>=0;n--)e.push(!!(t&1<<n));return e},ho=function t(e){var n=this;if(Object(g.a)(this,t),this.data=null,this.len=0,this.position=0,this.readByte=function(){if(n.position>=n.data.byteLength)throw new Error("Attempted to read past end of stream.");return n.data[n.position++]},this.readBytes=function(t){for(var e=[],i=0;i<t;i++)e.push(n.readByte());return e},this.read=function(t){for(var e="",i=0;i<t;i++)e+=String.fromCharCode(n.readByte());return e},this.readUnsigned=function(){var t=n.readBytes(2);return(t[1]<<8)+t[0]},this.data=new Uint8Array(e),this.len=this.data.byteLength,0===this.len)throw new Error("No data loaded from file")},fo=function(t,e){for(var n,i,r=0,a=function(t){for(var n=0,i=0;i<t;i++)e.charCodeAt(r>>3)&1<<(7&r)&&(n|=1<<i),r++;return n},o=[],s=1<<t,l=s+1,u=t+1,c=[],h=function(){c=[],u=t+1;for(var e=0;e<s;e++)c[e]=[e];c[s]=[],c[l]=null};;)if(i=n,(n=a(u))!==s){if(n===l)break;if(n<c.length)i!==s&&c.push(c[i].concat(c[n][0]));else{if(n!==c.length)throw new Error("Invalid LZW code.");c.push(c[i].concat(c[i][0]))}o.push.apply(o,c[n]),c.length===1<<u&&u<12&&u++}else h();return o},po=function t(e){var n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ut.Magenta;Object(g.a)(this,t),this._st=null,this._handler={},this._transparentColor=null,this.frames=[],this.images=[],this.globalColorTable=[],this.checkBytes=[],this.parseColorTable=function(t){for(var e=[],i=0;i<t;i++){var r="#"+n._st.readBytes(3).map((function(t){var e=t.toString(16);return 1===e.length?"0"+e:e})).join("");e.push(r)}return e},this.readSubBlocks=function(){var t,e;e="";do{t=n._st.readByte(),e+=n._st.read(t)}while(0!==t);return e},this.parseHeader=function(){var t={sig:null,ver:null,width:null,height:null,colorRes:null,globalColorTableSize:null,gctFlag:null,sorted:null,globalColorTable:[],bgColor:null,pixelAspectRatio:null};if(t.sig=n._st.read(3),t.ver=n._st.read(3),"GIF"!==t.sig)throw new Error("Not a GIF file.");t.width=n._st.readUnsigned(),t.height=n._st.readUnsigned();var e=co(n._st.readByte());t.gctFlag=e.shift(),t.colorRes=uo(e.splice(0,3)),t.sorted=e.shift(),t.globalColorTableSize=uo(e.splice(0,3)),t.bgColor=n._st.readByte(),t.pixelAspectRatio=n._st.readByte(),t.gctFlag&&(t.globalColorTable=n.parseColorTable(1<<t.globalColorTableSize+1),n.globalColorTable=t.globalColorTable),n._handler.hdr&&n._handler.hdr(t)&&n.checkBytes.push(n._handler.hdr)},this.parseExt=function(t){switch(t.label=n._st.readByte(),t.label){case 249:t.extType="gce",function(t){n.checkBytes.push(n._st.readByte());var e=co(n._st.readByte());t.reserved=e.splice(0,3),t.disposalMethod=uo(e.splice(0,3)),t.userInput=e.shift(),t.transparencyGiven=e.shift(),t.delayTime=n._st.readUnsigned(),t.transparencyIndex=n._st.readByte(),t.terminator=n._st.readByte(),n._handler.gce&&n._handler.gce(t)&&n.checkBytes.push(n._handler.gce)}(t);break;case 254:t.extType="com",function(t){t.comment=n.readSubBlocks(),n._handler.com&&n._handler.com(t)&&n.checkBytes.push(n._handler.com)}(t);break;case 1:t.extType="pte",function(t){n.checkBytes.push(n._st.readByte()),t.ptHeader=n._st.readBytes(12),t.ptData=n.readSubBlocks(),n._handler.pte&&n._handler.pte(t)&&n.checkBytes.push(n._handler.pte)}(t);break;case 255:t.extType="app",function(t){n.checkBytes.push(n._st.readByte()),t.identifier=n._st.read(8),t.authCode=n._st.read(3),"NETSCAPE"===t.identifier?function(t){n.checkBytes.push(n._st.readByte()),t.unknown=n._st.readByte(),t.iterations=n._st.readUnsigned(),t.terminator=n._st.readByte(),n._handler.app&&n._handler.app.NETSCAPE&&n._handler.app.NETSCAPE(t)&&n.checkBytes.push(n._handler.app)}(t):function(t){t.appData=n.readSubBlocks(),n._handler.app&&n._handler.app[t.identifier]&&n._handler.app[t.identifier](t)&&n.checkBytes.push(n._handler.app[t.identifier])}(t)}(t);break;default:t.extType="unknown",function(t){t.data=n.readSubBlocks(),n._handler.unknown&&n._handler.unknown(t)&&n.checkBytes.push(n._handler.unknown)}(t)}},this.parseImg=function(t){t.leftPos=n._st.readUnsigned(),t.topPos=n._st.readUnsigned(),t.width=n._st.readUnsigned(),t.height=n._st.readUnsigned();var e=co(n._st.readByte());t.lctFlag=e.shift(),t.interlaced=e.shift(),t.sorted=e.shift(),t.reserved=e.splice(0,2),t.lctSize=uo(e.splice(0,3)),t.lctFlag&&(t.lct=n.parseColorTable(1<<t.lctSize+1)),t.lzwMinCodeSize=n._st.readByte();var i=n.readSubBlocks();t.pixels=fo(t.lzwMinCodeSize,i),t.interlaced&&(t.pixels=function(t,e){for(var n=new Array(t.length),i=t.length/e,r=function(i,r){var a=t.slice(r*e,(r+1)*e);n.splice.apply(n,[i*e,e].concat(a))},a=[0,4,2,1],o=[8,8,4,2],s=0,l=0;l<4;l++)for(var u=a[l];u<i;u+=o[l])r(u,s),s++;return n}(t.pixels,t.width)),n.frames.push(t),n.arrayToImage(t),n._handler.img&&n._handler.img(t)&&n.checkBytes.push(n._handler)},this.parseBlock=function(){var t={sentinel:n._st.readByte(),type:""};switch(String.fromCharCode(t.sentinel)){case"!":t.type="ext",n.parseExt(t);break;case",":t.type="img",n.parseImg(t);break;case";":t.type="eof",n._handler.eof&&n._handler.eof(t)&&n.checkBytes.push(n._handler.eof);break;default:throw new Error("Unknown block: 0x"+t.sentinel.toString(16))}"eof"!==t.type&&n.parseBlock()},this.arrayToImage=function(t){var e=0,i=document.createElement("canvas");i.id=e.toString(),i.width=t.width,i.height=t.height,e++;for(var r=i.getContext("2d"),a=0,o=0,s=0;s<t.pixels.length;s++)o%t.width===0&&(a++,o=0),n.globalColorTable[t.pixels[s]]===n._transparentColor.toHex()?r.fillStyle="rgba(0, 0, 0, 0)":r.fillStyle=n.globalColorTable[t.pixels[s]],r.fillRect(o,a,1,1),o++;var l=new Image;l.src=i.toDataURL(),n.images.push(l)},this._st=e,this._handler={},this._transparentColor=i,this.parseHeader(),this.parseBlock()},vo=function(t){Object(p.a)(n,t);var e=Object(v.a)(n);function n(t){var i;return Object(g.a)(this,n),(i=e.call(this,t)).points=t.points,i.rasterize(),i}return Object(y.a)(n,[{key:"points",get:function(){return this._points},set:function(t){this._points=t;var e=this.minPoint;this.width=this._points.reduce((function(t,e){return Math.max(e.x,t)}),0)-e.x,this.height=this._points.reduce((function(t,e){return Math.max(e.y,t)}),0)-e.y,this.flagDirty()}},{key:"minPoint",get:function(){return st(this._points.reduce((function(t,e){return Math.min(e.x,t)}),1/0),this._points.reduce((function(t,e){return Math.min(e.y,t)}),1/0))}},{key:"clone",value:function(){return new n(Object.assign(Object.assign({points:this.points.map((function(t){return t.clone()}))},this.cloneGraphicOptions()),this.cloneRasterOptions()))}},{key:"execute",value:function(t){if(this.points&&this.points.length){t.beginPath();var e=this.minPoint.negate(),n=this.points[0].add(e);t.moveTo(n.x,n.y),this.points.forEach((function(n){t.lineTo(n.x+e.x,n.y+e.y)})),t.lineTo(n.x,n.y),t.closePath(),this.color&&t.fill(),this.strokeColor&&t.stroke()}}}]),n}(It),go=function(t,e,n,i){var r,a=arguments.length,o=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,n,o):r(e,n))||o);return a>3&&o&&Object.defineProperty(e,n,o),o},yo=function(){function t(e){Object(g.a)(this,t),this._getComparable=e}return Object(y.a)(t,[{key:"find",value:function(t){return this._find(this._root,t)}},{key:"_find",value:function(t,e){return null!=t&&(this._getComparable(e)===t.getKey()?t.getData().indexOf(e)>-1:this._getComparable(e)<t.getKey()?this._find(t.getLeft(),e):this._find(t.getRight(),e))}},{key:"get",value:function(t){return this._get(this._root,t)}},{key:"_get",value:function(t,e){return null==t?[]:e===t.getKey()?t.getData():e<t.getKey()?this._get(t.getLeft(),e):this._get(t.getRight(),e)}},{key:"add",value:function(t){return null==this._root?(this._root=new mo(this._getComparable(t),[t],null,null),!0):this._insert(this._root,t)}},{key:"_insert",value:function(t,e){return null!=t&&(this._getComparable(e)===t.getKey()?!(t.getData().indexOf(e)>-1)&&(t.getData().push(e),!0):this._getComparable(e)<t.getKey()?null==t.getLeft()?(t.setLeft(new mo(this._getComparable(e),[e],null,null)),!0):this._insert(t.getLeft(),e):null==t.getRight()?(t.setRight(new mo(this._getComparable(e),[e],null,null)),!0):this._insert(t.getRight(),e))}},{key:"removeByComparable",value:function(t){this._root=this._remove(this._root,t)}},{key:"_remove",value:function(t,e){if(null==t)return null;if(this._getComparable(e)!==t.getKey())return this._getComparable(e)<t.getKey()?(t.setLeft(this._remove(t.getLeft(),e)),t):(t.setRight(this._remove(t.getRight(),e)),t);var n=t.getData().indexOf(e);if(n>-1){if(t.getData().splice(n,1),0===t.getData().length){if(null==t.getLeft()&&null==t.getRight())return null;if(null==t.getLeft())return t.getRight();if(null==t.getRight())return t.getLeft();var i=this._findMinNode(t.getRight());return t.setKey(i.getKey()),t.setData(i.getData()),t.setRight(this._cleanup(t.getRight(),i)),t}return t}return null}},{key:"_cleanup",value:function(t,e){var n=e.getKey();if(null==t)return null;if(n===t.getKey()){if(null==t.getLeft()&&null==t.getRight())return null;if(null==t.getLeft())return t.getRight();if(null==t.getRight())return t.getLeft();var i=this._findMinNode(t.getRight());return t.setKey(i.getKey()),t.setData(i.getData()),t.setRight(this._cleanup(t.getRight(),i)),t}return e.getKey()<t.getKey()?(t.setLeft(this._cleanup(t.getLeft(),e)),t):(t.setRight(this._cleanup(t.getRight(),e)),t)}},{key:"_findMinNode",value:function(t){for(var e=t;null!=e.getLeft();)e=e.getLeft();return e}},{key:"list",value:function(){var t=new Array;return this._list(this._root,t),t}},{key:"_list",value:function(t,e){null!=t&&(this._list(t.getLeft(),e),t.getData().forEach((function(t){e.push(t)})),this._list(t.getRight(),e))}}]),t}();yo=go([rt({message:"Will be removed in excalibur v0.26.0",alternateMethod:"Use built in JS array.sort"})],yo);var mo=function(){function t(e,n,i,r){Object(g.a)(this,t),this._key=e,this._data=n,this._left=i,this._right=r}return Object(y.a)(t,[{key:"getKey",value:function(){return this._key}},{key:"setKey",value:function(t){this._key=t}},{key:"getData",value:function(){return this._data}},{key:"setData",value:function(t){this._data=t}},{key:"getLeft",value:function(){return this._left}},{key:"setLeft",value:function(t){this._left=t}},{key:"getRight",value:function(){return this._right}},{key:"setRight",value:function(t){this._right=t}}]),t}();mo=go([rt({message:"Will be removed in excalibur v0.26.0"})],mo);var _o,bo,wo=function(){function t(e){Object(g.a)(this,t),this._key=0,this._key=e}return Object(y.a)(t,[{key:"getTheKey",value:function(){return this._key}},{key:"setKey",value:function(t){this._key=t}}]),t}(),ko=function(t,e,n,i){var r,a=arguments.length,o=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,n,o):r(e,n))||o);return a>3&&o&&Object.defineProperty(e,n,o),o};!function(t){t[t.Resolved=0]="Resolved",t[t.Rejected=1]="Rejected",t[t.Pending=2]="Pending"}(bo||(bo={}));var xo=_o=function(){function t(){Object(g.a)(this,t),this._state=bo.Pending,this._successCallbacks=[],this._rejectCallback=function(){}}return Object(y.a)(t,[{key:"then",value:function(t,e){if(t&&(this._successCallbacks.push(t),this.state()===bo.Resolved))try{t.call(this,this._value)}catch(n){this._handleError(n)}if(e&&(this._rejectCallback=e,this.state()===bo.Rejected))try{e.call(this,this._value)}catch(n){this._handleError(n)}return this}},{key:"error",value:function(t){return t&&(this._errorCallback=t),this}},{key:"resolve",value:function(t){var e=this;if(this._state!==bo.Pending)throw new Error("Cannot resolve a promise that is not in a pending state!");this._value=t;try{this._state=bo.Resolved,this._successCallbacks.forEach((function(t){t.call(e,e._value)}))}catch(n){this._handleError(n)}return this}},{key:"reject",value:function(t){if(this._state!==bo.Pending)throw new Error("Cannot reject a promise that is not in a pending state!");this._value=t;try{this._state=bo.Rejected,this._rejectCallback.call(this,this._value)}catch(e){this._handleError(e)}return this}},{key:"state",value:function(){return this._state}},{key:"_handleError",value:function(t){if(!this._errorCallback)throw t;this._errorCallback.call(this,t)}}],[{key:"resolve",value:function(t){return(new _o).resolve(t)}},{key:"reject",value:function(t){return(new _o).reject(t)}},{key:"join",value:function(){var t=[];if(arguments.length>0&&!Array.isArray(arguments[0]))for(var e=0;e<arguments.length;e++)t[e-0]=arguments[e];else 1===arguments.length&&Array.isArray(arguments[0])&&(t=arguments[0]);var n=new _o;if(!t||!t.length)return n.resolve();var i=t.length,r=0,a=0,o=[];return t.forEach((function(t){t.then((function(){(r+=1)===i?n.resolve():r+a+o.length===i&&n.reject(o)}),(function(){r+(a+=1)+o.length===i&&n.reject(o)})).error((function(t){o.push(t),o.length+r+a===i&&n.reject(o)}))})),n}}]),t}();xo=_o=ko([rt({message:"ex.Promises are being replaced by native browser promises in v0.26.0",alternateMethod:"Use browser native promises"})],xo);var So="0.25.1";x()}();e.fWn,e.Ia8,e.hLI,e.yyv,e.tX5;var b=e.vtX,w=(e.r7K,e.lCh,e.fwF),k=(e.sce,e._c7,e.KUs,e.Ajp,e.RDh,e._H9,e.Ulf,e.mxs,e.OmD,e.kBf,e.C4F,e.NQt,e.JjN,e.V1s,e.Xz7,e.bLd,e.Cdc,e.FKn,e.wTW,e.ab2,e.GfZ,e.YMS,e.oyv,e.aUb,e.SdD,e.JUv,e.jEj,e.TFq,e.HDU,e.R_y,e.ydN,e._N2,e.t50,e.s$$,e.v2G),x=e.Ilk,S=(e.H_9,e.s9i,e.ksl,e.wA2,e.R_p,e.IQ$,e.I5F,e.X8$,e.FR6,e.U8o,e.kbG,e.oeJ,e.iS_,e.cGG,e.skb,e.SLU,e.RdJ,e.gU7,e.LSk,e.Nmp,e.d1Y,e.xrL,e.sRW,e.cmV,e.N0Q,e.q8b,e.ynB,e.jT9,e.wAz,e.D4V),C=(e.N6H,e.W1A,e.JHW,e.v2K,e.pBf,e.GMl,e.zW2,e.B0K,e.Nv7,e.C_p,e.MUA,e.xqU,e.peG,e.pTp,e.vUK,e.j9l,e.Zxw,e.Hdx,e.Z$d,e.o$7,e.Zm$,e.$QH,e.i78,e.h6u,e.hts,e.j88,e.VME,e.nt,e.Ukr,e.zsu,e.oA6,e.TVh,e.TwZ,e.GTT,e.xxj,e.XdK,e.cXo),O=(e.Dm5,e.IIB),E=(e.zI0,e.SKZ,e.__J,e.Dvr,e.Tf9,e.RI$,e.x12,e.aNw),A=(e.xwn,e.dNK,e.ini,e.YdH,e.y3G,e.l57,e.xn0,e.t2V,e.ZyS,e.uxB,e.cpd,e.fiy,e.$XZ,e.uqK,e.STE,e.y$z,e.sOq,e.Sqs,e.hpZ,e.Vol,e.wIZ),P=(e.cBi,e.mgq,e.YVA,e.Kgp,e.HH$,e.M_d,e.rgh,e.Ra6,e.KhR,e.BS5,e.xhz,e.xOq,e.a9j,e.bHk,e.CgK,e.cuY,e.kvE,e.JDb,e.Cbi,e.AE_,e.ctO,e.OLH,e.kky,e.nSF,e.zHn,e.zwx,e.AeJ,e.hLz,e.D9g,e.wA,e.jhr,e.GVs,e._zO,e.w6$,e.mhV,e.MOD,e.kwd,e.Lmr,e.xsS),j=(e.lLr,e.Z$r,e.IXb,e.SMj,e.bnF),T=e.MFA,R=(e.$XC,e.$uU),D=(e.jyi,e.E03,e.V6q),M=(e.nVo,e.F6N,e.ad3,e.xP7,e.Odq,e.Zif,e.ZGJ,e.xvT,e.PHM,e.KwO,e.B7y,e.SFp,e.Uvn,e.OFT,e.xzN),L=(e.H6j,e.ZrN,e.OWs),B=(e.dF9,e.VHo,e.R$E,e.q3I,e.Pab,e.uZ5,e.McK,e.k0b,e.hnT,e.RSJ,e.Mku,e.h90,e.rms,e.ErP,e.aVg,e.lPc,e.Z8E,e.NNA,e.yFn,e.lNv,e.MZQ,e.FUM,e.vdf,e.iaL,e.w6H,e.Q4c,e.Uxb,e.Yr5,e.Bhw)},function(t,e,n){"use strict";t.exports=n(38)},function(t,e,n){"use strict";function i(t){return i=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},i(t)}n.d(e,"a",(function(){return i}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var i=n(7);function r(t,e,n){return r="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Object(i.a)(t)););return t}(t,e);if(r){var a=Object.getOwnPropertyDescriptor(r,e);return a.get?a.get.call(n):a.value}},r(t,e,n||t)}},function(t,e,n){t.exports=n(26)},function(t,e,n){"use strict";t.exports=n(21)},function(t,e,n){"use strict";function i(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}n.d(e,"a",(function(){return i}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var i=n(13);function r(t,e){if(t){if("string"===typeof t)return Object(i.a)(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Object(i.a)(t,e):void 0}}},function(t,e,n){"use strict";function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}n.d(e,"a",(function(){return i}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var i=n(16);function r(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function a(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?r(Object(n),!0).forEach((function(e){Object(i.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}},function(t,e,n){"use strict";function i(t,e,n,i,r,a,o){try{var s=t[a](o),l=s.value}catch(u){return void n(u)}s.done?e(l):Promise.resolve(l).then(i,r)}function r(t){return function(){var e=this,n=arguments;return new Promise((function(r,a){var o=t.apply(e,n);function s(t){i(o,r,a,s,l,"next",t)}function l(t){i(o,r,a,s,l,"throw",t)}s(void 0)}))}}n.d(e,"a",(function(){return r}))},function(t,e,n){"use strict";function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}n.d(e,"a",(function(){return i}))},function(t,e,n){"use strict";function i(t){return i="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}n.d(e,"a",(function(){return a}));var r=n(11);function a(t,e){return!e||"object"!==i(e)&&"function"!==typeof e?Object(r.a)(t):e}},function(t,e,n){"use strict";var i=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable;function o(t){if(null===t||void 0===t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}t.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(e).map((function(t){return e[t]})).join(""))return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach((function(t){i[t]=t})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},i)).join("")}catch(r){return!1}}()?Object.assign:function(t,e){for(var n,s,l=o(t),u=1;u<arguments.length;u++){for(var c in n=Object(arguments[u]))r.call(n,c)&&(l[c]=n[c]);if(i){s=i(n);for(var h=0;h<s.length;h++)a.call(n,s[h])&&(l[s[h]]=n[s[h]])}}return l}},,function(t,e,n){"use strict";!function t(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}(),t.exports=n(22)},function(t,e,n){"use strict";var i=n(18),r=60103,a=60106;e.Fragment=60107,e.StrictMode=60108,e.Profiler=60114;var o=60109,s=60110,l=60112;e.Suspense=60113;var u=60115,c=60116;if("function"===typeof Symbol&&Symbol.for){var h=Symbol.for;r=h("react.element"),a=h("react.portal"),e.Fragment=h("react.fragment"),e.StrictMode=h("react.strict_mode"),e.Profiler=h("react.profiler"),o=h("react.provider"),s=h("react.context"),l=h("react.forward_ref"),e.Suspense=h("react.suspense"),u=h("react.memo"),c=h("react.lazy")}var d="function"===typeof Symbol&&Symbol.iterator;function f(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v={};function g(t,e,n){this.props=t,this.context=e,this.refs=v,this.updater=n||p}function y(){}function m(t,e,n){this.props=t,this.context=e,this.refs=v,this.updater=n||p}g.prototype.isReactComponent={},g.prototype.setState=function(t,e){if("object"!==typeof t&&"function"!==typeof t&&null!=t)throw Error(f(85));this.updater.enqueueSetState(this,t,e,"setState")},g.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")},y.prototype=g.prototype;var _=m.prototype=new y;_.constructor=m,i(_,g.prototype),_.isPureReactComponent=!0;var b={current:null},w=Object.prototype.hasOwnProperty,k={key:!0,ref:!0,__self:!0,__source:!0};function x(t,e,n){var i,a={},o=null,s=null;if(null!=e)for(i in void 0!==e.ref&&(s=e.ref),void 0!==e.key&&(o=""+e.key),e)w.call(e,i)&&!k.hasOwnProperty(i)&&(a[i]=e[i]);var l=arguments.length-2;if(1===l)a.children=n;else if(1<l){for(var u=Array(l),c=0;c<l;c++)u[c]=arguments[c+2];a.children=u}if(t&&t.defaultProps)for(i in l=t.defaultProps)void 0===a[i]&&(a[i]=l[i]);return{$$typeof:r,type:t,key:o,ref:s,props:a,_owner:b.current}}function S(t){return"object"===typeof t&&null!==t&&t.$$typeof===r}var C=/\/+/g;function O(t,e){return"object"===typeof t&&null!==t&&null!=t.key?function(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,(function(t){return e[t]}))}(""+t.key):e.toString(36)}function E(t,e,n,i,o){var s=typeof t;"undefined"!==s&&"boolean"!==s||(t=null);var l=!1;if(null===t)l=!0;else switch(s){case"string":case"number":l=!0;break;case"object":switch(t.$$typeof){case r:case a:l=!0}}if(l)return o=o(l=t),t=""===i?"."+O(l,0):i,Array.isArray(o)?(n="",null!=t&&(n=t.replace(C,"$&/")+"/"),E(o,e,n,"",(function(t){return t}))):null!=o&&(S(o)&&(o=function(t,e){return{$$typeof:r,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}(o,n+(!o.key||l&&l.key===o.key?"":(""+o.key).replace(C,"$&/")+"/")+t)),e.push(o)),1;if(l=0,i=""===i?".":i+":",Array.isArray(t))for(var u=0;u<t.length;u++){var c=i+O(s=t[u],u);l+=E(s,e,n,c,o)}else if(c=function(t){return null===t||"object"!==typeof t?null:"function"===typeof(t=d&&t[d]||t["@@iterator"])?t:null}(t),"function"===typeof c)for(t=c.call(t),u=0;!(s=t.next()).done;)l+=E(s=s.value,e,n,c=i+O(s,u++),o);else if("object"===s)throw e=""+t,Error(f(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e));return l}function A(t,e,n){if(null==t)return t;var i=[],r=0;return E(t,i,"","",(function(t){return e.call(n,t,r++)})),i}function P(t){if(-1===t._status){var e=t._result;e=e(),t._status=0,t._result=e,e.then((function(e){0===t._status&&(e=e.default,t._status=1,t._result=e)}),(function(e){0===t._status&&(t._status=2,t._result=e)}))}if(1===t._status)return t._result;throw t._result}var j={current:null};function T(){var t=j.current;if(null===t)throw Error(f(321));return t}var R={ReactCurrentDispatcher:j,ReactCurrentBatchConfig:{transition:0},ReactCurrentOwner:b,IsSomeRendererActing:{current:!1},assign:i};e.Children={map:A,forEach:function(t,e,n){A(t,(function(){e.apply(this,arguments)}),n)},count:function(t){var e=0;return A(t,(function(){e++})),e},toArray:function(t){return A(t,(function(t){return t}))||[]},only:function(t){if(!S(t))throw Error(f(143));return t}},e.Component=g,e.PureComponent=m,e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=R,e.cloneElement=function(t,e,n){if(null===t||void 0===t)throw Error(f(267,t));var a=i({},t.props),o=t.key,s=t.ref,l=t._owner;if(null!=e){if(void 0!==e.ref&&(s=e.ref,l=b.current),void 0!==e.key&&(o=""+e.key),t.type&&t.type.defaultProps)var u=t.type.defaultProps;for(c in e)w.call(e,c)&&!k.hasOwnProperty(c)&&(a[c]=void 0===e[c]&&void 0!==u?u[c]:e[c])}var c=arguments.length-2;if(1===c)a.children=n;else if(1<c){u=Array(c);for(var h=0;h<c;h++)u[h]=arguments[h+2];a.children=u}return{$$typeof:r,type:t.type,key:o,ref:s,props:a,_owner:l}},e.createContext=function(t,e){return void 0===e&&(e=null),(t={$$typeof:s,_calculateChangedBits:e,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:o,_context:t},t.Consumer=t},e.createElement=x,e.createFactory=function(t){var e=x.bind(null,t);return e.type=t,e},e.createRef=function(){return{current:null}},e.forwardRef=function(t){return{$$typeof:l,render:t}},e.isValidElement=S,e.lazy=function(t){return{$$typeof:c,_payload:{_status:-1,_result:t},_init:P}},e.memo=function(t,e){return{$$typeof:u,type:t,compare:void 0===e?null:e}},e.useCallback=function(t,e){return T().useCallback(t,e)},e.useContext=function(t,e){return T().useContext(t,e)},e.useDebugValue=function(){},e.useEffect=function(t,e){return T().useEffect(t,e)},e.useImperativeHandle=function(t,e,n){return T().useImperativeHandle(t,e,n)},e.useLayoutEffect=function(t,e){return T().useLayoutEffect(t,e)},e.useMemo=function(t,e){return T().useMemo(t,e)},e.useReducer=function(t,e,n){return T().useReducer(t,e,n)},e.useRef=function(t){return T().useRef(t)},e.useState=function(t){return T().useState(t)},e.version="17.0.2"},function(t,e,n){"use strict";var i=n(10),r=n(18),a=n(23);function o(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}if(!i)throw Error(o(227));var s=new Set,l={};function u(t,e){c(t,e),c(t+"Capture",e)}function c(t,e){for(l[t]=e,t=0;t<e.length;t++)s.add(e[t])}var h=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f=Object.prototype.hasOwnProperty,p={},v={};function g(t,e,n,i,r,a,o){this.acceptsBooleans=2===e||3===e||4===e,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=a,this.removeEmptyString=o}var y={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(t){y[t]=new g(t,0,!1,t,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(t){var e=t[0];y[e]=new g(e,1,!1,t[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(t){y[t]=new g(t,2,!1,t.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(t){y[t]=new g(t,2,!1,t,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(t){y[t]=new g(t,3,!1,t.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(t){y[t]=new g(t,3,!0,t,null,!1,!1)})),["capture","download"].forEach((function(t){y[t]=new g(t,4,!1,t,null,!1,!1)})),["cols","rows","size","span"].forEach((function(t){y[t]=new g(t,6,!1,t,null,!1,!1)})),["rowSpan","start"].forEach((function(t){y[t]=new g(t,5,!1,t.toLowerCase(),null,!1,!1)}));var m=/[\-:]([a-z])/g;function _(t){return t[1].toUpperCase()}function b(t,e,n,i){var r=y.hasOwnProperty(e)?y[e]:null;(null!==r?0===r.type:!i&&(2<e.length&&("o"===e[0]||"O"===e[0])&&("n"===e[1]||"N"===e[1])))||(function(t,e,n,i){if(null===e||"undefined"===typeof e||function(t,e,n,i){if(null!==n&&0===n.type)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return!i&&(null!==n?!n.acceptsBooleans:"data-"!==(t=t.toLowerCase().slice(0,5))&&"aria-"!==t);default:return!1}}(t,e,n,i))return!0;if(i)return!1;if(null!==n)switch(n.type){case 3:return!e;case 4:return!1===e;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}(e,n,r,i)&&(n=null),i||null===r?function(t){return!!f.call(v,t)||!f.call(p,t)&&(d.test(t)?v[t]=!0:(p[t]=!0,!1))}(e)&&(null===n?t.removeAttribute(e):t.setAttribute(e,""+n)):r.mustUseProperty?t[r.propertyName]=null===n?3!==r.type&&"":n:(e=r.attributeName,i=r.attributeNamespace,null===n?t.removeAttribute(e):(n=3===(r=r.type)||4===r&&!0===n?"":""+n,i?t.setAttributeNS(i,e,n):t.setAttribute(e,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(t){var e=t.replace(m,_);y[e]=new g(e,1,!1,t,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(t){var e=t.replace(m,_);y[e]=new g(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(t){var e=t.replace(m,_);y[e]=new g(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(t){y[t]=new g(t,1,!1,t.toLowerCase(),null,!1,!1)})),y.xlinkHref=new g("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(t){y[t]=new g(t,1,!1,t.toLowerCase(),null,!0,!0)}));var w=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,k=60103,x=60106,S=60107,C=60108,O=60114,E=60109,A=60110,P=60112,j=60113,T=60120,R=60115,D=60116,M=60121,L=60128,B=60129,F=60130,I=60131;if("function"===typeof Symbol&&Symbol.for){var z=Symbol.for;k=z("react.element"),x=z("react.portal"),S=z("react.fragment"),C=z("react.strict_mode"),O=z("react.profiler"),E=z("react.provider"),A=z("react.context"),P=z("react.forward_ref"),j=z("react.suspense"),T=z("react.suspense_list"),R=z("react.memo"),D=z("react.lazy"),M=z("react.block"),z("react.scope"),L=z("react.opaque.id"),B=z("react.debug_trace_mode"),F=z("react.offscreen"),I=z("react.legacy_hidden")}var N,U="function"===typeof Symbol&&Symbol.iterator;function H(t){return null===t||"object"!==typeof t?null:"function"===typeof(t=U&&t[U]||t["@@iterator"])?t:null}function W(t){if(void 0===N)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);N=e&&e[1]||""}return"\n"+N+t}var V=!1;function G(t,e){if(!t||V)return"";V=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(e,[])}catch(l){var i=l}Reflect.construct(t,[],e)}else{try{e.call()}catch(l){i=l}t.call(e.prototype)}else{try{throw Error()}catch(l){i=l}t()}}catch(l){if(l&&i&&"string"===typeof l.stack){for(var r=l.stack.split("\n"),a=i.stack.split("\n"),o=r.length-1,s=a.length-1;1<=o&&0<=s&&r[o]!==a[s];)s--;for(;1<=o&&0<=s;o--,s--)if(r[o]!==a[s]){if(1!==o||1!==s)do{if(o--,0>--s||r[o]!==a[s])return"\n"+r[o].replace(" at new "," at ")}while(1<=o&&0<=s);break}}}finally{V=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?W(t):""}function X(t){switch(t.tag){case 5:return W(t.type);case 16:return W("Lazy");case 13:return W("Suspense");case 19:return W("SuspenseList");case 0:case 2:case 15:return t=G(t.type,!1);case 11:return t=G(t.type.render,!1);case 22:return t=G(t.type._render,!1);case 1:return t=G(t.type,!0);default:return""}}function q(t){if(null==t)return null;if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t;switch(t){case S:return"Fragment";case x:return"Portal";case O:return"Profiler";case C:return"StrictMode";case j:return"Suspense";case T:return"SuspenseList"}if("object"===typeof t)switch(t.$$typeof){case A:return(t.displayName||"Context")+".Consumer";case E:return(t._context.displayName||"Context")+".Provider";case P:var e=t.render;return e=e.displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case R:return q(t.type);case M:return q(t._render);case D:e=t._payload,t=t._init;try{return q(t(e))}catch(n){}}return null}function K(t){switch(typeof t){case"boolean":case"number":case"object":case"string":case"undefined":return t;default:return""}}function Z(t){var e=t.type;return(t=t.nodeName)&&"input"===t.toLowerCase()&&("checkbox"===e||"radio"===e)}function Q(t){t._valueTracker||(t._valueTracker=function(t){var e=Z(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),i=""+t[e];if(!t.hasOwnProperty(e)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var r=n.get,a=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return r.call(this)},set:function(t){i=""+t,a.call(this,t)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(t){i=""+t},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}(t))}function Y(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),i="";return t&&(i=Z(t)?t.checked?"true":"false":t.value),(t=i)!==n&&(e.setValue(t),!0)}function $(t){if("undefined"===typeof(t=t||("undefined"!==typeof document?document:void 0)))return null;try{return t.activeElement||t.body}catch(e){return t.body}}function J(t,e){var n=e.checked;return r({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:t._wrapperState.initialChecked})}function tt(t,e){var n=null==e.defaultValue?"":e.defaultValue,i=null!=e.checked?e.checked:e.defaultChecked;n=K(null!=e.value?e.value:n),t._wrapperState={initialChecked:i,initialValue:n,controlled:"checkbox"===e.type||"radio"===e.type?null!=e.checked:null!=e.value}}function et(t,e){null!=(e=e.checked)&&b(t,"checked",e,!1)}function nt(t,e){et(t,e);var n=K(e.value),i=e.type;if(null!=n)"number"===i?(0===n&&""===t.value||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if("submit"===i||"reset"===i)return void t.removeAttribute("value");e.hasOwnProperty("value")?rt(t,e.type,n):e.hasOwnProperty("defaultValue")&&rt(t,e.type,K(e.defaultValue)),null==e.checked&&null!=e.defaultChecked&&(t.defaultChecked=!!e.defaultChecked)}function it(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var i=e.type;if(!("submit"!==i&&"reset"!==i||void 0!==e.value&&null!==e.value))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}""!==(n=t.name)&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,""!==n&&(t.name=n)}function rt(t,e,n){"number"===e&&$(t.ownerDocument)===t||(null==n?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}function at(t,e){return t=r({children:void 0},e),(e=function(t){var e="";return i.Children.forEach(t,(function(t){null!=t&&(e+=t)})),e}(e.children))&&(t.children=e),t}function ot(t,e,n,i){if(t=t.options,e){e={};for(var r=0;r<n.length;r++)e["$"+n[r]]=!0;for(n=0;n<t.length;n++)r=e.hasOwnProperty("$"+t[n].value),t[n].selected!==r&&(t[n].selected=r),r&&i&&(t[n].defaultSelected=!0)}else{for(n=""+K(n),e=null,r=0;r<t.length;r++){if(t[r].value===n)return t[r].selected=!0,void(i&&(t[r].defaultSelected=!0));null!==e||t[r].disabled||(e=t[r])}null!==e&&(e.selected=!0)}}function st(t,e){if(null!=e.dangerouslySetInnerHTML)throw Error(o(91));return r({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function lt(t,e){var n=e.value;if(null==n){if(n=e.children,e=e.defaultValue,null!=n){if(null!=e)throw Error(o(92));if(Array.isArray(n)){if(!(1>=n.length))throw Error(o(93));n=n[0]}e=n}null==e&&(e=""),n=e}t._wrapperState={initialValue:K(n)}}function ut(t,e){var n=K(e.value),i=K(e.defaultValue);null!=n&&((n=""+n)!==t.value&&(t.value=n),null==e.defaultValue&&t.defaultValue!==n&&(t.defaultValue=n)),null!=i&&(t.defaultValue=""+i)}function ct(t){var e=t.textContent;e===t._wrapperState.initialValue&&""!==e&&null!==e&&(t.value=e)}var ht="http://www.w3.org/1999/xhtml",dt="http://www.w3.org/2000/svg";function ft(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function pt(t,e){return null==t||"http://www.w3.org/1999/xhtml"===t?ft(e):"http://www.w3.org/2000/svg"===t&&"foreignObject"===e?"http://www.w3.org/1999/xhtml":t}var vt,gt,yt=(gt=function(t,e){if(t.namespaceURI!==dt||"innerHTML"in t)t.innerHTML=e;else{for((vt=vt||document.createElement("div")).innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=vt.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(t,e,n,i){MSApp.execUnsafeLocalFunction((function(){return gt(t,e)}))}:gt);function mt(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&3===n.nodeType)return void(n.nodeValue=e)}t.textContent=e}var _t={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},bt=["Webkit","ms","Moz","O"];function wt(t,e,n){return null==e||"boolean"===typeof e||""===e?"":n||"number"!==typeof e||0===e||_t.hasOwnProperty(t)&&_t[t]?(""+e).trim():e+"px"}function kt(t,e){for(var n in t=t.style,e)if(e.hasOwnProperty(n)){var i=0===n.indexOf("--"),r=wt(n,e[n],i);"float"===n&&(n="cssFloat"),i?t.setProperty(n,r):t[n]=r}}Object.keys(_t).forEach((function(t){bt.forEach((function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),_t[e]=_t[t]}))}));var xt=r({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function St(t,e){if(e){if(xt[t]&&(null!=e.children||null!=e.dangerouslySetInnerHTML))throw Error(o(137,t));if(null!=e.dangerouslySetInnerHTML){if(null!=e.children)throw Error(o(60));if("object"!==typeof e.dangerouslySetInnerHTML||!("__html"in e.dangerouslySetInnerHTML))throw Error(o(61))}if(null!=e.style&&"object"!==typeof e.style)throw Error(o(62))}}function Ct(t,e){if(-1===t.indexOf("-"))return"string"===typeof e.is;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}function Ot(t){return(t=t.target||t.srcElement||window).correspondingUseElement&&(t=t.correspondingUseElement),3===t.nodeType?t.parentNode:t}var Et=null,At=null,Pt=null;function jt(t){if(t=ir(t)){if("function"!==typeof Et)throw Error(o(280));var e=t.stateNode;e&&(e=ar(e),Et(t.stateNode,t.type,e))}}function Tt(t){At?Pt?Pt.push(t):Pt=[t]:At=t}function Rt(){if(At){var t=At,e=Pt;if(Pt=At=null,jt(t),e)for(t=0;t<e.length;t++)jt(e[t])}}function Dt(t,e){return t(e)}function Mt(t,e,n,i,r){return t(e,n,i,r)}function Lt(){}var Bt=Dt,Ft=!1,It=!1;function zt(){null===At&&null===Pt||(Lt(),Rt())}function Nt(t,e){var n=t.stateNode;if(null===n)return null;var i=ar(n);if(null===i)return null;n=i[e];t:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(i=!("button"===(t=t.type)||"input"===t||"select"===t||"textarea"===t)),t=!i;break t;default:t=!1}if(t)return null;if(n&&"function"!==typeof n)throw Error(o(231,e,typeof n));return n}var Ut=!1;if(h)try{var Ht={};Object.defineProperty(Ht,"passive",{get:function(){Ut=!0}}),window.addEventListener("test",Ht,Ht),window.removeEventListener("test",Ht,Ht)}catch(gt){Ut=!1}function Wt(t,e,n,i,r,a,o,s,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(c){this.onError(c)}}var Vt=!1,Gt=null,Xt=!1,qt=null,Kt={onError:function(t){Vt=!0,Gt=t}};function Zt(t,e,n,i,r,a,o,s,l){Vt=!1,Gt=null,Wt.apply(Kt,arguments)}function Qt(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do{0!==(1026&(e=t).flags)&&(n=e.return),t=e.return}while(t)}return 3===e.tag?n:null}function Yt(t){if(13===t.tag){var e=t.memoizedState;if(null===e&&(null!==(t=t.alternate)&&(e=t.memoizedState)),null!==e)return e.dehydrated}return null}function $t(t){if(Qt(t)!==t)throw Error(o(188))}function Jt(t){if(t=function(t){var e=t.alternate;if(!e){if(null===(e=Qt(t)))throw Error(o(188));return e!==t?null:t}for(var n=t,i=e;;){var r=n.return;if(null===r)break;var a=r.alternate;if(null===a){if(null!==(i=r.return)){n=i;continue}break}if(r.child===a.child){for(a=r.child;a;){if(a===n)return $t(r),t;if(a===i)return $t(r),e;a=a.sibling}throw Error(o(188))}if(n.return!==i.return)n=r,i=a;else{for(var s=!1,l=r.child;l;){if(l===n){s=!0,n=r,i=a;break}if(l===i){s=!0,i=r,n=a;break}l=l.sibling}if(!s){for(l=a.child;l;){if(l===n){s=!0,n=a,i=r;break}if(l===i){s=!0,i=a,n=r;break}l=l.sibling}if(!s)throw Error(o(189))}}if(n.alternate!==i)throw Error(o(190))}if(3!==n.tag)throw Error(o(188));return n.stateNode.current===n?t:e}(t),!t)return null;for(var e=t;;){if(5===e.tag||6===e.tag)return e;if(e.child)e.child.return=e,e=e.child;else{if(e===t)break;for(;!e.sibling;){if(!e.return||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}}return null}function te(t,e){for(var n=t.alternate;null!==e;){if(e===t||e===n)return!0;e=e.return}return!1}var ee,ne,ie,re,ae=!1,oe=[],se=null,le=null,ue=null,ce=new Map,he=new Map,de=[],fe="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function pe(t,e,n,i,r){return{blockedOn:t,domEventName:e,eventSystemFlags:16|n,nativeEvent:r,targetContainers:[i]}}function ve(t,e){switch(t){case"focusin":case"focusout":se=null;break;case"dragenter":case"dragleave":le=null;break;case"mouseover":case"mouseout":ue=null;break;case"pointerover":case"pointerout":ce.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":he.delete(e.pointerId)}}function ge(t,e,n,i,r,a){return null===t||t.nativeEvent!==a?(t=pe(e,n,i,r,a),null!==e&&(null!==(e=ir(e))&&ne(e)),t):(t.eventSystemFlags|=i,e=t.targetContainers,null!==r&&-1===e.indexOf(r)&&e.push(r),t)}function ye(t){var e=nr(t.target);if(null!==e){var n=Qt(e);if(null!==n)if(13===(e=n.tag)){if(null!==(e=Yt(n)))return t.blockedOn=e,void re(t.lanePriority,(function(){a.unstable_runWithPriority(t.priority,(function(){ie(n)}))}))}else if(3===e&&n.stateNode.hydrate)return void(t.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}t.blockedOn=null}function me(t){if(null!==t.blockedOn)return!1;for(var e=t.targetContainers;0<e.length;){var n=Je(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(null!==n)return null!==(e=ir(n))&&ne(e),t.blockedOn=n,!1;e.shift()}return!0}function _e(t,e,n){me(t)&&n.delete(e)}function be(){for(ae=!1;0<oe.length;){var t=oe[0];if(null!==t.blockedOn){null!==(t=ir(t.blockedOn))&&ee(t);break}for(var e=t.targetContainers;0<e.length;){var n=Je(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(null!==n){t.blockedOn=n;break}e.shift()}null===t.blockedOn&&oe.shift()}null!==se&&me(se)&&(se=null),null!==le&&me(le)&&(le=null),null!==ue&&me(ue)&&(ue=null),ce.forEach(_e),he.forEach(_e)}function we(t,e){t.blockedOn===e&&(t.blockedOn=null,ae||(ae=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,be)))}function ke(t){function e(e){return we(e,t)}if(0<oe.length){we(oe[0],t);for(var n=1;n<oe.length;n++){var i=oe[n];i.blockedOn===t&&(i.blockedOn=null)}}for(null!==se&&we(se,t),null!==le&&we(le,t),null!==ue&&we(ue,t),ce.forEach(e),he.forEach(e),n=0;n<de.length;n++)(i=de[n]).blockedOn===t&&(i.blockedOn=null);for(;0<de.length&&null===(n=de[0]).blockedOn;)ye(n),null===n.blockedOn&&de.shift()}function xe(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Se={animationend:xe("Animation","AnimationEnd"),animationiteration:xe("Animation","AnimationIteration"),animationstart:xe("Animation","AnimationStart"),transitionend:xe("Transition","TransitionEnd")},Ce={},Oe={};function Ee(t){if(Ce[t])return Ce[t];if(!Se[t])return t;var e,n=Se[t];for(e in n)if(n.hasOwnProperty(e)&&e in Oe)return Ce[t]=n[e];return t}h&&(Oe=document.createElement("div").style,"AnimationEvent"in window||(delete Se.animationend.animation,delete Se.animationiteration.animation,delete Se.animationstart.animation),"TransitionEvent"in window||delete Se.transitionend.transition);var Ae=Ee("animationend"),Pe=Ee("animationiteration"),je=Ee("animationstart"),Te=Ee("transitionend"),Re=new Map,De=new Map,Me=["abort","abort",Ae,"animationEnd",Pe,"animationIteration",je,"animationStart","canplay","canPlay","canplaythrough","canPlayThrough","durationchange","durationChange","emptied","emptied","encrypted","encrypted","ended","ended","error","error","gotpointercapture","gotPointerCapture","load","load","loadeddata","loadedData","loadedmetadata","loadedMetadata","loadstart","loadStart","lostpointercapture","lostPointerCapture","playing","playing","progress","progress","seeking","seeking","stalled","stalled","suspend","suspend","timeupdate","timeUpdate",Te,"transitionEnd","waiting","waiting"];function Le(t,e){for(var n=0;n<t.length;n+=2){var i=t[n],r=t[n+1];r="on"+(r[0].toUpperCase()+r.slice(1)),De.set(i,e),Re.set(i,r),u(r,[i])}}(0,a.unstable_now)();var Be=8;function Fe(t){if(0!==(1&t))return Be=15,1;if(0!==(2&t))return Be=14,2;if(0!==(4&t))return Be=13,4;var e=24&t;return 0!==e?(Be=12,e):0!==(32&t)?(Be=11,32):0!==(e=192&t)?(Be=10,e):0!==(256&t)?(Be=9,256):0!==(e=3584&t)?(Be=8,e):0!==(4096&t)?(Be=7,4096):0!==(e=4186112&t)?(Be=6,e):0!==(e=62914560&t)?(Be=5,e):67108864&t?(Be=4,67108864):0!==(134217728&t)?(Be=3,134217728):0!==(e=805306368&t)?(Be=2,e):0!==(1073741824&t)?(Be=1,1073741824):(Be=8,t)}function Ie(t,e){var n=t.pendingLanes;if(0===n)return Be=0;var i=0,r=0,a=t.expiredLanes,o=t.suspendedLanes,s=t.pingedLanes;if(0!==a)i=a,r=Be=15;else if(0!==(a=134217727&n)){var l=a&~o;0!==l?(i=Fe(l),r=Be):0!==(s&=a)&&(i=Fe(s),r=Be)}else 0!==(a=n&~o)?(i=Fe(a),r=Be):0!==s&&(i=Fe(s),r=Be);if(0===i)return 0;if(i=n&((0>(i=31-Ve(i))?0:1<<i)<<1)-1,0!==e&&e!==i&&0===(e&o)){if(Fe(e),r<=Be)return e;Be=r}if(0!==(e=t.entangledLanes))for(t=t.entanglements,e&=i;0<e;)r=1<<(n=31-Ve(e)),i|=t[n],e&=~r;return i}function ze(t){return 0!==(t=-1073741825&t.pendingLanes)?t:1073741824&t?1073741824:0}function Ne(t,e){switch(t){case 15:return 1;case 14:return 2;case 12:return 0===(t=Ue(24&~e))?Ne(10,e):t;case 10:return 0===(t=Ue(192&~e))?Ne(8,e):t;case 8:return 0===(t=Ue(3584&~e))&&(0===(t=Ue(4186112&~e))&&(t=512)),t;case 2:return 0===(e=Ue(805306368&~e))&&(e=268435456),e}throw Error(o(358,t))}function Ue(t){return t&-t}function He(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function We(t,e,n){t.pendingLanes|=e;var i=e-1;t.suspendedLanes&=i,t.pingedLanes&=i,(t=t.eventTimes)[e=31-Ve(e)]=n}var Ve=Math.clz32?Math.clz32:function(t){return 0===t?32:31-(Ge(t)/Xe|0)|0},Ge=Math.log,Xe=Math.LN2;var qe=a.unstable_UserBlockingPriority,Ke=a.unstable_runWithPriority,Ze=!0;function Qe(t,e,n,i){Ft||Lt();var r=$e,a=Ft;Ft=!0;try{Mt(r,t,e,n,i)}finally{(Ft=a)||zt()}}function Ye(t,e,n,i){Ke(qe,$e.bind(null,t,e,n,i))}function $e(t,e,n,i){var r;if(Ze)if((r=0===(4&e))&&0<oe.length&&-1<fe.indexOf(t))t=pe(null,t,e,n,i),oe.push(t);else{var a=Je(t,e,n,i);if(null===a)r&&ve(t,i);else{if(r){if(-1<fe.indexOf(t))return t=pe(a,t,e,n,i),void oe.push(t);if(function(t,e,n,i,r){switch(e){case"focusin":return se=ge(se,t,e,n,i,r),!0;case"dragenter":return le=ge(le,t,e,n,i,r),!0;case"mouseover":return ue=ge(ue,t,e,n,i,r),!0;case"pointerover":var a=r.pointerId;return ce.set(a,ge(ce.get(a)||null,t,e,n,i,r)),!0;case"gotpointercapture":return a=r.pointerId,he.set(a,ge(he.get(a)||null,t,e,n,i,r)),!0}return!1}(a,t,e,n,i))return;ve(t,i)}Li(t,e,i,null,n)}}}function Je(t,e,n,i){var r=Ot(i);if(null!==(r=nr(r))){var a=Qt(r);if(null===a)r=null;else{var o=a.tag;if(13===o){if(null!==(r=Yt(a)))return r;r=null}else if(3===o){if(a.stateNode.hydrate)return 3===a.tag?a.stateNode.containerInfo:null;r=null}else a!==r&&(r=null)}}return Li(t,e,i,r,n),null}var tn=null,en=null,nn=null;function rn(){if(nn)return nn;var t,e,n=en,i=n.length,r="value"in tn?tn.value:tn.textContent,a=r.length;for(t=0;t<i&&n[t]===r[t];t++);var o=i-t;for(e=1;e<=o&&n[i-e]===r[a-e];e++);return nn=r.slice(t,1<e?1-e:void 0)}function an(t){var e=t.keyCode;return"charCode"in t?0===(t=t.charCode)&&13===e&&(t=13):t=e,10===t&&(t=13),32<=t||13===t?t:0}function on(){return!0}function sn(){return!1}function ln(t){function e(e,n,i,r,a){for(var o in this._reactName=e,this._targetInst=i,this.type=n,this.nativeEvent=r,this.target=a,this.currentTarget=null,t)t.hasOwnProperty(o)&&(e=t[o],this[o]=e?e(r):r[o]);return this.isDefaultPrevented=(null!=r.defaultPrevented?r.defaultPrevented:!1===r.returnValue)?on:sn,this.isPropagationStopped=sn,this}return r(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():"unknown"!==typeof t.returnValue&&(t.returnValue=!1),this.isDefaultPrevented=on)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():"unknown"!==typeof t.cancelBubble&&(t.cancelBubble=!0),this.isPropagationStopped=on)},persist:function(){},isPersistent:on}),e}var un,cn,hn,dn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},fn=ln(dn),pn=r({},dn,{view:0,detail:0}),vn=ln(pn),gn=r({},pn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:An,button:0,buttons:0,relatedTarget:function(t){return void 0===t.relatedTarget?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==hn&&(hn&&"mousemove"===t.type?(un=t.screenX-hn.screenX,cn=t.screenY-hn.screenY):cn=un=0,hn=t),un)},movementY:function(t){return"movementY"in t?t.movementY:cn}}),yn=ln(gn),mn=ln(r({},gn,{dataTransfer:0})),_n=ln(r({},pn,{relatedTarget:0})),bn=ln(r({},dn,{animationName:0,elapsedTime:0,pseudoElement:0})),wn=r({},dn,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),kn=ln(wn),xn=ln(r({},dn,{data:0})),Sn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Cn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},On={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function En(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):!!(t=On[t])&&!!e[t]}function An(){return En}var Pn=r({},pn,{key:function(t){if(t.key){var e=Sn[t.key]||t.key;if("Unidentified"!==e)return e}return"keypress"===t.type?13===(t=an(t))?"Enter":String.fromCharCode(t):"keydown"===t.type||"keyup"===t.type?Cn[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:An,charCode:function(t){return"keypress"===t.type?an(t):0},keyCode:function(t){return"keydown"===t.type||"keyup"===t.type?t.keyCode:0},which:function(t){return"keypress"===t.type?an(t):"keydown"===t.type||"keyup"===t.type?t.keyCode:0}}),jn=ln(Pn),Tn=ln(r({},gn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Rn=ln(r({},pn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:An})),Dn=ln(r({},dn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Mn=r({},gn,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Ln=ln(Mn),Bn=[9,13,27,32],Fn=h&&"CompositionEvent"in window,In=null;h&&"documentMode"in document&&(In=document.documentMode);var zn=h&&"TextEvent"in window&&!In,Nn=h&&(!Fn||In&&8<In&&11>=In),Un=String.fromCharCode(32),Hn=!1;function Wn(t,e){switch(t){case"keyup":return-1!==Bn.indexOf(e.keyCode);case"keydown":return 229!==e.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Vn(t){return"object"===typeof(t=t.detail)&&"data"in t?t.data:null}var Gn=!1;var Xn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function qn(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return"input"===e?!!Xn[t.type]:"textarea"===e}function Kn(t,e,n,i){Tt(i),0<(e=Fi(e,"onChange")).length&&(n=new fn("onChange","change",null,n,i),t.push({event:n,listeners:e}))}var Zn=null,Qn=null;function Yn(t){Pi(t,0)}function $n(t){if(Y(rr(t)))return t}function Jn(t,e){if("change"===t)return e}var ti=!1;if(h){var ei;if(h){var ni="oninput"in document;if(!ni){var ii=document.createElement("div");ii.setAttribute("oninput","return;"),ni="function"===typeof ii.oninput}ei=ni}else ei=!1;ti=ei&&(!document.documentMode||9<document.documentMode)}function ri(){Zn&&(Zn.detachEvent("onpropertychange",ai),Qn=Zn=null)}function ai(t){if("value"===t.propertyName&&$n(Qn)){var e=[];if(Kn(e,Qn,t,Ot(t)),t=Yn,Ft)t(e);else{Ft=!0;try{Dt(t,e)}finally{Ft=!1,zt()}}}}function oi(t,e,n){"focusin"===t?(ri(),Qn=n,(Zn=e).attachEvent("onpropertychange",ai)):"focusout"===t&&ri()}function si(t){if("selectionchange"===t||"keyup"===t||"keydown"===t)return $n(Qn)}function li(t,e){if("click"===t)return $n(e)}function ui(t,e){if("input"===t||"change"===t)return $n(e)}var ci="function"===typeof Object.is?Object.is:function(t,e){return t===e&&(0!==t||1/t===1/e)||t!==t&&e!==e},hi=Object.prototype.hasOwnProperty;function di(t,e){if(ci(t,e))return!0;if("object"!==typeof t||null===t||"object"!==typeof e||null===e)return!1;var n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++)if(!hi.call(e,n[i])||!ci(t[n[i]],e[n[i]]))return!1;return!0}function fi(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function pi(t,e){var n,i=fi(t);for(t=0;i;){if(3===i.nodeType){if(n=t+i.textContent.length,t<=e&&n>=e)return{node:i,offset:e-t};t=n}t:{for(;i;){if(i.nextSibling){i=i.nextSibling;break t}i=i.parentNode}i=void 0}i=fi(i)}}function vi(t,e){return!(!t||!e)&&(t===e||(!t||3!==t.nodeType)&&(e&&3===e.nodeType?vi(t,e.parentNode):"contains"in t?t.contains(e):!!t.compareDocumentPosition&&!!(16&t.compareDocumentPosition(e))))}function gi(){for(var t=window,e=$();e instanceof t.HTMLIFrameElement;){try{var n="string"===typeof e.contentWindow.location.href}catch(i){n=!1}if(!n)break;e=$((t=e.contentWindow).document)}return e}function yi(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&("input"===e&&("text"===t.type||"search"===t.type||"tel"===t.type||"url"===t.type||"password"===t.type)||"textarea"===e||"true"===t.contentEditable)}var mi=h&&"documentMode"in document&&11>=document.documentMode,_i=null,bi=null,wi=null,ki=!1;function xi(t,e,n){var i=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;ki||null==_i||_i!==$(i)||("selectionStart"in(i=_i)&&yi(i)?i={start:i.selectionStart,end:i.selectionEnd}:i={anchorNode:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset},wi&&di(wi,i)||(wi=i,0<(i=Fi(bi,"onSelect")).length&&(e=new fn("onSelect","select",null,e,n),t.push({event:e,listeners:i}),e.target=_i)))}Le("cancel cancel click click close close contextmenu contextMenu copy copy cut cut auxclick auxClick dblclick doubleClick dragend dragEnd dragstart dragStart drop drop focusin focus focusout blur input input invalid invalid keydown keyDown keypress keyPress keyup keyUp mousedown mouseDown mouseup mouseUp paste paste pause pause play play pointercancel pointerCancel pointerdown pointerDown pointerup pointerUp ratechange rateChange reset reset seeked seeked submit submit touchcancel touchCancel touchend touchEnd touchstart touchStart volumechange volumeChange".split(" "),0),Le("drag drag dragenter dragEnter dragexit dragExit dragleave dragLeave dragover dragOver mousemove mouseMove mouseout mouseOut mouseover mouseOver pointermove pointerMove pointerout pointerOut pointerover pointerOver scroll scroll toggle toggle touchmove touchMove wheel wheel".split(" "),1),Le(Me,2);for(var Si="change selectionchange textInput compositionstart compositionend compositionupdate".split(" "),Ci=0;Ci<Si.length;Ci++)De.set(Si[Ci],0);c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),u("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),u("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),u("onBeforeInput",["compositionend","keypress","textInput","paste"]),u("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Oi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ei=new Set("cancel close invalid load scroll toggle".split(" ").concat(Oi));function Ai(t,e,n){var i=t.type||"unknown-event";t.currentTarget=n,function(t,e,n,i,r,a,s,l,u){if(Zt.apply(this,arguments),Vt){if(!Vt)throw Error(o(198));var c=Gt;Vt=!1,Gt=null,Xt||(Xt=!0,qt=c)}}(i,e,void 0,t),t.currentTarget=null}function Pi(t,e){e=0!==(4&e);for(var n=0;n<t.length;n++){var i=t[n],r=i.event;i=i.listeners;t:{var a=void 0;if(e)for(var o=i.length-1;0<=o;o--){var s=i[o],l=s.instance,u=s.currentTarget;if(s=s.listener,l!==a&&r.isPropagationStopped())break t;Ai(r,s,u),a=l}else for(o=0;o<i.length;o++){if(l=(s=i[o]).instance,u=s.currentTarget,s=s.listener,l!==a&&r.isPropagationStopped())break t;Ai(r,s,u),a=l}}}if(Xt)throw t=qt,Xt=!1,qt=null,t}function ji(t,e){var n=or(e),i=t+"__bubble";n.has(i)||(Mi(e,t,2,!1),n.add(i))}var Ti="_reactListening"+Math.random().toString(36).slice(2);function Ri(t){t[Ti]||(t[Ti]=!0,s.forEach((function(e){Ei.has(e)||Di(e,!1,t,null),Di(e,!0,t,null)})))}function Di(t,e,n,i){var r=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,a=n;if("selectionchange"===t&&9!==n.nodeType&&(a=n.ownerDocument),null!==i&&!e&&Ei.has(t)){if("scroll"!==t)return;r|=2,a=i}var o=or(a),s=t+"__"+(e?"capture":"bubble");o.has(s)||(e&&(r|=4),Mi(a,t,r,e),o.add(s))}function Mi(t,e,n,i){var r=De.get(e);switch(void 0===r?2:r){case 0:r=Qe;break;case 1:r=Ye;break;default:r=$e}n=r.bind(null,e,n,t),r=void 0,!Ut||"touchstart"!==e&&"touchmove"!==e&&"wheel"!==e||(r=!0),i?void 0!==r?t.addEventListener(e,n,{capture:!0,passive:r}):t.addEventListener(e,n,!0):void 0!==r?t.addEventListener(e,n,{passive:r}):t.addEventListener(e,n,!1)}function Li(t,e,n,i,r){var a=i;if(0===(1&e)&&0===(2&e)&&null!==i)t:for(;;){if(null===i)return;var o=i.tag;if(3===o||4===o){var s=i.stateNode.containerInfo;if(s===r||8===s.nodeType&&s.parentNode===r)break;if(4===o)for(o=i.return;null!==o;){var l=o.tag;if((3===l||4===l)&&((l=o.stateNode.containerInfo)===r||8===l.nodeType&&l.parentNode===r))return;o=o.return}for(;null!==s;){if(null===(o=nr(s)))return;if(5===(l=o.tag)||6===l){i=a=o;continue t}s=s.parentNode}}i=i.return}!function(t,e,n){if(It)return t(e,n);It=!0;try{Bt(t,e,n)}finally{It=!1,zt()}}((function(){var i=a,r=Ot(n),o=[];t:{var s=Re.get(t);if(void 0!==s){var l=fn,u=t;switch(t){case"keypress":if(0===an(n))break t;case"keydown":case"keyup":l=jn;break;case"focusin":u="focus",l=_n;break;case"focusout":u="blur",l=_n;break;case"beforeblur":case"afterblur":l=_n;break;case"click":if(2===n.button)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=yn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=mn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Rn;break;case Ae:case Pe:case je:l=bn;break;case Te:l=Dn;break;case"scroll":l=vn;break;case"wheel":l=Ln;break;case"copy":case"cut":case"paste":l=kn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Tn}var c=0!==(4&e),h=!c&&"scroll"===t,d=c?null!==s?s+"Capture":null:s;c=[];for(var f,p=i;null!==p;){var v=(f=p).stateNode;if(5===f.tag&&null!==v&&(f=v,null!==d&&(null!=(v=Nt(p,d))&&c.push(Bi(p,v,f)))),h)break;p=p.return}0<c.length&&(s=new l(s,u,null,n,r),o.push({event:s,listeners:c}))}}if(0===(7&e)){if(l="mouseout"===t||"pointerout"===t,(!(s="mouseover"===t||"pointerover"===t)||0!==(16&e)||!(u=n.relatedTarget||n.fromElement)||!nr(u)&&!u[tr])&&(l||s)&&(s=r.window===r?r:(s=r.ownerDocument)?s.defaultView||s.parentWindow:window,l?(l=i,null!==(u=(u=n.relatedTarget||n.toElement)?nr(u):null)&&(u!==(h=Qt(u))||5!==u.tag&&6!==u.tag)&&(u=null)):(l=null,u=i),l!==u)){if(c=yn,v="onMouseLeave",d="onMouseEnter",p="mouse","pointerout"!==t&&"pointerover"!==t||(c=Tn,v="onPointerLeave",d="onPointerEnter",p="pointer"),h=null==l?s:rr(l),f=null==u?s:rr(u),(s=new c(v,p+"leave",l,n,r)).target=h,s.relatedTarget=f,v=null,nr(r)===i&&((c=new c(d,p+"enter",u,n,r)).target=f,c.relatedTarget=h,v=c),h=v,l&&u)t:{for(d=u,p=0,f=c=l;f;f=Ii(f))p++;for(f=0,v=d;v;v=Ii(v))f++;for(;0<p-f;)c=Ii(c),p--;for(;0<f-p;)d=Ii(d),f--;for(;p--;){if(c===d||null!==d&&c===d.alternate)break t;c=Ii(c),d=Ii(d)}c=null}else c=null;null!==l&&zi(o,s,l,c,!1),null!==u&&null!==h&&zi(o,h,u,c,!0)}if("select"===(l=(s=i?rr(i):window).nodeName&&s.nodeName.toLowerCase())||"input"===l&&"file"===s.type)var g=Jn;else if(qn(s))if(ti)g=ui;else{g=si;var y=oi}else(l=s.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(g=li);switch(g&&(g=g(t,i))?Kn(o,g,n,r):(y&&y(t,s,i),"focusout"===t&&(y=s._wrapperState)&&y.controlled&&"number"===s.type&&rt(s,"number",s.value)),y=i?rr(i):window,t){case"focusin":(qn(y)||"true"===y.contentEditable)&&(_i=y,bi=i,wi=null);break;case"focusout":wi=bi=_i=null;break;case"mousedown":ki=!0;break;case"contextmenu":case"mouseup":case"dragend":ki=!1,xi(o,n,r);break;case"selectionchange":if(mi)break;case"keydown":case"keyup":xi(o,n,r)}var m;if(Fn)t:{switch(t){case"compositionstart":var _="onCompositionStart";break t;case"compositionend":_="onCompositionEnd";break t;case"compositionupdate":_="onCompositionUpdate";break t}_=void 0}else Gn?Wn(t,n)&&(_="onCompositionEnd"):"keydown"===t&&229===n.keyCode&&(_="onCompositionStart");_&&(Nn&&"ko"!==n.locale&&(Gn||"onCompositionStart"!==_?"onCompositionEnd"===_&&Gn&&(m=rn()):(en="value"in(tn=r)?tn.value:tn.textContent,Gn=!0)),0<(y=Fi(i,_)).length&&(_=new xn(_,t,null,n,r),o.push({event:_,listeners:y}),m?_.data=m:null!==(m=Vn(n))&&(_.data=m))),(m=zn?function(t,e){switch(t){case"compositionend":return Vn(e);case"keypress":return 32!==e.which?null:(Hn=!0,Un);case"textInput":return(t=e.data)===Un&&Hn?null:t;default:return null}}(t,n):function(t,e){if(Gn)return"compositionend"===t||!Fn&&Wn(t,e)?(t=rn(),nn=en=tn=null,Gn=!1,t):null;switch(t){case"paste":default:return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Nn&&"ko"!==e.locale?null:e.data}}(t,n))&&(0<(i=Fi(i,"onBeforeInput")).length&&(r=new xn("onBeforeInput","beforeinput",null,n,r),o.push({event:r,listeners:i}),r.data=m))}Pi(o,e)}))}function Bi(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Fi(t,e){for(var n=e+"Capture",i=[];null!==t;){var r=t,a=r.stateNode;5===r.tag&&null!==a&&(r=a,null!=(a=Nt(t,n))&&i.unshift(Bi(t,a,r)),null!=(a=Nt(t,e))&&i.push(Bi(t,a,r))),t=t.return}return i}function Ii(t){if(null===t)return null;do{t=t.return}while(t&&5!==t.tag);return t||null}function zi(t,e,n,i,r){for(var a=e._reactName,o=[];null!==n&&n!==i;){var s=n,l=s.alternate,u=s.stateNode;if(null!==l&&l===i)break;5===s.tag&&null!==u&&(s=u,r?null!=(l=Nt(n,a))&&o.unshift(Bi(n,l,s)):r||null!=(l=Nt(n,a))&&o.push(Bi(n,l,s))),n=n.return}0!==o.length&&t.push({event:e,listeners:o})}function Ni(){}var Ui=null,Hi=null;function Wi(t,e){switch(t){case"button":case"input":case"select":case"textarea":return!!e.autoFocus}return!1}function Vi(t,e){return"textarea"===t||"option"===t||"noscript"===t||"string"===typeof e.children||"number"===typeof e.children||"object"===typeof e.dangerouslySetInnerHTML&&null!==e.dangerouslySetInnerHTML&&null!=e.dangerouslySetInnerHTML.__html}var Gi="function"===typeof setTimeout?setTimeout:void 0,Xi="function"===typeof clearTimeout?clearTimeout:void 0;function qi(t){1===t.nodeType?t.textContent="":9===t.nodeType&&(null!=(t=t.body)&&(t.textContent=""))}function Ki(t){for(;null!=t;t=t.nextSibling){var e=t.nodeType;if(1===e||3===e)break}return t}function Zi(t){t=t.previousSibling;for(var e=0;t;){if(8===t.nodeType){var n=t.data;if("$"===n||"$!"===n||"$?"===n){if(0===e)return t;e--}else"/$"===n&&e++}t=t.previousSibling}return null}var Qi=0;var Yi=Math.random().toString(36).slice(2),$i="__reactFiber$"+Yi,Ji="__reactProps$"+Yi,tr="__reactContainer$"+Yi,er="__reactEvents$"+Yi;function nr(t){var e=t[$i];if(e)return e;for(var n=t.parentNode;n;){if(e=n[tr]||n[$i]){if(n=e.alternate,null!==e.child||null!==n&&null!==n.child)for(t=Zi(t);null!==t;){if(n=t[$i])return n;t=Zi(t)}return e}n=(t=n).parentNode}return null}function ir(t){return!(t=t[$i]||t[tr])||5!==t.tag&&6!==t.tag&&13!==t.tag&&3!==t.tag?null:t}function rr(t){if(5===t.tag||6===t.tag)return t.stateNode;throw Error(o(33))}function ar(t){return t[Ji]||null}function or(t){var e=t[er];return void 0===e&&(e=t[er]=new Set),e}var sr=[],lr=-1;function ur(t){return{current:t}}function cr(t){0>lr||(t.current=sr[lr],sr[lr]=null,lr--)}function hr(t,e){lr++,sr[lr]=t.current,t.current=e}var dr={},fr=ur(dr),pr=ur(!1),vr=dr;function gr(t,e){var n=t.type.contextTypes;if(!n)return dr;var i=t.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===e)return i.__reactInternalMemoizedMaskedChildContext;var r,a={};for(r in n)a[r]=e[r];return i&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=a),a}function yr(t){return null!==(t=t.childContextTypes)&&void 0!==t}function mr(){cr(pr),cr(fr)}function _r(t,e,n){if(fr.current!==dr)throw Error(o(168));hr(fr,e),hr(pr,n)}function br(t,e,n){var i=t.stateNode;if(t=e.childContextTypes,"function"!==typeof i.getChildContext)return n;for(var a in i=i.getChildContext())if(!(a in t))throw Error(o(108,q(e)||"Unknown",a));return r({},n,i)}function wr(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||dr,vr=fr.current,hr(fr,t),hr(pr,pr.current),!0}function kr(t,e,n){var i=t.stateNode;if(!i)throw Error(o(169));n?(t=br(t,e,vr),i.__reactInternalMemoizedMergedChildContext=t,cr(pr),cr(fr),hr(fr,t)):cr(pr),hr(pr,n)}var xr=null,Sr=null,Cr=a.unstable_runWithPriority,Or=a.unstable_scheduleCallback,Er=a.unstable_cancelCallback,Ar=a.unstable_shouldYield,Pr=a.unstable_requestPaint,jr=a.unstable_now,Tr=a.unstable_getCurrentPriorityLevel,Rr=a.unstable_ImmediatePriority,Dr=a.unstable_UserBlockingPriority,Mr=a.unstable_NormalPriority,Lr=a.unstable_LowPriority,Br=a.unstable_IdlePriority,Fr={},Ir=void 0!==Pr?Pr:function(){},zr=null,Nr=null,Ur=!1,Hr=jr(),Wr=1e4>Hr?jr:function(){return jr()-Hr};function Vr(){switch(Tr()){case Rr:return 99;case Dr:return 98;case Mr:return 97;case Lr:return 96;case Br:return 95;default:throw Error(o(332))}}function Gr(t){switch(t){case 99:return Rr;case 98:return Dr;case 97:return Mr;case 96:return Lr;case 95:return Br;default:throw Error(o(332))}}function Xr(t,e){return t=Gr(t),Cr(t,e)}function qr(t,e,n){return t=Gr(t),Or(t,e,n)}function Kr(){if(null!==Nr){var t=Nr;Nr=null,Er(t)}Zr()}function Zr(){if(!Ur&&null!==zr){Ur=!0;var t=0;try{var e=zr;Xr(99,(function(){for(;t<e.length;t++){var n=e[t];do{n=n(!0)}while(null!==n)}})),zr=null}catch(n){throw null!==zr&&(zr=zr.slice(t+1)),Or(Rr,Kr),n}finally{Ur=!1}}}var Qr=w.ReactCurrentBatchConfig;function Yr(t,e){if(t&&t.defaultProps){for(var n in e=r({},e),t=t.defaultProps)void 0===e[n]&&(e[n]=t[n]);return e}return e}var $r=ur(null),Jr=null,ta=null,ea=null;function na(){ea=ta=Jr=null}function ia(t){var e=$r.current;cr($r),t.type._context._currentValue=e}function ra(t,e){for(;null!==t;){var n=t.alternate;if((t.childLanes&e)===e){if(null===n||(n.childLanes&e)===e)break;n.childLanes|=e}else t.childLanes|=e,null!==n&&(n.childLanes|=e);t=t.return}}function aa(t,e){Jr=t,ea=ta=null,null!==(t=t.dependencies)&&null!==t.firstContext&&(0!==(t.lanes&e)&&(Fo=!0),t.firstContext=null)}function oa(t,e){if(ea!==t&&!1!==e&&0!==e)if("number"===typeof e&&1073741823!==e||(ea=t,e=1073741823),e={context:t,observedBits:e,next:null},null===ta){if(null===Jr)throw Error(o(308));ta=e,Jr.dependencies={lanes:0,firstContext:e,responders:null}}else ta=ta.next=e;return t._currentValue}var sa=!1;function la(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null},effects:null}}function ua(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function ca(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function ha(t,e){if(null!==(t=t.updateQueue)){var n=(t=t.shared).pending;null===n?e.next=e:(e.next=n.next,n.next=e),t.pending=e}}function da(t,e){var n=t.updateQueue,i=t.alternate;if(null!==i&&n===(i=i.updateQueue)){var r=null,a=null;if(null!==(n=n.firstBaseUpdate)){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===a?r=a=o:a=a.next=o,n=n.next}while(null!==n);null===a?r=a=e:a=a.next=e}else r=a=e;return n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:a,shared:i.shared,effects:i.effects},void(t.updateQueue=n)}null===(t=n.lastBaseUpdate)?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function fa(t,e,n,i){var a=t.updateQueue;sa=!1;var o=a.firstBaseUpdate,s=a.lastBaseUpdate,l=a.shared.pending;if(null!==l){a.shared.pending=null;var u=l,c=u.next;u.next=null,null===s?o=c:s.next=c,s=u;var h=t.alternate;if(null!==h){var d=(h=h.updateQueue).lastBaseUpdate;d!==s&&(null===d?h.firstBaseUpdate=c:d.next=c,h.lastBaseUpdate=u)}}if(null!==o){for(d=a.baseState,s=0,h=c=u=null;;){l=o.lane;var f=o.eventTime;if((i&l)===l){null!==h&&(h=h.next={eventTime:f,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});t:{var p=t,v=o;switch(l=e,f=n,v.tag){case 1:if("function"===typeof(p=v.payload)){d=p.call(f,d,l);break t}d=p;break t;case 3:p.flags=-4097&p.flags|64;case 0:if(null===(l="function"===typeof(p=v.payload)?p.call(f,d,l):p)||void 0===l)break t;d=r({},d,l);break t;case 2:sa=!0}}null!==o.callback&&(t.flags|=32,null===(l=a.effects)?a.effects=[o]:l.push(o))}else f={eventTime:f,lane:l,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===h?(c=h=f,u=d):h=h.next=f,s|=l;if(null===(o=o.next)){if(null===(l=a.shared.pending))break;o=l.next,l.next=null,a.lastBaseUpdate=l,a.shared.pending=null}}null===h&&(u=d),a.baseState=u,a.firstBaseUpdate=c,a.lastBaseUpdate=h,Us|=s,t.lanes=s,t.memoizedState=d}}function pa(t,e,n){if(t=e.effects,e.effects=null,null!==t)for(e=0;e<t.length;e++){var i=t[e],r=i.callback;if(null!==r){if(i.callback=null,i=n,"function"!==typeof r)throw Error(o(191,r));r.call(i)}}}var va=(new i.Component).refs;function ga(t,e,n,i){n=null===(n=n(i,e=t.memoizedState))||void 0===n?e:r({},e,n),t.memoizedState=n,0===t.lanes&&(t.updateQueue.baseState=n)}var ya={isMounted:function(t){return!!(t=t._reactInternals)&&Qt(t)===t},enqueueSetState:function(t,e,n){t=t._reactInternals;var i=dl(),r=fl(t),a=ca(i,r);a.payload=e,void 0!==n&&null!==n&&(a.callback=n),ha(t,a),pl(t,r,i)},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var i=dl(),r=fl(t),a=ca(i,r);a.tag=1,a.payload=e,void 0!==n&&null!==n&&(a.callback=n),ha(t,a),pl(t,r,i)},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=dl(),i=fl(t),r=ca(n,i);r.tag=2,void 0!==e&&null!==e&&(r.callback=e),ha(t,r),pl(t,i,n)}};function ma(t,e,n,i,r,a,o){return"function"===typeof(t=t.stateNode).shouldComponentUpdate?t.shouldComponentUpdate(i,a,o):!e.prototype||!e.prototype.isPureReactComponent||(!di(n,i)||!di(r,a))}function _a(t,e,n){var i=!1,r=dr,a=e.contextType;return"object"===typeof a&&null!==a?a=oa(a):(r=yr(e)?vr:fr.current,a=(i=null!==(i=e.contextTypes)&&void 0!==i)?gr(t,r):dr),e=new e(n,a),t.memoizedState=null!==e.state&&void 0!==e.state?e.state:null,e.updater=ya,t.stateNode=e,e._reactInternals=t,i&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=r,t.__reactInternalMemoizedMaskedChildContext=a),e}function ba(t,e,n,i){t=e.state,"function"===typeof e.componentWillReceiveProps&&e.componentWillReceiveProps(n,i),"function"===typeof e.UNSAFE_componentWillReceiveProps&&e.UNSAFE_componentWillReceiveProps(n,i),e.state!==t&&ya.enqueueReplaceState(e,e.state,null)}function wa(t,e,n,i){var r=t.stateNode;r.props=n,r.state=t.memoizedState,r.refs=va,la(t);var a=e.contextType;"object"===typeof a&&null!==a?r.context=oa(a):(a=yr(e)?vr:fr.current,r.context=gr(t,a)),fa(t,n,r,i),r.state=t.memoizedState,"function"===typeof(a=e.getDerivedStateFromProps)&&(ga(t,e,a,n),r.state=t.memoizedState),"function"===typeof e.getDerivedStateFromProps||"function"===typeof r.getSnapshotBeforeUpdate||"function"!==typeof r.UNSAFE_componentWillMount&&"function"!==typeof r.componentWillMount||(e=r.state,"function"===typeof r.componentWillMount&&r.componentWillMount(),"function"===typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount(),e!==r.state&&ya.enqueueReplaceState(r,r.state,null),fa(t,n,r,i),r.state=t.memoizedState),"function"===typeof r.componentDidMount&&(t.flags|=4)}var ka=Array.isArray;function xa(t,e,n){if(null!==(t=n.ref)&&"function"!==typeof t&&"object"!==typeof t){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(o(309));var i=n.stateNode}if(!i)throw Error(o(147,t));var r=""+t;return null!==e&&null!==e.ref&&"function"===typeof e.ref&&e.ref._stringRef===r?e.ref:(e=function(t){var e=i.refs;e===va&&(e=i.refs={}),null===t?delete e[r]:e[r]=t},e._stringRef=r,e)}if("string"!==typeof t)throw Error(o(284));if(!n._owner)throw Error(o(290,t))}return t}function Sa(t,e){if("textarea"!==t.type)throw Error(o(31,"[object Object]"===Object.prototype.toString.call(e)?"object with keys {"+Object.keys(e).join(", ")+"}":e))}function Ca(t){function e(e,n){if(t){var i=e.lastEffect;null!==i?(i.nextEffect=n,e.lastEffect=n):e.firstEffect=e.lastEffect=n,n.nextEffect=null,n.flags=8}}function n(n,i){if(!t)return null;for(;null!==i;)e(n,i),i=i.sibling;return null}function i(t,e){for(t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function r(t,e){return(t=Xl(t,e)).index=0,t.sibling=null,t}function a(e,n,i){return e.index=i,t?null!==(i=e.alternate)?(i=i.index)<n?(e.flags=2,n):i:(e.flags=2,n):n}function s(e){return t&&null===e.alternate&&(e.flags=2),e}function l(t,e,n,i){return null===e||6!==e.tag?((e=Ql(n,t.mode,i)).return=t,e):((e=r(e,n)).return=t,e)}function u(t,e,n,i){return null!==e&&e.elementType===n.type?((i=r(e,n.props)).ref=xa(t,e,n),i.return=t,i):((i=ql(n.type,n.key,n.props,null,t.mode,i)).ref=xa(t,e,n),i.return=t,i)}function c(t,e,n,i){return null===e||4!==e.tag||e.stateNode.containerInfo!==n.containerInfo||e.stateNode.implementation!==n.implementation?((e=Yl(n,t.mode,i)).return=t,e):((e=r(e,n.children||[])).return=t,e)}function h(t,e,n,i,a){return null===e||7!==e.tag?((e=Kl(n,t.mode,i,a)).return=t,e):((e=r(e,n)).return=t,e)}function d(t,e,n){if("string"===typeof e||"number"===typeof e)return(e=Ql(""+e,t.mode,n)).return=t,e;if("object"===typeof e&&null!==e){switch(e.$$typeof){case k:return(n=ql(e.type,e.key,e.props,null,t.mode,n)).ref=xa(t,null,e),n.return=t,n;case x:return(e=Yl(e,t.mode,n)).return=t,e}if(ka(e)||H(e))return(e=Kl(e,t.mode,n,null)).return=t,e;Sa(t,e)}return null}function f(t,e,n,i){var r=null!==e?e.key:null;if("string"===typeof n||"number"===typeof n)return null!==r?null:l(t,e,""+n,i);if("object"===typeof n&&null!==n){switch(n.$$typeof){case k:return n.key===r?n.type===S?h(t,e,n.props.children,i,r):u(t,e,n,i):null;case x:return n.key===r?c(t,e,n,i):null}if(ka(n)||H(n))return null!==r?null:h(t,e,n,i,null);Sa(t,n)}return null}function p(t,e,n,i,r){if("string"===typeof i||"number"===typeof i)return l(e,t=t.get(n)||null,""+i,r);if("object"===typeof i&&null!==i){switch(i.$$typeof){case k:return t=t.get(null===i.key?n:i.key)||null,i.type===S?h(e,t,i.props.children,r,i.key):u(e,t,i,r);case x:return c(e,t=t.get(null===i.key?n:i.key)||null,i,r)}if(ka(i)||H(i))return h(e,t=t.get(n)||null,i,r,null);Sa(e,i)}return null}function v(r,o,s,l){for(var u=null,c=null,h=o,v=o=0,g=null;null!==h&&v<s.length;v++){h.index>v?(g=h,h=null):g=h.sibling;var y=f(r,h,s[v],l);if(null===y){null===h&&(h=g);break}t&&h&&null===y.alternate&&e(r,h),o=a(y,o,v),null===c?u=y:c.sibling=y,c=y,h=g}if(v===s.length)return n(r,h),u;if(null===h){for(;v<s.length;v++)null!==(h=d(r,s[v],l))&&(o=a(h,o,v),null===c?u=h:c.sibling=h,c=h);return u}for(h=i(r,h);v<s.length;v++)null!==(g=p(h,r,v,s[v],l))&&(t&&null!==g.alternate&&h.delete(null===g.key?v:g.key),o=a(g,o,v),null===c?u=g:c.sibling=g,c=g);return t&&h.forEach((function(t){return e(r,t)})),u}function g(r,s,l,u){var c=H(l);if("function"!==typeof c)throw Error(o(150));if(null==(l=c.call(l)))throw Error(o(151));for(var h=c=null,v=s,g=s=0,y=null,m=l.next();null!==v&&!m.done;g++,m=l.next()){v.index>g?(y=v,v=null):y=v.sibling;var _=f(r,v,m.value,u);if(null===_){null===v&&(v=y);break}t&&v&&null===_.alternate&&e(r,v),s=a(_,s,g),null===h?c=_:h.sibling=_,h=_,v=y}if(m.done)return n(r,v),c;if(null===v){for(;!m.done;g++,m=l.next())null!==(m=d(r,m.value,u))&&(s=a(m,s,g),null===h?c=m:h.sibling=m,h=m);return c}for(v=i(r,v);!m.done;g++,m=l.next())null!==(m=p(v,r,g,m.value,u))&&(t&&null!==m.alternate&&v.delete(null===m.key?g:m.key),s=a(m,s,g),null===h?c=m:h.sibling=m,h=m);return t&&v.forEach((function(t){return e(r,t)})),c}return function(t,i,a,l){var u="object"===typeof a&&null!==a&&a.type===S&&null===a.key;u&&(a=a.props.children);var c="object"===typeof a&&null!==a;if(c)switch(a.$$typeof){case k:t:{for(c=a.key,u=i;null!==u;){if(u.key===c){if(7===u.tag){if(a.type===S){n(t,u.sibling),(i=r(u,a.props.children)).return=t,t=i;break t}}else if(u.elementType===a.type){n(t,u.sibling),(i=r(u,a.props)).ref=xa(t,u,a),i.return=t,t=i;break t}n(t,u);break}e(t,u),u=u.sibling}a.type===S?((i=Kl(a.props.children,t.mode,l,a.key)).return=t,t=i):((l=ql(a.type,a.key,a.props,null,t.mode,l)).ref=xa(t,i,a),l.return=t,t=l)}return s(t);case x:t:{for(u=a.key;null!==i;){if(i.key===u){if(4===i.tag&&i.stateNode.containerInfo===a.containerInfo&&i.stateNode.implementation===a.implementation){n(t,i.sibling),(i=r(i,a.children||[])).return=t,t=i;break t}n(t,i);break}e(t,i),i=i.sibling}(i=Yl(a,t.mode,l)).return=t,t=i}return s(t)}if("string"===typeof a||"number"===typeof a)return a=""+a,null!==i&&6===i.tag?(n(t,i.sibling),(i=r(i,a)).return=t,t=i):(n(t,i),(i=Ql(a,t.mode,l)).return=t,t=i),s(t);if(ka(a))return v(t,i,a,l);if(H(a))return g(t,i,a,l);if(c&&Sa(t,a),"undefined"===typeof a&&!u)switch(t.tag){case 1:case 22:case 0:case 11:case 15:throw Error(o(152,q(t.type)||"Component"))}return n(t,i)}}var Oa=Ca(!0),Ea=Ca(!1),Aa={},Pa=ur(Aa),ja=ur(Aa),Ta=ur(Aa);function Ra(t){if(t===Aa)throw Error(o(174));return t}function Da(t,e){switch(hr(Ta,e),hr(ja,t),hr(Pa,Aa),t=e.nodeType){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:pt(null,"");break;default:e=pt(e=(t=8===t?e.parentNode:e).namespaceURI||null,t=t.tagName)}cr(Pa),hr(Pa,e)}function Ma(){cr(Pa),cr(ja),cr(Ta)}function La(t){Ra(Ta.current);var e=Ra(Pa.current),n=pt(e,t.type);e!==n&&(hr(ja,t),hr(Pa,n))}function Ba(t){ja.current===t&&(cr(Pa),cr(ja))}var Fa=ur(0);function Ia(t){for(var e=t;null!==e;){if(13===e.tag){var n=e.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return e}else if(19===e.tag&&void 0!==e.memoizedProps.revealOrder){if(0!==(64&e.flags))return e}else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var za=null,Na=null,Ua=!1;function Ha(t,e){var n=Vl(5,null,null,0);n.elementType="DELETED",n.type="DELETED",n.stateNode=e,n.return=t,n.flags=8,null!==t.lastEffect?(t.lastEffect.nextEffect=n,t.lastEffect=n):t.firstEffect=t.lastEffect=n}function Wa(t,e){switch(t.tag){case 5:var n=t.type;return null!==(e=1!==e.nodeType||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e)&&(t.stateNode=e,!0);case 6:return null!==(e=""===t.pendingProps||3!==e.nodeType?null:e)&&(t.stateNode=e,!0);default:return!1}}function Va(t){if(Ua){var e=Na;if(e){var n=e;if(!Wa(t,e)){if(!(e=Ki(n.nextSibling))||!Wa(t,e))return t.flags=-1025&t.flags|2,Ua=!1,void(za=t);Ha(za,n)}za=t,Na=Ki(e.firstChild)}else t.flags=-1025&t.flags|2,Ua=!1,za=t}}function Ga(t){for(t=t.return;null!==t&&5!==t.tag&&3!==t.tag&&13!==t.tag;)t=t.return;za=t}function Xa(t){if(t!==za)return!1;if(!Ua)return Ga(t),Ua=!0,!1;var e=t.type;if(5!==t.tag||"head"!==e&&"body"!==e&&!Vi(e,t.memoizedProps))for(e=Na;e;)Ha(t,e),e=Ki(e.nextSibling);if(Ga(t),13===t.tag){if(!(t=null!==(t=t.memoizedState)?t.dehydrated:null))throw Error(o(317));t:{for(t=t.nextSibling,e=0;t;){if(8===t.nodeType){var n=t.data;if("/$"===n){if(0===e){Na=Ki(t.nextSibling);break t}e--}else"$"!==n&&"$!"!==n&&"$?"!==n||e++}t=t.nextSibling}Na=null}}else Na=za?Ki(t.stateNode.nextSibling):null;return!0}function qa(){Na=za=null,Ua=!1}var Ka=[];function Za(){for(var t=0;t<Ka.length;t++)Ka[t]._workInProgressVersionPrimary=null;Ka.length=0}var Qa=w.ReactCurrentDispatcher,Ya=w.ReactCurrentBatchConfig,$a=0,Ja=null,to=null,eo=null,no=!1,io=!1;function ro(){throw Error(o(321))}function ao(t,e){if(null===e)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!ci(t[n],e[n]))return!1;return!0}function oo(t,e,n,i,r,a){if($a=a,Ja=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Qa.current=null===t||null===t.memoizedState?Do:Mo,t=n(i,r),io){a=0;do{if(io=!1,!(25>a))throw Error(o(301));a+=1,eo=to=null,e.updateQueue=null,Qa.current=Lo,t=n(i,r)}while(io)}if(Qa.current=Ro,e=null!==to&&null!==to.next,$a=0,eo=to=Ja=null,no=!1,e)throw Error(o(300));return t}function so(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===eo?Ja.memoizedState=eo=t:eo=eo.next=t,eo}function lo(){if(null===to){var t=Ja.alternate;t=null!==t?t.memoizedState:null}else t=to.next;var e=null===eo?Ja.memoizedState:eo.next;if(null!==e)eo=e,to=t;else{if(null===t)throw Error(o(310));t={memoizedState:(to=t).memoizedState,baseState:to.baseState,baseQueue:to.baseQueue,queue:to.queue,next:null},null===eo?Ja.memoizedState=eo=t:eo=eo.next=t}return eo}function uo(t,e){return"function"===typeof e?e(t):e}function co(t){var e=lo(),n=e.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=t;var i=to,r=i.baseQueue,a=n.pending;if(null!==a){if(null!==r){var s=r.next;r.next=a.next,a.next=s}i.baseQueue=r=a,n.pending=null}if(null!==r){r=r.next,i=i.baseState;var l=s=a=null,u=r;do{var c=u.lane;if(($a&c)===c)null!==l&&(l=l.next={lane:0,action:u.action,eagerReducer:u.eagerReducer,eagerState:u.eagerState,next:null}),i=u.eagerReducer===t?u.eagerState:t(i,u.action);else{var h={lane:c,action:u.action,eagerReducer:u.eagerReducer,eagerState:u.eagerState,next:null};null===l?(s=l=h,a=i):l=l.next=h,Ja.lanes|=c,Us|=c}u=u.next}while(null!==u&&u!==r);null===l?a=i:l.next=s,ci(i,e.memoizedState)||(Fo=!0),e.memoizedState=i,e.baseState=a,e.baseQueue=l,n.lastRenderedState=i}return[e.memoizedState,n.dispatch]}function ho(t){var e=lo(),n=e.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=t;var i=n.dispatch,r=n.pending,a=e.memoizedState;if(null!==r){n.pending=null;var s=r=r.next;do{a=t(a,s.action),s=s.next}while(s!==r);ci(a,e.memoizedState)||(Fo=!0),e.memoizedState=a,null===e.baseQueue&&(e.baseState=a),n.lastRenderedState=a}return[a,i]}function fo(t,e,n){var i=e._getVersion;i=i(e._source);var r=e._workInProgressVersionPrimary;if(null!==r?t=r===i:(t=t.mutableReadLanes,(t=($a&t)===t)&&(e._workInProgressVersionPrimary=i,Ka.push(e))),t)return n(e._source);throw Ka.push(e),Error(o(350))}function po(t,e,n,i){var r=Ds;if(null===r)throw Error(o(349));var a=e._getVersion,s=a(e._source),l=Qa.current,u=l.useState((function(){return fo(r,e,n)})),c=u[1],h=u[0];u=eo;var d=t.memoizedState,f=d.refs,p=f.getSnapshot,v=d.source;d=d.subscribe;var g=Ja;return t.memoizedState={refs:f,source:e,subscribe:i},l.useEffect((function(){f.getSnapshot=n,f.setSnapshot=c;var t=a(e._source);if(!ci(s,t)){t=n(e._source),ci(h,t)||(c(t),t=fl(g),r.mutableReadLanes|=t&r.pendingLanes),t=r.mutableReadLanes,r.entangledLanes|=t;for(var i=r.entanglements,o=t;0<o;){var l=31-Ve(o),u=1<<l;i[l]|=t,o&=~u}}}),[n,e,i]),l.useEffect((function(){return i(e._source,(function(){var t=f.getSnapshot,n=f.setSnapshot;try{n(t(e._source));var i=fl(g);r.mutableReadLanes|=i&r.pendingLanes}catch(a){n((function(){throw a}))}}))}),[e,i]),ci(p,n)&&ci(v,e)&&ci(d,i)||((t={pending:null,dispatch:null,lastRenderedReducer:uo,lastRenderedState:h}).dispatch=c=To.bind(null,Ja,t),u.queue=t,u.baseQueue=null,h=fo(r,e,n),u.memoizedState=u.baseState=h),h}function vo(t,e,n){return po(lo(),t,e,n)}function go(t){var e=so();return"function"===typeof t&&(t=t()),e.memoizedState=e.baseState=t,t=(t=e.queue={pending:null,dispatch:null,lastRenderedReducer:uo,lastRenderedState:t}).dispatch=To.bind(null,Ja,t),[e.memoizedState,t]}function yo(t,e,n,i){return t={tag:t,create:e,destroy:n,deps:i,next:null},null===(e=Ja.updateQueue)?(e={lastEffect:null},Ja.updateQueue=e,e.lastEffect=t.next=t):null===(n=e.lastEffect)?e.lastEffect=t.next=t:(i=n.next,n.next=t,t.next=i,e.lastEffect=t),t}function mo(t){return t={current:t},so().memoizedState=t}function _o(){return lo().memoizedState}function bo(t,e,n,i){var r=so();Ja.flags|=t,r.memoizedState=yo(1|e,n,void 0,void 0===i?null:i)}function wo(t,e,n,i){var r=lo();i=void 0===i?null:i;var a=void 0;if(null!==to){var o=to.memoizedState;if(a=o.destroy,null!==i&&ao(i,o.deps))return void yo(e,n,a,i)}Ja.flags|=t,r.memoizedState=yo(1|e,n,a,i)}function ko(t,e){return bo(516,4,t,e)}function xo(t,e){return wo(516,4,t,e)}function So(t,e){return wo(4,2,t,e)}function Co(t,e){return"function"===typeof e?(t=t(),e(t),function(){e(null)}):null!==e&&void 0!==e?(t=t(),e.current=t,function(){e.current=null}):void 0}function Oo(t,e,n){return n=null!==n&&void 0!==n?n.concat([t]):null,wo(4,2,Co.bind(null,e,t),n)}function Eo(){}function Ao(t,e){var n=lo();e=void 0===e?null:e;var i=n.memoizedState;return null!==i&&null!==e&&ao(e,i[1])?i[0]:(n.memoizedState=[t,e],t)}function Po(t,e){var n=lo();e=void 0===e?null:e;var i=n.memoizedState;return null!==i&&null!==e&&ao(e,i[1])?i[0]:(t=t(),n.memoizedState=[t,e],t)}function jo(t,e){var n=Vr();Xr(98>n?98:n,(function(){t(!0)})),Xr(97<n?97:n,(function(){var n=Ya.transition;Ya.transition=1;try{t(!1),e()}finally{Ya.transition=n}}))}function To(t,e,n){var i=dl(),r=fl(t),a={lane:r,action:n,eagerReducer:null,eagerState:null,next:null},o=e.pending;if(null===o?a.next=a:(a.next=o.next,o.next=a),e.pending=a,o=t.alternate,t===Ja||null!==o&&o===Ja)io=no=!0;else{if(0===t.lanes&&(null===o||0===o.lanes)&&null!==(o=e.lastRenderedReducer))try{var s=e.lastRenderedState,l=o(s,n);if(a.eagerReducer=o,a.eagerState=l,ci(l,s))return}catch(u){}pl(t,r,i)}}var Ro={readContext:oa,useCallback:ro,useContext:ro,useEffect:ro,useImperativeHandle:ro,useLayoutEffect:ro,useMemo:ro,useReducer:ro,useRef:ro,useState:ro,useDebugValue:ro,useDeferredValue:ro,useTransition:ro,useMutableSource:ro,useOpaqueIdentifier:ro,unstable_isNewReconciler:!1},Do={readContext:oa,useCallback:function(t,e){return so().memoizedState=[t,void 0===e?null:e],t},useContext:oa,useEffect:ko,useImperativeHandle:function(t,e,n){return n=null!==n&&void 0!==n?n.concat([t]):null,bo(4,2,Co.bind(null,e,t),n)},useLayoutEffect:function(t,e){return bo(4,2,t,e)},useMemo:function(t,e){var n=so();return e=void 0===e?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var i=so();return e=void 0!==n?n(e):e,i.memoizedState=i.baseState=e,t=(t=i.queue={pending:null,dispatch:null,lastRenderedReducer:t,lastRenderedState:e}).dispatch=To.bind(null,Ja,t),[i.memoizedState,t]},useRef:mo,useState:go,useDebugValue:Eo,useDeferredValue:function(t){var e=go(t),n=e[0],i=e[1];return ko((function(){var e=Ya.transition;Ya.transition=1;try{i(t)}finally{Ya.transition=e}}),[t]),n},useTransition:function(){var t=go(!1),e=t[0];return mo(t=jo.bind(null,t[1])),[t,e]},useMutableSource:function(t,e,n){var i=so();return i.memoizedState={refs:{getSnapshot:e,setSnapshot:null},source:t,subscribe:n},po(i,t,e,n)},useOpaqueIdentifier:function(){if(Ua){var t=!1,e=function(t){return{$$typeof:L,toString:t,valueOf:t}}((function(){throw t||(t=!0,n("r:"+(Qi++).toString(36))),Error(o(355))})),n=go(e)[1];return 0===(2&Ja.mode)&&(Ja.flags|=516,yo(5,(function(){n("r:"+(Qi++).toString(36))}),void 0,null)),e}return go(e="r:"+(Qi++).toString(36)),e},unstable_isNewReconciler:!1},Mo={readContext:oa,useCallback:Ao,useContext:oa,useEffect:xo,useImperativeHandle:Oo,useLayoutEffect:So,useMemo:Po,useReducer:co,useRef:_o,useState:function(){return co(uo)},useDebugValue:Eo,useDeferredValue:function(t){var e=co(uo),n=e[0],i=e[1];return xo((function(){var e=Ya.transition;Ya.transition=1;try{i(t)}finally{Ya.transition=e}}),[t]),n},useTransition:function(){var t=co(uo)[0];return[_o().current,t]},useMutableSource:vo,useOpaqueIdentifier:function(){return co(uo)[0]},unstable_isNewReconciler:!1},Lo={readContext:oa,useCallback:Ao,useContext:oa,useEffect:xo,useImperativeHandle:Oo,useLayoutEffect:So,useMemo:Po,useReducer:ho,useRef:_o,useState:function(){return ho(uo)},useDebugValue:Eo,useDeferredValue:function(t){var e=ho(uo),n=e[0],i=e[1];return xo((function(){var e=Ya.transition;Ya.transition=1;try{i(t)}finally{Ya.transition=e}}),[t]),n},useTransition:function(){var t=ho(uo)[0];return[_o().current,t]},useMutableSource:vo,useOpaqueIdentifier:function(){return ho(uo)[0]},unstable_isNewReconciler:!1},Bo=w.ReactCurrentOwner,Fo=!1;function Io(t,e,n,i){e.child=null===t?Ea(e,null,n,i):Oa(e,t.child,n,i)}function zo(t,e,n,i,r){n=n.render;var a=e.ref;return aa(e,r),i=oo(t,e,n,i,a,r),null===t||Fo?(e.flags|=1,Io(t,e,i,r),e.child):(e.updateQueue=t.updateQueue,e.flags&=-517,t.lanes&=~r,as(t,e,r))}function No(t,e,n,i,r,a){if(null===t){var o=n.type;return"function"!==typeof o||Gl(o)||void 0!==o.defaultProps||null!==n.compare||void 0!==n.defaultProps?((t=ql(n.type,null,i,e,e.mode,a)).ref=e.ref,t.return=e,e.child=t):(e.tag=15,e.type=o,Uo(t,e,o,i,r,a))}return o=t.child,0===(r&a)&&(r=o.memoizedProps,(n=null!==(n=n.compare)?n:di)(r,i)&&t.ref===e.ref)?as(t,e,a):(e.flags|=1,(t=Xl(o,i)).ref=e.ref,t.return=e,e.child=t)}function Uo(t,e,n,i,r,a){if(null!==t&&di(t.memoizedProps,i)&&t.ref===e.ref){if(Fo=!1,0===(a&r))return e.lanes=t.lanes,as(t,e,a);0!==(16384&t.flags)&&(Fo=!0)}return Vo(t,e,n,i,a)}function Ho(t,e,n){var i=e.pendingProps,r=i.children,a=null!==t?t.memoizedState:null;if("hidden"===i.mode||"unstable-defer-without-hiding"===i.mode)if(0===(4&e.mode))e.memoizedState={baseLanes:0},kl(e,n);else{if(0===(1073741824&n))return t=null!==a?a.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t},kl(e,t),null;e.memoizedState={baseLanes:0},kl(e,null!==a?a.baseLanes:n)}else null!==a?(i=a.baseLanes|n,e.memoizedState=null):i=n,kl(e,i);return Io(t,e,r,n),e.child}function Wo(t,e){var n=e.ref;(null===t&&null!==n||null!==t&&t.ref!==n)&&(e.flags|=128)}function Vo(t,e,n,i,r){var a=yr(n)?vr:fr.current;return a=gr(e,a),aa(e,r),n=oo(t,e,n,i,a,r),null===t||Fo?(e.flags|=1,Io(t,e,n,r),e.child):(e.updateQueue=t.updateQueue,e.flags&=-517,t.lanes&=~r,as(t,e,r))}function Go(t,e,n,i,r){if(yr(n)){var a=!0;wr(e)}else a=!1;if(aa(e,r),null===e.stateNode)null!==t&&(t.alternate=null,e.alternate=null,e.flags|=2),_a(e,n,i),wa(e,n,i,r),i=!0;else if(null===t){var o=e.stateNode,s=e.memoizedProps;o.props=s;var l=o.context,u=n.contextType;"object"===typeof u&&null!==u?u=oa(u):u=gr(e,u=yr(n)?vr:fr.current);var c=n.getDerivedStateFromProps,h="function"===typeof c||"function"===typeof o.getSnapshotBeforeUpdate;h||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==i||l!==u)&&ba(e,o,i,u),sa=!1;var d=e.memoizedState;o.state=d,fa(e,i,o,r),l=e.memoizedState,s!==i||d!==l||pr.current||sa?("function"===typeof c&&(ga(e,n,c,i),l=e.memoizedState),(s=sa||ma(e,n,s,i,d,l,u))?(h||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(e.flags|=4)):("function"===typeof o.componentDidMount&&(e.flags|=4),e.memoizedProps=i,e.memoizedState=l),o.props=i,o.state=l,o.context=u,i=s):("function"===typeof o.componentDidMount&&(e.flags|=4),i=!1)}else{o=e.stateNode,ua(t,e),s=e.memoizedProps,u=e.type===e.elementType?s:Yr(e.type,s),o.props=u,h=e.pendingProps,d=o.context,"object"===typeof(l=n.contextType)&&null!==l?l=oa(l):l=gr(e,l=yr(n)?vr:fr.current);var f=n.getDerivedStateFromProps;(c="function"===typeof f||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==h||d!==l)&&ba(e,o,i,l),sa=!1,d=e.memoizedState,o.state=d,fa(e,i,o,r);var p=e.memoizedState;s!==h||d!==p||pr.current||sa?("function"===typeof f&&(ga(e,n,f,i),p=e.memoizedState),(u=sa||ma(e,n,u,i,d,p,l))?(c||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(i,p,l),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(i,p,l)),"function"===typeof o.componentDidUpdate&&(e.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(e.flags|=256)):("function"!==typeof o.componentDidUpdate||s===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===t.memoizedProps&&d===t.memoizedState||(e.flags|=256),e.memoizedProps=i,e.memoizedState=p),o.props=i,o.state=p,o.context=l,i=u):("function"!==typeof o.componentDidUpdate||s===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===t.memoizedProps&&d===t.memoizedState||(e.flags|=256),i=!1)}return Xo(t,e,n,i,a,r)}function Xo(t,e,n,i,r,a){Wo(t,e);var o=0!==(64&e.flags);if(!i&&!o)return r&&kr(e,n,!1),as(t,e,a);i=e.stateNode,Bo.current=e;var s=o&&"function"!==typeof n.getDerivedStateFromError?null:i.render();return e.flags|=1,null!==t&&o?(e.child=Oa(e,t.child,null,a),e.child=Oa(e,null,s,a)):Io(t,e,s,a),e.memoizedState=i.state,r&&kr(e,n,!0),e.child}function qo(t){var e=t.stateNode;e.pendingContext?_r(0,e.pendingContext,e.pendingContext!==e.context):e.context&&_r(0,e.context,!1),Da(t,e.containerInfo)}var Ko,Zo,Qo,Yo={dehydrated:null,retryLane:0};function $o(t,e,n){var i,r=e.pendingProps,a=Fa.current,o=!1;return(i=0!==(64&e.flags))||(i=(null===t||null!==t.memoizedState)&&0!==(2&a)),i?(o=!0,e.flags&=-65):null!==t&&null===t.memoizedState||void 0===r.fallback||!0===r.unstable_avoidThisFallback||(a|=1),hr(Fa,1&a),null===t?(void 0!==r.fallback&&Va(e),t=r.children,a=r.fallback,o?(t=Jo(e,t,a,n),e.child.memoizedState={baseLanes:n},e.memoizedState=Yo,t):"number"===typeof r.unstable_expectedLoadTime?(t=Jo(e,t,a,n),e.child.memoizedState={baseLanes:n},e.memoizedState=Yo,e.lanes=33554432,t):((n=Zl({mode:"visible",children:t},e.mode,n,null)).return=e,e.child=n)):(t.memoizedState,o?(r=es(t,e,r.children,r.fallback,n),o=e.child,a=t.child.memoizedState,o.memoizedState=null===a?{baseLanes:n}:{baseLanes:a.baseLanes|n},o.childLanes=t.childLanes&~n,e.memoizedState=Yo,r):(n=ts(t,e,r.children,n),e.memoizedState=null,n))}function Jo(t,e,n,i){var r=t.mode,a=t.child;return e={mode:"hidden",children:e},0===(2&r)&&null!==a?(a.childLanes=0,a.pendingProps=e):a=Zl(e,r,0,null),n=Kl(n,r,i,null),a.return=t,n.return=t,a.sibling=n,t.child=a,n}function ts(t,e,n,i){var r=t.child;return t=r.sibling,n=Xl(r,{mode:"visible",children:n}),0===(2&e.mode)&&(n.lanes=i),n.return=e,n.sibling=null,null!==t&&(t.nextEffect=null,t.flags=8,e.firstEffect=e.lastEffect=t),e.child=n}function es(t,e,n,i,r){var a=e.mode,o=t.child;t=o.sibling;var s={mode:"hidden",children:n};return 0===(2&a)&&e.child!==o?((n=e.child).childLanes=0,n.pendingProps=s,null!==(o=n.lastEffect)?(e.firstEffect=n.firstEffect,e.lastEffect=o,o.nextEffect=null):e.firstEffect=e.lastEffect=null):n=Xl(o,s),null!==t?i=Xl(t,i):(i=Kl(i,a,r,null)).flags|=2,i.return=e,n.return=e,n.sibling=i,e.child=n,i}function ns(t,e){t.lanes|=e;var n=t.alternate;null!==n&&(n.lanes|=e),ra(t.return,e)}function is(t,e,n,i,r,a){var o=t.memoizedState;null===o?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r,lastEffect:a}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=i,o.tail=n,o.tailMode=r,o.lastEffect=a)}function rs(t,e,n){var i=e.pendingProps,r=i.revealOrder,a=i.tail;if(Io(t,e,i.children,n),0!==(2&(i=Fa.current)))i=1&i|2,e.flags|=64;else{if(null!==t&&0!==(64&t.flags))t:for(t=e.child;null!==t;){if(13===t.tag)null!==t.memoizedState&&ns(t,n);else if(19===t.tag)ns(t,n);else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break t;for(;null===t.sibling;){if(null===t.return||t.return===e)break t;t=t.return}t.sibling.return=t.return,t=t.sibling}i&=1}if(hr(Fa,i),0===(2&e.mode))e.memoizedState=null;else switch(r){case"forwards":for(n=e.child,r=null;null!==n;)null!==(t=n.alternate)&&null===Ia(t)&&(r=n),n=n.sibling;null===(n=r)?(r=e.child,e.child=null):(r=n.sibling,n.sibling=null),is(e,!1,r,n,a,e.lastEffect);break;case"backwards":for(n=null,r=e.child,e.child=null;null!==r;){if(null!==(t=r.alternate)&&null===Ia(t)){e.child=r;break}t=r.sibling,r.sibling=n,n=r,r=t}is(e,!0,n,null,a,e.lastEffect);break;case"together":is(e,!1,null,null,void 0,e.lastEffect);break;default:e.memoizedState=null}return e.child}function as(t,e,n){if(null!==t&&(e.dependencies=t.dependencies),Us|=e.lanes,0!==(n&e.childLanes)){if(null!==t&&e.child!==t.child)throw Error(o(153));if(null!==e.child){for(n=Xl(t=e.child,t.pendingProps),e.child=n,n.return=e;null!==t.sibling;)t=t.sibling,(n=n.sibling=Xl(t,t.pendingProps)).return=e;n.sibling=null}return e.child}return null}function os(t,e){if(!Ua)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;null!==e;)null!==e.alternate&&(n=e),e=e.sibling;null===n?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var i=null;null!==n;)null!==n.alternate&&(i=n),n=n.sibling;null===i?e||null===t.tail?t.tail=null:t.tail.sibling=null:i.sibling=null}}function ss(t,e,n){var i=e.pendingProps;switch(e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:case 17:return yr(e.type)&&mr(),null;case 3:return Ma(),cr(pr),cr(fr),Za(),(i=e.stateNode).pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),null!==t&&null!==t.child||(Xa(e)?e.flags|=4:i.hydrate||(e.flags|=256)),null;case 5:Ba(e);var a=Ra(Ta.current);if(n=e.type,null!==t&&null!=e.stateNode)Zo(t,e,n,i),t.ref!==e.ref&&(e.flags|=128);else{if(!i){if(null===e.stateNode)throw Error(o(166));return null}if(t=Ra(Pa.current),Xa(e)){i=e.stateNode,n=e.type;var s=e.memoizedProps;switch(i[$i]=e,i[Ji]=s,n){case"dialog":ji("cancel",i),ji("close",i);break;case"iframe":case"object":case"embed":ji("load",i);break;case"video":case"audio":for(t=0;t<Oi.length;t++)ji(Oi[t],i);break;case"source":ji("error",i);break;case"img":case"image":case"link":ji("error",i),ji("load",i);break;case"details":ji("toggle",i);break;case"input":tt(i,s),ji("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!s.multiple},ji("invalid",i);break;case"textarea":lt(i,s),ji("invalid",i)}for(var u in St(n,s),t=null,s)s.hasOwnProperty(u)&&(a=s[u],"children"===u?"string"===typeof a?i.textContent!==a&&(t=["children",a]):"number"===typeof a&&i.textContent!==""+a&&(t=["children",""+a]):l.hasOwnProperty(u)&&null!=a&&"onScroll"===u&&ji("scroll",i));switch(n){case"input":Q(i),it(i,s,!0);break;case"textarea":Q(i),ct(i);break;case"select":case"option":break;default:"function"===typeof s.onClick&&(i.onclick=Ni)}i=t,e.updateQueue=i,null!==i&&(e.flags|=4)}else{switch(u=9===a.nodeType?a:a.ownerDocument,t===ht&&(t=ft(n)),t===ht?"script"===n?((t=u.createElement("div")).innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):"string"===typeof i.is?t=u.createElement(n,{is:i.is}):(t=u.createElement(n),"select"===n&&(u=t,i.multiple?u.multiple=!0:i.size&&(u.size=i.size))):t=u.createElementNS(t,n),t[$i]=e,t[Ji]=i,Ko(t,e),e.stateNode=t,u=Ct(n,i),n){case"dialog":ji("cancel",t),ji("close",t),a=i;break;case"iframe":case"object":case"embed":ji("load",t),a=i;break;case"video":case"audio":for(a=0;a<Oi.length;a++)ji(Oi[a],t);a=i;break;case"source":ji("error",t),a=i;break;case"img":case"image":case"link":ji("error",t),ji("load",t),a=i;break;case"details":ji("toggle",t),a=i;break;case"input":tt(t,i),a=J(t,i),ji("invalid",t);break;case"option":a=at(t,i);break;case"select":t._wrapperState={wasMultiple:!!i.multiple},a=r({},i,{value:void 0}),ji("invalid",t);break;case"textarea":lt(t,i),a=st(t,i),ji("invalid",t);break;default:a=i}St(n,a);var c=a;for(s in c)if(c.hasOwnProperty(s)){var h=c[s];"style"===s?kt(t,h):"dangerouslySetInnerHTML"===s?null!=(h=h?h.__html:void 0)&&yt(t,h):"children"===s?"string"===typeof h?("textarea"!==n||""!==h)&&mt(t,h):"number"===typeof h&&mt(t,""+h):"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&"autoFocus"!==s&&(l.hasOwnProperty(s)?null!=h&&"onScroll"===s&&ji("scroll",t):null!=h&&b(t,s,h,u))}switch(n){case"input":Q(t),it(t,i,!1);break;case"textarea":Q(t),ct(t);break;case"option":null!=i.value&&t.setAttribute("value",""+K(i.value));break;case"select":t.multiple=!!i.multiple,null!=(s=i.value)?ot(t,!!i.multiple,s,!1):null!=i.defaultValue&&ot(t,!!i.multiple,i.defaultValue,!0);break;default:"function"===typeof a.onClick&&(t.onclick=Ni)}Wi(n,i)&&(e.flags|=4)}null!==e.ref&&(e.flags|=128)}return null;case 6:if(t&&null!=e.stateNode)Qo(0,e,t.memoizedProps,i);else{if("string"!==typeof i&&null===e.stateNode)throw Error(o(166));n=Ra(Ta.current),Ra(Pa.current),Xa(e)?(i=e.stateNode,n=e.memoizedProps,i[$i]=e,i.nodeValue!==n&&(e.flags|=4)):((i=(9===n.nodeType?n:n.ownerDocument).createTextNode(i))[$i]=e,e.stateNode=i)}return null;case 13:return cr(Fa),i=e.memoizedState,0!==(64&e.flags)?(e.lanes=n,e):(i=null!==i,n=!1,null===t?void 0!==e.memoizedProps.fallback&&Xa(e):n=null!==t.memoizedState,i&&!n&&0!==(2&e.mode)&&(null===t&&!0!==e.memoizedProps.unstable_avoidThisFallback||0!==(1&Fa.current)?0===Is&&(Is=3):(0!==Is&&3!==Is||(Is=4),null===Ds||0===(134217727&Us)&&0===(134217727&Hs)||ml(Ds,Ls))),(i||n)&&(e.flags|=4),null);case 4:return Ma(),null===t&&Ri(e.stateNode.containerInfo),null;case 10:return ia(e),null;case 19:if(cr(Fa),null===(i=e.memoizedState))return null;if(s=0!==(64&e.flags),null===(u=i.rendering))if(s)os(i,!1);else{if(0!==Is||null!==t&&0!==(64&t.flags))for(t=e.child;null!==t;){if(null!==(u=Ia(t))){for(e.flags|=64,os(i,!1),null!==(s=u.updateQueue)&&(e.updateQueue=s,e.flags|=4),null===i.lastEffect&&(e.firstEffect=null),e.lastEffect=i.lastEffect,i=n,n=e.child;null!==n;)t=i,(s=n).flags&=2,s.nextEffect=null,s.firstEffect=null,s.lastEffect=null,null===(u=s.alternate)?(s.childLanes=0,s.lanes=t,s.child=null,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=u.childLanes,s.lanes=u.lanes,s.child=u.child,s.memoizedProps=u.memoizedProps,s.memoizedState=u.memoizedState,s.updateQueue=u.updateQueue,s.type=u.type,t=u.dependencies,s.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return hr(Fa,1&Fa.current|2),e.child}t=t.sibling}null!==i.tail&&Wr()>Xs&&(e.flags|=64,s=!0,os(i,!1),e.lanes=33554432)}else{if(!s)if(null!==(t=Ia(u))){if(e.flags|=64,s=!0,null!==(n=t.updateQueue)&&(e.updateQueue=n,e.flags|=4),os(i,!0),null===i.tail&&"hidden"===i.tailMode&&!u.alternate&&!Ua)return null!==(e=e.lastEffect=i.lastEffect)&&(e.nextEffect=null),null}else 2*Wr()-i.renderingStartTime>Xs&&1073741824!==n&&(e.flags|=64,s=!0,os(i,!1),e.lanes=33554432);i.isBackwards?(u.sibling=e.child,e.child=u):(null!==(n=i.last)?n.sibling=u:e.child=u,i.last=u)}return null!==i.tail?(n=i.tail,i.rendering=n,i.tail=n.sibling,i.lastEffect=e.lastEffect,i.renderingStartTime=Wr(),n.sibling=null,e=Fa.current,hr(Fa,s?1&e|2:1&e),n):null;case 23:case 24:return xl(),null!==t&&null!==t.memoizedState!==(null!==e.memoizedState)&&"unstable-defer-without-hiding"!==i.mode&&(e.flags|=4),null}throw Error(o(156,e.tag))}function ls(t){switch(t.tag){case 1:yr(t.type)&&mr();var e=t.flags;return 4096&e?(t.flags=-4097&e|64,t):null;case 3:if(Ma(),cr(pr),cr(fr),Za(),0!==(64&(e=t.flags)))throw Error(o(285));return t.flags=-4097&e|64,t;case 5:return Ba(t),null;case 13:return cr(Fa),4096&(e=t.flags)?(t.flags=-4097&e|64,t):null;case 19:return cr(Fa),null;case 4:return Ma(),null;case 10:return ia(t),null;case 23:case 24:return xl(),null;default:return null}}function us(t,e){try{var n="",i=e;do{n+=X(i),i=i.return}while(i);var r=n}catch(a){r="\nError generating stack: "+a.message+"\n"+a.stack}return{value:t,source:e,stack:r}}function cs(t,e){try{console.error(e.value)}catch(n){setTimeout((function(){throw n}))}}Ko=function(t,e){for(var n=e.child;null!==n;){if(5===n.tag||6===n.tag)t.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===e)break;for(;null===n.sibling;){if(null===n.return||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Zo=function(t,e,n,i){var a=t.memoizedProps;if(a!==i){t=e.stateNode,Ra(Pa.current);var o,s=null;switch(n){case"input":a=J(t,a),i=J(t,i),s=[];break;case"option":a=at(t,a),i=at(t,i),s=[];break;case"select":a=r({},a,{value:void 0}),i=r({},i,{value:void 0}),s=[];break;case"textarea":a=st(t,a),i=st(t,i),s=[];break;default:"function"!==typeof a.onClick&&"function"===typeof i.onClick&&(t.onclick=Ni)}for(h in St(n,i),n=null,a)if(!i.hasOwnProperty(h)&&a.hasOwnProperty(h)&&null!=a[h])if("style"===h){var u=a[h];for(o in u)u.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else"dangerouslySetInnerHTML"!==h&&"children"!==h&&"suppressContentEditableWarning"!==h&&"suppressHydrationWarning"!==h&&"autoFocus"!==h&&(l.hasOwnProperty(h)?s||(s=[]):(s=s||[]).push(h,null));for(h in i){var c=i[h];if(u=null!=a?a[h]:void 0,i.hasOwnProperty(h)&&c!==u&&(null!=c||null!=u))if("style"===h)if(u){for(o in u)!u.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&u[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(s||(s=[]),s.push(h,n)),n=c;else"dangerouslySetInnerHTML"===h?(c=c?c.__html:void 0,u=u?u.__html:void 0,null!=c&&u!==c&&(s=s||[]).push(h,c)):"children"===h?"string"!==typeof c&&"number"!==typeof c||(s=s||[]).push(h,""+c):"suppressContentEditableWarning"!==h&&"suppressHydrationWarning"!==h&&(l.hasOwnProperty(h)?(null!=c&&"onScroll"===h&&ji("scroll",t),s||u===c||(s=[])):"object"===typeof c&&null!==c&&c.$$typeof===L?c.toString():(s=s||[]).push(h,c))}n&&(s=s||[]).push("style",n);var h=s;(e.updateQueue=h)&&(e.flags|=4)}},Qo=function(t,e,n,i){n!==i&&(e.flags|=4)};var hs="function"===typeof WeakMap?WeakMap:Map;function ds(t,e,n){(n=ca(-1,n)).tag=3,n.payload={element:null};var i=e.value;return n.callback=function(){Qs||(Qs=!0,Ys=i),cs(0,e)},n}function fs(t,e,n){(n=ca(-1,n)).tag=3;var i=t.type.getDerivedStateFromError;if("function"===typeof i){var r=e.value;n.payload=function(){return cs(0,e),i(r)}}var a=t.stateNode;return null!==a&&"function"===typeof a.componentDidCatch&&(n.callback=function(){"function"!==typeof i&&(null===$s?$s=new Set([this]):$s.add(this),cs(0,e));var t=e.stack;this.componentDidCatch(e.value,{componentStack:null!==t?t:""})}),n}var ps="function"===typeof WeakSet?WeakSet:Set;function vs(t){var e=t.ref;if(null!==e)if("function"===typeof e)try{e(null)}catch(n){Nl(t,n)}else e.current=null}function gs(t,e){switch(e.tag){case 0:case 11:case 15:case 22:case 5:case 6:case 4:case 17:return;case 1:if(256&e.flags&&null!==t){var n=t.memoizedProps,i=t.memoizedState;e=(t=e.stateNode).getSnapshotBeforeUpdate(e.elementType===e.type?n:Yr(e.type,n),i),t.__reactInternalSnapshotBeforeUpdate=e}return;case 3:return void(256&e.flags&&qi(e.stateNode.containerInfo))}throw Error(o(163))}function ys(t,e,n){switch(n.tag){case 0:case 11:case 15:case 22:if(null!==(e=null!==(e=n.updateQueue)?e.lastEffect:null)){t=e=e.next;do{if(3===(3&t.tag)){var i=t.create;t.destroy=i()}t=t.next}while(t!==e)}if(null!==(e=null!==(e=n.updateQueue)?e.lastEffect:null)){t=e=e.next;do{var r=t;i=r.next,0!==(4&(r=r.tag))&&0!==(1&r)&&(Fl(n,t),Bl(n,t)),t=i}while(t!==e)}return;case 1:return t=n.stateNode,4&n.flags&&(null===e?t.componentDidMount():(i=n.elementType===n.type?e.memoizedProps:Yr(n.type,e.memoizedProps),t.componentDidUpdate(i,e.memoizedState,t.__reactInternalSnapshotBeforeUpdate))),void(null!==(e=n.updateQueue)&&pa(n,e,t));case 3:if(null!==(e=n.updateQueue)){if(t=null,null!==n.child)switch(n.child.tag){case 5:case 1:t=n.child.stateNode}pa(n,e,t)}return;case 5:return t=n.stateNode,void(null===e&&4&n.flags&&Wi(n.type,n.memoizedProps)&&t.focus());case 6:case 4:case 12:case 19:case 17:case 20:case 21:case 23:case 24:return;case 13:return void(null===n.memoizedState&&(n=n.alternate,null!==n&&(n=n.memoizedState,null!==n&&(n=n.dehydrated,null!==n&&ke(n)))))}throw Error(o(163))}function ms(t,e){for(var n=t;;){if(5===n.tag){var i=n.stateNode;if(e)"function"===typeof(i=i.style).setProperty?i.setProperty("display","none","important"):i.display="none";else{i=n.stateNode;var r=n.memoizedProps.style;r=void 0!==r&&null!==r&&r.hasOwnProperty("display")?r.display:null,i.style.display=wt("display",r)}}else if(6===n.tag)n.stateNode.nodeValue=e?"":n.memoizedProps;else if((23!==n.tag&&24!==n.tag||null===n.memoizedState||n===t)&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}}function _s(t,e){if(Sr&&"function"===typeof Sr.onCommitFiberUnmount)try{Sr.onCommitFiberUnmount(xr,e)}catch(a){}switch(e.tag){case 0:case 11:case 14:case 15:case 22:if(null!==(t=e.updateQueue)&&null!==(t=t.lastEffect)){var n=t=t.next;do{var i=n,r=i.destroy;if(i=i.tag,void 0!==r)if(0!==(4&i))Fl(e,n);else{i=e;try{r()}catch(a){Nl(i,a)}}n=n.next}while(n!==t)}break;case 1:if(vs(e),"function"===typeof(t=e.stateNode).componentWillUnmount)try{t.props=e.memoizedProps,t.state=e.memoizedState,t.componentWillUnmount()}catch(a){Nl(e,a)}break;case 5:vs(e);break;case 4:Cs(t,e)}}function bs(t){t.alternate=null,t.child=null,t.dependencies=null,t.firstEffect=null,t.lastEffect=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.return=null,t.updateQueue=null}function ws(t){return 5===t.tag||3===t.tag||4===t.tag}function ks(t){t:{for(var e=t.return;null!==e;){if(ws(e))break t;e=e.return}throw Error(o(160))}var n=e;switch(e=n.stateNode,n.tag){case 5:var i=!1;break;case 3:case 4:e=e.containerInfo,i=!0;break;default:throw Error(o(161))}16&n.flags&&(mt(e,""),n.flags&=-17);t:e:for(n=t;;){for(;null===n.sibling;){if(null===n.return||ws(n.return)){n=null;break t}n=n.return}for(n.sibling.return=n.return,n=n.sibling;5!==n.tag&&6!==n.tag&&18!==n.tag;){if(2&n.flags)continue e;if(null===n.child||4===n.tag)continue e;n.child.return=n,n=n.child}if(!(2&n.flags)){n=n.stateNode;break t}}i?xs(t,n,e):Ss(t,n,e)}function xs(t,e,n){var i=t.tag,r=5===i||6===i;if(r)t=r?t.stateNode:t.stateNode.instance,e?8===n.nodeType?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(8===n.nodeType?(e=n.parentNode).insertBefore(t,n):(e=n).appendChild(t),null!==(n=n._reactRootContainer)&&void 0!==n||null!==e.onclick||(e.onclick=Ni));else if(4!==i&&null!==(t=t.child))for(xs(t,e,n),t=t.sibling;null!==t;)xs(t,e,n),t=t.sibling}function Ss(t,e,n){var i=t.tag,r=5===i||6===i;if(r)t=r?t.stateNode:t.stateNode.instance,e?n.insertBefore(t,e):n.appendChild(t);else if(4!==i&&null!==(t=t.child))for(Ss(t,e,n),t=t.sibling;null!==t;)Ss(t,e,n),t=t.sibling}function Cs(t,e){for(var n,i,r=e,a=!1;;){if(!a){a=r.return;t:for(;;){if(null===a)throw Error(o(160));switch(n=a.stateNode,a.tag){case 5:i=!1;break t;case 3:case 4:n=n.containerInfo,i=!0;break t}a=a.return}a=!0}if(5===r.tag||6===r.tag){t:for(var s=t,l=r,u=l;;)if(_s(s,u),null!==u.child&&4!==u.tag)u.child.return=u,u=u.child;else{if(u===l)break t;for(;null===u.sibling;){if(null===u.return||u.return===l)break t;u=u.return}u.sibling.return=u.return,u=u.sibling}i?(s=n,l=r.stateNode,8===s.nodeType?s.parentNode.removeChild(l):s.removeChild(l)):n.removeChild(r.stateNode)}else if(4===r.tag){if(null!==r.child){n=r.stateNode.containerInfo,i=!0,r.child.return=r,r=r.child;continue}}else if(_s(t,r),null!==r.child){r.child.return=r,r=r.child;continue}if(r===e)break;for(;null===r.sibling;){if(null===r.return||r.return===e)return;4===(r=r.return).tag&&(a=!1)}r.sibling.return=r.return,r=r.sibling}}function Os(t,e){switch(e.tag){case 0:case 11:case 14:case 15:case 22:var n=e.updateQueue;if(null!==(n=null!==n?n.lastEffect:null)){var i=n=n.next;do{3===(3&i.tag)&&(t=i.destroy,i.destroy=void 0,void 0!==t&&t()),i=i.next}while(i!==n)}return;case 1:case 12:case 17:return;case 5:if(null!=(n=e.stateNode)){i=e.memoizedProps;var r=null!==t?t.memoizedProps:i;t=e.type;var a=e.updateQueue;if(e.updateQueue=null,null!==a){for(n[Ji]=i,"input"===t&&"radio"===i.type&&null!=i.name&&et(n,i),Ct(t,r),e=Ct(t,i),r=0;r<a.length;r+=2){var s=a[r],l=a[r+1];"style"===s?kt(n,l):"dangerouslySetInnerHTML"===s?yt(n,l):"children"===s?mt(n,l):b(n,s,l,e)}switch(t){case"input":nt(n,i);break;case"textarea":ut(n,i);break;case"select":t=n._wrapperState.wasMultiple,n._wrapperState.wasMultiple=!!i.multiple,null!=(a=i.value)?ot(n,!!i.multiple,a,!1):t!==!!i.multiple&&(null!=i.defaultValue?ot(n,!!i.multiple,i.defaultValue,!0):ot(n,!!i.multiple,i.multiple?[]:"",!1))}}}return;case 6:if(null===e.stateNode)throw Error(o(162));return void(e.stateNode.nodeValue=e.memoizedProps);case 3:return void((n=e.stateNode).hydrate&&(n.hydrate=!1,ke(n.containerInfo)));case 13:return null!==e.memoizedState&&(Gs=Wr(),ms(e.child,!0)),void Es(e);case 19:return void Es(e);case 23:case 24:return void ms(e,null!==e.memoizedState)}throw Error(o(163))}function Es(t){var e=t.updateQueue;if(null!==e){t.updateQueue=null;var n=t.stateNode;null===n&&(n=t.stateNode=new ps),e.forEach((function(e){var i=Hl.bind(null,t,e);n.has(e)||(n.add(e),e.then(i,i))}))}}function As(t,e){return null!==t&&(null===(t=t.memoizedState)||null!==t.dehydrated)&&(null!==(e=e.memoizedState)&&null===e.dehydrated)}var Ps=Math.ceil,js=w.ReactCurrentDispatcher,Ts=w.ReactCurrentOwner,Rs=0,Ds=null,Ms=null,Ls=0,Bs=0,Fs=ur(0),Is=0,zs=null,Ns=0,Us=0,Hs=0,Ws=0,Vs=null,Gs=0,Xs=1/0;function qs(){Xs=Wr()+500}var Ks,Zs=null,Qs=!1,Ys=null,$s=null,Js=!1,tl=null,el=90,nl=[],il=[],rl=null,al=0,ol=null,sl=-1,ll=0,ul=0,cl=null,hl=!1;function dl(){return 0!==(48&Rs)?Wr():-1!==sl?sl:sl=Wr()}function fl(t){if(0===(2&(t=t.mode)))return 1;if(0===(4&t))return 99===Vr()?1:2;if(0===ll&&(ll=Ns),0!==Qr.transition){0!==ul&&(ul=null!==Vs?Vs.pendingLanes:0),t=ll;var e=4186112&~ul;return 0===(e&=-e)&&(0===(e=(t=4186112&~t)&-t)&&(e=8192)),e}return t=Vr(),0!==(4&Rs)&&98===t?t=Ne(12,ll):t=Ne(t=function(t){switch(t){case 99:return 15;case 98:return 10;case 97:case 96:return 8;case 95:return 2;default:return 0}}(t),ll),t}function pl(t,e,n){if(50<al)throw al=0,ol=null,Error(o(185));if(null===(t=vl(t,e)))return null;We(t,e,n),t===Ds&&(Hs|=e,4===Is&&ml(t,Ls));var i=Vr();1===e?0!==(8&Rs)&&0===(48&Rs)?_l(t):(gl(t,n),0===Rs&&(qs(),Kr())):(0===(4&Rs)||98!==i&&99!==i||(null===rl?rl=new Set([t]):rl.add(t)),gl(t,n)),Vs=t}function vl(t,e){t.lanes|=e;var n=t.alternate;for(null!==n&&(n.lanes|=e),n=t,t=t.return;null!==t;)t.childLanes|=e,null!==(n=t.alternate)&&(n.childLanes|=e),n=t,t=t.return;return 3===n.tag?n.stateNode:null}function gl(t,e){for(var n=t.callbackNode,i=t.suspendedLanes,r=t.pingedLanes,a=t.expirationTimes,s=t.pendingLanes;0<s;){var l=31-Ve(s),u=1<<l,c=a[l];if(-1===c){if(0===(u&i)||0!==(u&r)){c=e,Fe(u);var h=Be;a[l]=10<=h?c+250:6<=h?c+5e3:-1}}else c<=e&&(t.expiredLanes|=u);s&=~u}if(i=Ie(t,t===Ds?Ls:0),e=Be,0===i)null!==n&&(n!==Fr&&Er(n),t.callbackNode=null,t.callbackPriority=0);else{if(null!==n){if(t.callbackPriority===e)return;n!==Fr&&Er(n)}15===e?(n=_l.bind(null,t),null===zr?(zr=[n],Nr=Or(Rr,Zr)):zr.push(n),n=Fr):14===e?n=qr(99,_l.bind(null,t)):(n=function(t){switch(t){case 15:case 14:return 99;case 13:case 12:case 11:case 10:return 98;case 9:case 8:case 7:case 6:case 4:case 5:return 97;case 3:case 2:case 1:return 95;case 0:return 90;default:throw Error(o(358,t))}}(e),n=qr(n,yl.bind(null,t))),t.callbackPriority=e,t.callbackNode=n}}function yl(t){if(sl=-1,ul=ll=0,0!==(48&Rs))throw Error(o(327));var e=t.callbackNode;if(Ll()&&t.callbackNode!==e)return null;var n=Ie(t,t===Ds?Ls:0);if(0===n)return null;var i=n,r=Rs;Rs|=16;var a=Ol();for(Ds===t&&Ls===i||(qs(),Sl(t,i));;)try{Pl();break}catch(l){Cl(t,l)}if(na(),js.current=a,Rs=r,null!==Ms?i=0:(Ds=null,Ls=0,i=Is),0!==(Ns&Hs))Sl(t,0);else if(0!==i){if(2===i&&(Rs|=64,t.hydrate&&(t.hydrate=!1,qi(t.containerInfo)),0!==(n=ze(t))&&(i=El(t,n))),1===i)throw e=zs,Sl(t,0),ml(t,n),gl(t,Wr()),e;switch(t.finishedWork=t.current.alternate,t.finishedLanes=n,i){case 0:case 1:throw Error(o(345));case 2:case 5:Rl(t);break;case 3:if(ml(t,n),(62914560&n)===n&&10<(i=Gs+500-Wr())){if(0!==Ie(t,0))break;if(((r=t.suspendedLanes)&n)!==n){dl(),t.pingedLanes|=t.suspendedLanes&r;break}t.timeoutHandle=Gi(Rl.bind(null,t),i);break}Rl(t);break;case 4:if(ml(t,n),(4186112&n)===n)break;for(i=t.eventTimes,r=-1;0<n;){var s=31-Ve(n);a=1<<s,(s=i[s])>r&&(r=s),n&=~a}if(n=r,10<(n=(120>(n=Wr()-n)?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Ps(n/1960))-n)){t.timeoutHandle=Gi(Rl.bind(null,t),n);break}Rl(t);break;default:throw Error(o(329))}}return gl(t,Wr()),t.callbackNode===e?yl.bind(null,t):null}function ml(t,e){for(e&=~Ws,e&=~Hs,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Ve(e),i=1<<n;t[n]=-1,e&=~i}}function _l(t){if(0!==(48&Rs))throw Error(o(327));if(Ll(),t===Ds&&0!==(t.expiredLanes&Ls)){var e=Ls,n=El(t,e);0!==(Ns&Hs)&&(n=El(t,e=Ie(t,e)))}else n=El(t,e=Ie(t,0));if(0!==t.tag&&2===n&&(Rs|=64,t.hydrate&&(t.hydrate=!1,qi(t.containerInfo)),0!==(e=ze(t))&&(n=El(t,e))),1===n)throw n=zs,Sl(t,0),ml(t,e),gl(t,Wr()),n;return t.finishedWork=t.current.alternate,t.finishedLanes=e,Rl(t),gl(t,Wr()),null}function bl(t,e){var n=Rs;Rs|=1;try{return t(e)}finally{0===(Rs=n)&&(qs(),Kr())}}function wl(t,e){var n=Rs;Rs&=-2,Rs|=8;try{return t(e)}finally{0===(Rs=n)&&(qs(),Kr())}}function kl(t,e){hr(Fs,Bs),Bs|=e,Ns|=e}function xl(){Bs=Fs.current,cr(Fs)}function Sl(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(-1!==n&&(t.timeoutHandle=-1,Xi(n)),null!==Ms)for(n=Ms.return;null!==n;){var i=n;switch(i.tag){case 1:null!==(i=i.type.childContextTypes)&&void 0!==i&&mr();break;case 3:Ma(),cr(pr),cr(fr),Za();break;case 5:Ba(i);break;case 4:Ma();break;case 13:case 19:cr(Fa);break;case 10:ia(i);break;case 23:case 24:xl()}n=n.return}Ds=t,Ms=Xl(t.current,null),Ls=Bs=Ns=e,Is=0,zs=null,Ws=Hs=Us=0}function Cl(t,e){for(;;){var n=Ms;try{if(na(),Qa.current=Ro,no){for(var i=Ja.memoizedState;null!==i;){var r=i.queue;null!==r&&(r.pending=null),i=i.next}no=!1}if($a=0,eo=to=Ja=null,io=!1,Ts.current=null,null===n||null===n.return){Is=1,zs=e,Ms=null;break}t:{var a=t,o=n.return,s=n,l=e;if(e=Ls,s.flags|=2048,s.firstEffect=s.lastEffect=null,null!==l&&"object"===typeof l&&"function"===typeof l.then){var u=l;if(0===(2&s.mode)){var c=s.alternate;c?(s.updateQueue=c.updateQueue,s.memoizedState=c.memoizedState,s.lanes=c.lanes):(s.updateQueue=null,s.memoizedState=null)}var h=0!==(1&Fa.current),d=o;do{var f;if(f=13===d.tag){var p=d.memoizedState;if(null!==p)f=null!==p.dehydrated;else{var v=d.memoizedProps;f=void 0!==v.fallback&&(!0!==v.unstable_avoidThisFallback||!h)}}if(f){var g=d.updateQueue;if(null===g){var y=new Set;y.add(u),d.updateQueue=y}else g.add(u);if(0===(2&d.mode)){if(d.flags|=64,s.flags|=16384,s.flags&=-2981,1===s.tag)if(null===s.alternate)s.tag=17;else{var m=ca(-1,1);m.tag=2,ha(s,m)}s.lanes|=1;break t}l=void 0,s=e;var _=a.pingCache;if(null===_?(_=a.pingCache=new hs,l=new Set,_.set(u,l)):void 0===(l=_.get(u))&&(l=new Set,_.set(u,l)),!l.has(s)){l.add(s);var b=Ul.bind(null,a,u,s);u.then(b,b)}d.flags|=4096,d.lanes=e;break t}d=d.return}while(null!==d);l=Error((q(s.type)||"A React component")+" suspended while rendering, but no fallback UI was specified.\n\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display.")}5!==Is&&(Is=2),l=us(l,s),d=o;do{switch(d.tag){case 3:a=l,d.flags|=4096,e&=-e,d.lanes|=e,da(d,ds(0,a,e));break t;case 1:a=l;var w=d.type,k=d.stateNode;if(0===(64&d.flags)&&("function"===typeof w.getDerivedStateFromError||null!==k&&"function"===typeof k.componentDidCatch&&(null===$s||!$s.has(k)))){d.flags|=4096,e&=-e,d.lanes|=e,da(d,fs(d,a,e));break t}}d=d.return}while(null!==d)}Tl(n)}catch(x){e=x,Ms===n&&null!==n&&(Ms=n=n.return);continue}break}}function Ol(){var t=js.current;return js.current=Ro,null===t?Ro:t}function El(t,e){var n=Rs;Rs|=16;var i=Ol();for(Ds===t&&Ls===e||Sl(t,e);;)try{Al();break}catch(r){Cl(t,r)}if(na(),Rs=n,js.current=i,null!==Ms)throw Error(o(261));return Ds=null,Ls=0,Is}function Al(){for(;null!==Ms;)jl(Ms)}function Pl(){for(;null!==Ms&&!Ar();)jl(Ms)}function jl(t){var e=Ks(t.alternate,t,Bs);t.memoizedProps=t.pendingProps,null===e?Tl(t):Ms=e,Ts.current=null}function Tl(t){var e=t;do{var n=e.alternate;if(t=e.return,0===(2048&e.flags)){if(null!==(n=ss(n,e,Bs)))return void(Ms=n);if(24!==(n=e).tag&&23!==n.tag||null===n.memoizedState||0!==(1073741824&Bs)||0===(4&n.mode)){for(var i=0,r=n.child;null!==r;)i|=r.lanes|r.childLanes,r=r.sibling;n.childLanes=i}null!==t&&0===(2048&t.flags)&&(null===t.firstEffect&&(t.firstEffect=e.firstEffect),null!==e.lastEffect&&(null!==t.lastEffect&&(t.lastEffect.nextEffect=e.firstEffect),t.lastEffect=e.lastEffect),1<e.flags&&(null!==t.lastEffect?t.lastEffect.nextEffect=e:t.firstEffect=e,t.lastEffect=e))}else{if(null!==(n=ls(e)))return n.flags&=2047,void(Ms=n);null!==t&&(t.firstEffect=t.lastEffect=null,t.flags|=2048)}if(null!==(e=e.sibling))return void(Ms=e);Ms=e=t}while(null!==e);0===Is&&(Is=5)}function Rl(t){var e=Vr();return Xr(99,Dl.bind(null,t,e)),null}function Dl(t,e){do{Ll()}while(null!==tl);if(0!==(48&Rs))throw Error(o(327));var n=t.finishedWork;if(null===n)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(o(177));t.callbackNode=null;var i=n.lanes|n.childLanes,r=i,a=t.pendingLanes&~r;t.pendingLanes=r,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=r,t.mutableReadLanes&=r,t.entangledLanes&=r,r=t.entanglements;for(var s=t.eventTimes,l=t.expirationTimes;0<a;){var u=31-Ve(a),c=1<<u;r[u]=0,s[u]=-1,l[u]=-1,a&=~c}if(null!==rl&&0===(24&i)&&rl.has(t)&&rl.delete(t),t===Ds&&(Ms=Ds=null,Ls=0),1<n.flags?null!==n.lastEffect?(n.lastEffect.nextEffect=n,i=n.firstEffect):i=n:i=n.firstEffect,null!==i){if(r=Rs,Rs|=32,Ts.current=null,Ui=Ze,yi(s=gi())){if("selectionStart"in s)l={start:s.selectionStart,end:s.selectionEnd};else t:if(l=(l=s.ownerDocument)&&l.defaultView||window,(c=l.getSelection&&l.getSelection())&&0!==c.rangeCount){l=c.anchorNode,a=c.anchorOffset,u=c.focusNode,c=c.focusOffset;try{l.nodeType,u.nodeType}catch(O){l=null;break t}var h=0,d=-1,f=-1,p=0,v=0,g=s,y=null;e:for(;;){for(var m;g!==l||0!==a&&3!==g.nodeType||(d=h+a),g!==u||0!==c&&3!==g.nodeType||(f=h+c),3===g.nodeType&&(h+=g.nodeValue.length),null!==(m=g.firstChild);)y=g,g=m;for(;;){if(g===s)break e;if(y===l&&++p===a&&(d=h),y===u&&++v===c&&(f=h),null!==(m=g.nextSibling))break;y=(g=y).parentNode}g=m}l=-1===d||-1===f?null:{start:d,end:f}}else l=null;l=l||{start:0,end:0}}else l=null;Hi={focusedElem:s,selectionRange:l},Ze=!1,cl=null,hl=!1,Zs=i;do{try{Ml()}catch(O){if(null===Zs)throw Error(o(330));Nl(Zs,O),Zs=Zs.nextEffect}}while(null!==Zs);cl=null,Zs=i;do{try{for(s=t;null!==Zs;){var _=Zs.flags;if(16&_&&mt(Zs.stateNode,""),128&_){var b=Zs.alternate;if(null!==b){var w=b.ref;null!==w&&("function"===typeof w?w(null):w.current=null)}}switch(1038&_){case 2:ks(Zs),Zs.flags&=-3;break;case 6:ks(Zs),Zs.flags&=-3,Os(Zs.alternate,Zs);break;case 1024:Zs.flags&=-1025;break;case 1028:Zs.flags&=-1025,Os(Zs.alternate,Zs);break;case 4:Os(Zs.alternate,Zs);break;case 8:Cs(s,l=Zs);var k=l.alternate;bs(l),null!==k&&bs(k)}Zs=Zs.nextEffect}}catch(O){if(null===Zs)throw Error(o(330));Nl(Zs,O),Zs=Zs.nextEffect}}while(null!==Zs);if(w=Hi,b=gi(),_=w.focusedElem,s=w.selectionRange,b!==_&&_&&_.ownerDocument&&vi(_.ownerDocument.documentElement,_)){null!==s&&yi(_)&&(b=s.start,void 0===(w=s.end)&&(w=b),"selectionStart"in _?(_.selectionStart=b,_.selectionEnd=Math.min(w,_.value.length)):(w=(b=_.ownerDocument||document)&&b.defaultView||window).getSelection&&(w=w.getSelection(),l=_.textContent.length,k=Math.min(s.start,l),s=void 0===s.end?k:Math.min(s.end,l),!w.extend&&k>s&&(l=s,s=k,k=l),l=pi(_,k),a=pi(_,s),l&&a&&(1!==w.rangeCount||w.anchorNode!==l.node||w.anchorOffset!==l.offset||w.focusNode!==a.node||w.focusOffset!==a.offset)&&((b=b.createRange()).setStart(l.node,l.offset),w.removeAllRanges(),k>s?(w.addRange(b),w.extend(a.node,a.offset)):(b.setEnd(a.node,a.offset),w.addRange(b))))),b=[];for(w=_;w=w.parentNode;)1===w.nodeType&&b.push({element:w,left:w.scrollLeft,top:w.scrollTop});for("function"===typeof _.focus&&_.focus(),_=0;_<b.length;_++)(w=b[_]).element.scrollLeft=w.left,w.element.scrollTop=w.top}Ze=!!Ui,Hi=Ui=null,t.current=n,Zs=i;do{try{for(_=t;null!==Zs;){var x=Zs.flags;if(36&x&&ys(_,Zs.alternate,Zs),128&x){b=void 0;var S=Zs.ref;if(null!==S){var C=Zs.stateNode;Zs.tag,b=C,"function"===typeof S?S(b):S.current=b}}Zs=Zs.nextEffect}}catch(O){if(null===Zs)throw Error(o(330));Nl(Zs,O),Zs=Zs.nextEffect}}while(null!==Zs);Zs=null,Ir(),Rs=r}else t.current=n;if(Js)Js=!1,tl=t,el=e;else for(Zs=i;null!==Zs;)e=Zs.nextEffect,Zs.nextEffect=null,8&Zs.flags&&((x=Zs).sibling=null,x.stateNode=null),Zs=e;if(0===(i=t.pendingLanes)&&($s=null),1===i?t===ol?al++:(al=0,ol=t):al=0,n=n.stateNode,Sr&&"function"===typeof Sr.onCommitFiberRoot)try{Sr.onCommitFiberRoot(xr,n,void 0,64===(64&n.current.flags))}catch(O){}if(gl(t,Wr()),Qs)throw Qs=!1,t=Ys,Ys=null,t;return 0!==(8&Rs)||Kr(),null}function Ml(){for(;null!==Zs;){var t=Zs.alternate;hl||null===cl||(0!==(8&Zs.flags)?te(Zs,cl)&&(hl=!0):13===Zs.tag&&As(t,Zs)&&te(Zs,cl)&&(hl=!0));var e=Zs.flags;0!==(256&e)&&gs(t,Zs),0===(512&e)||Js||(Js=!0,qr(97,(function(){return Ll(),null}))),Zs=Zs.nextEffect}}function Ll(){if(90!==el){var t=97<el?97:el;return el=90,Xr(t,Il)}return!1}function Bl(t,e){nl.push(e,t),Js||(Js=!0,qr(97,(function(){return Ll(),null})))}function Fl(t,e){il.push(e,t),Js||(Js=!0,qr(97,(function(){return Ll(),null})))}function Il(){if(null===tl)return!1;var t=tl;if(tl=null,0!==(48&Rs))throw Error(o(331));var e=Rs;Rs|=32;var n=il;il=[];for(var i=0;i<n.length;i+=2){var r=n[i],a=n[i+1],s=r.destroy;if(r.destroy=void 0,"function"===typeof s)try{s()}catch(u){if(null===a)throw Error(o(330));Nl(a,u)}}for(n=nl,nl=[],i=0;i<n.length;i+=2){r=n[i],a=n[i+1];try{var l=r.create;r.destroy=l()}catch(u){if(null===a)throw Error(o(330));Nl(a,u)}}for(l=t.current.firstEffect;null!==l;)t=l.nextEffect,l.nextEffect=null,8&l.flags&&(l.sibling=null,l.stateNode=null),l=t;return Rs=e,Kr(),!0}function zl(t,e,n){ha(t,e=ds(0,e=us(n,e),1)),e=dl(),null!==(t=vl(t,1))&&(We(t,1,e),gl(t,e))}function Nl(t,e){if(3===t.tag)zl(t,t,e);else for(var n=t.return;null!==n;){if(3===n.tag){zl(n,t,e);break}if(1===n.tag){var i=n.stateNode;if("function"===typeof n.type.getDerivedStateFromError||"function"===typeof i.componentDidCatch&&(null===$s||!$s.has(i))){var r=fs(n,t=us(e,t),1);if(ha(n,r),r=dl(),null!==(n=vl(n,1)))We(n,1,r),gl(n,r);else if("function"===typeof i.componentDidCatch&&(null===$s||!$s.has(i)))try{i.componentDidCatch(e,t)}catch(a){}break}}n=n.return}}function Ul(t,e,n){var i=t.pingCache;null!==i&&i.delete(e),e=dl(),t.pingedLanes|=t.suspendedLanes&n,Ds===t&&(Ls&n)===n&&(4===Is||3===Is&&(62914560&Ls)===Ls&&500>Wr()-Gs?Sl(t,0):Ws|=n),gl(t,e)}function Hl(t,e){var n=t.stateNode;null!==n&&n.delete(e),0===(e=0)&&(0===(2&(e=t.mode))?e=1:0===(4&e)?e=99===Vr()?1:2:(0===ll&&(ll=Ns),0===(e=Ue(62914560&~ll))&&(e=4194304))),n=dl(),null!==(t=vl(t,e))&&(We(t,e,n),gl(t,n))}function Wl(t,e,n,i){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.flags=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childLanes=this.lanes=0,this.alternate=null}function Vl(t,e,n,i){return new Wl(t,e,n,i)}function Gl(t){return!(!(t=t.prototype)||!t.isReactComponent)}function Xl(t,e){var n=t.alternate;return null===n?((n=Vl(t.tag,e,t.key,t.mode)).elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.nextEffect=null,n.firstEffect=null,n.lastEffect=null),n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function ql(t,e,n,i,r,a){var s=2;if(i=t,"function"===typeof t)Gl(t)&&(s=1);else if("string"===typeof t)s=5;else t:switch(t){case S:return Kl(n.children,r,a,e);case B:s=8,r|=16;break;case C:s=8,r|=1;break;case O:return(t=Vl(12,n,e,8|r)).elementType=O,t.type=O,t.lanes=a,t;case j:return(t=Vl(13,n,e,r)).type=j,t.elementType=j,t.lanes=a,t;case T:return(t=Vl(19,n,e,r)).elementType=T,t.lanes=a,t;case F:return Zl(n,r,a,e);case I:return(t=Vl(24,n,e,r)).elementType=I,t.lanes=a,t;default:if("object"===typeof t&&null!==t)switch(t.$$typeof){case E:s=10;break t;case A:s=9;break t;case P:s=11;break t;case R:s=14;break t;case D:s=16,i=null;break t;case M:s=22;break t}throw Error(o(130,null==t?t:typeof t,""))}return(e=Vl(s,n,e,r)).elementType=t,e.type=i,e.lanes=a,e}function Kl(t,e,n,i){return(t=Vl(7,t,i,e)).lanes=n,t}function Zl(t,e,n,i){return(t=Vl(23,t,i,e)).elementType=F,t.lanes=n,t}function Ql(t,e,n){return(t=Vl(6,t,null,e)).lanes=n,t}function Yl(t,e,n){return(e=Vl(4,null!==t.children?t.children:[],t.key,e)).lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function $l(t,e,n){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.pendingContext=this.context=null,this.hydrate=n,this.callbackNode=null,this.callbackPriority=0,this.eventTimes=He(0),this.expirationTimes=He(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=He(0),this.mutableSourceEagerHydrationData=null}function Jl(t,e,n){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:x,key:null==i?null:""+i,children:t,containerInfo:e,implementation:n}}function tu(t,e,n,i){var r=e.current,a=dl(),s=fl(r);t:if(n){e:{if(Qt(n=n._reactInternals)!==n||1!==n.tag)throw Error(o(170));var l=n;do{switch(l.tag){case 3:l=l.stateNode.context;break e;case 1:if(yr(l.type)){l=l.stateNode.__reactInternalMemoizedMergedChildContext;break e}}l=l.return}while(null!==l);throw Error(o(171))}if(1===n.tag){var u=n.type;if(yr(u)){n=br(n,u,l);break t}}n=l}else n=dr;return null===e.context?e.context=n:e.pendingContext=n,(e=ca(a,s)).payload={element:t},null!==(i=void 0===i?null:i)&&(e.callback=i),ha(r,e),pl(r,s,a),s}function eu(t){return(t=t.current).child?(t.child.tag,t.child.stateNode):null}function nu(t,e){if(null!==(t=t.memoizedState)&&null!==t.dehydrated){var n=t.retryLane;t.retryLane=0!==n&&n<e?n:e}}function iu(t,e){nu(t,e),(t=t.alternate)&&nu(t,e)}function ru(t,e,n){var i=null!=n&&null!=n.hydrationOptions&&n.hydrationOptions.mutableSources||null;if(n=new $l(t,e,null!=n&&!0===n.hydrate),e=Vl(3,null,null,2===e?7:1===e?3:0),n.current=e,e.stateNode=n,la(e),t[tr]=n.current,Ri(8===t.nodeType?t.parentNode:t),i)for(t=0;t<i.length;t++){var r=(e=i[t])._getVersion;r=r(e._source),null==n.mutableSourceEagerHydrationData?n.mutableSourceEagerHydrationData=[e,r]:n.mutableSourceEagerHydrationData.push(e,r)}this._internalRoot=n}function au(t){return!(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType&&(8!==t.nodeType||" react-mount-point-unstable "!==t.nodeValue))}function ou(t,e,n,i,r){var a=n._reactRootContainer;if(a){var o=a._internalRoot;if("function"===typeof r){var s=r;r=function(){var t=eu(o);s.call(t)}}tu(e,o,t,r)}else{if(a=n._reactRootContainer=function(t,e){if(e||(e=!(!(e=t?9===t.nodeType?t.documentElement:t.firstChild:null)||1!==e.nodeType||!e.hasAttribute("data-reactroot"))),!e)for(var n;n=t.lastChild;)t.removeChild(n);return new ru(t,0,e?{hydrate:!0}:void 0)}(n,i),o=a._internalRoot,"function"===typeof r){var l=r;r=function(){var t=eu(o);l.call(t)}}wl((function(){tu(e,o,t,r)}))}return eu(o)}function su(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!au(e))throw Error(o(200));return Jl(t,e,null,n)}Ks=function(t,e,n){var i=e.lanes;if(null!==t)if(t.memoizedProps!==e.pendingProps||pr.current)Fo=!0;else{if(0===(n&i)){switch(Fo=!1,e.tag){case 3:qo(e),qa();break;case 5:La(e);break;case 1:yr(e.type)&&wr(e);break;case 4:Da(e,e.stateNode.containerInfo);break;case 10:i=e.memoizedProps.value;var r=e.type._context;hr($r,r._currentValue),r._currentValue=i;break;case 13:if(null!==e.memoizedState)return 0!==(n&e.child.childLanes)?$o(t,e,n):(hr(Fa,1&Fa.current),null!==(e=as(t,e,n))?e.sibling:null);hr(Fa,1&Fa.current);break;case 19:if(i=0!==(n&e.childLanes),0!==(64&t.flags)){if(i)return rs(t,e,n);e.flags|=64}if(null!==(r=e.memoizedState)&&(r.rendering=null,r.tail=null,r.lastEffect=null),hr(Fa,Fa.current),i)break;return null;case 23:case 24:return e.lanes=0,Ho(t,e,n)}return as(t,e,n)}Fo=0!==(16384&t.flags)}else Fo=!1;switch(e.lanes=0,e.tag){case 2:if(i=e.type,null!==t&&(t.alternate=null,e.alternate=null,e.flags|=2),t=e.pendingProps,r=gr(e,fr.current),aa(e,n),r=oo(null,e,i,t,r,n),e.flags|=1,"object"===typeof r&&null!==r&&"function"===typeof r.render&&void 0===r.$$typeof){if(e.tag=1,e.memoizedState=null,e.updateQueue=null,yr(i)){var a=!0;wr(e)}else a=!1;e.memoizedState=null!==r.state&&void 0!==r.state?r.state:null,la(e);var s=i.getDerivedStateFromProps;"function"===typeof s&&ga(e,i,s,t),r.updater=ya,e.stateNode=r,r._reactInternals=e,wa(e,i,t,n),e=Xo(null,e,i,!0,a,n)}else e.tag=0,Io(null,e,r,n),e=e.child;return e;case 16:r=e.elementType;t:{switch(null!==t&&(t.alternate=null,e.alternate=null,e.flags|=2),t=e.pendingProps,r=(a=r._init)(r._payload),e.type=r,a=e.tag=function(t){if("function"===typeof t)return Gl(t)?1:0;if(void 0!==t&&null!==t){if((t=t.$$typeof)===P)return 11;if(t===R)return 14}return 2}(r),t=Yr(r,t),a){case 0:e=Vo(null,e,r,t,n);break t;case 1:e=Go(null,e,r,t,n);break t;case 11:e=zo(null,e,r,t,n);break t;case 14:e=No(null,e,r,Yr(r.type,t),i,n);break t}throw Error(o(306,r,""))}return e;case 0:return i=e.type,r=e.pendingProps,Vo(t,e,i,r=e.elementType===i?r:Yr(i,r),n);case 1:return i=e.type,r=e.pendingProps,Go(t,e,i,r=e.elementType===i?r:Yr(i,r),n);case 3:if(qo(e),i=e.updateQueue,null===t||null===i)throw Error(o(282));if(i=e.pendingProps,r=null!==(r=e.memoizedState)?r.element:null,ua(t,e),fa(e,i,null,n),(i=e.memoizedState.element)===r)qa(),e=as(t,e,n);else{if((a=(r=e.stateNode).hydrate)&&(Na=Ki(e.stateNode.containerInfo.firstChild),za=e,a=Ua=!0),a){if(null!=(t=r.mutableSourceEagerHydrationData))for(r=0;r<t.length;r+=2)(a=t[r])._workInProgressVersionPrimary=t[r+1],Ka.push(a);for(n=Ea(e,null,i,n),e.child=n;n;)n.flags=-3&n.flags|1024,n=n.sibling}else Io(t,e,i,n),qa();e=e.child}return e;case 5:return La(e),null===t&&Va(e),i=e.type,r=e.pendingProps,a=null!==t?t.memoizedProps:null,s=r.children,Vi(i,r)?s=null:null!==a&&Vi(i,a)&&(e.flags|=16),Wo(t,e),Io(t,e,s,n),e.child;case 6:return null===t&&Va(e),null;case 13:return $o(t,e,n);case 4:return Da(e,e.stateNode.containerInfo),i=e.pendingProps,null===t?e.child=Oa(e,null,i,n):Io(t,e,i,n),e.child;case 11:return i=e.type,r=e.pendingProps,zo(t,e,i,r=e.elementType===i?r:Yr(i,r),n);case 7:return Io(t,e,e.pendingProps,n),e.child;case 8:case 12:return Io(t,e,e.pendingProps.children,n),e.child;case 10:t:{i=e.type._context,r=e.pendingProps,s=e.memoizedProps,a=r.value;var l=e.type._context;if(hr($r,l._currentValue),l._currentValue=a,null!==s)if(l=s.value,0===(a=ci(l,a)?0:0|("function"===typeof i._calculateChangedBits?i._calculateChangedBits(l,a):1073741823))){if(s.children===r.children&&!pr.current){e=as(t,e,n);break t}}else for(null!==(l=e.child)&&(l.return=e);null!==l;){var u=l.dependencies;if(null!==u){s=l.child;for(var c=u.firstContext;null!==c;){if(c.context===i&&0!==(c.observedBits&a)){1===l.tag&&((c=ca(-1,n&-n)).tag=2,ha(l,c)),l.lanes|=n,null!==(c=l.alternate)&&(c.lanes|=n),ra(l.return,n),u.lanes|=n;break}c=c.next}}else s=10===l.tag&&l.type===e.type?null:l.child;if(null!==s)s.return=l;else for(s=l;null!==s;){if(s===e){s=null;break}if(null!==(l=s.sibling)){l.return=s.return,s=l;break}s=s.return}l=s}Io(t,e,r.children,n),e=e.child}return e;case 9:return r=e.type,i=(a=e.pendingProps).children,aa(e,n),i=i(r=oa(r,a.unstable_observedBits)),e.flags|=1,Io(t,e,i,n),e.child;case 14:return a=Yr(r=e.type,e.pendingProps),No(t,e,r,a=Yr(r.type,a),i,n);case 15:return Uo(t,e,e.type,e.pendingProps,i,n);case 17:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Yr(i,r),null!==t&&(t.alternate=null,e.alternate=null,e.flags|=2),e.tag=1,yr(i)?(t=!0,wr(e)):t=!1,aa(e,n),_a(e,i,r),wa(e,i,r,n),Xo(null,e,i,!0,t,n);case 19:return rs(t,e,n);case 23:case 24:return Ho(t,e,n)}throw Error(o(156,e.tag))},ru.prototype.render=function(t){tu(t,this._internalRoot,null,null)},ru.prototype.unmount=function(){var t=this._internalRoot,e=t.containerInfo;tu(null,t,null,(function(){e[tr]=null}))},ee=function(t){13===t.tag&&(pl(t,4,dl()),iu(t,4))},ne=function(t){13===t.tag&&(pl(t,67108864,dl()),iu(t,67108864))},ie=function(t){if(13===t.tag){var e=dl(),n=fl(t);pl(t,n,e),iu(t,n)}},re=function(t,e){return e()},Et=function(t,e,n){switch(e){case"input":if(nt(t,n),e=n.name,"radio"===n.type&&null!=e){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var i=n[e];if(i!==t&&i.form===t.form){var r=ar(i);if(!r)throw Error(o(90));Y(i),nt(i,r)}}}break;case"textarea":ut(t,n);break;case"select":null!=(e=n.value)&&ot(t,!!n.multiple,e,!1)}},Dt=bl,Mt=function(t,e,n,i,r){var a=Rs;Rs|=4;try{return Xr(98,t.bind(null,e,n,i,r))}finally{0===(Rs=a)&&(qs(),Kr())}},Lt=function(){0===(49&Rs)&&(function(){if(null!==rl){var t=rl;rl=null,t.forEach((function(t){t.expiredLanes|=24&t.pendingLanes,gl(t,Wr())}))}Kr()}(),Ll())},Bt=function(t,e){var n=Rs;Rs|=2;try{return t(e)}finally{0===(Rs=n)&&(qs(),Kr())}};var lu={Events:[ir,rr,ar,Tt,Rt,Ll,{current:!1}]},uu={findFiberByHostInstance:nr,bundleType:0,version:"17.0.2",rendererPackageName:"react-dom"},cu={bundleType:uu.bundleType,version:uu.version,rendererPackageName:uu.rendererPackageName,rendererConfig:uu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:w.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return null===(t=Jt(t))?null:t.stateNode},findFiberByHostInstance:uu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var hu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!hu.isDisabled&&hu.supportsFiber)try{xr=hu.inject(cu),Sr=hu}catch(gt){}}e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=lu,e.createPortal=su,e.findDOMNode=function(t){if(null==t)return null;if(1===t.nodeType)return t;var e=t._reactInternals;if(void 0===e){if("function"===typeof t.render)throw Error(o(188));throw Error(o(268,Object.keys(t)))}return t=null===(t=Jt(e))?null:t.stateNode},e.flushSync=function(t,e){var n=Rs;if(0!==(48&n))return t(e);Rs|=1;try{if(t)return Xr(99,t.bind(null,e))}finally{Rs=n,Kr()}},e.hydrate=function(t,e,n){if(!au(e))throw Error(o(200));return ou(null,t,e,!0,n)},e.render=function(t,e,n){if(!au(e))throw Error(o(200));return ou(null,t,e,!1,n)},e.unmountComponentAtNode=function(t){if(!au(t))throw Error(o(40));return!!t._reactRootContainer&&(wl((function(){ou(null,null,t,!1,(function(){t._reactRootContainer=null,t[tr]=null}))})),!0)},e.unstable_batchedUpdates=bl,e.unstable_createPortal=function(t,e){return su(t,e,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null)},e.unstable_renderSubtreeIntoContainer=function(t,e,n,i){if(!au(n))throw Error(o(200));if(null==t||void 0===t._reactInternals)throw Error(o(38));return ou(t,e,n,!1,i)},e.version="17.0.2"},function(t,e,n){"use strict";t.exports=n(24)},function(t,e,n){"use strict";var i,r,a,o;if("object"===typeof performance&&"function"===typeof performance.now){var s=performance;e.unstable_now=function(){return s.now()}}else{var l=Date,u=l.now();e.unstable_now=function(){return l.now()-u}}if("undefined"===typeof window||"function"!==typeof MessageChannel){var c=null,h=null,d=function t(){if(null!==c)try{var n=e.unstable_now();c(!0,n),c=null}catch(i){throw setTimeout(t,0),i}};i=function(t){null!==c?setTimeout(i,0,t):(c=t,setTimeout(d,0))},r=function(t,e){h=setTimeout(t,e)},a=function(){clearTimeout(h)},e.unstable_shouldYield=function(){return!1},o=e.unstable_forceFrameRate=function(){}}else{var f=window.setTimeout,p=window.clearTimeout;if("undefined"!==typeof console){var v=window.cancelAnimationFrame;"function"!==typeof window.requestAnimationFrame&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills"),"function"!==typeof v&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills")}var g=!1,y=null,m=-1,_=5,b=0;e.unstable_shouldYield=function(){return e.unstable_now()>=b},o=function(){},e.unstable_forceFrameRate=function(t){0>t||125<t?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<t?Math.floor(1e3/t):5};var w=new MessageChannel,k=w.port2;w.port1.onmessage=function(){if(null!==y){var t=e.unstable_now();b=t+_;try{y(!0,t)?k.postMessage(null):(g=!1,y=null)}catch(n){throw k.postMessage(null),n}}else g=!1},i=function(t){y=t,g||(g=!0,k.postMessage(null))},r=function(t,n){m=f((function(){t(e.unstable_now())}),n)},a=function(){p(m),m=-1}}function x(t,e){var n=t.length;t.push(e);t:for(;;){var i=n-1>>>1,r=t[i];if(!(void 0!==r&&0<O(r,e)))break t;t[i]=e,t[n]=r,n=i}}function S(t){return void 0===(t=t[0])?null:t}function C(t){var e=t[0];if(void 0!==e){var n=t.pop();if(n!==e){t[0]=n;t:for(var i=0,r=t.length;i<r;){var a=2*(i+1)-1,o=t[a],s=a+1,l=t[s];if(void 0!==o&&0>O(o,n))void 0!==l&&0>O(l,o)?(t[i]=l,t[s]=n,i=s):(t[i]=o,t[a]=n,i=a);else{if(!(void 0!==l&&0>O(l,n)))break t;t[i]=l,t[s]=n,i=s}}}return e}return null}function O(t,e){var n=t.sortIndex-e.sortIndex;return 0!==n?n:t.id-e.id}var E=[],A=[],P=1,j=null,T=3,R=!1,D=!1,M=!1;function L(t){for(var e=S(A);null!==e;){if(null===e.callback)C(A);else{if(!(e.startTime<=t))break;C(A),e.sortIndex=e.expirationTime,x(E,e)}e=S(A)}}function B(t){if(M=!1,L(t),!D)if(null!==S(E))D=!0,i(F);else{var e=S(A);null!==e&&r(B,e.startTime-t)}}function F(t,n){D=!1,M&&(M=!1,a()),R=!0;var i=T;try{for(L(n),j=S(E);null!==j&&(!(j.expirationTime>n)||t&&!e.unstable_shouldYield());){var o=j.callback;if("function"===typeof o){j.callback=null,T=j.priorityLevel;var s=o(j.expirationTime<=n);n=e.unstable_now(),"function"===typeof s?j.callback=s:j===S(E)&&C(E),L(n)}else C(E);j=S(E)}if(null!==j)var l=!0;else{var u=S(A);null!==u&&r(B,u.startTime-n),l=!1}return l}finally{j=null,T=i,R=!1}}var I=o;e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(t){t.callback=null},e.unstable_continueExecution=function(){D||R||(D=!0,i(F))},e.unstable_getCurrentPriorityLevel=function(){return T},e.unstable_getFirstCallbackNode=function(){return S(E)},e.unstable_next=function(t){switch(T){case 1:case 2:case 3:var e=3;break;default:e=T}var n=T;T=e;try{return t()}finally{T=n}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=I,e.unstable_runWithPriority=function(t,e){switch(t){case 1:case 2:case 3:case 4:case 5:break;default:t=3}var n=T;T=t;try{return e()}finally{T=n}},e.unstable_scheduleCallback=function(t,n,o){var s=e.unstable_now();switch("object"===typeof o&&null!==o?o="number"===typeof(o=o.delay)&&0<o?s+o:s:o=s,t){case 1:var l=-1;break;case 2:l=250;break;case 5:l=1073741823;break;case 4:l=1e4;break;default:l=5e3}return t={id:P++,callback:n,priorityLevel:t,startTime:o,expirationTime:l=o+l,sortIndex:-1},o>s?(t.sortIndex=o,x(A,t),null===S(E)&&t===S(A)&&(M?a():M=!0,r(B,o-s))):(t.sortIndex=l,x(E,t),D||R||(D=!0,i(F))),t},e.unstable_wrapCallback=function(t){var e=T;return function(){var n=T;T=e;try{return t.apply(this,arguments)}finally{T=n}}}},,function(t,e,n){var i=function(t){"use strict";var e,n=Object.prototype,i=n.hasOwnProperty,r="function"===typeof Symbol?Symbol:{},a=r.iterator||"@@iterator",o=r.asyncIterator||"@@asyncIterator",s=r.toStringTag||"@@toStringTag";function l(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(T){l=function(t,e,n){return t[e]=n}}function u(t,e,n,i){var r=e&&e.prototype instanceof g?e:g,a=Object.create(r.prototype),o=new A(i||[]);return a._invoke=function(t,e,n){var i=h;return function(r,a){if(i===f)throw new Error("Generator is already running");if(i===p){if("throw"===r)throw a;return j()}for(n.method=r,n.arg=a;;){var o=n.delegate;if(o){var s=C(o,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===h)throw i=p,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=f;var l=c(t,e,n);if("normal"===l.type){if(i=n.done?p:d,l.arg===v)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=p,n.method="throw",n.arg=l.arg)}}}(t,n,o),a}function c(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(T){return{type:"throw",arg:T}}}t.wrap=u;var h="suspendedStart",d="suspendedYield",f="executing",p="completed",v={};function g(){}function y(){}function m(){}var _={};l(_,a,(function(){return this}));var b=Object.getPrototypeOf,w=b&&b(b(P([])));w&&w!==n&&i.call(w,a)&&(_=w);var k=m.prototype=g.prototype=Object.create(_);function x(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function n(r,a,o,s){var l=c(t[r],t,a);if("throw"!==l.type){var u=l.arg,h=u.value;return h&&"object"===typeof h&&i.call(h,"__await")?e.resolve(h.__await).then((function(t){n("next",t,o,s)}),(function(t){n("throw",t,o,s)})):e.resolve(h).then((function(t){u.value=t,o(u)}),(function(t){return n("throw",t,o,s)}))}s(l.arg)}var r;this._invoke=function(t,i){function a(){return new e((function(e,r){n(t,i,e,r)}))}return r=r?r.then(a,a):a()}}function C(t,n){var i=t.iterator[n.method];if(i===e){if(n.delegate=null,"throw"===n.method){if(t.iterator.return&&(n.method="return",n.arg=e,C(t,n),"throw"===n.method))return v;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var r=c(i,t.iterator,n.arg);if("throw"===r.type)return n.method="throw",n.arg=r.arg,n.delegate=null,v;var a=r.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,v):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function O(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function E(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function P(t){if(t){var n=t[a];if(n)return n.call(t);if("function"===typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function n(){for(;++r<t.length;)if(i.call(t,r))return n.value=t[r],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}return{next:j}}function j(){return{value:e,done:!0}}return y.prototype=m,l(k,"constructor",m),l(m,"constructor",y),y.displayName=l(m,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"===typeof t&&t.constructor;return!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,m):(t.__proto__=m,l(t,s,"GeneratorFunction")),t.prototype=Object.create(k),t},t.awrap=function(t){return{__await:t}},x(S.prototype),l(S.prototype,o,(function(){return this})),t.AsyncIterator=S,t.async=function(e,n,i,r,a){void 0===a&&(a=Promise);var o=new S(u(e,n,i,r),a);return t.isGeneratorFunction(n)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},x(k),l(k,s,"Generator"),l(k,a,(function(){return this})),l(k,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var i=e.pop();if(i in t)return n.value=i,n.done=!1,n}return n.done=!0,n}},t.values=P,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(E),!t)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(i,r){return s.type="throw",s.arg=t,n.next=i,r&&(n.method="next",n.arg=e),!!r}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],s=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var l=i.call(o,"catchLoc"),u=i.call(o,"finallyLoc");if(l&&u){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(l){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var a=r;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=t,o.arg=e,a?(this.method="next",this.next=a.finallyLoc,v):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),E(n),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;E(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,i){return this.delegate={iterator:P(t),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=e),v}},t}(t.exports);try{regeneratorRuntime=i}catch(r){"object"===typeof globalThis?globalThis.regeneratorRuntime=i:Function("r","regeneratorRuntime = r")(i)}},,,,,,,,,,,,function(t,e,n){"use strict";n(18);var i=n(10),r=60103;if(e.Fragment=60107,"function"===typeof Symbol&&Symbol.for){var a=Symbol.for;r=a("react.element"),e.Fragment=a("react.fragment")}var o=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s=Object.prototype.hasOwnProperty,l={key:!0,ref:!0,__self:!0,__source:!0};function u(t,e,n){var i,a={},u=null,c=null;for(i in void 0!==n&&(u=""+n),void 0!==e.key&&(u=""+e.key),void 0!==e.ref&&(c=e.ref),e)s.call(e,i)&&!l.hasOwnProperty(i)&&(a[i]=e[i]);if(t&&t.defaultProps)for(i in e=t.defaultProps)void 0===a[i]&&(a[i]=e[i]);return{$$typeof:r,type:t,key:u,ref:c,props:a,_owner:o.current}}e.jsx=u,e.jsxs=u}]]);
//# sourceMappingURL=2.7d577553.chunk.js.map