/*! For license information please see 2.281b0185.chunk.js.LICENSE.txt */
(this.webpackJsonpfox=this.webpackJsonpfox||[]).push([[2],[function(t,e,n){var i=n(14),r=n(25),o=n(12),a=n(27),s=n(31),l=n(32),u=n(7),c=n(15),h=n(36),d=n(38),f=n(40),p=n(41);self,t.exports=function(){var t={4662:function(t,e,n){n(3430);var i=n(8791);t.exports=i("Array","sort")},8343:function(t,e,n){n(4769);var i=n(9276);t.exports=i.Object.keys},7111:function(t,e,n){var i=n(6733),r=n(9821);t.exports=function(t){if(i(t))return t;throw TypeError(r(t)+" is not a function")}},1176:function(t,e,n){var i=n(5052);t.exports=function(t){if(i(t))return t;throw TypeError(String(t)+" is not an object")}},9540:function(t,e,n){var i=n(905),r=n(4237),o=n(3231),a=function(t){return function(e,n,a){var s,l=i(e),u=r(l.length),c=o(a,u);if(t&&n!=n){for(;u>c;)if((s=l[c++])!=s)return!0}else for(;u>c;c++)if((t||c in l)&&l[c]===n)return t||c||0;return!t&&-1}};t.exports={includes:a(!0),indexOf:a(!1)}},6038:function(t,e,n){"use strict";var i=n(4229);t.exports=function(t,e){var n=[][t];return!!n&&i((function(){n.call(null,e||function(){throw 1},1)}))}},3867:function(t){var e=Math.floor,n=function t(n,o){var a=n.length,s=e(a/2);return a<8?i(n,o):r(t(n.slice(0,s),o),t(n.slice(s),o),o)},i=function(t,e){for(var n,i,r=t.length,o=1;o<r;){for(i=o,n=t[o];i&&e(t[i-1],n)>0;)t[i]=t[--i];i!==o++&&(t[i]=n)}return t},r=function(t,e,n){for(var i=t.length,r=e.length,o=0,a=0,s=[];o<i||a<r;)o<i&&a<r?s.push(n(t[o],e[a])<=0?t[o++]:e[a++]):s.push(o<i?t[o++]:e[a++]);return s};t.exports=n},7079:function(t){var e={}.toString;t.exports=function(t){return e.call(t).slice(8,-1)}},1589:function(t,e,n){var i=n(1601),r=n(6733),o=n(7079),a=n(95)("toStringTag"),s="Arguments"==o(function(){return arguments}());t.exports=i?o:function(t){var e,n,i;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),a))?n:s?o(e):"Object"==(i=o(e))&&r(e.callee)?"Arguments":i}},7081:function(t,e,n){var i=n(816),r=n(4826),o=n(7933),a=n(1787);t.exports=function(t,e){for(var n=r(e),s=a.f,l=o.f,u=0;u<n.length;u++){var c=n[u];i(t,c)||s(t,c,l(e,c))}}},5762:function(t,e,n){var i=n(7400),r=n(1787),o=n(5358);t.exports=i?function(t,e,n){return r.f(t,e,o(1,n))}:function(t,e,n){return t[e]=n,t}},5358:function(t){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},7400:function(t,e,n){var i=n(4229);t.exports=!i((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},2635:function(t,e,n){var i=n(9859),r=n(5052),o=i.document,a=r(o)&&r(o.createElement);t.exports=function(t){return a?o.createElement(t):{}}},2671:function(t,e,n){var i=n(598).match(/firefox\/(\d+)/i);t.exports=!!i&&+i[1]},8506:function(t,e,n){var i=n(598);t.exports=/MSIE|Trident/.test(i)},598:function(t,e,n){var i=n(1333);t.exports=i("navigator","userAgent")||""},6358:function(t,e,n){var i,r,o=n(9859),a=n(598),s=o.process,l=o.Deno,u=s&&s.versions||l&&l.version,c=u&&u.v8;c?r=(i=c.split("."))[0]<4?1:i[0]+i[1]:a&&(!(i=a.match(/Edge\/(\d+)/))||i[1]>=74)&&(i=a.match(/Chrome\/(\d+)/))&&(r=i[1]),t.exports=r&&+r},9811:function(t,e,n){var i=n(598).match(/AppleWebKit\/(\d+)\./);t.exports=!!i&&+i[1]},8791:function(t,e,n){var i=n(9859),r=n(7636),o=Function.call;t.exports=function(t,e,n){return r(o,i[t].prototype[e],n)}},3837:function(t){t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},3103:function(t,e,n){var i=n(9859),r=n(7933).f,o=n(5762),a=n(7487),s=n(2079),l=n(7081),u=n(6541);t.exports=function(t,e){var n,c,h,d,f,p=t.target,v=t.global,g=t.stat;if(n=v?i:g?i[p]||s(p,{}):(i[p]||{}).prototype)for(c in e){if(d=e[c],h=t.noTargetGet?(f=r(n,c))&&f.value:n[c],!u(v?c:p+(g?".":"#")+c,t.forced)&&void 0!==h){if(typeof d==typeof h)continue;l(d,h)}(t.sham||h&&h.sham)&&o(d,"sham",!0),a(n,c,d,t)}}},4229:function(t){t.exports=function(t){try{return!!t()}catch(t){return!0}}},7636:function(t,e,n){var i=n(7111);t.exports=function(t,e,n){if(i(t),void 0===e)return t;switch(n){case 0:return function(){return t.call(e)};case 1:return function(n){return t.call(e,n)};case 2:return function(n,i){return t.call(e,n,i)};case 3:return function(n,i,r){return t.call(e,n,i,r)}}return function(){return t.apply(e,arguments)}}},1805:function(t,e,n){var i=n(7400),r=n(816),o=Function.prototype,a=i&&Object.getOwnPropertyDescriptor,s=r(o,"name"),l=s&&"something"===function(){}.name,u=s&&(!i||i&&a(o,"name").configurable);t.exports={EXISTS:s,PROPER:l,CONFIGURABLE:u}},1333:function(t,e,n){var i=n(9859),r=n(6733),o=function(t){return r(t)?t:void 0};t.exports=function(t,e){return arguments.length<2?o(i[t]):i[t]&&i[t][e]}},5300:function(t,e,n){var i=n(7111);t.exports=function(t,e){var n=t[e];return null==n?void 0:i(n)}},9859:function(t,e,n){var i=function(t){return t&&t.Math==Math&&t};t.exports=i("object"==typeof globalThis&&globalThis)||i("object"==typeof window&&window)||i("object"==typeof self&&self)||i("object"==typeof n.g&&n.g)||function(){return this}()||Function("return this")()},816:function(t,e,n){var i=n(2991),r={}.hasOwnProperty;t.exports=Object.hasOwn||function(t,e){return r.call(i(t),e)}},5977:function(t){t.exports={}},4394:function(t,e,n){var i=n(7400),r=n(4229),o=n(2635);t.exports=!i&&!r((function(){return 7!=Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a}))},9337:function(t,e,n){var i=n(4229),r=n(7079),o="".split;t.exports=i((function(){return!Object("z").propertyIsEnumerable(0)}))?function(t){return"String"==r(t)?o.call(t,""):Object(t)}:Object},8511:function(t,e,n){var i=n(6733),r=n(5353),o=Function.toString;i(r.inspectSource)||(r.inspectSource=function(t){return o.call(t)}),t.exports=r.inspectSource},6407:function(t,e,n){var i,r,o,a=n(8694),s=n(9859),l=n(5052),u=n(5762),c=n(816),h=n(5353),d=n(4399),f=n(5977),p=s.WeakMap;if(a||h.state){var v=h.state||(h.state=new p),g=v.get,y=v.has,m=v.set;i=function(t,e){if(y.call(v,t))throw new TypeError("Object already initialized");return e.facade=t,m.call(v,t,e),e},r=function(t){return g.call(v,t)||{}},o=function(t){return y.call(v,t)}}else{var _=d("state");f[_]=!0,i=function(t,e){if(c(t,_))throw new TypeError("Object already initialized");return e.facade=t,u(t,_,e),e},r=function(t){return c(t,_)?t[_]:{}},o=function(t){return c(t,_)}}t.exports={set:i,get:r,has:o,enforce:function(t){return o(t)?r(t):i(t,{})},getterFor:function(t){return function(e){var n;if(!l(e)||(n=r(e)).type!==t)throw TypeError("Incompatible receiver, "+t+" required");return n}}}},6733:function(t){t.exports=function(t){return"function"==typeof t}},6541:function(t,e,n){var i=n(4229),r=n(6733),o=/#|\.prototype\./,a=function(t,e){var n=l[s(t)];return n==c||n!=u&&(r(e)?i(e):!!e)},s=a.normalize=function(t){return String(t).replace(o,".").toLowerCase()},l=a.data={},u=a.NATIVE="N",c=a.POLYFILL="P";t.exports=a},5052:function(t,e,n){var i=n(6733);t.exports=function(t){return"object"==typeof t?null!==t:i(t)}},4231:function(t){t.exports=!1},9395:function(t,e,n){var i=n(6733),r=n(1333),o=n(6969);t.exports=o?function(t){return"symbol"==typeof t}:function(t){var e=r("Symbol");return i(e)&&Object(t)instanceof e}},3839:function(t,e,n){var i=n(6358),r=n(4229);t.exports=!!Object.getOwnPropertySymbols&&!r((function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&i&&i<41}))},8694:function(t,e,n){var i=n(9859),r=n(6733),o=n(8511),a=i.WeakMap;t.exports=r(a)&&/native code/.test(o(a))},1787:function(t,e,n){var i=n(7400),r=n(4394),o=n(1176),a=n(9310),s=Object.defineProperty;e.f=i?s:function(t,e,n){if(o(t),e=a(e),o(n),r)try{return s(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(t[e]=n.value),t}},7933:function(t,e,n){var i=n(7400),r=n(9195),o=n(5358),a=n(905),s=n(9310),l=n(816),u=n(4394),c=Object.getOwnPropertyDescriptor;e.f=i?c:function(t,e){if(t=a(t),e=s(e),u)try{return c(t,e)}catch(t){}if(l(t,e))return o(!r.f.call(t,e),t[e])}},8151:function(t,e,n){var i=n(140),r=n(3837).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return i(t,r)}},894:function(t,e){e.f=Object.getOwnPropertySymbols},140:function(t,e,n){var i=n(816),r=n(905),o=n(9540).indexOf,a=n(5977);t.exports=function(t,e){var n,s=r(t),l=0,u=[];for(n in s)!i(a,n)&&i(s,n)&&u.push(n);for(;e.length>l;)i(s,n=e[l++])&&(~o(u,n)||u.push(n));return u}},5632:function(t,e,n){var i=n(140),r=n(3837);t.exports=Object.keys||function(t){return i(t,r)}},9195:function(t,e){"use strict";var n={}.propertyIsEnumerable,i=Object.getOwnPropertyDescriptor,r=i&&!n.call({1:2},1);e.f=r?function(t){var e=i(this,t);return!!e&&e.enumerable}:n},2914:function(t,e,n){var i=n(6733),r=n(5052);t.exports=function(t,e){var n,o;if("string"===e&&i(n=t.toString)&&!r(o=n.call(t)))return o;if(i(n=t.valueOf)&&!r(o=n.call(t)))return o;if("string"!==e&&i(n=t.toString)&&!r(o=n.call(t)))return o;throw TypeError("Can't convert object to primitive value")}},4826:function(t,e,n){var i=n(1333),r=n(8151),o=n(894),a=n(1176);t.exports=i("Reflect","ownKeys")||function(t){var e=r.f(a(t)),n=o.f;return n?e.concat(n(t)):e}},9276:function(t,e,n){var i=n(9859);t.exports=i},7487:function(t,e,n){var i=n(9859),r=n(6733),o=n(816),a=n(5762),s=n(2079),l=n(8511),u=n(6407),c=n(1805).CONFIGURABLE,h=u.get,d=u.enforce,f=String(String).split("String");(t.exports=function(t,e,n,l){var u,h=!!l&&!!l.unsafe,p=!!l&&!!l.enumerable,v=!!l&&!!l.noTargetGet,g=l&&void 0!==l.name?l.name:e;r(n)&&("Symbol("===String(g).slice(0,7)&&(g="["+String(g).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),(!o(n,"name")||c&&n.name!==g)&&a(n,"name",g),(u=d(n)).source||(u.source=f.join("string"==typeof g?g:""))),t!==i?(h?!v&&t[e]&&(p=!0):delete t[e],p?t[e]=n:a(t,e,n)):p?t[e]=n:s(e,n)})(Function.prototype,"toString",(function(){return r(this)&&h(this).source||l(this)}))},8885:function(t){t.exports=function(t){if(null==t)throw TypeError("Can't call method on "+t);return t}},2079:function(t,e,n){var i=n(9859);t.exports=function(t,e){try{Object.defineProperty(i,t,{value:e,configurable:!0,writable:!0})}catch(n){i[t]=e}return e}},4399:function(t,e,n){var i=n(3036),r=n(1441),o=i("keys");t.exports=function(t){return o[t]||(o[t]=r(t))}},5353:function(t,e,n){var i=n(9859),r=n(2079),o=i["__core-js_shared__"]||r("__core-js_shared__",{});t.exports=o},3036:function(t,e,n){var i=n(4231),r=n(5353);(t.exports=function(t,e){return r[t]||(r[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.18.1",mode:i?"pure":"global",copyright:"\xa9 2021 Denis Pushkarev (zloirock.ru)"})},3231:function(t,e,n){var i=n(6051),r=Math.max,o=Math.min;t.exports=function(t,e){var n=i(t);return n<0?r(n+e,0):o(n,e)}},905:function(t,e,n){var i=n(9337),r=n(8885);t.exports=function(t){return i(r(t))}},6051:function(t){var e=Math.ceil,n=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?n:e)(t)}},4237:function(t,e,n){var i=n(6051),r=Math.min;t.exports=function(t){return t>0?r(i(t),9007199254740991):0}},2991:function(t,e,n){var i=n(8885);t.exports=function(t){return Object(i(t))}},2066:function(t,e,n){var i=n(5052),r=n(9395),o=n(5300),a=n(2914),s=n(95)("toPrimitive");t.exports=function(t,e){if(!i(t)||r(t))return t;var n,l=o(t,s);if(l){if(void 0===e&&(e="default"),n=l.call(t,e),!i(n)||r(n))return n;throw TypeError("Can't convert object to primitive value")}return void 0===e&&(e="number"),a(t,e)}},9310:function(t,e,n){var i=n(2066),r=n(9395);t.exports=function(t){var e=i(t,"string");return r(e)?e:String(e)}},1601:function(t,e,n){var i={};i[n(95)("toStringTag")]="z",t.exports="[object z]"===String(i)},3326:function(t,e,n){var i=n(1589);t.exports=function(t){if("Symbol"===i(t))throw TypeError("Cannot convert a Symbol value to a string");return String(t)}},9821:function(t){t.exports=function(t){try{return String(t)}catch(t){return"Object"}}},1441:function(t){var e=0,n=Math.random();t.exports=function(t){return"Symbol("+String(void 0===t?"":t)+")_"+(++e+n).toString(36)}},6969:function(t,e,n){var i=n(3839);t.exports=i&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},95:function(t,e,n){var i=n(9859),r=n(3036),o=n(816),a=n(1441),s=n(3839),l=n(6969),u=r("wks"),c=i.Symbol,h=l?c:c&&c.withoutSetter||a;t.exports=function(t){return o(u,t)&&(s||"string"==typeof u[t])||(s&&o(c,t)?u[t]=c[t]:u[t]=h("Symbol."+t)),u[t]}},3430:function(t,e,n){"use strict";var i=n(3103),r=n(7111),o=n(2991),a=n(4237),s=n(3326),l=n(4229),u=n(3867),c=n(6038),h=n(2671),d=n(8506),f=n(6358),p=n(9811),v=[],g=v.sort,y=l((function(){v.sort(void 0)})),m=l((function(){v.sort(null)})),_=c("sort"),w=!l((function(){if(f)return f<70;if(!(h&&h>3)){if(d)return!0;if(p)return p<603;var t,e,n,i,r="";for(t=65;t<76;t++){switch(e=String.fromCharCode(t),t){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(i=0;i<47;i++)v.push({k:e+i,v:n})}for(v.sort((function(t,e){return e.v-t.v})),i=0;i<v.length;i++)e=v[i].k.charAt(0),r.charAt(r.length-1)!==e&&(r+=e);return"DGBEFHACIJK"!==r}}));i({target:"Array",proto:!0,forced:y||!m||!_||!w},{sort:function(t){void 0!==t&&r(t);var e=o(this);if(w)return void 0===t?g.call(e):g.call(e,t);var n,i,l=[],c=a(e.length);for(i=0;i<c;i++)i in e&&l.push(e[i]);for(n=(l=u(l,function(t){return function(e,n){return void 0===n?-1:void 0===e?1:void 0!==t?+t(e,n)||0:s(e)>s(n)?1:-1}}(t))).length,i=0;i<n;)e[i]=l[i++];for(;i<c;)delete e[i++];return e}})},4769:function(t,e,n){var i=n(3103),r=n(2991),o=n(5632);i({target:"Object",stat:!0,forced:n(4229)((function(){o(1)}))},{keys:function(t){return o(r(t))}})},1388:function(t,e,n){"use strict";n.d(e,{Z:function(){return s}});var i=n(272),r=n.n(i),o=n(2609),a=n.n(o)()(r());a.push([t.id,"/* Buttons styles start */\r\n\r\nbutton#excalibur-play {\r\n  display: inline-block;\r\n  position: relative;\r\n  z-index: 999;\r\n  border-radius: 6px;\r\n  border: none;\r\n  /*border: 3px solid;\r\n    border-color: white;\r\n    box-shadow: 0 0 10px #ccc;*/\r\n  padding: 1rem 1.5rem 1rem 4rem;\r\n  margin: 0;\r\n  text-decoration: none;\r\n  background: #00b233;\r\n  color: #ffffff;\r\n  font-family: sans-serif;\r\n  font-size: 2rem;\r\n  line-height: 1;\r\n  cursor: pointer;\r\n  text-align: center;\r\n  transition: background 250ms ease-in-out, transform 150ms ease;\r\n  -webkit-appearance: none;\r\n  -moz-appearance: none;\r\n\r\n  -webkit-animation: excalibur-button-fadein 200ms; /* Safari, Chrome and Opera > 12.1 */\r\n  -moz-animation: excalibur-button-fadein 200ms; /* Firefox < 16 */\r\n  -ms-animation: excalibur-button-fadein 200ms; /* Internet Explorer */\r\n  -o-animation: excalibur-button-fadein 200ms; /* Opera < 12.1 */\r\n  animation: excalibur-button-fadein 200ms;\r\n}\r\n\r\n/*\r\nbutton#excalibur-play {\r\n  display: none;\r\n}*/\r\n\r\nbutton#excalibur-play:after {\r\n  position: absolute;\r\n  content: '';\r\n  border: 8px solid;\r\n  border-color: transparent transparent transparent white;\r\n  left: 35px;\r\n  top: 24px;\r\n  width: 0;\r\n  height: 0;\r\n}\r\n\r\nbutton#excalibur-play:before {\r\n  position: absolute;\r\n  content: '';\r\n  border: 3px solid;\r\n  left: 19px;\r\n  top: 14px;\r\n  border-radius: 20px;\r\n  width: 30px;\r\n  height: 30px;\r\n}\r\n\r\nbutton#excalibur-play:hover,\r\nbutton#excalibur-play:focus {\r\n  background: #00982c;\r\n}\r\n\r\nbutton#excalibur-play:focus {\r\n  outline: 1px solid #fff;\r\n  outline-offset: -4px;\r\n}\r\n\r\nbutton#excalibur-play:active {\r\n  transform: scale(0.99);\r\n}\r\n\r\n@keyframes excalibur-button-fadein {\r\n  from {\r\n    opacity: 0;\r\n  }\r\n  to {\r\n    opacity: 1;\r\n  }\r\n}\r\n\r\n/* Firefox < 16 */\r\n@-moz-keyframes excalibur-button-fadein {\r\n  from {\r\n    opacity: 0;\r\n  }\r\n  to {\r\n    opacity: 1;\r\n  }\r\n}\r\n\r\n/* Safari, Chrome and Opera > 12.1 */\r\n@-webkit-keyframes excalibur-button-fadein {\r\n  from {\r\n    opacity: 0;\r\n  }\r\n  to {\r\n    opacity: 1;\r\n  }\r\n}\r\n\r\n/* Internet Explorer */\r\n@-ms-keyframes excalibur-button-fadein {\r\n  from {\r\n    opacity: 0;\r\n  }\r\n  to {\r\n    opacity: 1;\r\n  }\r\n}\r\n\r\n/* Opera < 12.1 */\r\n@-o-keyframes excalibur-button-fadein {\r\n  from {\r\n    opacity: 0;\r\n  }\r\n  to {\r\n    opacity: 1;\r\n  }\r\n}\r\n","",{version:3,sources:["webpack://./Loader.css"],names:[],mappings:"AAAA,yBAAyB;;AAEzB;EACE,qBAAqB;EACrB,kBAAkB;EAClB,YAAY;EACZ,kBAAkB;EAClB,YAAY;EACZ;;+BAE6B;EAC7B,8BAA8B;EAC9B,SAAS;EACT,qBAAqB;EACrB,mBAAmB;EACnB,cAAc;EACd,uBAAuB;EACvB,eAAe;EACf,cAAc;EACd,eAAe;EACf,kBAAkB;EAClB,8DAA8D;EAC9D,wBAAwB;EACxB,qBAAqB;;EAErB,gDAAgD,EAAE,oCAAoC;EACtF,6CAA6C,EAAE,iBAAiB;EAChE,4CAA4C,EAAE,sBAAsB;EACpE,2CAA2C,EAAE,iBAAiB;EAC9D,wCAAwC;AAC1C;;AAEA;;;EAGE;;AAEF;EACE,kBAAkB;EAClB,WAAW;EACX,iBAAiB;EACjB,uDAAuD;EACvD,UAAU;EACV,SAAS;EACT,QAAQ;EACR,SAAS;AACX;;AAEA;EACE,kBAAkB;EAClB,WAAW;EACX,iBAAiB;EACjB,UAAU;EACV,SAAS;EACT,mBAAmB;EACnB,WAAW;EACX,YAAY;AACd;;AAEA;;EAEE,mBAAmB;AACrB;;AAEA;EACE,uBAAuB;EACvB,oBAAoB;AACtB;;AAEA;EACE,sBAAsB;AACxB;;AAEA;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF;;AAEA,iBAAiB;AACjB;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF;;AAEA,oCAAoC;AACpC;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF;;AAEA,sBAAsB;AACtB;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF;;AAEA,iBAAiB;AACjB;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF",sourcesContent:["/* Buttons styles start */\r\n\r\nbutton#excalibur-play {\r\n  display: inline-block;\r\n  position: relative;\r\n  z-index: 999;\r\n  border-radius: 6px;\r\n  border: none;\r\n  /*border: 3px solid;\r\n    border-color: white;\r\n    box-shadow: 0 0 10px #ccc;*/\r\n  padding: 1rem 1.5rem 1rem 4rem;\r\n  margin: 0;\r\n  text-decoration: none;\r\n  background: #00b233;\r\n  color: #ffffff;\r\n  font-family: sans-serif;\r\n  font-size: 2rem;\r\n  line-height: 1;\r\n  cursor: pointer;\r\n  text-align: center;\r\n  transition: background 250ms ease-in-out, transform 150ms ease;\r\n  -webkit-appearance: none;\r\n  -moz-appearance: none;\r\n\r\n  -webkit-animation: excalibur-button-fadein 200ms; /* Safari, Chrome and Opera > 12.1 */\r\n  -moz-animation: excalibur-button-fadein 200ms; /* Firefox < 16 */\r\n  -ms-animation: excalibur-button-fadein 200ms; /* Internet Explorer */\r\n  -o-animation: excalibur-button-fadein 200ms; /* Opera < 12.1 */\r\n  animation: excalibur-button-fadein 200ms;\r\n}\r\n\r\n/*\r\nbutton#excalibur-play {\r\n  display: none;\r\n}*/\r\n\r\nbutton#excalibur-play:after {\r\n  position: absolute;\r\n  content: '';\r\n  border: 8px solid;\r\n  border-color: transparent transparent transparent white;\r\n  left: 35px;\r\n  top: 24px;\r\n  width: 0;\r\n  height: 0;\r\n}\r\n\r\nbutton#excalibur-play:before {\r\n  position: absolute;\r\n  content: '';\r\n  border: 3px solid;\r\n  left: 19px;\r\n  top: 14px;\r\n  border-radius: 20px;\r\n  width: 30px;\r\n  height: 30px;\r\n}\r\n\r\nbutton#excalibur-play:hover,\r\nbutton#excalibur-play:focus {\r\n  background: #00982c;\r\n}\r\n\r\nbutton#excalibur-play:focus {\r\n  outline: 1px solid #fff;\r\n  outline-offset: -4px;\r\n}\r\n\r\nbutton#excalibur-play:active {\r\n  transform: scale(0.99);\r\n}\r\n\r\n@keyframes excalibur-button-fadein {\r\n  from {\r\n    opacity: 0;\r\n  }\r\n  to {\r\n    opacity: 1;\r\n  }\r\n}\r\n\r\n/* Firefox < 16 */\r\n@-moz-keyframes excalibur-button-fadein {\r\n  from {\r\n    opacity: 0;\r\n  }\r\n  to {\r\n    opacity: 1;\r\n  }\r\n}\r\n\r\n/* Safari, Chrome and Opera > 12.1 */\r\n@-webkit-keyframes excalibur-button-fadein {\r\n  from {\r\n    opacity: 0;\r\n  }\r\n  to {\r\n    opacity: 1;\r\n  }\r\n}\r\n\r\n/* Internet Explorer */\r\n@-ms-keyframes excalibur-button-fadein {\r\n  from {\r\n    opacity: 0;\r\n  }\r\n  to {\r\n    opacity: 1;\r\n  }\r\n}\r\n\r\n/* Opera < 12.1 */\r\n@-o-keyframes excalibur-button-fadein {\r\n  from {\r\n    opacity: 0;\r\n  }\r\n  to {\r\n    opacity: 1;\r\n  }\r\n}\r\n"],sourceRoot:""}]);var s=a},2609:function(t){"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n="",i=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),i&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),i&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n})).join("")},e.i=function(t,n,i,r,o){"string"==typeof t&&(t=[[null,t,void 0]]);var a={};if(i)for(var s=0;s<this.length;s++){var l=this[s][0];null!=l&&(a[l]=!0)}for(var u=0;u<t.length;u++){var c=[].concat(t[u]);i&&a[c[0]]||(void 0!==o&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=o),n&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=n):c[2]=n),r&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=r):c[4]="".concat(r)),e.push(c))}},e}},272:function(t){"use strict";t.exports=function(t){var e=t[1],n=t[3];if(!n)return e;if("function"==typeof btoa){var i=btoa(unescape(encodeURIComponent(JSON.stringify(n)))),r="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(i),o="/*# ".concat(r," */"),a=n.sources.map((function(t){return"/*# sourceURL=".concat(n.sourceRoot||"").concat(t," */")}));return[e].concat(a).concat([o]).join("\n")}return[e].join("\n")}}},e={};function n(i){var r=e[i];if(void 0!==r)return r.exports;var o=e[i]={id:i,exports:{}};return t[i](o,o.exports,n),o.exports}n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,{a:e}),e},n.d=function(t,e){for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var v={};return function(){"use strict";n.r(v),n.d(v,{ActionContext:function(){return vn},ActionQueue:function(){return We},ActivateEvent:function(){return qt},Actor:function(){return ai},AddedComponent:function(){return qn},AddedEntity:function(){return Ui},Animation:function(){return ar},AnimationStrategy:function(){return Vi},ArcadeSolver:function(){return er},AudioContextFactory:function(){return pt},Axis:function(){return bi},BaseAlign:function(){return di},BinaryTreeNode:function(){return $o},Blink:function(){return un},BodyComponent:function(){return jn},BoundingBox:function(){return ht},BroadphaseStrategy:function(){return yn},BrowserComponent:function(){return Kr},BrowserEvents:function(){return Qr},Camera:function(){return Bi},Canvas:function(){return pe},Cell:function(){return Pi},Circle:function(){return ri},CircleCollider:function(){return On},Class:function(){return te},ClosestLine:function(){return Mn},ClosestLineJumpTable:function(){return Bn},Collider:function(){return Tn},ColliderComponent:function(){return Wn},CollisionContact:function(){return Fn},CollisionEndEvent:function(){return Gt},CollisionGroup:function(){return bn},CollisionGroupManager:function(){return Po},CollisionJumpTable:function(){return zn},CollisionPostSolveEvent:function(){return jt},CollisionPreSolveEvent:function(){return Wt},CollisionResolutionStrategy:function(){return gn},CollisionSolver:function(){return tr},CollisionStartEvent:function(){return Vt},CollisionSystem:function(){return rr},CollisionType:function(){return Je},Color:function(){return ut},ColorBlindCorrector:function(){return kr},ColorBlindFlags:function(){return xr},ColorBlindness:function(){return lr},Component:function(){return Qe},CompositeCollider:function(){return Rn},Configurable:function(){return Re},ConsoleAppender:function(){return T},ContactConstraintPoint:function(){return nr},ContactEndEvent:function(){return Ht},ContactStartEvent:function(){return Ut},CoordPlane:function(){return $e},CullingBox:function(){return Vn},DeactivateEvent:function(){return Kt},Debug:function(){return Cr},DebugSystem:function(){return _r},DebugText:function(){return $r},DegreeOfFreedom:function(){return Ln},Detector:function(){return me},Die:function(){return dn},Direction:function(){return pi},DisplayMode:function(){return at},DynamicTree:function(){return En},DynamicTreeCollisionProcessor:function(){return An},EX_VERSION:function(){return ra},EaseTo:function(){return ln},EasingFunctions:function(){return He},EdgeCollider:function(){return Nn},ElasticToActorStrategy:function(){return Di},EmitterType:function(){return Gi},Engine:function(){return mo},EnterTriggerEvent:function(){return Zt},EnterViewPortEvent:function(){return Yt},Entity:function(){return Zn},EntityManager:function(){return Xi},EventDispatcher:function(){return Jt},EventTypes:function(){return st},Events:function(){return t},ExResponse:function(){return Ro},ExcaliburGraphicsContext2DCanvas:function(){return to},ExcaliburGraphicsContextWebGL:function(){return go},ExitTriggerEvent:function(){return $t},ExitViewPortEvent:function(){return Qt},Experiments:function(){return w},Fade:function(){return cn},Flags:function(){return S},Follow:function(){return fn},Font:function(){return xo},FontStyle:function(){return fi},FontUnit:function(){return ci},FrameStats:function(){return Sr},GameEvent:function(){return gt},GameStartEvent:function(){return wt},GameStopEvent:function(){return bt},GamepadAxisEvent:function(){return Lt},GamepadButtonEvent:function(){return Mt},GamepadConnectEvent:function(){return Rt},GamepadDisconnectEvent:function(){return Dt},Gif:function(){return Vo},GlobalCoordinates:function(){return Hr},Graphic:function(){return se},GraphicsComponent:function(){return ni},GraphicsGroup:function(){return sr},GraphicsLayer:function(){return ti},GraphicsLayers:function(){return ei},GraphicsSystem:function(){return yr},HiddenEvent:function(){return It},ImageSource:function(){return gi},InitializeEvent:function(){return Xt},Input:function(){return m},Integrator:function(){return mn},KillEvent:function(){return yt},Label:function(){return Eo},Legacy:function(){return b},LegacyDrawing:function(){return y},LimitCameraBoundsStrategy:function(){return Li},Line:function(){return Dn},Loader:function(){return ge},LockCameraToActorAxisStrategy:function(){return Ri},LockCameraToActorStrategy:function(){return Ti},LogLevel:function(){return k},Logger:function(){return P},Matrix:function(){return en},MatrixLocations:function(){return Ne},MediaEvent:function(){return wo},Meet:function(){return pn},MockedElement:function(){return ea},MotionComponent:function(){return Ze},MotionSystem:function(){return Ji},MoveBy:function(){return Ge},MoveTo:function(){return Xe},NativeSoundEvent:function(){return bo},NativeSoundProcessedEvent:function(){return ko},Observable:function(){return kn},Pair:function(){return xn},ParseGif:function(){return Ko},Particle:function(){return vr},ParticleEmitter:function(){return gr},Physics:function(){return wn},PhysicsStats:function(){return Er},Polygon:function(){return Qo},PolygonCollider:function(){return Un},Pool:function(){return ro},PostCollisionEvent:function(){return Nt},PostDebugDrawEvent:function(){return St},PostDrawEvent:function(){return xt},PostFrameEvent:function(){return Tt},PostKillEvent:function(){return _t},PostUpdateEvent:function(){return Pt},PreCollisionEvent:function(){return zt},PreDebugDrawEvent:function(){return Ct},PreDrawEvent:function(){return kt},PreFrameEvent:function(){return At},PreKillEvent:function(){return mt},PreUpdateEvent:function(){return Et},Projection:function(){return Cn},Promise:function(){return ia},PromiseState:function(){return ta},Query:function(){return Ki},QueryManager:function(){return Qi},RadiusAroundActorStrategy:function(){return Mi},Random:function(){return D},Raster:function(){return fe},Ray:function(){return Pn},RealisticSolver:function(){return ir},Rectangle:function(){return ii},RemovedComponent:function(){return Qn},RemovedEntity:function(){return Wi},Repeat:function(){return je},RepeatForever:function(){return Ve},Resolution:function(){return dt},Resource:function(){return _e},RotateBy:function(){return Ke},RotateTo:function(){return qe},RotationType:function(){return ze},ScaleBy:function(){return an},ScaleTo:function(){return on},Scene:function(){return br},Screen:function(){return ft},ScreenAppender:function(){return R},ScreenElement:function(){return si},ScrollPreventionMode:function(){return lo},Shape:function(){return Hn},Side:function(){return A},SortedList:function(){return Zo},Sound:function(){return Wo},Sprite:function(){return yi},SpriteFont:function(){return Zr},SpriteSheet:function(){return ki},StrategyContainer:function(){return Ai},Stream:function(){return qo},SubscribeEvent:function(){return Bt},System:function(){return Ni},SystemManager:function(){return Yi},SystemType:function(){return Fi},TagComponent:function(){return Ye},Text:function(){return Co},TextAlign:function(){return hi},TileMap:function(){return Si},Timer:function(){return ui},Traits:function(){return _},TransformComponent:function(){return rn},TreeNode:function(){return Sn},Trigger:function(){return zi},UnsubscribeEvent:function(){return Ot},Util:function(){return x},Vector:function(){return rt},VectorView:function(){return nn},VisibleEvent:function(){return Ft},WebAudioInstance:function(){return No},World:function(){return Zi},canonicalizeAngle:function(){return N},clamp:function(){return F},createId:function(){return E},hasGraphicsTick:function(){return Jn},hasOnInitialize:function(){return Mo},hasOnPostUpdate:function(){return Fo},hasOnPreUpdate:function(){return Bo},hasPostDraw:function(){return zo},hasPreDraw:function(){return Io},has_initialize:function(){return Do},has_postupdate:function(){return Oo},has_preupdate:function(){return Lo},isAddedComponent:function(){return Kn},isAddedSystemEntity:function(){return Hi},isRemoveSystemEntity:function(){return ji},isRemovedComponent:function(){return Yn},maxMessages:function(){return $},obsolete:function(){return nt},randomInRange:function(){return I},randomIntInRange:function(){return z},range:function(){return Y},resetObsoleteCounter:function(){return tt},toDegrees:function(){return U},toRadians:function(){return H},vec:function(){return ot}});var t={};n.r(t),n.d(t,{ActivateEvent:function(){return qt},CollisionEndEvent:function(){return Gt},CollisionPostSolveEvent:function(){return jt},CollisionPreSolveEvent:function(){return Wt},CollisionStartEvent:function(){return Vt},ContactEndEvent:function(){return Ht},ContactStartEvent:function(){return Ut},DeactivateEvent:function(){return Kt},EnterTriggerEvent:function(){return Zt},EnterViewPortEvent:function(){return Yt},EventTypes:function(){return st},ExitTriggerEvent:function(){return $t},ExitViewPortEvent:function(){return Qt},GameEvent:function(){return gt},GameStartEvent:function(){return wt},GameStopEvent:function(){return bt},GamepadAxisEvent:function(){return Lt},GamepadButtonEvent:function(){return Mt},GamepadConnectEvent:function(){return Rt},GamepadDisconnectEvent:function(){return Dt},HiddenEvent:function(){return It},InitializeEvent:function(){return Xt},KillEvent:function(){return yt},PostCollisionEvent:function(){return Nt},PostDebugDrawEvent:function(){return St},PostDrawEvent:function(){return xt},PostFrameEvent:function(){return Tt},PostKillEvent:function(){return _t},PostUpdateEvent:function(){return Pt},PreCollisionEvent:function(){return zt},PreDebugDrawEvent:function(){return Ct},PreDrawEvent:function(){return kt},PreFrameEvent:function(){return At},PreKillEvent:function(){return mt},PreUpdateEvent:function(){return Et},SubscribeEvent:function(){return Bt},UnsubscribeEvent:function(){return Ot},VisibleEvent:function(){return Ft}});var e={};n.r(e),n.d(e,{circle:function(){return oe},line:function(){return ee},point:function(){return ne},roundRect:function(){return re},vector:function(){return ie}});var g={};n.r(g),n.d(g,{Colorize:function(){return Ce},Darken:function(){return Ee},Desaturate:function(){return Ae},Fill:function(){return Te},Grayscale:function(){return be},Invert:function(){return ke},Lighten:function(){return Se},Opacity:function(){return xe},Saturate:function(){return Pe}});var y={};n.r(y),n.d(y,{Animation:function(){return Ie},CanvasDrawComponent:function(){return $n},CanvasDrawingSystem:function(){return mr},Effects:function(){return g},Polygon:function(){return To},Sprite:function(){return Le},SpriteFont:function(){return wi},SpriteSheet:function(){return _i},Texture:function(){return Oe}});var m={};n.r(m),n.d(m,{Axes:function(){return Gr},Buttons:function(){return Vr},Gamepad:function(){return Xr},Gamepads:function(){return jr},KeyEvent:function(){return Pr},Keyboard:function(){return Ar},Keys:function(){return ur},NativePointerButton:function(){return dr},Pointer:function(){return Tr},PointerButton:function(){return fr},PointerCancelEvent:function(){return zr},PointerDownEvent:function(){return Br},PointerDragEvent:function(){return Mr},PointerEnterEvent:function(){return Fr},PointerEvent:function(){return Rr},PointerEventFactory:function(){return Dr},PointerLeaveEvent:function(){return Ir},PointerMoveEvent:function(){return Or},PointerScope:function(){return hr},PointerType:function(){return cr},PointerUpEvent:function(){return Lr},Pointers:function(){return Wr},WheelDeltaMode:function(){return pr},WheelEvent:function(){return Nr},createPointerEventByName:function(){return Ur}});var _={};n.r(_),n.d(_,{CapturePointer:function(){return Xn},OffscreenCulling:function(){return Gn}});var w,b,k,x={};function C(){if("undefined"==typeof window&&(window={audioContext:function(){}}),"undefined"==typeof window||window.requestAnimationFrame||(window.requestAnimationFrame=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setInterval(t,1e3/60)}),"undefined"==typeof window||window.cancelAnimationFrame||(window.cancelAnimationFrame=window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||function(){}),"undefined"!=typeof window&&!window.AudioContext){if(window.webkitAudioContext){var t=window.webkitAudioContext.prototype.decodeAudioData;window.webkitAudioContext.prototype.decodeAudioData=function(e){var n=this;return new Promise((function(i,r){t.call(n,e,i,r)}))}}window.AudioContext=window.AudioContext||window.webkitAudioContext||window.mozAudioContext||window.msAudioContext||window.oAudioContext}"undefined"==typeof window||window.devicePixelRatio||(window.devicePixelRatio=window.devicePixelRatio||1)}n.r(x),n.d(x,{Collection:function(){return K},ConsoleAppender:function(){return T},DrawUtil:function(){return e},EasingFunctions:function(){return He},LogLevel:function(){return k},Logger:function(){return P},Observable:function(){return kn},ScreenAppender:function(){return R},TwoPI:function(){return M},addItemToArray:function(){return j},base64Encode:function(){return B},canonicalizeAngle:function(){return N},clamp:function(){return F},contains:function(){return G},delay:function(){return Z},extend:function(){return L},fail:function(){return Q},getOppositeSide:function(){return X},getPosition:function(){return W},getSideFromDirection:function(){return q},nullish:function(){return O},randomInRange:function(){return I},randomIntInRange:function(){return z},range:function(){return Y},removeItemFromArray:function(){return V},toDegrees:function(){return U},toRadians:function(){return H}}),n(4662),n(8343),function(t){t.WebGL="use-webgl"}(w||(w={})),function(t){t.Canvas="use-canvas-context",t.LegacyDrawing="use-legacy-drawing"}(b||(b={}));var S=function(){function t(){f(this,t)}return p(t,null,[{key:"freeze",value:function(){t._FROZEN=!0}},{key:"_reset",value:function(){t._FROZEN=!1,t._FLAGS={}}},{key:"useWebGL",value:function(){t.enable(w.WebGL)}},{key:"useCanvasGraphicsContext",value:function(){t.enable(b.Canvas)}},{key:"useLegacyDrawing",value:function(){t.enable(b.LegacyDrawing)}},{key:"enable",value:function(e){if(this._FROZEN)throw Error("Feature flags can only be enabled before Engine constructor time");t._FLAGS[e]=!0}},{key:"disable",value:function(e){if(this._FROZEN)throw Error("Feature flags can only be disabled before Engine constructor time");t._FLAGS[e]=!1}},{key:"isEnabled",value:function(e){return!!t._FLAGS[e]}},{key:"show",value:function(){return Object.keys(t._FLAGS)}}]),t}();function E(t,e){return{type:t,value:e}}S._FROZEN=!1,S._FLAGS={},function(t){t[t.Debug=0]="Debug",t[t.Info=1]="Info",t[t.Warn=2]="Warn",t[t.Error=3]="Error",t[t.Fatal=4]="Fatal"}(k||(k={}));var P=function(){function t(){if(f(this,t),this._appenders=[],this.defaultLevel=k.Info,t._INSTANCE)throw new Error("Logger is a singleton");return t._INSTANCE=this,t._INSTANCE.addAppender(new T),t._INSTANCE}return p(t,[{key:"addAppender",value:function(t){this._appenders.push(t)}},{key:"clearAppenders",value:function(){this._appenders.length=0}},{key:"_log",value:function(t,e){null==t&&(t=this.defaultLevel);for(var n=this._appenders.length,i=0;i<n;i++)t>=this.defaultLevel&&this._appenders[i].log(t,e)}},{key:"debug",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this._log(k.Debug,e)}},{key:"info",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this._log(k.Info,e)}},{key:"warn",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this._log(k.Warn,e)}},{key:"error",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this._log(k.Error,e)}},{key:"fatal",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this._log(k.Fatal,e)}}],[{key:"getInstance",value:function(){return null==t._INSTANCE&&(t._INSTANCE=new t),t._INSTANCE}}]),t}();P._INSTANCE=null;var A,T=function(){function t(){f(this,t)}return p(t,[{key:"log",value:function(t,e){if(console||console.log||!console.warn||!console.error){var n=[];n.unshift.apply(n,e),n.unshift("["+k[t]+"] : "),t<k.Warn?console.log.apply?console.log.apply(console,n):console.log(n.join(" ")):t<k.Error?console.warn.apply?console.warn.apply(console,n):console.warn(n.join(" ")):console.error.apply?console.error.apply(console,n):console.error(n.join(" "))}}}]),t}(),R=function(){function t(e,n){f(this,t),this._messages=[],this._canvas=document.createElement("canvas"),this._canvas.width=e||window.innerWidth,this._canvas.height=n||window.innerHeight,this._canvas.style.position="absolute",this._ctx=this._canvas.getContext("2d"),document.body.appendChild(this._canvas)}return p(t,[{key:"log",value:function(t,e){var n=e.join(",");this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._messages.unshift("["+k[t]+"] : "+n);for(var i=10,r=1,o=0;o<this._messages.length;o++)this._ctx.fillStyle="rgba(255,255,255,"+r.toFixed(2)+")",this._ctx.fillText(this._messages[o],200,i),i+=10,r=r>0?r-.05:0}}]),t}(),D=function(){function t(e){f(this,t),this.seed=e,this._lowerMask=2147483647,this._upperMask=2147483648,this._w=32,this._n=624,this._m=397,this._a=2567483615,this._u=11,this._s=7,this._b=2636928640,this._t=15,this._c=4022730752,this._l=18,this._f=1812433253,this._mt=new Array(this._n),this._mt[0]=(e||Date.now())>>>0;for(var n=1;n<this._n;n++){var i=this._mt[n-1]^this._mt[n-1]>>>this._w-2;this._mt[n]=(this._f*((4294901760&i)>>>16)<<16)+this._f*(65535&i)+n>>>0}this._index=this._n}return p(t,[{key:"_twist",value:function(){for(var t=[0,this._a],e=0,n=0;n<this._n-this._m;n++)e=this._mt[n]&this._upperMask|this._mt[n+1]&this._lowerMask,this._mt[n]=this._mt[n+this._m]^e>>>1^4294967295&t[1&e];for(;n<this._n-1;n++)e=this._mt[n]&this._upperMask|this._mt[n+1]&this._lowerMask,this._mt[n]=this._mt[n+(this._m-this._n)]^e>>>1^4294967295&t[1&e];e=this._mt[this._n-1]&this._upperMask|this._mt[0]&this._lowerMask,this._mt[this._n-1]=this._mt[this._m-1]^e>>>1^4294967295&t[1&e],this._index=0}},{key:"nextInt",value:function(){this._index>=this._n&&this._twist();var t=this._mt[this._index++];return t^=t>>>this._u,t^=t<<this._s&this._b,t^=t<<this._t&this._c,(t^=t>>>this._l)>>>0}},{key:"next",value:function(){return this.nextInt()*(1/4294967296)}},{key:"floating",value:function(t,e){return(e-t)*this.next()+t}},{key:"integer",value:function(t,e){return Math.floor((e-t+1)*this.next()+t)}},{key:"bool",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.5;return this.next()<=t}},{key:"pickOne",value:function(t){return t[this.integer(0,t.length-1)]}},{key:"pickSet",value:function(t,e){return arguments.length>2&&void 0!==arguments[2]&&arguments[2]?this._pickSetWithDuplicates(t,e):this._pickSetWithoutDuplicates(t,e)}},{key:"_pickSetWithoutDuplicates",value:function(t,e){if(e>t.length||e<0)throw new Error("Invalid number of elements to pick, must pick a value 0 < n <= length");if(e===t.length)return t;for(var n=new Array(e),i=0,r=t.slice(0);i<e;){var o=this.integer(0,r.length-1);n[i++]=r[o],r.splice(o,1)}return n}},{key:"_pickSetWithDuplicates",value:function(t,e){if(e<0)throw new Error("Invalid number of elements to pick, must pick a value 0 <= n < MAX_INT");for(var n=new Array(e),i=0;i<e;i++)n[i]=this.pickOne(t);return n}},{key:"shuffle",value:function(t){for(var e=t.slice(0),n=null,i=0;i<e.length-2;i++){var r=this.integer(i,e.length-1);n=e[i],e[i]=e[r],e[r]=n}return e}},{key:"range",value:function(t,e,n){for(var i=new Array(t),r=0;r<t;r++)i[r]=this.integer(e,n);return i}},{key:"d4",value:function(){return this.integer(1,4)}},{key:"d6",value:function(){return this.integer(1,6)}},{key:"d8",value:function(){return this.integer(1,8)}},{key:"d10",value:function(){return this.integer(1,10)}},{key:"d12",value:function(){return this.integer(1,12)}},{key:"d20",value:function(){return this.integer(1,20)}}]),t}();!function(t){t.None="None",t.Top="Top",t.Bottom="Bottom",t.Left="Left",t.Right="Right"}(A||(A={})),function(t){t.getOpposite=function(e){return e===t.Top?t.Bottom:e===t.Bottom?t.Top:e===t.Left?t.Right:e===t.Right?t.Left:t.None},t.fromDirection=function(e){for(var n=[rt.Left,rt.Right,rt.Up,rt.Down],i=[t.Left,t.Right,t.Top,t.Bottom],r=-Number.MAX_VALUE,o=-1,a=0;a<n.length;a++)n[a].dot(e)>r&&(r=n[a].dot(e),o=a);return i[o]}}(A||(A={}));var M=2*Math.PI;function L(){var t={},e=!1,n=0,i=arguments.length;"[object Boolean]"===Object.prototype.toString.call(arguments[0])&&(e=arguments[0],n++);var r="function"==typeof Object.assign,o=null;for(o=r?Object.assign:function(n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e&&"[object Object]"===Object.prototype.toString.call(n[i])?t[i]=L(!0,t[i],n[i]):t[i]=n[i])};n<i;n++){var a=arguments[n];r?o(t,a):o(a)}return t}function B(t){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n="",i=0;i<t.length;){var r=255&t.charCodeAt(i++),o=255&t.charCodeAt(i++),a=255&t.charCodeAt(i++),s=r>>2,l=(3&r)<<4|o>>4,u=void 0,c=void 0;isNaN(o)?u=c=64:(u=(15&o)<<2|a>>6,c=isNaN(a)?64:63&a),n+=e.charAt(s)+e.charAt(l)+e.charAt(u)+e.charAt(c)}return n}function O(t,e){return null!=t?t:e}function F(t,e,n){return Math.min(Math.max(e,t),n)}function I(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new D;return n?n.floating(t,e):t+Math.random()*(e-t)}function z(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new D;return n?n.integer(t,e):Math.round(I(t,e))}function N(t){var e=t;if(t>M)for(;e>M;)e-=M;if(t<0)for(;e<0;)e+=M;return e}function U(t){return 180/Math.PI*t}function H(t){return t/180*Math.PI}function W(t){var e=0,n=0,i=function t(e){n+=e.offsetTop,e.offsetParent&&t(e.offsetParent)};return function t(n){e+=n.offsetLeft,n.offsetParent&&t(n.offsetParent)}(t),i(t),new rt(e,n)}function j(t,e){return-1===e.indexOf(t)&&(e.push(t),!0)}function V(t,e){var n=-1;return(n=e.indexOf(t))>-1&&(e.splice(n,1),!0)}function G(t,e){for(var n=0;n<t.length;n++)if(t[n]===e)return!0;return!1}function X(t){return t===A.Top?A.Bottom:t===A.Bottom?A.Top:t===A.Left?A.Right:t===A.Right?A.Left:A.None}function q(t){for(var e=[rt.Left,rt.Right,rt.Up,rt.Down],n=[A.Left,A.Right,A.Top,A.Bottom],i=-Number.MAX_VALUE,r=-1,o=0;o<e.length;o++)e[o].dot(t)>i&&(i=e[o].dot(t),r=o);return n[r]}var K=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t.DefaultSize;f(this,t),this._internalArray=null,this._endPointer=0,this._internalArray=new Array(e)}return p(t,[{key:"_resize",value:function(){for(var t=2*this._internalArray.length,e=new Array(t),n=this.count(),i=0;i<n;i++)e[i]=this._internalArray[i];delete this._internalArray,this._internalArray=e}},{key:"push",value:function(t){return this._endPointer===this._internalArray.length&&this._resize(),this._internalArray[this._endPointer++]=t}},{key:"pop",value:function(){return this._endPointer=this._endPointer-1<0?0:this._endPointer-1,this._internalArray[this._endPointer]}},{key:"count",value:function(){return this._endPointer}},{key:"clear",value:function(){this._endPointer=0}},{key:"internalSize",value:function(){return this._internalArray.length}},{key:"elementAt",value:function(t){if(t>=this.count())throw new Error("Invalid index "+t);return this._internalArray[t]}},{key:"insert",value:function(t,e){return t>=this.count()&&this._resize(),this._internalArray[t]=e}},{key:"remove",value:function(t){var e=this.count();if(0===e)throw new Error("Invalid parameter "+t);for(var n=this._internalArray[t],i=t;i<e;i++)this._internalArray[i]=this._internalArray[i+1];return this._endPointer--,n}},{key:"removeElement",value:function(t){var e=this._internalArray.indexOf(t);this.remove(e)}},{key:"toArray",value:function(){return this._internalArray.slice(0,this._endPointer)}},{key:"forEach",value:function(t){for(var e=0,n=this.count();e<n;e++)t.call(this,this._internalArray[e],e)}},{key:"map",value:function(t){for(var e=this.count(),n=0;n<e;n++)this._internalArray[n]=t.call(this,this._internalArray[n],n)}}]),t}();function Q(t){throw new Error(t)}K.DefaultSize=200;var Y=function(t,e){return Array.from(new Array(e-t+1),(function(e,n){return n+t}))};function Z(t){return new Promise((function(e){setTimeout((function(){e()}),t)}))}var $=5,J={},tt=function(){for(var t in J)J[t]=0},et=function(t,e){var n=S.isEnabled("suppress-obsolete-message");J[t]<$&&!n&&(P.getInstance().warn(t),console.trace&&e.showStackTrace&&console.trace()),J[t]++};function nt(t){return t=L({},{message:"This feature will be removed in future versions of Excalibur.",alternateMethod:null,showStackTrack:!1},t),function(e,n,i){if(i&&"function"!=typeof i.value&&"function"!=typeof i.get&&"function"!=typeof i.set)throw new SyntaxError("Only classes/functions/getters/setters can be marked as obsolete");var r="".concat("".concat(e.name||"").concat(e.name&&n?".":"").concat(n||"")," is marked obsolete: ",t.message)+(t.alternateMethod?" Use ".concat(t.alternateMethod," instead"):"");J[r]||(J[r]=0);var o=i?Object.assign({},i):e;return i?i&&i.value?(o.value=function(){return et(r,t),i.value.apply(this,arguments)},o):(i&&i.get&&(o.get=function(){return et(r,t),i.get.apply(this,arguments)}),i&&i.set&&(o.set=function(){return et(r,t),i.set.apply(this,arguments)}),o):function(e){h(i,e);var n=d(i);function i(){f(this,i);for(var e=arguments.length,o=new Array(e),a=0;a<e;a++)o[a]=arguments[a];return et(r,t),n.call.apply(n,[this].concat(o))}return i}(o)}}var it=function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},rt=function(){function t(e,n){f(this,t),this._x=0,this._y=0,this._x=e,this._y=n}return p(t,[{key:"x",get:function(){return this._x},set:function(t){this._x=t}},{key:"y",get:function(){return this._y},set:function(t){this._y=t}},{key:"setTo",value:function(t,e){this.x=t,this.y=e}},{key:"equals",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.001;return Math.abs(this.x-t.x)<=e&&Math.abs(this.y-t.y)<=e}},{key:"distance",value:function(e){return e||(e=t.Zero),Math.sqrt(Math.pow(this.x-e.x,2)+Math.pow(this.y-e.y,2))}},{key:"squareDistance",value:function(e){return e||(e=t.Zero),Math.pow(this.x-e.x,2)+Math.pow(this.y-e.y,2)}},{key:"magnitude",value:function(){return this.distance()}},{key:"size",get:function(){return this.distance()},set:function(t){var e=this.normalize().scale(t);this.setTo(e.x,e.y)}},{key:"normalize",value:function(){var e=this.distance();return e>0?new t(this.x/e,this.y/e):new t(0,1)}},{key:"average",value:function(t){return this.add(t).scale(.5)}},{key:"scale",value:function(e){return e instanceof t?new t(this.x*e.x,this.y*e.y):new t(this.x*e,this.y*e)}},{key:"add",value:function(e){return new t(this.x+e.x,this.y+e.y)}},{key:"sub",value:function(e){return new t(this.x-e.x,this.y-e.y)}},{key:"addEqual",value:function(t){return this.setTo(this.x+t.x,this.y+t.y),this}},{key:"subEqual",value:function(t){return this.setTo(this.x-t.x,this.y-t.y),this}},{key:"scaleEqual",value:function(t){return this.setTo(this.x*t,this.y*t),this}},{key:"dot",value:function(t){return this.x*t.x+this.y*t.y}},{key:"cross",value:function(e){return e instanceof t?this.x*e.y-this.y*e.x:"number"==typeof e?new t(e*this.y,-e*this.x):void 0}},{key:"perpendicular",value:function(){return new t(this.y,-this.x)}},{key:"normal",value:function(){return this.perpendicular().normalize()}},{key:"negate",value:function(){return this.scale(-1)}},{key:"toAngle",value:function(){return Math.atan2(this.y,this.x)}},{key:"rotate",value:function(e,n){n||(n=new t(0,0));var i=Math.sin(e),r=Math.cos(e);return new t(r*(this.x-n.x)-i*(this.y-n.y)+n.x,i*(this.x-n.x)+r*(this.y-n.y)+n.y)}},{key:"clone",value:function(){return new t(this.x,this.y)}},{key:"toString",value:function(t){return t?"(".concat(this.x.toFixed(t),", ").concat(this.y.toFixed(t),")"):"(".concat(this.x,", ").concat(this.y,")")}}],[{key:"Zero",get:function(){return new t(0,0)}},{key:"One",get:function(){return new t(1,1)}},{key:"Half",get:function(){return new t(.5,.5)}},{key:"Up",get:function(){return new t(0,-1)}},{key:"Down",get:function(){return new t(0,1)}},{key:"Left",get:function(){return new t(-1,0)}},{key:"Right",get:function(){return new t(1,0)}},{key:"fromAngle",value:function(e){return new t(Math.cos(e),Math.sin(e))}},{key:"isValid",value:function(t){return null!=t&&!isNaN(t.x)&&!isNaN(t.y)&&t.x!==1/0&&t.y!==1/0&&t.x!==-1/0&&t.y!==-1/0}},{key:"distance",value:function(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}},{key:"cross",value:function(e,n){return new t(-e*n.y,e*n.x)}}]),t}();function ot(t,e){return new rt(t,e)}it([nt({message:"will be removed in favour of `.size` in version 0.25.0"})],rt.prototype,"magnitude",null);var at,st,lt=function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},ut=function(){function t(e,n,i,r){f(this,t),this.r=e,this.g=n,this.b=i,this.a=null!=r?r:1}return p(t,[{key:"lighten",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1,e=ct.fromRGBA(this.r,this.g,this.b,this.a);return e.l+=(1-e.l)*t,e.toRGBA()}},{key:"darken",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1,e=ct.fromRGBA(this.r,this.g,this.b,this.a);return e.l-=e.l*t,e.toRGBA()}},{key:"saturate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1,e=ct.fromRGBA(this.r,this.g,this.b,this.a);return e.s+=e.s*t,e.toRGBA()}},{key:"desaturate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1,e=ct.fromRGBA(this.r,this.g,this.b,this.a);return e.s-=e.s*t,e.toRGBA()}},{key:"multiply",value:function(e){return new t(e.r/255*this.r/255*255,e.g/255*this.g/255*255,e.b/255*this.b/255*255,e.a*this.a)}},{key:"mulitiply",value:function(t){return this.multiply(t)}},{key:"screen",value:function(t){var e=t.invert(),n=t.invert();return e.multiply(n).invert()}},{key:"invert",value:function(){return new t(255-this.r,255-this.g,255-this.b,1-this.a)}},{key:"average",value:function(e){return new t((e.r+this.r)/2,(e.g+this.g)/2,(e.b+this.b)/2,(e.a+this.a)/2)}},{key:"equal",value:function(t){return this.toString()===t.toString()}},{key:"toString",value:function(){switch(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"rgb"){case"rgb":return this.toRGBA();case"hsl":return this.toHSLA();case"hex":return this.toHex();default:throw new Error("Invalid Color format")}}},{key:"_componentToHex",value:function(t){var e=t.toString(16);return 1===e.length?"0"+e:e}},{key:"toHex",value:function(){return"#"+this._componentToHex(this.r)+this._componentToHex(this.g)+this._componentToHex(this.b)}},{key:"toRGBA",value:function(){var t=String(this.r.toFixed(0))+", "+String(this.g.toFixed(0))+", "+String(this.b.toFixed(0));return void 0!==this.a||null!==this.a?"rgba("+t+", "+String(this.a)+")":"rgb("+t+")"}},{key:"toHSLA",value:function(){return ct.fromRGBA(this.r,this.g,this.b,this.a).toString()}},{key:"fillStyle",value:function(){return this.toString()}},{key:"clone",value:function(){return new t(this.r,this.g,this.b,this.a)}}],[{key:"fromRGB",value:function(e,n,i,r){return new t(e,n,i,r)}},{key:"fromRGBString",value:function(e){var n=null;if(n=e.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\)/i)){var i=parseInt(n[1],10),r=parseInt(n[2],10),o=parseInt(n[3],10),a=1;return n[4]&&(a=parseFloat(n[4])),new t(i,r,o,a)}throw new Error("Invalid rgb/a string: "+e)}},{key:"fromHex",value:function(e){var n=null;if(n=e.match(/^#?([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})?$/i)){var i=parseInt(n[1],16),r=parseInt(n[2],16),o=parseInt(n[3],16),a=1;return n[4]&&(a=parseInt(n[4],16)/255),new t(i,r,o,a)}throw new Error("Invalid hex string: "+e)}},{key:"fromHSL",value:function(t,e,n){return new ct(t,e,n,arguments.length>3&&void 0!==arguments[3]?arguments[3]:1).toRGBA()}},{key:"Black",get:function(){return t.fromHex("#000000")}},{key:"White",get:function(){return t.fromHex("#FFFFFF")}},{key:"Gray",get:function(){return t.fromHex("#808080")}},{key:"LightGray",get:function(){return t.fromHex("#D3D3D3")}},{key:"DarkGray",get:function(){return t.fromHex("#A9A9A9")}},{key:"Yellow",get:function(){return t.fromHex("#FFFF00")}},{key:"Orange",get:function(){return t.fromHex("#FFA500")}},{key:"Red",get:function(){return t.fromHex("#FF0000")}},{key:"Vermilion",get:function(){return t.fromHex("#FF5B31")}},{key:"Vermillion",get:function(){return t.Vermilion}},{key:"Rose",get:function(){return t.fromHex("#FF007F")}},{key:"Magenta",get:function(){return t.fromHex("#FF00FF")}},{key:"Violet",get:function(){return t.fromHex("#7F00FF")}},{key:"Blue",get:function(){return t.fromHex("#0000FF")}},{key:"Azure",get:function(){return t.fromHex("#007FFF")}},{key:"Cyan",get:function(){return t.fromHex("#00FFFF")}},{key:"Viridian",get:function(){return t.fromHex("#59978F")}},{key:"Green",get:function(){return t.fromHex("#00FF00")}},{key:"Chartreuse",get:function(){return t.fromHex("#7FFF00")}},{key:"Transparent",get:function(){return t.fromHex("#FFFFFF00")}},{key:"ExcaliburBlue",get:function(){return t.fromHex("#176BAA")}}]),t}();lt([nt({message:"Alias for incorrect spelling used in older versions, use multiply instead, will be removed in v0.25.0"})],ut.prototype,"mulitiply",null),lt([nt({message:"Alias for incorrect spelling used in older versions",alternateMethod:"Vermilion"})],ut,"Vermillion",null);var ct=function(){function t(e,n,i,r){f(this,t),this.h=e,this.s=n,this.l=i,this.a=r}return p(t,[{key:"toRGBA",value:function(){var e,n,i;if(0===this.s)e=n=i=this.l;else{var r=this.l<.5?this.l*(1+this.s):this.l+this.s-this.l*this.s,o=2*this.l-r;e=t.hue2rgb(o,r,this.h+1/3),n=t.hue2rgb(o,r,this.h),i=t.hue2rgb(o,r,this.h-1/3)}return new ut(255*e,255*n,255*i,this.a)}},{key:"toString",value:function(){return"hsla(".concat(this.h.toFixed(0),", ").concat(this.s.toFixed(0),", ").concat(this.l.toFixed(0),", ").concat(this.a.toFixed(0),")")}}],[{key:"hue2rgb",value:function(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+(e-t)*(2/3-n)*6:t}},{key:"fromRGBA",value:function(e,n,i,r){e/=255,n/=255,i/=255;var o,a,s=Math.max(e,n,i),l=Math.min(e,n,i),u=(s+l)/2;if(s===l)o=a=0;else{var c=s-l;switch(a=u>.5?c/(2-s-l):c/(s+l),s){case e:o=(n-i)/c+(n<i?6:0);break;case n:o=(i-e)/c+2;break;case i:o=(e-n)/c+4}o/=6}return new t(o,a,u,r)}}]),t}(),ht=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;f(this,t),"object"==typeof e?(this.left=e.left,this.top=e.top,this.right=e.right,this.bottom=e.bottom):"number"==typeof e&&(this.left=e,this.top=n,this.right=i,this.bottom=r)}return p(t,[{key:"width",get:function(){return this.right-this.left}},{key:"height",get:function(){return this.bottom-this.top}},{key:"hasZeroDimensions",value:function(){return 0===this.width||0===this.height}},{key:"center",get:function(){return new rt((this.left+this.right)/2,(this.top+this.bottom)/2)}},{key:"translate",value:function(e){return new t(this.left+e.x,this.top+e.y,this.right+e.x,this.bottom+e.y)}},{key:"rotate",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:rt.Zero,i=this.getPoints().map((function(t){return t.rotate(e,n)}));return t.fromPoints(i)}},{key:"scale",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:rt.Zero,i=this.translate(n);return new t(i.left*e.x,i.top*e.y,i.right*e.x,i.bottom*e.y)}},{key:"transform",value:function(e){var n=this.getPoints().map((function(t){return e.multv(t)}));return t.fromPoints(n)}},{key:"getPerimeter",value:function(){return 2*(this.width+this.height)}},{key:"getPoints",value:function(){var t=[];return t.push(new rt(this.left,this.top)),t.push(new rt(this.right,this.top)),t.push(new rt(this.right,this.bottom)),t.push(new rt(this.left,this.bottom)),t}},{key:"rayCast",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,n=-1/0,i=1/0,r=0===t.dir.x?Number.MAX_VALUE:1/t.dir.x,o=0===t.dir.y?Number.MAX_VALUE:1/t.dir.y,a=(this.left-t.pos.x)*r,s=(this.right-t.pos.x)*r;n=Math.min(a,s),i=Math.max(a,s);var l=(this.top-t.pos.y)*o,u=(this.bottom-t.pos.y)*o;return n=Math.max(n,Math.min(l,u)),(i=Math.min(i,Math.max(l,u)))>=Math.max(0,n)&&n<e}},{key:"rayCastTime",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,n=-1/0,i=1/0,r=0===t.dir.x?Number.MAX_VALUE:1/t.dir.x,o=0===t.dir.y?Number.MAX_VALUE:1/t.dir.y,a=(this.left-t.pos.x)*r,s=(this.right-t.pos.x)*r;n=Math.min(a,s),i=Math.max(a,s);var l=(this.top-t.pos.y)*o,u=(this.bottom-t.pos.y)*o;return n=Math.max(n,Math.min(l,u)),(i=Math.min(i,Math.max(l,u)))>=Math.max(0,n)&&n<e?n:-1}},{key:"contains",value:function(e){return e instanceof rt?this.left<=e.x&&this.top<=e.y&&this.bottom>=e.y&&this.right>=e.x:e instanceof t&&this.left<e.left&&this.top<e.top&&e.bottom<this.bottom&&e.right<this.right}},{key:"combine",value:function(e){return new t(Math.min(this.left,e.left),Math.min(this.top,e.top),Math.max(this.right,e.right),Math.max(this.bottom,e.bottom))}},{key:"dimensions",get:function(){return new rt(this.width,this.height)}},{key:"intersect",value:function(t){var e=this.combine(t);if(e.width<t.width+this.width&&e.height<t.height+this.height&&!e.dimensions.equals(t.dimensions)&&!e.dimensions.equals(this.dimensions)){var n=0;n=this.right>=t.left&&this.right<=t.right?t.left-this.right:t.right-this.left;var i=0;return i=this.top<=t.bottom&&this.top>=t.top?t.bottom-this.top:t.top-this.bottom,Math.abs(n)<Math.abs(i)?new rt(n,0):new rt(0,i)}if(e.dimensions.equals(t.dimensions)||e.dimensions.equals(this.dimensions)){var r=0;r=this.width-t.width>=0?this.right-t.right<=t.left-this.left?t.left-this.right:t.right-this.left:t.right-this.right<=this.left-t.left?this.left-t.right:this.right-t.left;var o=0;return o=this.height-t.height>=0?this.bottom-t.bottom<=t.top-this.top?t.top-this.bottom:t.bottom-this.top:t.bottom-this.bottom<=this.top-t.top?this.top-t.bottom:this.bottom-t.top,Math.abs(r)<Math.abs(o)?new rt(r,0):new rt(0,o)}return null}},{key:"intersectWithSide",value:function(e){var n=this.intersect(e);return t.getSideFromIntersection(n)}},{key:"debugDraw",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ut.Yellow;t.strokeStyle=e.toString(),t.strokeRect(this.left,this.top,this.width,this.height)}},{key:"draw",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ut.Yellow;t.debug.drawRect(this.left,this.top,this.width,this.height,{color:e})}}],[{key:"getSideFromIntersection",value:function(t){return t&&t?Math.abs(t.x)>Math.abs(t.y)?t.x<0?A.Right:A.Left:t.y<0?A.Bottom:A.Top:A.None}},{key:"fromPoints",value:function(e){for(var n=1/0,i=1/0,r=-1/0,o=-1/0,a=0;a<e.length;a++)e[a].x<n&&(n=e[a].x),e[a].x>r&&(r=e[a].x),e[a].y<i&&(i=e[a].y),e[a].y>o&&(o=e[a].y);return new t(n,i,r,o)}},{key:"fromDimension",value:function(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:rt.Half,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:rt.Zero;return new t(-e*i.x+r.x,-n*i.y+r.y,e-e*i.x+r.x,n-n*i.y+r.y)}}]),t}();!function(t){t.Fixed="Fixed",t.FitScreen="FitScreen",t.FillScreen="FillScreen",t.FitContainer="FitContainer",t.FillContainer="FillContainer",t.Position="Position"}(at||(at={}));var dt=function(){function t(){f(this,t)}return p(t,null,[{key:"SVGA",get:function(){return{width:800,height:600}}},{key:"Standard",get:function(){return{width:1920,height:1080}}},{key:"Atari2600",get:function(){return{width:160,height:192}}},{key:"GameBoy",get:function(){return{width:160,height:144}}},{key:"GameBoyAdvance",get:function(){return{width:240,height:160}}},{key:"NintendoDS",get:function(){return{width:256,height:192}}},{key:"NES",get:function(){return{width:256,height:224}}},{key:"SNES",get:function(){return{width:256,height:244}}}]),t}(),ft=function(){function t(e){var n,i,r,o=this;f(this,t),this._antialiasing=!0,this._resolutionStack=[],this._viewportStack=[],this._pixelRatioOverride=null,this._isFullScreen=!1,this._isDisposed=!1,this._logger=P.getInstance(),this._fullscreenChangeHandler=function(){o._isFullScreen=!o._isFullScreen,o._logger.debug("Fullscreen Change",o._isFullScreen)},this._pixelRatioChangeHandler=function(){o._logger.debug("Pixel Ratio Change",window.devicePixelRatio),o._devicePixelRatio=o._calculateDevicePixelRatio(),o.applyResolutionAndViewport()},this._resizeHandler=function(){var t=o.parent;o._logger.debug("View port resized"),o._setResolutionAndViewportByDisplayMode(t),o.applyResolutionAndViewport()},this._devicePixelRatio=this._calculateDevicePixelRatio(),this.viewport=e.viewport,this.resolution=null!==(n=e.resolution)&&void 0!==n?n:Object.assign({},this.viewport),this._displayMode=null!==(i=e.displayMode)&&void 0!==i?i:at.Fixed,this._canvas=e.canvas,this._ctx=e.context,this._antialiasing=null!==(r=e.antialiasing)&&void 0!==r?r:this._antialiasing,this._browser=e.browser,this._position=e.position,this._pixelRatioOverride=e.pixelRatio,this._applyDisplayMode(),this._mediaQueryList=this._browser.window.nativeComponent.matchMedia("(resolution: ".concat(window.devicePixelRatio,"dppx)")),this._mediaQueryList.addEventListener("change",this._pixelRatioChangeHandler),this._canvas.addEventListener("fullscreenchange",this._fullscreenChangeHandler)}return p(t,[{key:"dispose",value:function(){this._isDisposed||(this._isDisposed=!0,this._browser.window.off("resize",this._resizeHandler),this._resizeObserver&&this._resizeObserver.disconnect(),this.parent.removeEventListener("resize",this._resizeHandler),this._mediaQueryList.removeEventListener("change",this._pixelRatioChangeHandler),this._canvas.removeEventListener("fullscreenchange",this._fullscreenChangeHandler))}},{key:"_calculateDevicePixelRatio",value:function(){return window.devicePixelRatio<1?1:window.devicePixelRatio||1}},{key:"pixelRatio",get:function(){return this._pixelRatioOverride?this._pixelRatioOverride:this._devicePixelRatio}},{key:"isHiDpi",get:function(){return 1!==this.pixelRatio}},{key:"displayMode",get:function(){return this._displayMode}},{key:"canvas",get:function(){return this._canvas}},{key:"parent",get:function(){return this.displayMode===at.FillContainer||this.displayMode===at.FitContainer?this.canvas.parentElement||document.body:window}},{key:"resolution",get:function(){return this._resolution},set:function(t){this._resolution=t}},{key:"viewport",get:function(){return this._viewport?this._viewport:this._resolution},set:function(t){this._viewport=t}},{key:"aspectRatio",get:function(){return this._resolution.width/this._resolution.height}},{key:"scaledWidth",get:function(){return this._resolution.width*this.pixelRatio}},{key:"scaledHeight",get:function(){return this._resolution.height*this.pixelRatio}},{key:"setCurrentCamera",value:function(t){this._camera=t}},{key:"pushResolutionAndViewport",value:function(){this._resolutionStack.push(this.resolution),this._viewportStack.push(this.viewport),this.resolution=Object.assign({},this.resolution),this.viewport=Object.assign({},this.viewport)}},{key:"popResolutionAndViewport",value:function(){this.resolution=this._resolutionStack.pop(),this.viewport=this._viewportStack.pop()}},{key:"applyResolutionAndViewport",value:function(){this._canvas.width=this.scaledWidth,this._canvas.height=this.scaledHeight,this._antialiasing?this._canvas.style.imageRendering="auto":(this._canvas.style.imageRendering="pixelated",""===this._canvas.style.imageRendering&&(this._canvas.style.imageRendering="crisp-edges")),this._canvas.style.width=this.viewport.width+"px",this._canvas.style.height=this.viewport.height+"px",this._ctx.updateViewport(),this._ctx.resetTransform(),this._ctx.scale(this.pixelRatio,this.pixelRatio),this._ctx.smoothing=this._antialiasing}},{key:"antialiasing",get:function(){return this._antialiasing},set:function(t){this._antialiasing=t,this._ctx.smoothing=this._antialiasing}},{key:"isFullScreen",get:function(){return this._isFullScreen}},{key:"goFullScreen",value:function(){return this._canvas.requestFullscreen()}},{key:"exitFullScreen",value:function(){return document.exitFullscreen()}},{key:"pageToScreenCoordinates",value:function(t){var e=t.x,n=t.y;if(this._isFullScreen||(e-=W(this._canvas).x,n-=W(this._canvas).y),this._isFullScreen)if(window.innerWidth/this.aspectRatio<window.innerHeight){var i=window.innerWidth/this.aspectRatio;n=(n-(window.innerHeight-i)/2)/i*this.viewport.height,e=e/window.innerWidth*this.viewport.width}else{var r=window.innerHeight*this.aspectRatio;e=(e-(window.innerWidth-r)/2)/r*this.viewport.width,n=n/window.innerHeight*this.viewport.height}return e=e/this.viewport.width*this.resolution.width,n=n/this.viewport.height*this.resolution.height,new rt(e,n)}},{key:"screenToPageCoordinates",value:function(t){var e=t.x,n=t.y;if(e=e/this.resolution.width*this.viewport.width,n=n/this.resolution.height*this.viewport.height,this._isFullScreen)if(window.innerWidth/this.aspectRatio<window.innerHeight){var i=window.innerWidth/this.aspectRatio,r=(window.innerHeight-i)/2;n=n/this.viewport.height*i+r,e=e/this.viewport.width*window.innerWidth}else{var o=window.innerHeight*this.aspectRatio,a=(window.innerWidth-o)/2;e=e/this.viewport.width*o+a,n=n/this.viewport.height*window.innerHeight}return this._isFullScreen||(e+=W(this._canvas).x,n+=W(this._canvas).y),new rt(e,n)}},{key:"screenToWorldCoordinates",value:function(t){var e,n,i,r,o=t.x,a=t.y;return o=o/this.resolution.width*this.drawWidth,a=a/this.resolution.height*this.drawHeight,o-=this.halfDrawWidth,a-=this.halfDrawHeight,o+=null!==(n=null===(e=this._camera)||void 0===e?void 0:e.x)&&void 0!==n?n:0,a+=null!==(r=null===(i=this._camera)||void 0===i?void 0:i.y)&&void 0!==r?r:0,new rt(o,a)}},{key:"worldToScreenCoordinates",value:function(t){var e,n,i,r,o=t.x,a=t.y;return o-=null!==(n=null===(e=this._camera)||void 0===e?void 0:e.x)&&void 0!==n?n:0,a-=null!==(r=null===(i=this._camera)||void 0===i?void 0:i.y)&&void 0!==r?r:0,o+=this.halfDrawWidth,a+=this.halfDrawHeight,o=o/this.drawWidth*this.resolution.width,a=a/this.drawHeight*this.resolution.height,new rt(o,a)}},{key:"pageToWorldCoordinates",value:function(t){var e=this.pageToScreenCoordinates(t);return this.screenToWorldCoordinates(e)}},{key:"worldToPageCoordinates",value:function(t){var e=this.worldToScreenCoordinates(t);return this.screenToPageCoordinates(e)}},{key:"getWorldBounds",value:function(){var t=this.screenToWorldCoordinates(rt.Zero).x,e=this.screenToWorldCoordinates(rt.Zero).y,n=t+this.drawWidth,i=e+this.drawHeight;return new ht(t,e,n,i)}},{key:"canvasWidth",get:function(){return this.canvas.width}},{key:"halfCanvasWidth",get:function(){return this.canvas.width/2}},{key:"canvasHeight",get:function(){return this.canvas.height}},{key:"halfCanvasHeight",get:function(){return this.canvas.height/2}},{key:"drawWidth",get:function(){return this._camera?this.scaledWidth/this._camera.zoom/this.pixelRatio:this.scaledWidth/this.pixelRatio}},{key:"halfDrawWidth",get:function(){return this.drawWidth/2}},{key:"drawHeight",get:function(){return this._camera?this.scaledHeight/this._camera.zoom/this.pixelRatio:this.scaledHeight/this.pixelRatio}},{key:"halfDrawHeight",get:function(){return this.drawHeight/2}},{key:"center",get:function(){return ot(this.halfDrawWidth,this.halfDrawHeight)}},{key:"_computeFit",value:function(){document.body.style.margin="0px",document.body.style.overflow="hidden";var t=this.aspectRatio,e=0,n=0;window.innerWidth/t<window.innerHeight?(e=window.innerWidth,n=window.innerWidth/t):(e=window.innerHeight*t,n=window.innerHeight),this.viewport={width:e,height:n}}},{key:"_computeFitContainer",value:function(){var t=this.aspectRatio,e=0,n=0,i=this.canvas.parentElement;i.clientWidth/t<i.clientHeight?(e=i.clientWidth,n=i.clientWidth/t):(e=i.clientHeight*t,n=i.clientHeight),this.viewport={width:e,height:n}}},{key:"_applyDisplayMode",value:function(){var t=this;this.displayMode===at.Position?this._initializeDisplayModePosition(this._position):(this._setResolutionAndViewportByDisplayMode(this.parent),this.parent instanceof Window?this._browser.window.on("resize",this._resizeHandler):(this._resizeObserver=new ResizeObserver((function(){t._resizeHandler()})),this._resizeObserver.observe(this.parent)),this.parent.addEventListener("resize",this._resizeHandler))}},{key:"_setResolutionAndViewportByDisplayMode",value:function(t){this.displayMode===at.FillContainer&&(this.resolution={width:t.clientWidth,height:t.clientHeight},this.viewport=this.resolution),this.displayMode===at.FillScreen&&(document.body.style.margin="0px",document.body.style.overflow="hidden",this.resolution={width:t.innerWidth,height:t.innerHeight},this.viewport=this.resolution),this.displayMode===at.FitScreen&&this._computeFit(),this.displayMode===at.FitContainer&&this._computeFitContainer()}},{key:"_initializeDisplayModePosition",value:function(t){if(!t)throw new Error("DisplayMode of Position was selected but no position option was given");if(this.canvas.style.display="block",this.canvas.style.position="absolute","string"==typeof t){var e=t.split(" ");switch(e[0]){case"top":this.canvas.style.top="0px";break;case"bottom":this.canvas.style.bottom="0px";break;case"middle":this.canvas.style.top="50%";var n=-this.halfDrawHeight;this.canvas.style.marginTop=n.toString();break;default:throw new Error("Invalid Position Given")}if(e[1])switch(e[1]){case"left":this.canvas.style.left="0px";break;case"right":this.canvas.style.right="0px";break;case"center":this.canvas.style.left="50%";var i=-this.halfDrawWidth;this.canvas.style.marginLeft=i.toString();break;default:throw new Error("Invalid Position Given")}}else t.top&&("number"==typeof t.top?this.canvas.style.top=t.top.toString()+"px":this.canvas.style.top=t.top),t.right&&("number"==typeof t.right?this.canvas.style.right=t.right.toString()+"px":this.canvas.style.right=t.right),t.bottom&&("number"==typeof t.bottom?this.canvas.style.bottom=t.bottom.toString()+"px":this.canvas.style.bottom=t.bottom),t.left&&("number"==typeof t.left?this.canvas.style.left=t.left.toString()+"px":this.canvas.style.left=t.left)}}]),t}(),pt=function(){function t(){f(this,t)}return p(t,null,[{key:"create",value:function(){return this._INSTANCE||(window.AudioContext||window.webkitAudioContext)&&(this._INSTANCE=new AudioContext),this._INSTANCE}}]),t}();pt._INSTANCE=null;var vt=function(){function t(){f(this,t)}return p(t,null,[{key:"unlock",value:function(){return new Promise((function(e,n){if(t._UNLOCKED||!pt.create())return e(!0);var i=setTimeout((function(){P.getInstance().warn("Excalibur was unable to unlock the audio context, audio probably will not play in this browser."),e(!1)}),200),r=pt.create();r.resume().then((function(){var n=r.createBuffer(1,1,22050),o=r.createBufferSource(),a=!1;o.buffer=n,o.connect(r.destination),o.onended=function(){return a=!0},o.start(0),setTimeout((function(){!function(t){return!!t.playbackState}(o)?(r.currentTime>0||a)&&(t._UNLOCKED=!0):o.playbackState!==o.PLAYING_STATE&&o.playbackState!==o.FINISHED_STATE||(t._UNLOCKED=!0)}),0),clearTimeout(i),e(!0)}),(function(){n()}))}))}},{key:"isUnlocked",value:function(){return this._UNLOCKED}}]),t}();vt._UNLOCKED=!1,function(t){t.Kill="kill",t.PreKill="prekill",t.PostKill="postkill",t.PreDraw="predraw",t.PostDraw="postdraw",t.PreDebugDraw="predebugdraw",t.PostDebugDraw="postdebugdraw",t.PreUpdate="preupdate",t.PostUpdate="postupdate",t.PreFrame="preframe",t.PostFrame="postframe",t.PreCollision="precollision",t.CollisionStart="collisionstart",t.CollisionEnd="collisionend",t.PostCollision="postcollision",t.Initialize="initialize",t.Activate="activate",t.Deactivate="deactivate",t.ExitViewport="exitviewport",t.EnterViewport="enterviewport",t.ExitTrigger="exit",t.EnterTrigger="enter",t.Connect="connect",t.Disconnect="disconnect",t.Button="button",t.Axis="axis",t.Subscribe="subscribe",t.Unsubscribe="unsubscribe",t.Visible="visible",t.Hidden="hidden",t.Start="start",t.Stop="stop",t.PointerUp="pointerup",t.PointerDown="pointerdown",t.PointerMove="pointermove",t.PointerEnter="pointerenter",t.PointerLeave="pointerleave",t.PointerCancel="pointercancel",t.PointerWheel="pointerwheel",t.Up="up",t.Down="down",t.Move="move",t.Enter="enter",t.Leave="leave",t.Cancel="cancel",t.Wheel="wheel",t.Press="press",t.Release="release",t.Hold="hold",t.PointerDragStart="pointerdragstart",t.PointerDragEnd="pointerdragend",t.PointerDragEnter="pointerdragenter",t.PointerDragLeave="pointerdragleave",t.PointerDragMove="pointerdragmove"}(st||(st={}));var gt=function(){function t(){f(this,t),this._bubbles=!0}return p(t,[{key:"bubbles",get:function(){return this._bubbles},set:function(t){this._bubbles=t}},{key:"stopPropagation",value:function(){this.bubbles=!1}}]),t}(),yt=function(t){h(n,t);var e=d(n);function n(t){var i;return f(this,n),(i=e.call(this)).target=t,i}return n}(gt),mt=function(t){h(n,t);var e=d(n);function n(t){var i;return f(this,n),(i=e.call(this)).target=t,i}return n}(gt),_t=function(t){h(n,t);var e=d(n);function n(t){var i;return f(this,n),(i=e.call(this)).target=t,i}return n}(gt),wt=function(t){h(n,t);var e=d(n);function n(t){var i;return f(this,n),(i=e.call(this)).target=t,i}return n}(gt),bt=function(t){h(n,t);var e=d(n);function n(t){var i;return f(this,n),(i=e.call(this)).target=t,i}return n}(gt),kt=function(t){h(n,t);var e=d(n);function n(t,i,r){var o;return f(this,n),(o=e.call(this)).ctx=t,o.delta=i,o.target=r,o}return n}(gt),xt=function(t){h(n,t);var e=d(n);function n(t,i,r){var o;return f(this,n),(o=e.call(this)).ctx=t,o.delta=i,o.target=r,o}return n}(gt),Ct=function(t){h(n,t);var e=d(n);function n(t,i){var r;return f(this,n),(r=e.call(this)).ctx=t,r.target=i,r}return n}(gt),St=function(t){h(n,t);var e=d(n);function n(t,i){var r;return f(this,n),(r=e.call(this)).ctx=t,r.target=i,r}return n}(gt),Et=function(t){h(n,t);var e=d(n);function n(t,i,r){var o;return f(this,n),(o=e.call(this)).engine=t,o.delta=i,o.target=r,o}return n}(gt),Pt=function(t){h(n,t);var e=d(n);function n(t,i,r){var o;return f(this,n),(o=e.call(this)).engine=t,o.delta=i,o.target=r,o}return n}(gt),At=function(t){h(n,t);var e=d(n);function n(t,i){var r;return f(this,n),(r=e.call(this)).engine=t,r.prevStats=i,r.target=t,r}return n}(gt),Tt=function(t){h(n,t);var e=d(n);function n(t,i){var r;return f(this,n),(r=e.call(this)).engine=t,r.stats=i,r.target=t,r}return n}(gt),Rt=function(t){h(n,t);var e=d(n);function n(t,i){var r;return f(this,n),(r=e.call(this)).index=t,r.gamepad=i,r.target=i,r}return n}(gt),Dt=function(t){h(n,t);var e=d(n);function n(t,i){var r;return f(this,n),(r=e.call(this)).index=t,r.gamepad=i,r.target=i,r}return n}(gt),Mt=function(t){h(n,t);var e=d(n);function n(t,i,r){var o;return f(this,n),(o=e.call(this)).button=t,o.value=i,o.target=r,o}return n}(gt),Lt=function(t){h(n,t);var e=d(n);function n(t,i,r){var o;return f(this,n),(o=e.call(this)).axis=t,o.value=i,o.target=r,o}return n}(gt),Bt=function(t){h(n,t);var e=d(n);function n(t,i){var r;return f(this,n),(r=e.call(this)).topic=t,r.handler=i,r}return n}(gt),Ot=function(t){h(n,t);var e=d(n);function n(t,i){var r;return f(this,n),(r=e.call(this)).topic=t,r.handler=i,r}return n}(gt),Ft=function(t){h(n,t);var e=d(n);function n(t){var i;return f(this,n),(i=e.call(this)).target=t,i}return n}(gt),It=function(t){h(n,t);var e=d(n);function n(t){var i;return f(this,n),(i=e.call(this)).target=t,i}return n}(gt),zt=function(t){h(n,t);var e=d(n);function n(t,i,r,o){var a;return f(this,n),(a=e.call(this)).other=i,a.side=r,a.intersection=o,a.target=t,a}return n}(gt),Nt=function(t){h(n,t);var e=d(n);function n(t,i,r,o){var a;return f(this,n),(a=e.call(this)).other=i,a.side=r,a.intersection=o,a.target=t,a}return p(n,[{key:"actor",get:function(){return this.target},set:function(t){this.target=t}}]),n}(gt),Ut=function t(e,n,i){f(this,t),this.target=e,this.other=n,this.contact=i},Ht=function t(e,n){f(this,t),this.target=e,this.other=n},Wt=function t(e,n,i,r,o){f(this,t),this.target=e,this.other=n,this.side=i,this.intersection=r,this.contact=o},jt=function t(e,n,i,r,o){f(this,t),this.target=e,this.other=n,this.side=i,this.intersection=r,this.contact=o},Vt=function(t){h(n,t);var e=d(n);function n(t,i,r){var o;return f(this,n),(o=e.call(this)).other=i,o.contact=r,o.target=t,o}return p(n,[{key:"actor",get:function(){return this.target},set:function(t){this.target=t}}]),n}(gt),Gt=function(t){h(n,t);var e=d(n);function n(t,i){var r;return f(this,n),(r=e.call(this)).other=i,r.target=t,r}return p(n,[{key:"actor",get:function(){return this.target},set:function(t){this.target=t}}]),n}(gt),Xt=function(t){h(n,t);var e=d(n);function n(t,i){var r;return f(this,n),(r=e.call(this)).engine=t,r.target=i,r}return n}(gt),qt=function(t){h(n,t);var e=d(n);function n(t,i){var r;return f(this,n),(r=e.call(this)).oldScene=t,r.target=i,r}return n}(gt),Kt=function(t){h(n,t);var e=d(n);function n(t,i){var r;return f(this,n),(r=e.call(this)).newScene=t,r.target=i,r}return n}(gt),Qt=function(t){h(n,t);var e=d(n);function n(t){var i;return f(this,n),(i=e.call(this)).target=t,i}return n}(gt),Yt=function(t){h(n,t);var e=d(n);function n(t){var i;return f(this,n),(i=e.call(this)).target=t,i}return n}(gt),Zt=function(t){h(n,t);var e=d(n);function n(t,i){var r;return f(this,n),(r=e.call(this)).target=t,r.actor=i,r}return n}(gt),$t=function(t){h(n,t);var e=d(n);function n(t,i){var r;return f(this,n),(r=e.call(this)).target=t,r.actor=i,r}return n}(gt),Jt=function(){function t(e){f(this,t),this._handlers={},this._wiredEventDispatchers=[],this._target=e}return p(t,[{key:"clear",value:function(){this._handlers={},this._wiredEventDispatchers=[]}},{key:"emit",value:function(t,e){if(t){t=t.toLowerCase();var n,i,r=this._target;e||(e=new gt);try{e.target||(e.target=r)}catch(t){}if(this._handlers[t])for(n=0,i=this._handlers[t].length;n<i;n++)this._handlers[t][n].call(r,e);for(n=0,i=this._wiredEventDispatchers.length;n<i;n++)this._wiredEventDispatchers[n].emit(t,e)}}},{key:"on",value:function(t,e){t=t.toLowerCase(),this._handlers[t]||(this._handlers[t]=[]),this._handlers[t].push(e),"unsubscribe"!==t&&"subscribe"!==t&&this.emit("subscribe",new Bt(t,e))}},{key:"off",value:function(t,e){t=t.toLowerCase();var n=this._handlers[t];if(n)if(e){var i=n.indexOf(e);this._handlers[t].splice(i,1)}else this._handlers[t].length=0;"unsubscribe"!==t&&"subscribe"!==t&&this.emit("unsubscribe",new Ot(t,e))}},{key:"once",value:function(t,e){var n=this;this.on(t,(function(i){var r=i||new gt;try{r.target=r.target||n._target}catch(t){}n.off(t,e),e.call(r.target,r)}))}},{key:"wire",value:function(t){t._wiredEventDispatchers.push(this)}},{key:"unwire",value:function(t){var e=t._wiredEventDispatchers.indexOf(this);e>-1&&t._wiredEventDispatchers.splice(e,1)}}]),t}(),te=function(){function t(){f(this,t),this.eventDispatcher=new Jt(this)}return p(t,[{key:"on",value:function(t,e){this.eventDispatcher.on(t,e)}},{key:"off",value:function(t,e){this.eventDispatcher.off(t,e)}},{key:"emit",value:function(t,e){this.eventDispatcher.emit(t,e)}},{key:"once",value:function(t,e){this.eventDispatcher.once(t,e)}}]),t}();function ee(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ut.Red,n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0,o=arguments.length>5?arguments[5]:void 0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"butt";t.beginPath(),t.lineWidth=a,t.lineCap=s,t.strokeStyle=e.toString(),t.moveTo(n,i),t.lineTo(r,o),t.closePath(),t.stroke()}function ne(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ut.Red,n=arguments.length>2?arguments[2]:void 0;t.beginPath(),t.strokeStyle=e.toString(),t.arc(n.x,n.y,5,0,2*Math.PI),t.closePath(),t.stroke()}function ie(t,e,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,o=e?e.toString():"blue",a=i.scale(r);t.beginPath(),t.strokeStyle=o,t.moveTo(n.x,n.y),t.lineTo(n.x+a.x,n.y+a.y),t.closePath(),t.stroke()}function re(t,e,n,i,r){var o,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:5,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:ut.White,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;if("number"==typeof a)o={tl:a,tr:a,br:a,bl:a};else{var u={tl:0,tr:0,br:0,bl:0};for(var c in u)if(u.hasOwnProperty(c)){var h=c;o[h]=a[h]||u[h]}}t.beginPath(),t.moveTo(e+o.tl,n),t.lineTo(e+i-o.tr,n),t.quadraticCurveTo(e+i,n,e+i,n+o.tr),t.lineTo(e+i,n+r-o.br),t.quadraticCurveTo(e+i,n+r,e+i-o.br,n+r),t.lineTo(e+o.bl,n+r),t.quadraticCurveTo(e,n+r,e,n+r-o.bl),t.lineTo(e,n+o.tl),t.quadraticCurveTo(e,n,e+o.tl,n),t.closePath(),l&&(t.fillStyle=l.toString(),t.fill()),s&&(t.strokeStyle=s.toString(),t.stroke())}function oe(t,e,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:ut.White,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;t.beginPath(),t.arc(e,n,i,0,2*Math.PI),t.closePath(),o&&(t.fillStyle=o.toString(),t.fill()),r&&(t.strokeStyle=r.toString(),t.stroke())}var ae=n(1388),se=function(){function t(e){var n,i,r,o,a,s;f(this,t),this.id=t._ID++,this.showDebug=!1,this.flipHorizontal=!1,this.flipVertical=!1,this.rotation=0,this.opacity=1,this.scale=rt.One,this.origin=null,this._width=0,this._height=0,e&&(this.origin=null!==(n=e.origin)&&void 0!==n?n:this.origin,this.flipHorizontal=null!==(i=e.flipHorizontal)&&void 0!==i?i:this.flipHorizontal,this.flipVertical=null!==(r=e.flipVertical)&&void 0!==r?r:this.flipVertical,this.rotation=null!==(o=e.rotation)&&void 0!==o?o:this.rotation,this.opacity=null!==(a=e.opacity)&&void 0!==a?a:this.opacity,this.scale=null!==(s=e.scale)&&void 0!==s?s:this.scale)}return p(t,[{key:"cloneGraphicOptions",value:function(){return{origin:this.origin?this.origin.clone():null,flipHorizontal:this.flipHorizontal,flipVertical:this.flipVertical,rotation:this.rotation,opacity:this.opacity,scale:this.scale?this.scale.clone():null}}},{key:"width",get:function(){return Math.abs(this._width*this.scale.x)},set:function(t){this._width=t}},{key:"height",get:function(){return Math.abs(this._height*this.scale.y)},set:function(t){this._height=t}},{key:"localBounds",get:function(){return ht.fromDimension(this.width,this.height,rt.Zero)}},{key:"draw",value:function(t,e,n){this._preDraw(t,e,n),this._drawImage(t,0,0),this._postDraw(t)}},{key:"_preDraw",value:function(t,e,n){t.save(),t.translate(e,n),t.scale(Math.abs(this.scale.x),Math.abs(this.scale.y)),this._rotate(t),this._flip(t),t.opacity=t.opacity*this.opacity}},{key:"_rotate",value:function(t){var e,n=this.scale.x>0?1:-1,i=this.scale.y>0?1:-1,r=null!==(e=this.origin)&&void 0!==e?e:ot(this.width/2,this.height/2);t.translate(r.x,r.y),t.rotate(this.rotation),t.scale(n,i),t.translate(-r.x,-r.y)}},{key:"_flip",value:function(t){this.flipHorizontal&&(t.translate(this.width/this.scale.x,0),t.scale(-1,1)),this.flipVertical&&(t.translate(0,this.height/this.scale.y),t.scale(1,-1))}},{key:"_postDraw",value:function(t){this.showDebug&&t.debug.drawRect(0,0,this.width,this.height),t.restore()}}]),t}();function le(t){return 0==(t&t-1)}function ue(t){return le(t)?t:function(t){--t;for(var e=1;e<32;e<<=1)t|=t>>e;return t+1}(t)}function ce(t,e){return t&&void 0===t.__isProxy?new Proxy(t,{set:function(t,n,i){return t[n]!==i&&(t[n]=i,"string"==typeof n&&"_"!==n[0]&&e(t)),!0},get:function(t,e){return"__isProxy"===e||t[e]}}):t}function he(t,e){return t&&void 0===t.__isProxy?new Proxy(t,{set:function(t,n,i){return t[n]=i,"string"==typeof n&&"_"!==n[0]&&e(t),!0},get:function(t,e){return"__isProxy"===e||t[e]}}):t}se._ID=0;var de=function(){function t(){f(this,t)}return p(t,null,[{key:"registerContext",value:function(e){t._GL=e}},{key:"get",value:function(e){return t._TEXTURE_MAP.get(e)}},{key:"has",value:function(e){return t._TEXTURE_MAP.has(e)}},{key:"load",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=t._GL;if(!i)return null;var r=null;if(t.has(e)&&(r=t.get(e)),r){if(n){i.bindTexture(i.TEXTURE_2D,r);var o=t.toPowerOfTwoImage(e);i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,o)}return r}r=i.createTexture();var a=t.toPowerOfTwoImage(e);return i.bindTexture(i.TEXTURE_2D,r),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.NEAREST),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,a),t._TEXTURE_MAP.set(e,r),r}},{key:"toPowerOfTwoImage",value:function(e){var n=t._POT_CANVAS,i=t._POT_CTX;return le(e.width)&&le(e.height)||(n.width=ue(e.width),n.height=ue(e.height),i.imageSmoothingEnabled=!1,i.clearRect(0,0,n.width,n.height),i.drawImage(e,0,0,e.width,e.height),e=n),e}}]),t}();de._POT_CANVAS=document.createElement("canvas"),de._POT_CTX=de._POT_CANVAS.getContext("2d"),de._TEXTURE_MAP=new Map;var fe=function(t){h(n,t);var e=d(n);function n(t){var i,r,o,a,s,l,u,c;f(this,n),(i=e.call(this,t))._dirty=!0,i._smoothing=!1,i._color=ce(ut.Black,(function(){return i.flagDirty()})),i._lineWidth=1,i._lineDash=[],i._padding=0,t&&(i.color=null!==(r=t.color)&&void 0!==r?r:ut.Black,i.strokeColor=null==t?void 0:t.strokeColor,i.smoothing=null!==(o=t.smoothing)&&void 0!==o?o:i.smoothing,i.lineWidth=null!==(a=t.lineWidth)&&void 0!==a?a:i.lineWidth,i.lineDash=null!==(s=t.lineDash)&&void 0!==s?s:i.lineDash,i.padding=null!==(l=t.padding)&&void 0!==l?l:i.padding),i._bitmap=document.createElement("canvas");var h=null!==(u=null==t?void 0:t.width)&&void 0!==u?u:i._bitmap.width,d=null!==(c=null==t?void 0:t.height)&&void 0!==c?c:i._bitmap.height;i.width=ue(h),i.height=ue(d);var p=i._bitmap.getContext("2d");if(!p)throw new Error("Browser does not support 2d canvas drawing, cannot create Raster graphic");return i._ctx=p,i}return p(n,[{key:"cloneRasterOptions",value:function(){return{color:this.color?this.color.clone():null,strokeColor:this.strokeColor?this.strokeColor.clone():null,smoothing:this.smoothing,lineWidth:this.lineWidth,lineDash:this.lineDash,padding:this.padding}}},{key:"dirty",get:function(){return this._dirty}},{key:"flagDirty",value:function(){this._dirty=!0}},{key:"width",get:function(){return this._getTotalWidth()},set:function(t){this._bitmap.width=t,this._originalWidth=t,this.flagDirty()}},{key:"height",get:function(){return this._getTotalHeight()},set:function(t){this._bitmap.height=t,this._originalHeight=t,this.flagDirty()}},{key:"_getTotalWidth",value:function(){var t;return(null!==(t=this._originalWidth)&&void 0!==t?t:this._bitmap.width)+2*this.padding}},{key:"_getTotalHeight",value:function(){var t;return(null!==(t=this._originalHeight)&&void 0!==t?t:this._bitmap.height)+2*this.padding}},{key:"localBounds",get:function(){return ht.fromDimension(this._getTotalWidth()*this.scale.x,this._getTotalHeight()*this.scale.y,rt.Zero)}},{key:"smoothing",get:function(){return this._smoothing},set:function(t){this._smoothing=t,this.flagDirty()}},{key:"color",get:function(){return this._color},set:function(t){var e,n=this;(null===(e=this._color)||void 0===e?void 0:e.equal(t))||this.flagDirty(),this._color=ce(t,(function(){return n.flagDirty()}))}},{key:"strokeColor",get:function(){return this._strokeColor},set:function(t){var e,n=this;(null===(e=this._strokeColor)||void 0===e?void 0:e.equal(t))||this.flagDirty(),this._strokeColor=ce(t,(function(){return n.flagDirty()}))}},{key:"lineWidth",get:function(){return this._lineWidth},set:function(t){this._lineWidth=t,this.flagDirty()}},{key:"lineDash",get:function(){return this._lineDash},set:function(t){this._lineDash=t,this.flagDirty()}},{key:"padding",get:function(){return this._padding},set:function(t){this._padding=t,this.flagDirty()}},{key:"rasterize",value:function(){this._dirty=!1,this._ctx.clearRect(0,0,this._getTotalWidth(),this._getTotalHeight()),this._ctx.save(),this._applyRasterProperites(this._ctx),this.execute(this._ctx),this._ctx.restore(),de.load(this._bitmap,!0)}},{key:"_applyRasterProperites",value:function(t){var e,n,i;this._bitmap.width=this._getTotalWidth(),this._bitmap.height=this._getTotalHeight(),t.translate(this.padding,this.padding),t.imageSmoothingEnabled=this.smoothing,t.lineWidth=this.lineWidth,t.setLineDash(null!==(e=this.lineDash)&&void 0!==e?e:t.getLineDash()),t.strokeStyle=null===(n=this.strokeColor)||void 0===n?void 0:n.toString(),t.fillStyle=null===(i=this.color)||void 0===i?void 0:i.toString()}},{key:"_drawImage",value:function(t,e,n){this._dirty&&this.rasterize(),t.drawImage(this._bitmap,e,n)}}]),n}(se),pe=function(t){h(n,t);var e=d(n);function n(t){var i;return f(this,n),(i=e.call(this,t))._options=t,i}return p(n,[{key:"ctx",get:function(){return this._ctx}},{key:"clone",value:function(){return new n(Object.assign(Object.assign(Object.assign({},this._options),this.cloneGraphicOptions()),this.cloneRasterOptions()))}},{key:"execute",value:function(t){var e,n;(null===(e=this._options)||void 0===e?void 0:e.draw)&&(null===(n=this._options)||void 0===n||n.draw(t)),this._options.cache||this.flagDirty()}}]),n}(fe),ve=function(t,e,n,i){return new(n||(n=Promise))((function(r,o){function a(t){try{l(i.next(t))}catch(t){o(t)}}function s(t){try{l(i.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}l((i=i.apply(t,e||[])).next())}))},ge=function(t){h(n,t);var e=d(n);function n(t){var i;return f(this,n),(i=e.call(this)).canvas=new pe({smoothing:!0,draw:i.draw.bind(c(i))}),i._resourceList=[],i._index=0,i._playButtonShown=!1,i._resourceCount=0,i._numLoaded=0,i._progressCounts={},i._totalCounts={},i.logo="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAdQAAAB2CAYAAABxhGI9AAAACXBIWXMAAAsSAAALEgHS3X78AAAKnUlEQVR42u3dP2wjSx0H8N8hJIonIRmJjsq0SBR+BQ1dcqKhe0lD77SvSwpKkJKGPulpktfRIMUdEqKIqV57rpAokM4dbSiyq7ONPTP7x39ifz7SFbnEnp3xer47O7uzH15fXwMA6OYHmgAABCoACFQAEKgAgEAFAIEKAAIVAAQqACBQAUCgAoBABQCBCgAIVAAQqAAgUAFAoAIAAhUABCoACFQAEKgAgECFLbmOiNeFf2PbAyz68Pr6qhUgbRwR92v+/zwiJrYHMEKFMmcN///UtgcQqFBk1PD/97U9Qx8VCFSgu4EmAIEKAAIVAAQqACBQ4Z25jojP8eX+0WtNAgIVaOY+Im5j+eKh24h41jQgUIEyZ7F5NaPU7wCBCiwYd/w9cOB+qAlgJ3KLLow0EV198803RWvJfvfddx+0lhEqHKu5JgAjVCBvlhmFzjQRXUekHz9+TP79y8uLRjNChXfvoePvAYEKxNtj1e42/O5JoIJABcrdRMRVLM+X3kTEpaaB988cKuzWg9EobTWdMx0Oly8uN4dqhAoARqgnaN3arHfqu7OyH8ItKLVB/P+CEfMTHyGPY3npx1m8zWGDEeoBfUk/xdti57dr/r1Wv2+6EPow3tZ5rRdS72s1neuF97xvWd+XTH0/V+UMttDWqbI/r2nrxfp+jv2uSjSO7S+OXy/A/3lN+9xX5T5HxEUPZZ0tfB71+w57eJ/HFu+z+jkv1u92YX9fbI/HhX3JA9rp5MPr66tWaG9UfUGbrHIzi7cLUyYFf/tpTady03EEeL8mUJ6i7MKYNvWNqr4Pe2jradXO60LrvPAz2PQ5RPX684ah8dxD+2zantnCgVipSVV+m/tgB9W2DDq2Sx/vM95wcHhZhWVJm8yrv58cSgfTdc70+++/X/r522+/tUKSEepBqo+om4ZLPerMjUwuNnQCtx1GWJtee1FwdD5uWd86xLs8UaVt2aNEO1/saZ/Z5rYMW4zq6v34rGV9Bg3q2eZ9SkeNm9qwyUh30OPIHYFKx5FG03C7znSOqYBq+qW/zpQ3anH037TNHluG6f0WPsPhHvab4QFty7ogOeuxDYcNy2/zu2214WNYWxmBurNO8bGn97pNBOO8xy/9uCorZZ4I2r4C7aJgO7ZV9iE49Dm6NvOWx+pWE9CUq3zbdTp9doz38TbXtzqH9RT5CyWe422OaZoZGeZCabrhPQY9HjwsjpTvCg4YtlE2+Ta/j2bzn8fqrDqgm+6yUHOmAvWUjAtGhbNYvsBknDnqH1Qhc7VmxHgeb/NbudA5j/UXlYwif2p6luhAc9teu1npiHKnDs8if6tCm7JLX3NKpgttXe9ruc9mHMd7a83iwdxF5vt8tutARaCeklRnNK9C8WnNF7geJQ4T4XG3JhSnVdilQrG+yOnrlVHfsEGYzhNBn7Lu6tS7+HJafJQ4EMiNlNqWXZ9WPvVgnVYHG5M1ByDXkT6leX2EgTqJtyt45yv7S2qO3sEZjZhDLXeR+YKdJ0Zdk8QocvH9N732KrNtq+FZ/zzIHABcJrYpd+Xv14lOd5ap76SgrduW/VTQ1qcQpqnbgu4ifZvUMNpd9XuoZmvCtPaQ2Y/BCHVLgbrJTeRPDdVf6pfMKDU2fOkHmVFFfXr3MsouLsnNvV5kRoe5+s431PeuoKPqWnaurY/ZPBEeqwceN4l96iwO6H7Mjq4y7VGPVNe10VaZMzVCPVWpI/Z6FZbcv5fMqGCU+dLfFGzj58jP8+bCdJCo7yzKTwdOF0bu9Ug7V4c+yz7FJfYeGoysUss0HssIdVZwYLDujMqlESoCdTtGsZtbHnJBeNdDSJSs0jTKdMJN1HNX54Wv7bvsU9NkVJVa13dX+/wuArV0X/l5RHyo/lnfF4G6p6DrS0kHdtXhy35TGErDPYZUn2WfWqDOo/lVqdMD2O/hKJhD7S/odukymq9s02QN4EEPR/zbaOumZc+r15zK1Zqznl9jsfiemTM1QmV3HUuTkedlg9HIQzRbUD93dfC+2tpj2fIHEH2+RqCCQH13gZq7hWXTNpVu19OB1fc9nQ0AKOKUb5lU0P1kDyOneoWk0lOZ9cIP0x7qu8+2BhCoR2wYu1+e7DmaXzBSsu5vaX1ne2zrpmUPTmxf7PM1Dm4y/vC7ny7Nif7+z/9ZmtM0Z3panPLtPmra9f16bcK0Dpbnwk43Vd/RHtu6zfNQTy1QBy3aqG2g9nVmxml+BOoJyT3NpWmn9xhfFnu4bvDa+44BXhqqfdf3uUF9+yz77AT31Yue2mjecYQ62NLfgkA9ghHqLNEhNem4H1c6vdyDxhf/bpz5m4coW/c39wi6VH2bPtHlcaV9cvXts+zxCe6rTeqc2ndL7uGd93QwM9bFcAzMoZZ7SgTBbWx+asui61h/iq1+RmjqdbnQXQ3T1DNQ63V/U9ucqm/pMzPb1rePsk/1iTOjgvatR4W3Lc8ULB78pELyrnAfeTcj1NU509/86mfJ33/8+Mf00a05UyPUEw7UVCeWG/WNEiExyHRMt5ltW30izUPk18ytt7lNfc8i//DvtvXto+ySA5BjljsLUF8lPkqMPEtW1JomDsiGBZ9Byb4NAvUITSN9GuwsIj6t6UTOqk7jJREkmzqli8xIs96udSO20sX0H1vW92IL9e1a9rgqVyf91gbPsTy9UD9n9lOkT8k+RfkFR5PMNqxOcdSf32PBvg3vilO+zdxE+okx9Wm0ph36XYsRZCpMF993GOk5qvqB3Dct6jvssb67KvuUNJ3frw92bhr8/STSF0JdRPMLpUCgnsgo9S76PZ246ZFk1wWvK5m3vVoYvW1Sz7nN91jfXbQ1ZQc7TW6HeaoOalypG/8/p/rP1aNAc6ZHzSnfdqPUPhdy2PQw6Nz9gSVhuhiqueUHR3uu7y7K3rdDX4u46ZrPbUa0IFBZ0seKQ3XQTRt2vm3W/a2DbNKys++rvm3ep6+y1x2UdP3bWU9lzra47U1GmlctX/sQ23t+aOlByLTh/4NAPaCRxtcdO5HLSJ/6vNtCwGx67VPmPbvWd1q9frKHtp4kAqRJ2HR9j762JfX3bZ//elPtj13PPDx1+D5tqk/Xi6NO8SHz7MmH19dXrdBNfVFP6T2PT1UHNit87/t4m5+aRH+nQBdvqyhZDKJLfZs8h7XPsqdV2ZOV+tanKB8aln0dyxdAXbV4j4gvt4oMOrbP6vbU73NW7TMlbdTnPrWpfqXfh9HKZ9vke7KuTeZRNtXRSe6+1FV//ce/ln5eXfsXgcqXzr6+9261M3moOoa7E6nvTZTfy7iNsmfb7kjfgXGsvxe0vihsEts9HTquPpt1q1vtahu2TqAiUAEEKj0zhwoARqgAu/OnX/442WH+9xc/Wvr58re/Tr7f41/+ZsRqhAoACFQAEKgAcHjMoQJskJsz/eqrr5Z+vvr7v5fmQFevAl5lztQIFQAQqAAgUAHgIJlDBdhgdQ41N2eKESoAIFABQKACwFEwhwoARqgAIFABQKACAAIVAAQqAAhUABCoAIBABQCBCgACFQAEKgAgUAFAoAKAQAUAgQoACFQAEKgAIFABQKACAAIVAAQqAAhUABCoAIBABQCBCgACFQAQqAAgUAFAoAKAQAUAlvwPcFDns1DsH4sAAAAASUVORK5CYII=",i.logoWidth=468,i.logoHeight=118,i.loadingBarColor=ut.White,i.backgroundColor="#176BAA",i.suppressPlayButton=!1,i._playButtonStyles=ae.Z.toString(),i.playButtonText="Play game",i.startButtonFactory=function(){var t=document.getElementById("excalibur-play");return t||(t=document.createElement("button")),t.id="excalibur-play",t.textContent=i.playButtonText,t.style.display="none",t},t&&i.addResources(t),i}return p(n,[{key:"_image",get:function(){return this._imageElement||(this._imageElement=new Image,this._imageElement.src=this.logo),this._imageElement}},{key:"playButtonRootElement",get:function(){return this._playButtonRootElement}},{key:"playButtonElement",get:function(){return this._playButtonElement}},{key:"_playButton",get:function(){var t=document.getElementById("excalibur-play-root");return t&&(this._playButtonRootElement=t),this._playButtonRootElement||(this._playButtonRootElement=document.createElement("div"),this._playButtonRootElement.id="excalibur-play-root",this._playButtonRootElement.style.position="absolute",document.body.appendChild(this._playButtonRootElement)),this._styleBlock||(this._styleBlock=document.createElement("style"),this._styleBlock.textContent=this._playButtonStyles,document.head.appendChild(this._styleBlock)),this._playButtonElement||(this._playButtonElement=this.startButtonFactory(),this._playButtonRootElement.appendChild(this._playButtonElement)),this._playButtonElement}},{key:"wireEngine",value:function(t){this._engine=t,this.canvas.width=this._engine.canvas.width,this.canvas.height=this._engine.canvas.height}},{key:"addResource",value:function(t){var e=this._index++;this._resourceList.push(t),this._progressCounts[e]=0,this._totalCounts[e]=1,this._resourceCount++}},{key:"addResources",value:function(t){for(var e=0,n=t.length;e<n;e++)this.addResource(t[e])}},{key:"isLoaded",value:function(){return this._numLoaded===this._resourceCount}},{key:"showPlayButton",value:function(){var t=this;return this.suppressPlayButton?Promise.resolve():(this._playButtonShown=!0,this._playButton.style.display="block",document.body.addEventListener("keyup",(function(e){"Enter"===e.key&&t._playButton.click()})),new Promise((function(e){var n=function(t){t.stopPropagation(),e()};t._playButton.addEventListener("click",n),t._playButton.addEventListener("touchend",n),t._playButton.addEventListener("pointerup",n)})))}},{key:"hidePlayButton",value:function(){this._playButtonShown=!1,this._playButton.style.display="none"}},{key:"dispose",value:function(){this._playButtonRootElement.parentElement&&(this._playButtonRootElement.removeChild(this._playButtonElement),document.body.removeChild(this._playButtonRootElement),document.head.removeChild(this._styleBlock),this._playButtonRootElement=null,this._playButtonElement=null,this._styleBlock=null)}},{key:"update",value:function(t,e){}},{key:"load",value:function(){return ve(this,void 0,void 0,u.mark((function t(){var e=this;return u.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all(this._resourceList.map((function(t){return t.load().finally((function(){e._numLoaded++}))})));case 2:return t.next=4,Z(200);case 4:return t.next=6,this.showPlayButton();case 6:return t.next=8,vt.unlock();case 8:return this.hidePlayButton(),t.abrupt("return",this.data=this._resourceList);case 10:case"end":return t.stop()}}),t,this)})))}},{key:"markResourceComplete",value:function(){this._numLoaded++}},{key:"progress",get:function(){return this._resourceCount>0?F(this._numLoaded,0,this._resourceCount)/this._resourceCount:1}},{key:"draw",value:function(t){var e=this._engine.canvasHeight/this._engine.pixelRatio,n=this._engine.canvasWidth/this._engine.pixelRatio;if(this._playButtonRootElement){var i=this._engine.canvas.offsetLeft,r=this._engine.canvas.offsetTop,o=this._playButton.clientWidth,a=this._playButton.clientHeight;this.playButtonPosition?(this._playButtonRootElement.style.left=this.playButtonPosition.x+"px",this._playButtonRootElement.style.top=this.playButtonPosition.y+"px"):(this._playButtonRootElement.style.left=i+n/2-o/2+"px",this._playButtonRootElement.style.top=r+e/2-a/2+100+"px")}t.fillStyle=this.backgroundColor,t.fillRect(0,0,n,e);var s=e/2,l=Math.min(this.logoWidth,.75*n),u=n/2-l/2;this.logoPosition&&(u=this.logoPosition.x,s=this.logoPosition.y);var c=Math.floor(l*(this.logoHeight/this.logoWidth)),h=this._engine.getAntialiasing();if(this._engine.setAntialiasing(!0),this.logoPosition?t.drawImage(this._image,0,0,this.logoWidth,this.logoHeight,u,s,l,c):t.drawImage(this._image,0,0,this.logoWidth,this.logoHeight,u,s-c-20,l,c),this.suppressPlayButton||!this._playButtonShown){var d=u,f=s;this.loadingBarPosition&&(d=this.loadingBarPosition.x,f=this.loadingBarPosition.y),t.lineWidth=2,re(t,d,f,l,20,10,this.loadingBarColor);var p=l*this.progress-10;re(t,d+5,f+5,p>10?p:10,10,5,null,this.loadingBarColor),this._engine.setAntialiasing(h)}else this._engine.setAntialiasing(h)}}]),n}(te),ye={webgl:"WebGL",webaudio:"WebAudio",gamepadapi:"Gamepad API"},me=function(){function t(){f(this,t),this._features=null,this.failedTests=[],this._criticalTests={canvasSupport:function(){var t=document.createElement("canvas");return!(!t.getContext||!t.getContext("2d"))},arrayBufferSupport:function(){var t=new XMLHttpRequest;t.open("GET","/");try{t.responseType="arraybuffer"}catch(t){return!1}return"arraybuffer"===t.responseType},dataUrlSupport:function(){return 0===document.createElement("canvas").toDataURL("image/png").indexOf("data:image/png")},objectUrlSupport:function(){return"URL"in window&&"revokeObjectURL"in URL&&"createObjectURL"in URL},rgbaSupport:function(){var t=document.createElement("a").style;return t.cssText="background-color:rgba(150,255,150,.5)",(""+t.backgroundColor).indexOf("rgba")>-1}},this._warningTest={webAudioSupport:function(){return!!(window.AudioContext||window.webkitAudioContext||window.mozAudioContext||window.msAudioContext||window.oAudioContext)},webglSupport:function(){var t=document.createElement("canvas");return!(!t.getContext||!t.getContext("webgl"))}},this._features=this._loadBrowserFeatures()}return p(t,[{key:"getBrowserFeatures",value:function(){return null===this._features&&(this._features=this._loadBrowserFeatures()),this._features}},{key:"logBrowserFeatures",value:function(){for(var t="%cSUPPORTED BROWSER FEATURES\n==========================%c\n",e=["font-weight: bold; color: navy","font-weight: normal; color: inherit"],n=this.getBrowserFeatures(),i=0,r=Object.keys(ye);i<r.length;i++){var o=r[i];n[o]?(t+="(%c\u2713%c)",e.push("font-weight: bold; color: green"),e.push("font-weight: normal; color: inherit")):(t+="(%c\u2717%c)",e.push("font-weight: bold; color: red"),e.push("font-weight: normal; color: inherit")),t+=" "+ye[o]+"\n"}e.unshift(t),console.log.apply(console,e)}},{key:"_loadBrowserFeatures",value:function(){var t=this;return{canvas:t._criticalTests.canvasSupport(),arraybuffer:t._criticalTests.arrayBufferSupport(),dataurl:t._criticalTests.dataUrlSupport(),objecturl:t._criticalTests.objectUrlSupport(),rgba:t._criticalTests.rgbaSupport(),webaudio:t._warningTest.webAudioSupport(),webgl:t._warningTest.webglSupport(),gamepadapi:!!navigator.getGamepads}}},{key:"test",value:function(){var t=!1;for(var e in this._criticalTests)this._criticalTests[e].call(this)||(this.failedTests.push(e),P.getInstance().error("Critical browser feature missing, Excalibur requires:",e),t=!0);if(t)return!1;for(var n in this._warningTest)this._warningTest[n]()||P.getInstance().warn("Warning browser feature missing, Excalibur will have reduced performance:",n);return!0}}]),t}(),_e=function(){function t(e,n){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];f(this,t),this.path=e,this.responseType=n,this.bustCache=i,this.data=null,this.logger=P.getInstance(),this.events=new Jt(this)}return p(t,[{key:"isLoaded",value:function(){return null!==this.data}},{key:"_cacheBust",value:function(t){return/\?\w*=\w*/.test(t)?t+="&__="+Date.now():t+="?__="+Date.now(),t}},{key:"load",value:function(){var t=this;return new Promise((function(e,n){if(null!==t.data)return t.logger.debug("Already have data for resource",t.path),t.events.emit("complete",t.data),void e(t.data);var i=new XMLHttpRequest;i.open("GET",t.bustCache?t._cacheBust(t.path):t.path,!0),i.responseType=t.responseType,i.addEventListener("loadstart",(function(e){return t.events.emit("loadstart",e)})),i.addEventListener("progress",(function(e){return t.events.emit("progress",e)})),i.addEventListener("error",(function(e){return t.events.emit("error",e)})),i.addEventListener("load",(function(e){return t.events.emit("load",e)})),i.addEventListener("load",(function(){if(0!==i.status&&200!==i.status)return t.logger.error("Failed to load resource ",t.path," server responded with error code",i.status),t.events.emit("error",i.response),void n(i.response);t.data=i.response,t.events.emit("complete",t.data),t.logger.debug("Completed loading resource",t.path),e(t.data)})),i.send()}))}}]),t}(),we=function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},be=function(){function t(){f(this,t)}return p(t,[{key:"updatePixel",value:function(t,e,n){var i=4*(t+e*n.width),r=n.data,o=(r[i+0]+r[i+1]+r[i+2])/3;r[i+0]=o,r[i+1]=o,r[i+2]=o}}]),t}();be=we([nt({message:"Grayscale will be removed in v0.26.0"})],be);var ke=function(){function t(){f(this,t)}return p(t,[{key:"updatePixel",value:function(t,e,n){var i=4*(t+e*n.width),r=n.data;r[i+0]=255-r[i+0],r[i+1]=255-r[i+1],r[i+2]=255-r[i+2]}}]),t}();ke=we([nt({message:"Invert will be removed in v0.26.0"})],ke);var xe=function(){function t(e){f(this,t),this.opacity=e}return p(t,[{key:"updatePixel",value:function(t,e,n){var i=4*(t+e*n.width),r=n.data;0!==r[i+3]&&(r[i+3]=Math.round(this.opacity*r[i+3]))}}]),t}();xe=we([nt({message:"Opacity will be removed in v0.26.0"})],xe);var Ce=function(){function t(e){f(this,t),this.color=e}return p(t,[{key:"updatePixel",value:function(t,e,n){var i=4*(t+e*n.width),r=n.data;0!==r[i+3]&&(r[i+0]=(r[i+0]+this.color.r)/2,r[i+1]=(r[i+1]+this.color.g)/2,r[i+2]=(r[i+2]+this.color.b)/2)}}]),t}();Ce=we([nt({message:"Colorize will be removed in v0.26.0"})],Ce);var Se=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1;f(this,t),this.factor=e}return p(t,[{key:"updatePixel",value:function(t,e,n){var i=4*(t+e*n.width),r=n.data,o=ut.fromRGB(r[i+0],r[i+1],r[i+2],r[i+3]).lighten(this.factor);r[i+0]=o.r,r[i+1]=o.g,r[i+2]=o.b,r[i+3]=o.a}}]),t}();Se=we([nt({message:"Lighten will be removed in v0.26.0"})],Se);var Ee=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1;f(this,t),this.factor=e}return p(t,[{key:"updatePixel",value:function(t,e,n){var i=4*(t+e*n.width),r=n.data,o=ut.fromRGB(r[i+0],r[i+1],r[i+2],r[i+3]).darken(this.factor);r[i+0]=o.r,r[i+1]=o.g,r[i+2]=o.b,r[i+3]=o.a}}]),t}();Ee=we([nt({message:"Darken will be removed v0.26.0"})],Ee);var Pe=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1;f(this,t),this.factor=e}return p(t,[{key:"updatePixel",value:function(t,e,n){var i=4*(t+e*n.width),r=n.data,o=ut.fromRGB(r[i+0],r[i+1],r[i+2],r[i+3]).saturate(this.factor);r[i+0]=o.r,r[i+1]=o.g,r[i+2]=o.b,r[i+3]=o.a}}]),t}();Pe=we([nt({message:"Saturate will be removed in v0.26.0"})],Pe);var Ae=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1;f(this,t),this.factor=e}return p(t,[{key:"updatePixel",value:function(t,e,n){var i=4*(t+e*n.width),r=n.data,o=ut.fromRGB(r[i+0],r[i+1],r[i+2],r[i+3]).desaturate(this.factor);r[i+0]=o.r,r[i+1]=o.g,r[i+2]=o.b,r[i+3]=o.a}}]),t}();Ae=we([nt({message:"Desaturate will be removed in v0.26.0"})],Ae);var Te=function(){function t(e){f(this,t),this.color=e}return p(t,[{key:"updatePixel",value:function(t,e,n){var i=4*(t+e*n.width),r=n.data;0!==r[i+3]&&(r[i+0]=this.color.r,r[i+1]=this.color.g,r[i+2]=this.color.b)}}]),t}();function Re(t){return function(t){h(n,t);var e=d(n);function n(){var t;f(this,n);for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return t=e.call.apply(e,[this].concat(r)),1!==r.filter((function(t){return void 0!==t})).length||!r[0]||"object"!=typeof r[0]||r[0]instanceof Array||t.assign(r[0]),t}return p(n,[{key:"assign",value:function(t){for(var e in t)"function"!=typeof this[e]&&(this[e]=t[e])}}]),n}(t)}Te=we([nt({message:"Fill will be removed in v0.26.0"})],Te);var De=function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},Me=function(t,e,n,i){return new(n||(n=Promise))((function(r,o){function a(t){try{l(i.next(t))}catch(t){o(t)}}function s(t){try{l(i.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}l((i=i.apply(t,e||[])).next())}))},Le=function(t){h(n,t);var e=d(n);function n(t,i,r,o,a){return f(this,n),e.call(this,t,i,r,o,a)}return n}(Re(function(){function t(e,n,i,r,o){f(this,t),this.x=0,this.y=0,this.rotation=0,this.anchor=rt.Half,this.offset=rt.Zero,this.scale=rt.One,this.drawAroundAnchor=!1,this.logger=P.getInstance(),this.flipVertical=!1,this.flipHorizontal=!1,this.effects=[],this.width=0,this.height=0,this._spriteCanvas=null,this._spriteCtx=null,this._pixelData=null,this._pixelsLoaded=!1,this._dirtyEffect=!0,this._opacity=1;var a=e;if(e&&!(e instanceof Oe)&&(n=0|e.x,i=0|e.y,r=0|e.width,o=0|e.height,!(a=e.image)))throw new Error("An image texture is required to construct a sprite");this.x=n||0,this.y=i||0,this.texture=a,this._spriteCanvas=document.createElement("canvas"),this._spriteCanvas.width=r,this._spriteCanvas.height=o,this._spriteCtx=this._spriteCanvas.getContext("2d"),this._initPixelsFromTexture(),this.width=r,this.height=o}return p(t,[{key:"drawWidth",get:function(){return Math.abs(this.width*this.scale.x)}},{key:"drawHeight",get:function(){return Math.abs(this.height*this.scale.y)}},{key:"_initPixelsFromTexture",value:function(){return Me(this,void 0,void 0,u.mark((function t(){var e;return u.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.texture.loaded;case 3:e=t.sent,this.width=this.width||e.naturalWidth,this.height=this.height||e.naturalHeight,this._spriteCanvas.width=this._spriteCanvas.width||e.naturalWidth,this._spriteCanvas.height=this._spriteCanvas.height||e.naturalHeight,this._loadPixels(),this._dirtyEffect=!0,t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),this.logger.error("Error loading texture ",this.texture.path,t.t0);case 10:case"end":return t.stop()}}),t,this,[[0,7]])})))}},{key:"_loadPixels",value:function(){if(this.texture.isLoaded()&&!this._pixelsLoaded){var t=this.texture.image.naturalWidth||0,e=this.texture.image.naturalHeight||0;if(this.width>t&&this.logger.warn("The sprite width ".concat(this.width," exceeds the width \n                              ").concat(t," of the backing texture ").concat(this.texture.path)),this.width<=0||t<=0)throw new Error("The width of a sprite cannot be 0 or negative, sprite width: ".concat(this.width,", original width: ").concat(t));if(this.height>e&&this.logger.warn("The sprite height ".concat(this.height," exceeds the height \n                              ").concat(e," of the backing texture ").concat(this.texture.path)),this.height<=0||e<=0)throw new Error("The height of a sprite cannot be 0 or negative, sprite height: ".concat(this.height,", original height: ").concat(e));this._flushTexture(),this._pixelsLoaded=!0}}},{key:"_flushTexture",value:function(){var t=this.texture.image.naturalWidth||0,e=this.texture.image.naturalHeight||0;this._spriteCtx.clearRect(0,0,this.width,this.height),this._spriteCtx.drawImage(this.texture.image,F(this.x,0,t),F(this.y,0,e),F(this.width,0,t),F(this.height,0,e),0,0,this.width,this.height)}},{key:"opacity",value:function(t){this._opacity=t}},{key:"grayscale",value:function(){this.addEffect(new be)}},{key:"invert",value:function(){this.addEffect(new ke)}},{key:"fill",value:function(t){this.addEffect(new Te(t))}},{key:"colorize",value:function(t){this.addEffect(new Ce(t))}},{key:"lighten",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1;this.addEffect(new Se(t))}},{key:"darken",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1;this.addEffect(new Ee(t))}},{key:"saturate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1;this.addEffect(new Pe(t))}},{key:"desaturate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1;this.addEffect(new Ae(t))}},{key:"addEffect",value:function(t){this.effects.push(t),this.texture.isLoaded()&&this._pixelsLoaded?this._applyEffects():this._dirtyEffect=!0}},{key:"removeEffect",value:function(t){var e=-1;(e="number"==typeof t?t:this.effects.indexOf(t))<0||e>=this.effects.length||(this.effects.splice(e,1),this.texture.isLoaded()&&this._pixelsLoaded?this._applyEffects():this._dirtyEffect=!0)}},{key:"_applyEffects",value:function(){if(this._flushTexture(),this.effects.length>0){this._pixelData=this._spriteCtx.getImageData(0,0,this.width,this.height);for(var t=this.effects.length,e=0;e<t;e++)for(var n=0;n<this.height;n++)for(var i=0;i<this.width;i++)this.effects[e].updatePixel(i,n,this._pixelData);this._spriteCtx.clearRect(0,0,this.width,this.height),this._spriteCtx.putImageData(this._pixelData,0,0)}this._dirtyEffect=!1}},{key:"clearEffects",value:function(){this.effects.length=0,this._applyEffects()}},{key:"reset",value:function(){}},{key:"debugDraw",value:function(t,e,n){t.save(),t.translate(e,n),t.rotate(this.rotation);var i=this.drawWidth*this.anchor.x,r=this.drawHeight*this.anchor.y;t.strokeStyle=ut.Black.toString(),t.strokeRect(-i,-r,this.drawWidth,this.drawHeight),t.restore()}},{key:"draw",value:function(t,e,n){t instanceof CanvasRenderingContext2D?this._drawWithOptions({ctx:t,x:e,y:n}):this._drawWithOptions(t)}},{key:"_drawWithOptions",value:function(t){var e,n,i,r,o,a,s,l,u,c=Object.assign(Object.assign({},t),{rotation:null!==(e=t.rotation)&&void 0!==e?e:this.rotation,drawWidth:null!==(n=t.drawWidth)&&void 0!==n?n:this.width,drawHeight:null!==(i=t.drawHeight)&&void 0!==i?i:this.height,flipHorizontal:null!==(r=t.flipHorizontal)&&void 0!==r?r:this.flipHorizontal,flipVertical:null!==(o=t.flipVertical)&&void 0!==o?o:this.flipVertical,anchor:null!==(a=t.anchor)&&void 0!==a?a:this.anchor,offset:null!==(s=t.offset)&&void 0!==s?s:this.offset,opacity:(null!==(l=t.opacity)&&void 0!==l?l:1)*(null!==(u=this._opacity)&&void 0!==u?u:1)}),h=c.ctx,d=c.x,f=c.y,p=c.rotation,v=c.drawWidth,g=c.drawHeight,y=c.anchor,m=c.offset,_=c.opacity,w=c.flipHorizontal,b=c.flipVertical;this._dirtyEffect&&this._applyEffects();var k=v*y.x+m.x,x=g*y.y+m.y,C=this.scale.x>0?1:-1,S=this.scale.y>0?1:-1;h.save(),h.translate(d,f),h.scale(Math.abs(this.scale.x),Math.abs(this.scale.y)),this.drawAroundAnchor&&h.translate(-k,-x),h.translate(k,x),h.rotate(p),h.scale(C,S),h.translate(-k,-x),w&&(h.translate(v,0),h.scale(-1,1)),b&&(h.translate(0,g),h.scale(1,-1));var E=h.globalAlpha;h.globalAlpha=_,h.drawImage(this._spriteCanvas,0,0,this.width,this.height,0,0,this.width,this.height),h.globalAlpha=E,h.restore()}},{key:"clone",value:function(){var t=new Le(this.texture,this.x,this.y,this.width,this.height);t.anchor=this.anchor.clone(),t.scale=this.scale.clone(),t.rotation=this.rotation,t.flipHorizontal=this.flipHorizontal,t.flipVertical=this.flipVertical;for(var e=this.effects.length,n=0;n<e;n++)t.addEffect(this.effects[n]);return t}}]),t}()));Le=De([nt({message:"Label.clearTextShadow will be removed in v0.26.0",alternateMethod:"Use Label.font.shadow"})],Le);var Be=function(t,e,n,i){return new(n||(n=Promise))((function(r,o){function a(t){try{l(i.next(t))}catch(t){o(t)}}function s(t){try{l(i.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}l((i=i.apply(t,e||[])).next())}))},Oe=function(){function t(e){var n=this,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];f(this,t),this.path=e,this.bustCache=i,this._sprite=null,this.loaded=new Promise((function(t){n._loadedResolve=t})),this._resource=new _e(e,"blob",i),this._sprite=new Le(this,0,0,0,0)}return p(t,[{key:"image",get:function(){return this.data}},{key:"isLoaded",value:function(){return!!this.data}},{key:"load",value:function(){return Be(this,void 0,void 0,u.mark((function t(){var e,n,i;return u.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!this.path.includes("data:image/")){t.next=5;break}e=this.path,t.next=9;break;case 5:return t.next=7,this._resource.load();case 7:n=t.sent,e=URL.createObjectURL(n);case 9:return(i=new Image).src=e,t.next=13,i.decode();case 13:this.data=i,this.width=this._sprite.width=i.naturalWidth,this.height=this._sprite.height=i.naturalHeight,this._sprite=new Le(this,0,0,this.width,this.height),t.next=23;break;case 19:return t.prev=19,t.t0=t.catch(0),t.next=23,Promise.reject("Error loading texture");case 23:return t.abrupt("return",(this._loadedResolve(this.data),this.data));case 24:case"end":return t.stop()}}),t,this,[[0,19]])})))}},{key:"asSprite",value:function(){return this._sprite}}]),t}(),Fe=function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},Ie=function(t){h(n,t);var e=d(n);function n(t,i,r,o){return f(this,n),e.call(this,t,i,r,o)}return n}(Re(function(){function t(e,n,i,r){f(this,t),this.sprites=[],this.currentFrame=0,this._timeLeftInFrame=0,this._idempotencyToken=-1,this.anchor=rt.Zero,this.rotation=0,this.scale=rt.One,this.loop=!0,this.freezeFrame=-1,this.flipVertical=!1,this.flipHorizontal=!1,this.drawWidth=0,this.drawHeight=0,this.width=0,this.height=0,this._opacity=1;var o=e;if(e&&!(e instanceof mo)){var a=e;o=a.engine,n=a.sprites,i=a.speed,r=a.loop}this.sprites=n,this.speed=i,this._engine=o,this._timeLeftInFrame=this.speed,null!=r&&(this.loop=r),n&&n[0]&&(this.drawHeight=n[0]?n[0].drawHeight:0,this.drawWidth=n[0]?n[0].drawWidth:0,this.width=n[0]?n[0].width:0,this.height=n[0]?n[0].height:0,this.freezeFrame=n.length-1)}return p(t,[{key:"opacity",value:function(t){this._opacity=t}},{key:"grayscale",value:function(){this.addEffect(new be)}},{key:"invert",value:function(){this.addEffect(new ke)}},{key:"fill",value:function(t){this.addEffect(new Te(t))}},{key:"colorize",value:function(t){this.addEffect(new Ce(t))}},{key:"lighten",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1;this.addEffect(new Se(t))}},{key:"darken",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1;this.addEffect(new Ee(t))}},{key:"saturate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1;this.addEffect(new Pe(t))}},{key:"desaturate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1;this.addEffect(new Ae(t))}},{key:"addEffect",value:function(t){for(var e in this.sprites)this.sprites[e].addEffect(t)}},{key:"removeEffect",value:function(t){for(var e in this.sprites)this.sprites[e].removeEffect(t)}},{key:"clearEffects",value:function(){for(var t in this.sprites)this.sprites[t].clearEffects()}},{key:"_setAnchor",value:function(t){for(var e in this.sprites)this.sprites[e].anchor.setTo(t.x,t.y)}},{key:"_setRotation",value:function(t){for(var e in this.sprites)this.sprites[e].rotation=t}},{key:"_setScale",value:function(t){for(var e in this.sprites)this.sprites[e].scale=t}},{key:"reset",value:function(){this.currentFrame=0}},{key:"isDone",value:function(){return!this.loop&&this.currentFrame>=this.sprites.length}},{key:"tick",value:function(t,e){if(this._idempotencyToken!==e){this._idempotencyToken=e,this._timeLeftInFrame-=t,this._timeLeftInFrame<=0&&(this.currentFrame=this.loop?(this.currentFrame+1)%this.sprites.length:this.currentFrame+1,this._timeLeftInFrame=this.speed),this._updateValues();var n=this.sprites[this.currentFrame];n&&(this.width=n.width,this.height=n.height,this.drawWidth=n.drawWidth,this.drawHeight=n.drawHeight)}}},{key:"_updateValues",value:function(){this._setAnchor(this.anchor),this._setRotation(this.rotation),this._setScale(this.scale)}},{key:"skip",value:function(t){this.currentFrame=(this.currentFrame+t)%this.sprites.length}},{key:"draw",value:function(t,e,n){t instanceof CanvasRenderingContext2D?this._drawWithOptions({ctx:t,x:e,y:n}):this._drawWithOptions(t)}},{key:"_drawWithOptions",value:function(t){var e,n,i,r,o,a,s,l,u,c=Object.assign(Object.assign({},t),{rotation:null!==(e=t.rotation)&&void 0!==e?e:this.rotation,drawWidth:null!==(n=t.drawWidth)&&void 0!==n?n:this.drawWidth,drawHeight:null!==(i=t.drawHeight)&&void 0!==i?i:this.drawHeight,flipHorizontal:null!==(r=t.flipHorizontal)&&void 0!==r?r:this.flipHorizontal,flipVertical:null!==(o=t.flipVertical)&&void 0!==o?o:this.flipVertical,anchor:null!==(a=t.anchor)&&void 0!==a?a:this.anchor,opacity:(null!==(s=t.opacity)&&void 0!==s?s:1)*(null!==(l=this._opacity)&&void 0!==l?l:1)});this._updateValues(),this.currentFrame<this.sprites.length&&(u=this.sprites[this.currentFrame]).draw(c),-1!==this.freezeFrame&&this.currentFrame>=this.sprites.length&&(u=this.sprites[F(this.freezeFrame,0,this.sprites.length-1)]).draw(c),u&&(this.drawWidth=u.drawWidth,this.drawHeight=u.drawHeight)}},{key:"play",value:function(t,e){this.reset(),this._engine.playAnimation(this,t,e)}}]),t}()));Ie=Fe([nt({message:"Animation will be removed in v0.26.0",alternateMethod:"Use Graphics.Animation"})],Ie);var ze,Ne,Ue=function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},He=function(){function t(){f(this,t)}return p(t,null,[{key:"CreateReversibleEasingFunction",value:function(t){return function(e,n,i,r){return i<n?n-(t(e,i,n,r)-i):t(e,n,i,r)}}},{key:"CreateReversableEasingFunction",value:function(e){return t.CreateReversibleEasingFunction(e)}},{key:"CreateVectorEasingFunction",value:function(t){return function(e,n,i,r){return new rt(t(e,n.x,i.x,r),t(e,n.y,i.y,r))}}}]),t}();He.Linear=He.CreateReversibleEasingFunction((function(t,e,n,i){return(n-=e)*t/i+e})),He.EaseInQuad=He.CreateReversibleEasingFunction((function(t,e,n,i){return(n-=e)*(t/=i)*t+e})),He.EaseOutQuad=He.CreateReversibleEasingFunction((function(t,e,n,i){return-(n-=e)*(t/=i)*(t-2)+e})),He.EaseInOutQuad=He.CreateReversibleEasingFunction((function(t,e,n,i){return n-=e,(t/=i/2)<1?n/2*t*t+e:-n/2*(--t*(t-2)-1)+e})),He.EaseInCubic=He.CreateReversibleEasingFunction((function(t,e,n,i){return(n-=e)*(t/=i)*t*t+e})),He.EaseOutCubic=He.CreateReversibleEasingFunction((function(t,e,n,i){return t/=i,(n-=e)*(--t*t*t+1)+e})),He.EaseInOutCubic=He.CreateReversibleEasingFunction((function(t,e,n,i){return n-=e,(t/=i/2)<1?n/2*t*t*t+e:n/2*((t-=2)*t*t+2)+e})),Ue([nt({message:"Alias for incorrect spelling used in older versions, will be removed in v0.25.0",alternateMethod:"CreateReversibleEasingFunction"})],He,"CreateReversableEasingFunction",null);var We=function(){function t(e){f(this,t),this._actions=[],this._completedActions=[],this._actor=e}return p(t,[{key:"add",value:function(t){this._actions.push(t)}},{key:"remove",value:function(t){var e=this._actions.indexOf(t);this._actions.splice(e,1)}},{key:"clearActions",value:function(){this._actions.length=0,this._completedActions.length=0,this._currentAction&&this._currentAction.stop()}},{key:"getActions",value:function(){return this._actions.concat(this._completedActions)}},{key:"hasNext",value:function(){return this._actions.length>0}},{key:"isComplete",value:function(){return 0===this._actions.length}},{key:"reset",value:function(){this._actions=this.getActions();for(var t=this._actions.length,e=0;e<t;e++)this._actions[e].reset();this._completedActions=[]}},{key:"update",value:function(t){this._actions.length>0&&(this._currentAction=this._actions[0],this._currentAction.update(t),this._currentAction.isComplete(this._actor)&&this._completedActions.push(this._actions.shift()))}}]),t}(),je=function(){function t(e,n,i){f(this,t),this._stopped=!1,this._repeatBuilder=n,this._repeatContext=new vn(e),this._actionQueue=this._repeatContext.getQueue(),this._repeat=i,this._originalRepeat=i,this._repeatBuilder(this._repeatContext),this._repeat--}return p(t,[{key:"update",value:function(t){this._actionQueue.isComplete()&&(this._actionQueue.clearActions(),this._repeatBuilder(this._repeatContext),this._repeat--),this._actionQueue.update(t)}},{key:"isComplete",value:function(){return this._stopped||this._repeat<=0&&this._actionQueue.isComplete()}},{key:"stop",value:function(){this._stopped=!0}},{key:"reset",value:function(){this._repeat=this._originalRepeat}}]),t}(),Ve=function(){function t(e,n){f(this,t),this._stopped=!1,this._repeatBuilder=n,this._repeatContext=new vn(e),this._actionQueue=this._repeatContext.getQueue(),this._repeatBuilder(this._repeatContext)}return p(t,[{key:"update",value:function(t){this._stopped||(this._actionQueue.isComplete()&&(this._actionQueue.clearActions(),this._repeatBuilder(this._repeatContext)),this._actionQueue.update(t))}},{key:"isComplete",value:function(){return this._stopped}},{key:"stop",value:function(){this._stopped=!0,this._actionQueue.clearActions()}},{key:"reset",value:function(){}}]),t}(),Ge=function(){function t(e,n,i,r){if(f(this,t),this._started=!1,this._stopped=!1,this._actor=e,this._speed=r,this._offset=new rt(n,i),r<=0)throw P.getInstance().error("Attempted to moveBy with speed less than or equal to zero : "+r),new Error("Speed must be greater than 0 pixels per second")}return p(t,[{key:"update",value:function(t){this._started||(this._started=!0,this._start=new rt(this._actor.pos.x,this._actor.pos.y),this._end=this._start.add(this._offset),this._distance=this._offset.size,this._dir=this._end.sub(this._start).normalize()),this.isComplete(this._actor)?(this._actor.pos=ot(this._end.x,this._end.y),this._actor.vel=ot(0,0)):this._actor.vel=this._dir.scale(this._speed)}},{key:"isComplete",value:function(t){return this._stopped||t.pos.distance(this._start)>=this._distance}},{key:"stop",value:function(){this._actor.vel=ot(0,0),this._stopped=!0}},{key:"reset",value:function(){this._started=!1}}]),t}(),Xe=function(){function t(e,n,i,r){f(this,t),this._started=!1,this._stopped=!1,this._actor=e,this._end=new rt(n,i),this._speed=r}return p(t,[{key:"update",value:function(t){this._started||(this._started=!0,this._start=new rt(this._actor.pos.x,this._actor.pos.y),this._distance=this._start.distance(this._end),this._dir=this._end.sub(this._start).normalize());var e=this._dir.scale(this._speed);this._actor.vel=ot(e.x,e.y),this.isComplete(this._actor)&&(this._actor.pos=ot(this._end.x,this._end.y),this._actor.vel=ot(0,0))}},{key:"isComplete",value:function(t){return this._stopped||new rt(t.pos.x,t.pos.y).distance(this._start)>=this._distance}},{key:"stop",value:function(){this._actor.vel=ot(0,0),this._stopped=!0}},{key:"reset",value:function(){this._started=!1}}]),t}();!function(t){t[t.ShortestPath=0]="ShortestPath",t[t.LongestPath=1]="LongestPath",t[t.Clockwise=2]="Clockwise",t[t.CounterClockwise=3]="CounterClockwise"}(ze||(ze={}));var qe=function(){function t(e,n,i,r){f(this,t),this._started=!1,this._stopped=!1,this._actor=e,this._end=n,this._speed=i,this._rotationType=r||ze.ShortestPath}return p(t,[{key:"update",value:function(t){if(!this._started){this._started=!0,this._start=this._actor.rotation,this._currentNonCannonAngle=this._actor.rotation;var e=Math.abs(this._end-this._start),n=M-e;switch(e>n?(this._shortDistance=n,this._longDistance=e):(this._shortDistance=e,this._longDistance=n),this._shortestPathIsPositive=(this._start-this._end+M)%M>=Math.PI,this._rotationType){case ze.ShortestPath:this._distance=this._shortDistance,this._shortestPathIsPositive?this._direction=1:this._direction=-1;break;case ze.LongestPath:this._distance=this._longDistance,this._shortestPathIsPositive?this._direction=-1:this._direction=1;break;case ze.Clockwise:this._direction=1,this._shortestPathIsPositive?this._distance=this._shortDistance:this._distance=this._longDistance;break;case ze.CounterClockwise:this._direction=-1,this._shortestPathIsPositive?this._distance=this._longDistance:this._distance=this._shortDistance}}this._actor.angularVelocity=this._direction*this._speed,this._currentNonCannonAngle+=this._direction*this._speed*(t/1e3),this.isComplete()&&(this._actor.rotation=this._end,this._actor.angularVelocity=0,this._stopped=!0)}},{key:"isComplete",value:function(){var t=Math.abs(this._currentNonCannonAngle-this._start);return this._stopped||t>=Math.abs(this._distance)}},{key:"stop",value:function(){this._actor.angularVelocity=0,this._stopped=!0}},{key:"reset",value:function(){this._started=!1}}]),t}(),Ke=function(){function t(e,n,i,r){f(this,t),this._started=!1,this._stopped=!1,this._actor=e,this._speed=i,this._offset=n,this._rotationType=r||ze.ShortestPath}return p(t,[{key:"update",value:function(t){if(!this._started){this._started=!0,this._start=this._actor.rotation,this._currentNonCannonAngle=this._actor.rotation,this._end=this._start+this._offset;var e=Math.abs(this._end-this._start),n=M-e;switch(e>n?(this._shortDistance=n,this._longDistance=e):(this._shortDistance=e,this._longDistance=n),this._shortestPathIsPositive=(this._start-this._end+M)%M>=Math.PI,this._rotationType){case ze.ShortestPath:this._distance=this._shortDistance,this._shortestPathIsPositive?this._direction=1:this._direction=-1;break;case ze.LongestPath:this._distance=this._longDistance,this._shortestPathIsPositive?this._direction=-1:this._direction=1;break;case ze.Clockwise:this._direction=1,this._shortDistance>=0?this._distance=this._shortDistance:this._distance=this._longDistance;break;case ze.CounterClockwise:this._direction=-1,this._shortDistance<=0?this._distance=this._shortDistance:this._distance=this._longDistance}}this._actor.angularVelocity=this._direction*this._speed,this._currentNonCannonAngle+=this._direction*this._speed*(t/1e3),this.isComplete()&&(this._actor.rotation=this._end,this._actor.angularVelocity=0,this._stopped=!0)}},{key:"isComplete",value:function(){var t=Math.abs(this._currentNonCannonAngle-this._start);return this._stopped||t>=Math.abs(this._distance)}},{key:"stop",value:function(){this._actor.angularVelocity=0,this._stopped=!0}},{key:"reset",value:function(){this._started=!1}}]),t}(),Qe=function(){function t(){f(this,t),this.owner=null}return p(t,[{key:"clone",value:function(){var t,e=new this.constructor;for(var n in this)if(this.hasOwnProperty(n)){var i=this[n];(null==(t=i)?void 0:t.clone)&&"owner"!==n&&"clone"!==n?e[n]=i.clone():e[n]=i}return e}}]),t}(),Ye=function(t){h(n,t);var e=d(n);function n(t,i){var r;return f(this,n),(r=e.call(this)).type=t,r.value=i,r}return n}(Qe),Ze=function(t){h(n,t);var e=d(n);function n(){var t;return f(this,n),(t=e.apply(this,arguments)).type="ex.motion",t.vel=rt.Zero,t.acc=rt.Zero,t.scaleFactor=rt.Zero,t.angularVelocity=0,t.torque=0,t.inertia=1,t}return n}(Qe);!function(t){t[t.X=12]="X",t[t.Y=13]="Y"}(Ne||(Ne={}));var $e,Je,tn=function(t){return 0===t?0:t<0?-1:1},en=function(){function t(){f(this,t),this.data=new Float32Array(16),this._scaleSignX=1,this._scaleSignY=1}return p(t,[{key:"clone",value:function(){var e=new t;return e.data[0]=this.data[0],e.data[1]=this.data[1],e.data[2]=this.data[2],e.data[3]=this.data[3],e.data[4]=this.data[4],e.data[5]=this.data[5],e.data[6]=this.data[6],e.data[7]=this.data[7],e.data[8]=this.data[8],e.data[9]=this.data[9],e.data[10]=this.data[10],e.data[11]=this.data[11],e.data[12]=this.data[12],e.data[13]=this.data[13],e.data[14]=this.data[14],e.data[15]=this.data[15],e}},{key:"multv",value:function(t){return t instanceof rt?new rt(t.x*this.data[0]+t.y*this.data[4]+0*this.data[6]+1*this.data[12],t.x*this.data[1]+t.y*this.data[5]+0*this.data[9]+1*this.data[13]):[t[0]*this.data[0]+t[1]*this.data[4]+0*this.data[6]+1*this.data[12],t[0]*this.data[1]+t[1]*this.data[5]+0*this.data[9]+1*this.data[13]]}},{key:"multm",value:function(e){var n=new t,i=this.data[0],r=this.data[1],o=this.data[2],a=this.data[3],s=this.data[4],l=this.data[5],u=this.data[6],c=this.data[7],h=this.data[8],d=this.data[9],f=this.data[10],p=this.data[11],v=this.data[12],g=this.data[13],y=this.data[14],m=this.data[15],_=e.data[0],w=e.data[1],b=e.data[2],k=e.data[3],x=e.data[4],C=e.data[5],S=e.data[6],E=e.data[7],P=e.data[8],A=e.data[9],T=e.data[10],R=e.data[11],D=e.data[12],M=e.data[13],L=e.data[14],B=e.data[15];n.data[0]=i*_+s*w+h*b+v*k,n.data[1]=r*_+l*w+d*b+g*k,n.data[2]=o*_+u*w+f*b+y*k,n.data[3]=a*_+c*w+p*b+m*k,n.data[4]=i*x+s*C+h*S+v*E,n.data[5]=r*x+l*C+d*S+g*E,n.data[6]=o*x+u*C+f*S+y*E,n.data[7]=a*x+c*C+p*S+m*E,n.data[8]=i*P+s*A+h*T+v*R,n.data[9]=r*P+l*A+d*T+g*R,n.data[10]=o*P+u*A+f*T+y*R,n.data[11]=a*P+c*A+p*T+m*R,n.data[12]=i*D+s*M+h*L+v*B,n.data[13]=r*D+l*M+d*L+g*B,n.data[14]=o*D+u*M+f*L+y*B,n.data[15]=a*D+c*M+p*L+m*B;var O=this.getScale();return n._scaleSignX=tn(O.x)*tn(n._scaleSignX),n._scaleSignY=tn(O.y)*tn(n._scaleSignY),n}},{key:"translate",value:function(t,e){var n=this.data[0],i=this.data[1],r=this.data[2],o=this.data[3],a=this.data[4],s=this.data[5],l=this.data[6],u=this.data[7],c=this.data[8],h=this.data[9],d=this.data[10],f=this.data[11],p=this.data[12],v=this.data[13],g=this.data[14],y=this.data[15];return this.data[12]=n*t+a*e+0*c+1*p,this.data[13]=i*t+s*e+0*h+1*v,this.data[14]=r*t+l*e+0*d+1*g,this.data[15]=o*t+u*e+0*f+1*y,this}},{key:"setPosition",value:function(t,e){this.data[12]=t,this.data[13]=e}},{key:"getPosition",value:function(){return ot(this.data[12],this.data[13])}},{key:"rotate",value:function(t){var e=this.data[0],n=this.data[1],i=this.data[2],r=this.data[3],o=this.data[4],a=this.data[5],s=this.data[6],l=this.data[7],u=Math.sin(t),c=Math.cos(t);return this.data[0]=c*e+u*o,this.data[1]=c*n+u*a,this.data[2]=c*i+u*s,this.data[3]=c*r+u*l,this.data[4]=c*o-u*e,this.data[5]=c*a-u*n,this.data[6]=c*s-u*i,this.data[7]=c*l-u*r,this}},{key:"scale",value:function(t,e){var n=this.data[0],i=this.data[1],r=this.data[2],o=this.data[3],a=this.data[4],s=this.data[5],l=this.data[6],u=this.data[7];return this.data[0]=n*t,this.data[1]=i*t,this.data[2]=r*t,this.data[3]=o*t,this.data[4]=a*e,this.data[5]=s*e,this.data[6]=l*e,this.data[7]=u*e,this}},{key:"setRotation",value:function(t){var e=this.getScale(),n=Math.sin(t),i=Math.cos(t);this.data[0]=i*e.x,this.data[1]=n*e.y,this.data[4]=-n*e.x,this.data[5]=i*e.y}},{key:"getRotation",value:function(){return N(Math.atan2(this.data[1]/this.getScaleY(),this.data[0]/this.getScaleX()))}},{key:"getScaleX",value:function(){var t=ot(this.data[0],this.data[4]).size;return this._scaleSignX*t}},{key:"getScaleY",value:function(){var t=ot(this.data[1],this.data[5]).size;return this._scaleSignY*t}},{key:"getScale",value:function(){return ot(this.getScaleX(),this.getScaleY())}},{key:"setScaleX",value:function(t){this._scaleSignX=tn(t);var e=ot(this.data[0]*this._scaleSignX,this.data[4]*this._scaleSignX).normalize();this.data[0]=e.x*t,this.data[4]=e.y*t}},{key:"setScaleY",value:function(t){this._scaleSignY=tn(t);var e=ot(this.data[1]*this._scaleSignY,this.data[5]*this._scaleSignY).normalize();this.data[1]=e.x*t,this.data[5]=e.y*t}},{key:"setScale",value:function(t){this.setScaleX(t.x),this.setScaleY(t.y)}},{key:"getBasisDeterminant",value:function(){return this.data[0]*this.data[5]-this.data[1]*this.data[4]}},{key:"getAffineInverse",value:function(){var e=1/this.getBasisDeterminant(),n=this.data[0],i=this.data[4],r=this.data[1],o=this.data[5],a=t.identity();a.data[0]=o*e,a.data[1]=-r*e,a.data[4]=-i*e,a.data[5]=n*e;var s=this.data[12],l=this.data[13];return a.data[12]=-(s*a.data[0]+l*a.data[4]),a.data[13]=-(s*a.data[1]+l*a.data[5]),a}},{key:"isIdentity",value:function(){return 1===this.data[0]&&0===this.data[1]&&0===this.data[2]&&0===this.data[3]&&0===this.data[4]&&1===this.data[5]&&0===this.data[6]&&0===this.data[7]&&0===this.data[8]&&0===this.data[9]&&1===this.data[10]&&0===this.data[11]&&0===this.data[12]&&0===this.data[13]&&0===this.data[14]&&1===this.data[15]}},{key:"toString",value:function(){return"\n[".concat(this.data[0]," ").concat(this.data[4]," ").concat(this.data[8]," ").concat(this.data[12],"]\n[").concat(this.data[1]," ").concat(this.data[5]," ").concat(this.data[9]," ").concat(this.data[13],"]\n[").concat(this.data[2]," ").concat(this.data[6]," ").concat(this.data[10]," ").concat(this.data[14],"]\n[").concat(this.data[3]," ").concat(this.data[7]," ").concat(this.data[11]," ").concat(this.data[15],"]\n")}}],[{key:"ortho",value:function(e,n,i,r,o,a){var s=new t;return s.data[0]=2/(n-e),s.data[1]=0,s.data[2]=0,s.data[3]=0,s.data[4]=0,s.data[5]=2/(r-i),s.data[6]=0,s.data[7]=0,s.data[8]=0,s.data[9]=0,s.data[10]=-2/(a-o),s.data[11]=0,s.data[12]=-(n+e)/(n-e),s.data[13]=-(r+i)/(r-i),s.data[14]=-(a+o)/(a-o),s.data[15]=1,s}},{key:"identity",value:function(){var e=new t;return e.data[0]=1,e.data[1]=0,e.data[2]=0,e.data[3]=0,e.data[4]=0,e.data[5]=1,e.data[6]=0,e.data[7]=0,e.data[8]=0,e.data[9]=0,e.data[10]=1,e.data[11]=0,e.data[12]=0,e.data[13]=0,e.data[14]=0,e.data[15]=1,e}},{key:"translation",value:function(e,n){var i=t.identity();return i.data[12]=e,i.data[13]=n,i}},{key:"scale",value:function(e,n){var i=t.identity();return i.data[0]=e,i.data[5]=n,i.data[10]=1,i.data[15]=1,i}},{key:"rotation",value:function(e){var n=t.identity();return n.data[0]=Math.cos(e),n.data[4]=-Math.sin(e),n.data[1]=Math.sin(e),n.data[5]=Math.cos(e),n}}]),t}(),nn=function(t){h(n,t);var e=d(n);function n(t){var i;return f(this,n),(i=e.call(this,0,0))._getX=t.getX,i._getY=t.getY,i._setX=t.setX,i._setY=t.setY,i}return p(n,[{key:"x",get:function(){return this._x=this._getX()},set:function(t){this._setX(t),this._x=t}},{key:"y",get:function(){return this._y=this._getY()},set:function(t){this._setY(t),this._y=t}}]),n}(rt);!function(t){t.World="world",t.Screen="screen"}($e||($e={}));var rn=function(t){h(n,t);var e=d(n);function n(){var t;return f(this,n),(t=e.apply(this,arguments)).type="ex.transform",t._dirty=!1,t.matrix=en.identity().translate(0,0).rotate(0).scale(1,1),t._position=function(t){var e=t;return new nn({setX:function(t){e.data[Ne.X]=t},setY:function(t){e.data[Ne.Y]=t},getX:function(){return e.data[Ne.X]},getY:function(){return e.data[Ne.Y]}})}(t.matrix),t._rotation=0,t._scale=function(t){var e=t;return new nn({setX:function(t){e.setScaleX(t)},setY:function(t){e.setScaleY(t)},getX:function(){return e.getScaleX()},getY:function(){return e.getScaleY()}})}(t.matrix),t.coordPlane=$e.World,t.z=0,t}return p(n,[{key:"_recalculate",value:function(){this._rotation=this.matrix.getRotation(),this._dirty=!1}},{key:"getGlobalMatrix",value:function(){return this.parent?this.parent.getGlobalMatrix().multm(this.matrix):this.matrix}},{key:"getGlobalTransform",value:function(){return{pos:this.globalPos,scale:this.globalScale,rotation:this.globalRotation,z:this.z,coordPlane:this.coordPlane}}},{key:"parent",get:function(){var t,e;return null===(e=null===(t=null==this?void 0:this.owner)||void 0===t?void 0:t.parent)||void 0===e?void 0:e.get(n)}},{key:"pos",get:function(){return this._dirty&&this._recalculate(),this._position},set:function(t){this.matrix.setPosition(t.x,t.y),this._dirty=!0}},{key:"dirty",get:function(){var t;return(null===(t=null==this?void 0:this.owner)||void 0===t?void 0:t.parent)&&this.parent.dirty||this._dirty}},{key:"globalPos",get:function(){var t=this,e=this.getGlobalMatrix();return new nn({getX:function(){return e.data[Ne.X]},getY:function(){return e.data[Ne.Y]},setX:function(n){var i;if(t.parent){var r=null===(i=t.parent)||void 0===i?void 0:i.getGlobalMatrix().getAffineInverse().multv([n,e.data[Ne.Y]]),o=l(r,1)[0];t.matrix.data[Ne.X]=o}else t.matrix.data[Ne.X]=n},setY:function(n){var i;if(t.parent){var r=null===(i=t.parent)||void 0===i?void 0:i.getGlobalMatrix().getAffineInverse().multv([e.data[Ne.X],n]),o=l(r,2)[1];t.matrix.data[Ne.Y]=o}else t.matrix.data[Ne.Y]=n}})},set:function(t){var e=this.parent;this.pos=e?e.getGlobalMatrix().getAffineInverse().multv(t):t}},{key:"rotation",get:function(){return this._dirty&&this._recalculate(),this._rotation},set:function(t){this.matrix.setRotation(t),this._dirty=!0}},{key:"globalRotation",get:function(){return this.getGlobalMatrix().getRotation()},set:function(t){var e=this.parent;this.rotation=e?t-e.globalRotation:t}},{key:"scale",get:function(){return this._dirty&&this._recalculate(),this._scale},set:function(t){this.matrix.setScale(t),this._dirty=!0}},{key:"globalScale",get:function(){var t=this,e=this.getGlobalMatrix();return new nn({getX:function(){return e.getScaleX()},getY:function(){return e.getScaleY()},setX:function(e){if(t.parent){var n=t.parent.globalScale.x;t.matrix.setScaleX(e/n)}else t.matrix.setScaleX(e)},setY:function(e){if(t.parent){var n=t.parent.globalScale.y;t.matrix.setScaleY(e/n)}else t.matrix.setScaleY(e)}})},set:function(t){var e=this.parent;this.scale=e?ot(t.x/e.globalScale.x,t.y/e.globalScale.y):t}},{key:"apply",value:function(t){return this.matrix.multv(t)}},{key:"applyInverse",value:function(t){return this.matrix.getAffineInverse().multv(t)}}]),n}(Qe),on=function(){function t(e,n,i,r,o){f(this,t),this._started=!1,this._stopped=!1,this._actor=e,this._endX=n,this._endY=i,this._speedX=r,this._speedY=o}return p(t,[{key:"update",value:function(t){var e=this._actor.get(rn),n=this._actor.get(Ze);if(this._started||(this._started=!0,this._startX=e.scale.x,this._startY=e.scale.y,this._distanceX=Math.abs(this._endX-this._startX),this._distanceY=Math.abs(this._endY-this._startY)),Math.abs(e.scale.x-this._startX)>=this._distanceX)n.scaleFactor.x=0;else{var i=this._endY<this._startY?-1:1;n.scaleFactor.x=this._speedX*i}if(Math.abs(e.scale.y-this._startY)>=this._distanceY)n.scaleFactor.y=0;else{var r=this._endY<this._startY?-1:1;n.scaleFactor.y=this._speedY*r}this.isComplete()&&(this._actor.scale=ot(this._endX,this._endY),n.scaleFactor.x=0,n.scaleFactor.y=0)}},{key:"isComplete",value:function(){return this._stopped||Math.abs(this._actor.scale.y-this._startX)>=this._distanceX&&Math.abs(this._actor.scale.y-this._startY)>=this._distanceY}},{key:"stop",value:function(){var t=this._actor.get(Ze);t.scaleFactor.x=0,t.scaleFactor.y=0,this._stopped=!0}},{key:"reset",value:function(){this._started=!1}}]),t}(),an=function(){function t(e,n,i,r){f(this,t),this._started=!1,this._stopped=!1,this._actor=e,this._offset=new rt(n,i),this._speedX=this._speedY=r}return p(t,[{key:"update",value:function(t){var e=this._actor.get(rn),n=this._actor.get(Ze);this._started||(this._started=!0,this._startScale=e.scale.clone(),this._endScale=this._startScale.add(this._offset),this._distanceX=Math.abs(this._endScale.x-this._startScale.x),this._distanceY=Math.abs(this._endScale.y-this._startScale.y),this._directionX=this._endScale.x<this._startScale.x?-1:1,this._directionY=this._endScale.y<this._startScale.y?-1:1),n.scaleFactor.x=this._speedX*this._directionX,n.scaleFactor.y=this._speedY*this._directionY,this.isComplete()&&(e.scale=this._endScale,n.scaleFactor.x=0,n.scaleFactor.y=0)}},{key:"isComplete",value:function(){return this._stopped||Math.abs(this._actor.scale.x-this._startScale.x)>=this._distanceX&&Math.abs(this._actor.scale.y-this._startScale.y)>=this._distanceY}},{key:"stop",value:function(){var t=this._actor.get(Ze);t.scaleFactor.x=0,t.scaleFactor.y=0,this._stopped=!0}},{key:"reset",value:function(){this._started=!1}}]),t}(),sn=function(){function t(e){f(this,t),this._method=null,this._hasBeenCalled=!1,this._method=e}return p(t,[{key:"update",value:function(t){this._method(),this._hasBeenCalled=!0}},{key:"isComplete",value:function(){return this._hasBeenCalled}},{key:"reset",value:function(){this._hasBeenCalled=!1}},{key:"stop",value:function(){this._hasBeenCalled=!0}}]),t}(),ln=function(){function t(e,n,i,r,o){f(this,t),this.actor=e,this.easingFcn=o,this._currentLerpTime=0,this._lerpDuration=1e3,this._lerpStart=new rt(0,0),this._lerpEnd=new rt(0,0),this._initialized=!1,this._stopped=!1,this._distance=0,this._lerpDuration=r,this._lerpEnd=new rt(n,i)}return p(t,[{key:"_initialize",value:function(){this._lerpStart=new rt(this.actor.pos.x,this.actor.pos.y),this._currentLerpTime=0,this._distance=this._lerpStart.distance(this._lerpEnd)}},{key:"update",value:function(t){this._initialized||(this._initialize(),this._initialized=!0),this._currentLerpTime+=t;var e=this.actor.pos.x,n=this.actor.pos.y;this._currentLerpTime<this._lerpDuration?(e=this._lerpEnd.x<this._lerpStart.x?this._lerpStart.x-(this.easingFcn(this._currentLerpTime,this._lerpEnd.x,this._lerpStart.x,this._lerpDuration)-this._lerpEnd.x):this.easingFcn(this._currentLerpTime,this._lerpStart.x,this._lerpEnd.x,this._lerpDuration),n=this._lerpEnd.y<this._lerpStart.y?this._lerpStart.y-(this.easingFcn(this._currentLerpTime,this._lerpEnd.y,this._lerpStart.y,this._lerpDuration)-this._lerpEnd.y):this.easingFcn(this._currentLerpTime,this._lerpStart.y,this._lerpEnd.y,this._lerpDuration),this.actor.vel=ot((e-this.actor.pos.x)/(t/1e3),(n-this.actor.pos.y)/(t/1e3))):(this.actor.pos=ot(this._lerpEnd.x,this._lerpEnd.y),this.actor.vel=rt.Zero)}},{key:"isComplete",value:function(t){return this._stopped||new rt(t.pos.x,t.pos.y).distance(this._lerpStart)>=this._distance}},{key:"reset",value:function(){this._initialized=!1}},{key:"stop",value:function(){this.actor.vel=ot(0,0),this._stopped=!0}}]),t}(),un=function(){function t(e,n,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;f(this,t),this._timeVisible=0,this._timeNotVisible=0,this._elapsedTime=0,this._totalTime=0,this._stopped=!1,this._started=!1,this._actor=e,this._timeVisible=n,this._timeNotVisible=i,this._duration=(n+i)*r}return p(t,[{key:"update",value:function(t){this._started||(this._started=!0),this._elapsedTime+=t,this._totalTime+=t,this._actor.graphics.visible&&this._elapsedTime>=this._timeVisible&&(this._actor.graphics.visible=!1,this._elapsedTime=0),!this._actor.graphics.visible&&this._elapsedTime>=this._timeNotVisible&&(this._actor.graphics.visible=!0,this._elapsedTime=0),this.isComplete()&&(this._actor.graphics.visible=!0)}},{key:"isComplete",value:function(){return this._stopped||this._totalTime>=this._duration}},{key:"stop",value:function(){this._actor.graphics.visible=!0,this._stopped=!0}},{key:"reset",value:function(){this._started=!1,this._elapsedTime=0,this._totalTime=0}}]),t}(),cn=function(){function t(e,n,i){f(this,t),this._multiplier=1,this._started=!1,this._stopped=!1,this._actor=e,this._endOpacity=n,this._speed=i}return p(t,[{key:"update",value:function(t){this._started||(this._started=!0,this._endOpacity<this._actor.graphics.opacity?this._multiplier=-1:this._multiplier=1),this._speed>0&&(this._actor.graphics.opacity+=this._multiplier*(Math.abs(this._actor.graphics.opacity-this._endOpacity)*t)/this._speed),this._speed-=t,this.isComplete()&&(this._actor.graphics.opacity=this._endOpacity),P.getInstance().debug("[Action fade] Actor opacity:",this._actor.graphics.opacity)}},{key:"isComplete",value:function(){return this._stopped||Math.abs(this._actor.graphics.opacity-this._endOpacity)<.05}},{key:"stop",value:function(){this._stopped=!0}},{key:"reset",value:function(){this._started=!1}}]),t}(),hn=function(){function t(e,n){f(this,t),this._elapsedTime=0,this._started=!1,this._stopped=!1,this._actor=e,this._delay=n}return p(t,[{key:"update",value:function(t){this._started||(this._started=!0),this.x=this._actor.pos.x,this.y=this._actor.pos.y,this._elapsedTime+=t}},{key:"isComplete",value:function(){return this._stopped||this._elapsedTime>=this._delay}},{key:"stop",value:function(){this._stopped=!0}},{key:"reset",value:function(){this._elapsedTime=0,this._started=!1}}]),t}(),dn=function(){function t(e){f(this,t),this._stopped=!1,this._actor=e}return p(t,[{key:"update",value:function(t){this._actor.actions.clearActions(),this._actor.kill(),this._stopped=!0}},{key:"isComplete",value:function(){return this._stopped}},{key:"stop",value:function(){}},{key:"reset",value:function(){}}]),t}(),fn=function(){function t(e,n,i){f(this,t),this._started=!1,this._stopped=!1,this._actor=e,this._actorToFollow=n,this._current=new rt(this._actor.pos.x,this._actor.pos.y),this._end=new rt(n.pos.x,n.pos.y),this._maximumDistance=void 0!==i?i:this._current.distance(this._end),this._speed=0}return p(t,[{key:"update",value:function(t){this._started||(this._started=!0,this._distanceBetween=this._current.distance(this._end),this._dir=this._end.sub(this._current).normalize());var e=Math.sqrt(Math.pow(this._actorToFollow.vel.x,2)+Math.pow(this._actorToFollow.vel.y,2));if(0!==e&&(this._speed=e),this._current=ot(this._actor.pos.x,this._actor.pos.y),this._end=ot(this._actorToFollow.pos.x,this._actorToFollow.pos.y),this._distanceBetween=this._current.distance(this._end),this._dir=this._end.sub(this._current).normalize(),this._distanceBetween>=this._maximumDistance){var n=this._dir.scale(this._speed);this._actor.vel=ot(n.x,n.y)}else this._actor.vel=ot(0,0);this.isComplete()&&(this._actor.pos=ot(this._end.x,this._end.y),this._actor.vel=ot(0,0))}},{key:"stop",value:function(){this._actor.vel=ot(0,0),this._stopped=!0}},{key:"isComplete",value:function(){return this._stopped}},{key:"reset",value:function(){this._started=!1}}]),t}(),pn=function(){function t(e,n,i){f(this,t),this._started=!1,this._stopped=!1,this._speedWasSpecified=!1,this._actor=e,this._actorToMeet=n,this._current=new rt(this._actor.pos.x,this._actor.pos.y),this._end=new rt(n.pos.x,n.pos.y),this._speed=i||0,void 0!==i&&(this._speedWasSpecified=!0)}return p(t,[{key:"update",value:function(t){this._started||(this._started=!0,this._distanceBetween=this._current.distance(this._end),this._dir=this._end.sub(this._current).normalize());var e=Math.sqrt(Math.pow(this._actorToMeet.vel.x,2)+Math.pow(this._actorToMeet.vel.y,2));0===e||this._speedWasSpecified||(this._speed=e),this._current=ot(this._actor.pos.x,this._actor.pos.y),this._end=ot(this._actorToMeet.pos.x,this._actorToMeet.pos.y),this._distanceBetween=this._current.distance(this._end),this._dir=this._end.sub(this._current).normalize();var n=this._dir.scale(this._speed);this._actor.vel=ot(n.x,n.y),this.isComplete()&&(this._actor.pos=ot(this._end.x,this._end.y),this._actor.vel=ot(0,0))}},{key:"isComplete",value:function(){return this._stopped||this._distanceBetween<=1}},{key:"stop",value:function(){this._actor.vel=ot(0,0),this._stopped=!0}},{key:"reset",value:function(){this._started=!1}}]),t}(),vn=function(){function t(e){f(this,t),this._actor=e,this._queue=new We(e)}return p(t,[{key:"getQueue",value:function(){return this._queue}},{key:"update",value:function(t){this._queue.update(t)}},{key:"clearActions",value:function(){this._queue.clearActions()}},{key:"easeTo",value:function(){for(var t,e,n=0,i=0,r=0,o=He.Linear,a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];return s[0]instanceof rt?(n=s[0].x,i=s[0].y,r=s[1],o=null!==(t=s[2])&&void 0!==t?t:o):(n=s[0],i=s[1],r=s[2],o=null!==(e=s[3])&&void 0!==e?e:o),this._queue.add(new ln(this._actor,n,i,r,o)),this}},{key:"moveTo",value:function(t,e,n){var i=0,r=0,o=0;return t instanceof rt?(i=t.x,r=t.y,o=e):(i=t,r=e,o=n),this._queue.add(new Xe(this._actor,i,r,o)),this}},{key:"moveBy",value:function(t,e,n){var i=0,r=0,o=0;return t instanceof rt?(i=t.x,r=t.y,o=e):(i=t,r=e,o=n),this._queue.add(new Ge(this._actor,i,r,o)),this}},{key:"rotateTo",value:function(t,e,n){return this._queue.add(new qe(this._actor,t,e,n)),this}},{key:"rotateBy",value:function(t,e,n){return this._queue.add(new Ke(this._actor,t,e,n)),this}},{key:"scaleTo",value:function(t,e,n,i){var r=1,o=1,a=0,s=0;return t instanceof rt&&e instanceof rt&&(r=t.x,o=t.y,a=e.x,s=e.y),"number"==typeof t&&"number"==typeof e&&(r=t,o=e,a=n,s=i),this._queue.add(new on(this._actor,r,o,a,s)),this}},{key:"scaleBy",value:function(t,e,n){var i=1,r=1;return t instanceof rt&&(i=t.x,r=t.y,n=e),"number"==typeof t&&"number"==typeof e&&(i=t,r=e),this._queue.add(new an(this._actor,i,r,n)),this}},{key:"blink",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return this._queue.add(new un(this._actor,t,e,n)),this}},{key:"fade",value:function(t,e){return this._queue.add(new cn(this._actor,t,e)),this}},{key:"delay",value:function(t){return this._queue.add(new hn(this._actor,t)),this}},{key:"die",value:function(){return this._queue.add(new dn(this._actor)),this}},{key:"callMethod",value:function(t){return this._queue.add(new sn(t)),this}},{key:"repeat",value:function(t,e){return e?(this._queue.add(new je(this._actor,t,e)),this):(this.repeatForever(t),this)}},{key:"repeatForever",value:function(t){return this._queue.add(new Ve(this._actor,t)),this}},{key:"follow",value:function(t,e){return void 0===e?this._queue.add(new fn(this._actor,t)):this._queue.add(new fn(this._actor,t,e)),this}},{key:"meet",value:function(t,e){return void 0===e?this._queue.add(new pn(this._actor,t)):this._queue.add(new pn(this._actor,t,e)),this}},{key:"asPromise",value:function(){var t=this;return new Promise((function(e){t._queue.add(new sn((function(){e()})))}))}}]),t}();!function(t){t.PreventCollision="PreventCollision",t.Passive="Passive",t.Active="Active",t.Fixed="Fixed"}(Je||(Je={}));var gn,yn,mn,_n=function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a};!function(t){t.Arcade="arcade",t.Realistic="realistic"}(gn||(gn={})),function(t){t[t.DynamicAABBTree=0]="DynamicAABBTree"}(yn||(yn={})),function(t){t[t.Euler=0]="Euler"}(mn||(mn={}));var wn=function(){function t(){f(this,t)}return p(t,null,[{key:"gravity",get:function(){return t.acc},set:function(e){t.acc=e}},{key:"useArcadePhysics",value:function(){t.collisionResolutionStrategy=gn.Arcade}},{key:"useRealisticPhysics",value:function(){t.collisionResolutionStrategy=gn.Realistic}},{key:"dynamicTreeVelocityMultiplyer",get:function(){return t.dynamicTreeVelocityMultiplier},set:function(e){t.dynamicTreeVelocityMultiplier=e}}]),t}();wn.acc=new rt(0,0),wn.enabled=!0,wn.broadphaseStrategy=yn.DynamicAABBTree,wn.collisionResolutionStrategy=gn.Arcade,wn.defaultMass=10,wn.integrator=mn.Euler,wn.dynamicTreeVelocityMultiplier=2,wn.boundsPadding=5,wn.positionIterations=3,wn.velocityIterations=8,wn.slop=1,wn.steeringFactor=.2,wn.warmStart=!0,wn.bodiesCanSleepByDefault=!1,wn.surfaceEpsilon=.1,wn.sleepEpsilon=.07,wn.wakeThreshold=3*wn.sleepEpsilon,wn.sleepBias=.9,wn.checkForFastBodies=!0,wn.disableMinimumSpeedForFastBody=!1,_n([nt({message:"Alias for incorrect spelling used in older versions, will be removed in v0.25.0",alternateMethod:"dynamicTreeVelocityMultiplier"})],wn,"dynamicTreeVelocityMultiplyer",null);var bn=function(){function t(e,n,i){f(this,t),this._name=e,this._category=n,this._mask=i}return p(t,[{key:"name",get:function(){return this._name}},{key:"category",get:function(){return this._category}},{key:"mask",get:function(){return this._mask}},{key:"canCollide",value:function(t){return 0!=(this.category&t.mask)&&0!=(t.category&this.mask)}},{key:"invert",value:function(){return new t("~("+this.name+")",~this.category,~this.mask)}}],[{key:"combine",value:function(e){var n=e.map((function(t){return t.name})).join("+"),i=e.reduce((function(t,e){return e.category|t}),0);return new t(n,i,~i)}},{key:"collidesWith",value:function(e){return t.combine(e).invert()}}]),t}();bn.All=new bn("Collide with all groups",-1,-1);var kn=function(){function t(){f(this,t),this.observers=[],this.subscriptions=[]}return p(t,[{key:"register",value:function(t){this.observers.push(t)}},{key:"subscribe",value:function(t){this.subscriptions.push(t)}},{key:"unregister",value:function(t){var e=this.observers.indexOf(t);-1!==e&&this.observers.splice(e,1)}},{key:"unsubscribe",value:function(t){var e=this.subscriptions.indexOf(t);-1!==e&&this.subscriptions.splice(e,1)}},{key:"notifyAll",value:function(t){this.observers.forEach((function(e){return e.notify(t)})),this.subscriptions.forEach((function(e){return e(t)}))}},{key:"clear",value:function(){this.observers.length=0,this.subscriptions.length=0}}]),t}(),xn=function(){function t(e,n){f(this,t),this.colliderA=e,this.colliderB=n,this.id=null,this.id=t.calculatePairHash(e.id,n.id)}return p(t,[{key:"canCollide",get:function(){var e=this.colliderA,n=this.colliderB;return t.canCollide(e,n)}},{key:"collide",value:function(){return this.colliderA.collide(this.colliderB)}},{key:"hasCollider",value:function(t){return t===this.colliderA||t===this.colliderB}}],[{key:"canCollide",value:function(t,e){var n,i,r=null===(n=null==t?void 0:t.owner)||void 0===n?void 0:n.get(jn),o=null===(i=null==e?void 0:e.owner)||void 0===i?void 0:i.get(jn);return!(!r||!o)&&!!r.group.canCollide(o.group)&&(r.collisionType!==Je.Fixed||o.collisionType!==Je.Fixed)&&o.collisionType!==Je.PreventCollision&&r.collisionType!==Je.PreventCollision&&!(!r.active||!o.active)}},{key:"calculatePairHash",value:function(t,e){return t.value<e.value?"#".concat(t.value,"+").concat(e.value):"#".concat(e.value,"+").concat(t.value)}}]),t}(),Cn=function(){function t(e,n){f(this,t),this.min=e,this.max=n}return p(t,[{key:"overlaps",value:function(t){return this.max>t.min&&t.max>this.min}},{key:"getOverlap",value:function(t){return this.overlaps(t)?this.max>t.max?t.max-this.min:this.max-t.min:0}}]),t}(),Sn=function(){function t(e){f(this,t),this.parent=e,this.parent=e||null,this.data=null,this.bounds=new ht,this.left=null,this.right=null,this.height=0}return p(t,[{key:"isLeaf",value:function(){return!this.left&&!this.right}}]),t}(),En=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new ht(-Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE);f(this,t),this.worldBounds=e,this.root=null,this.nodes={}}return p(t,[{key:"_insert",value:function(t){if(null===this.root)return this.root=t,void(this.root.parent=null);for(var e=t.bounds,n=this.root;!n.isLeaf();){var i=n.left,r=n.right,o=n.bounds.getPerimeter(),a=n.bounds.combine(e).getPerimeter(),s=2*a,l=2*(a-o),u=0,c=e.combine(i.bounds),h=void 0;i.isLeaf()?u=c.getPerimeter()+l:(h=i.bounds.getPerimeter(),u=c.getPerimeter()-h+l);var d=0,f=e.combine(r.bounds);if(r.isLeaf()?d=f.getPerimeter()+l:(h=r.bounds.getPerimeter(),d=f.getPerimeter()-h+l),s<u&&s<d)break;n=u<d?i:r}var p=n.parent,v=new Sn(p);v.bounds=e.combine(n.bounds),v.height=n.height+1,null!==p?(p.left===n?p.left=v:p.right=v,v.left=n,v.right=t,n.parent=v,t.parent=v):(v.left=n,v.right=t,n.parent=v,t.parent=v,this.root=v);for(var g=t.parent;g;){if(!(g=this._balance(g)).left)throw new Error("Parent of current leaf cannot have a null left child"+g);if(!g.right)throw new Error("Parent of current leaf cannot have a null right child"+g);g.height=1+Math.max(g.left.height,g.right.height),g.bounds=g.left.bounds.combine(g.right.bounds),g=g.parent}}},{key:"_remove",value:function(t){if(t!==this.root){var e,n=t.parent,i=n.parent;if(e=n.left===t?n.right:n.left,i){i.left===n?i.left=e:i.right=e,e.parent=i;for(var r=i;r;)(r=this._balance(r)).bounds=r.left.bounds.combine(r.right.bounds),r.height=1+Math.max(r.left.height,r.right.height),r=r.parent}else this.root=e,e.parent=null}else this.root=null}},{key:"trackCollider",value:function(t){var e=new Sn;e.data=t,e.bounds=t.bounds,e.bounds.left-=2,e.bounds.top-=2,e.bounds.right+=2,e.bounds.bottom+=2,this.nodes[t.id.value]=e,this._insert(e)}},{key:"updateCollider",value:function(t){var e,n=this.nodes[t.id.value];if(!n)return!1;var i=t.bounds;if(!this.worldBounds.contains(i))return P.getInstance().warn("Collider with id "+t.id.value+" is outside the world bounds and will no longer be tracked for physics"),this.untrackCollider(t),!1;if(n.bounds.contains(i))return!1;if(this._remove(n),i.left-=wn.boundsPadding,i.top-=wn.boundsPadding,i.right+=wn.boundsPadding,i.bottom+=wn.boundsPadding,t.owner){var r=null===(e=t.owner)||void 0===e?void 0:e.get(jn);if(r){var o=32*r.vel.x/1e3*wn.dynamicTreeVelocityMultiplier,a=32*r.vel.y/1e3*wn.dynamicTreeVelocityMultiplier;o<0?i.left+=o:i.right+=o,a<0?i.top+=a:i.bottom+=a}}return n.bounds=i,this._insert(n),!0}},{key:"untrackCollider",value:function(t){var e=this.nodes[t.id.value];e&&(this._remove(e),this.nodes[t.id.value]=null,delete this.nodes[t.id.value])}},{key:"_balance",value:function(t){if(null===t)throw new Error("Cannot balance at null node");if(t.isLeaf()||t.height<2)return t;var e=t.left,n=t.right,i=t,r=e,o=n,a=e.left,s=e.right,l=n.left,u=n.right,c=o.height-r.height;if(c>1)return o.left=i,o.parent=i.parent,i.parent=o,o.parent?o.parent.left===i?o.parent.left=o:o.parent.right=o:this.root=o,l.height>u.height?(o.right=l,i.right=u,u.parent=i,i.bounds=r.bounds.combine(u.bounds),o.bounds=i.bounds.combine(l.bounds),i.height=1+Math.max(r.height,u.height),o.height=1+Math.max(i.height,l.height)):(o.right=u,i.right=l,l.parent=i,i.bounds=r.bounds.combine(l.bounds),o.bounds=i.bounds.combine(u.bounds),i.height=1+Math.max(r.height,l.height),o.height=1+Math.max(i.height,u.height)),o;if(c<-1){if(r.left=i,r.parent=i.parent,i.parent=r,r.parent)if(r.parent.left===i)r.parent.left=r;else{if(r.parent.right!==i)throw"Error rotating Dynamic Tree";r.parent.right=r}else this.root=r;return a.height>s.height?(r.right=a,i.left=s,s.parent=i,i.bounds=o.bounds.combine(s.bounds),r.bounds=i.bounds.combine(a.bounds),i.height=1+Math.max(o.height,s.height),r.height=1+Math.max(i.height,a.height)):(r.right=s,i.left=a,a.parent=i,i.bounds=o.bounds.combine(a.bounds),r.bounds=i.bounds.combine(s.bounds),i.height=1+Math.max(o.height,a.height),r.height=1+Math.max(i.height,s.height)),r}return t}},{key:"getHeight",value:function(){return null===this.root?0:this.root.height}},{key:"query",value:function(t,e){var n=t.bounds;!function i(r){if(r&&r.bounds.intersect(n)){if(!r.isLeaf()||r.data===t)return i(r.left)||i(r.right);if(e.call(t,r.data))return!0}return!1}(this.root)}},{key:"rayCastQuery",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,n=arguments.length>2?arguments[2]:void 0;!function i(r){if(r&&r.bounds.rayCast(t,e)){if(!r.isLeaf())return i(r.left)||i(r.right);if(n.call(t,r.data))return!0}return!1}(this.root)}},{key:"getNodes",value:function(){return function t(e){return e?[e].concat(t(e.left),t(e.right)):[]}(this.root)}},{key:"debug",value:function(t){!function e(n){n&&(n.isLeaf()?n.bounds.draw(t,ut.Green):n.bounds.draw(t,ut.White),n.left&&e(n.left),n.right&&e(n.right))}(this.root)}}]),t}(),Pn=function(){function t(e,n){f(this,t),this.pos=e,this.dir=n.normalize()}return p(t,[{key:"intersect",value:function(t){var e=t.begin.sub(this.pos);if(0===this.dir.cross(t.getSlope())&&0!==e.cross(this.dir))return-1;var n=this.dir.cross(t.getSlope());if(0===n)return-1;var i=e.cross(t.getSlope())/n;if(i>=0){var r=e.cross(this.dir)/n/t.getLength();if(r>=0&&r<=1)return i}return-1}},{key:"intersectPoint",value:function(t){var e=this.intersect(t);return e<0?null:this.getPoint(e)}},{key:"getPoint",value:function(t){return this.pos.add(this.dir.scale(t))}}]),t}(),An=function(){function t(){f(this,t),this._dynamicCollisionTree=new En,this._collisions=new Set,this._collisionPairCache=[],this._colliders=[]}return p(t,[{key:"getColliders",value:function(){return this._colliders}},{key:"track",value:function(t){if(t)if(t instanceof Rn){var e,n=t.getColliders(),i=s(n);try{for(i.s();!(e=i.n()).done;){var r=e.value;r.owner=t.owner,this._colliders.push(r),this._dynamicCollisionTree.trackCollider(r)}}catch(o){i.e(o)}finally{i.f()}}else this._colliders.push(t),this._dynamicCollisionTree.trackCollider(t);else P.getInstance().warn("Cannot track null collider")}},{key:"untrack",value:function(t){if(t)if(t instanceof Rn){var e,n=t.getColliders(),i=s(n);try{for(i.s();!(e=i.n()).done;){var r=e.value,o=this._colliders.indexOf(r);-1!==o&&this._colliders.splice(o,1),this._dynamicCollisionTree.untrackCollider(r)}}catch(l){i.e(l)}finally{i.f()}}else{var a=this._colliders.indexOf(t);-1!==a&&this._colliders.splice(a,1),this._dynamicCollisionTree.untrackCollider(t)}else P.getInstance().warn("Cannot untrack a null collider")}},{key:"_shouldGenerateCollisionPair",value:function(t,e){if(null!==t.id&&null!==e.id&&t.id===e.id||null!==t.owner&&null!==e.owner&&t.owner===e.owner)return!1;var n=xn.calculatePairHash(t.id,e.id);return!this._collisions.has(n)&&!t.localBounds.hasZeroDimensions()&&!e.localBounds.hasZeroDimensions()&&xn.canCollide(t,e)}},{key:"broadphase",value:function(t,e,n){var i,r=this,o=e/1e3,a=t.filter((function(t){var e,n,i=null===(e=t.owner)||void 0===e?void 0:e.get(jn);return(null===(n=t.owner)||void 0===n?void 0:n.active)&&i.collisionType!==Je.PreventCollision}));this._collisionPairCache=[],this._collisions.clear();for(var l=0,u=a.length;l<u;l++)i=a[l],this._dynamicCollisionTree.query(i,(function(t){if(r._shouldGenerateCollisionPair(i,t)){var e=new xn(i,t);r._collisions.add(e.id),r._collisionPairCache.push(e)}return!1}));if(n&&(n.physics.pairs=this._collisionPairCache.length),wn.checkForFastBodies){var c,h=s(a);try{var d=function(){var t=c.value,e=t.owner.get(jn);if(e.collisionType!==Je.Active)return"continue";var i=e.vel.size*o+.5*e.acc.size*o*o,a=Math.min(t.bounds.height,t.bounds.width);if(wn.disableMinimumSpeedForFastBody||i>a/2){n&&n.physics.fastBodies++;var s,l=e.pos.sub(e.oldPos),u=t.center,h=t.getFurthestPoint(e.vel),d=h.sub(l),f=new Pn(d,e.vel);f.pos=f.pos.add(f.dir.scale(-2*wn.surfaceEpsilon));var p=new rt(1/0,1/0);if(r._dynamicCollisionTree.rayCastQuery(f,i+2*wn.surfaceEpsilon,(function(e){if(t!==e&&xn.canCollide(t,e)){var n=e.rayCast(f,i+10*wn.surfaceEpsilon);if(n){var r=n.sub(d);r.size<p.size&&(p=r,s=e)}}return!1})),s&&rt.isValid(p)){var v=new xn(t,s);r._collisions.has(v.id)||(r._collisions.add(v.id),r._collisionPairCache.push(v));var g=u.sub(h);e.pos=d.add(g).add(p).add(f.dir.scale(10*wn.surfaceEpsilon)),t.update(e.transform),n&&n.physics.fastBodyCollisions++}}};for(h.s();!(c=h.n()).done;)d()}catch(f){h.e(f)}finally{h.f()}}return this._collisionPairCache}},{key:"narrowphase",value:function(t,e){for(var n=[],i=0;i<t.length;i++){var r=t[i].collide();if(n=n.concat(r),e&&r.length>0){var o,a=s(r);try{for(a.s();!(o=a.n()).done;){var l=o.value;e.physics.contacts.set(l.id,l)}}catch(u){a.e(u)}finally{a.f()}}}return e&&(e.physics.collisions+=n.length),n}},{key:"update",value:function(t){for(var e=0,n=t.length,i=0;i<n;i++)this._dynamicCollisionTree.updateCollider(t[i])&&e++;return e}},{key:"debug",value:function(t){this._dynamicCollisionTree.debug(t)}}]),t}(),Tn=function(){function t(){f(this,t),this.id=E("collider",t._ID++),this.events=new Jt(this)}return p(t,[{key:"touching",value:function(t){return!!this.collide(t)}}]),t}();Tn._ID=0;var Rn=function(t){h(n,t);var e=d(n);function n(t){var i;f(this,n),(i=e.call(this))._collisionProcessor=new An,i._dynamicAABBTree=new En,i._colliders=[];var r,o=s(t);try{for(o.s();!(r=o.n()).done;){var a=r.value;i.addCollider(a)}}catch(l){o.e(l)}finally{o.f()}return i}return p(n,[{key:"clearColliders",value:function(){this._colliders=[]}},{key:"addCollider",value:function(t){this.events.wire(t.events),this._colliders.push(t),this._collisionProcessor.track(t),this._dynamicAABBTree.trackCollider(t)}},{key:"removeCollider",value:function(t){this.events.unwire(t.events),V(t,this._colliders),this._collisionProcessor.untrack(t),this._dynamicAABBTree.untrackCollider(t)}},{key:"getColliders",value:function(){return this._colliders}},{key:"worldPos",get:function(){var t,e;return null!==(e=null===(t=this._transform)||void 0===t?void 0:t.pos)&&void 0!==e?e:rt.Zero}},{key:"center",get:function(){var t,e;return null!==(e=null===(t=this._transform)||void 0===t?void 0:t.pos)&&void 0!==e?e:rt.Zero}},{key:"bounds",get:function(){var t,e,n=this.getColliders();return n.reduce((function(t,e){return t.combine(e.bounds)}),null!==(e=null===(t=n[0])||void 0===t?void 0:t.bounds)&&void 0!==e?e:(new ht).translate(this.worldPos))}},{key:"localBounds",get:function(){var t,e,n=this.getColliders();return n.reduce((function(t,e){return t.combine(e.localBounds)}),null!==(e=null===(t=n[0])||void 0===t?void 0:t.localBounds)&&void 0!==e?e:new ht)}},{key:"axes",get:function(){var t,e=this.getColliders(),n=[],i=s(e);try{for(i.s();!(t=i.n()).done;){var r=t.value;n=n.concat(r.axes)}}catch(o){i.e(o)}finally{i.f()}return n}},{key:"getFurthestPoint",value:function(t){var e,n=this.getColliders(),i=[],r=s(n);try{for(r.s();!(e=r.n()).done;){var o=e.value;i.push(o.getFurthestPoint(t))}}catch(f){r.e(f)}finally{r.f()}for(var a=i[0],l=-Number.MAX_VALUE,u=0,c=i;u<c.length;u++){var h=c[u],d=h.dot(t);d>l&&(a=h,l=d)}return a}},{key:"getInertia",value:function(t){var e,n=this.getColliders(),i=0,r=s(n);try{for(r.s();!(e=r.n()).done;)i+=e.value.getInertia(t)}catch(o){r.e(o)}finally{r.f()}return i}},{key:"collide",value:function(t){var e=this,i=[t];t instanceof n&&(i=t.getColliders());var r,o=[],a=s(i);try{var l=function(){var t=r.value;e._dynamicAABBTree.query(t,(function(e){return o.push(new xn(t,e)),!1}))};for(a.s();!(r=a.n()).done;)l()}catch(f){a.e(f)}finally{a.f()}for(var u=[],c=0,h=o;c<h.length;c++){var d=h[c];u=u.concat(d.collide())}return u}},{key:"getClosestLineBetween",value:function(t){var e=this.getColliders(),i=[];if(t instanceof n){var r,o=t.getColliders(),a=s(e);try{for(a.s();!(r=a.n()).done;){var l,u=r.value,c=s(o);try{for(c.s();!(l=c.n()).done;){var h=l.value,d=u.getClosestLineBetween(h);d&&i.push(d)}}catch(x){c.e(x)}finally{c.f()}}}catch(x){a.e(x)}finally{a.f()}}else{var f,p=s(e);try{for(p.s();!(f=p.n()).done;){var v=f.value,g=t.getClosestLineBetween(v);g&&i.push(g)}}catch(x){p.e(x)}finally{p.f()}}if(i.length){var y,m=i[0].getLength(),_=i[0],w=s(i);try{for(w.s();!(y=w.n()).done;){var b=y.value,k=b.getLength();k<m&&(m=k,_=b)}}catch(x){w.e(x)}finally{w.f()}return _}return null}},{key:"contains",value:function(t){var e,n=this.getColliders(),i=s(n);try{for(i.s();!(e=i.n()).done;)if(e.value.contains(t))return!0}catch(r){i.e(r)}finally{i.f()}return!1}},{key:"rayCast",value:function(t,e){var n,i=this.getColliders(),r=[],o=s(i);try{for(o.s();!(n=o.n()).done;){var a=n.value.rayCast(t,e);a&&r.push(a)}}catch(p){o.e(p)}finally{o.f()}if(r.length){var l,u=r[0],c=u.dot(t.dir),h=s(r);try{for(h.s();!(l=h.n()).done;){var d=l.value,f=t.dir.dot(d);f<c&&(u=d,c=f)}}catch(p){h.e(p)}finally{h.f()}return u}return null}},{key:"project",value:function(t){var e,n=this.getColliders(),i=[],r=s(n);try{for(r.s();!(e=r.n()).done;){var o=e.value.project(t);o&&i.push(o)}}catch(h){r.e(h)}finally{r.f()}if(i.length){var a,l=new Cn(i[0].min,i[0].max),u=s(i);try{for(u.s();!(a=u.n()).done;){var c=a.value;l.min=Math.min(c.min,l.min),l.max=Math.max(c.max,l.max)}}catch(h){u.e(h)}finally{u.f()}return l}return null}},{key:"update",value:function(t){if(t){var e,n=this.getColliders(),i=s(n);try{for(i.s();!(e=i.n()).done;){var r=e.value;r.owner=this.owner,r.update(t)}}catch(o){i.e(o)}finally{i.f()}}}},{key:"draw",value:function(t,e,n){var i,r=this.getColliders(),o=s(r);try{for(o.s();!(i=o.n()).done;)i.value.draw(t,e,n)}catch(a){o.e(a)}finally{o.f()}}},{key:"debug",value:function(t,e){var n,i=this.getColliders(),r=s(i);try{for(r.s();!(n=r.n()).done;)n.value.debug(t,e)}catch(o){r.e(o)}finally{r.f()}}},{key:"debugDraw",value:function(t,e){var n,i=this.getColliders(),r=s(i);try{for(r.s();!(n=r.n()).done;)n.value.draw(t,e)}catch(o){r.e(o)}finally{r.f()}}},{key:"clone",value:function(){return new n(this._colliders.map((function(t){return t.clone()})))}}]),n}(Tn),Dn=function(){function t(e,n){f(this,t),this.begin=e,this.end=n}return p(t,[{key:"slope",get:function(){return(this.end.y-this.begin.y)/(this.end.x-this.begin.x)}},{key:"intercept",get:function(){return this.begin.y-this.slope*this.begin.x}},{key:"normal",value:function(){return this.end.sub(this.begin).normal()}},{key:"dir",value:function(){return this.end.sub(this.begin)}},{key:"getPoints",value:function(){return[this.begin,this.end]}},{key:"getSlope",value:function(){var t=this.begin,e=this.end,n=t.distance(e);return e.sub(t).scale(1/n)}},{key:"getEdge",value:function(){var t=this.begin;return this.end.sub(t)}},{key:"getLength",value:function(){var t=this.begin,e=this.end;return t.distance(e)}},{key:"midpoint",get:function(){return this.begin.add(this.end).scale(.5)}},{key:"flip",value:function(){return new t(this.end,this.begin)}},{key:"below",value:function(t){return(this.end.x-this.begin.x)*(t.y-this.begin.y)-(this.end.y-this.begin.y)*(t.x-this.begin.x)>=0}},{key:"clip",value:function(e,n){var i=e,r=(i=i.normalize()).dot(this.begin)-n,o=i.dot(this.end)-n,a=[];if(r<=0&&a.push(this.begin),o<=0&&a.push(this.end),r*o<0){var s=r/(r-o);a.push(this.begin.add(this.end.sub(this.begin).scale(s)))}return 2!==a.length?null:new t(a[0],a[1])}},{key:"distanceToPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t.x,i=t.y,r=this.getLength(),o=((this.end.y-this.begin.y)*n-(this.end.x-this.begin.x)*i+this.end.x*this.begin.y-this.end.y*this.begin.x)/r;return e?o:Math.abs(o)}},{key:"findVectorToPoint",value:function(t){var e=this.begin.sub(t),n=this.getSlope();return e.sub(n.scale(e.dot(n)))}},{key:"findPoint",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.slope,i=this.intercept;if(null!==t)return new rt(t,n*t+i);if(null!==e)return new rt((e-i)/n,e);throw new Error("You must provide an X or a Y value")}},{key:"hasPoint",value:function(){var t,e=0;if("number"==typeof arguments[0]&&"number"==typeof arguments[1])t=new rt(arguments[0],arguments[1]),e=arguments[2]||0;else{if(!(arguments[0]instanceof rt))throw"Could not determine the arguments for Vector.hasPoint";t=arguments[0],e=arguments[1]||0}var n=t.x-this.begin.x,i=t.y-this.begin.y,r=this.end.x-this.begin.x,o=this.end.y-this.begin.y,a=n*o-i*r;return!(Math.abs(a)>e)&&(Math.abs(r)>=Math.abs(o)?r>0?this.begin.x<=t.x&&t.x<=this.end.x:this.end.x<=t.x&&t.x<=this.begin.x:o>0?this.begin.y<=t.y&&t.y<=this.end.y:this.end.y<=t.y&&t.y<=this.begin.y)}}]),t}();function Mn(t,e,n,i){var r=t.sub(n),o=e.dot(e),a=e.dot(i),s=i.dot(i),l=e.dot(r),u=i.dot(r),c=o*s-a*a,h=c,d=c;if(0===c||c<=.01){var f=l/a;return new Dn(t,n.add(i.scale(f)))}var p=a*u-s*l,v=o*u-a*l;return p<0?(p=0,v=u,d=s):p>h&&(p=h,v=u+a,d=s),v<0?(v=0,-l<0?p=0:-l>o?p=h:(p=-l,h=o)):v>d&&(v=d,-l+a<0?p=0:-l+a>o?p=h:(p=-l+a,h=o)),p=Math.abs(p)<.001?0:p/h,v=Math.abs(v)<.001?0:v/d,new Dn(t.add(e.scale(p)),n.add(i.scale(v)))}var Ln,Bn={PolygonPolygonClosestLine:function(t,e){var n=e.worldPos,i=n.sub(t.worldPos),r=i.negate(),o=new Pn(t.worldPos,i),a=new Pn(n,r),s=t.rayCast(o).add(o.dir.scale(.1)),l=e.rayCast(a).add(a.dir.scale(.1)),u=t.getClosestFace(s),c=e.getClosestFace(l);return Mn(u.face.begin,u.face.getEdge(),c.face.begin,c.face.getEdge())},PolygonEdgeClosestLine:function(t,e){var n=e.worldPos.sub(t.worldPos),i=new Pn(t.worldPos,n),r=t.rayCast(i).add(i.dir.scale(.1)),o=t.getClosestFace(r),a=o.face.begin,s=o.face.getEdge(),l=e.asLine();return Mn(a,s,l.begin,l.getEdge())},PolygonCircleClosestLine:function(t,e){var n=e.worldPos,i=n.sub(t.worldPos),r=new Pn(t.worldPos,i.normalize()),o=t.rayCast(r).add(r.dir.scale(.1)),a=t.getClosestFace(o),s=a.face.begin,l=a.face.getEdge(),u=(l.x*(n.x-s.x)+l.y*(n.y-s.y))/(l.x*l.x+l.y*l.y);u>1?u=1:u<0&&(u=0);var c=Math.sqrt(Math.pow(s.x+l.x*u-n.x,2)+Math.pow(s.y+l.y*u-n.y,2))-e.radius,h=(s.x+l.x*u-n.x)*e.radius/(e.radius+c),d=(s.y+l.y*u-n.y)*e.radius/(e.radius+c);return new Dn(l.scale(u).add(s),new rt(n.x+h,n.y+d))},CircleCircleClosestLine:function(t,e){var n=e.worldPos.sub(t.worldPos),i=t.worldPos.sub(e.worldPos),r=new Pn(t.worldPos,n),o=new Pn(e.worldPos,i),a=t.rayCast(r),s=e.rayCast(o);return new Dn(a,s)},CircleEdgeClosestLine:function(t,e){var n=t.worldPos,i=e.asLine(),r=i.begin,o=i.getEdge(),a=(o.x*(n.x-r.x)+o.y*(n.y-r.y))/(o.x*o.x+o.y*o.y);a>1?a=1:a<0&&(a=0);var s=Math.sqrt(Math.pow(r.x+o.x*a-n.x,2)+Math.pow(r.y+o.y*a-n.y,2))-t.radius,l=(r.x+o.x*a-n.x)*t.radius/(t.radius+s),u=(r.y+o.y*a-n.y)*t.radius/(t.radius+s);return new Dn(o.scale(a).add(r),new rt(n.x+l,n.y+u))},EdgeEdgeClosestLine:function(t,e){var n=t.asLine(),i=n.begin,r=n.getEdge(),o=e.asLine();return Mn(i,r,o.begin,o.getEdge())}},On=function(t){h(n,t);var e=d(n);function n(t){var i;return f(this,n),(i=e.call(this)).offset=rt.Zero,i.offset=t.offset||rt.Zero,i.radius=t.radius||0,i}return p(n,[{key:"worldPos",get:function(){var t,e;return this.offset.add(null!==(e=null===(t=this._transform)||void 0===t?void 0:t.pos)&&void 0!==e?e:rt.Zero)}},{key:"clone",value:function(){return new n({offset:this.offset.clone(),radius:this.radius})}},{key:"center",get:function(){var t,e;return this.offset.add(null!==(e=null===(t=this._transform)||void 0===t?void 0:t.pos)&&void 0!==e?e:rt.Zero)}},{key:"contains",value:function(t){var e,n;return(null!==(n=null===(e=this._transform)||void 0===e?void 0:e.pos)&&void 0!==n?n:this.offset).distance(t)<=this.radius}},{key:"rayCast",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,n=this.center,i=t.dir,r=t.pos,o=Math.sqrt(Math.pow(i.dot(r.sub(n)),2)-Math.pow(r.sub(n).distance(),2)+Math.pow(this.radius,2));if(o<0)return null;var a=0;if(0===o)return(a=-i.dot(r.sub(n)))>0&&a<e?t.getPoint(a):null;var s=-i.dot(r.sub(n))+o,l=-i.dot(r.sub(n))-o,u=[];s>=0&&u.push(s),l>=0&&u.push(l);var c=Math.min.apply(Math,u);return c<=e?t.getPoint(c):null}},{key:"getClosestLineBetween",value:function(t){if(t instanceof n)return Bn.CircleCircleClosestLine(this,t);if(t instanceof Un)return Bn.PolygonCircleClosestLine(t,this).flip();if(t instanceof Nn)return Bn.CircleEdgeClosestLine(this,t).flip();throw new Error("Polygon could not collide with unknown CollisionShape "+typeof t)}},{key:"collide",value:function(t){if(t instanceof n)return zn.CollideCircleCircle(this,t);if(t instanceof Un)return zn.CollideCirclePolygon(this,t);if(t instanceof Nn)return zn.CollideCircleEdge(this,t);throw new Error("Circle could not collide with unknown CollisionShape "+typeof t)}},{key:"getFurthestPoint",value:function(t){return this.center.add(t.normalize().scale(this.radius))}},{key:"getFurthestLocalPoint",value:function(t){return t.normalize().scale(this.radius)}},{key:"bounds",get:function(){var t,e=this._transform,n=null!==(t=null==e?void 0:e.globalPos)&&void 0!==t?t:rt.Zero;return new ht(this.offset.x+n.x-this.radius,this.offset.y+n.y-this.radius,this.offset.x+n.x+this.radius,this.offset.y+n.y+this.radius)}},{key:"localBounds",get:function(){return new ht(this.offset.x-this.radius,this.offset.y-this.radius,this.offset.x+this.radius,this.offset.y+this.radius)}},{key:"axes",get:function(){return[]}},{key:"getInertia",value:function(t){return t*this.radius*this.radius/2}},{key:"update",value:function(t){this._transform=t}},{key:"project",value:function(t){var e=[],n=this.center.dot(t);return e.push(n),e.push(n+this.radius),e.push(n-this.radius),new Cn(Math.min.apply(Math,e),Math.max.apply(Math,e))}},{key:"draw",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ut.Green,n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:rt.Zero).add(this.offset);t.beginPath(),t.fillStyle=e.toString(),t.arc(n.x,n.y,this.radius,0,2*Math.PI),t.closePath(),t.fill()}},{key:"debug",value:function(t,e){var n=this._transform,i=(null==n?void 0:n.globalPos)?null==n?void 0:n.globalPos.add(this.offset):this.offset;t.drawCircle(i,this.radius,e)}},{key:"debugDraw",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ut.Green,n=this._transform,i=n?n.pos.add(this.offset):this.offset,r=n?n.rotation:0;t.beginPath(),t.strokeStyle=e.toString(),t.arc(i.x,i.y,this.radius,0,2*Math.PI),t.closePath(),t.stroke(),t.beginPath(),t.moveTo(i.x,i.y),t.lineTo(Math.cos(r)*this.radius+i.x,Math.sin(r)*this.radius+i.y),t.closePath(),t.stroke()}}]),n}(Tn),Fn=function(){function t(e,n,i,r,o,a,s,l){f(this,t),this._canceled=!1,this.colliderA=e,this.colliderB=n,this.mtv=i,this.normal=r,this.tangent=o,this.points=a,this.localPoints=s,this.info=l,this.id=xn.calculatePairHash(e.id,n.id)}return p(t,[{key:"matchAwake",value:function(){var t=this.colliderA.owner.get(jn),e=this.colliderB.owner.get(jn);t&&e&&t.sleeping!==e.sleeping&&(t.sleeping&&t.collisionType!==Je.Fixed&&e.sleepMotion>=wn.wakeThreshold&&t.setSleeping(!1),e.sleeping&&e.collisionType!==Je.Fixed&&t.sleepMotion>=wn.wakeThreshold&&e.setSleeping(!1))}},{key:"isCanceled",value:function(){return this._canceled}},{key:"cancel",value:function(){this._canceled=!0}}]),t}(),In=function(){function t(){f(this,t)}return p(t,null,[{key:"findPolygonPolygonSeparation",value:function(t,e){for(var n=-Number.MAX_VALUE,i=null,r=null,o=-1,a=null,s=t.getSides(),l=t.getLocalSides(),u=0;u<s.length;u++){var c=s[u],h=c.normal(),d=e.getFurthestPoint(h.negate()),f=c.distanceToPoint(d,!0);f>n&&(n=f,i=c,r=h,o=u,a=d)}return{collider:t,separation:r?n:99,axis:r,side:i,localSide:l[o],sideId:o,point:a,localPoint:r?e.getFurthestLocalPoint(r.negate()):null}}},{key:"findCirclePolygonSeparation",value:function(t,e){var n=e.axes,i=e.center.sub(t.worldPos),r=e.getFurthestPoint(i.negate());n.push(r.sub(t.worldPos).normalize());for(var o=Number.MAX_VALUE,a=null,s=-1,l=0;l<n.length;l++){var u=e.project(n[l]),c=t.project(n[l]),h=u.getOverlap(c);if(h<=0)return null;h<o&&(o=h,a=n[l],s=l)}return s<0?null:a.normalize().scale(o)}}]),t}(),zn={CollideCircleCircle:function(t,e){var n=t.worldPos,i=e.worldPos,r=t.radius+e.radius,o=n.distance(i);if(o>r)return[];var a=r-o,s=i.sub(n).normalize(),l=s.perpendicular(),u=s.scale(a),c=t.getFurthestPoint(s),h=t.getFurthestLocalPoint(s);return[new Fn(t,e,u,s,l,[c],[h],{collider:t,separation:a,axis:s,point:c})]},CollideCirclePolygon:function(t,e){var n,i,r=In.findCirclePolygonSeparation(t,e);if(!r)return[];var o=r.dot(e.center.sub(t.center));r=o<0?r.negate():r;var a=t.getFurthestPoint(r),s=(null!==(i=null===(n=t.owner)||void 0===n?void 0:n.get(rn))&&void 0!==i?i:new rn).applyInverse(a),l=r.normalize(),u={collider:t,separation:-r.size,axis:l,point:a,localPoint:s,side:e.findSide(l.negate()),localSide:e.findLocalSide(l.negate())};return[new Fn(t,e,r,l,l.perpendicular(),[a],[s],u)]},CollideCircleEdge:function(t,e){var n=t.center,i=e.asLine(),r=i.end.sub(i.begin),o=r.dot(i.end.sub(n)),a=r.dot(n.sub(i.begin)),s=e.asLine(),l=e.asLocalLine();if(a<=0){var u=i.begin.sub(n),c=u.dot(u);if(c>t.radius*t.radius)return[];var h=u.normalize(),d=t.radius-Math.sqrt(c),f={collider:t,separation:d,axis:h,point:s.begin,side:s,localSide:l};return[new Fn(t,e,h.scale(d),h,h.perpendicular(),[s.begin],[l.begin],f)]}if(o<=0){var p=i.end.sub(n),v=p.dot(p);if(v>t.radius*t.radius)return[];var g=p.normalize(),y=t.radius-Math.sqrt(v),m={collider:t,separation:y,axis:g,point:s.end,side:s,localSide:l};return[new Fn(t,e,g.scale(y),g,g.perpendicular(),[s.end],[l.end],m)]}var _=r.dot(r),w=i.begin.scale(o).add(i.end.scale(a)).scale(1/_),b=n.sub(w),k=b.dot(b);if(k>t.radius*t.radius)return[];var x=r.perpendicular();x.dot(n.sub(i.begin))<0&&(x.x=-x.x,x.y=-x.y),x=x.normalize();var C=t.radius-Math.sqrt(k),S=x.scale(C),E={collider:t,separation:C,axis:x,point:w,side:s,localSide:l};return[new Fn(t,e,S,x.negate(),x.negate().perpendicular(),[w],[w.sub(e.worldPos)],E)]},CollideEdgeEdge:function(){return[]},CollidePolygonEdge:function(t,e){var n,i=t.center,r=e.center.sub(i).normalize(),o=new Un({points:[e.begin,e.end,e.end.add(r.scale(100)),e.begin.add(r.scale(100))],offset:e.offset});o.owner=e.owner,(null===(n=e.owner)||void 0===n?void 0:n.get(rn))&&o.update(e.owner.get(rn));var a=this.CollidePolygonPolygon(t,o);return a.length&&(a[0].colliderB=e,a[0].id=xn.calculatePairHash(t.id,e.id)),a},CollidePolygonPolygon:function(t,e){var n,i,r,o,a=In.findPolygonPolygonSeparation(t,e);if(a.separation>0)return[];var s=In.findPolygonPolygonSeparation(e,t);if(s.separation>0)return[];var l=a.separation>s.separation?a:s,u=(l.collider===t?e:t).findSide(l.axis.negate()),c=l.side,h=c.dir().normalize(),d=u.clip(h.negate(),-h.dot(c.begin)),f=null;if(d&&(f=d.clip(h,h.dot(c.end))),f){var p=f.getPoints().filter((function(t){return c.below(t)})),v=l.axis,g=v.perpendicular();e.worldPos.sub(t.worldPos).dot(v)<0&&(g=(v=v.negate()).perpendicular());var y=[];if(l.collider===t){var m=null!==(i=null===(n=e.owner)||void 0===n?void 0:n.get(rn))&&void 0!==i?i:new rn;y=p.map((function(t){return m.applyInverse(t)}))}else{var _=null!==(o=null===(r=t.owner)||void 0===r?void 0:r.get(rn))&&void 0!==o?o:new rn;y=p.map((function(t){return _.applyInverse(t)}))}return[new Fn(t,e,v.scale(-l.separation),v,g,p,y,l)]}return[]},FindContactSeparation:function(t,e){var n,i,r,o,a,s,l,u=t.colliderA,c=null!==(i=null===(n=t.colliderA.owner)||void 0===n?void 0:n.get(rn))&&void 0!==i?i:new rn,h=t.colliderB,d=null!==(o=null===(r=t.colliderB.owner)||void 0===r?void 0:r.get(rn))&&void 0!==o?o:new rn;if(u instanceof On&&h instanceof On)return-(u.radius+h.radius-c.pos.distance(d.pos));if(u instanceof Un&&h instanceof Un&&t.info.localSide)return t.info.collider===u?(a=new Dn(c.apply(t.info.localSide.begin),c.apply(t.info.localSide.end)),s=d.apply(e)):(a=new Dn(d.apply(t.info.localSide.begin),d.apply(t.info.localSide.end)),s=c.apply(e)),a.distanceToPoint(s,!0);if(u instanceof Un&&h instanceof On||h instanceof Un&&u instanceof On){var f=c.apply(e);if(t.info.side)return t.info.side.distanceToPoint(f,!0)}if((u instanceof Nn&&h instanceof Un||h instanceof Nn&&u instanceof Un)&&(l=t.info.collider===u?d.apply(e):c.apply(e),t.info.side))return t.info.side.distanceToPoint(l,!0);if(u instanceof On&&h instanceof Nn||h instanceof On&&u instanceof Nn){var p,v=d.apply(e);u instanceof On&&(p=u.getFurthestPoint(t.normal));var g=v.distance(p);if(t.info.side)return g>0?-g:0}return 0}},Nn=function(t){h(n,t);var e=d(n);function n(t){var i,r;return f(this,n),(i=e.call(this)).begin=t.begin||rt.Zero,i.end=t.end||rt.Zero,i.offset=null!==(r=t.offset)&&void 0!==r?r:rt.Zero,i}return p(n,[{key:"clone",value:function(){return new n({begin:this.begin.clone(),end:this.end.clone()})}},{key:"worldPos",get:function(){var t,e=this._transform;return null!==(t=null==e?void 0:e.globalPos.add(this.offset))&&void 0!==t?t:this.offset}},{key:"center",get:function(){return this.begin.average(this.end).add(this._getBodyPos())}},{key:"_getBodyPos",value:function(){var t,e=this._transform;return null!==(t=null==e?void 0:e.globalPos)&&void 0!==t?t:rt.Zero}},{key:"_getTransformedBegin",value:function(){var t=this._transform,e=t?t.globalRotation:0;return this.begin.rotate(e).add(this._getBodyPos())}},{key:"_getTransformedEnd",value:function(){var t=this._transform,e=t?t.globalRotation:0;return this.end.rotate(e).add(this._getBodyPos())}},{key:"getSlope",value:function(){var t=this._getTransformedBegin(),e=this._getTransformedEnd(),n=t.distance(e);return e.sub(t).scale(1/n)}},{key:"getLength",value:function(){var t=this._getTransformedBegin(),e=this._getTransformedEnd();return t.distance(e)}},{key:"contains",value:function(){return!1}},{key:"rayCast",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,n=this._getTransformedBegin().sub(t.pos);if(0===t.dir.cross(this.getSlope())&&0!==n.cross(t.dir))return null;var i=t.dir.cross(this.getSlope());if(0===i)return null;var r=n.cross(this.getSlope())/i;if(r>=0&&r<=e){var o=n.cross(t.dir)/i/this.getLength();if(o>=0&&o<=1)return t.getPoint(r)}return null}},{key:"getClosestLineBetween",value:function(t){if(t instanceof On)return Bn.CircleEdgeClosestLine(t,this);if(t instanceof Un)return Bn.PolygonEdgeClosestLine(t,this).flip();if(t instanceof n)return Bn.EdgeEdgeClosestLine(this,t);throw new Error("Polygon could not collide with unknown CollisionShape "+typeof t)}},{key:"collide",value:function(t){if(t instanceof On)return zn.CollideCircleEdge(t,this);if(t instanceof Un)return zn.CollidePolygonEdge(t,this);if(t instanceof n)return zn.CollideEdgeEdge();throw new Error("Edge could not collide with unknown CollisionShape "+typeof t)}},{key:"getFurthestPoint",value:function(t){var e=this._getTransformedBegin(),n=this._getTransformedEnd();return t.dot(e)>0?e:n}},{key:"_boundsFromBeginEnd",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;return new ht(Math.min(t.x,e.x)-n,Math.min(t.y,e.y)-n,Math.max(t.x,e.x)+n,Math.max(t.y,e.y)+n)}},{key:"bounds",get:function(){var t=this._getTransformedBegin(),e=this._getTransformedEnd();return this._boundsFromBeginEnd(t,e)}},{key:"localBounds",get:function(){return this._boundsFromBeginEnd(this.begin,this.end)}},{key:"asLine",value:function(){return new Dn(this._getTransformedBegin(),this._getTransformedEnd())}},{key:"asLocalLine",value:function(){return new Dn(this.begin,this.end)}},{key:"axes",get:function(){var t=this._getTransformedEnd().sub(this._getTransformedBegin()).normal(),e=[];return e.push(t),e.push(t.negate()),e.push(t.normal()),e.push(t.normal().negate()),e}},{key:"getInertia",value:function(t){var e=this.end.sub(this.begin).distance()/2;return t*e*e}},{key:"update",value:function(t){this._transform=t}},{key:"project",value:function(t){for(var e=[],n=[this._getTransformedBegin(),this._getTransformedEnd()],i=n.length,r=0;r<i;r++)e.push(n[r].dot(t));return new Cn(Math.min.apply(Math,e),Math.max.apply(Math,e))}},{key:"draw",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ut.Green,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:rt.Zero,i=this.begin.add(n),r=this.end.add(n);t.strokeStyle=e.toString(),t.beginPath(),t.moveTo(i.x,i.y),t.lineTo(r.x,r.y),t.closePath(),t.stroke()}},{key:"debug",value:function(t,e){var n=this._getTransformedBegin(),i=this._getTransformedEnd();t.drawLine(n,i,e,2),t.drawCircle(n,2,e),t.drawCircle(i,2,e)}},{key:"debugDraw",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ut.Red,n=this._getTransformedBegin(),i=this._getTransformedEnd();t.strokeStyle=e.toString(),t.beginPath(),t.moveTo(n.x,n.y),t.lineTo(i.x,i.y),t.closePath(),t.stroke()}}]),n}(Tn),Un=function(t){h(n,t);var e=d(n);function n(t){var i,r;f(this,n),(i=e.call(this))._transformedPoints=[],i._axes=[],i._sides=[],i._localSides=[],i.offset=null!==(r=t.offset)&&void 0!==r?r:rt.Zero;var o=!!t.clockwiseWinding;return i.points=(o?t.points.reverse():t.points)||[],i._calculateTransformation(),i}return p(n,[{key:"clone",value:function(){return new n({offset:this.offset.clone(),points:this.points.map((function(t){return t.clone()}))})}},{key:"worldPos",get:function(){return this._transform?this._transform.pos.add(this.offset):this.offset}},{key:"center",get:function(){return this.bounds.center}},{key:"_calculateTransformation",value:function(){var t=this._transform,e=t?t.globalPos.add(this.offset):this.offset,n=t?t.globalRotation:0,i=t?t.globalScale:rt.One,r=this.points.length;this._transformedPoints.length=0;for(var o=0;o<r;o++)this._transformedPoints[o]=this.points[o].scale(i).rotate(n).add(e)}},{key:"getTransformedPoints",value:function(){return this._calculateTransformation(),this._transformedPoints}},{key:"getSides",value:function(){if(this._sides.length)return this._sides;for(var t=[],e=this.getTransformedPoints(),n=e.length,i=0;i<n;i++)t.push(new Dn(e[i],e[(i+1)%n]));return this._sides=t,this._sides}},{key:"getLocalSides",value:function(){if(this._localSides.length)return this._localSides;for(var t=[],e=this.points,n=e.length,i=0;i<n;i++)t.push(new Dn(e[i],e[(i+1)%n]));return this._localSides=t,this._localSides}},{key:"findSide",value:function(t){for(var e=this.getSides(),n=e[0],i=-Number.MAX_VALUE,r=0;r<e.length;r++){var o=e[r],a=o.normal().dot(t);a>i&&(n=o,i=a)}return n}},{key:"findLocalSide",value:function(t){for(var e=this.getLocalSides(),n=e[0],i=-Number.MAX_VALUE,r=0;r<e.length;r++){var o=e[r],a=o.normal().dot(t);a>i&&(n=o,i=a)}return n}},{key:"axes",get:function(){if(this._axes.length)return this._axes;var t=this.getSides().map((function(t){return t.normal()}));return this._axes=t,this._axes}},{key:"update",value:function(t){this._transform=t,this._sides.length=0,this._localSides.length=0,this._axes.length=0,this._transformedPoints.length=0,this.getTransformedPoints(),this.getSides(),this.getLocalSides()}},{key:"contains",value:function(t){var e=new Pn(t,new rt(1,0));return this.getSides().reduce((function(t,n){return e.intersect(n)>=0?t+1:t}),0)%2!=0}},{key:"getClosestLineBetween",value:function(t){if(t instanceof On)return Bn.PolygonCircleClosestLine(this,t);if(t instanceof n)return Bn.PolygonPolygonClosestLine(this,t);if(t instanceof Nn)return Bn.PolygonEdgeClosestLine(this,t);throw new Error("Polygon could not collide with unknown CollisionShape "+typeof t)}},{key:"collide",value:function(t){if(t instanceof On)return zn.CollideCirclePolygon(t,this);if(t instanceof n)return zn.CollidePolygonPolygon(this,t);if(t instanceof Nn)return zn.CollidePolygonEdge(this,t);throw new Error("Polygon could not collide with unknown CollisionShape "+typeof t)}},{key:"getFurthestPoint",value:function(t){for(var e=this.getTransformedPoints(),n=null,i=-Number.MAX_VALUE,r=0;r<e.length;r++){var o=t.dot(e[r]);o>i&&(i=o,n=e[r])}return n}},{key:"getFurthestLocalPoint",value:function(t){for(var e=this.points,n=e[0],i=-Number.MAX_VALUE,r=0;r<e.length;r++){var o=t.dot(e[r]);o>i&&(i=o,n=e[r])}return n}},{key:"getClosestFace",value:function(t){for(var e=this.getSides(),n=Number.POSITIVE_INFINITY,i=-1,r=-1,o=0;o<e.length;o++){var a=e[o].distanceToPoint(t);a<n&&(n=a,i=o,r=a)}return-1!==i?{distance:e[i].normal().scale(r),face:e[i]}:null}},{key:"bounds",get:function(){var t,e,n,i=this._transform,r=null!==(t=null==i?void 0:i.globalScale)&&void 0!==t?t:rt.One,o=null!==(e=null==i?void 0:i.globalRotation)&&void 0!==e?e:0,a=(null!==(n=null==i?void 0:i.globalPos)&&void 0!==n?n:rt.Zero).add(this.offset);return this.localBounds.scale(r).rotate(o).translate(a)}},{key:"localBounds",get:function(){return ht.fromPoints(this.points)}},{key:"getInertia",value:function(t){for(var e=0,n=0,i=0;i<this.points.length;i++){var r=(i+1)%this.points.length,o=this.points[r].cross(this.points[i]);e+=o*(this.points[i].dot(this.points[i])+this.points[i].dot(this.points[r])+this.points[r].dot(this.points[r])),n+=o}return t/6*(e/n)}},{key:"rayCast",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,n=this.getSides(),i=n.length,r=Number.MAX_VALUE,o=-1,a=0;a<i;a++){var s=t.intersect(n[a]);s>=0&&s<r&&s<=e&&(r=s,o=a)}return o>=0?t.getPoint(r):null}},{key:"project",value:function(t){for(var e=this.getTransformedPoints(),n=e.length,i=Number.MAX_VALUE,r=-Number.MAX_VALUE,o=0;o<n;o++){var a=e[o].dot(t);i=Math.min(i,a),r=Math.max(r,a)}return new Cn(i,r)}},{key:"draw",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ut.Green,n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:rt.Zero).add(this.offset);t.beginPath(),t.fillStyle=e.toString();var i=this.points[0].add(n);t.moveTo(i.x,i.y),this.points.map((function(t){return t.add(n)})).forEach((function(e){t.lineTo(e.x,e.y)})),t.lineTo(i.x,i.y),t.closePath(),t.fill()}},{key:"debug",value:function(t,e){for(var n=this.getTransformedPoints()[0],i=[n].concat(a(this.getTransformedPoints()),[n]),r=0;r<i.length-1;r++)t.drawLine(i[r],i[r+1],e,2),t.drawCircle(i[r],2,e),t.drawCircle(i[r+1],2,e)}},{key:"debugDraw",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ut.Red;t.beginPath(),t.strokeStyle=e.toString();var n=this.getTransformedPoints()[0];t.moveTo(n.x,n.y),this.getTransformedPoints().forEach((function(e){t.lineTo(e.x,e.y)})),t.lineTo(n.x,n.y),t.closePath(),t.stroke()}}]),n}(Tn),Hn=function(){function t(){f(this,t)}return p(t,null,[{key:"Box",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:rt.Half,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:rt.Zero;return new Un({points:new ht(-t*n.x,-e*n.y,t-t*n.x,e-e*n.y).getPoints(),offset:i})}},{key:"Polygon",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:rt.Zero;return new Un({points:t,offset:n,clockwiseWinding:e})}},{key:"Circle",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:rt.Zero;return new On({radius:t,offset:e})}},{key:"Edge",value:function(t,e){return new Nn({begin:t,end:e})}},{key:"Capsule",value:function(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:rt.Zero,r=P.getInstance();return e===n&&r.warn("A capsule collider with equal width and height is a circle, consider using a ex.Shape.Circle or ex.CircleCollider"),new Rn(n>=e?[t.Circle(e/2,ot(0,-n/2+e/2).add(i)),t.Box(e,n-e,rt.Half,i),t.Circle(e/2,ot(0,n/2-e/2).add(i))]:[t.Circle(n/2,ot(-e/2+n/2,0).add(i)),t.Box(e-n,n,rt.Half,i),t.Circle(n/2,ot(e/2-n/2,0).add(i))])}}]),t}(),Wn=function(t){h(n,t);var e=d(n);function n(t){var i;return f(this,n),(i=e.call(this)).type="ex.collider",i.events=new Jt(c(i)),i.$colliderAdded=new kn,i.$colliderRemoved=new kn,i.set(t),i}return p(n,[{key:"get",value:function(){return this._collider}},{key:"set",value:function(t){return this.clear(),t&&(this._collider=t,this._collider.owner=this.owner,this.events.wire(t.events),this.$colliderAdded.notifyAll(t),this.update()),t}},{key:"clear",value:function(){this._collider&&(this.events.unwire(this._collider.events),this.$colliderRemoved.notifyAll(this._collider),this._collider.owner=null,this._collider=null)}},{key:"bounds",get:function(){var t,e;return null!==(e=null===(t=this._collider)||void 0===t?void 0:t.bounds)&&void 0!==e?e:new ht}},{key:"localBounds",get:function(){var t,e;return null!==(e=null===(t=this._collider)||void 0===t?void 0:t.localBounds)&&void 0!==e?e:new ht}},{key:"update",value:function(){var t,e=null===(t=this.owner)||void 0===t?void 0:t.get(rn);this._collider&&(this._collider.owner=this.owner,e&&this._collider.update(e))}},{key:"collide",value:function(t){var e=this,n=this._collider,i=t._collider;if(!n||!i)return[];var r=!1;if(i instanceof Rn&&(n=i,i=this._collider,r=!0),this._collider){var o=n.collide(i);return o?(r&&o.forEach((function(n){n.mtv=n.mtv.negate(),n.normal=n.normal.negate(),n.tangent=n.normal.perpendicular(),n.colliderA=e._collider,n.colliderB=t._collider})),o):[]}return[]}},{key:"onAdd",value:function(t){this._collider&&this.update(),this.events.on("precollision",(function(e){var n=e;t.events.emit("precollision",new zt(n.target.owner,n.other.owner,n.side,n.intersection))})),this.events.on("postcollision",(function(e){var n=e;t.events.emit("postcollision",new Nt(n.target.owner,n.other.owner,n.side,n.intersection))})),this.events.on("collisionstart",(function(e){var n=e;t.events.emit("collisionstart",new Vt(n.target.owner,n.other.owner,n.contact))})),this.events.on("collisionend",(function(e){var n=e;t.events.emit("collisionend",new Gt(n.target.owner,n.other.owner))}))}},{key:"onRemove",value:function(){this.events.clear(),this.$colliderRemoved.notifyAll(this._collider)}},{key:"useBoxCollider",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:rt.Half,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:rt.Zero,r=Hn.Box(t,e,n,i);return this.set(r)}},{key:"usePolygonCollider",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:rt.Zero,n=Hn.Polygon(t,!1,e);return this.set(n)}},{key:"useCircleCollider",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:rt.Zero,n=Hn.Circle(t,e);return this.set(n)}},{key:"useEdgeCollider",value:function(t,e){var n=Hn.Edge(t,e);return this.set(n)}},{key:"useCompositeCollider",value:function(t){return this.set(new Rn(t))}}]),n}(Qe);!function(t){t.Rotation="rotation",t.X="x",t.Y="y"}(Ln||(Ln={}));var jn=function(t){h(n,t);var e=d(n);function n(t){var i,r,o,a;return f(this,n),(i=e.call(this)).type="ex.body",i.dependencies=[rn,Ze],i.id=E("body",n._ID++),i.events=new Jt(c(i)),i.collisionType=Je.PreventCollision,i.group=bn.All,i.mass=wn.defaultMass,i.sleepMotion=5*wn.sleepEpsilon,i.canSleep=wn.bodiesCanSleepByDefault,i._sleeping=!1,i.bounciness=.2,i.friction=.99,i.useGravity=!0,i.limitDegreeOfFreedom=[],i.oldPos=new rt(0,0),i.oldVel=new rt(0,0),i.oldAcc=rt.Zero,i.oldRotation=0,i.oldScale=rt.One,t&&(i.collisionType=null!==(r=t.type)&&void 0!==r?r:i.collisionType,i.group=null!==(o=t.group)&&void 0!==o?o:i.group,i.useGravity=null!==(a=t.useGravity)&&void 0!==a?a:i.useGravity),i}return p(n,[{key:"inverseMass",get:function(){return this.collisionType===Je.Fixed?0:1/this.mass}},{key:"sleeping",get:function(){return this._sleeping}},{key:"setSleeping",value:function(t){this._sleeping=t,t?(this.vel=rt.Zero,this.acc=rt.Zero,this.angularVelocity=0,this.sleepMotion=0):this.sleepMotion=5*wn.sleepEpsilon}},{key:"updateMotion",value:function(){this._sleeping&&this.setSleeping(!0);var t=this.vel.size*this.vel.size+Math.abs(this.angularVelocity*this.angularVelocity),e=wn.sleepBias;this.sleepMotion=e*this.sleepMotion+(1-e)*t,this.sleepMotion=F(this.sleepMotion,0,10*wn.sleepEpsilon),this.canSleep&&this.sleepMotion<wn.sleepEpsilon&&this.setSleeping(!0)}},{key:"inertia",get:function(){var t=this.owner.get(Wn);return(null==t?void 0:t.get())?t.get().getInertia(this.mass):0}},{key:"inverseInertia",get:function(){return this.collisionType===Je.Fixed?0:1/this.inertia}},{key:"active",get:function(){var t;return!!(null===(t=this.owner)||void 0===t?void 0:t.active)}},{key:"center",get:function(){return this.pos}},{key:"transform",get:function(){var t;return null===(t=this.owner)||void 0===t?void 0:t.get(rn)}},{key:"motion",get:function(){var t;return null===(t=this.owner)||void 0===t?void 0:t.get(Ze)}},{key:"pos",get:function(){return this.transform.globalPos},set:function(t){this.transform.globalPos=t}},{key:"vel",get:function(){return this.motion.vel},set:function(t){this.motion.vel=t}},{key:"acc",get:function(){return this.motion.acc},set:function(t){this.motion.acc=t}},{key:"torque",get:function(){return this.motion.torque},set:function(t){this.motion.torque=t}},{key:"rotation",get:function(){return this.transform.globalRotation},set:function(t){this.transform.globalRotation=t}},{key:"scale",get:function(){return this.transform.globalScale},set:function(t){this.transform.globalScale=t}},{key:"sx",get:function(){return this.motion.scaleFactor.x},set:function(t){this.motion.scaleFactor.x=t}},{key:"sy",get:function(){return this.motion.scaleFactor.y},set:function(t){this.motion.scaleFactor.y=t}},{key:"rx",get:function(){return this.motion.angularVelocity},set:function(t){this.motion.angularVelocity=t}},{key:"angularVelocity",get:function(){return this.motion.angularVelocity},set:function(t){this.motion.angularVelocity=t}},{key:"applyImpulse",value:function(t,e){if(this.collisionType===Je.Active){var n=e.scale(this.inverseMass);if(this.limitDegreeOfFreedom.includes(Ln.X)&&(n.x=0),this.limitDegreeOfFreedom.includes(Ln.Y)&&(n.y=0),this.vel.addEqual(n),!this.limitDegreeOfFreedom.includes(Ln.Rotation)){var i=t.sub(this.pos);this.angularVelocity+=this.inverseInertia*i.cross(e)}}}},{key:"applyLinearImpulse",value:function(t){if(this.collisionType===Je.Active){var e=t.scale(this.inverseMass);this.limitDegreeOfFreedom.includes(Ln.X)&&(e.x=0),this.limitDegreeOfFreedom.includes(Ln.Y)&&(e.y=0),this.vel=this.vel.add(e)}}},{key:"applyAngularImpulse",value:function(t,e){if(this.collisionType===Je.Active&&!this.limitDegreeOfFreedom.includes(Ln.Rotation)){var n=t.sub(this.pos);this.angularVelocity+=this.inverseInertia*n.cross(e)}}},{key:"captureOldTransform",value:function(){this.oldVel.setTo(this.vel.x,this.vel.y),this.oldPos.setTo(this.pos.x,this.pos.y),this.oldAcc.setTo(this.acc.x,this.acc.y),this.oldScale.setTo(this.scale.x,this.scale.y),this.oldRotation=this.rotation}},{key:"debugDraw",value:function(t){}}]),n}(Qe);jn._ID=0;var Vn=function(){function t(){f(this,t),this._topLeft=new rt(0,0),this._topRight=new rt(0,0),this._bottomLeft=new rt(0,0),this._bottomRight=new rt(0,0)}return p(t,[{key:"isSpriteOffScreen",value:function(t,e){var n=t.currentDrawing.drawWidth,i=t.currentDrawing.drawHeight,r=t.rotation,o=t.center,a=t.getGlobalPos();this._topLeft=ot(a.x-n/2,a.y-i/2),this._topLeft=this._topLeft.rotate(r,o),this._topRight=ot(a.x+n/2,a.y-i/2),this._topRight=this._topRight.rotate(r,o),this._bottomLeft=ot(a.x-n/2,a.y+i/2),this._bottomLeft=this._bottomLeft.rotate(r,o),this._bottomRight=ot(a.x+n/2,a.y+i/2),this._bottomRight=this._bottomRight.rotate(r,o);var s=e.worldToScreenCoordinates(this._topLeft),l=e.worldToScreenCoordinates(this._topRight),u=e.worldToScreenCoordinates(this._bottomLeft),c=e.worldToScreenCoordinates(this._bottomRight);this._xCoords=[],this._yCoords=[],this._xCoords.push(s.x,l.x,u.x,c.x),this._yCoords.push(s.y,l.y,u.y,c.y),this._xMin=Math.min.apply(null,this._xCoords),this._yMin=Math.min.apply(null,this._yCoords),this._xMax=Math.max.apply(null,this._xCoords),this._yMax=Math.max.apply(null,this._yCoords);var h=e.screenToWorldCoordinates(new rt(this._xMin,this._yMin)),d=e.screenToWorldCoordinates(new rt(this._xMax,this._yMax));this._xMinWorld=h.x,this._yMinWorld=h.y,this._xMaxWorld=d.x,this._yMaxWorld=d.y;var f=[new rt(this._xMin,this._yMin),new rt(this._xMax,this._yMin),new rt(this._xMin,this._yMax),new rt(this._xMax,this._yMax)];if(f[0].x<0&&f[1].x>e.canvas.clientWidth&&(f[0].y>0||f[2].y<e.canvas.clientHeight))return!1;if(f[0].y<0&&f[2].y>e.canvas.clientHeight&&(f[1].x>0||f[0].x<e.canvas.clientWidth))return!1;for(var p=0;p<f.length;p++)if(f[p].x>0&&f[p].y>0&&f[p].x<e.canvas.clientWidth&&f[p].y<e.canvas.clientHeight)return!1;return!0}},{key:"debugDraw",value:function(t){t.beginPath(),t.strokeStyle=ut.White.toString(),t.rect(this._xMinWorld,this._yMinWorld,this._xMaxWorld-this._xMinWorld,this._yMaxWorld-this._yMinWorld),t.stroke(),t.fillStyle=ut.Red.toString(),t.beginPath(),t.arc(this._topLeft.x,this._topLeft.y,5,0,2*Math.PI),t.closePath(),t.fill(),t.fillStyle=ut.Green.toString(),t.beginPath(),t.arc(this._topRight.x,this._topRight.y,5,0,2*Math.PI),t.closePath(),t.fill(),t.fillStyle=ut.Blue.toString(),t.beginPath(),t.arc(this._bottomLeft.x,this._bottomLeft.y,5,0,2*Math.PI),t.closePath(),t.fill(),t.fillStyle=ut.Magenta.toString(),t.beginPath(),t.arc(this._bottomRight.x,this._bottomRight.y,5,0,2*Math.PI),t.closePath(),t.fill()}}]),t}(),Gn=function(){function t(){f(this,t),this.cullingBox=new Vn}return p(t,[{key:"update",value:function(t,e){var n=t.eventDispatcher,i=!0;null!=t.currentDrawing&&(i=this.cullingBox.isSpriteOffScreen(t,e));var r=!1;e&&e.currentScene&&e.currentScene.camera&&e.currentScene.camera.viewport&&!t.parent&&(r=!e.currentScene.camera.viewport.intersect(t.collider.bounds)),t.isOffScreen?r&&i||(n.emit("enterviewport",new Yt(t)),t.removeComponent("offscreen")):r&&i&&(n.emit("exitviewport",new Qt(t)),t.addComponent(new Ye("offscreen")))}}]),t}(),Xn=function(){function t(){f(this,t)}return p(t,[{key:"update",value:function(t,e){t.enableCapturePointer&&(t.isKilled()||e.input.pointers.checkAndUpdateActorUnderPointer(t))}}]),t}(),qn=function t(e){f(this,t),this.data=e,this.type="Component Added"};function Kn(t){return!!t&&"Component Added"===t.type}var Qn=function t(e){f(this,t),this.data=e,this.type="Component Removed"};function Yn(t){return!!t&&"Component Removed"===t.type}var Zn=function(t){h(n,t);var e=d(n);function n(t,r){var o;if(f(this,n),(o=e.call(this)).id=n._ID++,o._name="anonymous",o.active=!0,o._componentsToRemove=[],o._componentTypeToInstance=new Map,o._componentStringToInstance=new Map,o._tagsMemo=[],o._typesMemo=[],o.componentAdded$=new kn,o.componentRemoved$=new kn,o._parent=null,o.childrenAdded$=new kn,o.childrenRemoved$=new kn,o._children=[],o._isInitialized=!1,o._setName(r),t){var a,l=s(t);try{for(l.s();!(a=l.n()).done;){var u=a.value;o.addComponent(u)}}catch(c){l.e(c)}finally{l.f()}}return i(o)}return p(n,[{key:"_setName",value:function(t){t&&(this._name=t)}},{key:"name",get:function(){return this._name}},{key:"events",get:function(){return this.eventDispatcher}},{key:"kill",value:function(){this.active=!1}},{key:"isKilled",value:function(){return!this.active}},{key:"tags",get:function(){return this._tagsMemo}},{key:"hasTag",value:function(t){return this.tags.includes(t)}},{key:"addTag",value:function(t){return this.addComponent(new Ye(t))}},{key:"removeTag",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.removeComponent(t,e)}},{key:"types",get:function(){return this._typesMemo}},{key:"_rebuildMemos",value:function(){this._tagsMemo=Array.from(this._componentStringToInstance.values()).filter((function(t){return t instanceof Ye})).map((function(t){return t.type})),this._typesMemo=Array.from(this._componentStringToInstance.keys())}},{key:"getComponents",value:function(){return Array.from(this._componentStringToInstance.values())}},{key:"_notifyAddComponent",value:function(t){this._rebuildMemos();var e=new qn({component:t,entity:this});this.componentAdded$.notifyAll(e)}},{key:"_notifyRemoveComponent",value:function(t){var e=new Qn({component:t,entity:this});this.componentRemoved$.notifyAll(e),this._rebuildMemos()}},{key:"parent",get:function(){return this._parent}},{key:"children",get:function(){return this._children}},{key:"unparent",value:function(){this._parent&&(this._parent.removeChild(this),this._parent=null)}},{key:"addChild",value:function(t){if(null!==t.parent)throw new Error("Entity already has a parent, cannot add without unparenting");if(this.getAncestors().includes(t))throw new Error("Cycle detected, cannot add entity");return this._children.push(t),t._parent=this,this.childrenAdded$.notifyAll(t),this}},{key:"removeChild",value:function(t){return t.parent===this&&(V(t,this._children),t._parent=null,this.childrenRemoved$.notifyAll(t)),this}},{key:"removeAllChildren",value:function(){var t=this;return this.children.forEach((function(e){t.removeChild(e)})),this}},{key:"getAncestors",value:function(){for(var t=[this],e=this.parent;e;)t.push(e),e=e.parent;return t.reverse()}},{key:"getDescendants",value:function(){for(var t=[this],e=[this];e.length>0;){var n=e.pop();e=e.concat(n.children),t=t.concat(n.children)}return t}},{key:"clone",value:function(){var t,e=new n,i=s(this.types);try{for(i.s();!(t=i.n()).done;){var r=t.value;e.addComponent(this.get(r).clone())}}catch(u){i.e(u)}finally{i.f()}var o,a=s(this.children);try{for(a.s();!(o=a.n()).done;){var l=o.value;e.addChild(l.clone())}}catch(u){a.e(u)}finally{a.f()}return e}},{key:"addTemplate",value:function(t){var e,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=s(t.getComponents());try{for(i.s();!(e=i.n()).done;){var r=e.value;this.addComponent(r.clone(),n)}}catch(u){i.e(u)}finally{i.f()}var o,a=s(t.children);try{for(a.s();!(o=a.n()).done;){var l=o.value;this.addChild(l.clone().addTemplate(l))}}catch(u){a.e(u)}finally{a.f()}return this}},{key:"addComponent",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.has(t.type)){if(!e)return this;this.removeComponent(t)}if(t.dependencies&&t.dependencies.length){var n,i=s(t.dependencies);try{for(i.s();!(n=i.n()).done;){var r=n.value;this.addComponent(new r)}}catch(a){i.e(a)}finally{i.f()}}t.owner=this;var o=t.constructor;return this._componentTypeToInstance.set(o,t),this._componentStringToInstance.set(t.type,t),t.onAdd&&t.onAdd(this),this._notifyAddComponent(t),this}},{key:"removeComponent",value:function(t){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]?"string"==typeof t?this._removeComponentByType(t):t instanceof Qe&&this._removeComponentByType(t.type):this._componentsToRemove.push(t),this}},{key:"_removeComponentByType",value:function(t){if(this.has(t)){var e=this.get(t);e.owner=null,e.onRemove&&e.onRemove(this);var n=e.constructor;this._componentTypeToInstance.delete(n),this._componentStringToInstance.delete(e.type),this._notifyRemoveComponent(e)}}},{key:"processComponentRemoval",value:function(){var t,e=s(this._componentsToRemove);try{for(e.s();!(t=e.n()).done;){var n=t.value,i="string"==typeof n?n:n.type;this._removeComponentByType(i)}}catch(r){e.e(r)}finally{e.f()}this._componentsToRemove.length=0}},{key:"has",value:function(t){return"string"==typeof t?this._componentStringToInstance.has(t):this._componentTypeToInstance.has(t)}},{key:"get",value:function(t){return"string"==typeof t?this._componentStringToInstance.get(t):this._componentTypeToInstance.get(t)}},{key:"isInitialized",get:function(){return this._isInitialized}},{key:"_initialize",value:function(t){this.isInitialized||(this.onInitialize(t),r(o(n.prototype),"emit",this).call(this,"initialize",new Xt(t,this)),this._isInitialized=!0)}},{key:"_preupdate",value:function(t,e){this.emit("preupdate",new Et(t,e,this)),this.onPreUpdate(t,e)}},{key:"_postupdate",value:function(t,e){this.emit("postupdate",new Pt(t,e,this)),this.onPostUpdate(t,e)}},{key:"onInitialize",value:function(t){}},{key:"onPreUpdate",value:function(t,e){}},{key:"onPostUpdate",value:function(t,e){}},{key:"update",value:function(t,e){this._initialize(t),this._preupdate(t,e);var n,i=s(this.children);try{for(i.s();!(n=i.n()).done;)n.value.update(t,e)}catch(r){i.e(r)}finally{i.f()}this._postupdate(t,e)}}]),n}(te);Zn._ID=0;var $n=function(t){h(n,t);var e=d(n);function n(t){var i,r;return f(this,n),(i=e.call(this)).draw=t,i.type="ex.canvas",i.draw=null!==(r=i.draw)&&void 0!==r?r:function(){},i}return n}(Qe);function Jn(t){return!!t.tick}var ti=function(){function t(e,n){f(this,t),this._options=e,this._graphics=n,this.graphics=[]}return p(t,[{key:"name",get:function(){return this._options.name}},{key:"hide",value:function(t){if(t){var e=null;e=t instanceof se?t:this._graphics.getGraphic(t),this.graphics=this.graphics.filter((function(t){return t.graphic!==e}))}else this.graphics.length=0}},{key:"show",value:function(t,e){var n;return e=Object.assign({},e),t instanceof se?n=this._graphics.copyGraphics?t.clone():t:(n=this._graphics.getGraphic(t))||P.getInstance().error("No such graphic added to component named ".concat(t,". These named graphics are available: "),this._graphics.getNames()),n?(this.graphics.push({graphic:n,options:e}),n):null}},{key:"use",value:function(t,e){return e=Object.assign({},e),this.hide(),this.show(t,e)}},{key:"order",get:function(){return this._options.order},set:function(t){this._options.order=t}},{key:"offset",get:function(){var t;return null!==(t=this._options.offset)&&void 0!==t?t:rt.Zero},set:function(t){this._options.offset=t}}]),t}(),ei=function(){function t(e){f(this,t),this._component=e,this._layers=[],this._layerMap={},this.default=new ti({name:"default",order:0},e),this._maybeAddLayer(this.default)}return p(t,[{key:"create",value:function(t){var e=new ti(t,this._component);return this._maybeAddLayer(e)}},{key:"get",value:function(t){return t?this._getLayer(t):this._layers}},{key:"has",value:function(t){return t in this._layerMap}},{key:"_maybeAddLayer",value:function(t){return this._layerMap[t.name]?this._layerMap[t.name]:(this._layerMap[t.name]=t,this._layers.push(t),this._layers.sort((function(t,e){return t.order-e.order})),t)}},{key:"_getLayer",value:function(t){return this._layerMap[t]}}]),t}(),ni=function(t){h(n,t);var e=d(n);function n(t){var i;f(this,n),(i=e.call(this)).type="ex.graphics",i._graphics={},i.visible=!0,i.opacity=1,i.offset=rt.Zero,i.anchor=rt.Half,i.copyGraphics=!1,i._bounds=null;var r=t=Object.assign({visible:i.visible},t),o=r.current,a=r.anchor,s=r.opacity,l=r.visible,u=r.graphics,h=r.offset,d=r.copyGraphics,p=r.onPreDraw,v=r.onPostDraw;return i._graphics=u||{},i.offset=null!=h?h:i.offset,i.opacity=null!=s?s:i.opacity,i.anchor=null!=a?a:i.anchor,i.copyGraphics=null!=d?d:i.copyGraphics,i.onPreDraw=null!=p?p:i.onPreDraw,i.onPostDraw=null!=v?v:i.onPostDraw,i.visible=!!l,i.layers=new ei(c(i)),o&&i._graphics[o]&&i.show(i._graphics[o]),i}return p(n,[{key:"getGraphic",value:function(t){return this._graphics[t]}},{key:"getNames",value:function(){return Object.keys(this._graphics)}},{key:"current",get:function(){return this.layers.default.graphics}},{key:"graphics",get:function(){return this._graphics}},{key:"add",value:function(t,e){var n="default",i=null;return"string"==typeof t?(n=t,i=e):i=t,this._graphics[n]=this.copyGraphics?i.clone():i,"default"===n&&this.show("default"),i}},{key:"show",value:function(t,e){return this.layers.default.show(t,e)}},{key:"use",value:function(t,e){return this.layers.default.use(t,e)}},{key:"hide",value:function(t){this.layers.default.hide(t)}},{key:"localBounds",get:function(){if(this._bounds)return this._bounds;var t,e=new ht,n=s(this.layers.get());try{for(n.s();!(t=n.n()).done;){var i,r=t.value,o=s(r.graphics);try{for(o.s();!(i=o.n()).done;){var a=i.value,l=a.graphic,u=a.options,c=this.anchor,h=this.offset;(null==u?void 0:u.anchor)&&(c=u.anchor),(null==u?void 0:u.offset)&&(h=u.offset);var d=l.localBounds,f=-d.width*l.scale.x*c.x+h.x,p=-d.height*l.scale.y*c.y+h.y;e=null==l?void 0:l.localBounds.translate(ot(f+r.offset.x,p+r.offset.y)).combine(e)}}catch(v){o.e(v)}finally{o.f()}}}catch(v){n.e(v)}finally{n.f()}return e},set:function(t){this._bounds=t}},{key:"update",value:function(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=s(this.layers.get());try{for(i.s();!(e=i.n()).done;){var r,o=e.value,a=s(o.graphics);try{for(a.s();!(r=a.n()).done;){var l=r.value.graphic;Jn(l)&&(null==l||l.tick(t,n))}}catch(u){a.e(u)}finally{a.f()}}}catch(u){i.e(u)}finally{i.f()}}}]),n}(Qe),ii=function(t){h(n,t);var e=d(n);function n(t){var i;return f(this,n),(i=e.call(this,t)).width=t.width,i.height=t.height,i.rasterize(),i}return p(n,[{key:"clone",value:function(){return new n(Object.assign(Object.assign({width:this.width,height:this.height},this.cloneGraphicOptions()),this.cloneRasterOptions()))}},{key:"execute",value:function(t){this.color&&t.fillRect(0,0,this.width,this.height),this.strokeColor&&t.strokeRect(0,0,this.width,this.height)}}]),n}(fe),ri=function(t){h(n,t);var e=d(n);function n(t){var i,r;return f(this,n),(i=e.call(this,t))._radius=0,i.padding=null!==(r=t.padding)&&void 0!==r?r:2,i.radius=t.radius,i.rasterize(),i}return p(n,[{key:"radius",get:function(){return this._radius},set:function(t){this._radius=t,this.width=2*this._radius,this.height=2*this._radius,this.flagDirty()}},{key:"clone",value:function(){return new n(Object.assign(Object.assign({radius:this.radius},this.cloneGraphicOptions()),this.cloneRasterOptions()))}},{key:"execute",value:function(t){this.radius>0&&(t.beginPath(),t.arc(this.radius,this.radius,this.radius,0,2*Math.PI),this.color&&t.fill(),this.strokeColor&&t.stroke())}}]),n}(fe),oi=function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},ai=function(t){h(n,t);var e=d(n);function n(t){var i;f(this,n),(i=e.call(this))._anchor=ce(rt.Half,(function(t){return i._handleAnchorChange(t)})),i.logger=P.getInstance(),i.scene=null,i.frames={},i.currentDrawing=null,i._draggable=!1,i._dragging=!1,i._pointerDragStartHandler=function(){i._dragging=!0},i._pointerDragEndHandler=function(){i._dragging=!1},i._pointerDragMoveHandler=function(t){i._dragging&&(i.pos=t.pointer.lastWorldPos)},i._pointerDragLeaveHandler=function(t){i._dragging&&(i.pos=t.pointer.lastWorldPos)},i.traits=[],i.enableCapturePointer=!1,i.capturePointer={captureMoveEvents:!1,captureDragEvents:!1},i._capturePointerEvents=["pointerup","pointerdown","pointermove","pointerenter","pointerleave","pointerdragstart","pointerdragend","pointerdragmove","pointerdragenter","pointerdragleave"],i._captureMoveEvents=["pointermove","pointerenter","pointerleave","pointerdragmove","pointerdragenter","pointerdragleave"],i._captureDragEvents=["pointerdragstart","pointerdragend","pointerdragmove","pointerdragenter","pointerdragleave"];var r=Object.assign({},t),o=r.name,a=r.x,s=r.y,l=r.pos,u=r.scale,h=r.width,d=r.height,p=r.radius,v=r.collider,g=r.vel,y=r.acc,m=r.rotation,_=r.angularVelocity,w=r.z,k=r.color,x=r.visible,C=r.anchor,E=r.collisionType,A=r.collisionGroup;return i._setName(o),i.anchor=null!=C?C:n.defaults.anchor.clone(),i.addComponent(new rn),i.pos=null!=l?l:ot(null!=a?a:0,null!=s?s:0),i.rotation=null!=m?m:0,i.scale=null!=u?u:ot(1,1),i.z=null!=w?w:0,i.addComponent(new ni),i.addComponent(new $n((function(t,e){return i.draw(t,e)}))),i.addComponent(new Ze),i.vel=null!=g?g:rt.Zero,i.acc=null!=y?y:rt.Zero,i.angularVelocity=null!=_?_:0,i.addComponent(new jn),i.body.collisionType=null!=E?E:Je.Passive,A&&(i.body.group=A),v?i.addComponent(new Wn(v)):p?i.addComponent(new Wn(Hn.Circle(p,i.anchor))):h>0&&d>0?i.addComponent(new Wn(Hn.Box(h,d,i.anchor))):i.addComponent(new Wn),i.graphics.visible=null==x||x,k&&(i.color=k,h&&d?i.graphics.add(new ii({color:k,width:h,height:d})):p&&i.graphics.add(new ri({color:k,radius:p}))),S.isEnabled(b.LegacyDrawing)&&i.traits.push(new Gn),i.traits.push(new Xn),i.actions=new vn(c(i)),i}return p(n,[{key:"body",get:function(){return this.get(jn)}},{key:"transform",get:function(){return this.get(rn)}},{key:"motion",get:function(){return this.get(Ze)}},{key:"graphics",get:function(){return this.get(ni)}},{key:"collider",get:function(){return this.get(Wn)}},{key:"pos",get:function(){return this.transform.pos},set:function(t){this.transform.pos=t.clone()}},{key:"oldPos",get:function(){return this.body.oldPos},set:function(t){this.body.oldPos.setTo(t.x,t.y)}},{key:"vel",get:function(){return this.motion.vel},set:function(t){this.motion.vel=t.clone()}},{key:"oldVel",get:function(){return this.body.oldVel},set:function(t){this.body.oldVel.setTo(t.x,t.y)}},{key:"acc",get:function(){return this.motion.acc},set:function(t){this.motion.acc=t.clone()}},{key:"oldAcc",get:function(){return this.body.oldAcc},set:function(t){this.body.oldAcc.setTo(t.x,t.y)}},{key:"rotation",get:function(){return this.transform.rotation},set:function(t){this.transform.rotation=t}},{key:"angularVelocity",get:function(){return this.motion.angularVelocity},set:function(t){this.motion.angularVelocity=t}},{key:"scale",get:function(){return this.get(rn).scale},set:function(t){this.get(rn).scale=t}},{key:"anchor",get:function(){return this._anchor},set:function(t){var e=this;this._anchor=ce(t,(function(t){return e._handleAnchorChange(t)})),this._handleAnchorChange(t)}},{key:"_handleAnchorChange",value:function(t){this.graphics&&(this.graphics.anchor=t)}},{key:"isOffScreen",get:function(){return this.hasTag("offscreen")}},{key:"visible",get:function(){return this.graphics.visible},set:function(t){this.graphics.visible=t}},{key:"opacity",get:function(){return this.graphics.opacity},set:function(t){this.graphics.opacity=t}},{key:"draggable",get:function(){return this._draggable},set:function(t){t&&(t&&!this._draggable?(this.on("pointerdragstart",this._pointerDragStartHandler),this.on("pointerdragend",this._pointerDragEndHandler),this.on("pointerdragmove",this._pointerDragMoveHandler),this.on("pointerdragleave",this._pointerDragLeaveHandler)):!t&&this._draggable&&(this.off("pointerdragstart",this._pointerDragStartHandler),this.off("pointerdragend",this._pointerDragEndHandler),this.off("pointerdragmove",this._pointerDragMoveHandler),this.off("pointerdragleave",this._pointerDragLeaveHandler)),this._draggable=t)}},{key:"color",get:function(){return this._color},set:function(t){this._color=t.clone()}},{key:"onInitialize",value:function(t){}},{key:"_initialize",value:function(t){r(o(n.prototype),"_initialize",this).call(this,t);var e,i=s(this.children);try{for(i.s();!(e=i.n()).done;)e.value._initialize(t)}catch(a){i.e(a)}finally{i.f()}}},{key:"_checkForPointerOptIn",value:function(t){if(t){var e=t.toLowerCase();-1!==this._capturePointerEvents.indexOf(e)&&(this.enableCapturePointer=!0,-1!==this._captureMoveEvents.indexOf(e)&&(this.capturePointer.captureMoveEvents=!0),-1!==this._captureDragEvents.indexOf(e)&&(this.capturePointer.captureDragEvents=!0))}}},{key:"on",value:function(t,e){this._checkForPointerOptIn(t),r(o(n.prototype),"on",this).call(this,t,e)}},{key:"once",value:function(t,e){this._checkForPointerOptIn(t),r(o(n.prototype),"once",this).call(this,t,e)}},{key:"off",value:function(t,e){r(o(n.prototype),"off",this).call(this,t,e)}},{key:"_prekill",value:function(t){r(o(n.prototype),"emit",this).call(this,"prekill",new mt(this)),this.onPreKill(t)}},{key:"onPreKill",value:function(t){}},{key:"_postkill",value:function(t){r(o(n.prototype),"emit",this).call(this,"postkill",new _t(this)),this.onPostKill(t)}},{key:"onPostKill",value:function(t){}},{key:"kill",value:function(){this.scene?(this._prekill(this.scene),this.emit("kill",new yt(this)),r(o(n.prototype),"kill",this).call(this),this._postkill(this.scene)):this.logger.warn("Cannot kill actor, it was never added to the Scene")}},{key:"unkill",value:function(){this.active=!0}},{key:"isKilled",value:function(){return!this.active}},{key:"setDrawing",value:function(t){t=t.toString(),this.currentDrawing!==this.frames[t]&&(null!=this.frames[t]?(this.frames[t].reset(),this.currentDrawing=this.frames[t]):P.getInstance().error("the specified drawing key ".concat(t," does not exist"))),this.currentDrawing&&this.currentDrawing instanceof Ie&&this.currentDrawing.tick(0)}},{key:"addDrawing",value:function(){2===arguments.length?(this.frames[arguments[0]]=arguments[1],this.currentDrawing||(this.currentDrawing=arguments[1])):(arguments[0]instanceof Le&&this.addDrawing("default",arguments[0]),arguments[0]instanceof Oe&&this.addDrawing("default",arguments[0].asSprite()))}},{key:"z",get:function(){return this.get(rn).z},set:function(t){this.get(rn).z=t}},{key:"getZIndex",value:function(){return this.get(rn).z}},{key:"setZIndex",value:function(t){this.get(rn).z=t}},{key:"center",get:function(){return new rt(this.pos.x+this.width/2-this.anchor.x*this.width,this.pos.y+this.height/2-this.anchor.y*this.height)}},{key:"width",get:function(){return this.collider.localBounds.width*this.getGlobalScale().x}},{key:"height",get:function(){return this.collider.localBounds.height*this.getGlobalScale().y}},{key:"getGlobalRotation",value:function(){return this.get(rn).globalRotation}},{key:"getGlobalPos",value:function(){return this.get(rn).globalPos}},{key:"getGlobalScale",value:function(){return this.get(rn).globalScale}},{key:"contains",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=ot(t,e),r=this.get(Wn);r.update();var o=r.get();if(!o)return!1;var a=o.contains(i);return n?a||this.children.some((function(n){return n.contains(t,e,!0)})):a}},{key:"within",value:function(t,e){var n=this.get(Wn),i=t.get(Wn),r=n.get(),o=i.get();return!(!r||!o)&&r.getClosestLineBetween(o).getLength()<=e}},{key:"update",value:function(t,e){this._initialize(t),this._preupdate(t,e);var n=this.currentDrawing;n&&n instanceof Ie&&n.tick(e,t.stats.currFrame.id),this.actions.update(e);var i,r=s(this.traits);try{for(r.s();!(i=r.n()).done;)i.value.update(this,t,e)}catch(o){r.e(o)}finally{r.f()}this._postupdate(t,e)}},{key:"onPreUpdate",value:function(t,e){}},{key:"onPostUpdate",value:function(t,e){}},{key:"_preupdate",value:function(t,e){this.emit("preupdate",new Et(t,e,this)),this.onPreUpdate(t,e)}},{key:"_postupdate",value:function(t,e){this.emit("postupdate",new Et(t,e,this)),this.onPostUpdate(t,e)}},{key:"draw",value:function(t,e){var n;if(t.save(),this.currentDrawing){t.translate(-this.width*this.anchor.x,-this.height*this.anchor.y),this._predraw(t,e);var i=this.currentDrawing,r=(this.width-i.width*i.scale.x)*this.anchor.x,o=(this.height-i.height*i.scale.y)*this.anchor.y;this.currentDrawing.draw({ctx:t,x:r,y:o,opacity:this.graphics.opacity})}else if(this._predraw(t,e),this.color&&this.collider){var a=this.get(Wn);a.update(),a&&!a.bounds.hasZeroDimensions()&&(t.globalAlpha=this.graphics.opacity,null===(n=a.get())||void 0===n||n.draw(t,this.color,ot(0,0)))}t.restore(),this._postdraw(t,e)}},{key:"onPreDraw",value:function(t,e){}},{key:"onPostDraw",value:function(t,e){}},{key:"_predraw",value:function(t,e){this.emit("predraw",new kt(t,e,this)),this.onPreDraw(t,e)}},{key:"_postdraw",value:function(t,e){this.emit("postdraw",new kt(t,e,this)),this.onPostDraw(t,e)}},{key:"debugDraw",value:function(t){}}]),n}(Zn);ai.defaults={anchor:rt.Half},oi([nt({message:"Actor.visible will be removed in v0.26.0",alternateMethod:"Use Actor.graphics.visible"})],ai.prototype,"visible",null),oi([nt({message:"Actor.opacity will be removed in v0.26.0",alternateMethod:"Use Actor.graphics.opacity"})],ai.prototype,"opacity",null),oi([nt({message:"Actor.setDrawing will be removed in v0.26.0",alternateMethod:"Use Actor.graphics.show() or Actor.graphics.use()"})],ai.prototype,"setDrawing",null),oi([nt({message:"Actor.addDrawing will be removed in v0.26.0",alternateMethod:"Use Actor.graphics.add()"})],ai.prototype,"addDrawing",null),oi([nt({message:"Actor.getZIndex will be removed in v0.26.0",alternateMethod:"Use Actor.transform.z or Actor.z"})],ai.prototype,"getZIndex",null),oi([nt({message:"Actor.setZIndex will be removed in v0.26.0",alternateMethod:"Use Actor.transform.z or Actor.z"})],ai.prototype,"setZIndex",null);var si=function(t){h(n,t);var e=d(n);function n(t){var i;return f(this,n),(i=e.call(this,Object.assign({},t))).get(rn).coordPlane=$e.Screen,i.traits=[],i.traits.push(new Xn),i.anchor=ot(0,0),i.body.collisionType=Je.PreventCollision,i.collider.useBoxCollider(i.width,i.height,i.anchor),i.enableCapturePointer=!0,i}return p(n,[{key:"_initialize",value:function(t){this._engine=t,r(o(n.prototype),"_initialize",this).call(this,t)}},{key:"contains",value:function(t,e){if(!(arguments.length>2&&void 0!==arguments[2])||arguments[2])return r(o(n.prototype),"contains",this).call(this,t,e);var i=this._engine.worldToScreenCoordinates(new rt(t,e));return r(o(n.prototype),"contains",this).call(this,i.x,i.y)}}]),n}(ai),li=function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},ui=function(){function t(e,n,i,r){if(f(this,t),this._logger=P.getInstance(),this.id=0,this._elapsedTime=0,this._totalTimeAlive=0,this._running=!1,this._numberOfTicks=0,this.interval=10,this.repeats=!1,this.maxNumberOfRepeats=-1,this._complete=!1,this.scene=null,"function"!=typeof e){var o=e;e=o.fcn,n=o.interval,i=o.repeats,r=o.numberOfRepeats}if(r&&r>=0&&(this.maxNumberOfRepeats=r,!i))throw new Error("repeats must be set to true if numberOfRepeats is set");this.id=t._MAX_ID++,this.interval=n||this.interval,this.repeats=i||this.repeats,this._callbacks=[],e&&this.on(e)}return p(t,[{key:"complete",get:function(){return this._complete}},{key:"on",value:function(t){this._callbacks.push(t)}},{key:"off",value:function(t){var e=this._callbacks.indexOf(t);this._callbacks.splice(e,1)}},{key:"update",value:function(t){var e=this;this._running&&(this._totalTimeAlive+=t,this._elapsedTime+=t,this.maxNumberOfRepeats>-1&&this._numberOfTicks>=this.maxNumberOfRepeats&&(this._complete=!0,this._running=!1,this._elapsedTime=0),!this.complete&&this._elapsedTime>=this.interval&&(this._callbacks.forEach((function(t){t.call(e)})),this._numberOfTicks++,this.repeats||(this._complete=!0,this._running=!1),this._elapsedTime=0))}},{key:"reset",value:function(t,e){if(t&&t>=0&&(this.interval=t),this.maxNumberOfRepeats&&this.maxNumberOfRepeats>=0&&(this.maxNumberOfRepeats=e,!this.repeats))throw new Error("repeats must be set to true if numberOfRepeats is set");this._complete=!1,this._elapsedTime=0,this._numberOfTicks=0}},{key:"timesRepeated",get:function(){return this._numberOfTicks}},{key:"getTimeRunning",value:function(){return this._totalTimeAlive}},{key:"timeToNextAction",get:function(){return this.complete?0:this.interval-this._elapsedTime}},{key:"timeElapsedTowardNextAction",get:function(){return this._elapsedTime}},{key:"isRunning",get:function(){return this._running}},{key:"pause",value:function(){return this._running=!1,this}},{key:"unpause",value:function(){this._running=!0}},{key:"resume",value:function(){return this._running=!0,this}},{key:"start",value:function(){return this.scene||this._logger.warn("Cannot start a timer not part of a scene, timer wont start until added"),this._running=!0,this.complete&&(this._complete=!1,this._elapsedTime=0,this._numberOfTicks=0),this}},{key:"stop",value:function(){return this._running=!1,this._elapsedTime=0,this._numberOfTicks=0,this}},{key:"cancel",value:function(){this.pause(),this.scene&&this.scene.cancelTimer(this)}}]),t}();ui._MAX_ID=0,li([nt({message:"Will be removed in v0.26.0",alternateMethod:"Use Timer.resume()"})],ui.prototype,"unpause",null);var ci,hi,di,fi,pi,vi=function(t,e,n,i){return new(n||(n=Promise))((function(r,o){function a(t){try{l(i.next(t))}catch(t){o(t)}}function s(t){try{l(i.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}l((i=i.apply(t,e||[])).next())}))},gi=function(){function t(e){var n=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];f(this,t),this.path=e,this._logger=P.getInstance(),this.data=new Image,this._resource=new _e(e,"blob",i),(e.endsWith(".svg")||e.endsWith(".gif"))&&this._logger.warn("Image type is not fully supported, you may have mixed results ".concat(e,". Fully supported: jpg, bmp, and png")),this.ready=new Promise((function(t){n._loadedResolve=t}))}return p(t,[{key:"width",get:function(){return this.image.naturalWidth}},{key:"height",get:function(){return this.image.naturalHeight}},{key:"isLoaded",value:function(){return!!this.data.src}},{key:"image",get:function(){return this.data}},{key:"load",value:function(){return vi(this,void 0,void 0,u.mark((function t(){var e,n,i;return u.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.isLoaded()){t.next=2;break}return t.abrupt("return",this.data);case 2:if(t.prev=2,!this.path.includes("data:image/")){t.next=7;break}e=this.path,t.next=11;break;case 7:return t.next=9,this._resource.load();case 9:n=t.sent,e=URL.createObjectURL(n);case 11:return(i=new Image).src=e,t.next=15,i.decode();case 15:this.data=i,t.next=22;break;case 18:return t.prev=18,t.t0=t.catch(2),t.next=22,Promise.reject("Error loading texture");case 22:return t.abrupt("return",(this._loadedResolve(this.data),this.data));case 23:case"end":return t.stop()}}),t,this,[[2,18]])})))}},{key:"toSprite",value:function(){return yi.from(this)}},{key:"unload",value:function(){this.data=new Image}}],[{key:"fromLegacyTexture",value:function(e){var n=new t(e.path);return e.isLoaded()?n.data=e.data:e.loaded.then((function(){n.data=e.data})),n}}]),t}(),yi=function(t){h(n,t);var e=d(n);function n(t){var i,r,o;f(this,n),(i=e.call(this,t)).image=t.image;var a=t.width,s=t.height;return i.sourceView=null!==(r=t.sourceView)&&void 0!==r?r:{x:0,y:0,width:null!=a?a:0,height:null!=s?s:0},i.destSize=null!==(o=t.destSize)&&void 0!==o?o:{width:null!=a?a:0,height:null!=s?s:0},i._updateSpriteDimensions(),i.image.ready.then((function(){i._updateSpriteDimensions()})),i}return p(n,[{key:"_updateSpriteDimensions",value:function(){var t,e,n,i,r,o,a=this.image,s=a.width,l=a.height;this.sourceView.width=(null===(t=this.sourceView)||void 0===t?void 0:t.width)||s,this.sourceView.height=(null===(e=this.sourceView)||void 0===e?void 0:e.height)||l,this.destSize.width=(null===(n=this.destSize)||void 0===n?void 0:n.width)||(null===(i=this.sourceView)||void 0===i?void 0:i.width)||s,this.destSize.height=(null===(r=this.destSize)||void 0===r?void 0:r.height)||(null===(o=this.sourceView)||void 0===o?void 0:o.height)||l,this.width=Math.ceil(this.destSize.width),this.height=Math.ceil(this.destSize.height)}},{key:"_preDraw",value:function(t,e,i){this.image.isLoaded()&&this._updateSpriteDimensions(),r(o(n.prototype),"_preDraw",this).call(this,t,e,i)}},{key:"_drawImage",value:function(t,e,n){this.image.isLoaded()&&(this._updateSpriteDimensions(),t.drawImage(this.image.image,this.sourceView.x,this.sourceView.y,this.sourceView.width,this.sourceView.height,e,n,this.destSize.width,this.destSize.height))}},{key:"clone",value:function(){return new n(Object.assign({image:this.image,sourceView:Object.assign({},this.sourceView),destSize:Object.assign({},this.destSize)},this.cloneGraphicOptions()))}}],[{key:"from",value:function(t){return new n({image:t})}},{key:"fromLegacySprite",value:function(t){var e=t.texture;return new n({image:gi.fromLegacyTexture(e),sourceView:{x:t.x,y:t.y,width:t.width,height:t.height}})}},{key:"toLegacySprite",value:function(t){var e=t.image,n=new Oe(e.path);return n.data=e.image,new Le(n,t.sourceView.x,t.sourceView.y,t.sourceView.width,t.sourceView.height)}}]),n}(se);!function(t){t.Em="em",t.Rem="rem",t.Px="px",t.Pt="pt",t.Percent="%"}(ci||(ci={})),function(t){t.Left="left",t.Right="right",t.Center="center",t.Start="start",t.End="end"}(hi||(hi={})),function(t){t.Top="top",t.Hanging="hanging",t.Middle="middle",t.Alphabetic="alphabetic",t.Ideographic="ideographic",t.Bottom="bottom"}(di||(di={})),function(t){t.Normal="normal",t.Italic="italic",t.Oblique="oblique"}(fi||(fi={})),function(t){t.LeftToRight="ltr",t.RightToLeft="rtl"}(pi||(pi={}));var mi=function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},_i=function(){function t(e,n,i,r,o,a){f(this,t),this._sprites=[],this._image=null,this._columns=0,this._rows=0,this._spWidth=0,this._spHeight=0,this._spacing=0;var s=!1;if(e instanceof Array?this._sprites=e:(!e||e instanceof Oe?(this._image=e,this._columns=n,this._rows=i,this._spWidth=r,this._spHeight=o,this._spacing=a||0):(this._columns=e.columns,this._rows=e.rows,this._spWidth=e.spWidth,this._spHeight=e.spHeight,this._image=e.image,this._spacing=e.spacing||0),this._sprites=new Array(this._columns*this._rows),s=!0),this.image instanceof Oe){var l=!1,u=!1;if(this.image.isLoaded()){if(l=this.spWidth*this.columns>this.image.image.naturalWidth,u=this.spHeight*this.rows>this.image.image.naturalHeight,l)throw new RangeError("SpriteSheet specified is wider, ".concat(this.columns," cols x ").concat(this.spWidth," pixels > ").concat(this.image.image.naturalWidth," pixels than image width"));if(u)throw new RangeError("SpriteSheet specified is taller, ".concat(this.rows," rows x ").concat(this.spHeight," pixels > ").concat(this.image.image.naturalHeight," pixels than image height"))}}if(s)for(var c=this.getSpacingDimensions(),h=0;h<this.rows;h++)for(var d=0;d<this.columns;d++)this._sprites[d+h*this.columns]=new Le(this.image,d*this.spWidth+c.margin*d+c.left,h*this.spHeight+c.margin*h+c.top,this.spWidth,this.spHeight)}return p(t,[{key:"spacing",get:function(){return this._spacing}},{key:"sprites",get:function(){return a(this._sprites)}},{key:"image",get:function(){return this._image}},{key:"columns",get:function(){return this._columns}},{key:"rows",get:function(){return this._rows}},{key:"spWidth",get:function(){return this._spWidth}},{key:"spHeight",get:function(){return this._spHeight}},{key:"getSpacingDimensions",value:function(){var t,e,n;return"number"==typeof this.spacing?{left:this.spacing,top:this.spacing,margin:this.spacing}:{left:null!==(t=this.spacing.left)&&void 0!==t?t:0,top:null!==(e=this.spacing.top)&&void 0!==e?e:0,margin:null!==(n=this.spacing.margin)&&void 0!==n?n:0}}},{key:"getAnimationByIndices",value:function(t,e,n){var i=this,r=e.map((function(t){return i.sprites[t]}));return r=r.map((function(t){return t.clone()})),new Ie(t,r,n)}},{key:"getAnimationBetween",value:function(t,e,n,i){var r=this.sprites.slice(e,n);return r=r.map((function(t){return t.clone()})),new Ie(t,r,i)}},{key:"getAnimationForAll",value:function(t,e){var n=this.sprites.map((function(t){return t.clone()}));return new Ie(t,n,e)}},{key:"getSprite",value:function(t){if(t>=0&&t<this.sprites.length)return this.sprites[t];throw new Error("Invalid index: "+t)}},{key:"getAnimationByCoords",value:function(t,e,n){for(var i=0,r=0,o=new Array(e.length),a=0;a<e.length;a++){var s=e[a];s.image=s.image||this.image,i=Math.max(i,s.drawWidth),r=Math.max(r,s.drawHeight),o[a]=new Le(s)}var l=new Ie(t,o,n);return l.drawWidth=i,l.drawHeight=r,l}}]),t}(),wi=function(t){h(n,t);var e=d(n);function n(t,i,r,o,a,s,l,u){var c;return f(this,n),(c=e.call(this,t instanceof Oe?{image:t,spWidth:s,spHeight:l,rows:a,columns:o,spacing:u||0}:t))._currentColor=ut.Black,c._currentOpacity=1,c._spriteRecord={},c._textShadowOn=!1,c._textShadowDirty=!0,c._textShadowColor=ut.Black,c._textShadowSprites={},c._shadowOffsetX=5,c._shadowOffsetY=5,!t||t instanceof Oe||(i=t.alphabet,r=t.caseInsensitive),c.alphabet=i,c.caseInsensitive=r,c._spriteRecord=c.getTextSprites(),c}return p(n,[{key:"getTextSprites",value:function(){for(var t={},e=0;e<this.alphabet.length;e++){var n=this.alphabet[e];this.caseInsensitive&&(n=n.toLowerCase()),t[n]=this.sprites[e].clone()}return t}},{key:"setTextShadow",value:function(t,e,n){for(var i in this._textShadowOn=!0,this._shadowOffsetX=t,this._shadowOffsetY=e,this._textShadowColor=n.clone(),this._textShadowDirty=!0,this._spriteRecord)this._textShadowSprites[i]=this._spriteRecord[i].clone()}},{key:"useTextShadow",value:function(t){this._textShadowOn=t,t&&this.setTextShadow(5,5,this._textShadowColor)}},{key:"draw",value:function(t,e,n,i,r){if(r=this._parseOptions(r),this._currentColor.toString()!==r.color.toString()||this._currentOpacity!==r.opacity)for(var o in this._currentOpacity=r.opacity,this._currentColor=r.color,this._spriteRecord)this._spriteRecord[o].clearEffects(),this._spriteRecord[o].fill(r.color),this._spriteRecord[o].opacity(r.opacity);if(this._textShadowOn&&this._textShadowDirty&&this._textShadowColor){for(var a in this._textShadowSprites)this._textShadowSprites[a].clearEffects(),this._textShadowSprites[a].addEffect(new Te(this._textShadowColor.clone()));this._textShadowDirty=!1}var s=this.sprites[0],l=s.height,u=r.fontSize/l,c=e.length*s.width*u+e.length*r.letterSpacing,h=n;r.textAlign===hi.Left||r.textAlign===hi.Start?h=n:r.textAlign===hi.Right||r.textAlign===hi.End?h=n-c:r.textAlign===hi.Center&&(h=n-c/2);var d=i-l*u;r.baseAlign===di.Top||r.baseAlign===di.Hanging?d=i:r.baseAlign===di.Ideographic||r.baseAlign===di.Bottom||r.baseAlign===di.Alphabetic?d=i-l*u:r.baseAlign===di.Middle&&(d=i-l*u/2);for(var f=0;f<e.length;f++){var p=e[f];this.caseInsensitive&&(p=p.toLowerCase());try{this._textShadowOn&&(this._textShadowSprites[p].drawAroundAnchor=!1,this._textShadowSprites[p].scale=ot(u,u),this._textShadowSprites[p].draw(t,h+this._shadowOffsetX,d+this._shadowOffsetY));var v=this._spriteRecord[p];v.drawAroundAnchor=!1,v.scale=ot(u,u),v.draw(t,h,d),h+=v.drawWidth+r.letterSpacing}catch(t){P.getInstance().error("SpriteFont Error drawing char "+p)}}}},{key:"_parseOptions",value:function(t){return{fontSize:t.fontSize||10,letterSpacing:t.letterSpacing||0,color:t.color||ut.Black,textAlign:void 0===typeof t.textAlign?hi.Left:t.textAlign,baseAlign:void 0===typeof t.baseAlign?di.Bottom:t.baseAlign,maxWidth:t.maxWidth||-1,opacity:t.opacity||0}}}]),n}(_i);wi=mi([nt({message:"SpriteSheet will be removed in v0.26.0",alternateMethod:"Use Graphics.SpriteSheet"})],wi);var bi,ki=function(){function t(e){f(this,t),this._logger=P.getInstance(),this.sprites=[];var n=e.sprites,i=e.rows,r=e.columns;this.sprites=n,this.rows=null!=i?i:1,this.columns=null!=r?r:this.sprites.length}return p(t,[{key:"getSprite",value:function(t,e){if(t>=this.columns||t<0)return this._logger.warn("No sprite exists in the SpriteSheet at (".concat(t,", ").concat(e,"), x: ").concat(t," should be between 0 and ").concat(this.columns-1)),null;if(e>=this.rows||e<0)return this._logger.warn("No sprite exists in the SpriteSheet at (".concat(t,", ").concat(e,"), y: ").concat(e," should be between 0 and ").concat(this.rows-1)),null;var n=t+e*this.columns;return this.sprites[n]}}],[{key:"fromLegacySpriteSheet",value:function(e){return new t({sprites:e.sprites.map((function(t){return yi.fromLegacySprite(t)}))})}},{key:"toLegacySpriteSheet",value:function(t){var e=t.sprites.map((function(t){return yi.toLegacySprite(t)}));return new _i(e)}},{key:"fromImageSource",value:function(e){var n,i=[];e.spacing=null!==(n=e.spacing)&&void 0!==n?n:{};for(var r=e.image,o=e.grid,a=o.rows,s=o.columns,l=o.spriteWidth,u=o.spriteHeight,c=e.spacing,h=c.originOffset,d=c.margin,f=Object.assign({x:0,y:0},h),p=Object.assign({x:0,y:0},d),v=0;v<s;v++)for(var g=0;g<a;g++)i[v+g*s]=new yi({image:r,sourceView:{x:v*l+p.x*v+f.x,y:g*u+p.y*g+f.y,width:l,height:u},destSize:{height:u,width:l}});return new t({sprites:i,rows:a,columns:s})}}]),t}(),xi=function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},Ci=function(t){h(n,t);var e=d(n);function n(t,r,o,a,s,l){var u;if(f(this,n),(u=e.call(this))._token=0,u._onScreenXStart=0,u._onScreenXEnd=9999,u._onScreenYStart=0,u._onScreenYEnd=9999,u._spriteSheets={},u._legacySpriteMap=new Map,u.logger=P.getInstance(),u.data=[],u._rows=[],u._cols=[],u.visible=!0,u.isOffscreen=!1,u._dirty=!0,t&&"object"==typeof t){var h=t;t=h.x,r=h.y,o=h.cellWidth,a=h.cellHeight,s=h.rows,l=h.cols}u.addComponent(new rn),u.addComponent(new Ze),u.addComponent(new jn({type:Je.Fixed})),u.addComponent(new $n((function(t,e){return u.draw(t,e)}))),u.addComponent(new ni({onPostDraw:function(t,e){return u.draw(t,e)}})),u.addComponent(new Wn),u._transform=u.get(rn),u._motion=u.get(Ze),u._collider=u.get(Wn),u._composite=u._collider.useCompositeCollider([]),u.x=t,u.y=r,u.cellWidth=o,u.cellHeight=a,u.rows=s,u.cols=l,u.data=new Array(s*l),u._rows=new Array(s),u._cols=new Array(l);for(var d=[],p=0;p<l;p++){for(var v=0;v<s;v++){var g=new Pi(p*o+t,v*a+r,o,a,p+v*l);g.map=c(u),u.data[p+v*l]=g,d.push(g),u._rows[v]||(u._rows[v]=[]),u._rows[v].push(g)}u._cols[p]=d,d=[]}return u.get(ni).localBounds=new ht({left:0,top:0,right:u.cols*u.cellWidth,bottom:u.rows*u.cellHeight}),i(u)}return p(n,[{key:"flagDirty",value:function(){this._dirty=!0}},{key:"x",get:function(){var t;return null!==(t=this._transform.pos.x)&&void 0!==t?t:0},set:function(t){var e;(null===(e=this._transform)||void 0===e?void 0:e.pos)&&(this.get(rn).pos=ot(t,this.y))}},{key:"y",get:function(){var t,e;return null!==(e=null===(t=this._transform)||void 0===t?void 0:t.pos.y)&&void 0!==e?e:0},set:function(t){var e;(null===(e=this._transform)||void 0===e?void 0:e.pos)&&(this._transform.pos=ot(this.x,t))}},{key:"z",get:function(){var t;return null!==(t=this._transform.z)&&void 0!==t?t:0},set:function(t){var e;(null===(e=this._transform)||void 0===e?void 0:e.z)&&(this._transform.z=t)}},{key:"rotation",get:function(){var t,e;return null!==(e=null===(t=this._transform)||void 0===t?void 0:t.rotation)&&void 0!==e?e:0},set:function(t){var e;(null===(e=this._transform)||void 0===e?void 0:e.rotation)&&(this._transform.rotation=t)}},{key:"scale",get:function(){var t,e;return null!==(e=null===(t=this._transform)||void 0===t?void 0:t.scale)&&void 0!==e?e:rt.One},set:function(t){var e;(null===(e=this._transform)||void 0===e?void 0:e.scale)&&(this._transform.scale=t)}},{key:"pos",get:function(){return this._transform.pos},set:function(t){this._transform.pos=t}},{key:"vel",get:function(){return this._motion.vel},set:function(t){this._motion.vel=t}},{key:"on",value:function(t,e){r(o(n.prototype),"on",this).call(this,t,e)}},{key:"_initialize",value:function(t){r(o(n.prototype),"_initialize",this).call(this,t)}},{key:"registerSpriteSheet",value:function(t,e){this._spriteSheets[t]=e instanceof ki?e:ki.fromLegacySpriteSheet(e)}},{key:"_updateColliders",value:function(){this._composite.clearColliders();for(var t,e=[],n=0;n<this.cols;n++){for(var i=0;i<this.rows;i++){0===i&&(t=null);var r=this.data[n+i*this.cols];r.solid?t=t?t.combine(r.bounds):r.bounds:(t&&e.push(t),t=null)}if(t){var o=e[e.length-1];o&&o.top===t.top&&o.bottom===t.bottom?e[e.length-1]=o.combine(t):e.push(t)}}this._composite=this._collider.useCompositeCollider([]);for(var a=0,s=e;a<s.length;a++){var l=s[a],u=Hn.Box(l.width,l.height,rt.Zero,ot(l.left-this.pos.x,l.top-this.pos.y));u.owner=this,this._composite.addCollider(u)}this._collider.update()}},{key:"getCellByIndex",value:function(t){return this.data[t]}},{key:"getCell",value:function(t,e){return t<0||e<0||t>=this.cols||e>=this.rows?null:this.data[t+e*this.cols]}},{key:"getCellByPoint",value:function(t,e){t=Math.floor((t-this.pos.x)/this.cellWidth),e=Math.floor((e-this.pos.y)/this.cellHeight);var n=this.getCell(t,e);return t>=0&&e>=0&&t<this.cols&&e<this.rows&&n?n:null}},{key:"getRows",value:function(){return this._rows}},{key:"getColumns",value:function(){return this._cols}},{key:"onPreUpdate",value:function(t,e){}},{key:"onPostUpdate",value:function(t,e){}},{key:"update",value:function(t,e){this.onPreUpdate(t,e),this.emit("preupdate",new Et(t,e,this)),this._dirty&&(this._dirty=!1,this._updateColliders()),this._token++;var n=t.getWorldBounds(),i=ot(n.left,n.top),r=ot(n.right,n.bottom);this._onScreenXStart=Math.max(Math.floor((i.x-this.x)/this.cellWidth)-2,0),this._onScreenYStart=Math.max(Math.floor((i.y-this.y)/this.cellHeight)-2,0),this._onScreenXEnd=Math.max(Math.floor((r.x-this.x)/this.cellWidth)+2,0),this._onScreenYEnd=Math.max(Math.floor((r.y-this.y)/this.cellHeight)+2,0),this._transform.pos=ot(this.x,this.y),this.onPostUpdate(t,e),this.emit("postupdate",new Pt(t,e,this))}},{key:"draw",value:function(t,e){this.emit("predraw",new kt(t,e,this));for(var n,i,r,o=this._onScreenXStart,a=Math.min(this._onScreenXEnd,this.cols),s=this._onScreenYStart,l=Math.min(this._onScreenYEnd,this.rows);o<a;o++){for(;s<l;s++)for(i=0,r=(n=this.getCell(o,s).graphics).length;i<r;i++){var u=n[i];u&&(t instanceof CanvasRenderingContext2D?u instanceof yi&&(this._legacySpriteMap.has(u)||this._legacySpriteMap.set(u,yi.toLegacySprite(u)),this._legacySpriteMap.get(u).draw(t,o*this.cellWidth,s*this.cellHeight)):(Jn(u)&&(null==u||u.tick(e,this._token)),u.draw(t,o*this.cellWidth,s*this.cellHeight)))}s=this._onScreenYStart}this.emit("postdraw",new xt(t,e,this))}}]),n}(Zn);xi([nt({message:"No longer used, will be removed in v0.26.0"})],Ci.prototype,"registerSpriteSheet",null);var Si=function(t){h(n,t);var e=d(n);function n(t,i,r,o,a,s){return f(this,n),e.call(this,t,i,r,o,a,s)}return n}(Re(Ci)),Ei=function(t){h(n,t);var e=d(n);function n(t,r,o,a,s){var l,u=arguments.length>5&&void 0!==arguments[5]&&arguments[5],c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:[];if(f(this,n),(l=e.call(this))._solid=!1,l.graphics=[],l.data=new Map,t&&"object"==typeof t){var h=t;t=h.x,r=h.y,o=h.width,a=h.height,s=h.index,u=h.solid,c=h.sprites}return l.x=t,l.y=r,l.width=o,l.height=a,l.index=s,l.solid=u,l.graphics=c,l._bounds=new ht(l.x,l.y,l.x+l.width,l.y+l.height),i(l)}return p(n,[{key:"solid",get:function(){return this._solid},set:function(t){var e;null===(e=this.map)||void 0===e||e.flagDirty(),this._solid=t}},{key:"bounds",get:function(){return this._bounds}},{key:"center",get:function(){return new rt(this.x+this.width/2,this.y+this.height/2)}},{key:"pushSprite",value:function(t){this.addGraphic(t)}},{key:"addGraphic",value:function(t){t instanceof Le?this.graphics.push(yi.fromLegacySprite(t)):this.graphics.push(t)}},{key:"removeGraphic",value:function(t){V(t,this.graphics)}},{key:"clearGraphics",value:function(){this.graphics.length=0}}]),n}(Zn);xi([nt({message:"Will be removed in v0.26.0",alternateMethod:"addSprite"})],Ei.prototype,"pushSprite",null);var Pi=function(t){h(n,t);var e=d(n);function n(t,i,r,o,a,s,l){return f(this,n),e.call(this,t,i,r,o,a,s,l)}return n}(Re(Ei)),Ai=function(){function t(e){f(this,t),this.camera=e}return p(t,[{key:"lockToActor",value:function(t){this.camera.addStrategy(new Ti(t))}},{key:"lockToActorAxis",value:function(t,e){this.camera.addStrategy(new Ri(t,e))}},{key:"elasticToActor",value:function(t,e,n){this.camera.addStrategy(new Di(t,e,n))}},{key:"radiusAroundActor",value:function(t,e){this.camera.addStrategy(new Mi(t,e))}},{key:"limitCameraBounds",value:function(t){this.camera.addStrategy(new Li(t))}}]),t}();!function(t){t[t.X=0]="X",t[t.Y=1]="Y"}(bi||(bi={}));var Ti=function t(e){f(this,t),this.target=e,this.action=function(t,e,n,i){return t.center}},Ri=function t(e,n){var i=this;f(this,t),this.target=e,this.axis=n,this.action=function(t,e,n,r){var o=t.center,a=e.getFocus();return i.axis===bi.X?new rt(o.x,a.y):new rt(a.x,o.y)}},Di=function t(e,n,i){var r=this;f(this,t),this.target=e,this.cameraElasticity=n,this.cameraFriction=i,this.action=function(t,e,n,i){var o=t.center,a=e.getFocus(),s=e.vel.clone(),l=o.sub(a).scale(r.cameraElasticity),u=(s=s.add(l)).scale(-1).scale(r.cameraFriction);return s=s.add(u),a=a.add(s)}},Mi=function t(e,n){var i=this;f(this,t),this.target=e,this.radius=n,this.action=function(t,e,n,r){var o=t.center,a=e.getFocus(),s=o.sub(a),l=s.size;if(l>=i.radius){var u=l-i.radius;return a.add(s.normalize().scale(u))}return a}},Li=function t(e){var n=this;f(this,t),this.target=e,this.boundSizeChecked=!1,this.action=function(t,e,i,r){var o=e.getFocus();n.boundSizeChecked||((t.bottom-t.top<i.drawHeight||t.right-t.left<i.drawWidth)&&P.getInstance().warn("Camera bounds should not be smaller than the engine viewport"),n.boundSizeChecked=!0);var a=o.x,s=o.y;return o.x<t.left+i.halfDrawWidth?a=t.left+i.halfDrawWidth:o.x>t.right-i.halfDrawWidth&&(a=t.right-i.halfDrawWidth),o.y<t.top+i.halfDrawHeight?s=t.top+i.halfDrawHeight:o.y>t.bottom-i.halfDrawHeight&&(s=t.bottom-i.halfDrawHeight),ot(a,s)}},Bi=function(t){h(n,t);var e=d(n);function n(){var t;return f(this,n),(t=e.apply(this,arguments))._cameraStrategies=[],t.strategy=new Ai(c(t)),t._z=1,t.dz=0,t.az=0,t.rotation=0,t.rx=0,t._posChanged=!1,t._pos=he(rt.Zero,(function(){return t._posChanged=!0})),t.vel=rt.Zero,t.acc=rt.Zero,t._cameraMoving=!1,t._currentLerpTime=0,t._lerpDuration=1e3,t._lerpStart=null,t._lerpEnd=null,t._isShaking=!1,t._shakeMagnitudeX=0,t._shakeMagnitudeY=0,t._shakeDuration=0,t._elapsedShakeTime=0,t._xShake=0,t._yShake=0,t._isZooming=!1,t._zoomStart=1,t._zoomEnd=1,t._currentZoomTime=0,t._zoomDuration=0,t._zoomEasing=He.EaseInOutCubic,t._easing=He.EaseInOutCubic,t._halfWidth=0,t._halfHeight=0,t._viewport=null,t._isInitialized=!1,t}return p(n,[{key:"zoom",get:function(){return this._z},set:function(t){this._z=t,this._engine&&(this._halfWidth=this._engine.halfDrawWidth,this._halfHeight=this._engine.halfDrawHeight)}},{key:"angularVelocity",get:function(){return this.rx},set:function(t){this.rx=t}},{key:"pos",get:function(){return this._pos},set:function(t){var e=this;this._pos=he(t,(function(){return e._posChanged=!0})),this._posChanged=!0}},{key:"x",get:function(){return this.pos.x},set:function(t){this._follow||this._cameraMoving||(this.pos=ot(t,this.pos.y))}},{key:"y",get:function(){return this.pos.y},set:function(t){this._follow||this._cameraMoving||(this.pos=ot(this.pos.x,t))}},{key:"dx",get:function(){return this.vel.x},set:function(t){this.vel=ot(t,this.vel.y)}},{key:"dy",get:function(){return this.vel.y},set:function(t){this.vel=ot(this.vel.x,t)}},{key:"ax",get:function(){return this.acc.x},set:function(t){this.acc=ot(t,this.acc.y)}},{key:"ay",get:function(){return this.acc.y},set:function(t){this.acc=ot(this.acc.x,t)}},{key:"getFocus",value:function(){return this.pos}},{key:"move",value:function(t,e){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:He.EaseInOutCubic;if("function"!=typeof i)throw"Please specify an EasingFunction";return this._follow?Promise.reject(t):(this._lerpPromise&&this._lerpResolve&&this._lerpResolve(t),this._lerpPromise=new Promise((function(t){n._lerpResolve=t})),this._lerpStart=this.getFocus().clone(),this._lerpDuration=e,this._lerpEnd=t,this._currentLerpTime=0,this._cameraMoving=!0,this._easing=i,this._lerpPromise)}},{key:"shake",value:function(t,e,n){this._isShaking=!0,this._shakeMagnitudeX=t,this._shakeMagnitudeY=e,this._shakeDuration=n}},{key:"zoomOverTime",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:He.EaseInOutCubic;return this._zoomPromise=new Promise((function(t){e._zoomResolve=t})),n?(this._isZooming=!0,this._zoomEasing=i,this._currentZoomTime=0,this._zoomDuration=n,this._zoomStart=this.zoom,this._zoomEnd=t,this._zoomPromise):(this._isZooming=!1,this.zoom=t,Promise.resolve(!0))}},{key:"viewport",get:function(){return this._viewport?this._viewport:new ht(0,0,0,0)}},{key:"addStrategy",value:function(t){this._cameraStrategies.push(t)}},{key:"removeStrategy",value:function(t){V(t,this._cameraStrategies)}},{key:"clearAllStrategies",value:function(){this._cameraStrategies.length=0}},{key:"_preupdate",value:function(t,e){this.emit("preupdate",new Et(t,e,this)),this.onPreUpdate(t,e)}},{key:"onPreUpdate",value:function(t,e){}},{key:"_postupdate",value:function(t,e){this.emit("postupdate",new Pt(t,e,this)),this.onPostUpdate(t,e)}},{key:"onPostUpdate",value:function(t,e){}},{key:"isInitialized",get:function(){return this._isInitialized}},{key:"_initialize",value:function(t){this.isInitialized||(this._engine=t,this._halfWidth=t.halfDrawWidth,this._halfHeight=t.halfDrawHeight,this._posChanged||(this.pos.x=t.halfDrawWidth,this.pos.y=t.halfDrawHeight),this.onInitialize(t),r(o(n.prototype),"emit",this).call(this,"initialize",new Xt(t,this)),this._isInitialized=!0)}},{key:"onInitialize",value:function(t){}},{key:"on",value:function(t,e){r(o(n.prototype),"on",this).call(this,t,e)}},{key:"off",value:function(t,e){r(o(n.prototype),"off",this).call(this,t,e)}},{key:"once",value:function(t,e){r(o(n.prototype),"once",this).call(this,t,e)}},{key:"update",value:function(t,e){if(this._initialize(t),this._preupdate(t,e),this.pos=this.pos.add(this.vel.scale(e/1e3)),this.zoom+=this.dz*e/1e3,this.vel=this.vel.add(this.acc.scale(e/1e3)),this.dz+=this.az*e/1e3,this.rotation+=this.angularVelocity*e/1e3,this._isZooming)if(this._currentZoomTime<this._zoomDuration){var n=(0,this._zoomEasing)(this._currentZoomTime,this._zoomStart,this._zoomEnd,this._zoomDuration);this.zoom=n,this._currentZoomTime+=e}else this._isZooming=!1,this.zoom=this._zoomEnd,this._currentZoomTime=0,this._zoomResolve(!0);if(this._cameraMoving)if(this._currentLerpTime<this._lerpDuration){var i=He.CreateVectorEasingFunction(this._easing)(this._currentLerpTime,this._lerpStart,this._lerpEnd,this._lerpDuration);this.pos=i,this._currentLerpTime+=e}else{this.pos=this._lerpEnd;var r=this._lerpEnd.clone();this._lerpStart=null,this._lerpEnd=null,this._currentLerpTime=0,this._cameraMoving=!1,this._lerpResolve(r)}this._isDoneShaking()?(this._isShaking=!1,this._elapsedShakeTime=0,this._shakeMagnitudeX=0,this._shakeMagnitudeY=0,this._shakeDuration=0,this._xShake=0,this._yShake=0):(this._elapsedShakeTime+=e,this._xShake=1+(Math.random()*this._shakeMagnitudeX|0),this._yShake=1+(Math.random()*this._shakeMagnitudeY|0));var o,a=s(this._cameraStrategies);try{for(a.s();!(o=a.n()).done;){var l=o.value;this.pos=l.action.call(l,l.target,this,t,e)}}catch(u){a.e(u)}finally{a.f()}this._viewport=new ht(this.x-this._halfWidth,this.y-this._halfHeight,this.x+this._halfWidth,this.y+this._halfHeight),this._postupdate(t,e)}},{key:"draw",value:function(t){var e=0,n=0;t instanceof CanvasRenderingContext2D?(e=t.canvas.width,n=t.canvas.height):(e=t.width,n=t.height);var i=this.getFocus(),r=this._engine?this._engine.pixelRatio:1,o=this.zoom,a=e/o/r,s=n/o/r;t.scale(o,o),t.translate(-i.x+a/2+this._xShake,-i.y+s/2+this._yShake)}},{key:"debugDraw",value:function(t){}},{key:"_isDoneShaking",value:function(){return!this._isShaking||this._elapsedShakeTime>=this._shakeDuration}}]),n}(te);function Oi(t){return t instanceof si}var Fi,Ii={pos:rt.Zero,width:10,height:10,visible:!1,action:function(){},filter:function(){return!0},repeat:-1},zi=function(t){h(n,t);var e=d(n);function n(t){var i;return f(this,n),(i=e.call(this,{x:t.pos.x,y:t.pos.y,width:t.width,height:t.height})).action=function(){},i.filter=function(){return!0},i.repeat=-1,t=L({},Ii,t),i.filter=t.filter||i.filter,i.repeat=t.repeat||i.repeat,i.action=t.action||i.action,t.target&&(i.target=t.target),i.graphics.visible=t.visible,i.body.collisionType=Je.Passive,i.eventDispatcher=new Jt(c(i)),i.events.on("collisionstart",(function(t){i.filter(t.other)&&(i.emit("enter",new Zt(c(i),t.other)),i._dispatchAction(),0===i.repeat&&i.kill())})),i.events.on("collisionend",(function(t){i.filter(t.other)&&i.emit("exit",new $t(c(i),t.other))})),i}return p(n,[{key:"target",get:function(){return this._target},set:function(t){this._target=t,this.filter=function(e){return e===t}}},{key:"_initialize",value:function(t){r(o(n.prototype),"_initialize",this).call(this,t)}},{key:"_dispatchAction",value:function(){0!==this.repeat&&(this.action.call(this),this.repeat--)}},{key:"debugDraw",value:function(t){r(o(n.prototype),"debugDraw",this).call(this,t),t.save(),t.translate(this.pos.x,this.pos.y);var e=this.collider.bounds,i=this.getGlobalPos();e.left=e.left-i.x,e.right=e.right-i.x,e.top=e.top-i.y,e.bottom=e.bottom-i.y,t.fillStyle=ut.Violet.toString(),t.strokeStyle=ut.Violet.toString(),t.fillText("Trigger",10,10),e.debugDraw(t),t.restore()}}]),n}(ai);!function(t){t.Update="update",t.Draw="draw"}(Fi||(Fi={}));var Ni=function(){function t(){f(this,t),this.priority=0}return p(t,[{key:"notify",value:function(t){}}]),t}(),Ui=function t(e){f(this,t),this.data=e,this.type="Entity Added"};function Hi(t){return!!t&&"Entity Added"===t.type}var Wi=function t(e){f(this,t),this.data=e,this.type="Entity Removed"};function ji(t){return!!t&&"Entity Removed"===t.type}var Vi,Gi,Xi=function(){function t(e){f(this,t),this._world=e,this.entities=[],this._entityIndex={},this._entitiesToRemove=[]}return p(t,[{key:"updateEntities",value:function(t,e){var n,i=s(this.entities);try{for(i.s();!(n=i.n()).done;){var r=n.value;r.update(t.engine,e),r.active||this.removeEntity(r)}}catch(o){i.e(o)}finally{i.f()}}},{key:"notify",value:function(t){Kn(t)&&this._world.queryManager.addEntity(t.data.entity),Yn(t)&&this._world.queryManager.removeComponent(t.data.entity,t.data.component)}},{key:"addEntity",value:function(t){var e=this;t.active=!0,t&&!this._entityIndex[t.id]&&(this._entityIndex[t.id]=t,this.entities.push(t),this._world.queryManager.addEntity(t),t.componentAdded$.register(this),t.componentRemoved$.register(this),t.children.forEach((function(t){return e.addEntity(t)})),t.childrenAdded$.register({notify:function(t){e.addEntity(t)}}),t.childrenRemoved$.register({notify:function(t){e.removeEntity(t,!1)}}))}},{key:"removeEntity",value:function(t){var e,n=this,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=0;r=t instanceof Zn?t.id:t;var o=this._entityIndex[r];o&&o.active&&o.kill(),o&&i?this._entitiesToRemove.push(o):(delete this._entityIndex[r],o&&(V(o,this.entities),this._world.queryManager.removeEntity(o),o.componentAdded$.unregister(this),o.componentRemoved$.unregister(this),o.children.forEach((function(t){return n.removeEntity(t,i)})),o.childrenAdded$.clear(),o.childrenRemoved$.clear(),(null===(e=this._world.context)||void 0===e?void 0:e.engine)&&this._world.context.engine.stats.currFrame.actors.killed++))}},{key:"processEntityRemovals",value:function(){var t,e=s(this._entitiesToRemove);try{for(e.s();!(t=e.n()).done;){var n=t.value;n.active||this.removeEntity(n,!1)}}catch(i){e.e(i)}finally{e.f()}}},{key:"processComponentRemovals",value:function(){var t,e=s(this.entities);try{for(e.s();!(t=e.n()).done;)t.value.processComponentRemoval()}catch(n){e.e(n)}finally{e.f()}}},{key:"getById",value:function(t){return this._entityIndex[t]}},{key:"getByName",value:function(t){return this.entities.filter((function(e){return e.name===t}))}},{key:"clear",value:function(){var t,e=s(this.entities);try{for(e.s();!(t=e.n()).done;){var n=t.value;this.removeEntity(n)}}catch(i){e.e(i)}finally{e.f()}}}]),t}(),qi=function(t){return a(t).sort((function(t,e){return t.localeCompare(e)})).join("+")},Ki=function(t){h(n,t);var e=d(n);function n(t){var i;return f(this,n),(i=e.call(this))._entities=[],t[0]instanceof Function?i.types=t.map((function(t){return(new t).type})):i.types=t,i}return p(n,[{key:"key",get:function(){return this._key?this._key:this._key=qi(this.types)}},{key:"getEntities",value:function(t){return t&&this._entities.sort(t),this._entities}},{key:"addEntity",value:function(t){!G(this._entities,t)&&this.matches(t)&&(this._entities.push(t),this.notifyAll(new Ui(t)))}},{key:"removeEntity",value:function(t){V(t,this._entities)&&this.notifyAll(new Wi(t))}},{key:"clear",value:function(){this._entities.length=0;var t,e=s(this.observers);try{for(e.s();!(t=e.n()).done;){var n=t.value;this.unregister(n)}}catch(i){e.e(i)}finally{e.f()}}},{key:"matches",value:function(t){var e=[];e=t instanceof Zn?t.types:t;var n,i=!0,r=s(this.types);try{for(r.s();!(n=r.n()).done;){var o=n.value;if(!(i=i&&e.indexOf(o)>-1))return!1}}catch(a){r.e(a)}finally{r.f()}return i}},{key:"contain",value:function(t){return this.types.indexOf(t)>-1}}]),n}(kn),Qi=function(){function t(e){f(this,t),this._world=e,this._queries={}}return p(t,[{key:"_addQuery",value:function(t){this._queries[qi(t.types)]=t;var e,n=s(this._world.entityManager.entities);try{for(n.s();!(e=n.n()).done;){var i=e.value;t.addEntity(i)}}catch(r){n.e(r)}finally{n.f()}}},{key:"maybeRemoveQuery",value:function(t){0===t.observers.length&&(t.clear(),delete this._queries[qi(t.types)])}},{key:"addEntity",value:function(t){for(var e in this._queries)this._queries[e]&&this._queries[e].addEntity(t)}},{key:"removeComponent",value:function(t,e){for(var n in this._queries)this._queries[n].contain(e.type)&&this._queries[n].removeEntity(t)}},{key:"removeEntity",value:function(t){for(var e in this._queries)this._queries[e].removeEntity(t)}},{key:"createQuery",value:function(t){var e=this.getQuery(t);if(e)return e;var n=new Ki(t);return this._addQuery(n),n}},{key:"getQuery",value:function(t){var e=qi(t);return this._queries[e]?this._queries[e]:null}}]),t}(),Yi=function(){function t(e){f(this,t),this._world=e,this.systems=[],this.initialized=!1}return p(t,[{key:"get",value:function(t){return this.systems.find((function(e){return e instanceof t}))}},{key:"addSystem",value:function(t){if(!t.types||0===t.types.length)throw new Error("Attempted to add a System without any types");var e=this._world.queryManager.createQuery(t.types);this.systems.push(t),this.systems.sort((function(t,e){return t.priority-e.priority})),e.register(t),this.initialized&&t.initialize&&t.initialize(this._world.context)}},{key:"removeSystem",value:function(t){V(t,this.systems);var e=this._world.queryManager.getQuery(t.types);e&&(e.unregister(t),this._world.queryManager.maybeRemoveQuery(e))}},{key:"updateSystems",value:function(t,e,n){if(!this.initialized){this.initialized=!0;var i,r=s(this.systems);try{for(r.s();!(i=r.n()).done;){var o=i.value;o.initialize&&o.initialize(this._world.context)}}catch(w){r.e(w)}finally{r.f()}}var a,l=this.systems.filter((function(e){return e.systemType===t})),u=s(l);try{for(u.s();!(a=u.n()).done;){var c=a.value;c.preupdate&&c.preupdate(e,n)}}catch(w){u.e(w)}finally{u.f()}var h,d=s(l);try{for(d.s();!(h=d.n()).done;){var f=h.value,p=this._world.queryManager.getQuery(f.types).getEntities(f.sort);if(e instanceof br){var v,g=s(p);try{for(g.s();!(v=g.n()).done;)v.value._initialize(null==e?void 0:e.engine)}catch(w){g.e(w)}finally{g.f()}}f.update(p,n)}}catch(w){d.e(w)}finally{d.f()}var y,m=s(l);try{for(m.s();!(y=m.n()).done;){var _=y.value;_.postupdate&&_.postupdate(e,n)}}catch(w){m.e(w)}finally{m.f()}}},{key:"clear",value:function(){var t,e=s(this.systems);try{for(e.s();!(t=e.n()).done;){var n=t.value;this.removeSystem(n)}}catch(i){e.e(i)}finally{e.f()}}}]),t}(),Zi=function(){function t(e){f(this,t),this.context=e,this.queryManager=new Qi(this),this.entityManager=new Xi(this),this.systemManager=new Yi(this)}return p(t,[{key:"update",value:function(t,e){t===Fi.Update&&this.entityManager.updateEntities(this.context,e),this.systemManager.updateSystems(t,this.context,e),this.entityManager.processComponentRemovals(),this.entityManager.processEntityRemovals()}},{key:"add",value:function(t){t instanceof Zn&&this.entityManager.addEntity(t),t instanceof Ni&&this.systemManager.addSystem(t)}},{key:"remove",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t instanceof Zn&&this.entityManager.removeEntity(t,e),t instanceof Ni&&this.systemManager.removeSystem(t)}},{key:"clearEntities",value:function(){this.entityManager.clear()}},{key:"clearSystems",value:function(){this.systemManager.clear()}}]),t}(),$i=function(){function t(){f(this,t)}return p(t,null,[{key:"integrate",value:function(t,e,n,i){var r=i/1e3;e.vel.addEqual(n.scale(r)),t.pos.addEqual(e.vel.scale(r)).addEqual(n.scale(.5*r*r)),e.angularVelocity+=e.torque*(1/e.inertia)*r,t.rotation+=e.angularVelocity*r,t.scale.addEqual(e.scaleFactor.scale(r))}}]),t}(),Ji=function(t){h(n,t);var e=d(n);function n(){var t;return f(this,n),(t=e.apply(this,arguments)).types=["ex.transform","ex.motion"],t.systemType=Fi.Update,t.priority=-1,t}return p(n,[{key:"update",value:function(t,e){var n,i,r,o=s(t);try{for(o.s();!(r=o.n()).done;){var a=r.value;n=a.get(rn),i=a.get(Ze);var l=a.get(jn);if(!(null==l?void 0:l.sleeping)){var u=i.acc.clone();(null==l?void 0:l.collisionType)===Je.Active&&(null==l?void 0:l.useGravity)&&u.addEqual(wn.gravity),null==l||l.captureOldTransform(),$i.integrate(n,i,u,e)}}}catch(c){o.e(c)}finally{o.f()}}},{key:"debugDraw",value:function(t){}}]),n}(Ni),tr=function(){function t(){f(this,t)}return p(t,[{key:"solve",value:function(t){return this.preSolve(t),t=t.filter((function(t){return!t.isCanceled()})),this.solveVelocity(t),this.solvePosition(t),this.postSolve(t),t}}]),t}(),er=function(t){h(n,t);var e=d(n);function n(){return f(this,n),e.apply(this,arguments)}return p(n,[{key:"preSolve",value:function(t){var e,n=s(t);try{for(n.s();!(e=n.n()).done;){var i=e.value,r=A.fromDirection(i.mtv),o=i.mtv.negate();i.colliderA.events.emit("precollision",new zt(i.colliderA,i.colliderB,r,o)),i.colliderB.events.emit("precollision",new zt(i.colliderB,i.colliderA,A.getOpposite(r),o.negate()))}}catch(a){n.e(a)}finally{n.f()}}},{key:"postSolve",value:function(t){var e,n,i,r=s(t);try{for(r.s();!(i=r.n()).done;){var o=i.value,a=o.colliderA,l=o.colliderB,u=null===(e=a.owner)||void 0===e?void 0:e.get(jn),c=null===(n=l.owner)||void 0===n?void 0:n.get(jn);if(!u||!c||u.collisionType!==Je.Passive&&c.collisionType!==Je.Passive){var h=A.fromDirection(o.mtv),d=o.mtv.negate();o.colliderA.events.emit("postcollision",new Nt(o.colliderA,o.colliderB,h,d)),o.colliderB.events.emit("postcollision",new Nt(o.colliderB,o.colliderA,A.getOpposite(h),d.negate()))}}}catch(f){r.e(f)}finally{r.f()}}},{key:"solvePosition",value:function(t){var e,n,i,r=s(t);try{for(r.s();!(i=r.n()).done;){var o=i.value,a=o.mtv,l=o.colliderA,u=o.colliderB,c=null===(e=l.owner)||void 0===e?void 0:e.get(jn),h=null===(n=u.owner)||void 0===n?void 0:n.get(jn);if(c&&h){if(c.collisionType===Je.Passive||h.collisionType===Je.Passive)continue;c.collisionType===Je.Active&&h.collisionType===Je.Active&&(a=a.scale(.5)),c.collisionType===Je.Active&&(c.pos.x-=a.x,c.pos.y-=a.y),h.collisionType===Je.Active&&(h.pos.x+=a.x,h.pos.y+=a.y)}}}catch(d){r.e(d)}finally{r.f()}}},{key:"solveVelocity",value:function(t){var e,n,i,r=s(t);try{for(r.s();!(i=r.n()).done;){var o=i.value,a=o.colliderA,l=o.colliderB,u=null===(e=a.owner)||void 0===e?void 0:e.get(jn),c=null===(n=l.owner)||void 0===n?void 0:n.get(jn);if(u&&c){if(u.collisionType===Je.Passive||c.collisionType===Je.Passive)continue;var h=o.normal,d=h.negate();if(u.collisionType===Je.Active){var f=h.scale(h.dot(u.vel.negate()));u.vel=u.vel.add(f)}if(c.collisionType===Je.Active){var p=d.scale(d.dot(c.vel.negate()));c.vel=c.vel.add(p)}}}}catch(v){r.e(v)}finally{r.f()}}}]),n}(tr),nr=function(){function t(e,n,i){f(this,t),this.point=e,this.local=n,this.contact=i,this.normalImpulse=0,this.tangentImpulse=0,this.normalMass=0,this.tangentMass=0,this.aToContact=new rt(0,0),this.bToContact=new rt(0,0),this.update()}return p(t,[{key:"update",value:function(){var t,e,n=null===(t=this.contact.colliderA.owner)||void 0===t?void 0:t.get(jn),i=null===(e=this.contact.colliderB.owner)||void 0===e?void 0:e.get(jn);if(n&&i){var r=this.contact.normal,o=this.contact.tangent;this.aToContact=this.point.sub(n.pos),this.bToContact=this.point.sub(i.pos);var a=this.aToContact.cross(r),s=this.bToContact.cross(r);this.normalMass=n.inverseMass+i.inverseMass+n.inverseInertia*a*a+i.inverseInertia*s*s;var l=this.aToContact.cross(o),u=this.bToContact.cross(o);this.tangentMass=n.inverseMass+i.inverseMass+n.inverseInertia*l*l+i.inverseInertia*u*u}return this}},{key:"getRelativeVelocity",value:function(){var t,e,n=null===(t=this.contact.colliderA.owner)||void 0===t?void 0:t.get(jn),i=null===(e=this.contact.colliderB.owner)||void 0===e?void 0:e.get(jn);if(n&&i){var r=n.vel.add(rt.cross(n.angularVelocity,this.aToContact));return i.vel.add(rt.cross(i.angularVelocity,this.bToContact)).sub(r)}return rt.Zero}}]),t}(),ir=function(t){h(n,t);var e=d(n);function n(){var t;return f(this,n),(t=e.apply(this,arguments)).lastFrameContacts=new Map,t.idToContactConstraint=new Map,t}return p(n,[{key:"getContactConstraints",value:function(t){var e;return null!==(e=this.idToContactConstraint.get(t))&&void 0!==e?e:[]}},{key:"preSolve",value:function(t){var e,n,i,r,o=s(t);try{for(o.s();!(r=o.n()).done;){var a=r.value,l=A.fromDirection(a.mtv);a.colliderA.events.emit("precollision",new zt(a.colliderA,a.colliderB,l,a.mtv)),a.colliderA.events.emit("beforecollisionresolve",new Wt(a.colliderA,a.colliderB,l,a.mtv,a)),a.colliderB.events.emit("precollision",new zt(a.colliderB,a.colliderA,A.getOpposite(l),a.mtv.negate())),a.colliderB.events.emit("beforecollisionresolve",new Wt(a.colliderB,a.colliderA,A.getOpposite(l),a.mtv.negate(),a)),a.matchAwake()}}catch(W){o.e(W)}finally{o.f()}var u,c=Array.from(this.idToContactConstraint.keys()),h=s(t);try{for(h.s();!(u=h.n()).done;){var d=u.value,f=c.indexOf(d.id);f>-1&&c.splice(f,1);var p=null!==(e=this.idToContactConstraint.get(d.id))&&void 0!==e?e:[],v=0,g=d.colliderA.owner.get(jn),y=d.colliderB.owner.get(jn);if(g&&y){var m,_=s(d.points);try{for(_.s();!(m=_.n()).done;){var w=m.value,b=d.normal,k=d.tangent,x=w.sub(g.pos),C=w.sub(y.pos),S=x.cross(b),E=C.cross(b),P=g.inverseMass+y.inverseMass+g.inverseInertia*S*S+y.inverseInertia*E*E,T=x.cross(k),R=C.cross(k),D=g.inverseMass+y.inverseMass+g.inverseInertia*T*T+y.inverseInertia*R*R;p[v]&&(null===(i=null===(n=p[v])||void 0===n?void 0:n.point)||void 0===i?void 0:i.squareDistance(w))<4?(p[v].point=w,p[v].local=d.localPoints[v]):p[v]=new nr(w,d.localPoints[v],d),p[v].aToContact=x,p[v].bToContact=C,p[v].normalMass=P,p[v].tangentMass=D,v++}}catch(W){_.e(W)}finally{_.f()}}this.idToContactConstraint.set(d.id,p)}}catch(W){h.e(W)}finally{h.f()}for(var M=0,L=c;M<L.length;M++){var B=L[M];this.idToContactConstraint.delete(B)}if(wn.warmStart)this.warmStart(t);else{var O,F=s(t);try{for(F.s();!(O=F.n()).done;){var I,z=O.value,N=this.getContactConstraints(z.id),U=s(N);try{for(U.s();!(I=U.n()).done;){var H=I.value;H.normalImpulse=0,H.tangentImpulse=0}}catch(W){U.e(W)}finally{U.f()}}}catch(W){F.e(W)}finally{F.f()}}}},{key:"postSolve",value:function(t){var e,n=s(t);try{for(n.s();!(e=n.n()).done;){var i=e.value,r=i.colliderA.owner.get(jn),o=i.colliderB.owner.get(jn);if(r&&o){if(r.collisionType===Je.Passive||o.collisionType===Je.Passive)continue;r.updateMotion(),o.updateMotion()}var a=A.fromDirection(i.mtv);i.colliderA.events.emit("postcollision",new Nt(i.colliderA,i.colliderB,a,i.mtv)),i.colliderA.events.emit("aftercollisionresolve",new jt(i.colliderA,i.colliderB,a,i.mtv,i)),i.colliderB.events.emit("postcollision",new Nt(i.colliderB,i.colliderA,A.getOpposite(a),i.mtv.negate())),i.colliderB.events.emit("aftercollisionresolve",new jt(i.colliderB,i.colliderA,A.getOpposite(a),i.mtv.negate(),i))}}catch(h){n.e(h)}finally{n.f()}this.lastFrameContacts.clear();var l,u=s(t);try{for(u.s();!(l=u.n()).done;){var c=l.value;this.lastFrameContacts.set(c.id,c)}}catch(h){u.e(h)}finally{u.f()}}},{key:"warmStart",value:function(t){var e,n,i,r,o=s(t);try{for(o.s();!(r=o.n()).done;){var a=r.value,l=null===(e=a.colliderA.owner)||void 0===e?void 0:e.get(jn),u=null===(n=a.colliderB.owner)||void 0===n?void 0:n.get(jn);if(l&&u){var c,h=null!==(i=this.idToContactConstraint.get(a.id))&&void 0!==i?i:[],d=s(h);try{for(d.s();!(c=d.n()).done;){var f=c.value;if(wn.warmStart){var p=a.normal.scale(f.normalImpulse),v=a.tangent.scale(f.tangentImpulse),g=p.add(v);l.applyImpulse(f.point,g.negate()),u.applyImpulse(f.point,g)}else f.normalImpulse=0,f.tangentImpulse=0}}catch(y){d.e(y)}finally{d.f()}}}}catch(y){o.e(y)}finally{o.f()}}},{key:"solvePosition",value:function(t){for(var e,n,i,r=0;r<wn.positionIterations;r++){var o,a=s(t);try{for(a.s();!(o=a.n()).done;){var l=o.value,u=null===(e=l.colliderA.owner)||void 0===e?void 0:e.get(jn),c=null===(n=l.colliderB.owner)||void 0===n?void 0:n.get(jn);if(u&&c){if(u.collisionType===Je.Passive||c.collisionType===Je.Passive)continue;var h,d=null!==(i=this.idToContactConstraint.get(l.id))&&void 0!==i?i:[],f=s(d);try{for(f.s();!(h=f.n()).done;){var p=h.value,v=l.normal,g=zn.FindContactSeparation(l,p.local),y=-5,m=F(wn.steeringFactor*(g+wn.slop),y,0),_=v.scale(-m/p.normalMass);u.collisionType===Je.Active&&(u.pos=u.pos.add(_.negate().scale(u.inverseMass)),u.rotation-=p.aToContact.cross(_)*u.inverseInertia),c.collisionType===Je.Active&&(c.pos=c.pos.add(_.scale(c.inverseMass)),c.rotation+=p.bToContact.cross(_)*c.inverseInertia)}}catch(w){f.e(w)}finally{f.f()}}}}catch(w){a.e(w)}finally{a.f()}}}},{key:"solveVelocity",value:function(t){for(var e,n,i,r=0;r<wn.velocityIterations;r++){var o,a=s(t);try{for(a.s();!(o=a.n()).done;){var l=o.value,u=null===(e=l.colliderA.owner)||void 0===e?void 0:e.get(jn),c=null===(n=l.colliderB.owner)||void 0===n?void 0:n.get(jn);if(u&&c){if(u.collisionType===Je.Passive||c.collisionType===Je.Passive)continue;var h,d=u.bounciness*c.bounciness,f=Math.min(u.friction,c.friction),p=null!==(i=this.idToContactConstraint.get(l.id))&&void 0!==i?i:[],v=s(p);try{for(v.s();!(h=v.n()).done;){var g=h.value,y=-g.getRelativeVelocity().dot(l.tangent)/g.tangentMass,m=f*g.normalImpulse,_=F(g.tangentImpulse+y,-m,m);y=_-g.tangentImpulse,g.tangentImpulse=_;var w=l.tangent.scale(y);u.applyImpulse(g.point,w.negate()),c.applyImpulse(g.point,w)}}catch(P){v.e(P)}finally{v.f()}var b,k=s(p);try{for(k.s();!(b=k.n()).done;){var x=b.value,C=-(1+d)*x.getRelativeVelocity().dot(l.normal)/x.normalMass,S=Math.max(x.normalImpulse+C,0);C=S-x.normalImpulse,x.normalImpulse=S;var E=l.normal.scale(C);u.applyImpulse(x.point,E.negate()),c.applyImpulse(x.point,E)}}catch(P){k.e(P)}finally{k.f()}}}}catch(P){a.e(P)}finally{a.f()}}}}]),n}(tr),rr=function(t){h(n,t);var e=d(n);function n(){var t;return f(this,n),(t=e.apply(this,arguments)).types=["ex.transform","ex.motion","ex.collider"],t.systemType=Fi.Update,t.priority=-1,t._realisticSolver=new ir,t._arcadeSolver=new er,t._processor=new An,t._lastFrameContacts=new Map,t._currentFrameContacts=new Map,t._trackCollider=function(e){return t._processor.track(e)},t._untrackCollider=function(e){return t._processor.untrack(e)},t}return p(n,[{key:"notify",value:function(t){if(Hi(t)){var e=t.data.get(Wn);e.$colliderAdded.subscribe(this._trackCollider),e.$colliderRemoved.subscribe(this._untrackCollider);var n=e.get();n&&this._processor.track(n)}else{var i=t.data.get(Wn),r=i.get();i&&r&&this._processor.untrack(r)}}},{key:"initialize",value:function(t){this._engine=t.engine}},{key:"update",value:function(t,e){var n,i=this;if(wn.enabled){var r,o=[],a=s(t);try{for(a.s();!(r=a.n()).done;){var l=r.value.get(Wn),u=null==l?void 0:l.get();l&&(null===(n=l.owner)||void 0===n?void 0:n.active)&&u&&(l.update(),u instanceof Rn?o=o.concat(u.getColliders()):o.push(u))}}catch(d){a.e(d)}finally{a.f()}this._processor.update(o);var c=this._processor.broadphase(o,e);this._currentFrameContacts.clear();var h=this._processor.narrowphase(c,this._engine.debug.stats.currFrame);(h=this.getSolver().solve(h)).forEach((function(t){return i._currentFrameContacts.set(t.id,t)})),this.runContactStartEnd(),this._lastFrameContacts.clear(),this._lastFrameContacts=new Map(this._currentFrameContacts)}}},{key:"getSolver",value:function(){return wn.collisionResolutionStrategy===gn.Realistic?this._realisticSolver:this._arcadeSolver}},{key:"debug",value:function(t){this._processor.debug(t)}},{key:"runContactStartEnd",value:function(){var t,e=s(this._currentFrameContacts);try{for(e.s();!(t=e.n()).done;){var n=l(t.value,2),i=n[0],r=n[1];if(!this._lastFrameContacts.has(i)){var o=r.colliderA,a=r.colliderB;o.events.emit("collisionstart",new Vt(o,a,r)),o.events.emit("contactstart",new Ut(o,a,r)),a.events.emit("collisionstart",new Vt(a,o,r)),a.events.emit("contactstart",new Ut(a,o,r))}}}catch(g){e.e(g)}finally{e.f()}var u,c=s(this._lastFrameContacts);try{for(c.s();!(u=c.n()).done;){var h=l(u.value,2),d=h[0],f=h[1];if(!this._currentFrameContacts.has(d)){var p=f.colliderA,v=f.colliderB;p.events.emit("collisionend",new Gt(p,v)),p.events.emit("contactend",new Ht(p,v)),v.events.emit("collisionend",new Gt(v,p)),v.events.emit("contactend",new Ht(v,p))}}}catch(g){c.e(g)}finally{c.f()}}}]),n}(Ni),or=function(){function t(){f(this,t)}return p(t,null,[{key:"clear",value:function(){t.DrawCallCount=0,t.DrawnImagesCount=0}}]),t}();or.DrawCallCount=0,or.DrawnImagesCount=0,function(t){t.End="end",t.Loop="loop",t.PingPong="pingpong",t.Freeze="freeze"}(Vi||(Vi={}));var ar=function(t){h(n,t);var e=d(n);function n(t){var i,r,o;return f(this,n),(i=e.call(this,t)).events=new Jt(c(i)),i.frames=[],i.strategy=Vi.Loop,i.frameDuration=100,i.timeScale=1,i._idempotencyToken=-1,i._firstTick=!0,i._currentFrame=0,i._timeLeftInFrame=0,i._direction=1,i._done=!1,i._playing=!0,i.frames=t.frames,i.strategy=null!==(r=t.strategy)&&void 0!==r?r:i.strategy,i.frameDuration=null!==(o=t.frameDuration)&&void 0!==o?o:i.frameDuration,i.goToFrame(0),i}return p(n,[{key:"clone",value:function(){return new n(Object.assign({frames:this.frames.map((function(t){return Object.assign({},t)})),frameDuration:this.frameDuration,strategy:this.strategy},this.cloneGraphicOptions()))}},{key:"currentFrame",get:function(){return this._currentFrame>=0&&this._currentFrame<this.frames.length?this.frames[this._currentFrame]:null}},{key:"isPlaying",get:function(){return this._playing}},{key:"play",value:function(){this._playing=!0}},{key:"pause",value:function(){this._playing=!1,this._firstTick=!0}},{key:"reset",value:function(){this._done=!1,this._firstTick=!0,this._currentFrame=0}},{key:"canFinish",get:function(){switch(this.strategy){case Vi.End:case Vi.Freeze:return!0;default:return!1}}},{key:"done",get:function(){return this._done}},{key:"goToFrame",value:function(t){var e,n;this._currentFrame=t,this._timeLeftInFrame=this.frameDuration;var i=this.frames[this._currentFrame];i&&!this._done&&(this._timeLeftInFrame=(null==i?void 0:i.duration)||this.frameDuration,this.width=null===(e=i.graphic)||void 0===e?void 0:e.width,this.height=null===(n=i.graphic)||void 0===n?void 0:n.height,this.events.emit("frame",i))}},{key:"_nextFrame",value:function(){var t=this._currentFrame;if(this._done)return t;var e=-1;switch(this.strategy){case Vi.Loop:0===(e=(t+1)%this.frames.length)&&this.events.emit("loop",this);break;case Vi.End:(e=t+1)>=this.frames.length&&(this._done=!0,this._currentFrame=this.frames.length,this.events.emit("end",this));break;case Vi.Freeze:(e=F(t+1,0,this.frames.length-1))>=this.frames.length-1&&(this._done=!0,this.events.emit("end",this));break;case Vi.PingPong:t+this._direction>=this.frames.length&&(this._direction=-1,this.events.emit("loop",this)),t+this._direction<0&&(this._direction=1,this.events.emit("loop",this)),e=t+this._direction%this.frames.length}return e}},{key:"tick",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._idempotencyToken!==e&&(this._idempotencyToken=e,this._playing&&(this._firstTick&&(this._firstTick=!1,this.events.emit("frame",this.currentFrame)),this._timeLeftInFrame-=t*this.timeScale,this._timeLeftInFrame<=0&&this.goToFrame(this._nextFrame()),this._updateDimensions()))}},{key:"_updateDimensions",value:function(){var t,e;this.currentFrame&&(this.width=null===(t=this.currentFrame.graphic)||void 0===t?void 0:t.width,this.height=null===(e=this.currentFrame.graphic)||void 0===e?void 0:e.height)}},{key:"_drawImage",value:function(t,e,n){this.currentFrame&&this.currentFrame.graphic.draw(t,e,n)}}],[{key:"fromSpriteSheet",value:function(t,e,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Vi.Loop,o=t.sprites.length-1,a=e.filter((function(t){return t<0||t>o}));return a.length&&n._LOGGER.warn("Indices into SpriteSheet were provided that don't exist: ".concat(a.join(",")," no frame will be shown")),new n({frames:t.sprites.filter((function(t,n){return e.indexOf(n)>-1})).map((function(t){return{graphic:t,duration:i}})),strategy:r})}},{key:"toLegacyAnimation",value:function(t,e){var n=e.frames.map((function(t){return yi.toLegacySprite(t.graphic)}));return new Ie({sprites:n,loop:e.strategy===Vi.Loop,freezeFrame:e.strategy===Vi.Freeze?n.length-1:void 0,speed:e.frameDuration,engine:t})}}]),n}(se);ar._LOGGER=P.getInstance();var sr=function(t){h(n,t);var e=d(n);function n(t){var i;return f(this,n),(i=e.call(this,t)).members=[],i.members=t.members,i._updateDimensions(),i}return p(n,[{key:"clone",value:function(){return new n(Object.assign({members:a(this.members)},this.cloneGraphicOptions()))}},{key:"_updateDimensions",value:function(){var t,e=new ht,n=s(this.members);try{for(n.s();!(t=n.n()).done;){var i=t.value,r=i.graphic,o=i.pos;e=r.localBounds.translate(o).combine(e)}}catch(a){n.e(a)}finally{n.f()}return this.width=e.width,this.height=e.height,e}},{key:"localBounds",get:function(){var t,e=new ht,n=s(this.members);try{for(n.s();!(t=n.n()).done;){var i=t.value,r=i.graphic,o=i.pos;e=r.localBounds.translate(o).combine(e)}}catch(a){n.e(a)}finally{n.f()}return e}},{key:"_isAnimationOrGroup",value:function(t){return t instanceof ar||t instanceof n}},{key:"tick",value:function(t,e){var n,i=s(this.members);try{for(i.s();!(n=i.n()).done;){var r=n.value.graphic;this._isAnimationOrGroup(r)&&r.tick(t,e)}}catch(o){i.e(o)}finally{i.f()}}},{key:"reset",value:function(){var t,e=s(this.members);try{for(e.s();!(t=e.n()).done;){var n=t.value.graphic;this._isAnimationOrGroup(n)&&n.reset()}}catch(i){e.e(i)}finally{e.f()}}},{key:"_preDraw",value:function(t,e,i){this._updateDimensions(),r(o(n.prototype),"_preDraw",this).call(this,t,e,i)}},{key:"_drawImage",value:function(t,e,n){var i,r=s(this.members);try{for(r.s();!(i=r.n()).done;){var o=i.value;t.save(),t.translate(e,n),o.graphic.draw(t,o.pos.x,o.pos.y),this.showDebug&&t.debug.drawRect(0,0,this.width,this.height),t.restore()}}catch(a){r.e(a)}finally{r.f()}}}]),n}(se);!function(t){t[t.Circle=0]="Circle",t[t.Rectangle=1]="Rectangle"}(Gi||(Gi={}));var lr,ur,cr,hr,dr,fr,pr,vr=function(t){h(n,t);var e=d(n);function n(t,i,r,o,a,s,l,u,c,h){return f(this,n),e.call(this,t,i,r,o,a,s,l,u,c,h)}return n}(Re(function(t){h(n,t);var e=d(n);function n(t,i,r,o,a,s,l,u,c,h){var d;f(this,n),(d=e.call(this)).position=new rt(0,0),d.velocity=new rt(0,0),d.acceleration=new rt(0,0),d.particleRotationalVelocity=0,d.currentRotation=0,d.focus=null,d.focusAccel=0,d.opacity=1,d.beginColor=ut.White,d.endColor=ut.White,d.life=300,d.fadeFlag=!1,d._rRate=1,d._gRate=1,d._bRate=1,d._aRate=0,d._currentColor=ut.White,d.emitter=null,d.particleSize=5,d.particleSprite=null,d.sizeRate=0,d.elapsedMultiplier=0,d.visible=!0,d.isOffscreen=!1;var p=t;if(p&&!(t instanceof gr)){var v=t;p=v.emitter,i=v.life,r=v.opacity,a=v.endColor,o=v.beginColor,s=v.position,l=v.velocity,u=v.acceleration,c=v.startSize,h=v.endSize}return d.emitter=p,d.life=i||d.life,d.opacity=r||d.opacity,d.endColor=a||d.endColor.clone(),d.beginColor=o||d.beginColor.clone(),d._currentColor=d.beginColor.clone(),d.position=(s||d.position).add(d.emitter.pos),d.velocity=l||d.velocity,d.acceleration=u||d.acceleration,d._rRate=(d.endColor.r-d.beginColor.r)/d.life,d._gRate=(d.endColor.g-d.beginColor.g)/d.life,d._bRate=(d.endColor.b-d.beginColor.b)/d.life,d._aRate=d.opacity/d.life,d.startSize=c||0,d.endSize=h||0,d.endSize>0&&d.startSize>0&&(d.sizeRate=(d.endSize-d.startSize)/d.life,d.particleSize=d.startSize),d.addComponent(d.transform=new rn),d.addComponent(new $n((function(t){return d.draw(t)}))),d.addComponent(d.graphics=new ni),d.transform.pos=d.position,d.transform.rotation=d.currentRotation,d.transform.scale=ot(1,1),d.particleSprite?(d.graphics.opacity=d.opacity,d.graphics.use(yi.fromLegacySprite(d.particleSprite))):d.graphics.onPostDraw=function(t){t.save(),d.graphics.opacity=d.opacity;var e=d._currentColor.clone();e.a=1,t.debug.drawPoint(ot(0,0),{color:e,size:d.particleSize}),t.restore()},d}return p(n,[{key:"kill",value:function(){this.emitter.removeParticle(this)}},{key:"update",value:function(t,e){if(this.life=this.life-e,this.elapsedMultiplier=this.elapsedMultiplier+e,this.life<0&&this.kill(),this.fadeFlag&&(this.opacity=F(this._aRate*this.life,1e-4,1)),this.startSize>0&&this.endSize>0&&(this.particleSize=F(this.sizeRate*e+this.particleSize,Math.min(this.startSize,this.endSize),Math.max(this.startSize,this.endSize))),this._currentColor.r=F(this._currentColor.r+this._rRate*e,0,255),this._currentColor.g=F(this._currentColor.g+this._gRate*e,0,255),this._currentColor.b=F(this._currentColor.b+this._bRate*e,0,255),this._currentColor.a=F(this.opacity,1e-4,1),this.focus){var n=this.focus.sub(this.position).normalize().scale(this.focusAccel).scale(e/1e3);this.velocity=this.velocity.add(n)}else this.velocity=this.velocity.add(this.acceleration.scale(e/1e3));this.position=this.position.add(this.velocity.scale(e/1e3)),this.particleRotationalVelocity&&(this.currentRotation=(this.currentRotation+this.particleRotationalVelocity*e/1e3)%(2*Math.PI)),this.transform.pos=this.position,this.transform.rotation=this.currentRotation,this.transform.scale=ot(1,1),this.graphics.opacity=this.opacity}},{key:"draw",value:function(t){if(this.particleSprite)return this.particleSprite.opacity(this.opacity),void this.particleSprite.draw(t,0,0);t.save(),this._currentColor.a=F(this.opacity,1e-4,1),t.fillStyle=this._currentColor.toString(),t.beginPath(),t.arc(0,0,this.particleSize,0,2*Math.PI),t.fill(),t.closePath(),t.restore()}}]),n}(Zn))),gr=function(t){h(n,t);var e=d(n);function n(t){var i,r,o;f(this,n),(i=e.call(this,{width:null!==(r=t.width)&&void 0!==r?r:0,height:null!==(o=t.height)&&void 0!==o?o:0}))._particlesToEmit=0,i.numParticles=0,i.isEmitting=!0,i.particles=[],i.deadParticles=[],i.minVel=0,i.maxVel=0,i.acceleration=new rt(0,0),i.minAngle=0,i.maxAngle=0,i.emitRate=1,i.particleLife=2e3,i.fadeFlag=!1,i.focus=null,i.focusAccel=null,i.startSize=null,i.endSize=null,i.minSize=5,i.maxSize=5,i.beginColor=ut.White,i.endColor=ut.White,i._og=null,i._sprite=null,i.emitterType=Gi.Rectangle,i.radius=0,i.particleRotationalVelocity=0,i.randomRotation=!1;var a=Object.assign({},t),s=a.x,l=a.y,u=a.pos,c=a.isEmitting,h=a.minVel,d=a.maxVel,p=a.acceleration,v=a.minAngle,g=a.maxAngle,y=a.emitRate,m=a.particleLife,_=a.opacity,w=a.fadeFlag,b=a.focus,k=a.focusAccel,x=a.startSize,C=a.endSize,S=a.minSize,E=a.maxSize,P=a.beginColor,A=a.endColor,T=a.particleSprite,R=a.emitterType,M=a.radius,L=a.particleRotationalVelocity,B=a.randomRotation,O=a.random;i.pos=null!=u?u:ot(null!=s?s:0,null!=l?l:0),i.isEmitting=null!=c?c:i.isEmitting,i.minVel=null!=h?h:i.minVel,i.maxVel=null!=d?d:i.maxVel,i.acceleration=null!=p?p:i.acceleration,i.minAngle=null!=v?v:i.minAngle,i.maxAngle=null!=g?g:i.maxAngle,i.emitRate=null!=y?y:i.emitRate,i.particleLife=null!=m?m:i.particleLife,i.opacity=null!=_?_:i.opacity,i.fadeFlag=null!=w?w:i.fadeFlag,i.focus=null!=b?b:i.focus,i.focusAccel=null!=k?k:i.focusAccel,i.startSize=null!=x?x:i.startSize,i.endSize=null!=C?C:i.endSize,i.minSize=null!=S?S:i.minSize,i.maxSize=null!=E?E:i.maxSize,i.beginColor=null!=P?P:i.beginColor,i.endColor=null!=A?A:i.endColor,i.particleSprite=null!=T?T:i.particleSprite,i.emitterType=null!=R?R:i.emitterType,i.radius=null!=M?M:i.radius,i.particleRotationalVelocity=null!=L?L:i.particleRotationalVelocity,i.randomRotation=null!=B?B:i.randomRotation,i.body.collisionType=Je.PreventCollision,i.random=null!=O?O:new D;for(var F=0;F<i.traits.length;F++)i.traits[F]instanceof Gn&&i.traits.splice(F,1);return i}return p(n,[{key:"opacity",get:function(){return r(o(n.prototype),"graphics",this).opacity},set:function(t){r(o(n.prototype),"graphics",this).opacity=t}},{key:"particleSprite",get:function(){return this._og},set:function(t){this._og=t,t&&(this._sprite=yi.fromLegacySprite(t))}},{key:"removeParticle",value:function(t){this.deadParticles.push(t)}},{key:"emitParticles",value:function(t){for(var e,n=0;n<t;n++){var i=this._createParticle();this.particles.push(i),(null===(e=null==this?void 0:this.scene)||void 0===e?void 0:e.world)&&this.scene.world.add(i)}}},{key:"clearParticles",value:function(){this.particles.length=0}},{key:"_createParticle",value:function(){var t=0,e=0,n=I(this.minAngle,this.maxAngle,this.random),i=I(this.minVel,this.maxVel,this.random),r=this.startSize||I(this.minSize,this.maxSize,this.random),o=i*Math.cos(n),a=i*Math.sin(n);if(this.emitterType===Gi.Rectangle)t=I(0,this.width,this.random),e=I(0,this.height,this.random);else if(this.emitterType===Gi.Circle){var s=I(0,this.radius,this.random);t=s*Math.cos(n),e=s*Math.sin(n)}var l=new vr(this,this.particleLife,this.opacity,this.beginColor,this.endColor,new rt(t,e),new rt(o,a),this.acceleration,this.startSize,this.endSize);return l.fadeFlag=this.fadeFlag,l.particleSize=r,this.particleSprite&&(l.particleSprite=this.particleSprite,l.graphics.opacity=this.opacity,l.graphics.use(this._sprite)),l.particleRotationalVelocity=this.particleRotationalVelocity,this.randomRotation&&(l.currentRotation=I(0,2*Math.PI,this.random)),this.focus&&(l.focus=this.focus.add(new rt(this.pos.x,this.pos.y)),l.focusAccel=this.focusAccel),l}},{key:"update",value:function(t,e){var i;r(o(n.prototype),"update",this).call(this,t,e),this.isEmitting&&(this._particlesToEmit+=this.emitRate*(e/1e3),this._particlesToEmit>1&&(this.emitParticles(Math.floor(this._particlesToEmit)),this._particlesToEmit=this._particlesToEmit-Math.floor(this._particlesToEmit)));for(var a=0;a<this.deadParticles.length;a++)V(this.deadParticles[a],this.particles),(null===(i=null==this?void 0:this.scene)||void 0===i?void 0:i.world)&&this.scene.world.remove(this.deadParticles[a],!1);this.deadParticles.length=0}},{key:"draw",value:function(t){this.particles.forEach((function(e){return e.draw(t)}))}},{key:"debugDraw",value:function(t){r(o(n.prototype),"debugDraw",this).call(this,t),t.fillStyle=ut.Black.toString(),t.fillText("Particles: "+this.particles.length,this.pos.x,this.pos.y+20),this.focus&&(t.fillRect(this.focus.x+this.pos.x,this.focus.y+this.pos.y,3,3),ee(t,ut.Yellow,this.focus.x+this.pos.x,this.focus.y+this.pos.y,this.center.x,this.center.y),t.fillText("Focus",this.focus.x+this.pos.x,this.focus.y+this.pos.y))}}]),n}(ai),yr=function(t){h(n,t);var e=d(n);function n(){var t;return f(this,n),(t=e.apply(this,arguments)).types=["ex.transform","ex.graphics"],t.systemType=Fi.Draw,t.priority=0,t._token=0,t}return p(n,[{key:"initialize",value:function(t){this._graphicsContext=t.engine.graphicsContext,this._camera=t.camera,this._engine=t.engine}},{key:"sort",value:function(t,e){return t.get(rn).z-e.get(rn).z}},{key:"update",value:function(t,e){var n,i;this._clearScreen(),this._token++;var r,o=s(t);try{for(o.s();!(r=o.n()).done;){var a=r.value;n=a.get(rn),i=a.get(ni);var l=this._isOffscreen(n,i);if(l&&!a.hasTag("offscreen")&&(a.eventDispatcher.emit("exitviewport",new Qt(a)),a.addComponent(new Ye("offscreen"))),!l&&a.hasTag("offscreen")&&(a.eventDispatcher.emit("enterviewport",new Yt(a)),a.removeComponent("offscreen")),!l){this._pushCameraTransform(n),this._graphicsContext.save(),i.update(e,this._token),this._applyTransform(a),i.onPreDraw&&i.onPreDraw(this._graphicsContext,e);var u=a instanceof vr?a.opacity:1;this._graphicsContext.opacity=i.opacity*u,this._drawGraphicsComponent(i),i.onPostDraw&&i.onPostDraw(this._graphicsContext,e),this._graphicsContext.restore(),this._popCameraTransform(n)}}}catch(c){o.e(c)}finally{o.f()}this._graphicsContext.flush(),this._engine.stats.currFrame.graphics.drawnImages=or.DrawnImagesCount,this._engine.stats.currFrame.graphics.drawCalls=or.DrawCallCount}},{key:"_clearScreen",value:function(){this._graphicsContext.clear()}},{key:"_isOffscreen",value:function(t,e){return t.coordPlane===$e.World&&!this._camera.viewport.intersect(e.localBounds.transform(t.getGlobalMatrix()))}},{key:"_drawGraphicsComponent",value:function(t){var e,n;if(t.visible){var i,r=s(t.layers.get());try{for(r.s();!(i=r.n()).done;){var o,a=i.value,l=s(a.graphics);try{for(l.s();!(o=l.n()).done;){var u=o.value,c=u.graphic,h=u.options,d=t.anchor,f=t.offset;(null==h?void 0:h.anchor)&&(d=h.anchor),(null==h?void 0:h.offset)&&(f=h.offset);var p=-c.width*d.x+f.x,v=-c.height*d.y+f.y;if(null==c||c.draw(this._graphicsContext,p+a.offset.x,v+a.offset.y),(null===(e=this._engine)||void 0===e?void 0:e.isDebug)&&this._engine.debug.graphics.showBounds){var g=ot(p+a.offset.x,v+a.offset.y);if(c instanceof sr){var y,m=s(c.members);try{for(m.s();!(y=m.n()).done;){var _=y.value;null===(n=_.graphic)||void 0===n||n.localBounds.translate(g.add(_.pos)).draw(this._graphicsContext,this._engine.debug.graphics.boundsColor)}}catch(w){m.e(w)}finally{m.f()}}else null==c||c.localBounds.translate(g).draw(this._graphicsContext,this._engine.debug.graphics.boundsColor)}}}catch(w){l.e(w)}finally{l.f()}}}catch(w){r.e(w)}finally{r.f()}}}},{key:"_applyTransform",value:function(t){var e,n=t.getAncestors(),i=s(n);try{for(i.s();!(e=i.n()).done;){var r=e.value,o=null==r?void 0:r.get(rn);o&&(this._graphicsContext.translate(o.pos.x,o.pos.y),this._graphicsContext.scale(o.scale.x,o.scale.y),this._graphicsContext.rotate(o.rotation))}}catch(a){i.e(a)}finally{i.f()}}},{key:"_pushCameraTransform",value:function(t){t.coordPlane===$e.World&&(this._graphicsContext.save(),this._camera&&this._camera.draw(this._graphicsContext))}},{key:"_popCameraTransform",value:function(t){t.coordPlane===$e.World&&this._graphicsContext.restore()}}]),n}(Ni),mr=function(t){h(n,t);var e=d(n);function n(){var t;return f(this,n),(t=e.apply(this,arguments)).types=["ex.transform","ex.canvas"],t.systemType=Fi.Draw,t.priority=-1,t}return p(n,[{key:"initialize",value:function(t){this._ctx=t.engine.ctx,this._engine=t.engine,this._camera=t.camera}},{key:"sort",value:function(t,e){return t.get(rn).z-e.get(rn).z}},{key:"update",value:function(t,e){var n,i,r,o,a;this._clearScreen();for(var s=t.length,l=0;l<s;l++){var u=null===(r=null===(i=null===(n=t[l])||void 0===n?void 0:n.graphics)||void 0===i?void 0:i.visible)||void 0===r||r,c=t[l].isOffScreen;u&&!c&&(o=t[l].get(rn),a=t[l].get($n),this._ctx.save(),this._pushCameraTransform(o),this._ctx.save(),this._applyTransform(t[l]),a.draw(this._ctx,e),this._ctx.restore(),this._popCameraTransform(o),this._ctx.restore()),this._engine.isDebug&&(this._ctx.save(),this._pushCameraTransform(o),this._ctx.strokeStyle="yellow",t[l].debugDraw(this._ctx),this._popCameraTransform(o),this._ctx.restore())}this._engine.isDebug&&(this._ctx.save(),this._camera.draw(this._ctx),this._camera.debugDraw(this._ctx),this._ctx.restore()),this._engine.stats.currFrame.graphics.drawnImages=or.DrawnImagesCount,this._engine.stats.currFrame.graphics.drawCalls=or.DrawCallCount}},{key:"_applyTransform",value:function(t){var e,n=t.getAncestors(),i=s(n);try{for(i.s();!(e=i.n()).done;){var r=e.value,o=null==r?void 0:r.get(rn);o&&(this._ctx.translate(o.pos.x,o.pos.y),this._ctx.rotate(o.rotation),this._ctx.scale(o.scale.x,o.scale.y))}}catch(a){i.e(a)}finally{i.f()}}},{key:"_clearScreen",value:function(){this._ctx.clearRect(0,0,this._ctx.canvas.width,this._ctx.canvas.height),this._ctx.fillStyle=this._engine.backgroundColor.toString(),this._ctx.fillRect(0,0,this._ctx.canvas.width,this._ctx.canvas.height)}},{key:"_pushCameraTransform",value:function(t){t.coordPlane===$e.World&&(this._ctx.save(),this._camera&&this._camera.draw(this._ctx))}},{key:"_popCameraTransform",value:function(t){t.coordPlane===$e.World&&this._ctx.restore()}}]),n}(Ni),_r=function(t){h(n,t);var e=d(n);function n(){var t;return f(this,n),(t=e.apply(this,arguments)).types=["ex.transform"],t.systemType=Fi.Draw,t.priority=999,t}return p(n,[{key:"initialize",value:function(t){this._graphicsContext=t.engine.graphicsContext,this._camera=t.camera,this._engine=t.engine,this._collisionSystem=t.world.systemManager.get(rr)}},{key:"update",value:function(t,e){var n,i;if(this._engine.isDebug){var r,o,a,u,c,h,d,f,p=this._engine.debug.filter,v=this._engine.debug.entity,g=this._engine.debug.transform,y=this._engine.debug.motion,m=this._engine.debug.collider,_=this._engine.debug.physics,w=this._engine.debug.graphics,b=this._engine.debug.body,k=this._engine.debug.camera,x=s(t);try{for(x.s();!(f=x.n()).done;){var C=f.value;if(!C.hasTag("offscreen")&&!(C instanceof vr)){if(p.useFilter){if(0!==p.ids.length&&!p.ids.includes(C.id))continue;if(""!==p.nameQuery&&!C.name.includes(p.nameQuery))continue}var S=rt.Zero,E=ot(0,16);if(r=C.id,o=C.name,a=C.get(rn),this._pushCameraTransform(a),this._graphicsContext.save(),this._applyTransform(C),a&&((g.showAll||g.showPosition)&&(this._graphicsContext.debug.drawPoint(rt.Zero,{size:2,color:g.positionColor}),this._graphicsContext.debug.drawText("pos"+a.pos.toString(2),S),S=S.add(E)),(v.showAll||v.showId)&&(this._graphicsContext.debug.drawText("id(".concat(r,") ").concat(a.parent?"child of id("+(null===(i=null===(n=a.parent)||void 0===n?void 0:n.owner)||void 0===i?void 0:i.id)+")":""),S),S=S.add(E)),(v.showAll||v.showName)&&(this._graphicsContext.debug.drawText("name(".concat(o,")"),S),S=S.add(E)),(g.showAll||g.showRotation)&&(this._graphicsContext.drawLine(rt.Zero,rt.fromAngle(a.rotation).scale(50).add(rt.Zero),g.rotationColor,2),this._graphicsContext.debug.drawText("rot deg(".concat(U(a.rotation).toFixed(2),")"),S),S=S.add(E)),(g.showAll||g.showScale)&&this._graphicsContext.drawLine(rt.Zero,a.scale.add(rt.Zero),g.scaleColor,2)),(h=C.get(ni))&&(w.showAll||w.showBounds)&&h.localBounds.draw(this._graphicsContext,w.boundsColor),(d=C.get(jn))&&((b.showAll||b.showCollisionGroup)&&(this._graphicsContext.debug.drawText("collision group(".concat(d.group.name,")"),S),S=S.add(E)),(b.showAll||b.showCollisionType)&&(this._graphicsContext.debug.drawText("collision type(".concat(d.collisionType,")"),S),S=S.add(E)),(b.showAll||b.showMass)&&(this._graphicsContext.debug.drawText("mass(".concat(d.mass,")"),S),S=S.add(E)),(b.showAll||b.showMotion)&&(this._graphicsContext.debug.drawText("motion(".concat(d.sleepMotion,")"),S),S=S.add(E)),(b.showAll||b.showSleeping)&&(this._graphicsContext.debug.drawText("sleeping(".concat(d.canSleep?d.sleeping:"cant sleep",")"),S),S=S.add(E))),this._graphicsContext.restore(),(u=C.get(Ze))&&((y.showAll||y.showVelocity)&&(this._graphicsContext.debug.drawText("vel"+u.vel.toString(2),S.add(a.globalPos)),this._graphicsContext.drawLine(a.globalPos,a.globalPos.add(u.vel),y.velocityColor,2),S=S.add(E)),(y.showAll||y.showAcceleration)&&this._graphicsContext.drawLine(a.globalPos,a.globalPos.add(u.acc),y.accelerationColor,2)),c=C.get(Wn)){var P=c.get();if((m.showAll||m.showGeometry)&&P.debug(this._graphicsContext,m.geometryColor),m.showAll||m.showBounds)if(P instanceof Rn){var A,T=P.getColliders(),R=s(T);try{for(R.s();!(A=R.n()).done;){var D=A.value,M=D.bounds,L=ot(M.left,M.top);this._graphicsContext.debug.drawRect(L.x,L.y,M.width,M.height,{color:m.boundsColor}),(m.showAll||m.showOwner)&&this._graphicsContext.debug.drawText("owner id(".concat(D.owner.id,")"),L)}}catch(q){R.e(q)}finally{R.f()}c.bounds.draw(this._graphicsContext,m.boundsColor)}else if(P){var B=c.bounds,O=ot(B.left,B.top);this._graphicsContext.debug.drawRect(O.x,O.y,B.width,B.height,{color:m.boundsColor}),(m.showAll||m.showOwner)&&this._graphicsContext.debug.drawText("owner id(".concat(c.owner.id,")"),O)}}this._popCameraTransform(a)}}}catch(q){x.e(q)}finally{x.f()}if(this._graphicsContext.save(),this._camera.draw(this._graphicsContext),(_.showAll||_.showBroadphaseSpacePartitionDebug)&&this._collisionSystem.debug(this._graphicsContext),_.showAll||_.showCollisionContacts||_.showCollisionNormals){var F,I=s(this._engine.debug.stats.currFrame.physics.contacts);try{for(I.s();!(F=I.n()).done;){var z=l(F.value,2),N=(z[0],z[1]);if(_.showAll||_.showCollisionContacts){var H,W=s(N.points);try{for(W.s();!(H=W.n()).done;){var j=H.value;this._graphicsContext.debug.drawPoint(j,{size:5,color:_.collisionContactColor})}}catch(q){W.e(q)}finally{W.f()}}if(_.showAll||_.showCollisionNormals){var V,G=s(N.points);try{for(G.s();!(V=G.n()).done;){var X=V.value;this._graphicsContext.debug.drawLine(X,N.normal.scale(30).add(X),{color:_.collisionNormalColor})}}catch(q){G.e(q)}finally{G.f()}}}}catch(q){I.e(q)}finally{I.f()}}this._graphicsContext.restore(),k&&(this._graphicsContext.save(),this._camera.draw(this._graphicsContext),(k.showAll||k.showFocus)&&this._graphicsContext.drawCircle(this._camera.pos,4,k.focusColor),(k.showAll||k.showZoom)&&this._graphicsContext.debug.drawText("zoom(".concat(this._camera.zoom,")"),this._camera.pos),this._graphicsContext.restore()),this._graphicsContext.flush()}}},{key:"_applyTransform",value:function(t){var e,n=t.getAncestors(),i=s(n);try{for(i.s();!(e=i.n()).done;){var r=e.value,o=null==r?void 0:r.get(rn);o&&(this._graphicsContext.translate(o.pos.x,o.pos.y),this._graphicsContext.scale(o.scale.x,o.scale.y),this._graphicsContext.rotate(o.rotation))}}catch(a){i.e(a)}finally{i.f()}}},{key:"_pushCameraTransform",value:function(t){t.coordPlane===$e.World&&(this._graphicsContext.save(),this._camera&&this._camera.draw(this._graphicsContext))}},{key:"_popCameraTransform",value:function(t){t.coordPlane===$e.World&&this._graphicsContext.restore()}}]),n}(Ni),wr=function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},br=function(t){h(n,t);var e=d(n);function n(){var t;return f(this,n),(t=e.call(this))._logger=P.getInstance(),t.camera=new Bi,t.world=new Zi(c(t)),t._isInitialized=!1,t._timers=[],t._cancelQueue=[],t.world.add(new Ji),t.world.add(new rr),S.isEnabled(b.LegacyDrawing)?t.world.add(new mr):t.world.add(new yr),t.world.add(new _r),t}return p(n,[{key:"actors",get:function(){return this.world.entityManager.entities.filter((function(t){return t instanceof ai}))}},{key:"entities",get:function(){return this.world.entityManager.entities}},{key:"triggers",get:function(){return this.world.entityManager.entities.filter((function(t){return t instanceof zi}))}},{key:"tileMaps",get:function(){return this.world.entityManager.entities.filter((function(t){return t instanceof Si}))}},{key:"screenElements",get:function(){return this.actors.filter((function(t){return t instanceof si}))}},{key:"on",value:function(t,e){r(o(n.prototype),"on",this).call(this,t,e)}},{key:"once",value:function(t,e){r(o(n.prototype),"once",this).call(this,t,e)}},{key:"off",value:function(t,e){r(o(n.prototype),"off",this).call(this,t,e)}},{key:"onInitialize",value:function(t){}},{key:"onActivate",value:function(t,e){}},{key:"onDeactivate",value:function(t,e){}},{key:"onPreUpdate",value:function(t,e){}},{key:"onPostUpdate",value:function(t,e){}},{key:"onPreDraw",value:function(t,e){}},{key:"onPostDraw",value:function(t,e){}},{key:"_initializeChildren",value:function(){var t,e=s(this.entities);try{for(e.s();!(t=e.n()).done;)t.value._initialize(this.engine)}catch(n){e.e(n)}finally{e.f()}}},{key:"isInitialized",get:function(){return this._isInitialized}},{key:"_initialize",value:function(t){this.isInitialized||(this.engine=t,this.camera._initialize(t),this.onInitialize.call(this,t),this._initializeChildren(),this._logger.debug("Scene.onInitialize",this,t),this.eventDispatcher.emit("initialize",new Xt(t,this)),this._isInitialized=!0)}},{key:"_activate",value:function(t,e){this._logger.debug("Scene.onActivate",this),this.onActivate(t,e)}},{key:"_deactivate",value:function(t,e){this._logger.debug("Scene.onDeactivate",this),this.onDeactivate(t,e)}},{key:"_preupdate",value:function(t,e){this.emit("preupdate",new Et(t,e,this)),this.onPreUpdate(t,e)}},{key:"_postupdate",value:function(t,e){this.emit("postupdate",new Pt(t,e,this)),this.onPostUpdate(t,e)}},{key:"_predraw",value:function(t,e){this.emit("predraw",new kt(t,e,this)),this.onPreDraw(t,e)}},{key:"_postdraw",value:function(t,e){this.emit("postdraw",new xt(t,e,this)),this.onPostDraw(t,e)}},{key:"update",value:function(t,e){var n,i;for(this._preupdate(t,e),this.camera&&this.camera.update(t,e),n=0,i=this._cancelQueue.length;n<i;n++)this.removeTimer(this._cancelQueue[n]);this._cancelQueue.length=0;var r,o=s(this._timers);try{for(o.s();!(r=o.n()).done;)r.value.update(e)}catch(a){o.e(a)}finally{o.f()}this.world.update(Fi.Update,e),this._collectActorStats(t),t.input.pointers.dispatchPointerEvents(),this._postupdate(t,e)}},{key:"draw",value:function(t,e){var n;this._predraw(t,e),this.world.update(Fi.Draw,e),(null===(n=this.engine)||void 0===n?void 0:n.isDebug)&&this.debugDraw(t),this._postdraw(t,e)}},{key:"debugDraw",value:function(t){this.emit("predebugdraw",new Ct(t,this)),this.emit("postdebugdraw",new St(t,this))}},{key:"contains",value:function(t){return this.actors.indexOf(t)>-1}},{key:"add",value:function(t){this.emit("entityadded",{target:t}),this.world.add(t),t.scene=this,t instanceof ui&&(G(this._timers,t)||this.addTimer(t))}},{key:"remove",value:function(t){t instanceof Zn&&(this.emit("entityremoved",{target:t}),this.world.remove(t)),t instanceof ui&&this.removeTimer(t)}},{key:"addScreenElement",value:function(t){this.add(t)}},{key:"removeScreenElement",value:function(t){this.remove(t)}},{key:"addTileMap",value:function(t){this.world.add(t)}},{key:"removeTileMap",value:function(t){this.world.remove(t)}},{key:"addTimer",value:function(t){return this._timers.push(t),t.scene=this,t}},{key:"removeTimer",value:function(t){var e=this._timers.indexOf(t);return-1!==e&&this._timers.splice(e,1),t}},{key:"cancelTimer",value:function(t){return this._cancelQueue.push(t),t}},{key:"isTimerActive",value:function(t){return this._timers.indexOf(t)>-1&&!t.complete}},{key:"isCurrentScene",value:function(){return!!this.engine&&this.engine.currentScene===this}},{key:"_collectActorStats",value:function(t){var e,n=this.actors.filter((function(t){return t instanceof si})),i=s(n);try{for(i.s();!(e=i.n()).done;)e.value,t.stats.currFrame.actors.ui++}catch(c){i.e(c)}finally{i.f()}var r,o=s(this.actors);try{for(o.s();!(r=o.n()).done;){var a=r.value;t.stats.currFrame.actors.alive++;var l,u=s(a.children);try{for(u.s();!(l=u.n()).done;)Oi(l.value)?t.stats.currFrame.actors.ui++:t.stats.currFrame.actors.alive++}catch(c){u.e(c)}finally{u.f()}}}catch(c){o.e(c)}finally{o.f()}}}]),n}(te);wr([nt({message:"Will be removed in excalibur v0.26.0",alternateMethod:"ScreenElements now are normal actors with a Transform Coordinate Plane of Screen"})],br.prototype,"screenElements",null),wr([nt({message:"Will be removed in excalibur v0.26.0",alternateMethod:"Use Scene.add"})],br.prototype,"addScreenElement",null),wr([nt({message:"Will be removed in excalibur v0.26.0",alternateMethod:"Use Scene.remove"})],br.prototype,"removeScreenElement",null),wr([nt({message:"Will be removed in excalibur v0.26.0",alternateMethod:"Use Scene.add"})],br.prototype,"addTileMap",null),wr([nt({message:"Will be removed in excalibur v0.26.0",alternateMethod:"Use Scene.remove"})],br.prototype,"removeTileMap",null),function(t){t[t.Protanope=0]="Protanope",t[t.Deuteranope=1]="Deuteranope",t[t.Tritanope=2]="Tritanope"}(lr||(lr={}));var kr=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:lr.Protanope;f(this,t),this.engine=e,this.simulate=n,this.colorMode=i,this._vertexShader="attribute vec2 a_position;attribute vec2 a_texCoord;uniform vec2 u_resolution;varying vec2 v_texCoord;void main() {vec2 zeroToOne = a_position / u_resolution;vec2 zeroToTwo = zeroToOne * 2.0;vec2 clipSpace = zeroToTwo - 1.0;gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);v_texCoord = a_texCoord;}",this._fragmentShader="precision mediump float;uniform sampler2D u_image;varying vec2 v_texCoord;void main() {vec4 o =  texture2D(u_image, v_texCoord);float L = (17.8824 * o.r) + (43.5161 * o.g) + (4.11935 * o.b);float M = (3.45565 * o.r) + (27.1554 * o.g) + (3.86714 * o.b);float S = (0.0299566 * o.r) + (0.184309 * o.g) + (1.46709 * o.b);//MODE CODE//vec4 error;error.r = (0.0809444479 * l) + (-0.130504409 * m) + (0.116721066 * s);error.g = (-0.0102485335 * l) + (0.0540193266 * m) + (-0.113614708 * s);error.b = (-0.000365296938 * l) + (-0.00412161469 * m) + (0.693511405 * s);error.a = 1.0;vec4 diff = o - error;vec4 correction;correction.r = 0.0;correction.g =  (diff.r * 0.7) + (diff.g * 1.0);correction.b =  (diff.r * 0.7) + (diff.b * 1.0);correction = o + correction;correction.a = o.a;//SIMULATE//}",this._internalCanvas=document.createElement("canvas"),this._internalCanvas.width=e.drawWidth,this._internalCanvas.height=e.drawHeight,this._gl=this._internalCanvas.getContext("webgl",{preserveDrawingBuffer:!0}),this._program=this._gl.createProgram();var r=this._getShader("Fragment",this._getFragmentShaderByMode(i)),o=this._getShader("Vertex",this._vertexShader);this._gl.attachShader(this._program,o),this._gl.attachShader(this._program,r),this._gl.linkProgram(this._program),this._gl.getProgramParameter(this._program,this._gl.LINK_STATUS)||P.getInstance().error("Unable to link shader program!"),this._gl.useProgram(this._program)}return p(t,[{key:"_getFragmentShaderByMode",value:function(t){var e="";return t===lr.Protanope?e="float l = 0.0 * L + 2.02344 * M + -2.52581 * S;float m = 0.0 * L + 1.0 * M + 0.0 * S;float s = 0.0 * L + 0.0 * M + 1.0 * S;":t===lr.Deuteranope?e="float l = 1.0 * L + 0.0 * M + 0.0 * S;float m = 0.494207 * L + 0.0 * M + 1.24827 * S;float s = 0.0 * L + 0.0 * M + 1.0 * S;":t===lr.Tritanope&&(e="float l = 1.0 * L + 0.0 * M + 0.0 * S;float m = 0.0 * L + 1.0 * M + 0.0 * S;float s = -0.395913 * L + 0.801109 * M + 0.0 * S;"),this.simulate?this._fragmentShader=this._fragmentShader.replace("//SIMULATE//","gl_FragColor = error.rgba;"):this._fragmentShader=this._fragmentShader.replace("//SIMULATE//","gl_FragColor = correction.rgba;"),this._fragmentShader.replace("//MODE CODE//",e)}},{key:"_setRectangle",value:function(t,e,n,i){var r=t,o=t+n,a=e,s=e+i;this._gl.bufferData(this._gl.ARRAY_BUFFER,new Float32Array([r,a,o,a,r,s,r,s,o,a,o,s]),this._gl.STATIC_DRAW)}},{key:"_getShader",value:function(t,e){var n;return"Fragment"===t?n=this._gl.createShader(this._gl.FRAGMENT_SHADER):"Vertex"===t?n=this._gl.createShader(this._gl.VERTEX_SHADER):P.getInstance().error("Error unknown shader type",t),this._gl.shaderSource(n,e),this._gl.compileShader(n),this._gl.getShaderParameter(n,this._gl.COMPILE_STATUS)?n:(P.getInstance().error("Unable to compile shader!",this._gl.getShaderInfoLog(n)),null)}},{key:"process",value:function(t,e){var n=this._gl.getAttribLocation(this._program,"a_position"),i=this._gl.getAttribLocation(this._program,"a_texCoord"),r=this._gl.createBuffer();this._gl.bindBuffer(this._gl.ARRAY_BUFFER,r),this._gl.bufferData(this._gl.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),this._gl.STATIC_DRAW),this._gl.enableVertexAttribArray(i),this._gl.vertexAttribPointer(i,2,this._gl.FLOAT,!1,0,0);var o=this._gl.createTexture();this._gl.bindTexture(this._gl.TEXTURE_2D,o),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,this._gl.NEAREST),this._gl.pixelStorei(this._gl.UNPACK_FLIP_Y_WEBGL,1),this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.RGBA,this._gl.RGBA,this._gl.UNSIGNED_BYTE,t);var a=this._gl.getUniformLocation(this._program,"u_resolution");this._gl.uniform2f(a,this._internalCanvas.width,this._internalCanvas.height);var s=this._gl.createBuffer();this._gl.bindBuffer(this._gl.ARRAY_BUFFER,s),this._gl.enableVertexAttribArray(n),this._gl.vertexAttribPointer(n,2,this._gl.FLOAT,!1,0,0),this._setRectangle(0,0,t.width,t.height),this._gl.drawArrays(this._gl.TRIANGLES,0,6);var l=new Uint8Array(t.width*t.height*4);this._gl.readPixels(0,0,t.width,t.height,this._gl.RGBA,this._gl.UNSIGNED_BYTE,l),t.data.set(l),e.putImageData(t,0,0)}}]),t}(),xr=function(){function t(e){f(this,t),this._engine=e}return p(t,[{key:"correct",value:function(t){this._engine.postProcessors.push(new kr(this._engine,!1,t))}},{key:"simulate",value:function(t){this._engine.postProcessors.push(new kr(this._engine,!0,t))}}]),t}(),Cr=function t(e){f(this,t),this.stats={currFrame:new Sr,prevFrame:new Sr},this.filter={useFilter:!1,nameQuery:"",ids:[]},this.entity={showAll:!1,showId:!0,showName:!1},this.transform={showAll:!1,showPosition:!1,positionColor:ut.Yellow,showScale:!1,scaleColor:ut.Green,showRotation:!1,rotationColor:ut.Blue},this.graphics={showAll:!1,showBounds:!0,boundsColor:ut.Yellow},this.collider={showAll:!1,showBounds:!0,boundsColor:ut.Blue,showOwner:!1,showGeometry:!0,geometryColor:ut.Green},this.physics={showAll:!1,showBroadphaseSpacePartitionDebug:!1,showCollisionNormals:!1,collisionNormalColor:ut.Cyan,showCollisionContacts:!0,collisionContactColor:ut.Red},this.motion={showAll:!1,showVelocity:!1,velocityColor:ut.Yellow,showAcceleration:!1,accelerationColor:ut.Red},this.body={showAll:!1,showCollisionGroup:!1,showCollisionType:!1,showSleeping:!1,showMotion:!1,showMass:!1},this.camera={showAll:!1,showFocus:!1,focusColor:ut.Red,showZoom:!1},this._engine=e,this.colorBlindMode=new xr(this._engine)},Sr=function(){function t(){f(this,t),this._id=0,this._delta=0,this._fps=0,this._actorStats={alive:0,killed:0,ui:0,get remaining(){return this.alive-this.killed},get total(){return this.remaining+this.ui}},this._durationStats={update:0,draw:0,get total(){return this.update+this.draw}},this._physicsStats=new Er,this._graphicsStats={drawCalls:0,drawnImages:0}}return p(t,[{key:"reset",value:function(t){t?(this.id=t.id,this.delta=t.delta,this.fps=t.fps,this.actors.alive=t.actors.alive,this.actors.killed=t.actors.killed,this.actors.ui=t.actors.ui,this.duration.update=t.duration.update,this.duration.draw=t.duration.draw,this._physicsStats.reset(t.physics),this.graphics.drawCalls=t.graphics.drawCalls,this.graphics.drawnImages=t.graphics.drawnImages):(this.id=this.delta=this.fps=0,this.actors.alive=this.actors.killed=this.actors.ui=0,this.duration.update=this.duration.draw=0,this._physicsStats.reset(),this.graphics.drawnImages=this.graphics.drawCalls=0)}},{key:"clone",value:function(){var e=new t;return e.reset(this),e}},{key:"id",get:function(){return this._id},set:function(t){this._id=t}},{key:"delta",get:function(){return this._delta},set:function(t){this._delta=t}},{key:"fps",get:function(){return this._fps},set:function(t){this._fps=t}},{key:"actors",get:function(){return this._actorStats}},{key:"duration",get:function(){return this._durationStats}},{key:"physics",get:function(){return this._physicsStats}},{key:"graphics",get:function(){return this._graphicsStats}}]),t}(),Er=function(){function t(){f(this,t),this._pairs=0,this._collisions=0,this._contacts=new Map,this._fastBodies=0,this._fastBodyCollisions=0,this._broadphase=0,this._narrowphase=0}return p(t,[{key:"reset",value:function(t){t?(this.pairs=t.pairs,this.collisions=t.collisions,this.contacts=t.contacts,this.fastBodies=t.fastBodies,this.fastBodyCollisions=t.fastBodyCollisions,this.broadphase=t.broadphase,this.narrowphase=t.narrowphase):(this.pairs=this.collisions=this.fastBodies=0,this.fastBodyCollisions=this.broadphase=this.narrowphase=0,this.contacts.clear())}},{key:"clone",value:function(){var e=new t;return e.reset(this),e}},{key:"pairs",get:function(){return this._pairs},set:function(t){this._pairs=t}},{key:"collisions",get:function(){return this._collisions},set:function(t){this._collisions=t}},{key:"contacts",get:function(){return this._contacts},set:function(t){this._contacts=t}},{key:"fastBodies",get:function(){return this._fastBodies},set:function(t){this._fastBodies=t}},{key:"fastBodyCollisions",get:function(){return this._fastBodyCollisions},set:function(t){this._fastBodyCollisions=t}},{key:"broadphase",get:function(){return this._broadphase},set:function(t){this._broadphase=t}},{key:"narrowphase",get:function(){return this._narrowphase},set:function(t){this._narrowphase=t}}]),t}();!function(t){t.Num0="Numpad0",t.Num1="Numpad1",t.Num2="Numpad2",t.Num3="Numpad3",t.Num4="Numpad4",t.Num5="Numpad5",t.Num6="Numpad6",t.Num7="Numpad7",t.Num8="Numpad8",t.Num9="Numpad9",t.NumAdd="NumpadAdd",t.NumSubtract="NumpadSubtract",t.NumMultiply="NumpadMultiply",t.NumDivide="NumpadDivide",t.NumDecimal="NumpadDecimal",t.Numpad0="Numpad0",t.Numpad1="Numpad1",t.Numpad2="Numpad2",t.Numpad3="Numpad3",t.Numpad4="Numpad4",t.Numpad5="Numpad5",t.Numpad6="Numpad6",t.Numpad7="Numpad7",t.Numpad8="Numpad8",t.Numpad9="Numpad9",t.NumpadAdd="NumpadAdd",t.NumpadSubtract="NumpadSubtract",t.NumpadMultiply="NumpadMultiply",t.NumpadDivide="NumpadDivide",t.NumpadDecimal="NumpadDecimal",t.NumLock="NumLock",t.ShiftLeft="ShiftLeft",t.ShiftRight="ShiftRight",t.AltLeft="AltLeft",t.AltRight="AltRight",t.Key0="Digit0",t.Key1="Digit1",t.Key2="Digit2",t.Key3="Digit3",t.Key4="Digit4",t.Key5="Digit5",t.Key6="Digit6",t.Key7="Digit7",t.Key8="Digit8",t.Key9="Digit9",t.Digit0="Digit0",t.Digit1="Digit1",t.Digit2="Digit2",t.Digit3="Digit3",t.Digit4="Digit4",t.Digit5="Digit5",t.Digit6="Digit6",t.Digit7="Digit7",t.Digit8="Digit8",t.Digit9="Digit9",t.A="KeyA",t.B="KeyB",t.C="KeyC",t.D="KeyD",t.E="KeyE",t.F="KeyF",t.G="KeyG",t.H="KeyH",t.I="KeyI",t.J="KeyJ",t.K="KeyK",t.L="KeyL",t.M="KeyM",t.N="KeyN",t.O="KeyO",t.P="KeyP",t.Q="KeyQ",t.R="KeyR",t.S="KeyS",t.T="KeyT",t.U="KeyU",t.V="KeyV",t.W="KeyW",t.X="KeyX",t.Y="KeyY",t.Z="KeyZ",t.KeyA="KeyA",t.KeyB="KeyB",t.KeyC="KeyC",t.KeyD="KeyD",t.KeyE="KeyE",t.KeyF="KeyF",t.KeyG="KeyG",t.KeyH="KeyH",t.KeyI="KeyI",t.KeyJ="KeyJ",t.KeyK="KeyK",t.KeyL="KeyL",t.KeyM="KeyM",t.KeyN="KeyN",t.KeyO="KeyO",t.KeyP="KeyP",t.KeyQ="KeyQ",t.KeyR="KeyR",t.KeyS="KeyS",t.KeyT="KeyT",t.KeyU="KeyU",t.KeyV="KeyV",t.KeyW="KeyW",t.KeyX="KeyX",t.KeyY="KeyY",t.KeyZ="KeyZ",t.Semicolon="Semicolon",t.Quote="Quote",t.Comma="Comma",t.Minus="Minus",t.Period="Period",t.Slash="Slash",t.Equal="Equal",t.BracketLeft="BracketLeft",t.Backslash="Backslash",t.BracketRight="BracketRight",t.Backquote="Backquote",t.Up="ArrowUp",t.Down="ArrowDown",t.Left="ArrowLeft",t.Right="ArrowRight",t.ArrowUp="ArrowUp",t.ArrowDown="ArrowDown",t.ArrowLeft="ArrowLeft",t.ArrowRight="ArrowRight",t.Space="Space",t.Esc="Escape",t.Escape="Escape"}(ur||(ur={}));var Pr=function(t){h(n,t);var e=d(n);function n(t,i,r){var o;return f(this,n),(o=e.call(this)).key=t,o.value=i,o.originalEvent=r,o}return n}(gt),Ar=function(t){h(i,t);var n=d(i);function i(){var t;return f(this,i),(t=n.call(this))._keys=[],t._keysUp=[],t._keysDown=[],t}return p(i,[{key:"on",value:function(t,e){r(o(i.prototype),"on",this).call(this,t,e)}},{key:"init",value:function(t){var n=this;if(!t)try{var i=function(){};window.top.addEventListener("blur",i),window.top.removeEventListener("blur",i),t=window.top}catch(e){t=window,P.getInstance().warn("Failed to bind to keyboard events to top frame. If you are trying to embed Excalibur in a cross-origin iframe, keyboard events will not fire.")}t.addEventListener("blur",(function(){n._keys.length=0})),t.addEventListener("keyup",(function(t){var e=t.code,i=n._keys.indexOf(e);n._keys.splice(i,1),n._keysUp.push(e);var r=new Pr(e,t.key,t);n.eventDispatcher.emit("up",r),n.eventDispatcher.emit("release",r)})),t.addEventListener("keydown",(function(t){var e=t.code;if(-1===n._keys.indexOf(e)){n._keys.push(e),n._keysDown.push(e);var i=new Pr(e,t.key,t);n.eventDispatcher.emit("down",i),n.eventDispatcher.emit("press",i)}}))}},{key:"update",value:function(){this._keysDown.length=0,this._keysUp.length=0;for(var t=0;t<this._keys.length;t++)this.eventDispatcher.emit("hold",new Pr(this._keys[t]))}},{key:"getKeys",value:function(){return this._keys}},{key:"wasPressed",value:function(t){return this._keysDown.indexOf(t)>-1}},{key:"isHeld",value:function(t){return this._keys.indexOf(t)>-1}},{key:"wasReleased",value:function(t){return this._keysUp.indexOf(t)>-1}}]),i}(te);!function(t){t.Touch="Touch",t.Mouse="Mouse",t.Pen="Pen",t.Unknown="Unknown"}(cr||(cr={})),function(t){t.Canvas="Canvas",t.Document="Document"}(hr||(hr={}));var Tr=function(t){h(n,t);var e=d(n);function n(){var t;return f(this,n),(t=e.call(this)).id=n._MAX_ID++,t._isDown=!1,t._wasDown=!1,t._actorsUnderPointer={length:0},t._actors=[],t._actorsLastFrame=[],t._actorsNoLongerUnderPointer=[],t._actorSortingFcn=function(t,e){return t.z===e.z?e.id-t.id:e.z-t.z},t.lastPagePos=null,t.lastScreenPos=null,t.lastWorldPos=null,t.dragTarget=null,t.on("move",t._onPointerMove),t.on("down",t._onPointerDown),t.on("up",t._onPointerUp),t}return p(n,[{key:"isDragging",get:function(){return this._isDown}},{key:"isDragStart",get:function(){return!this._wasDown&&this._isDown}},{key:"isDragEnd",get:function(){return this._wasDown&&!this._isDown}},{key:"hasActorsUnderPointer",get:function(){return!!this._actorsUnderPointer.length}},{key:"on",value:function(t,e){r(o(n.prototype),"on",this).call(this,t,e)}},{key:"once",value:function(t,e){r(o(n.prototype),"once",this).call(this,t,e)}},{key:"off",value:function(t,e){r(o(n.prototype),"off",this).call(this,t,e)}},{key:"update",value:function(){this._wasDown&&!this._isDown?this._wasDown=!1:!this._wasDown&&this._isDown&&(this._wasDown=!0),this._actorsLastFrame=a(this._actors),this._actorsNoLongerUnderPointer=[]}},{key:"addActorUnderPointer",value:function(t){this.isActorAliveUnderPointer(t)||(this._actorsUnderPointer[t.id]=t,this._actorsUnderPointer.length+=1,this._actors.push(t)),this._actors.sort(this._actorSortingFcn)}},{key:"removeActorUnderPointer",value:function(t){this.isActorAliveUnderPointer(t)&&(delete this._actorsUnderPointer[t.id],this._actorsUnderPointer.length-=1,V(t,this._actors),this._actorsNoLongerUnderPointer.push(t))}},{key:"getActorsUnderPointer",value:function(){return this._actors}},{key:"getActorsUnderPointerLastFrame",value:function(){return this._actorsLastFrame}},{key:"getActorsForEvents",value:function(){return this._actors.concat(this._actorsLastFrame).filter((function(t,e,n){return n.indexOf(t)===e})).sort(this._actorSortingFcn)}},{key:"checkActorUnderPointer",value:function(t){return!!this.lastWorldPos&&t.contains(this.lastWorldPos.x,this.lastWorldPos.y,!Oi(t))}},{key:"wasActorUnderPointer",value:function(t){return this._actorsLastFrame.indexOf(t)>-1}},{key:"isActorAliveUnderPointer",value:function(t){return!(t.isKilled()||!t.scene||!this._actorsUnderPointer.hasOwnProperty(t.id.toString()))}},{key:"_onPointerMove",value:function(t){this.lastPagePos=new rt(t.pagePos.x,t.pagePos.y),this.lastScreenPos=new rt(t.screenPos.x,t.screenPos.y),this.lastWorldPos=new rt(t.worldPos.x,t.worldPos.y)}},{key:"_onPointerDown",value:function(t){this.lastPagePos=new rt(t.pagePos.x,t.pagePos.y),this.lastScreenPos=new rt(t.screenPos.x,t.screenPos.y),this.lastWorldPos=new rt(t.worldPos.x,t.worldPos.y),this._isDown=!0}},{key:"_onPointerUp",value:function(t){this._isDown=!1,this.dragTarget=null}}]),n}(te);Tr._MAX_ID=0,function(t){t[t.NoButton=-1]="NoButton",t[t.Left=0]="Left",t[t.Middle=1]="Middle",t[t.Right=2]="Right",t[t.Unknown=3]="Unknown"}(dr||(dr={})),function(t){t.Left="Left",t.Middle="Middle",t.Right="Right",t.Unknown="Unknown",t.NoButton="NoButton"}(fr||(fr={})),function(t){t.Pixel="Pixel",t.Line="Line",t.Page="Page"}(pr||(pr={}));var Rr=function(t){h(n,t);var e=d(n);function n(t,i,r,o,a,s){var l;return f(this,n),(l=e.call(this)).coordinates=t,l.pointer=i,l.index=r,l.pointerType=o,l.button=a,l.ev=s,l._canceled=!1,l}return p(n,[{key:"name",get:function(){return this._name}},{key:"worldPos",get:function(){return this.coordinates.worldPos.clone()}},{key:"pagePos",get:function(){return this.coordinates.pagePos.clone()}},{key:"screenPos",get:function(){return this.coordinates.screenPos.clone()}},{key:"pos",get:function(){return this.coordinates.worldPos.clone()}},{key:"cancel",value:function(){this._canceled=!0}},{key:"isCanceled",value:function(){return this._canceled}},{key:"propagate",value:function(t){this.doAction(t),this.bubbles&&!this.isCanceled()&&t.parent&&this.propagate(t.parent)}},{key:"doAction",value:function(t){t&&(this._onActionStart(t),t.emit(this._name,this),this._onActionEnd(t))}},{key:"_onActionStart",value:function(t){}},{key:"_onActionEnd",value:function(t){}}]),n}(gt),Dr=function(){function t(e){f(this,t),this._pointerEventType=e}return p(t,[{key:"create",value:function(t,e,n,i,r,o){return new this._pointerEventType(t,e,n,i,r,o)}}]),t}(),Mr=function(t){h(n,t);var e=d(n);function n(){return f(this,n),e.apply(this,arguments)}return n}(Rr),Lr=function(t){h(n,t);var e=d(n);function n(){var t;return f(this,n),(t=e.apply(this,arguments))._name="pointerup",t}return p(n,[{key:"_onActionEnd",value:function(t){this.pointer.isDragEnd&&t.capturePointer.captureDragEvents&&t.eventDispatcher.emit("pointerdragend",this)}}]),n}(Rr),Br=function(t){h(n,t);var e=d(n);function n(){var t;return f(this,n),(t=e.apply(this,arguments))._name="pointerdown",t}return p(n,[{key:"_onActionEnd",value:function(t){this.pointer.isDragStart&&t.capturePointer.captureDragEvents&&t.eventDispatcher.emit("pointerdragstart",this)}}]),n}(Rr),Or=function(t){h(n,t);var e=d(n);function n(){var t;return f(this,n),(t=e.apply(this,arguments))._name="pointermove",t}return p(n,[{key:"propagate",value:function(t){this.pointer.isActorAliveUnderPointer(t)&&(this.doAction(t),this.bubbles&&!this.isCanceled()&&t.parent&&this.propagate(t.parent))}},{key:"_onActionStart",value:function(t){t.capturePointer.captureMoveEvents&&this.pointer.isDragging&&t.capturePointer.captureDragEvents&&t.eventDispatcher.emit("pointerdragmove",this)}}]),n}(Rr),Fr=function(t){h(n,t);var e=d(n);function n(){var t;return f(this,n),(t=e.apply(this,arguments))._name="pointerenter",t}return p(n,[{key:"_onActionStart",value:function(t){t.capturePointer.captureMoveEvents}},{key:"_onActionEnd",value:function(t){this.pointer.isDragging&&t.capturePointer.captureDragEvents&&t.eventDispatcher.emit("pointerdragenter",this)}}]),n}(Rr),Ir=function(t){h(n,t);var e=d(n);function n(){var t;return f(this,n),(t=e.apply(this,arguments))._name="pointerleave",t}return p(n,[{key:"_onActionStart",value:function(t){t.capturePointer.captureMoveEvents}},{key:"_onActionEnd",value:function(t){this.pointer.isDragging&&t.capturePointer.captureDragEvents&&t.eventDispatcher.emit("pointerdragleave",this)}}]),n}(Rr),zr=function(t){h(n,t);var e=d(n);function n(){var t;return f(this,n),(t=e.apply(this,arguments))._name="pointercancel",t}return n}(Rr),Nr=function(t){h(n,t);var e=d(n);function n(t,i,r,o,a,s,l,u,c,h,d,p){var v;return f(this,n),(v=e.call(this)).x=t,v.y=i,v.pageX=r,v.pageY=o,v.screenX=a,v.screenY=s,v.index=l,v.deltaX=u,v.deltaY=c,v.deltaZ=h,v.deltaMode=d,v.ev=p,v._isCanceled=!1,v}return p(n,[{key:"cancel",value:function(){this._isCanceled=!0}},{key:"isCanceled",value:function(){return this._isCanceled}}]),n}(gt);function Ur(t,e,n,i,r,o,a){var s;switch(t){case"up":s=new Dr(Lr);break;case"down":s=new Dr(Br);break;case"move":s=new Dr(Or);break;case"cancel":s=new Dr(zr);break;case"enter":s=new Dr(Fr);break;case"leave":s=new Dr(Ir)}return s.create(e,n,i,r,o,a)}var Hr=function(){function t(e,n,i){f(this,t),this.worldPos=e,this.pagePos=n,this.screenPos=i}return p(t,null,[{key:"fromPagePosition",value:function(e,n,i){var r,o;3===arguments.length?(r=new rt(e,n),o=i):((r=e).x,r.y,o=n);var a=o.screen.pageToScreenCoordinates(r);return new t(o.screen.screenToWorldCoordinates(a),r,a)}}]),t}(),Wr=function(t){h(n,t);var e=d(n);function n(t){var i;return f(this,n),(i=e.call(this))._pointerDown=[],i._pointerUp=[],i._pointerMove=[],i._pointerCancel=[],i._wheel=[],i._pointers=[],i._activePointers=[],i._engine=t,i._pointers.push(new Tr),i._activePointers=[-1],i.primary=i._pointers[0],i}return p(n,[{key:"on",value:function(t,e){r(o(n.prototype),"on",this).call(this,t,e)}},{key:"init",value:function(t){(t=t||this._engine.canvas).addEventListener("touchstart",this._handleTouchEvent("down",this._pointerDown)),t.addEventListener("touchend",this._handleTouchEvent("up",this._pointerUp)),t.addEventListener("touchmove",this._handleTouchEvent("move",this._pointerMove)),t.addEventListener("touchcancel",this._handleTouchEvent("cancel",this._pointerCancel)),window.PointerEvent?(this._engine.canvas.style.touchAction="none",t.addEventListener("pointerdown",this._handlePointerEvent("down",this._pointerDown)),t.addEventListener("pointerup",this._handlePointerEvent("up",this._pointerUp)),t.addEventListener("pointermove",this._handlePointerEvent("move",this._pointerMove)),t.addEventListener("pointercancel",this._handlePointerEvent("cancel",this._pointerCancel))):window.MSPointerEvent?(this._engine.canvas.style.msTouchAction="none",t.addEventListener("MSPointerDown",this._handlePointerEvent("down",this._pointerDown)),t.addEventListener("MSPointerUp",this._handlePointerEvent("up",this._pointerUp)),t.addEventListener("MSPointerMove",this._handlePointerEvent("move",this._pointerMove)),t.addEventListener("MSPointerCancel",this._handlePointerEvent("cancel",this._pointerCancel))):(t.addEventListener("mousedown",this._handleMouseEvent("down",this._pointerDown)),t.addEventListener("mouseup",this._handleMouseEvent("up",this._pointerUp)),t.addEventListener("mousemove",this._handleMouseEvent("move",this._pointerMove)));var e={passive:!(this._engine.pageScrollPreventionMode===lo.All||this._engine.pageScrollPreventionMode===lo.Canvas)};"onwheel"in document.createElement("div")?t.addEventListener("wheel",this._handleWheelEvent("wheel",this._wheel),e):void 0!==document.onmousewheel?t.addEventListener("mousewheel",this._handleWheelEvent("wheel",this._wheel),e):t.addEventListener("MozMousePixelScroll",this._handleWheelEvent("wheel",this._wheel),e)}},{key:"triggerEvent",value:function(t,e){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:dr.Left,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"mouse",o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=0,l=0;e instanceof Hr?(a=e.pagePos.x,l=e.pagePos.y,n=e):(a=e.x,l=e.y,n=new Hr(e.clone(),e.clone(),e.clone()));var u={pageX:a,pageY:l,pointerId:o,pointerType:r,button:i,preventDefault:function(){}};switch(t){case"move":this._handlePointerEvent(t,this._pointerMove,n)(u);break;case"down":this._handlePointerEvent(t,this._pointerDown,n)(u);break;case"up":this._handlePointerEvent(t,this._pointerUp,n)(u);break;case"cancel":this._handlePointerEvent(t,this._pointerCancel,n)(u)}var c,h=s(this._engine.currentScene.actors);try{for(h.s();!(c=h.n()).done;){var d=c.value,f=d.traits.filter((function(t){return t instanceof Xn}))[0];f&&f.update(d,this._engine,1)}}catch(p){h.e(p)}finally{h.f()}this.dispatchPointerEvents(),this.update()}},{key:"update",value:function(){this._pointerUp.length=0,this._pointerDown.length=0,this._pointerMove.length=0,this._pointerCancel.length=0,this._wheel.length=0;for(var t=0;t<this._pointers.length;t++)this._pointers[t].update()}},{key:"at",value:function(t){if(t>=this._pointers.length)for(var e=this._pointers.length-1,n=t;e<n;e++)this._pointers.push(new Tr),this._activePointers.push(-1);return this._pointers[t]}},{key:"count",value:function(){return this._pointers.length}},{key:"checkAndUpdateActorUnderPointer",value:function(t){var e,n=s(this._pointers);try{for(n.s();!(e=n.n()).done;){var i=e.value;i.checkActorUnderPointer(t)?i.addActorUnderPointer(t):i.removeActorUnderPointer(t)}}catch(r){n.e(r)}finally{n.f()}}},{key:"_dispatchWithBubble",value:function(t){var e,n=s(t);try{for(n.s();!(e=n.n()).done;){var i,r=e.value,o=s(r.pointer.getActorsForEvents());try{for(o.s();!(i=o.n()).done;){var a=i.value;if(r.isCanceled()||r.propagate(a),!r.bubbles||r.isCanceled())break}}catch(l){o.e(l)}finally{o.f()}}}catch(l){n.e(l)}finally{n.f()}}},{key:"_dispatchPointerLeaveEvents",value:function(){var t,e={},n=[],i=s(this._pointerMove);try{for(i.s();!(t=i.n()).done;){var r,o=t.value,a=s(o.pointer.getActorsForEvents());try{for(a.s();!(r=a.n()).done;){var l=r.value;if(!e[o.pointer.id+"+"+l.id]&&o.pointer.wasActorUnderPointer(l)&&!o.pointer.isActorAliveUnderPointer(l)&&!o.isCanceled()){e[o.pointer.id+"+"+l.id]=o;var u=Ur("leave",new Hr(o.worldPos,o.pagePos,o.screenPos),o.pointer,o.index,o.pointerType,o.button,o.ev);u.propagate(l),n.push(u)}}}catch(c){a.e(c)}finally{a.f()}}}catch(c){i.e(c)}finally{i.f()}return n}},{key:"_dispatchPointerEnterEvents",value:function(){var t,e={},n=[],i=s(this._pointerMove);try{for(i.s();!(t=i.n()).done;){var r,o=t.value,a=s(o.pointer.getActorsForEvents());try{for(a.s();!(r=a.n()).done;){var l=r.value;if(!e[o.pointer.id]&&!o.pointer.wasActorUnderPointer(l)&&o.pointer.isActorAliveUnderPointer(l)&&!o.isCanceled()){e[o.pointer.id]=o;var u=Ur("enter",new Hr(o.worldPos,o.pagePos,o.screenPos),o.pointer,o.index,o.pointerType,o.button,o.ev);u.propagate(l),n.push(u),o.pointer.isDragging&&(o.pointer.dragTarget=l)}}}catch(c){a.e(c)}finally{a.f()}}}catch(c){i.e(c)}finally{i.f()}return n}},{key:"dispatchPointerEvents",value:function(){this._dispatchWithBubble(this._pointerDown),this._dispatchWithBubble(this._pointerUp),this._dispatchWithBubble(this._pointerMove),this._dispatchPointerLeaveEvents(),this._dispatchPointerEnterEvents(),this._dispatchWithBubble(this._pointerCancel);var t,e=s(this._wheel);try{for(e.s();!(t=e.n()).done;){var n,i=t.value,r=s(this._pointers[i.index].getActorsUnderPointer());try{for(r.s();!(n=r.n()).done;){var o=n.value;if(this._propagateWheelPointerEvent(o,i),!i.bubbles||i.isCanceled())break}}catch(a){r.e(a)}finally{r.f()}}}catch(a){e.e(a)}finally{e.f()}}},{key:"_propagateWheelPointerEvent",value:function(t,e){t.emit("pointerwheel",e),e.bubbles&&!e.isCanceled()&&t.parent&&this._propagateWheelPointerEvent(t.parent,e)}},{key:"_handleMouseEvent",value:function(t,e){var n=this;return function(i){i.preventDefault();var r=n.at(0),o=Hr.fromPagePosition(i.pageX,i.pageY,n._engine),a=Ur(t,o,r,0,cr.Mouse,n._nativeButtonToPointerButton(i.button),i);e.push(a),r.eventDispatcher.emit(t,a)}}},{key:"_handleTouchEvent",value:function(t,e){var n=this;return function(i){i.preventDefault();for(var r=0,o=i.changedTouches.length;r<o;r++){var a=n._pointers.length>1?n._getPointerIndex(i.changedTouches[r].identifier):0;if(-1!==a){var s=n.at(a),l=Hr.fromPagePosition(i.changedTouches[r].pageX,i.changedTouches[r].pageY,n._engine),u=Ur(t,l,s,a,cr.Touch,fr.Unknown,i);e.push(u),s.eventDispatcher.emit(t,u),n.emit(t,u),n._pointers.length>1&&("up"===t?n._activePointers[a]=-1:"down"===t&&(n._activePointers[a]=i.changedTouches[r].identifier))}}}}},{key:"_handlePointerEvent",value:function(t,e,n){var i=this;return function(r){r.preventDefault();var o=i._pointers.length>1?i._getPointerIndex(r.pointerId):0;if(-1!==o){var a=i.at(o),s=n||Hr.fromPagePosition(r.pageX,r.pageY,i._engine),l=Ur(t,s,a,o,i._stringToPointerType(r.pointerType),i._nativeButtonToPointerButton(r.button),r);e.push(l),a.eventDispatcher.emit(t,l),i.emit(t,l),i._pointers.length>1&&("up"===t?i._activePointers[o]=-1:"down"===t&&(i._activePointers[o]=r.pointerId))}}}},{key:"_handleWheelEvent",value:function(t,e){var n=this;return function(i){(n._engine.pageScrollPreventionMode===lo.All||n._engine.pageScrollPreventionMode===lo.Canvas&&i.target===n._engine.canvas)&&i.preventDefault();var r=n._engine.screen.pageToScreenCoordinates(ot(i.pageX,i.pageY)),o=n._engine.screen.screenToWorldCoordinates(r),a=i.deltaX||i.wheelDeltaX*(-1/40)||0,s=i.deltaY||i.wheelDeltaY*(-1/40)||i.wheelDelta*(-1/40)||i.detail||0,l=i.deltaZ||0,u=pr.Pixel;i.deltaMode&&(1===i.deltaMode?u=pr.Line:2===i.deltaMode&&(u=pr.Page));var c=new Nr(o.x,o.y,i.pageX,i.pageY,r.x,r.y,0,a,s,l,u,i);e.push(c),n.at(0).eventDispatcher.emit(t,c),n.emit(t,c)}}},{key:"_getPointerIndex",value:function(t){var e;if((e=this._activePointers.indexOf(t))>-1)return e;for(var n=0;n<this._activePointers.length;n++)if(-1===this._activePointers[n])return n;return-1}},{key:"_nativeButtonToPointerButton",value:function(t){switch(t){case dr.NoButton:return fr.NoButton;case dr.Left:return fr.Left;case dr.Middle:return fr.Middle;case dr.Right:return fr.Right;case dr.Unknown:return fr.Unknown;default:return Q(t)}}},{key:"_stringToPointerType",value:function(t){switch(t){case"touch":return cr.Touch;case"mouse":return cr.Mouse;case"pen":return cr.Pen;default:return cr.Unknown}}}]),n}(te),jr=function(t){h(n,t);var e=d(n);function n(){var t;return f(this,n),(t=e.call(this)).enabled=!1,t.supported=!!navigator.getGamepads,t._gamePadTimeStamps=[0,0,0,0],t._oldPads=[],t._pads=[],t._initSuccess=!1,t._navigator=navigator,t._minimumConfiguration=null,t}return p(n,[{key:"init",value:function(){this.supported&&(this._initSuccess||(this._oldPads=this._clonePads(this._navigator.getGamepads()),this._oldPads.length&&this._oldPads[0]&&(this._initSuccess=!0)))}},{key:"setMinimumGamepadConfiguration",value:function(t){this._enableAndUpdate(),this._minimumConfiguration=t}},{key:"_enableAndUpdate",value:function(){this.enabled||(this.enabled=!0,this.update())}},{key:"_isGamepadValid",value:function(t){if(!this._minimumConfiguration)return!0;if(!t)return!1;var e=t.axes.filter((function(t){return void 0!==typeof t})).length,n=t.buttons.filter((function(t){return void 0!==typeof t})).length;return e>=this._minimumConfiguration.axis&&n>=this._minimumConfiguration.buttons&&t.connected}},{key:"on",value:function(t,e){this._enableAndUpdate(),r(o(n.prototype),"on",this).call(this,t,e)}},{key:"off",value:function(t,e){this._enableAndUpdate(),r(o(n.prototype),"off",this).call(this,t,e)}},{key:"update",value:function(){if(this.enabled&&this.supported){this.init();for(var t=this._navigator.getGamepads(),e=0;e<t.length;e++)if(t[e]){if(!this.at(e).connected&&this._isGamepadValid(t[e])&&this.eventDispatcher.emit("connect",new Rt(e,this.at(e))),this.at(e).connected=!0,!t[e].timestamp||t[e].timestamp!==this._gamePadTimeStamps[e]){var n=void 0,i=void 0,r=void 0,o=void 0,a=void 0;for(n in this._gamePadTimeStamps[e]=t[e].timestamp,this.at(e).navigatorGamepad=t[e],Vr)"number"==typeof(i=Vr[n])&&t[e].buttons[i]&&(a=t[e].buttons[i].value)!==this._oldPads[e].getButton(i)&&(t[e].buttons[i].pressed?(this.at(e).updateButton(i,a),this.at(e).eventDispatcher.emit("button",new Mt(i,a,this.at(e)))):this.at(e).updateButton(i,0));for(r in Gr)"number"==typeof(o=Gr[r])&&(a=t[e].axes[o])!==this._oldPads[e].getAxes(o)&&(this.at(e).updateAxes(o,a),this.at(e).eventDispatcher.emit("axis",new Lt(o,a,this.at(e))));this._oldPads[e]=this._clonePad(t[e])}}else{var s=this.at(e);s.connected&&this.eventDispatcher.emit("disconnect",new Dt(e,s)),s.connected=!1}}}},{key:"at",value:function(t){if(this._enableAndUpdate(),t>=this._pads.length)for(var e=this._pads.length-1,n=t;e<n;e++)this._pads.push(new Xr),this._oldPads.push(new Xr);return this._pads[t]}},{key:"getValidGamepads",value:function(){this._enableAndUpdate();for(var t=[],e=0;e<this._pads.length;e++)this._isGamepadValid(this.at(e).navigatorGamepad)&&this.at(e).connected&&t.push(this.at(e));return t}},{key:"count",value:function(){return this._pads.filter((function(t){return t.connected})).length}},{key:"_clonePads",value:function(t){for(var e=[],n=0,i=t.length;n<i;n++)e.push(this._clonePad(t[n]));return e}},{key:"_clonePad",value:function(t){var e,n,i=new Xr;if(!t)return i;for(e=0,n=t.buttons.length;e<n;e++)t.buttons[e]&&i.updateButton(e,t.buttons[e].value);for(e=0,n=t.axes.length;e<n;e++)i.updateAxes(e,t.axes[e]);return i}}]),n}(te);jr.MinAxisMoveThreshold=.05;var Vr,Gr,Xr=function(t){h(n,t);var e=d(n);function n(){var t;f(this,n),(t=e.call(this)).connected=!1,t._buttons=new Array(16),t._axes=new Array(4);for(var i=0;i<t._buttons.length;i++)t._buttons[i]=0;for(var r=0;r<t._axes.length;r++)t._axes[r]=0;return t}return p(n,[{key:"isButtonPressed",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this._buttons[t]>=e}},{key:"getButton",value:function(t){return this._buttons[t]}},{key:"getAxes",value:function(t){var e=this._axes[t];return Math.abs(e)<jr.MinAxisMoveThreshold?0:e}},{key:"updateButton",value:function(t,e){this._buttons[t]=e}},{key:"updateAxes",value:function(t,e){this._axes[t]=e}}]),n}(te);!function(t){t[t.Face1=0]="Face1",t[t.Face2=1]="Face2",t[t.Face3=2]="Face3",t[t.Face4=3]="Face4",t[t.LeftBumper=4]="LeftBumper",t[t.RightBumper=5]="RightBumper",t[t.LeftTrigger=6]="LeftTrigger",t[t.RightTrigger=7]="RightTrigger",t[t.Select=8]="Select",t[t.Start=9]="Start",t[t.LeftStick=10]="LeftStick",t[t.RightStick=11]="RightStick",t[t.DpadUp=12]="DpadUp",t[t.DpadDown=13]="DpadDown",t[t.DpadLeft=14]="DpadLeft",t[t.DpadRight=15]="DpadRight"}(Vr||(Vr={})),function(t){t[t.LeftStickX=0]="LeftStickX",t[t.LeftStickY=1]="LeftStickY",t[t.RightStickX=2]="RightStickX",t[t.RightStickY=3]="RightStickY"}(Gr||(Gr={}));var qr,Kr=function(){function t(e){f(this,t),this.nativeComponent=e,this._paused=!1,this._nativeHandlers={}}return p(t,[{key:"on",value:function(t,e){this._nativeHandlers[t]&&this.off(t,this._nativeHandlers[t]),this._nativeHandlers[t]=this._decorate(e),this.nativeComponent.addEventListener(t,this._nativeHandlers[t])}},{key:"off",value:function(t,e){e||(e=this._nativeHandlers[t]),this.nativeComponent.removeEventListener(t,e),this._nativeHandlers[t]=null}},{key:"_decorate",value:function(t){var e=this;return function(n){e._paused||t(n)}}},{key:"pause",value:function(){this._paused=!0}},{key:"resume",value:function(){this._paused=!1}},{key:"clear",value:function(){for(var t in this._nativeHandlers)this.off(t)}}]),t}(),Qr=function(){function t(e,n){f(this,t),this._windowGlobal=e,this._documentGlobal=n,this._windowComponent=new Kr(this._windowGlobal),this._documentComponent=new Kr(this._documentGlobal)}return p(t,[{key:"window",get:function(){return this._windowComponent}},{key:"document",get:function(){return this._documentComponent}},{key:"pause",value:function(){this.window.pause(),this.document.pause()}},{key:"resume",value:function(){this.window.resume(),this.document.resume()}},{key:"clear",value:function(){this.window.clear(),this.document.clear()}}]),t}(),Yr=function(){function t(){f(this,t),this._states=[],this._currentState=this._getDefaultState()}return p(t,[{key:"_getDefaultState",value:function(){return{opacity:1}}},{key:"_cloneState",value:function(){return{opacity:this._currentState.opacity}}},{key:"save",value:function(){this._states.push(this._currentState),this._currentState=this._cloneState()}},{key:"restore",value:function(){this._currentState=this._states.pop()}},{key:"current",get:function(){return this._currentState}}]),t}(),Zr=function(t){h(n,t);var e=d(n);function n(t){var i;f(this,n),(i=e.call(this,t))._text="",i._dirty=!0,i.alphabet="",i.shadow=null,i.caseInsensitive=!1,i.spacing=0,i._logger=P.getInstance(),i._sprites=[];var r=t.alphabet,o=t.spriteSheet,a=t.caseInsensitive,s=t.spacing,l=t.shadow;return i.alphabet=r,i.spriteSheet=o,i.caseInsensitive=null!=a?a:i.caseInsensitive,i.spacing=null!=s?s:i.spacing,i.shadow=null!=l?l:i.shadow,i.spriteSheet.sprites[0].image.ready.then((function(){i._updateDimensions()})),i}return p(n,[{key:"_getCharacterSprites",value:function(t){if(!this._dirty)return this._sprites;for(var e=[],n=this.caseInsensitive?t.toLocaleLowerCase():t,i=this.caseInsensitive?this.alphabet.toLocaleLowerCase():this.alphabet,r=0;r<n.length;r++){var o=n[r],a=i.indexOf(o);-1===a&&(a=0,this._logger.warn("SpriteFont - Cannot find letter '".concat(o,"' in configured alphabet '").concat(i,"'")));var s=this.spriteSheet.sprites[a];s?e.push(s):this._logger.warn("SpriteFont - Cannot find sprite for '".concat(o,"' at index '").concat(a,"' in configured SpriteSheet"))}return this._dirty=!1,this._sprites=e}},{key:"_updateDimensions",value:function(){var t,e=this._getCharacterSprites(this._text),n=0,i=0,r=s(e);try{for(r.s();!(t=r.n()).done;){var o=t.value;n+=o.width+this.spacing,i=Math.max(i,o.height)}}catch(a){r.e(a)}finally{r.f()}this.width=n,this.height=i}},{key:"updateText",value:function(t){this._text!==t&&(this._dirty=!0,this._text=t,this._updateDimensions())}},{key:"_preDraw",value:function(t,e,i){this._updateDimensions(),r(o(n.prototype),"_preDraw",this).call(this,t,e,i)}},{key:"_drawImage",value:function(t,e,n){var i,r=0,o=s(this._getCharacterSprites(this._text));try{for(o.s();!(i=o.n()).done;){var a=i.value;a.draw(t,e+r,n),r+=a.width+this.spacing}}catch(l){o.e(l)}finally{o.f()}}},{key:"render",value:function(t,e,n,i){this._text!==e&&(this._dirty=!0,this._text=e),this.shadow&&(t.save(),t.translate(this.shadow.offset.x,this.shadow.offset.y),this.draw(t,n,i),t.restore()),this.draw(t,n,i)}},{key:"clone",value:function(){return new n({alphabet:this.alphabet,spriteSheet:this.spriteSheet,spacing:this.spacing})}}],[{key:"fromLegacySpriteFont",value:function(t){var e=t.sprites.map(yi.fromLegacySprite);return new n({alphabet:t.alphabet,spacing:0,caseInsensitive:t.caseInsensitive,spriteSheet:new ki({sprites:e})})}}]),n}(se),$r=function(){function t(){f(this,t),this.fontSheet="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAAwCAYAAAD+f6R/AAAAAXNSR0IArs4c6QAABcJJREFUeJztnemu7CgMhGE07//KmT9NhrAFVzkQndQntXRP3/bCZkwCSQhCCCGEEEIIIYQQQog/TRz953Ecx/nDGIe/vdNhlc9tIz605Fk/ZmWfsO1hn9Gxuv1KHbvb3iL/VN+d1WORbyr7yR/5b9M4vjNeqko6jPJHq5wGHU151o9J2Udse9hndCxuv0rH7rY3yD/Wdyf13MrnQeDfkZIUSGKM4ff3cWN82pEZuTyQGX2IxeyR63va//8VNCYCq+1yEkLtWyagXv1P1r1H+110gP3PzT4gT8uW/mdQ8mUG8E9DqOz4MS9ICKGbXpS2BpnIrRzYeS96cll08INlCMl2/glzdcfazuuPqQO03lmqrBHsf272Q6NODXj6zzZIJd/LAHYTg3Mays5gBi7ZR27fOgs0yj8rm36DLMFiPgkAdXHKOwUQeMCQ/adSh/qBQrT/tPxbAwA9+DOZEILPAATSuHMgTv7+Auk/df2lHPCZLvMSLJe34LkEQ9PwXF1SRTllMYgvIaflqyVAjLGbsiCDcOK76jflxZ+sINPyROc5071yKWK5CJTV3dMp6+tBlyCtNlhAq/+XbWoBDcRNXYBMzD4VvQygSuPYC2jGGaSSOxXfy3dTUEsanIvNeepm38N/hssSALTPZnAXfwIYRJn2b7UBcw0FKX+nDdAMpm2j9WVnxrUa7TXaVAca/B+TgaAVh6R/rH0P/5m01dt/RLYViJn+w/bhVX2P7f/duqom5qb02pRLCLGIMgBU1wCEEN9BAUCID6MAIMSHUQAQ4sMoAAjxYRQAhPgwd1uB0fuZ7H3cnn2P+9mr/Pe4B8/eB/fwP4eRtci/0f6OfTCPt/9oHwC6G6y19RHZDumxmwzR4eE/s/2Tte/q/+XLdc9DeJ19diesQc/j7Z8fCe4tAS4CxZ7sp7eiJi7HiZmjmOTGJs+93CbS3nP0XIPH3vW8/qz6QPnX2QdsV/1uw/iZYvg8ACeHd28rpPzfNfhL+7vkw/4Ou9s+Onhbv91elpKZ48Dl6bzpwwibHigRArf+Ptk9+L3Y1Q5OB4LgCeSBw1iuB3GeJh1/HrX/zF0A9Mk+u45zMkc3r4rWPomma5+p/514LB+Zo93MErJ1JHxXPzByGa/licRYVKbpeQCoQ6Q8yxuCwJF9IPsoDkHAo/3Tx26cvA4EtJ/n04w8QOq/mrR7ddfLAC5BYFNlVI/0CnOVUflOpvJUQMx9AIMIW/nWDM67/qw0+95v9goBqD9j+72u/KD9U89IbnQbMIR2Zbneh5zUY7Hdk7XIP3UffVb+r+wDYAZLq+1n1+C7y3/ny2r7p5yeByDEh9HzAIQQJwoAQnwYBQAhPowCgBBjoNu3hNxSFACE6INuKvPajPZ4EFEAEKINcybGYzOd247WEd3TgA2jlmjEyrd+j9hvfVbD2PWQ3ZmGlu2HyO8og8eBuNUvNYWoDgMVpwHTJoLWdz1Y+ZYOy5uF7t6PPruZxANrud1lQXkP0jsGz/Yz+vGGMuygFyhSPcJnc1pMnQZElc+cRnoAlxdTvoDuK7puqF7uCQy+3fyFMiA02/vJQHh7DQDogMPTSGFNA56HTzbZ9yAfBOb1Zyo3qGM3MfMZ3f76huXf6xlmAHknMlLNXsBBBvbljIz9Uyz5Y5TzIBLR/qy/rNyrZ8+L/0BZ0m+tgXD0OK5XZxC/9P7I/g4hVFvzXf1/6i5A7+3AlijMPBLMZfCvuAp7A9rY56ApHitmLQc7c8bOv6ftAxlM9Xp35nkEK7nJetBsaMhtAAAuOLQGXwhh2dXQnn1rZ/a42BI3dL7L+jkFAbQddwdA9Ah35yMKhgEgVT46EFh5D4jz+OgavNKxeBCd1wDSJ/97oR8eoJkLi9t9/BDgDHTJ5NE7Dnzechh914OVv9M1K9PCqsfqb88XVg9qN9lm6nG176UPu+zn17GOxuO0vOWEEC/j+LFKTgghlvEfYJaLS+SA2O0AAAAASUVORK5CYII=",this.size=16,this.load()}return p(t,[{key:"load",value:function(){var t=this;return this._imageSource=new gi(this.fontSheet),this._imageSource.load().then((function(){t._spriteSheet=ki.fromImageSource({image:t._imageSource,grid:{rows:3,columns:16,spriteWidth:16,spriteHeight:16}}),t._spriteFont=new Zr({alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ,!'&.\"?-()+ ",caseInsensitive:!0,spriteSheet:t._spriteSheet,spacing:-6})}))}},{key:"write",value:function(t,e,n){this._imageSource.isLoaded()&&this._spriteFont.render(t,e,n.x,n.y)}}]),t}(),Jr=function(){function t(e){f(this,t),this._ex=e,this._debugText=new $r}return p(t,[{key:"drawRect",value:function(t,e,n,i){this._ex.__ctx.save(),this._ex.__ctx.strokeStyle="red",this._ex.__ctx.strokeRect(this._ex.snapToPixel?~~t:t,this._ex.snapToPixel?~~e:e,this._ex.snapToPixel?~~n:n,this._ex.snapToPixel?~~i:i),this._ex.__ctx.restore()}},{key:"drawLine",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{color:ut.Black};this._ex.__ctx.save(),this._ex.__ctx.beginPath(),this._ex.__ctx.strokeStyle=n.color.toString(),this._ex.__ctx.moveTo(this._ex.snapToPixel?~~t.x:t.x,this._ex.snapToPixel?~~t.y:t.y),this._ex.__ctx.lineTo(this._ex.snapToPixel?~~e.x:e.x,this._ex.snapToPixel?~~e.y:e.y),this._ex.__ctx.lineWidth=2,this._ex.__ctx.stroke(),this._ex.__ctx.closePath(),this._ex.__ctx.restore()}},{key:"drawPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{color:ut.Black,size:5};this._ex.__ctx.save(),this._ex.__ctx.beginPath(),this._ex.__ctx.fillStyle=e.color.toString(),this._ex.__ctx.arc(this._ex.snapToPixel?~~t.x:t.x,this._ex.snapToPixel?~~t.y:t.y,e.size,0,2*Math.PI),this._ex.__ctx.fill(),this._ex.__ctx.closePath(),this._ex.__ctx.restore()}},{key:"drawText",value:function(t,e){this._debugText.write(this._ex,t,e)}}]),t}(),to=function(){function t(e){f(this,t),this.backgroundColor=ut.ExcaliburBlue,this._state=new Yr,this.snapToPixel=!0,this.debug=new Jr(this);var n=e.canvasElement,i=e.enableTransparency,r=e.snapToPixel,o=e.smoothing,a=e.backgroundColor;this.__ctx=n.getContext("2d",{alpha:null==i||i}),this.backgroundColor=null!=a?a:this.backgroundColor,this.snapToPixel=null!=r?r:this.snapToPixel,this.smoothing=null!=o?o:this.smoothing}return p(t,[{key:"width",get:function(){return this.__ctx.canvas.width}},{key:"height",get:function(){return this.__ctx.canvas.height}},{key:"opacity",get:function(){return this._state.current.opacity},set:function(t){this._state.current.opacity=t}},{key:"smoothing",get:function(){return this.__ctx.imageSmoothingEnabled},set:function(t){this.__ctx.imageSmoothingEnabled=t}},{key:"resetTransform",value:function(){this.__ctx.resetTransform()}},{key:"updateViewport",value:function(){}},{key:"drawImage",value:function(t,e,n,i,r,o,a,s,l){var u=this;if(0!==i&&0!==r&&0!==s&&0!==l&&0!==t.width&&0!==t.height){this.__ctx.globalAlpha=this.opacity;var c=[t,e,n,i,r,o,a,s,l].filter((function(t){return void 0!==t})).map((function(t){return"number"==typeof t&&u.snapToPixel?~~t:t}));this.__ctx.drawImage.apply(this.__ctx,c),or.DrawCallCount++,or.DrawnImagesCount=1}}},{key:"drawLine",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;this.__ctx.save(),this.__ctx.beginPath(),this.__ctx.strokeStyle=n.toString(),this.__ctx.moveTo(this.snapToPixel?~~t.x:t.x,this.snapToPixel?~~t.y:t.y),this.__ctx.lineTo(this.snapToPixel?~~e.x:e.x,this.snapToPixel?~~e.y:e.y),this.__ctx.lineWidth=i,this.__ctx.stroke(),this.__ctx.closePath(),this.__ctx.restore()}},{key:"drawRectangle",value:function(t,e,n,i){this.__ctx.save(),this.__ctx.fillStyle=i.toString(),this.__ctx.fillRect(this.snapToPixel?~~t.x:t.x,this.snapToPixel?~~t.y:t.y,this.snapToPixel?~~e:e,this.snapToPixel?~~n:n),this.__ctx.restore()}},{key:"drawCircle",value:function(t,e,n){this.__ctx.save(),this.__ctx.beginPath(),this.__ctx.fillStyle=n.toString(),this.__ctx.arc(this.snapToPixel?~~t.x:t.x,this.snapToPixel?~~t.y:t.y,e,0,2*Math.PI),this.__ctx.fill(),this.__ctx.closePath(),this.__ctx.restore()}},{key:"save",value:function(){this.__ctx.save()}},{key:"restore",value:function(){this.__ctx.restore()}},{key:"translate",value:function(t,e){this.__ctx.translate(this.snapToPixel?~~t:t,this.snapToPixel?~~e:e)}},{key:"rotate",value:function(t){this.__ctx.rotate(t)}},{key:"scale",value:function(t,e){this.__ctx.scale(t,e)}},{key:"clear",value:function(){this.__ctx.clearRect(0,0,this.width,this.height),this.__ctx.fillStyle=this.backgroundColor.toString(),this.__ctx.fillRect(0,0,this.width,this.height),or.clear()}},{key:"flush",value:function(){}}]),t}(),eo=function(){function t(){f(this,t),this._transforms=[],this._currentTransform=en.identity()}return p(t,[{key:"save",value:function(){this._transforms.push(this._currentTransform),this._currentTransform=this._currentTransform.clone()}},{key:"restore",value:function(){this._currentTransform=this._transforms.pop()}},{key:"translate",value:function(t,e){return this._currentTransform.translate(t,e)}},{key:"rotate",value:function(t){return this._currentTransform.rotate(t)}},{key:"scale",value:function(t,e){return this._currentTransform.scale(t,e)}},{key:"current",get:function(){return this._currentTransform},set:function(t){this._currentTransform=t}}]),t}(),no=function(){function t(e,n,i){f(this,t),this._gl=e,this._vertexSource=n,this._fragmentSource=i,this.program=null,this.uniforms={},this.attributes={},this.layout=[],this.compile(e)}return p(t,[{key:"_createProgram",value:function(t,e,n){var i=t.createProgram();if(null===i)throw Error("Could not create graphics shader program");if(t.attachShader(i,e),t.attachShader(i,n),t.linkProgram(i),!t.getProgramParameter(i,t.LINK_STATUS))throw Error("Could not link the program: [".concat(t.getProgramInfoLog(i),"]"));return i}},{key:"_compileShader",value:function(t,e,n){var i=t.createShader(n);if(null===i)throw Error("Could not build shader: [".concat(e,"]"));if(t.shaderSource(i,e),t.compileShader(i),!t.getShaderParameter(i,t.COMPILE_STATUS))throw Error("Could not compile shader [".concat(t.getShaderInfoLog(i),"]"));return i}},{key:"compile",value:function(t){var e=this._compileShader(t,this._vertexSource,t.VERTEX_SHADER),n=this._compileShader(t,this._fragmentSource,t.FRAGMENT_SHADER),i=this._createProgram(t,e,n);return this.program=i}},{key:"addUniformMatrix",value:function(t,e){if(!e)throw Error("Shader Uniform Matrix '".concat(t,"' was set to null or undefined"));var n=this._gl;this.uniforms[t]={name:t,type:"matrix",location:n.getUniformLocation(this.program,t),data:e}}},{key:"addUniformIntegerArray",value:function(t,e){if(!e)throw Error("Shader Uniform Integery Array '".concat(t,"' was set to null or undefined"));var n=this._gl;this.uniforms[t]={name:t,type:"numbers",location:n.getUniformLocation(this.program,t),data:e}}},{key:"addAttribute",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=this._gl.getAttribLocation(this.program,t);this.attributes[t]={name:t,size:e,glType:n,normalized:i,location:r},this.layout.push(this.attributes[t])}},{key:"vertexAttributeSize",get:function(){var t,e=0,n=s(this.layout);try{for(n.s();!(t=n.n()).done;)e+=t.value.size}catch(i){n.e(i)}finally{n.f()}return e}},{key:"totalVertexSizeBytes",get:function(){var t,e=0,n=s(this.layout);try{for(n.s();!(t=n.n()).done;){var i=t.value,r=1;switch(i.glType){case this._gl.FLOAT:r=4;break;default:r=1}e+=r*i.size}}catch(o){n.e(o)}finally{n.f()}return e}},{key:"getAttributeSize",value:function(t){var e=1;switch(this.attributes[t].glType){case this._gl.FLOAT:e=4;break;default:e=1}return e*this.attributes[t].size}},{key:"use",value:function(){var t=this._gl;t.useProgram(this.program);var e,n=0,i=s(this.layout);try{for(i.s();!(e=i.n()).done;){var r=e.value;t.vertexAttribPointer(r.location,r.size,r.glType,r.normalized,this.totalVertexSizeBytes,n),t.enableVertexAttribArray(r.location),n+=this.getAttributeSize(r.name)}}catch(l){i.e(l)}finally{i.f()}for(var o in this.uniforms){var a=this.uniforms[o];switch(a.type){case"matrix":t.uniformMatrix4fv(a.location,!1,a.data);break;case"numbers":t.uniform1iv(a.location,a.data)}}}}]),t}(),io=function(){function t(e){f(this,t),this.max=e,this._pool=void 0,this.commands=[]}return p(t,[{key:"isFull",value:function(){return this.commands.length>=this.max}},{key:"canAdd",value:function(){return!this.isFull()}},{key:"add",value:function(t){this.commands.push(t)}},{key:"dispose",value:function(){return this.commands.length=0,this}}]),t}(),ro=function(){function t(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100;f(this,t),this.builder=e,this.recycler=n,this.maxObjects=i,this.totalAllocations=0,this.index=0,this.objects=[],this._logger=P.getInstance()}return p(t,[{key:"using",value:function(t){var e=t(this);return e?this.done.apply(this,a(e)):this.done()}},{key:"borrow",value:function(t){t(this.get()),this.index--}},{key:"get",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];if(this.index===this.maxObjects&&(this._logger.warn("Max pooled objects reached, possible memory leak? Doubling"),this.maxObjects=2*this.maxObjects),this.objects[this.index])return this.recycler.apply(this,[this.objects[this.index++]].concat(e));this.totalAllocations++;var i=this.objects[this.index++]=this.builder.apply(this,e);return i._pool=this,i}},{key:"done",value:function(){this.index=0;for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var i=0,r=e;i<r.length;i++){var o=r[i],a=this.objects.indexOf(o);this.objects[a]=this.builder(),this.objects[a]._pool=this,this.totalAllocations++,o._pool=void 0}return e}}]),t}(),oo=function(){function t(e){var n,i,r,o=this;f(this,t),this.priority=0,this._buffer=null,this._maxCommandsPerBatch=2e3,this._batches=[],this._gl=e.gl;var a=e.command;this._verticesPerCommand=null!==(n=null==e?void 0:e.verticesPerCommand)&&void 0!==n?n:1,this._maxCommandsPerBatch=null!==(i=null==e?void 0:e.maxCommandsPerBatch)&&void 0!==i?i:this._maxCommandsPerBatch;var s=null!==(r=null==e?void 0:e.batchFactory)&&void 0!==r?r:function(){return new io(o._maxCommandsPerBatch)};this.commands=new ro((function(){return new a}),(function(t){return t.dispose()}),this._maxCommandsPerBatch),this._batchPool=new ro(s,(function(t){return t.dispose()}),100)}return p(t,[{key:"init",value:function(){var t=this._gl;this.shader=this.buildShader(t),this._vertices=new Float32Array(this.shader.vertexAttributeSize*this._verticesPerCommand*this._maxCommandsPerBatch),this._buffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this._buffer),t.bufferData(t.ARRAY_BUFFER,this._vertices,t.DYNAMIC_DRAW)}},{key:"vertexSize",get:function(){return this.shader.vertexAttributeSize}},{key:"addCommand",value:function(t){0===this._batches.length&&this._batches.push(this._batchPool.get());var e=this._batches[this._batches.length-1];if(e.canAdd())e.add(t);else{var n=this._batchPool.get();n.add(t),this._batches.push(n)}}},{key:"render",value:function(){var t=this._gl;t.bindBuffer(t.ARRAY_BUFFER,this._buffer),this.shader.use();var e,n=0,i=0,r=s(this._batches);try{for(r.s();!(e=r.n()).done;){var o=e.value,a=this.buildBatchVertices(this._vertices,o);t.bufferSubData(t.ARRAY_BUFFER,0,this._vertices),this.renderBatch(t,o,a),i+=o.commands.length,n++}}catch(l){r.e(l)}finally{r.f()}this.commands.done(),this._batchPool.done(),this._batches.length=0,or.DrawCallCount+=n,or.DrawnImagesCount+=i}}]),t}(),ao=function(){function t(){f(this,t),this.color=ut.Black,this.start=rt.Zero,this.end=rt.Zero}return p(t,[{key:"dispose",value:function(){return this.color.r=0,this.color.g=0,this.color.b=0,this.color.a=1,this.start.setTo(0,0),this.end.setTo(0,0),this}}]),t}(),so=function(t){h(n,t);var e=d(n);function n(t,i){var r;return f(this,n),(r=e.call(this,{gl:t,command:ao,verticesPerCommand:2}))._contextInfo=i,r.init(),r}return p(n,[{key:"buildShader",value:function(t){var e=new no(t,"attribute vec4 a_position;\r\nattribute vec4 a_color;\r\n\r\nvarying lowp vec4 v_color;\r\n\r\nuniform mat4 u_matrix;\r\n\r\n\r\nvoid main() {\r\n   // Set the vertex position using the ortho transform matrix\r\n   gl_Position = u_matrix * a_position;\r\n\r\n   // Passthrough the color\r\n   v_color = a_color;\r\n}","precision mediump float;\r\n\r\n// Color\r\nvarying lowp vec4 v_color;\r\n\r\n\r\nvoid main() {\r\n  gl_FragColor = v_color;\r\n}");return e.addAttribute("a_position",2,t.FLOAT),e.addAttribute("a_color",4,t.FLOAT),e.addUniformMatrix("u_matrix",this._contextInfo.matrix.data),e}},{key:"addLine",value:function(t,e,n){var i=this.commands.get();i.start=this._contextInfo.transform.current.multv(t),i.end=this._contextInfo.transform.current.multv(e),i.color.r=n.r,i.color.g=n.g,i.color.b=n.b,i.color.a=i.color.a*this._contextInfo.state.current.opacity,this.addCommand(i)}},{key:"buildBatchVertices",value:function(t,e){var n,i=0,r=s(e.commands);try{for(r.s();!(n=r.n()).done;){var o=n.value;t[i++]=o.start.x,t[i++]=o.start.y,t[i++]=o.color.r/255,t[i++]=o.color.g/255,t[i++]=o.color.b/255,t[i++]=o.color.a,t[i++]=o.end.x,t[i++]=o.end.y,t[i++]=o.color.r/255,t[i++]=o.color.g/255,t[i++]=o.color.b/255,t[i++]=o.color.a}}catch(a){r.e(a)}finally{r.f()}return i/this.vertexSize}},{key:"renderBatch",value:function(t,e,n){t.drawArrays(t.LINES,0,n)}}]),n}(oo);!function(t){t.Image="image",t.Line="line",t.Rectangle="rectangle",t.Circle="circle"}(qr||(qr={}));var lo,uo=function(){function t(e,n,i,r,o,a,s,l,u){f(this,t),this._pool=void 0,this.snapToPixel=!0,this.type=qr.Image,this.opacity=1,this.width=0,this.height=0,this.dest=[0,0],this.view=[0,0,0,0],this._geom=[[0,0],[0,0],[0,0],[0,0],[0,0],[0,0]],this.init(e,n,i,r,o,a,s,l,u)}return p(t,[{key:"init",value:function(t,e,n,i,r,o,a,l,u){this.type=qr.Image,this.image=t,this.width=(null==t?void 0:t.width)||i||0,this.height=(null==t?void 0:t.height)||r||0,this.view=[0,0,null!=i?i:null==t?void 0:t.width,null!=r?r:null==t?void 0:t.height],this.dest=[e,n],void 0!==o&&void 0!==a&&void 0!==l&&void 0!==u&&(this.view=[e,n,null!=i?i:null==t?void 0:t.width,null!=r?r:null==t?void 0:t.height],this.dest=[o,a],this.width=l,this.height=u);var c=0;if(this._geom[c++]=[this.dest[0],this.dest[1]],this._geom[c++]=[this.dest[0],this.dest[1]+this.height],this._geom[c++]=[this.dest[0]+this.width,this.dest[1]],this._geom[c++]=[this.dest[0]+this.width,this.dest[1]],this._geom[c++]=[this.dest[0],this.dest[1]+this.height],this._geom[c++]=[this.dest[0]+this.width,this.dest[1]+this.height],this.snapToPixel){var h,d=s(this._geom);try{for(d.s();!(h=d.n()).done;){var f=h.value;f[0]=~~f[0],f[1]=~~f[1]}}catch(p){d.e(p)}finally{d.f()}}return this}},{key:"initRect",value:function(t,e,n,i){this.type=qr.Rectangle,this.color=t,this.width=n,this.height=i;var r=0;if(this._geom[r++]=[e.x,e.y],this._geom[r++]=[e.x,e.y+this.height],this._geom[r++]=[e.x+this.width,e.y],this._geom[r++]=[e.x+this.width,e.y],this._geom[r++]=[e.x,e.y+this.height],this._geom[r++]=[e.x+this.width,e.y+this.height],this.snapToPixel){var o,a=s(this._geom);try{for(a.s();!(o=a.n()).done;){var l=o.value;l[0]=~~l[0],l[1]=~~l[1]}}catch(u){a.e(u)}finally{a.f()}}return this}},{key:"initLine",value:function(t,e,n,i){this.type=qr.Line,this.color=t;var r=n.sub(e).normalize().perpendicular(),o=i/2,a=r.scale(o).add(e),l=r.scale(-o).add(e),u=r.scale(o).add(n),c=r.scale(-o).add(n),h=0;if(this._geom[h++]=[a.x,a.y],this._geom[h++]=[u.x,u.y],this._geom[h++]=[l.x,l.y],this._geom[h++]=[l.x,l.y],this._geom[h++]=[u.x,u.y],this._geom[h++]=[c.x,c.y],this.snapToPixel){var d,f=s(this._geom);try{for(f.s();!(d=f.n()).done;){var p=d.value;p[0]=~~p[0],p[1]=~~p[1]}}catch(v){f.e(v)}finally{f.f()}}return this}},{key:"initCircle",value:function(t,e,n){this.type=qr.Circle,this.color=n;var i=t.add(ot(-e,-e)),r=t.add(ot(e,-e)),o=t.add(ot(e,e)),a=t.add(ot(-e,e)),l=0;if(this._geom[l++]=[i.x,i.y],this._geom[l++]=[r.x,r.y],this._geom[l++]=[a.x,a.y],this._geom[l++]=[a.x,a.y],this._geom[l++]=[r.x,r.y],this._geom[l++]=[o.x,o.y],this.snapToPixel){var u,c=s(this._geom);try{for(c.s();!(u=c.n()).done;){var h=u.value;h[0]=~~h[0],h[1]=~~h[1]}}catch(d){c.e(d)}finally{c.f()}}return this}},{key:"dispose",value:function(){this.image=null,this.width=0,this.height=0,this.view=[0,0,0,0],this.dest=[0,0];var t=0;return this._geom[t++]=[this.dest[0],this.dest[1]],this._geom[t++]=[this.dest[0],this.dest[1]+this.height],this._geom[t++]=[this.dest[0]+this.width,this.dest[1]],this._geom[t++]=[this.dest[0]+this.width,this.dest[1]],this._geom[t++]=[this.dest[0],this.dest[1]+this.height],this._geom[t++]=[this.dest[0]+this.width,this.dest[1]+this.height],this}},{key:"applyTransform",value:function(t,e){if(t)for(var n=0;n<this._geom.length;n++)this._geom[n]=t.multv(this._geom[n]),this.snapToPixel&&(this._geom[n]=[~~this._geom[n][0],~~this._geom[n][1]]);this.opacity=e}},{key:"geometry",get:function(){return this._geom}}]),t}(),co=function(t){h(n,t);var e=d(n);function n(t,i){var r;return f(this,n),(r=e.call(this,t)).maxDraws=t,r.maxTextures=i,r.textures=[],r.commands=[],r._graphicMap={},r}return p(n,[{key:"isFull",value:function(){return this.commands.length>=this.maxDraws||this.textures.length>=this.maxTextures}},{key:"canAdd",value:function(){return!(this.commands.length>=this.maxDraws)&&this.textures.length<this.maxTextures}},{key:"_isCommandFull",value:function(){return this.commands.length>=this.maxDraws}},{key:"_isTextureFull",value:function(){return this.textures.length>=this.maxTextures}},{key:"_wouldAddTexture",value:function(t){return!this._graphicMap[t.image.id]}},{key:"maybeAdd",value:function(t){return(!this._isCommandFull()&&!this._isTextureFull()||!this._wouldAddTexture(t))&&(this.add(t),!0)}},{key:"add",value:function(t){if(t.type===qr.Image){var e=de.load(t.image);-1===this.textures.indexOf(e)&&this.textures.push(e)}this.commands.push(t)}},{key:"bindTextures",value:function(t){for(var e=0;e<this.maxTextures;e++)t.activeTexture(t.TEXTURE0+e),t.bindTexture(t.TEXTURE_2D,this.textures[e]||this.textures[0])}},{key:"getBatchTextureId",value:function(t){return t.image?this.textures.indexOf(de.get(t.image)):-1}},{key:"dispose",value:function(){return this.clear(),this}},{key:"clear",value:function(){this.commands.length=0,this.textures.length=0,this._graphicMap={}}}]),n}(io),ho=function(t){h(n,t);var e=d(n);function n(t,i){var r;return f(this,n),(r=e.call(this,{gl:t,command:uo,verticesPerCommand:6,maxCommandsPerBatch:2e3,batchFactory:function(){return new co(2e3,t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS))}}))._contextInfo=i,de.registerContext(t),r.init(),r}return p(n,[{key:"buildShader",value:function(t){var e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),n=new no(t,"attribute vec4 a_position;\r\n\r\n// Opacity \r\nattribute float a_opacity;\r\nvarying float v_opacity;\r\n\r\nattribute vec4 a_color;\r\nvarying vec4 v_color;\r\n\r\n// UV coordinate\r\nattribute vec2 a_texcoord;\r\nvarying vec2 v_texcoord;\r\n\r\n// Texture number\r\nattribute lowp float a_textureIndex;\r\nvarying lowp float v_textureIndex;\r\n\r\nuniform mat4 u_matrix;\r\n\r\n\r\nvoid main() {\r\n   // Set the vertex position using the ortho transform matrix\r\n   gl_Position = u_matrix * a_position;\r\n\r\n   // Pass through the Opacity to the fragment shader\r\n   v_opacity = a_opacity;\r\n   // Pass through the UV coord to the fragment shader\r\n   v_texcoord = a_texcoord;\r\n   // Pass through the texture number to the fragment shader\r\n   v_textureIndex = a_textureIndex;\r\n   // Pass through the color to the fragment shader\r\n   v_color = a_color;\r\n}",this._transformFragmentSource("#ifdef GL_OES_standard_derivatives\r\n#extension GL_OES_standard_derivatives : enable\r\n#endif\r\nprecision mediump float;\r\n\r\n// UV coord\r\nvarying vec2 v_texcoord;\r\n\r\n// Texture index\r\nvarying lowp float v_textureIndex;\r\n\r\n// Color coord to blend with image\r\nvarying lowp vec4 v_color;\r\n\r\n// Opacity\r\nvarying float v_opacity;\r\n\r\nuniform sampler2D u_textures[%%count%%];\r\n\r\nfloat circle(in vec2 st, in float radius) {\r\n  vec2 dist = st - vec2(0.5);\r\n  float r = dot(dist, dist) * 4.0;\r\n  float delta = fwidth(r);\r\n  return 1.0 - smoothstep(radius - delta, radius + delta, r);\r\n}\r\n\r\nvoid main() {\r\n  float r = 0.0, delta = 0.0, alpha = 1.0;\r\n   // In order to support the most efficient sprite batching, we have multiple\r\n   // textures loaded into the gpu (usually 8) this picker logic skips over textures\r\n   // that do not apply to a particular sprite.\r\n\r\n   vec4 color;\r\n   // -1 If there is no texture to sample we are drawing a solid geometry (rectangles)\r\n   if (v_textureIndex == -1.0) {\r\n     color = v_color;\r\n     color.w = color.w * v_opacity;\r\n   // -2 If there is no texture we are drawing a circle\r\n   } else if (v_textureIndex == -2.0) {\r\n     color = v_color;\r\n     color.a = color.a * circle(v_texcoord, .95);\r\n   } else {\r\n     // GLSL is templated out to pick the right texture and set the vec4 color\r\n      %%texture_picker%%\r\n   }\r\n   color.w = color.w * v_opacity;\r\n   gl_FragColor = color;\r\n}",e));return n.addAttribute("a_position",3,t.FLOAT),n.addAttribute("a_texcoord",2,t.FLOAT),n.addAttribute("a_textureIndex",1,t.FLOAT),n.addAttribute("a_opacity",1,t.FLOAT),n.addAttribute("a_color",4,t.FLOAT),n.addUniformMatrix("u_matrix",this._contextInfo.matrix.data),n.addUniformIntegerArray("u_textures",a(Array(e)).map((function(t,e){return e}))),n}},{key:"_transformFragmentSource",value:function(t,e){for(var n=t.replace("%%count%%",e.toString()),i="",r=0;r<e;r++)i+=0===r?"if (v_textureIndex <= ".concat(r,".5) {\n"):"   else if (v_textureIndex <= ".concat(r,".5) {\n"),i+="      color = texture2D(u_textures[".concat(r,"], v_texcoord);\n"),i+="   }\n";return n=n.replace("%%texture_picker%%",i)}},{key:"addCircle",value:function(t,e,n){var i=this.commands.get().initCircle(t,e,n);i.applyTransform(this._contextInfo.transform.current,this._contextInfo.state.current.opacity),this.addCommand(i)}},{key:"addRectangle",value:function(t,e,n,i){var r=this.commands.get().initRect(t,e,n,i);r.applyTransform(this._contextInfo.transform.current,this._contextInfo.state.current.opacity),this.addCommand(r)}},{key:"addLine",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=this.commands.get().initLine(t,e,n,i);r.applyTransform(this._contextInfo.transform.current,this._contextInfo.state.current.opacity),this.addCommand(r)}},{key:"addImage",value:function(t,e,n,i,r,o,a,s,l){var u=this.commands.get().init(t,e,n,i,r,o,a,s,l);u.applyTransform(this._contextInfo.transform.current,this._contextInfo.state.current.opacity),this.addCommand(u)}},{key:"renderBatch",value:function(t,e,n){e.bindTextures(t),t.drawArrays(t.TRIANGLES,0,n)}},{key:"buildBatchVertices",value:function(t,e){var n,i,r,o=0,a=0,l=0,u=0,c=0,h=1,d=1,f=0,p=ut.Transparent,v=s(e.commands);try{for(v.s();!(r=v.n()).done;){var g=r.value;a=g.view[0],l=g.view[1],u=g.view[2],c=g.view[3],h=ue((null===(n=g.image)||void 0===n?void 0:n.width)||g.width),d=ue((null===(i=g.image)||void 0===i?void 0:i.height)||g.height),f=e.getBatchTextureId(g),g.type!==qr.Line&&g.type!==qr.Rectangle||(f=-1,p=g.color),g.type===qr.Circle&&(f=-2,p=g.color);var y=a/h,m=l/d,_=(a+u)/h,w=(l+c)/d;-2===f&&(y=0,m=0,_=1,w=1),t[o++]=g.geometry[0][0],t[o++]=g.geometry[0][1],t[o++]=0,t[o++]=y,t[o++]=m,t[o++]=f,t[o++]=g.opacity,t[o++]=p.r/255,t[o++]=p.g/255,t[o++]=p.b/255,t[o++]=p.a,t[o++]=g.geometry[1][0],t[o++]=g.geometry[1][1],t[o++]=0,t[o++]=y,t[o++]=w,t[o++]=f,t[o++]=g.opacity,t[o++]=p.r/255,t[o++]=p.g/255,t[o++]=p.b/255,t[o++]=p.a,t[o++]=g.geometry[2][0],t[o++]=g.geometry[2][1],t[o++]=0,t[o++]=_,t[o++]=m,t[o++]=f,t[o++]=g.opacity,t[o++]=p.r/255,t[o++]=p.g/255,t[o++]=p.b/255,t[o++]=p.a,t[o++]=g.geometry[3][0],t[o++]=g.geometry[3][1],t[o++]=0,t[o++]=_,t[o++]=m,t[o++]=f,t[o++]=g.opacity,t[o++]=p.r/255,t[o++]=p.g/255,t[o++]=p.b/255,t[o++]=p.a,t[o++]=g.geometry[4][0],t[o++]=g.geometry[4][1],t[o++]=0,t[o++]=y,t[o++]=w,t[o++]=f,t[o++]=g.opacity,t[o++]=p.r/255,t[o++]=p.g/255,t[o++]=p.b/255,t[o++]=p.a,t[o++]=g.geometry[5][0],t[o++]=g.geometry[5][1],t[o++]=0,t[o++]=_,t[o++]=w,t[o++]=f,t[o++]=g.opacity,t[o++]=p.r/255,t[o++]=p.g/255,t[o++]=p.b/255,t[o++]=p.a}}catch(b){v.e(b)}finally{v.f()}return o/this.vertexSize}}]),n}(oo),fo=function(){function t(){f(this,t),this.point=rt.Zero,this.color=ut.Black,this.size=1}return p(t,[{key:"dispose",value:function(){return this.point.setTo(0,0),this.color.r=0,this.color.g=0,this.color.b=0,this.color.a=1,this.size=1,this}}]),t}(),po=function(t){h(n,t);var e=d(n);function n(t,i){var r;return f(this,n),(r=e.call(this,{gl:t,command:fo,verticesPerCommand:1}))._contextInfo=i,r.init(),r}return p(n,[{key:"buildShader",value:function(t){t.getExtension("OES_standard_derivatives");var e=new no(t,"attribute vec4 a_position;\r\nattribute vec4 a_color;\r\nattribute float a_size;\r\nvarying lowp vec4 v_color;\r\nuniform mat4 u_matrix;\r\n\r\nvoid main() {\r\n  gl_Position = u_matrix * a_position;\r\n  gl_PointSize = a_size * 2.0;\r\n  v_color = a_color;\r\n}","#ifdef GL_OES_standard_derivatives\r\n#extension GL_OES_standard_derivatives : enable\r\n#endif\r\n\r\nprecision mediump float;\r\nvarying lowp vec4 v_color;\r\n\r\nvoid main() {\r\n  float r = 0.0, delta = 0.0, alpha = 1.0;\r\n  vec2 cxy = 2.0 * gl_PointCoord - 1.0;\r\n  r = dot(cxy, cxy);\r\n  \r\n#ifdef GL_OES_standard_derivatives\r\n  delta = fwidth(r);\r\n  alpha = 1.0 - smoothstep(1.0 - delta, 1.0 + delta, r);\r\n#else\r\n  if (r > 1.0) {\r\n    discard;\r\n  }\r\n#endif\r\n  gl_FragColor = vec4(v_color.rgb, v_color.a * alpha);\r\n}");return e.addAttribute("a_position",2,t.FLOAT),e.addAttribute("a_color",4,t.FLOAT),e.addAttribute("a_size",1,t.FLOAT),e.addUniformMatrix("u_matrix",this._contextInfo.matrix.data),e}},{key:"addPoint",value:function(t,e,n){var i=this.commands.get();i.point=this._contextInfo.transform.current.multv(t),i.color.r=e.r,i.color.g=e.g,i.color.b=e.b,i.color.a=e.a*this._contextInfo.state.current.opacity,i.size=n*Math.max(this._contextInfo.transform.current.getScaleX(),this._contextInfo.transform.current.getScaleY()),this.addCommand(i)}},{key:"buildBatchVertices",value:function(t,e){var n,i=0,r=s(e.commands);try{for(r.s();!(n=r.n()).done;){var o=n.value;t[i++]=o.point.x,t[i++]=o.point.y,t[i++]=o.color.r/255,t[i++]=o.color.g/255,t[i++]=o.color.b/255,t[i++]=o.color.a,t[i++]=o.size}}catch(a){r.e(a)}finally{r.f()}return i/this.vertexSize}},{key:"renderBatch",value:function(t,e,n){t.drawArrays(t.POINTS,0,n)}}]),n}(oo),vo=function(){function t(e){f(this,t),this._webglCtx=e,this._debugText=new $r}return p(t,[{key:"drawRect",value:function(t,e,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{color:ut.Black};this.drawLine(ot(t,e),ot(t+n,e),Object.assign({},r)),this.drawLine(ot(t+n,e),ot(t+n,e+i),Object.assign({},r)),this.drawLine(ot(t+n,e+i),ot(t,e+i),Object.assign({},r)),this.drawLine(ot(t,e+i),ot(t,e),Object.assign({},r))}},{key:"drawLine",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{color:ut.Black};this._webglCtx.__lineRenderer.addLine(t,e,n.color)}},{key:"drawPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{color:ut.Black,size:5};this._webglCtx.__pointRenderer.addPoint(t,e.color,e.size)}},{key:"drawText",value:function(t,e){this._debugText.write(this._webglCtx,t,e)}}]),t}(),go=function(){function t(e){f(this,t),this._transform=new eo,this._state=new Yr,this.snapToPixel=!0,this.smoothing=!1,this.backgroundColor=ut.ExcaliburBlue,this.debug=new vo(this);var n=e.canvasElement,i=e.enableTransparency,r=e.smoothing,o=e.snapToPixel,a=e.backgroundColor;this.__gl=n.getContext("webgl",{antialias:null!=r?r:this.smoothing,premultipliedAlpha:!1,alpha:null==i||i,depth:!0,powerPreference:"high-performance"}),this.snapToPixel=null!=o?o:this.snapToPixel,this.smoothing=null!=r?r:this.smoothing,this.backgroundColor=null!=a?a:this.backgroundColor,this._init()}return p(t,[{key:"opacity",get:function(){return this._state.current.opacity},set:function(t){this._state.current.opacity=t}},{key:"width",get:function(){return this.__gl.canvas.width}},{key:"height",get:function(){return this.__gl.canvas.height}},{key:"_init",value:function(){var t=this.__gl;this._ortho=en.ortho(0,t.canvas.width,t.canvas.height,0,400,-400),t.viewport(0,0,t.canvas.width,t.canvas.height),t.clearColor(this.backgroundColor.r/255,this.backgroundColor.g/255,this.backgroundColor.b/255,this.backgroundColor.a),t.clear(t.COLOR_BUFFER_BIT),t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA),this.__pointRenderer=new po(t,{matrix:this._ortho,transform:this._transform,state:this._state}),this.__lineRenderer=new so(t,{matrix:this._ortho,transform:this._transform,state:this._state}),this.__imageRenderer=new ho(t,{matrix:this._ortho,transform:this._transform,state:this._state}),this._canvas=new pe({width:t.canvas.width,height:t.canvas.height}),this.__ctx=this._canvas.ctx}},{key:"resetTransform",value:function(){this._transform.current=en.identity()}},{key:"updateViewport",value:function(){var t=this.__gl;this._ortho=this._ortho=en.ortho(0,t.canvas.width,t.canvas.height,0,400,-400),this.__pointRenderer.shader.addUniformMatrix("u_matrix",this._ortho.data),this.__lineRenderer.shader.addUniformMatrix("u_matrix",this._ortho.data),this.__imageRenderer.shader.addUniformMatrix("u_matrix",this._ortho.data),this._canvas.width=t.canvas.width,this._canvas.height=t.canvas.height}},{key:"drawImage",value:function(t,e,n,i,r,o,a,s,l){if(0!==i&&0!==r&&0!==s&&0!==l&&0!==t.width&&0!==t.height)return t?void this.__imageRenderer.addImage(t,e,n,i,r,o,a,s,l):(P.getInstance().warn("Cannot draw a null or undefined image"),void(console.trace&&console.trace()))}},{key:"drawLine",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;this.__imageRenderer.addLine(n,t,e,i)}},{key:"drawRectangle",value:function(t,e,n,i){this.__imageRenderer.addRectangle(i,t,e,n)}},{key:"drawCircle",value:function(t,e,n){this.__imageRenderer.addCircle(t,e,n)}},{key:"save",value:function(){this._transform.save(),this._state.save()}},{key:"restore",value:function(){this._transform.restore(),this._state.restore()}},{key:"translate",value:function(t,e){this._transform.translate(this.snapToPixel?~~t:t,this.snapToPixel?~~e:e)}},{key:"rotate",value:function(t){this._transform.rotate(t)}},{key:"scale",value:function(t,e){this._transform.scale(t,e)}},{key:"transform",value:function(t){this._transform.current=t}},{key:"clear",value:function(){var t=this.__gl;t.clearColor(this.backgroundColor.r/255,this.backgroundColor.g/255,this.backgroundColor.b/255,this.backgroundColor.a),t.clear(t.COLOR_BUFFER_BIT),or.clear()}},{key:"flush",value:function(){var t=this.__gl;t.viewport(0,0,t.canvas.width,t.canvas.height),this.__imageRenderer.render(),this.__lineRenderer.render(),this.__pointRenderer.render()}}]),t}(),yo=function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a};C(),function(t){t[t.None=0]="None",t[t.Canvas=1]="Canvas",t[t.All=2]="All"}(lo||(lo={}));var mo=function(t){h(n,t);var e=d(n);function n(t){var r,o,a,s;f(this,n),(r=e.call(this))._hasStarted=!1,r.postProcessors=[],r.scenes={},r._animations=[],r._suppressPlayButton=!1,r.pauseAudioWhenHidden=!0,r._isDebug=!1,r.debugColor=new ut(255,255,255),r.enableCanvasTransparency=!0,r.onFatalException=function(t){P.getInstance().fatal(t)},r._timescale=1,r._isLoading=!1,r._isInitialized=!1,r._deferredGoTo=null,t=Object.assign(Object.assign({},n._DEFAULT_ENGINE_OPTIONS),t),S.freeze(),r.browser=new Qr(window,document);var l=new me;if(!t.suppressMinimumBrowserFeatureDetection&&!(r._compatible=l.test())){var u=document.createElement("div");if(u.innerText="Sorry, your browser does not support all the features needed for Excalibur",document.body.appendChild(u),l.failedTests.forEach((function(t){var e=document.createElement("div");e.innerText="Browser feature missing "+t,document.body.appendChild(e)})),t.canvasElementId){var h=document.getElementById(t.canvasElementId);h&&h.parentElement.removeChild(h)}return i(r)}r._compatible=!0,console.log&&!t.suppressConsoleBootMessage&&(console.log("%cPowered by Excalibur.js (v".concat(ra,")"),"background: #176BAA; color: white; border-radius: 5px; padding: 15px; font-size: 1.5em; line-height: 80px;"),console.log("\n      /| ________________\nO|===|* >________________>\n      \\|"),console.log("Visit","http://excaliburjs.com","for more information")),t.suppressPlayButton&&(r._suppressPlayButton=!0),r._logger=P.getInstance(),r._logger.defaultLevel===k.Debug&&l.logBrowserFeatures(),r._logger.debug("Building engine..."),r.canvasElementId=t.canvasElementId,t.canvasElementId?(r._logger.debug("Using Canvas element specified: "+t.canvasElementId),r.canvas=document.getElementById(t.canvasElementId)):t.canvasElement?(r._logger.debug("Using Canvas element specified:",t.canvasElement),r.canvas=t.canvasElement):(r._logger.debug("Using generated canvas element"),r.canvas=document.createElement("canvas"));var d=null!==(o=t.displayMode)&&void 0!==o?o:at.Fixed;if(t.width&&t.height||t.viewport?(void 0===t.displayMode&&(d=at.Fixed),r._logger.debug("Engine viewport is size "+t.width+" x "+t.height)):t.displayMode||(r._logger.debug("Engine viewport is fit"),d=at.FitScreen),S.isEnabled(b.Canvas)){var p=new to({canvasElement:r.canvas,enableTransparency:r.enableCanvasTransparency,smoothing:t.antialiasing,backgroundColor:t.backgroundColor,snapToPixel:t.snapToPixel});r.graphicsContext=p,r.ctx=p.__ctx}else{var v=new go({canvasElement:r.canvas,enableTransparency:r.enableCanvasTransparency,smoothing:t.antialiasing,backgroundColor:t.backgroundColor,snapToPixel:t.snapToPixel});r.graphicsContext=v,r.ctx=v.__ctx}return r.screen=new ft({canvas:r.canvas,context:r.graphicsContext,antialiasing:null===(a=t.antialiasing)||void 0===a||a,browser:r.browser,viewport:null!==(s=t.viewport)&&void 0!==s?s:t.width&&t.height?{width:t.width,height:t.height}:dt.SVGA,resolution:t.resolution,displayMode:d,position:t.position,pixelRatio:t.suppressHiDPIScaling?1:null}),r.screen.applyResolutionAndViewport(),t.backgroundColor&&(r.backgroundColor=t.backgroundColor.clone()),r.enableCanvasTransparency=t.enableCanvasTransparency,r._loader=new ge,r.debug=new Cr(c(r)),r._initialize(t),r.rootScene=r.currentScene=new br,r.addScene("root",r.rootScene),r}return p(n,[{key:"canvasWidth",get:function(){return this.screen.canvasWidth}},{key:"halfCanvasWidth",get:function(){return this.screen.halfCanvasWidth}},{key:"canvasHeight",get:function(){return this.screen.canvasHeight}},{key:"halfCanvasHeight",get:function(){return this.screen.halfCanvasHeight}},{key:"drawWidth",get:function(){return this.screen.drawWidth}},{key:"halfDrawWidth",get:function(){return this.screen.halfDrawWidth}},{key:"drawHeight",get:function(){return this.screen.drawHeight}},{key:"halfDrawHeight",get:function(){return this.screen.halfDrawHeight}},{key:"isHiDpi",get:function(){return this.screen.isHiDpi}},{key:"stats",get:function(){return this.debug.stats}},{key:"isFullscreen",get:function(){return this.screen.isFullScreen}},{key:"displayMode",get:function(){return this.screen.displayMode}},{key:"pixelRatio",get:function(){return this.screen.pixelRatio}},{key:"isDebug",get:function(){return this._isDebug}},{key:"on",value:function(t,e){r(o(n.prototype),"on",this).call(this,t,e)}},{key:"once",value:function(t,e){r(o(n.prototype),"once",this).call(this,t,e)}},{key:"off",value:function(t,e){r(o(n.prototype),"off",this).call(this,t,e)}},{key:"getWorldBounds",value:function(){return this.screen.getWorldBounds()}},{key:"timescale",get:function(){return this._timescale},set:function(t){t<=0?P.getInstance().error("Cannot set engine.timescale to a value of 0 or less than 0."):this._timescale=t}},{key:"playAnimation",value:function(t,e,n){this._animations.push(new _o(t,e,n))}},{key:"addTileMap",value:function(t){this.currentScene.addTileMap(t)}},{key:"removeTileMap",value:function(t){this.currentScene.removeTileMap(t)}},{key:"addTimer",value:function(t){return this.currentScene.addTimer(t)}},{key:"removeTimer",value:function(t){return this.currentScene.removeTimer(t)}},{key:"addScene",value:function(t,e){this.scenes[t]&&this._logger.warn("Scene",t,"already exists overwriting"),this.scenes[t]=e}},{key:"removeScene",value:function(t){if(t instanceof br)for(var e in this.scenes)this.scenes.hasOwnProperty(e)&&this.scenes[e]===t&&delete this.scenes[e];"string"==typeof t&&delete this.scenes[t]}},{key:"add",value:function(t){2!==arguments.length?this._deferredGoTo&&this.scenes[this._deferredGoTo]?this.scenes[this._deferredGoTo].add(t):this.currentScene.add(t):this.addScene(arguments[0],arguments[1])}},{key:"remove",value:function(t){t instanceof Zn&&this.currentScene.remove(t),t instanceof br&&this.removeScene(t),"string"==typeof t&&this.removeScene(t)}},{key:"goToScene",value:function(t){if(this.isInitialized)if(this.scenes[t]){var e=this.currentScene,n=this.scenes[t];this._logger.debug("Going to scene:",t),this.currentScene.isInitialized&&(this.currentScene._deactivate.apply(this.currentScene,[e,n]),this.currentScene.eventDispatcher.emit("deactivate",new Kt(n,this.currentScene))),this.currentScene=n,this.screen.setCurrentCamera(n.camera),this.currentScene._initialize(this),this.currentScene._activate.apply(this.currentScene,[e,n]),this.currentScene.eventDispatcher.emit("activate",new qt(e,this.currentScene))}else this._logger.error("Scene",t,"does not exist!");else this._deferredGoTo=t}},{key:"screenToWorldCoordinates",value:function(t){return this.screen.screenToWorldCoordinates(t)}},{key:"worldToScreenCoordinates",value:function(t){return this.screen.worldToScreenCoordinates(t)}},{key:"_initialize",value:function(t){var e,n,i=this;this.pageScrollPreventionMode=t.scrollPreventionMode,this.input={keyboard:new Ar,pointers:new Wr(this),gamepads:new jr},this.input.keyboard.init(),this.input.pointers.init(t&&t.pointerScope===hr.Document?document:this.canvas),this.input.gamepads.init(),void 0!==document.hidden?(e="hidden",n="visibilitychange"):"msHidden"in document?(e="msHidden",n="msvisibilitychange"):"webkitHidden"in document&&(e="webkitHidden",n="webkitvisibilitychange"),this.browser.document.on(n,(function(){document[e]?(i.eventDispatcher.emit("hidden",new It(i)),i._logger.debug("Window hidden")):(i.eventDispatcher.emit("visible",new Ft(i)),i._logger.debug("Window visible"))})),this.canvasElementId||t.canvasElement||document.body.appendChild(this.canvas)}},{key:"onInitialize",value:function(t){}},{key:"setAntialiasing",value:function(t){this.screen.antialiasing=t}},{key:"getAntialiasing",value:function(){return this.screen.antialiasing}},{key:"isInitialized",get:function(){return this._isInitialized}},{key:"_overrideInitialize",value:function(t){this.isInitialized||(this.onInitialize(t),r(o(n.prototype),"emit",this).call(this,"initialize",new Xt(t,this)),this._isInitialized=!0,this._deferredGoTo?this.goToScene(this._deferredGoTo):this.goToScene("root"))}},{key:"_update",value:function(t){if(this._isLoading)return this._loader.update(this,t),this.input.keyboard.update(),this.input.pointers.update(),void this.input.gamepads.update();this._overrideInitialize(this),this._preupdate(t),this.currentScene.update(this,t),this._animations=this._animations.filter((function(t){return!t.animation.isDone()})),this.input.keyboard.update(),this.input.pointers.update(),this.input.gamepads.update(),this._postupdate(t)}},{key:"_preupdate",value:function(t){this.emit("preupdate",new Et(this,t,this)),this.onPreUpdate(this,t)}},{key:"onPreUpdate",value:function(t,e){}},{key:"_postupdate",value:function(t){this.emit("postupdate",new Pt(this,t,this)),this.onPostUpdate(this,t)}},{key:"onPostUpdate",value:function(t,e){}},{key:"_draw",value:function(t){var e=this.ctx;if(this._predraw(e,t),this._isLoading)return this._loader.canvas.draw(this.graphicsContext,0,0),void this.graphicsContext.flush();this.graphicsContext.backgroundColor=this.backgroundColor,this.currentScene.draw(this.ctx,t);for(var n=0,i=this._animations.length;n<i;n++)this._animations[n].animation.draw(e,this._animations[n].x,this._animations[n].y);if(this.isDebug){this.ctx.font="Consolas",this.ctx.fillStyle=this.debugColor.toString();for(var r=this.input.keyboard.getKeys(),o=0;o<r.length;o++)this.ctx.fillText(r[o].toString()+" : "+(ur[r[o]]?ur[r[o]]:"Not Mapped"),100,10*o+10);this.ctx.fillText("FPS:"+this.stats.currFrame.fps.toFixed(2).toString(),10,10)}for(var a=0;a<this.postProcessors.length;a++)this.postProcessors[a].process(this.ctx.getImageData(0,0,this.canvasWidth,this.canvasHeight),this.ctx);this._postdraw(e,t)}},{key:"_predraw",value:function(t,e){this.emit("predraw",new kt(t,e,this)),this.onPreDraw(t,e)}},{key:"onPreDraw",value:function(t,e){}},{key:"_postdraw",value:function(t,e){this.emit("postdraw",new xt(t,e,this)),this.onPostDraw(t,e)}},{key:"onPostDraw",value:function(t,e){}},{key:"showDebug",value:function(t){this._isDebug=t}},{key:"toggleDebug",value:function(){return this._isDebug=!this._isDebug,this._isDebug}},{key:"start",value:function(t){var e,i=this;return this._compatible?(this.screen.pushResolutionAndViewport(),this.screen.resolution=this.screen.viewport,this.screen.applyResolutionAndViewport(),this.graphicsContext.updateViewport(),t?(this._loader=t,this._loader.suppressPlayButton=this._suppressPlayButton||this._loader.suppressPlayButton,this._loader.wireEngine(this),e=this.load(this._loader)):e=Promise.resolve(),e.then((function(){i.screen.popResolutionAndViewport(),i.screen.applyResolutionAndViewport(),i.graphicsContext.updateViewport(),i.emit("start",new wt(i))})),this._hasStarted||(this._hasStarted=!0,this._logger.debug("Starting game..."),this.browser.resume(),n.createMainLoop(this,window.requestAnimationFrame,Date.now)(),this._logger.debug("Game started")),e):Promise.reject("Excalibur is incompatible with your browser")}},{key:"stop",value:function(){this._hasStarted&&(this.emit("stop",new bt(this)),this.browser.pause(),this._hasStarted=!1,this._logger.debug("Game stopped"))}},{key:"isPaused",value:function(){return!this._hasStarted}},{key:"screenshot",value:function(){var t=new Image,e=this.canvas.toDataURL("image/png");return t.src=e,t}},{key:"load",value:function(t){var e=this;return new Promise((function(n){e._isLoading=!0,t.load().then((function(){e._suppressPlayButton?setTimeout((function(){e._isLoading=!1,n()}),500):(e._isLoading=!1,n())}))}))}}],[{key:"createMainLoop",value:function(t,e,n){var i=n();return function r(){if(t._hasStarted)try{t._requestId=e(r),t.emit("preframe",new At(t,t.stats.prevFrame));var o=n(),a=Math.floor(o-i)||1;a>200&&(a=1);var s=a*t.timescale,l=t.stats.prevFrame.id+1;t.stats.currFrame.reset(),t.stats.currFrame.id=l,t.stats.currFrame.delta=s,t.stats.currFrame.fps=1/(s/1e3);var u=n();t._update(s);var c=n();t._draw(s);var h=n();t.stats.currFrame.duration.update=c-u,t.stats.currFrame.duration.draw=h-c,i=o,t.emit("postframe",new Tt(t,t.stats.currFrame)),t.stats.prevFrame.reset(t.stats.currFrame)}catch(e){window.cancelAnimationFrame(t._requestId),t.stop(),t.onFatalException(e)}}}}]),n}(te);mo._DEFAULT_ENGINE_OPTIONS={width:0,height:0,enableCanvasTransparency:!0,canvasElementId:"",canvasElement:void 0,snapToPixel:!1,pointerScope:hr.Canvas,suppressConsoleBootMessage:null,suppressMinimumBrowserFeatureDetection:null,suppressHiDPIScaling:null,suppressPlayButton:null,scrollPreventionMode:lo.Canvas,backgroundColor:ut.fromHex("#2185d0")},yo([nt({message:"Will be removed in excalibur v0.26.0",alternateMethod:"Use Actor.graphics"})],mo.prototype,"playAnimation",null);var _o=function t(e,n,i){f(this,t),this.animation=e,this.x=n,this.y=i};_o=yo([nt({message:"Will be removed in excalibur v0.26.0"})],_o);var wo=function(t){h(n,t);var e=d(n);function n(t){var i,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"MediaEvent";return f(this,n),(i=e.call(this)).target=t,i._name=r,i}return p(n,[{key:"bubbles",get:function(){return!1},set:function(t){}},{key:"_path",get:function(){return null},set:function(t){}},{key:"stopPropagation",value:function(){}},{key:"action",value:function(){}},{key:"propagate",value:function(){}},{key:"layPath",value:function(t){}}]),n}(gt),bo=function(t){h(n,t);var e=d(n);function n(t,i){var r;return f(this,n),(r=e.call(this,t,"NativeSoundEvent")).track=i,r}return n}(wo),ko=function(t){h(n,t);var e=d(n);function n(t,i){var r;return f(this,n),(r=e.call(this,t,"NativeSoundProcessedEvent"))._processedData=i,r.data=r._processedData,r}return n}(wo),xo=function(t){h(n,t);var e=d(n);function n(){var t,i,r,o,a,s,l,u,c,h,d,p,v,g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return f(this,n),(t=e.call(this,g)).quality=2,t.family="sans-serif",t.style=fi.Normal,t.bold=!1,t.unit=ci.Px,t.textAlign=hi.Left,t.baseAlign=di.Alphabetic,t.direction=pi.LeftToRight,t.size=10,t.shadow=null,t._textBounds=new ht,t._textWidth=0,t._textHeight=0,t.family=null!==(i=null==g?void 0:g.family)&&void 0!==i?i:t.family,t.style=null!==(r=null==g?void 0:g.style)&&void 0!==r?r:t.style,t.bold=null!==(o=null==g?void 0:g.bold)&&void 0!==o?o:t.bold,t.size=null!==(a=null==g?void 0:g.size)&&void 0!==a?a:t.size,t.unit=null!==(s=null==g?void 0:g.unit)&&void 0!==s?s:t.unit,t.textAlign=null!==(l=null==g?void 0:g.textAlign)&&void 0!==l?l:t.textAlign,t.baseAlign=null!==(u=null==g?void 0:g.baseAlign)&&void 0!==u?u:t.baseAlign,t.direction=null!==(c=null==g?void 0:g.direction)&&void 0!==c?c:t.direction,t.quality=null!==(h=null==g?void 0:g.quality)&&void 0!==h?h:t.quality,(null==g?void 0:g.shadow)&&(t.shadow={},t.shadow.blur=null!==(d=g.shadow.blur)&&void 0!==d?d:t.shadow.blur,t.shadow.offset=null!==(p=g.shadow.offset)&&void 0!==p?p:t.shadow.offset,t.shadow.color=null!==(v=g.shadow.color)&&void 0!==v?v:t.shadow.color),t.flagDirty(),t}return p(n,[{key:"clone",value:function(){return new n(Object.assign(Object.assign(Object.assign({},this.cloneGraphicOptions()),this.cloneRasterOptions()),{size:this.size,unit:this.unit,family:this.family,style:this.style,bold:this.bold,textAlign:this.textAlign,baseAlign:this.baseAlign,direction:this.direction,shadow:this.shadow?{blur:this.shadow.blur,offset:this.shadow.offset,color:this.shadow.color}:null}))}},{key:"fontString",get:function(){return"".concat(this.style," ").concat(this.bold?"bold":""," ").concat(this.size).concat(this.unit," ").concat(this.family)}},{key:"width",get:function(){return this._textWidth},set:function(t){this._textWidth=t}},{key:"height",get:function(){var t,e,n=null!==(e=null===(t=this._lines)||void 0===t?void 0:t.length)&&void 0!==e?e:1;return this._textHeight*n},set:function(t){var e,n,i=null!==(n=null===(e=this._lines)||void 0===e?void 0:e.length)&&void 0!==n?n:1;this._textHeight=t/i}},{key:"_rasterWidth",get:function(){return this._bitmap.width}},{key:"_rasterHeight",get:function(){return this._bitmap.height}},{key:"_halfRasterWidth",get:function(){return Math.floor(this._bitmap.width/2)}},{key:"_halfRasterHeight",get:function(){return Math.floor(this._bitmap.height/2)}},{key:"localBounds",get:function(){return this._textBounds}},{key:"_drawImage",value:function(t,e,n){this.dirty&&this.rasterize(),t.drawImage(this._bitmap,0,0,this._rasterWidth,this._rasterHeight,e-this._rasterWidth/this.quality/2,n-this._rasterHeight/this.quality/2,this._rasterWidth/this.quality,this._rasterHeight/this.quality)}},{key:"_rotate",value:function(t){var e,n=null!==(e=this.origin)&&void 0!==e?e:this._textBounds.center;t.translate(n.x,n.y),t.rotate(this.rotation),t.translate(-n.x,-n.y)}},{key:"_flip",value:function(t){this.flipHorizontal&&(t.translate(this._textBounds.width/this.scale.x,0),t.scale(-1,1)),this.flipVertical&&(t.translate(0,-this._textBounds.height/2/this.scale.y),t.scale(1,-1))}},{key:"updateText",value:function(t){this._text!==t&&(this._text=t,this._lines=this._text.split("\n"),this._updateDimensions(),this.flagDirty())}},{key:"_updateDimensions",value:function(){if(this._text){this._applyFont(this._ctx);var t=this._lines.reduce((function(t,e){return t.length>e.length?t:e})),e=this._ctx.measureText(t);this._textWidth=Math.abs(e.actualBoundingBoxLeft)+Math.abs(e.actualBoundingBoxRight),this._textHeight=Math.abs(e.actualBoundingBoxAscent)+Math.abs(e.actualBoundingBoxDescent);var n=this._textHeight*this._lines.length;this._bitmap.width=2*(this._textWidth+2*this.padding)*this.quality,this._bitmap.height=2*(n+2*this.padding)*this.quality;var i=0,r=0,o=n-Math.abs(e.actualBoundingBoxAscent);this._textBounds=new ht({left:i-Math.abs(e.actualBoundingBoxLeft)-this.padding,top:r-Math.abs(e.actualBoundingBoxAscent)-this.padding,bottom:r+o+this.padding,right:i+Math.abs(e.actualBoundingBoxRight)+this.padding})}}},{key:"_preDraw",value:function(t,e,i){this.dirty&&this._updateDimensions(),r(o(n.prototype),"_preDraw",this).call(this,t,e,i)}},{key:"_postDraw",value:function(t){this.showDebug&&t.debug.drawRect(-this._halfRasterWidth,-this._halfRasterHeight,this._rasterWidth,this._rasterHeight),t.restore()}},{key:"_applyFont",value:function(t){t.translate(this.padding+this._halfRasterWidth,this.padding+this._halfRasterHeight),t.scale(this.quality,this.quality),t.textAlign=this.textAlign,t.textBaseline=this.baseAlign,t.font=this.fontString,t.direction=this.direction,this.shadow&&(t.shadowColor=this.shadow.color.toString(),t.shadowBlur=this.shadow.blur,t.shadowOffsetX=this.shadow.offset.x,t.shadowOffsetY=this.shadow.offset.y)}},{key:"execute",value:function(t){if(this._text){this._applyRasterProperites(t),this._applyFont(t);for(var e=this._textHeight,n=0;n<this._lines.length;n++){var i=this._lines[n];this.color&&t.fillText(i,0,n*e),this.strokeColor&&t.strokeText(i,0,n*e)}this.showDebug&&(ee(t,ut.Red,-this._halfRasterWidth,0,this._halfRasterWidth,0,2),ee(t,ut.Red,0,-this._halfRasterHeight,0,this._halfRasterHeight,2))}}},{key:"render",value:function(t,e,n,i){this.updateText(e),this.draw(t,n,i)}}]),n}(fe),Co=function(t){h(n,t);var e=d(n);function n(t){var i,r,o;return f(this,n),(i=e.call(this,t))._text="",i.font=null!==(r=t.font)&&void 0!==r?r:new xo,i.color=null!==(o=t.color)&&void 0!==o?o:i.color,i.text=t.text,i}return p(n,[{key:"clone",value:function(){return new n({text:this.text.slice(),color:this.color.clone(),font:this.font.clone()})}},{key:"text",get:function(){return this._text},set:function(t){this._text=t,this.font.updateText(t)}},{key:"color",get:function(){return this.font instanceof xo?this.font.color:ut.Black},set:function(t){this.font instanceof xo&&(this.font.color=t)}},{key:"font",get:function(){return this._font},set:function(t){this._font=t instanceof xo?ce(t,(function(t){return t.flagDirty()})):t}},{key:"width",get:function(){return this.font.width}},{key:"height",get:function(){return this.font.height}},{key:"localBounds",get:function(){return this.font.localBounds}},{key:"_rotate",value:function(t){}},{key:"_flip",value:function(t){}},{key:"_drawImage",value:function(t,e,n){this.font instanceof xo&&(this.font.color=this.color),this.font.flipHorizontal=this.flipHorizontal,this.font.flipVertical=this.flipVertical,this.font.scale=this.scale,this.font.rotation=this.rotation,this.font.origin=this.origin,this.font.opacity=this.opacity,this.font.render(t,this._text,e,n)}}]),n}(se),So=function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},Eo=function(t){h(n,t);var e=d(n);function n(t){var i;f(this,n),(i=e.call(this,t)).font=new xo,i._text=new Co({text:"",font:i.font}),i.letterSpacing=0,i.caseInsensitive=!0;var r=t.text,o=t.pos,a=t.x,s=t.y,l=t.spriteFont,u=t.font,c=t.color;i.pos=null!=o?o:a&&s?ot(a,s):i.pos,i.text=null!=r?r:i.text,i.spriteFont=null!=l?l:i.spriteFont,i.font=null!=u?u:i.font,i.color=null!=c?c:i.color;var h=i.get(ni);return h.anchor=rt.Zero,h.use(i._text),i}return p(n,[{key:"text",get:function(){return this._text.text},set:function(t){this._text.text=t}},{key:"color",get:function(){return this._text.color},set:function(t){this._text.color=t}},{key:"opacity",get:function(){return this._text.opacity},set:function(t){this._text.opacity=t}},{key:"bold",get:function(){return this.font.bold},set:function(t){this.font.bold=t}},{key:"fontFamily",get:function(){return this.font.family},set:function(t){this.font.family=t}},{key:"fontSize",get:function(){return this.font.size},set:function(t){this.font.size=t}},{key:"fontStyle",get:function(){return this.font.style},set:function(t){this.font.style=t}},{key:"fontUnit",get:function(){return this.font.unit},set:function(t){this.font.unit=t}},{key:"textAlign",get:function(){return this.font.textAlign},set:function(t){this.font.textAlign=t}},{key:"baseAlign",get:function(){return this.font.baseAlign},set:function(t){this.font.baseAlign=t}},{key:"spriteFont",get:function(){return this._legacySpriteFont},set:function(t){if(t){if(t instanceof wi)return this._legacySpriteFont=t,this._spriteFont=Zr.fromLegacySpriteFont(t),void(this._text.font=this._spriteFont);this._spriteFont=t,this._text.font=this._spriteFont}}},{key:"_initialize",value:function(t){r(o(n.prototype),"_initialize",this).call(this,t),this._graphicsContext=t.graphicsContext}},{key:"getTextWidth",value:function(){return this._text.width}},{key:"setTextShadow",value:function(t,e,n){this.font.shadow={offset:ot(t,e),blur:2,color:n}}},{key:"useTextShadow",value:function(t){this.spriteFont&&this.spriteFont.useTextShadow(t)}},{key:"clearTextShadow",value:function(){this.font.shadow=null}},{key:"draw",value:function(t,e){var n=this._graphicsContext;this._text.draw(n,0,0)}}]),n}(ai);So([nt({message:"Label.bold will be removed in v0.26.0",alternateMethod:"Use Label.font.bold"})],Eo.prototype,"bold",null),So([nt({message:"Label.fontFamily will be removed in v0.26.0",alternateMethod:"Use Label.font.family"})],Eo.prototype,"fontFamily",null),So([nt({message:"Label.fontSize will be removed in v0.26.0",alternateMethod:"Use Label.font.size"})],Eo.prototype,"fontSize",null),So([nt({message:"Label.fontStyle will be removed in v0.26.0",alternateMethod:"Use Lable.font.style"})],Eo.prototype,"fontStyle",null),So([nt({message:"Label.fontUnit will be removed in v0.26.0",alternateMethod:"Use Label.font.unit"})],Eo.prototype,"fontUnit",null),So([nt({message:"Label.textAlign will be removed in v0.26.0",alternateMethod:"Use Label.font.textAlign"})],Eo.prototype,"textAlign",null),So([nt({message:"Label.baseAlign will be removed in v0.26.0",alternateMethod:"Use Label.font.baseAlign"})],Eo.prototype,"baseAlign",null),So([nt()],Eo.prototype,"spriteFont",null),So([nt({message:"Label.setTextShadow will be removed in v0.26.0",alternateMethod:"Use Label.font.shadow"})],Eo.prototype,"setTextShadow",null),So([nt({message:"Label.useTextShadow will be removed in v0.26.0",alternateMethod:"Use Label.font.shadow"})],Eo.prototype,"useTextShadow",null),So([nt({message:"Label.clearTextShadow will be removed in v0.26.0",alternateMethod:"Use Label.font.shadow"})],Eo.prototype,"clearTextShadow",null);var Po=function(){function t(){f(this,t)}return p(t,null,[{key:"create",value:function(t,e){if(this._CURRENT_GROUP>this._MAX_GROUPS)throw new Error("Cannot have more than ".concat(this._MAX_GROUPS," collision groups"));if(this._GROUPS.get(t))throw new Error("Collision group ".concat(t," already exists"));var n=new bn(t,this._CURRENT_BIT,void 0!==e?e:~this._CURRENT_BIT);return this._CURRENT_BIT=this._CURRENT_BIT<<1|0,this._CURRENT_GROUP++,this._GROUPS.set(t,n),n}},{key:"groups",get:function(){return Array.from(this._GROUPS.values())}},{key:"groupByName",value:function(t){return this._GROUPS.get(t)}},{key:"reset",value:function(){this._GROUPS=new Map,this._CURRENT_BIT=this._STARTING_BIT,this._CURRENT_GROUP=1}}]),t}();Po._STARTING_BIT=1,Po._MAX_GROUPS=32,Po._CURRENT_GROUP=1,Po._CURRENT_BIT=Po._STARTING_BIT,Po._GROUPS=new Map;var Ao=function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},To=function(){function t(e){f(this,t),this.lineWidth=5,this.filled=!1,this._points=[],this.anchor=rt.Zero,this.offset=rt.Zero,this.rotation=0,this.scale=rt.One,this.opacity=1,this._points=e;var n=this._points.reduce((function(t,e){return Math.min(t,e.x)}),0),i=this._points.reduce((function(t,e){return Math.max(t,e.x)}),0);this.drawWidth=i-n;var r=this._points.reduce((function(t,e){return Math.min(t,e.y)}),0),o=this._points.reduce((function(t,e){return Math.max(t,e.y)}),0);this.drawHeight=o-r,this.height=this.drawHeight,this.width=this.drawWidth}return p(t,[{key:"addEffect",value:function(){}},{key:"removeEffect",value:function(){}},{key:"clearEffects",value:function(){}},{key:"reset",value:function(){}},{key:"draw",value:function(t,e,n){t instanceof CanvasRenderingContext2D?this._drawWithOptions({ctx:t,x:e,y:n}):this._drawWithOptions(t)}},{key:"_drawWithOptions",value:function(t){var e,n,i,r,o,a,s,l,u,c=Object.assign(Object.assign({},t),{rotation:null!==(e=t.rotation)&&void 0!==e?e:this.rotation,drawWidth:null!==(n=t.drawWidth)&&void 0!==n?n:this.drawWidth,drawHeight:null!==(i=t.drawHeight)&&void 0!==i?i:this.drawHeight,flipHorizontal:null!==(r=t.flipHorizontal)&&void 0!==r?r:this.flipHorizontal,flipVertical:null!==(o=t.flipVertical)&&void 0!==o?o:this.flipVertical,anchor:null!==(a=t.anchor)&&void 0!==a?a:this.anchor,offset:null!==(s=t.offset)&&void 0!==s?s:this.offset,opacity:(null!==(l=t.opacity)&&void 0!==l?l:1)*(null!==(u=this.opacity)&&void 0!==u?u:1)}),h=c.ctx,d=c.x,f=c.y,p=c.rotation,v=c.drawWidth,g=c.drawHeight,y=c.anchor,m=c.offset,_=c.opacity,w=c.flipHorizontal,b=c.flipVertical,k=v*y.x+m.x+d,x=g*y.y+m.y+f;h.save(),h.translate(k,x),h.scale(this.scale.x,this.scale.y),h.rotate(p),h.beginPath(),h.lineWidth=this.lineWidth;var C=this._points[0];h.moveTo(C.x,C.y);for(var S=0,E=this._points.length;S<E;S++)h.lineTo(this._points[S].x,this._points[S].y);h.lineTo(C.x,C.y),h.closePath(),this.filled&&(h.fillStyle=this.fillColor.toString(),h.fill()),h.strokeStyle=this.lineColor.toString(),w&&(h.translate(v,0),h.scale(-1,1)),b&&(h.translate(0,g),h.scale(1,-1));var P=h.globalAlpha;h.globalAlpha=_,h.stroke(),h.globalAlpha=P,h.restore()}}]),t}();To=Ao([nt({message:"Polygon will be removed in v0.26.0",alternateMethod:"Use Graphics.Polygon"})],To);var Ro=function t(){f(this,t)};function Do(t){return!!t._initialize}function Mo(t){return!!t.onInitialize}function Lo(t){return!!t._preupdate}function Bo(t){return!!t.onPreUpdate}function Oo(t){return!!t.onPostUpdate}function Fo(t){return!!t.onPostUpdate}function Io(t){return!!t.onPreDraw}function zo(t){return!!t.onPostDraw}Ro.type={any:"",blob:"blob",json:"json",text:"text",document:"document",arraybuffer:"arraybuffer"};var No=function(){function t(e){f(this,t),this._src=e,this._volume=1,this._duration=void 0,this._loop=!1,this._isPlaying=!1,this._isPaused=!1,this._audioContext=pt.create(),this._volumeNode=this._audioContext.createGain(),this._currentOffset=0,this._createNewBufferSource()}return p(t,[{key:"loop",get:function(){return this._loop},set:function(t){this._loop=t,this._instance&&(this._instance.loop=t,this._wireUpOnEnded())}},{key:"volume",get:function(){return this._volume},set:function(t){t=F(t,0,1),this._volume=t,this._isPlaying&&this._volumeNode.gain.setTargetAtTime?this._volumeNode.gain.setTargetAtTime(t,this._audioContext.currentTime,.1):this._volumeNode.gain.value=t}},{key:"duration",get:function(){return this._duration},set:function(t){this._duration=t}},{key:"_playbackRate",get:function(){return this._instance?1/(this._instance.playbackRate.value||1):null}},{key:"isPlaying",value:function(){return this._isPlaying}},{key:"play",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};return this._isPaused&&(this._resumePlayBack(),t()),this._isPlaying||(this._startPlayBack(),t()),this._playingPromise}},{key:"pause",value:function(){this._isPlaying&&(this._isPaused=!0,this._isPlaying=!1,this._instance.stop(0),this._setPauseOffset())}},{key:"stop",value:function(){this._isPlaying&&(this._isPlaying=!1,this._isPaused=!1,this._currentOffset=0,this._instance.stop(0),this._instance.onended||this._handleOnEnded())}},{key:"_startPlayBack",value:function(){var t=this;this._isPlaying=!0,this._isPaused=!1,this._playingPromise=new Promise((function(e){t._playingResolve=e})),this._instance||this._createNewBufferSource(),this._rememberStartTime(),this._volumeNode.connect(this._audioContext.destination),this._instance.start(0,0),this._currentOffset=0,this._wireUpOnEnded()}},{key:"_resumePlayBack",value:function(){if(this._isPaused){this._isPaused=!1,this._isPlaying=!0,this._instance.onended=null,this._createNewBufferSource();var t=this._playbackRate*this._src.duration,e=this._currentOffset%t;this._rememberStartTime(-1e3*e),this._instance.start(0,e),this._wireUpOnEnded()}}},{key:"_wireUpOnEnded",value:function(){var t=this;this.loop||(this._instance.onended=function(){return t._handleOnEnded()})}},{key:"_handleOnEnded",value:function(){this._isPaused||(this._isPlaying=!1,this._playingResolve(!0))}},{key:"_rememberStartTime",value:function(t){this._startTime=(new Date).getTime()+(0|t)}},{key:"_setPauseOffset",value:function(){this._currentOffset=((new Date).getTime()-this._startTime)*this._playbackRate/1e3}},{key:"_createNewBufferSource",value:function(){this._instance=this._audioContext.createBufferSource(),this._instance.buffer=this._src,this._instance.loop=this.loop,this._instance.playbackRate.setValueAtTime(1,0),this._instance.connect(this._volumeNode)}}]),t}();function Uo(t){try{var e=new Audio,n=/.*\.([A-Za-z0-9]+)$/,i=t.match(n)[1];return!!e.canPlayType("audio/"+i)}catch(t){return P.getInstance().warn("Cannot determine audio support, assuming no support for the Audio Tag",t),!1}}var Ho=function(t,e,n,i){return new(n||(n=Promise))((function(r,o){function a(t){try{l(i.next(t))}catch(t){o(t)}}function s(t){try{l(i.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}l((i=i.apply(t,e||[])).next())}))},Wo=function(t){h(n,t);var e=d(n);function n(){var t;f(this,n),(t=e.call(this)).logger=P.getInstance(),t._loop=!1,t._volume=1,t._duration=void 0,t._isStopped=!1,t._isPaused=!1,t._tracks=[],t._wasPlayingOnHidden=!1,t._audioContext=pt.create(),t._resource=new _e("",Ro.type.arraybuffer);for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];for(var a=0,s=r;a<s.length;a++){var l=s[a];if(Uo(l)){t.path=l;break}}return t.path||(t.logger.warn("This browser does not support any of the audio files specified:",r.join(", ")),t.logger.warn("Attempting to use",r[0]),t.path=r[0]),t}return p(n,[{key:"loop",get:function(){return this._loop},set:function(t){this._loop=t;var e,n=s(this._tracks);try{for(n.s();!(e=n.n()).done;)e.value.loop=this._loop}catch(i){n.e(i)}finally{n.f()}this.logger.debug("Set loop for all instances of sound",this.path,"to",this._loop)}},{key:"volume",get:function(){return this._volume},set:function(t){this._volume=t;var e,n=s(this._tracks);try{for(n.s();!(e=n.n()).done;)e.value.volume=this._volume}catch(i){n.e(i)}finally{n.f()}this.emit("volumechange",new bo(this)),this.logger.debug("Set loop for all instances of sound",this.path,"to",this._volume)}},{key:"duration",get:function(){return this._duration}},{key:"instances",get:function(){return this._tracks}},{key:"path",get:function(){return this._resource.path},set:function(t){this._resource.path=t}},{key:"isLoaded",value:function(){return!!this.data}},{key:"load",value:function(){return Ho(this,void 0,void 0,u.mark((function t(){var e,n;return u.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.data){t.next=2;break}return t.abrupt("return",this.data);case 2:return t.next=4,this._resource.load();case 4:return e=t.sent,t.next=7,this.decodeAudio(e.slice(0));case 7:return n=t.sent,t.abrupt("return",(this._duration="object"==typeof n?n.duration:void 0,this.emit("processed",new ko(this,n)),this.data=n));case 9:case"end":return t.stop()}}),t,this)})))}},{key:"decodeAudio",value:function(t){return Ho(this,void 0,void 0,u.mark((function e(){return u.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this._audioContext.decodeAudioData(t.slice(0));case 3:return e.abrupt("return",e.sent);case 6:return e.prev=6,e.t0=e.catch(0),this.logger.error("Unable to decode  this browser may not fully support this format, or the file may be corrupt, if this is an mp3 try removing id3 tags and album art from the file."),e.next=11,Promise.reject();case 11:return e.abrupt("return",e.sent);case 12:case"end":return e.stop()}}),e,this,[[0,6]])})))}},{key:"wireEngine",value:function(t){var e=this;t&&(this._engine=t,this._engine.on("hidden",(function(){t.pauseAudioWhenHidden&&e.isPlaying()&&(e._wasPlayingOnHidden=!0,e.pause())})),this._engine.on("visible",(function(){t.pauseAudioWhenHidden&&e._wasPlayingOnHidden&&(e.play(),e._wasPlayingOnHidden=!1)})),this._engine.on("start",(function(){e._isStopped=!1})),this._engine.on("stop",(function(){e.stop(),e._isStopped=!0})))}},{key:"instanceCount",value:function(){return this._tracks.length}},{key:"isPlaying",value:function(){return this._tracks.some((function(t){return t.isPlaying()}))}},{key:"play",value:function(t){return this.isLoaded()?this._isStopped?(this.logger.warn("Cannot start playing. Engine is in a stopped state."),Promise.resolve(!1)):(this.volume=t||this.volume,this._isPaused?this._resumePlayback():this._startPlayback()):(this.logger.warn("Cannot start playing. Resource",this.path,"is not loaded yet"),Promise.resolve(!0))}},{key:"pause",value:function(){if(this.isPlaying()){var t,e=s(this._tracks);try{for(e.s();!(t=e.n()).done;)t.value.pause()}catch(n){e.e(n)}finally{e.f()}this._isPaused=!0,this.emit("pause",new bo(this)),this.logger.debug("Paused all instances of sound",this.path)}}},{key:"stop",value:function(){var t,e=s(this._tracks);try{for(e.s();!(t=e.n()).done;)t.value.stop()}catch(n){e.e(n)}finally{e.f()}this.emit("stop",new bo(this)),this._isPaused=!1,this._tracks.length=0,this.logger.debug("Stopped all instances of sound",this.path)}},{key:"getTrackId",value:function(t){return this._tracks.indexOf(t)}},{key:"_resumePlayback",value:function(){return Ho(this,void 0,void 0,u.mark((function t(){var e,n,i,r;return u.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this._isPaused){t.next=9;break}e=[],n=s(this._tracks);try{for(n.s();!(i=n.n()).done;)r=i.value,e.push(r.play())}catch(o){n.e(o)}finally{n.f()}return this._isPaused=!1,this.emit("resume",new bo(this)),this.logger.debug("Resuming paused instances for sound",this.path,this._tracks),t.next=9,Promise.all(e);case 9:return t.abrupt("return",!0);case 10:case"end":return t.stop()}}),t,this)})))}},{key:"_startPlayback",value:function(){return Ho(this,void 0,void 0,u.mark((function t(){var e,n,i=this;return u.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._getTrackInstance(this.data);case 2:return e=t.sent,t.next=5,e.play((function(){i.emit("playbackstart",new bo(i,e)),i.logger.debug("Playing new instance for sound",i.path)}));case 5:return n=t.sent,t.abrupt("return",(this.emit("playbackend",new bo(this,e)),this._tracks.splice(this.getTrackId(e),1),n));case 7:case"end":return t.stop()}}),t,this)})))}},{key:"_getTrackInstance",value:function(t){var e=new No(t);return e.loop=this.loop,e.volume=this.volume,e.duration=this.duration,this._tracks.push(e),e}}]),n}(te),jo=function(t,e,n,i){return new(n||(n=Promise))((function(r,o){function a(t){try{l(i.next(t))}catch(t){o(t)}}function s(t){try{l(i.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}l((i=i.apply(t,e||[])).next())}))},Vo=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ut.Magenta,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];f(this,t),this.path=e,this.color=n,this.bustCache=i,this._stream=null,this._gif=null,this._textures=[],this._animation=null,this._transparentColor=null,this._resource=new _e(e,"arraybuffer",i),this._transparentColor=n}return p(t,[{key:"load",value:function(){return jo(this,void 0,void 0,u.mark((function t(){var e,n;return u.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._resource.load();case 2:return e=t.sent,this._stream=new qo(e),this._gif=new Ko(this._stream,this._transparentColor),n=this._gif.images.map((function(t){return new gi(t.src,!1)})),t.next=7,Promise.all(n.map((function(t){return t.load()})));case 7:return t.abrupt("return",this.data=this._textures=n);case 8:case"end":return t.stop()}}),t,this)})))}},{key:"isLoaded",value:function(){return!!this.data}},{key:"toLegacySprite",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return yi.toLegacySprite(this.toSprite(t))}},{key:"toLegacySpriteSheet",value:function(){return ki.toLegacySpriteSheet(this.toSpriteSheet())}},{key:"toLegacyAnimation",value:function(t,e){return ar.toLegacyAnimation(t,this.toAnimation(e))}},{key:"toSprite",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this._textures[t].toSprite()}},{key:"toSpriteSheet",value:function(){var t=this._textures.map((function(t){return t.toSprite()}));return new ki({sprites:t})}},{key:"toAnimation",value:function(t){var e=this.toSpriteSheet(),n=e.sprites.length;return this._animation=ar.fromSpriteSheet(e,Y(0,n),t),this._animation}},{key:"readCheckBytes",get:function(){return this._gif.checkBytes}}]),t}(),Go=function(t){return t.reduce((function(t,e){return 2*t+e}),0)},Xo=function(t){for(var e=[],n=7;n>=0;n--)e.push(!!(t&1<<n));return e},qo=function t(e){var n=this;if(f(this,t),this.data=null,this.len=0,this.position=0,this.readByte=function(){if(n.position>=n.data.byteLength)throw new Error("Attempted to read past end of stream.");return n.data[n.position++]},this.readBytes=function(t){for(var e=[],i=0;i<t;i++)e.push(n.readByte());return e},this.read=function(t){for(var e="",i=0;i<t;i++)e+=String.fromCharCode(n.readByte());return e},this.readUnsigned=function(){var t=n.readBytes(2);return(t[1]<<8)+t[0]},this.data=new Uint8Array(e),this.len=this.data.byteLength,0===this.len)throw new Error("No data loaded from file")},Ko=function t(e){var n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ut.Magenta;f(this,t),this._st=null,this._handler={},this._transparentColor=null,this.frames=[],this.images=[],this.globalColorTable=[],this.checkBytes=[],this.parseColorTable=function(t){for(var e=[],i=0;i<t;i++){var r="#"+n._st.readBytes(3).map((function(t){var e=t.toString(16);return 1===e.length?"0"+e:e})).join("");e.push(r)}return e},this.readSubBlocks=function(){var t,e;e="";do{t=n._st.readByte(),e+=n._st.read(t)}while(0!==t);return e},this.parseHeader=function(){var t={sig:null,ver:null,width:null,height:null,colorRes:null,globalColorTableSize:null,gctFlag:null,sorted:null,globalColorTable:[],bgColor:null,pixelAspectRatio:null};if(t.sig=n._st.read(3),t.ver=n._st.read(3),"GIF"!==t.sig)throw new Error("Not a GIF file.");t.width=n._st.readUnsigned(),t.height=n._st.readUnsigned();var e=Xo(n._st.readByte());t.gctFlag=e.shift(),t.colorRes=Go(e.splice(0,3)),t.sorted=e.shift(),t.globalColorTableSize=Go(e.splice(0,3)),t.bgColor=n._st.readByte(),t.pixelAspectRatio=n._st.readByte(),t.gctFlag&&(t.globalColorTable=n.parseColorTable(1<<t.globalColorTableSize+1),n.globalColorTable=t.globalColorTable),n._handler.hdr&&n._handler.hdr(t)&&n.checkBytes.push(n._handler.hdr)},this.parseExt=function(t){var e=function(t){n.checkBytes.push(n._st.readByte());var e=Xo(n._st.readByte());t.reserved=e.splice(0,3),t.disposalMethod=Go(e.splice(0,3)),t.userInput=e.shift(),t.transparencyGiven=e.shift(),t.delayTime=n._st.readUnsigned(),t.transparencyIndex=n._st.readByte(),t.terminator=n._st.readByte(),n._handler.gce&&n._handler.gce(t)&&n.checkBytes.push(n._handler.gce)},i=function(t){t.comment=n.readSubBlocks(),n._handler.com&&n._handler.com(t)&&n.checkBytes.push(n._handler.com)},r=function(t){n.checkBytes.push(n._st.readByte()),t.ptHeader=n._st.readBytes(12),t.ptData=n.readSubBlocks(),n._handler.pte&&n._handler.pte(t)&&n.checkBytes.push(n._handler.pte)},o=function(t){var e=function(t){n.checkBytes.push(n._st.readByte()),t.unknown=n._st.readByte(),t.iterations=n._st.readUnsigned(),t.terminator=n._st.readByte(),n._handler.app&&n._handler.app.NETSCAPE&&n._handler.app.NETSCAPE(t)&&n.checkBytes.push(n._handler.app)},i=function(t){t.appData=n.readSubBlocks(),n._handler.app&&n._handler.app[t.identifier]&&n._handler.app[t.identifier](t)&&n.checkBytes.push(n._handler.app[t.identifier])};switch(n.checkBytes.push(n._st.readByte()),t.identifier=n._st.read(8),t.authCode=n._st.read(3),t.identifier){case"NETSCAPE":e(t);break;default:i(t)}},a=function(t){t.data=n.readSubBlocks(),n._handler.unknown&&n._handler.unknown(t)&&n.checkBytes.push(n._handler.unknown)};switch(t.label=n._st.readByte(),t.label){case 249:t.extType="gce",e(t);break;case 254:t.extType="com",i(t);break;case 1:t.extType="pte",r(t);break;case 255:t.extType="app",o(t);break;default:t.extType="unknown",a(t)}},this.parseImg=function(t){t.leftPos=n._st.readUnsigned(),t.topPos=n._st.readUnsigned(),t.width=n._st.readUnsigned(),t.height=n._st.readUnsigned();var e=Xo(n._st.readByte());t.lctFlag=e.shift(),t.interlaced=e.shift(),t.sorted=e.shift(),t.reserved=e.splice(0,2),t.lctSize=Go(e.splice(0,3)),t.lctFlag&&(t.lct=n.parseColorTable(1<<t.lctSize+1)),t.lzwMinCodeSize=n._st.readByte();var i=n.readSubBlocks();t.pixels=function(t,e){for(var n,i,r=0,o=function(t){for(var n=0,i=0;i<t;i++)e.charCodeAt(r>>3)&1<<(7&r)&&(n|=1<<i),r++;return n},a=[],s=1<<t,l=s+1,u=t+1,c=[],h=function(){c=[],u=t+1;for(var e=0;e<s;e++)c[e]=[e];c[s]=[],c[l]=null};;)if(i=n,(n=o(u))!==s){if(n===l)break;if(n<c.length)i!==s&&c.push(c[i].concat(c[n][0]));else{if(n!==c.length)throw new Error("Invalid LZW code.");c.push(c[i].concat(c[i][0]))}a.push.apply(a,c[n]),c.length===1<<u&&u<12&&u++}else h();return a}(t.lzwMinCodeSize,i),t.interlaced&&(t.pixels=function(t,e){for(var n=new Array(t.length),i=t.length/e,r=function(i,r){var o=t.slice(r*e,(r+1)*e);n.splice.apply(n,[i*e,e].concat(o))},o=[0,4,2,1],a=[8,8,4,2],s=0,l=0;l<4;l++)for(var u=o[l];u<i;u+=a[l])r(u,s),s++;return n}(t.pixels,t.width)),n.frames.push(t),n.arrayToImage(t),n._handler.img&&n._handler.img(t)&&n.checkBytes.push(n._handler)},this.parseBlock=function(){var t={sentinel:n._st.readByte(),type:""};switch(String.fromCharCode(t.sentinel)){case"!":t.type="ext",n.parseExt(t);break;case",":t.type="img",n.parseImg(t);break;case";":t.type="eof",n._handler.eof&&n._handler.eof(t)&&n.checkBytes.push(n._handler.eof);break;default:throw new Error("Unknown block: 0x"+t.sentinel.toString(16))}"eof"!==t.type&&n.parseBlock()},this.arrayToImage=function(t){var e=0,i=document.createElement("canvas");i.id=e.toString(),i.width=t.width,i.height=t.height,e++;for(var r=i.getContext("2d"),o=0,a=0,s=0;s<t.pixels.length;s++)a%t.width==0&&(o++,a=0),n.globalColorTable[t.pixels[s]]===n._transparentColor.toHex()?r.fillStyle="rgba(0, 0, 0, 0)":r.fillStyle=n.globalColorTable[t.pixels[s]],r.fillRect(a,o,1,1),a++;var l=new Image;l.src=i.toDataURL(),n.images.push(l)},this._st=e,this._handler={},this._transparentColor=i,this.parseHeader(),this.parseBlock()},Qo=function(t){h(n,t);var e=d(n);function n(t){var i;return f(this,n),(i=e.call(this,t)).points=t.points,i.rasterize(),i}return p(n,[{key:"points",get:function(){return this._points},set:function(t){this._points=t;var e=this.minPoint;this.width=this._points.reduce((function(t,e){return Math.max(e.x,t)}),0)-e.x,this.height=this._points.reduce((function(t,e){return Math.max(e.y,t)}),0)-e.y,this.flagDirty()}},{key:"minPoint",get:function(){return ot(this._points.reduce((function(t,e){return Math.min(e.x,t)}),1/0),this._points.reduce((function(t,e){return Math.min(e.y,t)}),1/0))}},{key:"clone",value:function(){return new n(Object.assign(Object.assign({points:this.points.map((function(t){return t.clone()}))},this.cloneGraphicOptions()),this.cloneRasterOptions()))}},{key:"execute",value:function(t){if(this.points&&this.points.length){t.beginPath();var e=this.minPoint.negate(),n=this.points[0].add(e);t.moveTo(n.x,n.y),this.points.forEach((function(n){t.lineTo(n.x+e.x,n.y+e.y)})),t.lineTo(n.x,n.y),t.closePath(),this.color&&t.fill(),this.strokeColor&&t.stroke()}}}]),n}(fe),Yo=function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},Zo=function(){function t(e){f(this,t),this._getComparable=e}return p(t,[{key:"find",value:function(t){return this._find(this._root,t)}},{key:"_find",value:function(t,e){return null!=t&&(this._getComparable(e)===t.getKey()?t.getData().indexOf(e)>-1:this._getComparable(e)<t.getKey()?this._find(t.getLeft(),e):this._find(t.getRight(),e))}},{key:"get",value:function(t){return this._get(this._root,t)}},{key:"_get",value:function(t,e){return null==t?[]:e===t.getKey()?t.getData():e<t.getKey()?this._get(t.getLeft(),e):this._get(t.getRight(),e)}},{key:"add",value:function(t){return null==this._root?(this._root=new $o(this._getComparable(t),[t],null,null),!0):this._insert(this._root,t)}},{key:"_insert",value:function(t,e){return null!=t&&(this._getComparable(e)===t.getKey()?!(t.getData().indexOf(e)>-1)&&(t.getData().push(e),!0):this._getComparable(e)<t.getKey()?null==t.getLeft()?(t.setLeft(new $o(this._getComparable(e),[e],null,null)),!0):this._insert(t.getLeft(),e):null==t.getRight()?(t.setRight(new $o(this._getComparable(e),[e],null,null)),!0):this._insert(t.getRight(),e))}},{key:"removeByComparable",value:function(t){this._root=this._remove(this._root,t)}},{key:"_remove",value:function(t,e){if(null==t)return null;if(this._getComparable(e)!==t.getKey())return this._getComparable(e)<t.getKey()?(t.setLeft(this._remove(t.getLeft(),e)),t):(t.setRight(this._remove(t.getRight(),e)),t);var n=t.getData().indexOf(e);if(n>-1){if(t.getData().splice(n,1),0===t.getData().length){if(null==t.getLeft()&&null==t.getRight())return null;if(null==t.getLeft())return t.getRight();if(null==t.getRight())return t.getLeft();var i=this._findMinNode(t.getRight());return t.setKey(i.getKey()),t.setData(i.getData()),t.setRight(this._cleanup(t.getRight(),i)),t}return t}return null}},{key:"_cleanup",value:function(t,e){var n=e.getKey();if(null==t)return null;if(n===t.getKey()){if(null==t.getLeft()&&null==t.getRight())return null;if(null==t.getLeft())return t.getRight();if(null==t.getRight())return t.getLeft();var i=this._findMinNode(t.getRight());return t.setKey(i.getKey()),t.setData(i.getData()),t.setRight(this._cleanup(t.getRight(),i)),t}return e.getKey()<t.getKey()?(t.setLeft(this._cleanup(t.getLeft(),e)),t):(t.setRight(this._cleanup(t.getRight(),e)),t)}},{key:"_findMinNode",value:function(t){for(var e=t;null!=e.getLeft();)e=e.getLeft();return e}},{key:"list",value:function(){var t=new Array;return this._list(this._root,t),t}},{key:"_list",value:function(t,e){null!=t&&(this._list(t.getLeft(),e),t.getData().forEach((function(t){e.push(t)})),this._list(t.getRight(),e))}}]),t}();Zo=Yo([nt({message:"Will be removed in excalibur v0.26.0",alternateMethod:"Use built in JS array.sort"})],Zo);var $o=function(){function t(e,n,i,r){f(this,t),this._key=e,this._data=n,this._left=i,this._right=r}return p(t,[{key:"getKey",value:function(){return this._key}},{key:"setKey",value:function(t){this._key=t}},{key:"getData",value:function(){return this._data}},{key:"setData",value:function(t){this._data=t}},{key:"getLeft",value:function(){return this._left}},{key:"setLeft",value:function(t){this._left=t}},{key:"getRight",value:function(){return this._right}},{key:"setRight",value:function(t){this._right=t}}]),t}();$o=Yo([nt({message:"Will be removed in excalibur v0.26.0"})],$o);var Jo,ta,ea=function(){function t(e){f(this,t),this._key=0,this._key=e}return p(t,[{key:"getTheKey",value:function(){return this._key}},{key:"setKey",value:function(t){this._key=t}}]),t}(),na=function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a};!function(t){t[t.Resolved=0]="Resolved",t[t.Rejected=1]="Rejected",t[t.Pending=2]="Pending"}(ta||(ta={}));var ia=Jo=function(){function t(){f(this,t),this._state=ta.Pending,this._successCallbacks=[],this._rejectCallback=function(){}}return p(t,[{key:"then",value:function(t,e){if(t&&(this._successCallbacks.push(t),this.state()===ta.Resolved))try{t.call(this,this._value)}catch(t){this._handleError(t)}if(e&&(this._rejectCallback=e,this.state()===ta.Rejected))try{e.call(this,this._value)}catch(t){this._handleError(t)}return this}},{key:"error",value:function(t){return t&&(this._errorCallback=t),this}},{key:"resolve",value:function(t){var e=this;if(this._state!==ta.Pending)throw new Error("Cannot resolve a promise that is not in a pending state!");this._value=t;try{this._state=ta.Resolved,this._successCallbacks.forEach((function(t){t.call(e,e._value)}))}catch(t){this._handleError(t)}return this}},{key:"reject",value:function(t){if(this._state!==ta.Pending)throw new Error("Cannot reject a promise that is not in a pending state!");this._value=t;try{this._state=ta.Rejected,this._rejectCallback.call(this,this._value)}catch(t){this._handleError(t)}return this}},{key:"state",value:function(){return this._state}},{key:"_handleError",value:function(t){if(!this._errorCallback)throw t;this._errorCallback.call(this,t)}}],[{key:"resolve",value:function(t){return(new Jo).resolve(t)}},{key:"reject",value:function(t){return(new Jo).reject(t)}},{key:"join",value:function(){var t=[];if(arguments.length>0&&!Array.isArray(arguments[0]))for(var e=0;e<arguments.length;e++)t[e-0]=arguments[e];else 1===arguments.length&&Array.isArray(arguments[0])&&(t=arguments[0]);var n=new Jo;if(!t||!t.length)return n.resolve();var i=t.length,r=0,o=0,a=[];return t.forEach((function(t){t.then((function(){(r+=1)===i?n.resolve():r+o+a.length===i&&n.reject(a)}),(function(){r+(o+=1)+a.length===i&&n.reject(a)})).error((function(t){a.push(t),a.length+r+o===i&&n.reject(a)}))})),n}}]),t}();ia=Jo=na([nt({message:"ex.Promises are being replaced by native browser promises in v0.26.0",alternateMethod:"Use browser native promises"})],ia);var ra="0.25.0";C()}(),v}()},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",(function(){return i}))},function(t,e,n){"use strict";t.exports=n(50)},function(t,e,n){"use strict";function i(t){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function r(t){return(r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){return!e||"object"!==r(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function a(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=i(t);if(e){var a=i(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return o(this,n)}}n.d(e,"a",(function(){return a}))},function(t,e,n){"use strict";function i(t,e){return(i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function r(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&i(t,e)}n.d(e,"a",(function(){return r}))},function(t,e,n){"use strict";function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function r(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}n.d(e,"a",(function(){return r}))},function(t,e,n){"use strict";t.exports=n(18)},function(t,e,n){t.exports=n(23)},,function(t,e,n){"use strict";function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function r(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function o(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?r(Object(n),!0).forEach((function(e){i(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}n.d(e,"a",(function(){return o}))},function(t,e,n){"use strict";function i(t,e,n,i,r,o,a){try{var s=t[o](a),l=s.value}catch(u){return void n(u)}s.done?e(l):Promise.resolve(l).then(i,r)}function r(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var a=t.apply(e,n);function s(t){i(a,r,o,s,l,"next",t)}function l(t){i(a,r,o,s,l,"throw",t)}s(void 0)}))}}n.d(e,"a",(function(){return r}))},function(t,e,n){"use strict";var i=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;function a(t){if(null===t||void 0===t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}t.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(e).map((function(t){return e[t]})).join(""))return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach((function(t){i[t]=t})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},i)).join("")}catch(r){return!1}}()?Object.assign:function(t,e){for(var n,s,l=a(t),u=1;u<arguments.length;u++){for(var c in n=Object(arguments[u]))r.call(n,c)&&(l[c]=n[c]);if(i){s=i(n);for(var h=0;h<s.length;h++)o.call(n,s[h])&&(l[s[h]]=n[s[h]])}}return l}},function(t,e){function n(e){return t.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},n(e)}t.exports=n},function(t,e,n){var i=n(16);t.exports=function(t,e){if(t){if("string"===typeof t)return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(t,e):void 0}}},function(t,e,n){var i=n(24),r=n(15);t.exports=function(t,e){return!e||"object"!==i(e)&&"function"!==typeof e?r(t):e}},function(t,e){t.exports=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}},function(t,e){t.exports=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}},function(t,e,n){"use strict";!function t(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}(),t.exports=n(19)},function(t,e,n){"use strict";var i=n(11),r=60103,o=60106;e.Fragment=60107,e.StrictMode=60108,e.Profiler=60114;var a=60109,s=60110,l=60112;e.Suspense=60113;var u=60115,c=60116;if("function"===typeof Symbol&&Symbol.for){var h=Symbol.for;r=h("react.element"),o=h("react.portal"),e.Fragment=h("react.fragment"),e.StrictMode=h("react.strict_mode"),e.Profiler=h("react.profiler"),a=h("react.provider"),s=h("react.context"),l=h("react.forward_ref"),e.Suspense=h("react.suspense"),u=h("react.memo"),c=h("react.lazy")}var d="function"===typeof Symbol&&Symbol.iterator;function f(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v={};function g(t,e,n){this.props=t,this.context=e,this.refs=v,this.updater=n||p}function y(){}function m(t,e,n){this.props=t,this.context=e,this.refs=v,this.updater=n||p}g.prototype.isReactComponent={},g.prototype.setState=function(t,e){if("object"!==typeof t&&"function"!==typeof t&&null!=t)throw Error(f(85));this.updater.enqueueSetState(this,t,e,"setState")},g.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")},y.prototype=g.prototype;var _=m.prototype=new y;_.constructor=m,i(_,g.prototype),_.isPureReactComponent=!0;var w={current:null},b=Object.prototype.hasOwnProperty,k={key:!0,ref:!0,__self:!0,__source:!0};function x(t,e,n){var i,o={},a=null,s=null;if(null!=e)for(i in void 0!==e.ref&&(s=e.ref),void 0!==e.key&&(a=""+e.key),e)b.call(e,i)&&!k.hasOwnProperty(i)&&(o[i]=e[i]);var l=arguments.length-2;if(1===l)o.children=n;else if(1<l){for(var u=Array(l),c=0;c<l;c++)u[c]=arguments[c+2];o.children=u}if(t&&t.defaultProps)for(i in l=t.defaultProps)void 0===o[i]&&(o[i]=l[i]);return{$$typeof:r,type:t,key:a,ref:s,props:o,_owner:w.current}}function C(t){return"object"===typeof t&&null!==t&&t.$$typeof===r}var S=/\/+/g;function E(t,e){return"object"===typeof t&&null!==t&&null!=t.key?function(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,(function(t){return e[t]}))}(""+t.key):e.toString(36)}function P(t,e,n,i,a){var s=typeof t;"undefined"!==s&&"boolean"!==s||(t=null);var l=!1;if(null===t)l=!0;else switch(s){case"string":case"number":l=!0;break;case"object":switch(t.$$typeof){case r:case o:l=!0}}if(l)return a=a(l=t),t=""===i?"."+E(l,0):i,Array.isArray(a)?(n="",null!=t&&(n=t.replace(S,"$&/")+"/"),P(a,e,n,"",(function(t){return t}))):null!=a&&(C(a)&&(a=function(t,e){return{$$typeof:r,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}(a,n+(!a.key||l&&l.key===a.key?"":(""+a.key).replace(S,"$&/")+"/")+t)),e.push(a)),1;if(l=0,i=""===i?".":i+":",Array.isArray(t))for(var u=0;u<t.length;u++){var c=i+E(s=t[u],u);l+=P(s,e,n,c,a)}else if("function"===typeof(c=function(t){return null===t||"object"!==typeof t?null:"function"===typeof(t=d&&t[d]||t["@@iterator"])?t:null}(t)))for(t=c.call(t),u=0;!(s=t.next()).done;)l+=P(s=s.value,e,n,c=i+E(s,u++),a);else if("object"===s)throw e=""+t,Error(f(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e));return l}function A(t,e,n){if(null==t)return t;var i=[],r=0;return P(t,i,"","",(function(t){return e.call(n,t,r++)})),i}function T(t){if(-1===t._status){var e=t._result;e=e(),t._status=0,t._result=e,e.then((function(e){0===t._status&&(e=e.default,t._status=1,t._result=e)}),(function(e){0===t._status&&(t._status=2,t._result=e)}))}if(1===t._status)return t._result;throw t._result}var R={current:null};function D(){var t=R.current;if(null===t)throw Error(f(321));return t}var M={ReactCurrentDispatcher:R,ReactCurrentBatchConfig:{transition:0},ReactCurrentOwner:w,IsSomeRendererActing:{current:!1},assign:i};e.Children={map:A,forEach:function(t,e,n){A(t,(function(){e.apply(this,arguments)}),n)},count:function(t){var e=0;return A(t,(function(){e++})),e},toArray:function(t){return A(t,(function(t){return t}))||[]},only:function(t){if(!C(t))throw Error(f(143));return t}},e.Component=g,e.PureComponent=m,e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=M,e.cloneElement=function(t,e,n){if(null===t||void 0===t)throw Error(f(267,t));var o=i({},t.props),a=t.key,s=t.ref,l=t._owner;if(null!=e){if(void 0!==e.ref&&(s=e.ref,l=w.current),void 0!==e.key&&(a=""+e.key),t.type&&t.type.defaultProps)var u=t.type.defaultProps;for(c in e)b.call(e,c)&&!k.hasOwnProperty(c)&&(o[c]=void 0===e[c]&&void 0!==u?u[c]:e[c])}var c=arguments.length-2;if(1===c)o.children=n;else if(1<c){u=Array(c);for(var h=0;h<c;h++)u[h]=arguments[h+2];o.children=u}return{$$typeof:r,type:t.type,key:a,ref:s,props:o,_owner:l}},e.createContext=function(t,e){return void 0===e&&(e=null),(t={$$typeof:s,_calculateChangedBits:e,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:a,_context:t},t.Consumer=t},e.createElement=x,e.createFactory=function(t){var e=x.bind(null,t);return e.type=t,e},e.createRef=function(){return{current:null}},e.forwardRef=function(t){return{$$typeof:l,render:t}},e.isValidElement=C,e.lazy=function(t){return{$$typeof:c,_payload:{_status:-1,_result:t},_init:T}},e.memo=function(t,e){return{$$typeof:u,type:t,compare:void 0===e?null:e}},e.useCallback=function(t,e){return D().useCallback(t,e)},e.useContext=function(t,e){return D().useContext(t,e)},e.useDebugValue=function(){},e.useEffect=function(t,e){return D().useEffect(t,e)},e.useImperativeHandle=function(t,e,n){return D().useImperativeHandle(t,e,n)},e.useLayoutEffect=function(t,e){return D().useLayoutEffect(t,e)},e.useMemo=function(t,e){return D().useMemo(t,e)},e.useReducer=function(t,e,n){return D().useReducer(t,e,n)},e.useRef=function(t){return D().useRef(t)},e.useState=function(t){return D().useState(t)},e.version="17.0.2"},function(t,e,n){"use strict";var i=n(6),r=n(11),o=n(20);function a(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}if(!i)throw Error(a(227));var s=new Set,l={};function u(t,e){c(t,e),c(t+"Capture",e)}function c(t,e){for(l[t]=e,t=0;t<e.length;t++)s.add(e[t])}var h=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f=Object.prototype.hasOwnProperty,p={},v={};function g(t,e,n,i,r,o,a){this.acceptsBooleans=2===e||3===e||4===e,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=a}var y={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(t){y[t]=new g(t,0,!1,t,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(t){var e=t[0];y[e]=new g(e,1,!1,t[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(t){y[t]=new g(t,2,!1,t.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(t){y[t]=new g(t,2,!1,t,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(t){y[t]=new g(t,3,!1,t.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(t){y[t]=new g(t,3,!0,t,null,!1,!1)})),["capture","download"].forEach((function(t){y[t]=new g(t,4,!1,t,null,!1,!1)})),["cols","rows","size","span"].forEach((function(t){y[t]=new g(t,6,!1,t,null,!1,!1)})),["rowSpan","start"].forEach((function(t){y[t]=new g(t,5,!1,t.toLowerCase(),null,!1,!1)}));var m=/[\-:]([a-z])/g;function _(t){return t[1].toUpperCase()}function w(t,e,n,i){var r=y.hasOwnProperty(e)?y[e]:null;(null!==r?0===r.type:!i&&(2<e.length&&("o"===e[0]||"O"===e[0])&&("n"===e[1]||"N"===e[1])))||(function(t,e,n,i){if(null===e||"undefined"===typeof e||function(t,e,n,i){if(null!==n&&0===n.type)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return!i&&(null!==n?!n.acceptsBooleans:"data-"!==(t=t.toLowerCase().slice(0,5))&&"aria-"!==t);default:return!1}}(t,e,n,i))return!0;if(i)return!1;if(null!==n)switch(n.type){case 3:return!e;case 4:return!1===e;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}(e,n,r,i)&&(n=null),i||null===r?function(t){return!!f.call(v,t)||!f.call(p,t)&&(d.test(t)?v[t]=!0:(p[t]=!0,!1))}(e)&&(null===n?t.removeAttribute(e):t.setAttribute(e,""+n)):r.mustUseProperty?t[r.propertyName]=null===n?3!==r.type&&"":n:(e=r.attributeName,i=r.attributeNamespace,null===n?t.removeAttribute(e):(n=3===(r=r.type)||4===r&&!0===n?"":""+n,i?t.setAttributeNS(i,e,n):t.setAttribute(e,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(t){var e=t.replace(m,_);y[e]=new g(e,1,!1,t,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(t){var e=t.replace(m,_);y[e]=new g(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(t){var e=t.replace(m,_);y[e]=new g(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(t){y[t]=new g(t,1,!1,t.toLowerCase(),null,!1,!1)})),y.xlinkHref=new g("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(t){y[t]=new g(t,1,!1,t.toLowerCase(),null,!0,!0)}));var b=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,k=60103,x=60106,C=60107,S=60108,E=60114,P=60109,A=60110,T=60112,R=60113,D=60120,M=60115,L=60116,B=60121,O=60128,F=60129,I=60130,z=60131;if("function"===typeof Symbol&&Symbol.for){var N=Symbol.for;k=N("react.element"),x=N("react.portal"),C=N("react.fragment"),S=N("react.strict_mode"),E=N("react.profiler"),P=N("react.provider"),A=N("react.context"),T=N("react.forward_ref"),R=N("react.suspense"),D=N("react.suspense_list"),M=N("react.memo"),L=N("react.lazy"),B=N("react.block"),N("react.scope"),O=N("react.opaque.id"),F=N("react.debug_trace_mode"),I=N("react.offscreen"),z=N("react.legacy_hidden")}var U,H="function"===typeof Symbol&&Symbol.iterator;function W(t){return null===t||"object"!==typeof t?null:"function"===typeof(t=H&&t[H]||t["@@iterator"])?t:null}function j(t){if(void 0===U)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);U=e&&e[1]||""}return"\n"+U+t}var V=!1;function G(t,e){if(!t||V)return"";V=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(e,[])}catch(l){var i=l}Reflect.construct(t,[],e)}else{try{e.call()}catch(l){i=l}t.call(e.prototype)}else{try{throw Error()}catch(l){i=l}t()}}catch(l){if(l&&i&&"string"===typeof l.stack){for(var r=l.stack.split("\n"),o=i.stack.split("\n"),a=r.length-1,s=o.length-1;1<=a&&0<=s&&r[a]!==o[s];)s--;for(;1<=a&&0<=s;a--,s--)if(r[a]!==o[s]){if(1!==a||1!==s)do{if(a--,0>--s||r[a]!==o[s])return"\n"+r[a].replace(" at new "," at ")}while(1<=a&&0<=s);break}}}finally{V=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?j(t):""}function X(t){switch(t.tag){case 5:return j(t.type);case 16:return j("Lazy");case 13:return j("Suspense");case 19:return j("SuspenseList");case 0:case 2:case 15:return t=G(t.type,!1);case 11:return t=G(t.type.render,!1);case 22:return t=G(t.type._render,!1);case 1:return t=G(t.type,!0);default:return""}}function q(t){if(null==t)return null;if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t;switch(t){case C:return"Fragment";case x:return"Portal";case E:return"Profiler";case S:return"StrictMode";case R:return"Suspense";case D:return"SuspenseList"}if("object"===typeof t)switch(t.$$typeof){case A:return(t.displayName||"Context")+".Consumer";case P:return(t._context.displayName||"Context")+".Provider";case T:var e=t.render;return e=e.displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case M:return q(t.type);case B:return q(t._render);case L:e=t._payload,t=t._init;try{return q(t(e))}catch(n){}}return null}function K(t){switch(typeof t){case"boolean":case"number":case"object":case"string":case"undefined":return t;default:return""}}function Q(t){var e=t.type;return(t=t.nodeName)&&"input"===t.toLowerCase()&&("checkbox"===e||"radio"===e)}function Y(t){t._valueTracker||(t._valueTracker=function(t){var e=Q(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),i=""+t[e];if(!t.hasOwnProperty(e)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var r=n.get,o=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return r.call(this)},set:function(t){i=""+t,o.call(this,t)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(t){i=""+t},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}(t))}function Z(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),i="";return t&&(i=Q(t)?t.checked?"true":"false":t.value),(t=i)!==n&&(e.setValue(t),!0)}function $(t){if("undefined"===typeof(t=t||("undefined"!==typeof document?document:void 0)))return null;try{return t.activeElement||t.body}catch(e){return t.body}}function J(t,e){var n=e.checked;return r({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:t._wrapperState.initialChecked})}function tt(t,e){var n=null==e.defaultValue?"":e.defaultValue,i=null!=e.checked?e.checked:e.defaultChecked;n=K(null!=e.value?e.value:n),t._wrapperState={initialChecked:i,initialValue:n,controlled:"checkbox"===e.type||"radio"===e.type?null!=e.checked:null!=e.value}}function et(t,e){null!=(e=e.checked)&&w(t,"checked",e,!1)}function nt(t,e){et(t,e);var n=K(e.value),i=e.type;if(null!=n)"number"===i?(0===n&&""===t.value||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if("submit"===i||"reset"===i)return void t.removeAttribute("value");e.hasOwnProperty("value")?rt(t,e.type,n):e.hasOwnProperty("defaultValue")&&rt(t,e.type,K(e.defaultValue)),null==e.checked&&null!=e.defaultChecked&&(t.defaultChecked=!!e.defaultChecked)}function it(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var i=e.type;if(!("submit"!==i&&"reset"!==i||void 0!==e.value&&null!==e.value))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}""!==(n=t.name)&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,""!==n&&(t.name=n)}function rt(t,e,n){"number"===e&&$(t.ownerDocument)===t||(null==n?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}function ot(t,e){return t=r({children:void 0},e),(e=function(t){var e="";return i.Children.forEach(t,(function(t){null!=t&&(e+=t)})),e}(e.children))&&(t.children=e),t}function at(t,e,n,i){if(t=t.options,e){e={};for(var r=0;r<n.length;r++)e["$"+n[r]]=!0;for(n=0;n<t.length;n++)r=e.hasOwnProperty("$"+t[n].value),t[n].selected!==r&&(t[n].selected=r),r&&i&&(t[n].defaultSelected=!0)}else{for(n=""+K(n),e=null,r=0;r<t.length;r++){if(t[r].value===n)return t[r].selected=!0,void(i&&(t[r].defaultSelected=!0));null!==e||t[r].disabled||(e=t[r])}null!==e&&(e.selected=!0)}}function st(t,e){if(null!=e.dangerouslySetInnerHTML)throw Error(a(91));return r({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function lt(t,e){var n=e.value;if(null==n){if(n=e.children,e=e.defaultValue,null!=n){if(null!=e)throw Error(a(92));if(Array.isArray(n)){if(!(1>=n.length))throw Error(a(93));n=n[0]}e=n}null==e&&(e=""),n=e}t._wrapperState={initialValue:K(n)}}function ut(t,e){var n=K(e.value),i=K(e.defaultValue);null!=n&&((n=""+n)!==t.value&&(t.value=n),null==e.defaultValue&&t.defaultValue!==n&&(t.defaultValue=n)),null!=i&&(t.defaultValue=""+i)}function ct(t){var e=t.textContent;e===t._wrapperState.initialValue&&""!==e&&null!==e&&(t.value=e)}var ht="http://www.w3.org/1999/xhtml",dt="http://www.w3.org/2000/svg";function ft(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function pt(t,e){return null==t||"http://www.w3.org/1999/xhtml"===t?ft(e):"http://www.w3.org/2000/svg"===t&&"foreignObject"===e?"http://www.w3.org/1999/xhtml":t}var vt,gt,yt=(gt=function(t,e){if(t.namespaceURI!==dt||"innerHTML"in t)t.innerHTML=e;else{for((vt=vt||document.createElement("div")).innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=vt.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(t,e,n,i){MSApp.execUnsafeLocalFunction((function(){return gt(t,e)}))}:gt);function mt(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&3===n.nodeType)return void(n.nodeValue=e)}t.textContent=e}var _t={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},wt=["Webkit","ms","Moz","O"];function bt(t,e,n){return null==e||"boolean"===typeof e||""===e?"":n||"number"!==typeof e||0===e||_t.hasOwnProperty(t)&&_t[t]?(""+e).trim():e+"px"}function kt(t,e){for(var n in t=t.style,e)if(e.hasOwnProperty(n)){var i=0===n.indexOf("--"),r=bt(n,e[n],i);"float"===n&&(n="cssFloat"),i?t.setProperty(n,r):t[n]=r}}Object.keys(_t).forEach((function(t){wt.forEach((function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),_t[e]=_t[t]}))}));var xt=r({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ct(t,e){if(e){if(xt[t]&&(null!=e.children||null!=e.dangerouslySetInnerHTML))throw Error(a(137,t));if(null!=e.dangerouslySetInnerHTML){if(null!=e.children)throw Error(a(60));if("object"!==typeof e.dangerouslySetInnerHTML||!("__html"in e.dangerouslySetInnerHTML))throw Error(a(61))}if(null!=e.style&&"object"!==typeof e.style)throw Error(a(62))}}function St(t,e){if(-1===t.indexOf("-"))return"string"===typeof e.is;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}function Et(t){return(t=t.target||t.srcElement||window).correspondingUseElement&&(t=t.correspondingUseElement),3===t.nodeType?t.parentNode:t}var Pt=null,At=null,Tt=null;function Rt(t){if(t=tr(t)){if("function"!==typeof Pt)throw Error(a(280));var e=t.stateNode;e&&(e=nr(e),Pt(t.stateNode,t.type,e))}}function Dt(t){At?Tt?Tt.push(t):Tt=[t]:At=t}function Mt(){if(At){var t=At,e=Tt;if(Tt=At=null,Rt(t),e)for(t=0;t<e.length;t++)Rt(e[t])}}function Lt(t,e){return t(e)}function Bt(t,e,n,i,r){return t(e,n,i,r)}function Ot(){}var Ft=Lt,It=!1,zt=!1;function Nt(){null===At&&null===Tt||(Ot(),Mt())}function Ut(t,e){var n=t.stateNode;if(null===n)return null;var i=nr(n);if(null===i)return null;n=i[e];t:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(i=!("button"===(t=t.type)||"input"===t||"select"===t||"textarea"===t)),t=!i;break t;default:t=!1}if(t)return null;if(n&&"function"!==typeof n)throw Error(a(231,e,typeof n));return n}var Ht=!1;if(h)try{var Wt={};Object.defineProperty(Wt,"passive",{get:function(){Ht=!0}}),window.addEventListener("test",Wt,Wt),window.removeEventListener("test",Wt,Wt)}catch(gt){Ht=!1}function jt(t,e,n,i,r,o,a,s,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(c){this.onError(c)}}var Vt=!1,Gt=null,Xt=!1,qt=null,Kt={onError:function(t){Vt=!0,Gt=t}};function Qt(t,e,n,i,r,o,a,s,l){Vt=!1,Gt=null,jt.apply(Kt,arguments)}function Yt(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do{0!==(1026&(e=t).flags)&&(n=e.return),t=e.return}while(t)}return 3===e.tag?n:null}function Zt(t){if(13===t.tag){var e=t.memoizedState;if(null===e&&(null!==(t=t.alternate)&&(e=t.memoizedState)),null!==e)return e.dehydrated}return null}function $t(t){if(Yt(t)!==t)throw Error(a(188))}function Jt(t){if(!(t=function(t){var e=t.alternate;if(!e){if(null===(e=Yt(t)))throw Error(a(188));return e!==t?null:t}for(var n=t,i=e;;){var r=n.return;if(null===r)break;var o=r.alternate;if(null===o){if(null!==(i=r.return)){n=i;continue}break}if(r.child===o.child){for(o=r.child;o;){if(o===n)return $t(r),t;if(o===i)return $t(r),e;o=o.sibling}throw Error(a(188))}if(n.return!==i.return)n=r,i=o;else{for(var s=!1,l=r.child;l;){if(l===n){s=!0,n=r,i=o;break}if(l===i){s=!0,i=r,n=o;break}l=l.sibling}if(!s){for(l=o.child;l;){if(l===n){s=!0,n=o,i=r;break}if(l===i){s=!0,i=o,n=r;break}l=l.sibling}if(!s)throw Error(a(189))}}if(n.alternate!==i)throw Error(a(190))}if(3!==n.tag)throw Error(a(188));return n.stateNode.current===n?t:e}(t)))return null;for(var e=t;;){if(5===e.tag||6===e.tag)return e;if(e.child)e.child.return=e,e=e.child;else{if(e===t)break;for(;!e.sibling;){if(!e.return||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}}return null}function te(t,e){for(var n=t.alternate;null!==e;){if(e===t||e===n)return!0;e=e.return}return!1}var ee,ne,ie,re,oe=!1,ae=[],se=null,le=null,ue=null,ce=new Map,he=new Map,de=[],fe="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function pe(t,e,n,i,r){return{blockedOn:t,domEventName:e,eventSystemFlags:16|n,nativeEvent:r,targetContainers:[i]}}function ve(t,e){switch(t){case"focusin":case"focusout":se=null;break;case"dragenter":case"dragleave":le=null;break;case"mouseover":case"mouseout":ue=null;break;case"pointerover":case"pointerout":ce.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":he.delete(e.pointerId)}}function ge(t,e,n,i,r,o){return null===t||t.nativeEvent!==o?(t=pe(e,n,i,r,o),null!==e&&(null!==(e=tr(e))&&ne(e)),t):(t.eventSystemFlags|=i,e=t.targetContainers,null!==r&&-1===e.indexOf(r)&&e.push(r),t)}function ye(t){var e=Ji(t.target);if(null!==e){var n=Yt(e);if(null!==n)if(13===(e=n.tag)){if(null!==(e=Zt(n)))return t.blockedOn=e,void re(t.lanePriority,(function(){o.unstable_runWithPriority(t.priority,(function(){ie(n)}))}))}else if(3===e&&n.stateNode.hydrate)return void(t.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}t.blockedOn=null}function me(t){if(null!==t.blockedOn)return!1;for(var e=t.targetContainers;0<e.length;){var n=Je(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(null!==n)return null!==(e=tr(n))&&ne(e),t.blockedOn=n,!1;e.shift()}return!0}function _e(t,e,n){me(t)&&n.delete(e)}function we(){for(oe=!1;0<ae.length;){var t=ae[0];if(null!==t.blockedOn){null!==(t=tr(t.blockedOn))&&ee(t);break}for(var e=t.targetContainers;0<e.length;){var n=Je(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(null!==n){t.blockedOn=n;break}e.shift()}null===t.blockedOn&&ae.shift()}null!==se&&me(se)&&(se=null),null!==le&&me(le)&&(le=null),null!==ue&&me(ue)&&(ue=null),ce.forEach(_e),he.forEach(_e)}function be(t,e){t.blockedOn===e&&(t.blockedOn=null,oe||(oe=!0,o.unstable_scheduleCallback(o.unstable_NormalPriority,we)))}function ke(t){function e(e){return be(e,t)}if(0<ae.length){be(ae[0],t);for(var n=1;n<ae.length;n++){var i=ae[n];i.blockedOn===t&&(i.blockedOn=null)}}for(null!==se&&be(se,t),null!==le&&be(le,t),null!==ue&&be(ue,t),ce.forEach(e),he.forEach(e),n=0;n<de.length;n++)(i=de[n]).blockedOn===t&&(i.blockedOn=null);for(;0<de.length&&null===(n=de[0]).blockedOn;)ye(n),null===n.blockedOn&&de.shift()}function xe(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Ce={animationend:xe("Animation","AnimationEnd"),animationiteration:xe("Animation","AnimationIteration"),animationstart:xe("Animation","AnimationStart"),transitionend:xe("Transition","TransitionEnd")},Se={},Ee={};function Pe(t){if(Se[t])return Se[t];if(!Ce[t])return t;var e,n=Ce[t];for(e in n)if(n.hasOwnProperty(e)&&e in Ee)return Se[t]=n[e];return t}h&&(Ee=document.createElement("div").style,"AnimationEvent"in window||(delete Ce.animationend.animation,delete Ce.animationiteration.animation,delete Ce.animationstart.animation),"TransitionEvent"in window||delete Ce.transitionend.transition);var Ae=Pe("animationend"),Te=Pe("animationiteration"),Re=Pe("animationstart"),De=Pe("transitionend"),Me=new Map,Le=new Map,Be=["abort","abort",Ae,"animationEnd",Te,"animationIteration",Re,"animationStart","canplay","canPlay","canplaythrough","canPlayThrough","durationchange","durationChange","emptied","emptied","encrypted","encrypted","ended","ended","error","error","gotpointercapture","gotPointerCapture","load","load","loadeddata","loadedData","loadedmetadata","loadedMetadata","loadstart","loadStart","lostpointercapture","lostPointerCapture","playing","playing","progress","progress","seeking","seeking","stalled","stalled","suspend","suspend","timeupdate","timeUpdate",De,"transitionEnd","waiting","waiting"];function Oe(t,e){for(var n=0;n<t.length;n+=2){var i=t[n],r=t[n+1];r="on"+(r[0].toUpperCase()+r.slice(1)),Le.set(i,e),Me.set(i,r),u(r,[i])}}(0,o.unstable_now)();var Fe=8;function Ie(t){if(0!==(1&t))return Fe=15,1;if(0!==(2&t))return Fe=14,2;if(0!==(4&t))return Fe=13,4;var e=24&t;return 0!==e?(Fe=12,e):0!==(32&t)?(Fe=11,32):0!==(e=192&t)?(Fe=10,e):0!==(256&t)?(Fe=9,256):0!==(e=3584&t)?(Fe=8,e):0!==(4096&t)?(Fe=7,4096):0!==(e=4186112&t)?(Fe=6,e):0!==(e=62914560&t)?(Fe=5,e):67108864&t?(Fe=4,67108864):0!==(134217728&t)?(Fe=3,134217728):0!==(e=805306368&t)?(Fe=2,e):0!==(1073741824&t)?(Fe=1,1073741824):(Fe=8,t)}function ze(t,e){var n=t.pendingLanes;if(0===n)return Fe=0;var i=0,r=0,o=t.expiredLanes,a=t.suspendedLanes,s=t.pingedLanes;if(0!==o)i=o,r=Fe=15;else if(0!==(o=134217727&n)){var l=o&~a;0!==l?(i=Ie(l),r=Fe):0!==(s&=o)&&(i=Ie(s),r=Fe)}else 0!==(o=n&~a)?(i=Ie(o),r=Fe):0!==s&&(i=Ie(s),r=Fe);if(0===i)return 0;if(i=n&((0>(i=31-Ve(i))?0:1<<i)<<1)-1,0!==e&&e!==i&&0===(e&a)){if(Ie(e),r<=Fe)return e;Fe=r}if(0!==(e=t.entangledLanes))for(t=t.entanglements,e&=i;0<e;)r=1<<(n=31-Ve(e)),i|=t[n],e&=~r;return i}function Ne(t){return 0!==(t=-1073741825&t.pendingLanes)?t:1073741824&t?1073741824:0}function Ue(t,e){switch(t){case 15:return 1;case 14:return 2;case 12:return 0===(t=He(24&~e))?Ue(10,e):t;case 10:return 0===(t=He(192&~e))?Ue(8,e):t;case 8:return 0===(t=He(3584&~e))&&(0===(t=He(4186112&~e))&&(t=512)),t;case 2:return 0===(e=He(805306368&~e))&&(e=268435456),e}throw Error(a(358,t))}function He(t){return t&-t}function We(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function je(t,e,n){t.pendingLanes|=e;var i=e-1;t.suspendedLanes&=i,t.pingedLanes&=i,(t=t.eventTimes)[e=31-Ve(e)]=n}var Ve=Math.clz32?Math.clz32:function(t){return 0===t?32:31-(Ge(t)/Xe|0)|0},Ge=Math.log,Xe=Math.LN2;var qe=o.unstable_UserBlockingPriority,Ke=o.unstable_runWithPriority,Qe=!0;function Ye(t,e,n,i){It||Ot();var r=$e,o=It;It=!0;try{Bt(r,t,e,n,i)}finally{(It=o)||Nt()}}function Ze(t,e,n,i){Ke(qe,$e.bind(null,t,e,n,i))}function $e(t,e,n,i){var r;if(Qe)if((r=0===(4&e))&&0<ae.length&&-1<fe.indexOf(t))t=pe(null,t,e,n,i),ae.push(t);else{var o=Je(t,e,n,i);if(null===o)r&&ve(t,i);else{if(r){if(-1<fe.indexOf(t))return t=pe(o,t,e,n,i),void ae.push(t);if(function(t,e,n,i,r){switch(e){case"focusin":return se=ge(se,t,e,n,i,r),!0;case"dragenter":return le=ge(le,t,e,n,i,r),!0;case"mouseover":return ue=ge(ue,t,e,n,i,r),!0;case"pointerover":var o=r.pointerId;return ce.set(o,ge(ce.get(o)||null,t,e,n,i,r)),!0;case"gotpointercapture":return o=r.pointerId,he.set(o,ge(he.get(o)||null,t,e,n,i,r)),!0}return!1}(o,t,e,n,i))return;ve(t,i)}Mi(t,e,i,null,n)}}}function Je(t,e,n,i){var r=Et(i);if(null!==(r=Ji(r))){var o=Yt(r);if(null===o)r=null;else{var a=o.tag;if(13===a){if(null!==(r=Zt(o)))return r;r=null}else if(3===a){if(o.stateNode.hydrate)return 3===o.tag?o.stateNode.containerInfo:null;r=null}else o!==r&&(r=null)}}return Mi(t,e,i,r,n),null}var tn=null,en=null,nn=null;function rn(){if(nn)return nn;var t,e,n=en,i=n.length,r="value"in tn?tn.value:tn.textContent,o=r.length;for(t=0;t<i&&n[t]===r[t];t++);var a=i-t;for(e=1;e<=a&&n[i-e]===r[o-e];e++);return nn=r.slice(t,1<e?1-e:void 0)}function on(t){var e=t.keyCode;return"charCode"in t?0===(t=t.charCode)&&13===e&&(t=13):t=e,10===t&&(t=13),32<=t||13===t?t:0}function an(){return!0}function sn(){return!1}function ln(t){function e(e,n,i,r,o){for(var a in this._reactName=e,this._targetInst=i,this.type=n,this.nativeEvent=r,this.target=o,this.currentTarget=null,t)t.hasOwnProperty(a)&&(e=t[a],this[a]=e?e(r):r[a]);return this.isDefaultPrevented=(null!=r.defaultPrevented?r.defaultPrevented:!1===r.returnValue)?an:sn,this.isPropagationStopped=sn,this}return r(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():"unknown"!==typeof t.returnValue&&(t.returnValue=!1),this.isDefaultPrevented=an)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():"unknown"!==typeof t.cancelBubble&&(t.cancelBubble=!0),this.isPropagationStopped=an)},persist:function(){},isPersistent:an}),e}var un,cn,hn,dn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},fn=ln(dn),pn=r({},dn,{view:0,detail:0}),vn=ln(pn),gn=r({},pn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Pn,button:0,buttons:0,relatedTarget:function(t){return void 0===t.relatedTarget?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==hn&&(hn&&"mousemove"===t.type?(un=t.screenX-hn.screenX,cn=t.screenY-hn.screenY):cn=un=0,hn=t),un)},movementY:function(t){return"movementY"in t?t.movementY:cn}}),yn=ln(gn),mn=ln(r({},gn,{dataTransfer:0})),_n=ln(r({},pn,{relatedTarget:0})),wn=ln(r({},dn,{animationName:0,elapsedTime:0,pseudoElement:0})),bn=ln(r({},dn,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}})),kn=ln(r({},dn,{data:0})),xn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Cn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Sn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function En(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):!!(t=Sn[t])&&!!e[t]}function Pn(){return En}var An=ln(r({},pn,{key:function(t){if(t.key){var e=xn[t.key]||t.key;if("Unidentified"!==e)return e}return"keypress"===t.type?13===(t=on(t))?"Enter":String.fromCharCode(t):"keydown"===t.type||"keyup"===t.type?Cn[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Pn,charCode:function(t){return"keypress"===t.type?on(t):0},keyCode:function(t){return"keydown"===t.type||"keyup"===t.type?t.keyCode:0},which:function(t){return"keypress"===t.type?on(t):"keydown"===t.type||"keyup"===t.type?t.keyCode:0}})),Tn=ln(r({},gn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Rn=ln(r({},pn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Pn})),Dn=ln(r({},dn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Mn=ln(r({},gn,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0})),Ln=[9,13,27,32],Bn=h&&"CompositionEvent"in window,On=null;h&&"documentMode"in document&&(On=document.documentMode);var Fn=h&&"TextEvent"in window&&!On,In=h&&(!Bn||On&&8<On&&11>=On),zn=String.fromCharCode(32),Nn=!1;function Un(t,e){switch(t){case"keyup":return-1!==Ln.indexOf(e.keyCode);case"keydown":return 229!==e.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Hn(t){return"object"===typeof(t=t.detail)&&"data"in t?t.data:null}var Wn=!1;var jn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Vn(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return"input"===e?!!jn[t.type]:"textarea"===e}function Gn(t,e,n,i){Dt(i),0<(e=Bi(e,"onChange")).length&&(n=new fn("onChange","change",null,n,i),t.push({event:n,listeners:e}))}var Xn=null,qn=null;function Kn(t){Ei(t,0)}function Qn(t){if(Z(er(t)))return t}function Yn(t,e){if("change"===t)return e}var Zn=!1;if(h){var $n;if(h){var Jn="oninput"in document;if(!Jn){var ti=document.createElement("div");ti.setAttribute("oninput","return;"),Jn="function"===typeof ti.oninput}$n=Jn}else $n=!1;Zn=$n&&(!document.documentMode||9<document.documentMode)}function ei(){Xn&&(Xn.detachEvent("onpropertychange",ni),qn=Xn=null)}function ni(t){if("value"===t.propertyName&&Qn(qn)){var e=[];if(Gn(e,qn,t,Et(t)),t=Kn,It)t(e);else{It=!0;try{Lt(t,e)}finally{It=!1,Nt()}}}}function ii(t,e,n){"focusin"===t?(ei(),qn=n,(Xn=e).attachEvent("onpropertychange",ni)):"focusout"===t&&ei()}function ri(t){if("selectionchange"===t||"keyup"===t||"keydown"===t)return Qn(qn)}function oi(t,e){if("click"===t)return Qn(e)}function ai(t,e){if("input"===t||"change"===t)return Qn(e)}var si="function"===typeof Object.is?Object.is:function(t,e){return t===e&&(0!==t||1/t===1/e)||t!==t&&e!==e},li=Object.prototype.hasOwnProperty;function ui(t,e){if(si(t,e))return!0;if("object"!==typeof t||null===t||"object"!==typeof e||null===e)return!1;var n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++)if(!li.call(e,n[i])||!si(t[n[i]],e[n[i]]))return!1;return!0}function ci(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function hi(t,e){var n,i=ci(t);for(t=0;i;){if(3===i.nodeType){if(n=t+i.textContent.length,t<=e&&n>=e)return{node:i,offset:e-t};t=n}t:{for(;i;){if(i.nextSibling){i=i.nextSibling;break t}i=i.parentNode}i=void 0}i=ci(i)}}function di(t,e){return!(!t||!e)&&(t===e||(!t||3!==t.nodeType)&&(e&&3===e.nodeType?di(t,e.parentNode):"contains"in t?t.contains(e):!!t.compareDocumentPosition&&!!(16&t.compareDocumentPosition(e))))}function fi(){for(var t=window,e=$();e instanceof t.HTMLIFrameElement;){try{var n="string"===typeof e.contentWindow.location.href}catch(i){n=!1}if(!n)break;e=$((t=e.contentWindow).document)}return e}function pi(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&("input"===e&&("text"===t.type||"search"===t.type||"tel"===t.type||"url"===t.type||"password"===t.type)||"textarea"===e||"true"===t.contentEditable)}var vi=h&&"documentMode"in document&&11>=document.documentMode,gi=null,yi=null,mi=null,_i=!1;function wi(t,e,n){var i=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;_i||null==gi||gi!==$(i)||("selectionStart"in(i=gi)&&pi(i)?i={start:i.selectionStart,end:i.selectionEnd}:i={anchorNode:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset},mi&&ui(mi,i)||(mi=i,0<(i=Bi(yi,"onSelect")).length&&(e=new fn("onSelect","select",null,e,n),t.push({event:e,listeners:i}),e.target=gi)))}Oe("cancel cancel click click close close contextmenu contextMenu copy copy cut cut auxclick auxClick dblclick doubleClick dragend dragEnd dragstart dragStart drop drop focusin focus focusout blur input input invalid invalid keydown keyDown keypress keyPress keyup keyUp mousedown mouseDown mouseup mouseUp paste paste pause pause play play pointercancel pointerCancel pointerdown pointerDown pointerup pointerUp ratechange rateChange reset reset seeked seeked submit submit touchcancel touchCancel touchend touchEnd touchstart touchStart volumechange volumeChange".split(" "),0),Oe("drag drag dragenter dragEnter dragexit dragExit dragleave dragLeave dragover dragOver mousemove mouseMove mouseout mouseOut mouseover mouseOver pointermove pointerMove pointerout pointerOut pointerover pointerOver scroll scroll toggle toggle touchmove touchMove wheel wheel".split(" "),1),Oe(Be,2);for(var bi="change selectionchange textInput compositionstart compositionend compositionupdate".split(" "),ki=0;ki<bi.length;ki++)Le.set(bi[ki],0);c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),u("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),u("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),u("onBeforeInput",["compositionend","keypress","textInput","paste"]),u("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var xi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ci=new Set("cancel close invalid load scroll toggle".split(" ").concat(xi));function Si(t,e,n){var i=t.type||"unknown-event";t.currentTarget=n,function(t,e,n,i,r,o,s,l,u){if(Qt.apply(this,arguments),Vt){if(!Vt)throw Error(a(198));var c=Gt;Vt=!1,Gt=null,Xt||(Xt=!0,qt=c)}}(i,e,void 0,t),t.currentTarget=null}function Ei(t,e){e=0!==(4&e);for(var n=0;n<t.length;n++){var i=t[n],r=i.event;i=i.listeners;t:{var o=void 0;if(e)for(var a=i.length-1;0<=a;a--){var s=i[a],l=s.instance,u=s.currentTarget;if(s=s.listener,l!==o&&r.isPropagationStopped())break t;Si(r,s,u),o=l}else for(a=0;a<i.length;a++){if(l=(s=i[a]).instance,u=s.currentTarget,s=s.listener,l!==o&&r.isPropagationStopped())break t;Si(r,s,u),o=l}}}if(Xt)throw t=qt,Xt=!1,qt=null,t}function Pi(t,e){var n=ir(e),i=t+"__bubble";n.has(i)||(Di(e,t,2,!1),n.add(i))}var Ai="_reactListening"+Math.random().toString(36).slice(2);function Ti(t){t[Ai]||(t[Ai]=!0,s.forEach((function(e){Ci.has(e)||Ri(e,!1,t,null),Ri(e,!0,t,null)})))}function Ri(t,e,n,i){var r=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,o=n;if("selectionchange"===t&&9!==n.nodeType&&(o=n.ownerDocument),null!==i&&!e&&Ci.has(t)){if("scroll"!==t)return;r|=2,o=i}var a=ir(o),s=t+"__"+(e?"capture":"bubble");a.has(s)||(e&&(r|=4),Di(o,t,r,e),a.add(s))}function Di(t,e,n,i){var r=Le.get(e);switch(void 0===r?2:r){case 0:r=Ye;break;case 1:r=Ze;break;default:r=$e}n=r.bind(null,e,n,t),r=void 0,!Ht||"touchstart"!==e&&"touchmove"!==e&&"wheel"!==e||(r=!0),i?void 0!==r?t.addEventListener(e,n,{capture:!0,passive:r}):t.addEventListener(e,n,!0):void 0!==r?t.addEventListener(e,n,{passive:r}):t.addEventListener(e,n,!1)}function Mi(t,e,n,i,r){var o=i;if(0===(1&e)&&0===(2&e)&&null!==i)t:for(;;){if(null===i)return;var a=i.tag;if(3===a||4===a){var s=i.stateNode.containerInfo;if(s===r||8===s.nodeType&&s.parentNode===r)break;if(4===a)for(a=i.return;null!==a;){var l=a.tag;if((3===l||4===l)&&((l=a.stateNode.containerInfo)===r||8===l.nodeType&&l.parentNode===r))return;a=a.return}for(;null!==s;){if(null===(a=Ji(s)))return;if(5===(l=a.tag)||6===l){i=o=a;continue t}s=s.parentNode}}i=i.return}!function(t,e,n){if(zt)return t(e,n);zt=!0;try{Ft(t,e,n)}finally{zt=!1,Nt()}}((function(){var i=o,r=Et(n),a=[];t:{var s=Me.get(t);if(void 0!==s){var l=fn,u=t;switch(t){case"keypress":if(0===on(n))break t;case"keydown":case"keyup":l=An;break;case"focusin":u="focus",l=_n;break;case"focusout":u="blur",l=_n;break;case"beforeblur":case"afterblur":l=_n;break;case"click":if(2===n.button)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=yn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=mn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Rn;break;case Ae:case Te:case Re:l=wn;break;case De:l=Dn;break;case"scroll":l=vn;break;case"wheel":l=Mn;break;case"copy":case"cut":case"paste":l=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Tn}var c=0!==(4&e),h=!c&&"scroll"===t,d=c?null!==s?s+"Capture":null:s;c=[];for(var f,p=i;null!==p;){var v=(f=p).stateNode;if(5===f.tag&&null!==v&&(f=v,null!==d&&(null!=(v=Ut(p,d))&&c.push(Li(p,v,f)))),h)break;p=p.return}0<c.length&&(s=new l(s,u,null,n,r),a.push({event:s,listeners:c}))}}if(0===(7&e)){if(l="mouseout"===t||"pointerout"===t,(!(s="mouseover"===t||"pointerover"===t)||0!==(16&e)||!(u=n.relatedTarget||n.fromElement)||!Ji(u)&&!u[Zi])&&(l||s)&&(s=r.window===r?r:(s=r.ownerDocument)?s.defaultView||s.parentWindow:window,l?(l=i,null!==(u=(u=n.relatedTarget||n.toElement)?Ji(u):null)&&(u!==(h=Yt(u))||5!==u.tag&&6!==u.tag)&&(u=null)):(l=null,u=i),l!==u)){if(c=yn,v="onMouseLeave",d="onMouseEnter",p="mouse","pointerout"!==t&&"pointerover"!==t||(c=Tn,v="onPointerLeave",d="onPointerEnter",p="pointer"),h=null==l?s:er(l),f=null==u?s:er(u),(s=new c(v,p+"leave",l,n,r)).target=h,s.relatedTarget=f,v=null,Ji(r)===i&&((c=new c(d,p+"enter",u,n,r)).target=f,c.relatedTarget=h,v=c),h=v,l&&u)t:{for(d=u,p=0,f=c=l;f;f=Oi(f))p++;for(f=0,v=d;v;v=Oi(v))f++;for(;0<p-f;)c=Oi(c),p--;for(;0<f-p;)d=Oi(d),f--;for(;p--;){if(c===d||null!==d&&c===d.alternate)break t;c=Oi(c),d=Oi(d)}c=null}else c=null;null!==l&&Fi(a,s,l,c,!1),null!==u&&null!==h&&Fi(a,h,u,c,!0)}if("select"===(l=(s=i?er(i):window).nodeName&&s.nodeName.toLowerCase())||"input"===l&&"file"===s.type)var g=Yn;else if(Vn(s))if(Zn)g=ai;else{g=ri;var y=ii}else(l=s.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(g=oi);switch(g&&(g=g(t,i))?Gn(a,g,n,r):(y&&y(t,s,i),"focusout"===t&&(y=s._wrapperState)&&y.controlled&&"number"===s.type&&rt(s,"number",s.value)),y=i?er(i):window,t){case"focusin":(Vn(y)||"true"===y.contentEditable)&&(gi=y,yi=i,mi=null);break;case"focusout":mi=yi=gi=null;break;case"mousedown":_i=!0;break;case"contextmenu":case"mouseup":case"dragend":_i=!1,wi(a,n,r);break;case"selectionchange":if(vi)break;case"keydown":case"keyup":wi(a,n,r)}var m;if(Bn)t:{switch(t){case"compositionstart":var _="onCompositionStart";break t;case"compositionend":_="onCompositionEnd";break t;case"compositionupdate":_="onCompositionUpdate";break t}_=void 0}else Wn?Un(t,n)&&(_="onCompositionEnd"):"keydown"===t&&229===n.keyCode&&(_="onCompositionStart");_&&(In&&"ko"!==n.locale&&(Wn||"onCompositionStart"!==_?"onCompositionEnd"===_&&Wn&&(m=rn()):(en="value"in(tn=r)?tn.value:tn.textContent,Wn=!0)),0<(y=Bi(i,_)).length&&(_=new kn(_,t,null,n,r),a.push({event:_,listeners:y}),m?_.data=m:null!==(m=Hn(n))&&(_.data=m))),(m=Fn?function(t,e){switch(t){case"compositionend":return Hn(e);case"keypress":return 32!==e.which?null:(Nn=!0,zn);case"textInput":return(t=e.data)===zn&&Nn?null:t;default:return null}}(t,n):function(t,e){if(Wn)return"compositionend"===t||!Bn&&Un(t,e)?(t=rn(),nn=en=tn=null,Wn=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return In&&"ko"!==e.locale?null:e.data;default:return null}}(t,n))&&(0<(i=Bi(i,"onBeforeInput")).length&&(r=new kn("onBeforeInput","beforeinput",null,n,r),a.push({event:r,listeners:i}),r.data=m))}Ei(a,e)}))}function Li(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Bi(t,e){for(var n=e+"Capture",i=[];null!==t;){var r=t,o=r.stateNode;5===r.tag&&null!==o&&(r=o,null!=(o=Ut(t,n))&&i.unshift(Li(t,o,r)),null!=(o=Ut(t,e))&&i.push(Li(t,o,r))),t=t.return}return i}function Oi(t){if(null===t)return null;do{t=t.return}while(t&&5!==t.tag);return t||null}function Fi(t,e,n,i,r){for(var o=e._reactName,a=[];null!==n&&n!==i;){var s=n,l=s.alternate,u=s.stateNode;if(null!==l&&l===i)break;5===s.tag&&null!==u&&(s=u,r?null!=(l=Ut(n,o))&&a.unshift(Li(n,l,s)):r||null!=(l=Ut(n,o))&&a.push(Li(n,l,s))),n=n.return}0!==a.length&&t.push({event:e,listeners:a})}function Ii(){}var zi=null,Ni=null;function Ui(t,e){switch(t){case"button":case"input":case"select":case"textarea":return!!e.autoFocus}return!1}function Hi(t,e){return"textarea"===t||"option"===t||"noscript"===t||"string"===typeof e.children||"number"===typeof e.children||"object"===typeof e.dangerouslySetInnerHTML&&null!==e.dangerouslySetInnerHTML&&null!=e.dangerouslySetInnerHTML.__html}var Wi="function"===typeof setTimeout?setTimeout:void 0,ji="function"===typeof clearTimeout?clearTimeout:void 0;function Vi(t){1===t.nodeType?t.textContent="":9===t.nodeType&&(null!=(t=t.body)&&(t.textContent=""))}function Gi(t){for(;null!=t;t=t.nextSibling){var e=t.nodeType;if(1===e||3===e)break}return t}function Xi(t){t=t.previousSibling;for(var e=0;t;){if(8===t.nodeType){var n=t.data;if("$"===n||"$!"===n||"$?"===n){if(0===e)return t;e--}else"/$"===n&&e++}t=t.previousSibling}return null}var qi=0;var Ki=Math.random().toString(36).slice(2),Qi="__reactFiber$"+Ki,Yi="__reactProps$"+Ki,Zi="__reactContainer$"+Ki,$i="__reactEvents$"+Ki;function Ji(t){var e=t[Qi];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Zi]||n[Qi]){if(n=e.alternate,null!==e.child||null!==n&&null!==n.child)for(t=Xi(t);null!==t;){if(n=t[Qi])return n;t=Xi(t)}return e}n=(t=n).parentNode}return null}function tr(t){return!(t=t[Qi]||t[Zi])||5!==t.tag&&6!==t.tag&&13!==t.tag&&3!==t.tag?null:t}function er(t){if(5===t.tag||6===t.tag)return t.stateNode;throw Error(a(33))}function nr(t){return t[Yi]||null}function ir(t){var e=t[$i];return void 0===e&&(e=t[$i]=new Set),e}var rr=[],or=-1;function ar(t){return{current:t}}function sr(t){0>or||(t.current=rr[or],rr[or]=null,or--)}function lr(t,e){or++,rr[or]=t.current,t.current=e}var ur={},cr=ar(ur),hr=ar(!1),dr=ur;function fr(t,e){var n=t.type.contextTypes;if(!n)return ur;var i=t.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===e)return i.__reactInternalMemoizedMaskedChildContext;var r,o={};for(r in n)o[r]=e[r];return i&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=o),o}function pr(t){return null!==(t=t.childContextTypes)&&void 0!==t}function vr(){sr(hr),sr(cr)}function gr(t,e,n){if(cr.current!==ur)throw Error(a(168));lr(cr,e),lr(hr,n)}function yr(t,e,n){var i=t.stateNode;if(t=e.childContextTypes,"function"!==typeof i.getChildContext)return n;for(var o in i=i.getChildContext())if(!(o in t))throw Error(a(108,q(e)||"Unknown",o));return r({},n,i)}function mr(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||ur,dr=cr.current,lr(cr,t),lr(hr,hr.current),!0}function _r(t,e,n){var i=t.stateNode;if(!i)throw Error(a(169));n?(t=yr(t,e,dr),i.__reactInternalMemoizedMergedChildContext=t,sr(hr),sr(cr),lr(cr,t)):sr(hr),lr(hr,n)}var wr=null,br=null,kr=o.unstable_runWithPriority,xr=o.unstable_scheduleCallback,Cr=o.unstable_cancelCallback,Sr=o.unstable_shouldYield,Er=o.unstable_requestPaint,Pr=o.unstable_now,Ar=o.unstable_getCurrentPriorityLevel,Tr=o.unstable_ImmediatePriority,Rr=o.unstable_UserBlockingPriority,Dr=o.unstable_NormalPriority,Mr=o.unstable_LowPriority,Lr=o.unstable_IdlePriority,Br={},Or=void 0!==Er?Er:function(){},Fr=null,Ir=null,zr=!1,Nr=Pr(),Ur=1e4>Nr?Pr:function(){return Pr()-Nr};function Hr(){switch(Ar()){case Tr:return 99;case Rr:return 98;case Dr:return 97;case Mr:return 96;case Lr:return 95;default:throw Error(a(332))}}function Wr(t){switch(t){case 99:return Tr;case 98:return Rr;case 97:return Dr;case 96:return Mr;case 95:return Lr;default:throw Error(a(332))}}function jr(t,e){return t=Wr(t),kr(t,e)}function Vr(t,e,n){return t=Wr(t),xr(t,e,n)}function Gr(){if(null!==Ir){var t=Ir;Ir=null,Cr(t)}Xr()}function Xr(){if(!zr&&null!==Fr){zr=!0;var t=0;try{var e=Fr;jr(99,(function(){for(;t<e.length;t++){var n=e[t];do{n=n(!0)}while(null!==n)}})),Fr=null}catch(n){throw null!==Fr&&(Fr=Fr.slice(t+1)),xr(Tr,Gr),n}finally{zr=!1}}}var qr=b.ReactCurrentBatchConfig;function Kr(t,e){if(t&&t.defaultProps){for(var n in e=r({},e),t=t.defaultProps)void 0===e[n]&&(e[n]=t[n]);return e}return e}var Qr=ar(null),Yr=null,Zr=null,$r=null;function Jr(){$r=Zr=Yr=null}function to(t){var e=Qr.current;sr(Qr),t.type._context._currentValue=e}function eo(t,e){for(;null!==t;){var n=t.alternate;if((t.childLanes&e)===e){if(null===n||(n.childLanes&e)===e)break;n.childLanes|=e}else t.childLanes|=e,null!==n&&(n.childLanes|=e);t=t.return}}function no(t,e){Yr=t,$r=Zr=null,null!==(t=t.dependencies)&&null!==t.firstContext&&(0!==(t.lanes&e)&&(Ba=!0),t.firstContext=null)}function io(t,e){if($r!==t&&!1!==e&&0!==e)if("number"===typeof e&&1073741823!==e||($r=t,e=1073741823),e={context:t,observedBits:e,next:null},null===Zr){if(null===Yr)throw Error(a(308));Zr=e,Yr.dependencies={lanes:0,firstContext:e,responders:null}}else Zr=Zr.next=e;return t._currentValue}var ro=!1;function oo(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null},effects:null}}function ao(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function so(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function lo(t,e){if(null!==(t=t.updateQueue)){var n=(t=t.shared).pending;null===n?e.next=e:(e.next=n.next,n.next=e),t.pending=e}}function uo(t,e){var n=t.updateQueue,i=t.alternate;if(null!==i&&n===(i=i.updateQueue)){var r=null,o=null;if(null!==(n=n.firstBaseUpdate)){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===o?r=o=a:o=o.next=a,n=n.next}while(null!==n);null===o?r=o=e:o=o.next=e}else r=o=e;return n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:o,shared:i.shared,effects:i.effects},void(t.updateQueue=n)}null===(t=n.lastBaseUpdate)?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function co(t,e,n,i){var o=t.updateQueue;ro=!1;var a=o.firstBaseUpdate,s=o.lastBaseUpdate,l=o.shared.pending;if(null!==l){o.shared.pending=null;var u=l,c=u.next;u.next=null,null===s?a=c:s.next=c,s=u;var h=t.alternate;if(null!==h){var d=(h=h.updateQueue).lastBaseUpdate;d!==s&&(null===d?h.firstBaseUpdate=c:d.next=c,h.lastBaseUpdate=u)}}if(null!==a){for(d=o.baseState,s=0,h=c=u=null;;){l=a.lane;var f=a.eventTime;if((i&l)===l){null!==h&&(h=h.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});t:{var p=t,v=a;switch(l=e,f=n,v.tag){case 1:if("function"===typeof(p=v.payload)){d=p.call(f,d,l);break t}d=p;break t;case 3:p.flags=-4097&p.flags|64;case 0:if(null===(l="function"===typeof(p=v.payload)?p.call(f,d,l):p)||void 0===l)break t;d=r({},d,l);break t;case 2:ro=!0}}null!==a.callback&&(t.flags|=32,null===(l=o.effects)?o.effects=[a]:l.push(a))}else f={eventTime:f,lane:l,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===h?(c=h=f,u=d):h=h.next=f,s|=l;if(null===(a=a.next)){if(null===(l=o.shared.pending))break;a=l.next,l.next=null,o.lastBaseUpdate=l,o.shared.pending=null}}null===h&&(u=d),o.baseState=u,o.firstBaseUpdate=c,o.lastBaseUpdate=h,zs|=s,t.lanes=s,t.memoizedState=d}}function ho(t,e,n){if(t=e.effects,e.effects=null,null!==t)for(e=0;e<t.length;e++){var i=t[e],r=i.callback;if(null!==r){if(i.callback=null,i=n,"function"!==typeof r)throw Error(a(191,r));r.call(i)}}}var fo=(new i.Component).refs;function po(t,e,n,i){n=null===(n=n(i,e=t.memoizedState))||void 0===n?e:r({},e,n),t.memoizedState=n,0===t.lanes&&(t.updateQueue.baseState=n)}var vo={isMounted:function(t){return!!(t=t._reactInternals)&&Yt(t)===t},enqueueSetState:function(t,e,n){t=t._reactInternals;var i=ul(),r=cl(t),o=so(i,r);o.payload=e,void 0!==n&&null!==n&&(o.callback=n),lo(t,o),hl(t,r,i)},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var i=ul(),r=cl(t),o=so(i,r);o.tag=1,o.payload=e,void 0!==n&&null!==n&&(o.callback=n),lo(t,o),hl(t,r,i)},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=ul(),i=cl(t),r=so(n,i);r.tag=2,void 0!==e&&null!==e&&(r.callback=e),lo(t,r),hl(t,i,n)}};function go(t,e,n,i,r,o,a){return"function"===typeof(t=t.stateNode).shouldComponentUpdate?t.shouldComponentUpdate(i,o,a):!e.prototype||!e.prototype.isPureReactComponent||(!ui(n,i)||!ui(r,o))}function yo(t,e,n){var i=!1,r=ur,o=e.contextType;return"object"===typeof o&&null!==o?o=io(o):(r=pr(e)?dr:cr.current,o=(i=null!==(i=e.contextTypes)&&void 0!==i)?fr(t,r):ur),e=new e(n,o),t.memoizedState=null!==e.state&&void 0!==e.state?e.state:null,e.updater=vo,t.stateNode=e,e._reactInternals=t,i&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=r,t.__reactInternalMemoizedMaskedChildContext=o),e}function mo(t,e,n,i){t=e.state,"function"===typeof e.componentWillReceiveProps&&e.componentWillReceiveProps(n,i),"function"===typeof e.UNSAFE_componentWillReceiveProps&&e.UNSAFE_componentWillReceiveProps(n,i),e.state!==t&&vo.enqueueReplaceState(e,e.state,null)}function _o(t,e,n,i){var r=t.stateNode;r.props=n,r.state=t.memoizedState,r.refs=fo,oo(t);var o=e.contextType;"object"===typeof o&&null!==o?r.context=io(o):(o=pr(e)?dr:cr.current,r.context=fr(t,o)),co(t,n,r,i),r.state=t.memoizedState,"function"===typeof(o=e.getDerivedStateFromProps)&&(po(t,e,o,n),r.state=t.memoizedState),"function"===typeof e.getDerivedStateFromProps||"function"===typeof r.getSnapshotBeforeUpdate||"function"!==typeof r.UNSAFE_componentWillMount&&"function"!==typeof r.componentWillMount||(e=r.state,"function"===typeof r.componentWillMount&&r.componentWillMount(),"function"===typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount(),e!==r.state&&vo.enqueueReplaceState(r,r.state,null),co(t,n,r,i),r.state=t.memoizedState),"function"===typeof r.componentDidMount&&(t.flags|=4)}var wo=Array.isArray;function bo(t,e,n){if(null!==(t=n.ref)&&"function"!==typeof t&&"object"!==typeof t){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(a(309));var i=n.stateNode}if(!i)throw Error(a(147,t));var r=""+t;return null!==e&&null!==e.ref&&"function"===typeof e.ref&&e.ref._stringRef===r?e.ref:((e=function(t){var e=i.refs;e===fo&&(e=i.refs={}),null===t?delete e[r]:e[r]=t})._stringRef=r,e)}if("string"!==typeof t)throw Error(a(284));if(!n._owner)throw Error(a(290,t))}return t}function ko(t,e){if("textarea"!==t.type)throw Error(a(31,"[object Object]"===Object.prototype.toString.call(e)?"object with keys {"+Object.keys(e).join(", ")+"}":e))}function xo(t){function e(e,n){if(t){var i=e.lastEffect;null!==i?(i.nextEffect=n,e.lastEffect=n):e.firstEffect=e.lastEffect=n,n.nextEffect=null,n.flags=8}}function n(n,i){if(!t)return null;for(;null!==i;)e(n,i),i=i.sibling;return null}function i(t,e){for(t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function r(t,e){return(t=jl(t,e)).index=0,t.sibling=null,t}function o(e,n,i){return e.index=i,t?null!==(i=e.alternate)?(i=i.index)<n?(e.flags=2,n):i:(e.flags=2,n):n}function s(e){return t&&null===e.alternate&&(e.flags=2),e}function l(t,e,n,i){return null===e||6!==e.tag?((e=ql(n,t.mode,i)).return=t,e):((e=r(e,n)).return=t,e)}function u(t,e,n,i){return null!==e&&e.elementType===n.type?((i=r(e,n.props)).ref=bo(t,e,n),i.return=t,i):((i=Vl(n.type,n.key,n.props,null,t.mode,i)).ref=bo(t,e,n),i.return=t,i)}function c(t,e,n,i){return null===e||4!==e.tag||e.stateNode.containerInfo!==n.containerInfo||e.stateNode.implementation!==n.implementation?((e=Kl(n,t.mode,i)).return=t,e):((e=r(e,n.children||[])).return=t,e)}function h(t,e,n,i,o){return null===e||7!==e.tag?((e=Gl(n,t.mode,i,o)).return=t,e):((e=r(e,n)).return=t,e)}function d(t,e,n){if("string"===typeof e||"number"===typeof e)return(e=ql(""+e,t.mode,n)).return=t,e;if("object"===typeof e&&null!==e){switch(e.$$typeof){case k:return(n=Vl(e.type,e.key,e.props,null,t.mode,n)).ref=bo(t,null,e),n.return=t,n;case x:return(e=Kl(e,t.mode,n)).return=t,e}if(wo(e)||W(e))return(e=Gl(e,t.mode,n,null)).return=t,e;ko(t,e)}return null}function f(t,e,n,i){var r=null!==e?e.key:null;if("string"===typeof n||"number"===typeof n)return null!==r?null:l(t,e,""+n,i);if("object"===typeof n&&null!==n){switch(n.$$typeof){case k:return n.key===r?n.type===C?h(t,e,n.props.children,i,r):u(t,e,n,i):null;case x:return n.key===r?c(t,e,n,i):null}if(wo(n)||W(n))return null!==r?null:h(t,e,n,i,null);ko(t,n)}return null}function p(t,e,n,i,r){if("string"===typeof i||"number"===typeof i)return l(e,t=t.get(n)||null,""+i,r);if("object"===typeof i&&null!==i){switch(i.$$typeof){case k:return t=t.get(null===i.key?n:i.key)||null,i.type===C?h(e,t,i.props.children,r,i.key):u(e,t,i,r);case x:return c(e,t=t.get(null===i.key?n:i.key)||null,i,r)}if(wo(i)||W(i))return h(e,t=t.get(n)||null,i,r,null);ko(e,i)}return null}function v(r,a,s,l){for(var u=null,c=null,h=a,v=a=0,g=null;null!==h&&v<s.length;v++){h.index>v?(g=h,h=null):g=h.sibling;var y=f(r,h,s[v],l);if(null===y){null===h&&(h=g);break}t&&h&&null===y.alternate&&e(r,h),a=o(y,a,v),null===c?u=y:c.sibling=y,c=y,h=g}if(v===s.length)return n(r,h),u;if(null===h){for(;v<s.length;v++)null!==(h=d(r,s[v],l))&&(a=o(h,a,v),null===c?u=h:c.sibling=h,c=h);return u}for(h=i(r,h);v<s.length;v++)null!==(g=p(h,r,v,s[v],l))&&(t&&null!==g.alternate&&h.delete(null===g.key?v:g.key),a=o(g,a,v),null===c?u=g:c.sibling=g,c=g);return t&&h.forEach((function(t){return e(r,t)})),u}function g(r,s,l,u){var c=W(l);if("function"!==typeof c)throw Error(a(150));if(null==(l=c.call(l)))throw Error(a(151));for(var h=c=null,v=s,g=s=0,y=null,m=l.next();null!==v&&!m.done;g++,m=l.next()){v.index>g?(y=v,v=null):y=v.sibling;var _=f(r,v,m.value,u);if(null===_){null===v&&(v=y);break}t&&v&&null===_.alternate&&e(r,v),s=o(_,s,g),null===h?c=_:h.sibling=_,h=_,v=y}if(m.done)return n(r,v),c;if(null===v){for(;!m.done;g++,m=l.next())null!==(m=d(r,m.value,u))&&(s=o(m,s,g),null===h?c=m:h.sibling=m,h=m);return c}for(v=i(r,v);!m.done;g++,m=l.next())null!==(m=p(v,r,g,m.value,u))&&(t&&null!==m.alternate&&v.delete(null===m.key?g:m.key),s=o(m,s,g),null===h?c=m:h.sibling=m,h=m);return t&&v.forEach((function(t){return e(r,t)})),c}return function(t,i,o,l){var u="object"===typeof o&&null!==o&&o.type===C&&null===o.key;u&&(o=o.props.children);var c="object"===typeof o&&null!==o;if(c)switch(o.$$typeof){case k:t:{for(c=o.key,u=i;null!==u;){if(u.key===c){switch(u.tag){case 7:if(o.type===C){n(t,u.sibling),(i=r(u,o.props.children)).return=t,t=i;break t}break;default:if(u.elementType===o.type){n(t,u.sibling),(i=r(u,o.props)).ref=bo(t,u,o),i.return=t,t=i;break t}}n(t,u);break}e(t,u),u=u.sibling}o.type===C?((i=Gl(o.props.children,t.mode,l,o.key)).return=t,t=i):((l=Vl(o.type,o.key,o.props,null,t.mode,l)).ref=bo(t,i,o),l.return=t,t=l)}return s(t);case x:t:{for(u=o.key;null!==i;){if(i.key===u){if(4===i.tag&&i.stateNode.containerInfo===o.containerInfo&&i.stateNode.implementation===o.implementation){n(t,i.sibling),(i=r(i,o.children||[])).return=t,t=i;break t}n(t,i);break}e(t,i),i=i.sibling}(i=Kl(o,t.mode,l)).return=t,t=i}return s(t)}if("string"===typeof o||"number"===typeof o)return o=""+o,null!==i&&6===i.tag?(n(t,i.sibling),(i=r(i,o)).return=t,t=i):(n(t,i),(i=ql(o,t.mode,l)).return=t,t=i),s(t);if(wo(o))return v(t,i,o,l);if(W(o))return g(t,i,o,l);if(c&&ko(t,o),"undefined"===typeof o&&!u)switch(t.tag){case 1:case 22:case 0:case 11:case 15:throw Error(a(152,q(t.type)||"Component"))}return n(t,i)}}var Co=xo(!0),So=xo(!1),Eo={},Po=ar(Eo),Ao=ar(Eo),To=ar(Eo);function Ro(t){if(t===Eo)throw Error(a(174));return t}function Do(t,e){switch(lr(To,e),lr(Ao,t),lr(Po,Eo),t=e.nodeType){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:pt(null,"");break;default:e=pt(e=(t=8===t?e.parentNode:e).namespaceURI||null,t=t.tagName)}sr(Po),lr(Po,e)}function Mo(){sr(Po),sr(Ao),sr(To)}function Lo(t){Ro(To.current);var e=Ro(Po.current),n=pt(e,t.type);e!==n&&(lr(Ao,t),lr(Po,n))}function Bo(t){Ao.current===t&&(sr(Po),sr(Ao))}var Oo=ar(0);function Fo(t){for(var e=t;null!==e;){if(13===e.tag){var n=e.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return e}else if(19===e.tag&&void 0!==e.memoizedProps.revealOrder){if(0!==(64&e.flags))return e}else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Io=null,zo=null,No=!1;function Uo(t,e){var n=Hl(5,null,null,0);n.elementType="DELETED",n.type="DELETED",n.stateNode=e,n.return=t,n.flags=8,null!==t.lastEffect?(t.lastEffect.nextEffect=n,t.lastEffect=n):t.firstEffect=t.lastEffect=n}function Ho(t,e){switch(t.tag){case 5:var n=t.type;return null!==(e=1!==e.nodeType||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e)&&(t.stateNode=e,!0);case 6:return null!==(e=""===t.pendingProps||3!==e.nodeType?null:e)&&(t.stateNode=e,!0);case 13:default:return!1}}function Wo(t){if(No){var e=zo;if(e){var n=e;if(!Ho(t,e)){if(!(e=Gi(n.nextSibling))||!Ho(t,e))return t.flags=-1025&t.flags|2,No=!1,void(Io=t);Uo(Io,n)}Io=t,zo=Gi(e.firstChild)}else t.flags=-1025&t.flags|2,No=!1,Io=t}}function jo(t){for(t=t.return;null!==t&&5!==t.tag&&3!==t.tag&&13!==t.tag;)t=t.return;Io=t}function Vo(t){if(t!==Io)return!1;if(!No)return jo(t),No=!0,!1;var e=t.type;if(5!==t.tag||"head"!==e&&"body"!==e&&!Hi(e,t.memoizedProps))for(e=zo;e;)Uo(t,e),e=Gi(e.nextSibling);if(jo(t),13===t.tag){if(!(t=null!==(t=t.memoizedState)?t.dehydrated:null))throw Error(a(317));t:{for(t=t.nextSibling,e=0;t;){if(8===t.nodeType){var n=t.data;if("/$"===n){if(0===e){zo=Gi(t.nextSibling);break t}e--}else"$"!==n&&"$!"!==n&&"$?"!==n||e++}t=t.nextSibling}zo=null}}else zo=Io?Gi(t.stateNode.nextSibling):null;return!0}function Go(){zo=Io=null,No=!1}var Xo=[];function qo(){for(var t=0;t<Xo.length;t++)Xo[t]._workInProgressVersionPrimary=null;Xo.length=0}var Ko=b.ReactCurrentDispatcher,Qo=b.ReactCurrentBatchConfig,Yo=0,Zo=null,$o=null,Jo=null,ta=!1,ea=!1;function na(){throw Error(a(321))}function ia(t,e){if(null===e)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!si(t[n],e[n]))return!1;return!0}function ra(t,e,n,i,r,o){if(Yo=o,Zo=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Ko.current=null===t||null===t.memoizedState?Ra:Da,t=n(i,r),ea){o=0;do{if(ea=!1,!(25>o))throw Error(a(301));o+=1,Jo=$o=null,e.updateQueue=null,Ko.current=Ma,t=n(i,r)}while(ea)}if(Ko.current=Ta,e=null!==$o&&null!==$o.next,Yo=0,Jo=$o=Zo=null,ta=!1,e)throw Error(a(300));return t}function oa(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===Jo?Zo.memoizedState=Jo=t:Jo=Jo.next=t,Jo}function aa(){if(null===$o){var t=Zo.alternate;t=null!==t?t.memoizedState:null}else t=$o.next;var e=null===Jo?Zo.memoizedState:Jo.next;if(null!==e)Jo=e,$o=t;else{if(null===t)throw Error(a(310));t={memoizedState:($o=t).memoizedState,baseState:$o.baseState,baseQueue:$o.baseQueue,queue:$o.queue,next:null},null===Jo?Zo.memoizedState=Jo=t:Jo=Jo.next=t}return Jo}function sa(t,e){return"function"===typeof e?e(t):e}function la(t){var e=aa(),n=e.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=t;var i=$o,r=i.baseQueue,o=n.pending;if(null!==o){if(null!==r){var s=r.next;r.next=o.next,o.next=s}i.baseQueue=r=o,n.pending=null}if(null!==r){r=r.next,i=i.baseState;var l=s=o=null,u=r;do{var c=u.lane;if((Yo&c)===c)null!==l&&(l=l.next={lane:0,action:u.action,eagerReducer:u.eagerReducer,eagerState:u.eagerState,next:null}),i=u.eagerReducer===t?u.eagerState:t(i,u.action);else{var h={lane:c,action:u.action,eagerReducer:u.eagerReducer,eagerState:u.eagerState,next:null};null===l?(s=l=h,o=i):l=l.next=h,Zo.lanes|=c,zs|=c}u=u.next}while(null!==u&&u!==r);null===l?o=i:l.next=s,si(i,e.memoizedState)||(Ba=!0),e.memoizedState=i,e.baseState=o,e.baseQueue=l,n.lastRenderedState=i}return[e.memoizedState,n.dispatch]}function ua(t){var e=aa(),n=e.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=t;var i=n.dispatch,r=n.pending,o=e.memoizedState;if(null!==r){n.pending=null;var s=r=r.next;do{o=t(o,s.action),s=s.next}while(s!==r);si(o,e.memoizedState)||(Ba=!0),e.memoizedState=o,null===e.baseQueue&&(e.baseState=o),n.lastRenderedState=o}return[o,i]}function ca(t,e,n){var i=e._getVersion;i=i(e._source);var r=e._workInProgressVersionPrimary;if(null!==r?t=r===i:(t=t.mutableReadLanes,(t=(Yo&t)===t)&&(e._workInProgressVersionPrimary=i,Xo.push(e))),t)return n(e._source);throw Xo.push(e),Error(a(350))}function ha(t,e,n,i){var r=Rs;if(null===r)throw Error(a(349));var o=e._getVersion,s=o(e._source),l=Ko.current,u=l.useState((function(){return ca(r,e,n)})),c=u[1],h=u[0];u=Jo;var d=t.memoizedState,f=d.refs,p=f.getSnapshot,v=d.source;d=d.subscribe;var g=Zo;return t.memoizedState={refs:f,source:e,subscribe:i},l.useEffect((function(){f.getSnapshot=n,f.setSnapshot=c;var t=o(e._source);if(!si(s,t)){t=n(e._source),si(h,t)||(c(t),t=cl(g),r.mutableReadLanes|=t&r.pendingLanes),t=r.mutableReadLanes,r.entangledLanes|=t;for(var i=r.entanglements,a=t;0<a;){var l=31-Ve(a),u=1<<l;i[l]|=t,a&=~u}}}),[n,e,i]),l.useEffect((function(){return i(e._source,(function(){var t=f.getSnapshot,n=f.setSnapshot;try{n(t(e._source));var i=cl(g);r.mutableReadLanes|=i&r.pendingLanes}catch(o){n((function(){throw o}))}}))}),[e,i]),si(p,n)&&si(v,e)&&si(d,i)||((t={pending:null,dispatch:null,lastRenderedReducer:sa,lastRenderedState:h}).dispatch=c=Aa.bind(null,Zo,t),u.queue=t,u.baseQueue=null,h=ca(r,e,n),u.memoizedState=u.baseState=h),h}function da(t,e,n){return ha(aa(),t,e,n)}function fa(t){var e=oa();return"function"===typeof t&&(t=t()),e.memoizedState=e.baseState=t,t=(t=e.queue={pending:null,dispatch:null,lastRenderedReducer:sa,lastRenderedState:t}).dispatch=Aa.bind(null,Zo,t),[e.memoizedState,t]}function pa(t,e,n,i){return t={tag:t,create:e,destroy:n,deps:i,next:null},null===(e=Zo.updateQueue)?(e={lastEffect:null},Zo.updateQueue=e,e.lastEffect=t.next=t):null===(n=e.lastEffect)?e.lastEffect=t.next=t:(i=n.next,n.next=t,t.next=i,e.lastEffect=t),t}function va(t){return t={current:t},oa().memoizedState=t}function ga(){return aa().memoizedState}function ya(t,e,n,i){var r=oa();Zo.flags|=t,r.memoizedState=pa(1|e,n,void 0,void 0===i?null:i)}function ma(t,e,n,i){var r=aa();i=void 0===i?null:i;var o=void 0;if(null!==$o){var a=$o.memoizedState;if(o=a.destroy,null!==i&&ia(i,a.deps))return void pa(e,n,o,i)}Zo.flags|=t,r.memoizedState=pa(1|e,n,o,i)}function _a(t,e){return ya(516,4,t,e)}function wa(t,e){return ma(516,4,t,e)}function ba(t,e){return ma(4,2,t,e)}function ka(t,e){return"function"===typeof e?(t=t(),e(t),function(){e(null)}):null!==e&&void 0!==e?(t=t(),e.current=t,function(){e.current=null}):void 0}function xa(t,e,n){return n=null!==n&&void 0!==n?n.concat([t]):null,ma(4,2,ka.bind(null,e,t),n)}function Ca(){}function Sa(t,e){var n=aa();e=void 0===e?null:e;var i=n.memoizedState;return null!==i&&null!==e&&ia(e,i[1])?i[0]:(n.memoizedState=[t,e],t)}function Ea(t,e){var n=aa();e=void 0===e?null:e;var i=n.memoizedState;return null!==i&&null!==e&&ia(e,i[1])?i[0]:(t=t(),n.memoizedState=[t,e],t)}function Pa(t,e){var n=Hr();jr(98>n?98:n,(function(){t(!0)})),jr(97<n?97:n,(function(){var n=Qo.transition;Qo.transition=1;try{t(!1),e()}finally{Qo.transition=n}}))}function Aa(t,e,n){var i=ul(),r=cl(t),o={lane:r,action:n,eagerReducer:null,eagerState:null,next:null},a=e.pending;if(null===a?o.next=o:(o.next=a.next,a.next=o),e.pending=o,a=t.alternate,t===Zo||null!==a&&a===Zo)ea=ta=!0;else{if(0===t.lanes&&(null===a||0===a.lanes)&&null!==(a=e.lastRenderedReducer))try{var s=e.lastRenderedState,l=a(s,n);if(o.eagerReducer=a,o.eagerState=l,si(l,s))return}catch(u){}hl(t,r,i)}}var Ta={readContext:io,useCallback:na,useContext:na,useEffect:na,useImperativeHandle:na,useLayoutEffect:na,useMemo:na,useReducer:na,useRef:na,useState:na,useDebugValue:na,useDeferredValue:na,useTransition:na,useMutableSource:na,useOpaqueIdentifier:na,unstable_isNewReconciler:!1},Ra={readContext:io,useCallback:function(t,e){return oa().memoizedState=[t,void 0===e?null:e],t},useContext:io,useEffect:_a,useImperativeHandle:function(t,e,n){return n=null!==n&&void 0!==n?n.concat([t]):null,ya(4,2,ka.bind(null,e,t),n)},useLayoutEffect:function(t,e){return ya(4,2,t,e)},useMemo:function(t,e){var n=oa();return e=void 0===e?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var i=oa();return e=void 0!==n?n(e):e,i.memoizedState=i.baseState=e,t=(t=i.queue={pending:null,dispatch:null,lastRenderedReducer:t,lastRenderedState:e}).dispatch=Aa.bind(null,Zo,t),[i.memoizedState,t]},useRef:va,useState:fa,useDebugValue:Ca,useDeferredValue:function(t){var e=fa(t),n=e[0],i=e[1];return _a((function(){var e=Qo.transition;Qo.transition=1;try{i(t)}finally{Qo.transition=e}}),[t]),n},useTransition:function(){var t=fa(!1),e=t[0];return va(t=Pa.bind(null,t[1])),[t,e]},useMutableSource:function(t,e,n){var i=oa();return i.memoizedState={refs:{getSnapshot:e,setSnapshot:null},source:t,subscribe:n},ha(i,t,e,n)},useOpaqueIdentifier:function(){if(No){var t=!1,e=function(t){return{$$typeof:O,toString:t,valueOf:t}}((function(){throw t||(t=!0,n("r:"+(qi++).toString(36))),Error(a(355))})),n=fa(e)[1];return 0===(2&Zo.mode)&&(Zo.flags|=516,pa(5,(function(){n("r:"+(qi++).toString(36))}),void 0,null)),e}return fa(e="r:"+(qi++).toString(36)),e},unstable_isNewReconciler:!1},Da={readContext:io,useCallback:Sa,useContext:io,useEffect:wa,useImperativeHandle:xa,useLayoutEffect:ba,useMemo:Ea,useReducer:la,useRef:ga,useState:function(){return la(sa)},useDebugValue:Ca,useDeferredValue:function(t){var e=la(sa),n=e[0],i=e[1];return wa((function(){var e=Qo.transition;Qo.transition=1;try{i(t)}finally{Qo.transition=e}}),[t]),n},useTransition:function(){var t=la(sa)[0];return[ga().current,t]},useMutableSource:da,useOpaqueIdentifier:function(){return la(sa)[0]},unstable_isNewReconciler:!1},Ma={readContext:io,useCallback:Sa,useContext:io,useEffect:wa,useImperativeHandle:xa,useLayoutEffect:ba,useMemo:Ea,useReducer:ua,useRef:ga,useState:function(){return ua(sa)},useDebugValue:Ca,useDeferredValue:function(t){var e=ua(sa),n=e[0],i=e[1];return wa((function(){var e=Qo.transition;Qo.transition=1;try{i(t)}finally{Qo.transition=e}}),[t]),n},useTransition:function(){var t=ua(sa)[0];return[ga().current,t]},useMutableSource:da,useOpaqueIdentifier:function(){return ua(sa)[0]},unstable_isNewReconciler:!1},La=b.ReactCurrentOwner,Ba=!1;function Oa(t,e,n,i){e.child=null===t?So(e,null,n,i):Co(e,t.child,n,i)}function Fa(t,e,n,i,r){n=n.render;var o=e.ref;return no(e,r),i=ra(t,e,n,i,o,r),null===t||Ba?(e.flags|=1,Oa(t,e,i,r),e.child):(e.updateQueue=t.updateQueue,e.flags&=-517,t.lanes&=~r,ns(t,e,r))}function Ia(t,e,n,i,r,o){if(null===t){var a=n.type;return"function"!==typeof a||Wl(a)||void 0!==a.defaultProps||null!==n.compare||void 0!==n.defaultProps?((t=Vl(n.type,null,i,e,e.mode,o)).ref=e.ref,t.return=e,e.child=t):(e.tag=15,e.type=a,za(t,e,a,i,r,o))}return a=t.child,0===(r&o)&&(r=a.memoizedProps,(n=null!==(n=n.compare)?n:ui)(r,i)&&t.ref===e.ref)?ns(t,e,o):(e.flags|=1,(t=jl(a,i)).ref=e.ref,t.return=e,e.child=t)}function za(t,e,n,i,r,o){if(null!==t&&ui(t.memoizedProps,i)&&t.ref===e.ref){if(Ba=!1,0===(o&r))return e.lanes=t.lanes,ns(t,e,o);0!==(16384&t.flags)&&(Ba=!0)}return Ha(t,e,n,i,o)}function Na(t,e,n){var i=e.pendingProps,r=i.children,o=null!==t?t.memoizedState:null;if("hidden"===i.mode||"unstable-defer-without-hiding"===i.mode)if(0===(4&e.mode))e.memoizedState={baseLanes:0},_l(e,n);else{if(0===(1073741824&n))return t=null!==o?o.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t},_l(e,t),null;e.memoizedState={baseLanes:0},_l(e,null!==o?o.baseLanes:n)}else null!==o?(i=o.baseLanes|n,e.memoizedState=null):i=n,_l(e,i);return Oa(t,e,r,n),e.child}function Ua(t,e){var n=e.ref;(null===t&&null!==n||null!==t&&t.ref!==n)&&(e.flags|=128)}function Ha(t,e,n,i,r){var o=pr(n)?dr:cr.current;return o=fr(e,o),no(e,r),n=ra(t,e,n,i,o,r),null===t||Ba?(e.flags|=1,Oa(t,e,n,r),e.child):(e.updateQueue=t.updateQueue,e.flags&=-517,t.lanes&=~r,ns(t,e,r))}function Wa(t,e,n,i,r){if(pr(n)){var o=!0;mr(e)}else o=!1;if(no(e,r),null===e.stateNode)null!==t&&(t.alternate=null,e.alternate=null,e.flags|=2),yo(e,n,i),_o(e,n,i,r),i=!0;else if(null===t){var a=e.stateNode,s=e.memoizedProps;a.props=s;var l=a.context,u=n.contextType;"object"===typeof u&&null!==u?u=io(u):u=fr(e,u=pr(n)?dr:cr.current);var c=n.getDerivedStateFromProps,h="function"===typeof c||"function"===typeof a.getSnapshotBeforeUpdate;h||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(s!==i||l!==u)&&mo(e,a,i,u),ro=!1;var d=e.memoizedState;a.state=d,co(e,i,a,r),l=e.memoizedState,s!==i||d!==l||hr.current||ro?("function"===typeof c&&(po(e,n,c,i),l=e.memoizedState),(s=ro||go(e,n,s,i,d,l,u))?(h||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||("function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"===typeof a.componentDidMount&&(e.flags|=4)):("function"===typeof a.componentDidMount&&(e.flags|=4),e.memoizedProps=i,e.memoizedState=l),a.props=i,a.state=l,a.context=u,i=s):("function"===typeof a.componentDidMount&&(e.flags|=4),i=!1)}else{a=e.stateNode,ao(t,e),s=e.memoizedProps,u=e.type===e.elementType?s:Kr(e.type,s),a.props=u,h=e.pendingProps,d=a.context,"object"===typeof(l=n.contextType)&&null!==l?l=io(l):l=fr(e,l=pr(n)?dr:cr.current);var f=n.getDerivedStateFromProps;(c="function"===typeof f||"function"===typeof a.getSnapshotBeforeUpdate)||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(s!==h||d!==l)&&mo(e,a,i,l),ro=!1,d=e.memoizedState,a.state=d,co(e,i,a,r);var p=e.memoizedState;s!==h||d!==p||hr.current||ro?("function"===typeof f&&(po(e,n,f,i),p=e.memoizedState),(u=ro||go(e,n,u,i,d,p,l))?(c||"function"!==typeof a.UNSAFE_componentWillUpdate&&"function"!==typeof a.componentWillUpdate||("function"===typeof a.componentWillUpdate&&a.componentWillUpdate(i,p,l),"function"===typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(i,p,l)),"function"===typeof a.componentDidUpdate&&(e.flags|=4),"function"===typeof a.getSnapshotBeforeUpdate&&(e.flags|=256)):("function"!==typeof a.componentDidUpdate||s===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||s===t.memoizedProps&&d===t.memoizedState||(e.flags|=256),e.memoizedProps=i,e.memoizedState=p),a.props=i,a.state=p,a.context=l,i=u):("function"!==typeof a.componentDidUpdate||s===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||s===t.memoizedProps&&d===t.memoizedState||(e.flags|=256),i=!1)}return ja(t,e,n,i,o,r)}function ja(t,e,n,i,r,o){Ua(t,e);var a=0!==(64&e.flags);if(!i&&!a)return r&&_r(e,n,!1),ns(t,e,o);i=e.stateNode,La.current=e;var s=a&&"function"!==typeof n.getDerivedStateFromError?null:i.render();return e.flags|=1,null!==t&&a?(e.child=Co(e,t.child,null,o),e.child=Co(e,null,s,o)):Oa(t,e,s,o),e.memoizedState=i.state,r&&_r(e,n,!0),e.child}function Va(t){var e=t.stateNode;e.pendingContext?gr(0,e.pendingContext,e.pendingContext!==e.context):e.context&&gr(0,e.context,!1),Do(t,e.containerInfo)}var Ga,Xa,qa,Ka={dehydrated:null,retryLane:0};function Qa(t,e,n){var i,r=e.pendingProps,o=Oo.current,a=!1;return(i=0!==(64&e.flags))||(i=(null===t||null!==t.memoizedState)&&0!==(2&o)),i?(a=!0,e.flags&=-65):null!==t&&null===t.memoizedState||void 0===r.fallback||!0===r.unstable_avoidThisFallback||(o|=1),lr(Oo,1&o),null===t?(void 0!==r.fallback&&Wo(e),t=r.children,o=r.fallback,a?(t=Ya(e,t,o,n),e.child.memoizedState={baseLanes:n},e.memoizedState=Ka,t):"number"===typeof r.unstable_expectedLoadTime?(t=Ya(e,t,o,n),e.child.memoizedState={baseLanes:n},e.memoizedState=Ka,e.lanes=33554432,t):((n=Xl({mode:"visible",children:t},e.mode,n,null)).return=e,e.child=n)):(t.memoizedState,a?(r=$a(t,e,r.children,r.fallback,n),a=e.child,o=t.child.memoizedState,a.memoizedState=null===o?{baseLanes:n}:{baseLanes:o.baseLanes|n},a.childLanes=t.childLanes&~n,e.memoizedState=Ka,r):(n=Za(t,e,r.children,n),e.memoizedState=null,n))}function Ya(t,e,n,i){var r=t.mode,o=t.child;return e={mode:"hidden",children:e},0===(2&r)&&null!==o?(o.childLanes=0,o.pendingProps=e):o=Xl(e,r,0,null),n=Gl(n,r,i,null),o.return=t,n.return=t,o.sibling=n,t.child=o,n}function Za(t,e,n,i){var r=t.child;return t=r.sibling,n=jl(r,{mode:"visible",children:n}),0===(2&e.mode)&&(n.lanes=i),n.return=e,n.sibling=null,null!==t&&(t.nextEffect=null,t.flags=8,e.firstEffect=e.lastEffect=t),e.child=n}function $a(t,e,n,i,r){var o=e.mode,a=t.child;t=a.sibling;var s={mode:"hidden",children:n};return 0===(2&o)&&e.child!==a?((n=e.child).childLanes=0,n.pendingProps=s,null!==(a=n.lastEffect)?(e.firstEffect=n.firstEffect,e.lastEffect=a,a.nextEffect=null):e.firstEffect=e.lastEffect=null):n=jl(a,s),null!==t?i=jl(t,i):(i=Gl(i,o,r,null)).flags|=2,i.return=e,n.return=e,n.sibling=i,e.child=n,i}function Ja(t,e){t.lanes|=e;var n=t.alternate;null!==n&&(n.lanes|=e),eo(t.return,e)}function ts(t,e,n,i,r,o){var a=t.memoizedState;null===a?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r,lastEffect:o}:(a.isBackwards=e,a.rendering=null,a.renderingStartTime=0,a.last=i,a.tail=n,a.tailMode=r,a.lastEffect=o)}function es(t,e,n){var i=e.pendingProps,r=i.revealOrder,o=i.tail;if(Oa(t,e,i.children,n),0!==(2&(i=Oo.current)))i=1&i|2,e.flags|=64;else{if(null!==t&&0!==(64&t.flags))t:for(t=e.child;null!==t;){if(13===t.tag)null!==t.memoizedState&&Ja(t,n);else if(19===t.tag)Ja(t,n);else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break t;for(;null===t.sibling;){if(null===t.return||t.return===e)break t;t=t.return}t.sibling.return=t.return,t=t.sibling}i&=1}if(lr(Oo,i),0===(2&e.mode))e.memoizedState=null;else switch(r){case"forwards":for(n=e.child,r=null;null!==n;)null!==(t=n.alternate)&&null===Fo(t)&&(r=n),n=n.sibling;null===(n=r)?(r=e.child,e.child=null):(r=n.sibling,n.sibling=null),ts(e,!1,r,n,o,e.lastEffect);break;case"backwards":for(n=null,r=e.child,e.child=null;null!==r;){if(null!==(t=r.alternate)&&null===Fo(t)){e.child=r;break}t=r.sibling,r.sibling=n,n=r,r=t}ts(e,!0,n,null,o,e.lastEffect);break;case"together":ts(e,!1,null,null,void 0,e.lastEffect);break;default:e.memoizedState=null}return e.child}function ns(t,e,n){if(null!==t&&(e.dependencies=t.dependencies),zs|=e.lanes,0!==(n&e.childLanes)){if(null!==t&&e.child!==t.child)throw Error(a(153));if(null!==e.child){for(n=jl(t=e.child,t.pendingProps),e.child=n,n.return=e;null!==t.sibling;)t=t.sibling,(n=n.sibling=jl(t,t.pendingProps)).return=e;n.sibling=null}return e.child}return null}function is(t,e){if(!No)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;null!==e;)null!==e.alternate&&(n=e),e=e.sibling;null===n?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var i=null;null!==n;)null!==n.alternate&&(i=n),n=n.sibling;null===i?e||null===t.tail?t.tail=null:t.tail.sibling=null:i.sibling=null}}function rs(t,e,n){var i=e.pendingProps;switch(e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:return pr(e.type)&&vr(),null;case 3:return Mo(),sr(hr),sr(cr),qo(),(i=e.stateNode).pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),null!==t&&null!==t.child||(Vo(e)?e.flags|=4:i.hydrate||(e.flags|=256)),null;case 5:Bo(e);var o=Ro(To.current);if(n=e.type,null!==t&&null!=e.stateNode)Xa(t,e,n,i),t.ref!==e.ref&&(e.flags|=128);else{if(!i){if(null===e.stateNode)throw Error(a(166));return null}if(t=Ro(Po.current),Vo(e)){i=e.stateNode,n=e.type;var s=e.memoizedProps;switch(i[Qi]=e,i[Yi]=s,n){case"dialog":Pi("cancel",i),Pi("close",i);break;case"iframe":case"object":case"embed":Pi("load",i);break;case"video":case"audio":for(t=0;t<xi.length;t++)Pi(xi[t],i);break;case"source":Pi("error",i);break;case"img":case"image":case"link":Pi("error",i),Pi("load",i);break;case"details":Pi("toggle",i);break;case"input":tt(i,s),Pi("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!s.multiple},Pi("invalid",i);break;case"textarea":lt(i,s),Pi("invalid",i)}for(var u in Ct(n,s),t=null,s)s.hasOwnProperty(u)&&(o=s[u],"children"===u?"string"===typeof o?i.textContent!==o&&(t=["children",o]):"number"===typeof o&&i.textContent!==""+o&&(t=["children",""+o]):l.hasOwnProperty(u)&&null!=o&&"onScroll"===u&&Pi("scroll",i));switch(n){case"input":Y(i),it(i,s,!0);break;case"textarea":Y(i),ct(i);break;case"select":case"option":break;default:"function"===typeof s.onClick&&(i.onclick=Ii)}i=t,e.updateQueue=i,null!==i&&(e.flags|=4)}else{switch(u=9===o.nodeType?o:o.ownerDocument,t===ht&&(t=ft(n)),t===ht?"script"===n?((t=u.createElement("div")).innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):"string"===typeof i.is?t=u.createElement(n,{is:i.is}):(t=u.createElement(n),"select"===n&&(u=t,i.multiple?u.multiple=!0:i.size&&(u.size=i.size))):t=u.createElementNS(t,n),t[Qi]=e,t[Yi]=i,Ga(t,e),e.stateNode=t,u=St(n,i),n){case"dialog":Pi("cancel",t),Pi("close",t),o=i;break;case"iframe":case"object":case"embed":Pi("load",t),o=i;break;case"video":case"audio":for(o=0;o<xi.length;o++)Pi(xi[o],t);o=i;break;case"source":Pi("error",t),o=i;break;case"img":case"image":case"link":Pi("error",t),Pi("load",t),o=i;break;case"details":Pi("toggle",t),o=i;break;case"input":tt(t,i),o=J(t,i),Pi("invalid",t);break;case"option":o=ot(t,i);break;case"select":t._wrapperState={wasMultiple:!!i.multiple},o=r({},i,{value:void 0}),Pi("invalid",t);break;case"textarea":lt(t,i),o=st(t,i),Pi("invalid",t);break;default:o=i}Ct(n,o);var c=o;for(s in c)if(c.hasOwnProperty(s)){var h=c[s];"style"===s?kt(t,h):"dangerouslySetInnerHTML"===s?null!=(h=h?h.__html:void 0)&&yt(t,h):"children"===s?"string"===typeof h?("textarea"!==n||""!==h)&&mt(t,h):"number"===typeof h&&mt(t,""+h):"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&"autoFocus"!==s&&(l.hasOwnProperty(s)?null!=h&&"onScroll"===s&&Pi("scroll",t):null!=h&&w(t,s,h,u))}switch(n){case"input":Y(t),it(t,i,!1);break;case"textarea":Y(t),ct(t);break;case"option":null!=i.value&&t.setAttribute("value",""+K(i.value));break;case"select":t.multiple=!!i.multiple,null!=(s=i.value)?at(t,!!i.multiple,s,!1):null!=i.defaultValue&&at(t,!!i.multiple,i.defaultValue,!0);break;default:"function"===typeof o.onClick&&(t.onclick=Ii)}Ui(n,i)&&(e.flags|=4)}null!==e.ref&&(e.flags|=128)}return null;case 6:if(t&&null!=e.stateNode)qa(0,e,t.memoizedProps,i);else{if("string"!==typeof i&&null===e.stateNode)throw Error(a(166));n=Ro(To.current),Ro(Po.current),Vo(e)?(i=e.stateNode,n=e.memoizedProps,i[Qi]=e,i.nodeValue!==n&&(e.flags|=4)):((i=(9===n.nodeType?n:n.ownerDocument).createTextNode(i))[Qi]=e,e.stateNode=i)}return null;case 13:return sr(Oo),i=e.memoizedState,0!==(64&e.flags)?(e.lanes=n,e):(i=null!==i,n=!1,null===t?void 0!==e.memoizedProps.fallback&&Vo(e):n=null!==t.memoizedState,i&&!n&&0!==(2&e.mode)&&(null===t&&!0!==e.memoizedProps.unstable_avoidThisFallback||0!==(1&Oo.current)?0===Os&&(Os=3):(0!==Os&&3!==Os||(Os=4),null===Rs||0===(134217727&zs)&&0===(134217727&Ns)||vl(Rs,Ms))),(i||n)&&(e.flags|=4),null);case 4:return Mo(),null===t&&Ti(e.stateNode.containerInfo),null;case 10:return to(e),null;case 17:return pr(e.type)&&vr(),null;case 19:if(sr(Oo),null===(i=e.memoizedState))return null;if(s=0!==(64&e.flags),null===(u=i.rendering))if(s)is(i,!1);else{if(0!==Os||null!==t&&0!==(64&t.flags))for(t=e.child;null!==t;){if(null!==(u=Fo(t))){for(e.flags|=64,is(i,!1),null!==(s=u.updateQueue)&&(e.updateQueue=s,e.flags|=4),null===i.lastEffect&&(e.firstEffect=null),e.lastEffect=i.lastEffect,i=n,n=e.child;null!==n;)t=i,(s=n).flags&=2,s.nextEffect=null,s.firstEffect=null,s.lastEffect=null,null===(u=s.alternate)?(s.childLanes=0,s.lanes=t,s.child=null,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=u.childLanes,s.lanes=u.lanes,s.child=u.child,s.memoizedProps=u.memoizedProps,s.memoizedState=u.memoizedState,s.updateQueue=u.updateQueue,s.type=u.type,t=u.dependencies,s.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return lr(Oo,1&Oo.current|2),e.child}t=t.sibling}null!==i.tail&&Ur()>js&&(e.flags|=64,s=!0,is(i,!1),e.lanes=33554432)}else{if(!s)if(null!==(t=Fo(u))){if(e.flags|=64,s=!0,null!==(n=t.updateQueue)&&(e.updateQueue=n,e.flags|=4),is(i,!0),null===i.tail&&"hidden"===i.tailMode&&!u.alternate&&!No)return null!==(e=e.lastEffect=i.lastEffect)&&(e.nextEffect=null),null}else 2*Ur()-i.renderingStartTime>js&&1073741824!==n&&(e.flags|=64,s=!0,is(i,!1),e.lanes=33554432);i.isBackwards?(u.sibling=e.child,e.child=u):(null!==(n=i.last)?n.sibling=u:e.child=u,i.last=u)}return null!==i.tail?(n=i.tail,i.rendering=n,i.tail=n.sibling,i.lastEffect=e.lastEffect,i.renderingStartTime=Ur(),n.sibling=null,e=Oo.current,lr(Oo,s?1&e|2:1&e),n):null;case 23:case 24:return wl(),null!==t&&null!==t.memoizedState!==(null!==e.memoizedState)&&"unstable-defer-without-hiding"!==i.mode&&(e.flags|=4),null}throw Error(a(156,e.tag))}function os(t){switch(t.tag){case 1:pr(t.type)&&vr();var e=t.flags;return 4096&e?(t.flags=-4097&e|64,t):null;case 3:if(Mo(),sr(hr),sr(cr),qo(),0!==(64&(e=t.flags)))throw Error(a(285));return t.flags=-4097&e|64,t;case 5:return Bo(t),null;case 13:return sr(Oo),4096&(e=t.flags)?(t.flags=-4097&e|64,t):null;case 19:return sr(Oo),null;case 4:return Mo(),null;case 10:return to(t),null;case 23:case 24:return wl(),null;default:return null}}function as(t,e){try{var n="",i=e;do{n+=X(i),i=i.return}while(i);var r=n}catch(o){r="\nError generating stack: "+o.message+"\n"+o.stack}return{value:t,source:e,stack:r}}function ss(t,e){try{console.error(e.value)}catch(n){setTimeout((function(){throw n}))}}Ga=function(t,e){for(var n=e.child;null!==n;){if(5===n.tag||6===n.tag)t.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===e)break;for(;null===n.sibling;){if(null===n.return||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Xa=function(t,e,n,i){var o=t.memoizedProps;if(o!==i){t=e.stateNode,Ro(Po.current);var a,s=null;switch(n){case"input":o=J(t,o),i=J(t,i),s=[];break;case"option":o=ot(t,o),i=ot(t,i),s=[];break;case"select":o=r({},o,{value:void 0}),i=r({},i,{value:void 0}),s=[];break;case"textarea":o=st(t,o),i=st(t,i),s=[];break;default:"function"!==typeof o.onClick&&"function"===typeof i.onClick&&(t.onclick=Ii)}for(h in Ct(n,i),n=null,o)if(!i.hasOwnProperty(h)&&o.hasOwnProperty(h)&&null!=o[h])if("style"===h){var u=o[h];for(a in u)u.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else"dangerouslySetInnerHTML"!==h&&"children"!==h&&"suppressContentEditableWarning"!==h&&"suppressHydrationWarning"!==h&&"autoFocus"!==h&&(l.hasOwnProperty(h)?s||(s=[]):(s=s||[]).push(h,null));for(h in i){var c=i[h];if(u=null!=o?o[h]:void 0,i.hasOwnProperty(h)&&c!==u&&(null!=c||null!=u))if("style"===h)if(u){for(a in u)!u.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in c)c.hasOwnProperty(a)&&u[a]!==c[a]&&(n||(n={}),n[a]=c[a])}else n||(s||(s=[]),s.push(h,n)),n=c;else"dangerouslySetInnerHTML"===h?(c=c?c.__html:void 0,u=u?u.__html:void 0,null!=c&&u!==c&&(s=s||[]).push(h,c)):"children"===h?"string"!==typeof c&&"number"!==typeof c||(s=s||[]).push(h,""+c):"suppressContentEditableWarning"!==h&&"suppressHydrationWarning"!==h&&(l.hasOwnProperty(h)?(null!=c&&"onScroll"===h&&Pi("scroll",t),s||u===c||(s=[])):"object"===typeof c&&null!==c&&c.$$typeof===O?c.toString():(s=s||[]).push(h,c))}n&&(s=s||[]).push("style",n);var h=s;(e.updateQueue=h)&&(e.flags|=4)}},qa=function(t,e,n,i){n!==i&&(e.flags|=4)};var ls="function"===typeof WeakMap?WeakMap:Map;function us(t,e,n){(n=so(-1,n)).tag=3,n.payload={element:null};var i=e.value;return n.callback=function(){qs||(qs=!0,Ks=i),ss(0,e)},n}function cs(t,e,n){(n=so(-1,n)).tag=3;var i=t.type.getDerivedStateFromError;if("function"===typeof i){var r=e.value;n.payload=function(){return ss(0,e),i(r)}}var o=t.stateNode;return null!==o&&"function"===typeof o.componentDidCatch&&(n.callback=function(){"function"!==typeof i&&(null===Qs?Qs=new Set([this]):Qs.add(this),ss(0,e));var t=e.stack;this.componentDidCatch(e.value,{componentStack:null!==t?t:""})}),n}var hs="function"===typeof WeakSet?WeakSet:Set;function ds(t){var e=t.ref;if(null!==e)if("function"===typeof e)try{e(null)}catch(n){Il(t,n)}else e.current=null}function fs(t,e){switch(e.tag){case 0:case 11:case 15:case 22:return;case 1:if(256&e.flags&&null!==t){var n=t.memoizedProps,i=t.memoizedState;e=(t=e.stateNode).getSnapshotBeforeUpdate(e.elementType===e.type?n:Kr(e.type,n),i),t.__reactInternalSnapshotBeforeUpdate=e}return;case 3:return void(256&e.flags&&Vi(e.stateNode.containerInfo));case 5:case 6:case 4:case 17:return}throw Error(a(163))}function ps(t,e,n){switch(n.tag){case 0:case 11:case 15:case 22:if(null!==(e=null!==(e=n.updateQueue)?e.lastEffect:null)){t=e=e.next;do{if(3===(3&t.tag)){var i=t.create;t.destroy=i()}t=t.next}while(t!==e)}if(null!==(e=null!==(e=n.updateQueue)?e.lastEffect:null)){t=e=e.next;do{var r=t;i=r.next,0!==(4&(r=r.tag))&&0!==(1&r)&&(Bl(n,t),Ll(n,t)),t=i}while(t!==e)}return;case 1:return t=n.stateNode,4&n.flags&&(null===e?t.componentDidMount():(i=n.elementType===n.type?e.memoizedProps:Kr(n.type,e.memoizedProps),t.componentDidUpdate(i,e.memoizedState,t.__reactInternalSnapshotBeforeUpdate))),void(null!==(e=n.updateQueue)&&ho(n,e,t));case 3:if(null!==(e=n.updateQueue)){if(t=null,null!==n.child)switch(n.child.tag){case 5:t=n.child.stateNode;break;case 1:t=n.child.stateNode}ho(n,e,t)}return;case 5:return t=n.stateNode,void(null===e&&4&n.flags&&Ui(n.type,n.memoizedProps)&&t.focus());case 6:case 4:case 12:return;case 13:return void(null===n.memoizedState&&(n=n.alternate,null!==n&&(n=n.memoizedState,null!==n&&(n=n.dehydrated,null!==n&&ke(n)))));case 19:case 17:case 20:case 21:case 23:case 24:return}throw Error(a(163))}function vs(t,e){for(var n=t;;){if(5===n.tag){var i=n.stateNode;if(e)"function"===typeof(i=i.style).setProperty?i.setProperty("display","none","important"):i.display="none";else{i=n.stateNode;var r=n.memoizedProps.style;r=void 0!==r&&null!==r&&r.hasOwnProperty("display")?r.display:null,i.style.display=bt("display",r)}}else if(6===n.tag)n.stateNode.nodeValue=e?"":n.memoizedProps;else if((23!==n.tag&&24!==n.tag||null===n.memoizedState||n===t)&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}}function gs(t,e){if(br&&"function"===typeof br.onCommitFiberUnmount)try{br.onCommitFiberUnmount(wr,e)}catch(o){}switch(e.tag){case 0:case 11:case 14:case 15:case 22:if(null!==(t=e.updateQueue)&&null!==(t=t.lastEffect)){var n=t=t.next;do{var i=n,r=i.destroy;if(i=i.tag,void 0!==r)if(0!==(4&i))Bl(e,n);else{i=e;try{r()}catch(o){Il(i,o)}}n=n.next}while(n!==t)}break;case 1:if(ds(e),"function"===typeof(t=e.stateNode).componentWillUnmount)try{t.props=e.memoizedProps,t.state=e.memoizedState,t.componentWillUnmount()}catch(o){Il(e,o)}break;case 5:ds(e);break;case 4:ks(t,e)}}function ys(t){t.alternate=null,t.child=null,t.dependencies=null,t.firstEffect=null,t.lastEffect=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.return=null,t.updateQueue=null}function ms(t){return 5===t.tag||3===t.tag||4===t.tag}function _s(t){t:{for(var e=t.return;null!==e;){if(ms(e))break t;e=e.return}throw Error(a(160))}var n=e;switch(e=n.stateNode,n.tag){case 5:var i=!1;break;case 3:case 4:e=e.containerInfo,i=!0;break;default:throw Error(a(161))}16&n.flags&&(mt(e,""),n.flags&=-17);t:e:for(n=t;;){for(;null===n.sibling;){if(null===n.return||ms(n.return)){n=null;break t}n=n.return}for(n.sibling.return=n.return,n=n.sibling;5!==n.tag&&6!==n.tag&&18!==n.tag;){if(2&n.flags)continue e;if(null===n.child||4===n.tag)continue e;n.child.return=n,n=n.child}if(!(2&n.flags)){n=n.stateNode;break t}}i?ws(t,n,e):bs(t,n,e)}function ws(t,e,n){var i=t.tag,r=5===i||6===i;if(r)t=r?t.stateNode:t.stateNode.instance,e?8===n.nodeType?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(8===n.nodeType?(e=n.parentNode).insertBefore(t,n):(e=n).appendChild(t),null!==(n=n._reactRootContainer)&&void 0!==n||null!==e.onclick||(e.onclick=Ii));else if(4!==i&&null!==(t=t.child))for(ws(t,e,n),t=t.sibling;null!==t;)ws(t,e,n),t=t.sibling}function bs(t,e,n){var i=t.tag,r=5===i||6===i;if(r)t=r?t.stateNode:t.stateNode.instance,e?n.insertBefore(t,e):n.appendChild(t);else if(4!==i&&null!==(t=t.child))for(bs(t,e,n),t=t.sibling;null!==t;)bs(t,e,n),t=t.sibling}function ks(t,e){for(var n,i,r=e,o=!1;;){if(!o){o=r.return;t:for(;;){if(null===o)throw Error(a(160));switch(n=o.stateNode,o.tag){case 5:i=!1;break t;case 3:case 4:n=n.containerInfo,i=!0;break t}o=o.return}o=!0}if(5===r.tag||6===r.tag){t:for(var s=t,l=r,u=l;;)if(gs(s,u),null!==u.child&&4!==u.tag)u.child.return=u,u=u.child;else{if(u===l)break t;for(;null===u.sibling;){if(null===u.return||u.return===l)break t;u=u.return}u.sibling.return=u.return,u=u.sibling}i?(s=n,l=r.stateNode,8===s.nodeType?s.parentNode.removeChild(l):s.removeChild(l)):n.removeChild(r.stateNode)}else if(4===r.tag){if(null!==r.child){n=r.stateNode.containerInfo,i=!0,r.child.return=r,r=r.child;continue}}else if(gs(t,r),null!==r.child){r.child.return=r,r=r.child;continue}if(r===e)break;for(;null===r.sibling;){if(null===r.return||r.return===e)return;4===(r=r.return).tag&&(o=!1)}r.sibling.return=r.return,r=r.sibling}}function xs(t,e){switch(e.tag){case 0:case 11:case 14:case 15:case 22:var n=e.updateQueue;if(null!==(n=null!==n?n.lastEffect:null)){var i=n=n.next;do{3===(3&i.tag)&&(t=i.destroy,i.destroy=void 0,void 0!==t&&t()),i=i.next}while(i!==n)}return;case 1:return;case 5:if(null!=(n=e.stateNode)){i=e.memoizedProps;var r=null!==t?t.memoizedProps:i;t=e.type;var o=e.updateQueue;if(e.updateQueue=null,null!==o){for(n[Yi]=i,"input"===t&&"radio"===i.type&&null!=i.name&&et(n,i),St(t,r),e=St(t,i),r=0;r<o.length;r+=2){var s=o[r],l=o[r+1];"style"===s?kt(n,l):"dangerouslySetInnerHTML"===s?yt(n,l):"children"===s?mt(n,l):w(n,s,l,e)}switch(t){case"input":nt(n,i);break;case"textarea":ut(n,i);break;case"select":t=n._wrapperState.wasMultiple,n._wrapperState.wasMultiple=!!i.multiple,null!=(o=i.value)?at(n,!!i.multiple,o,!1):t!==!!i.multiple&&(null!=i.defaultValue?at(n,!!i.multiple,i.defaultValue,!0):at(n,!!i.multiple,i.multiple?[]:"",!1))}}}return;case 6:if(null===e.stateNode)throw Error(a(162));return void(e.stateNode.nodeValue=e.memoizedProps);case 3:return void((n=e.stateNode).hydrate&&(n.hydrate=!1,ke(n.containerInfo)));case 12:return;case 13:return null!==e.memoizedState&&(Ws=Ur(),vs(e.child,!0)),void Cs(e);case 19:return void Cs(e);case 17:return;case 23:case 24:return void vs(e,null!==e.memoizedState)}throw Error(a(163))}function Cs(t){var e=t.updateQueue;if(null!==e){t.updateQueue=null;var n=t.stateNode;null===n&&(n=t.stateNode=new hs),e.forEach((function(e){var i=Nl.bind(null,t,e);n.has(e)||(n.add(e),e.then(i,i))}))}}function Ss(t,e){return null!==t&&(null===(t=t.memoizedState)||null!==t.dehydrated)&&(null!==(e=e.memoizedState)&&null===e.dehydrated)}var Es=Math.ceil,Ps=b.ReactCurrentDispatcher,As=b.ReactCurrentOwner,Ts=0,Rs=null,Ds=null,Ms=0,Ls=0,Bs=ar(0),Os=0,Fs=null,Is=0,zs=0,Ns=0,Us=0,Hs=null,Ws=0,js=1/0;function Vs(){js=Ur()+500}var Gs,Xs=null,qs=!1,Ks=null,Qs=null,Ys=!1,Zs=null,$s=90,Js=[],tl=[],el=null,nl=0,il=null,rl=-1,ol=0,al=0,sl=null,ll=!1;function ul(){return 0!==(48&Ts)?Ur():-1!==rl?rl:rl=Ur()}function cl(t){if(0===(2&(t=t.mode)))return 1;if(0===(4&t))return 99===Hr()?1:2;if(0===ol&&(ol=Is),0!==qr.transition){0!==al&&(al=null!==Hs?Hs.pendingLanes:0),t=ol;var e=4186112&~al;return 0===(e&=-e)&&(0===(e=(t=4186112&~t)&-t)&&(e=8192)),e}return t=Hr(),0!==(4&Ts)&&98===t?t=Ue(12,ol):t=Ue(t=function(t){switch(t){case 99:return 15;case 98:return 10;case 97:case 96:return 8;case 95:return 2;default:return 0}}(t),ol),t}function hl(t,e,n){if(50<nl)throw nl=0,il=null,Error(a(185));if(null===(t=dl(t,e)))return null;je(t,e,n),t===Rs&&(Ns|=e,4===Os&&vl(t,Ms));var i=Hr();1===e?0!==(8&Ts)&&0===(48&Ts)?gl(t):(fl(t,n),0===Ts&&(Vs(),Gr())):(0===(4&Ts)||98!==i&&99!==i||(null===el?el=new Set([t]):el.add(t)),fl(t,n)),Hs=t}function dl(t,e){t.lanes|=e;var n=t.alternate;for(null!==n&&(n.lanes|=e),n=t,t=t.return;null!==t;)t.childLanes|=e,null!==(n=t.alternate)&&(n.childLanes|=e),n=t,t=t.return;return 3===n.tag?n.stateNode:null}function fl(t,e){for(var n=t.callbackNode,i=t.suspendedLanes,r=t.pingedLanes,o=t.expirationTimes,s=t.pendingLanes;0<s;){var l=31-Ve(s),u=1<<l,c=o[l];if(-1===c){if(0===(u&i)||0!==(u&r)){c=e,Ie(u);var h=Fe;o[l]=10<=h?c+250:6<=h?c+5e3:-1}}else c<=e&&(t.expiredLanes|=u);s&=~u}if(i=ze(t,t===Rs?Ms:0),e=Fe,0===i)null!==n&&(n!==Br&&Cr(n),t.callbackNode=null,t.callbackPriority=0);else{if(null!==n){if(t.callbackPriority===e)return;n!==Br&&Cr(n)}15===e?(n=gl.bind(null,t),null===Fr?(Fr=[n],Ir=xr(Tr,Xr)):Fr.push(n),n=Br):14===e?n=Vr(99,gl.bind(null,t)):n=Vr(n=function(t){switch(t){case 15:case 14:return 99;case 13:case 12:case 11:case 10:return 98;case 9:case 8:case 7:case 6:case 4:case 5:return 97;case 3:case 2:case 1:return 95;case 0:return 90;default:throw Error(a(358,t))}}(e),pl.bind(null,t)),t.callbackPriority=e,t.callbackNode=n}}function pl(t){if(rl=-1,al=ol=0,0!==(48&Ts))throw Error(a(327));var e=t.callbackNode;if(Ml()&&t.callbackNode!==e)return null;var n=ze(t,t===Rs?Ms:0);if(0===n)return null;var i=n,r=Ts;Ts|=16;var o=xl();for(Rs===t&&Ms===i||(Vs(),bl(t,i));;)try{El();break}catch(l){kl(t,l)}if(Jr(),Ps.current=o,Ts=r,null!==Ds?i=0:(Rs=null,Ms=0,i=Os),0!==(Is&Ns))bl(t,0);else if(0!==i){if(2===i&&(Ts|=64,t.hydrate&&(t.hydrate=!1,Vi(t.containerInfo)),0!==(n=Ne(t))&&(i=Cl(t,n))),1===i)throw e=Fs,bl(t,0),vl(t,n),fl(t,Ur()),e;switch(t.finishedWork=t.current.alternate,t.finishedLanes=n,i){case 0:case 1:throw Error(a(345));case 2:Tl(t);break;case 3:if(vl(t,n),(62914560&n)===n&&10<(i=Ws+500-Ur())){if(0!==ze(t,0))break;if(((r=t.suspendedLanes)&n)!==n){ul(),t.pingedLanes|=t.suspendedLanes&r;break}t.timeoutHandle=Wi(Tl.bind(null,t),i);break}Tl(t);break;case 4:if(vl(t,n),(4186112&n)===n)break;for(i=t.eventTimes,r=-1;0<n;){var s=31-Ve(n);o=1<<s,(s=i[s])>r&&(r=s),n&=~o}if(n=r,10<(n=(120>(n=Ur()-n)?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Es(n/1960))-n)){t.timeoutHandle=Wi(Tl.bind(null,t),n);break}Tl(t);break;case 5:Tl(t);break;default:throw Error(a(329))}}return fl(t,Ur()),t.callbackNode===e?pl.bind(null,t):null}function vl(t,e){for(e&=~Us,e&=~Ns,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Ve(e),i=1<<n;t[n]=-1,e&=~i}}function gl(t){if(0!==(48&Ts))throw Error(a(327));if(Ml(),t===Rs&&0!==(t.expiredLanes&Ms)){var e=Ms,n=Cl(t,e);0!==(Is&Ns)&&(n=Cl(t,e=ze(t,e)))}else n=Cl(t,e=ze(t,0));if(0!==t.tag&&2===n&&(Ts|=64,t.hydrate&&(t.hydrate=!1,Vi(t.containerInfo)),0!==(e=Ne(t))&&(n=Cl(t,e))),1===n)throw n=Fs,bl(t,0),vl(t,e),fl(t,Ur()),n;return t.finishedWork=t.current.alternate,t.finishedLanes=e,Tl(t),fl(t,Ur()),null}function yl(t,e){var n=Ts;Ts|=1;try{return t(e)}finally{0===(Ts=n)&&(Vs(),Gr())}}function ml(t,e){var n=Ts;Ts&=-2,Ts|=8;try{return t(e)}finally{0===(Ts=n)&&(Vs(),Gr())}}function _l(t,e){lr(Bs,Ls),Ls|=e,Is|=e}function wl(){Ls=Bs.current,sr(Bs)}function bl(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(-1!==n&&(t.timeoutHandle=-1,ji(n)),null!==Ds)for(n=Ds.return;null!==n;){var i=n;switch(i.tag){case 1:null!==(i=i.type.childContextTypes)&&void 0!==i&&vr();break;case 3:Mo(),sr(hr),sr(cr),qo();break;case 5:Bo(i);break;case 4:Mo();break;case 13:case 19:sr(Oo);break;case 10:to(i);break;case 23:case 24:wl()}n=n.return}Rs=t,Ds=jl(t.current,null),Ms=Ls=Is=e,Os=0,Fs=null,Us=Ns=zs=0}function kl(t,e){for(;;){var n=Ds;try{if(Jr(),Ko.current=Ta,ta){for(var i=Zo.memoizedState;null!==i;){var r=i.queue;null!==r&&(r.pending=null),i=i.next}ta=!1}if(Yo=0,Jo=$o=Zo=null,ea=!1,As.current=null,null===n||null===n.return){Os=1,Fs=e,Ds=null;break}t:{var o=t,a=n.return,s=n,l=e;if(e=Ms,s.flags|=2048,s.firstEffect=s.lastEffect=null,null!==l&&"object"===typeof l&&"function"===typeof l.then){var u=l;if(0===(2&s.mode)){var c=s.alternate;c?(s.updateQueue=c.updateQueue,s.memoizedState=c.memoizedState,s.lanes=c.lanes):(s.updateQueue=null,s.memoizedState=null)}var h=0!==(1&Oo.current),d=a;do{var f;if(f=13===d.tag){var p=d.memoizedState;if(null!==p)f=null!==p.dehydrated;else{var v=d.memoizedProps;f=void 0!==v.fallback&&(!0!==v.unstable_avoidThisFallback||!h)}}if(f){var g=d.updateQueue;if(null===g){var y=new Set;y.add(u),d.updateQueue=y}else g.add(u);if(0===(2&d.mode)){if(d.flags|=64,s.flags|=16384,s.flags&=-2981,1===s.tag)if(null===s.alternate)s.tag=17;else{var m=so(-1,1);m.tag=2,lo(s,m)}s.lanes|=1;break t}l=void 0,s=e;var _=o.pingCache;if(null===_?(_=o.pingCache=new ls,l=new Set,_.set(u,l)):void 0===(l=_.get(u))&&(l=new Set,_.set(u,l)),!l.has(s)){l.add(s);var w=zl.bind(null,o,u,s);u.then(w,w)}d.flags|=4096,d.lanes=e;break t}d=d.return}while(null!==d);l=Error((q(s.type)||"A React component")+" suspended while rendering, but no fallback UI was specified.\n\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display.")}5!==Os&&(Os=2),l=as(l,s),d=a;do{switch(d.tag){case 3:o=l,d.flags|=4096,e&=-e,d.lanes|=e,uo(d,us(0,o,e));break t;case 1:o=l;var b=d.type,k=d.stateNode;if(0===(64&d.flags)&&("function"===typeof b.getDerivedStateFromError||null!==k&&"function"===typeof k.componentDidCatch&&(null===Qs||!Qs.has(k)))){d.flags|=4096,e&=-e,d.lanes|=e,uo(d,cs(d,o,e));break t}}d=d.return}while(null!==d)}Al(n)}catch(x){e=x,Ds===n&&null!==n&&(Ds=n=n.return);continue}break}}function xl(){var t=Ps.current;return Ps.current=Ta,null===t?Ta:t}function Cl(t,e){var n=Ts;Ts|=16;var i=xl();for(Rs===t&&Ms===e||bl(t,e);;)try{Sl();break}catch(r){kl(t,r)}if(Jr(),Ts=n,Ps.current=i,null!==Ds)throw Error(a(261));return Rs=null,Ms=0,Os}function Sl(){for(;null!==Ds;)Pl(Ds)}function El(){for(;null!==Ds&&!Sr();)Pl(Ds)}function Pl(t){var e=Gs(t.alternate,t,Ls);t.memoizedProps=t.pendingProps,null===e?Al(t):Ds=e,As.current=null}function Al(t){var e=t;do{var n=e.alternate;if(t=e.return,0===(2048&e.flags)){if(null!==(n=rs(n,e,Ls)))return void(Ds=n);if(24!==(n=e).tag&&23!==n.tag||null===n.memoizedState||0!==(1073741824&Ls)||0===(4&n.mode)){for(var i=0,r=n.child;null!==r;)i|=r.lanes|r.childLanes,r=r.sibling;n.childLanes=i}null!==t&&0===(2048&t.flags)&&(null===t.firstEffect&&(t.firstEffect=e.firstEffect),null!==e.lastEffect&&(null!==t.lastEffect&&(t.lastEffect.nextEffect=e.firstEffect),t.lastEffect=e.lastEffect),1<e.flags&&(null!==t.lastEffect?t.lastEffect.nextEffect=e:t.firstEffect=e,t.lastEffect=e))}else{if(null!==(n=os(e)))return n.flags&=2047,void(Ds=n);null!==t&&(t.firstEffect=t.lastEffect=null,t.flags|=2048)}if(null!==(e=e.sibling))return void(Ds=e);Ds=e=t}while(null!==e);0===Os&&(Os=5)}function Tl(t){var e=Hr();return jr(99,Rl.bind(null,t,e)),null}function Rl(t,e){do{Ml()}while(null!==Zs);if(0!==(48&Ts))throw Error(a(327));var n=t.finishedWork;if(null===n)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(a(177));t.callbackNode=null;var i=n.lanes|n.childLanes,r=i,o=t.pendingLanes&~r;t.pendingLanes=r,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=r,t.mutableReadLanes&=r,t.entangledLanes&=r,r=t.entanglements;for(var s=t.eventTimes,l=t.expirationTimes;0<o;){var u=31-Ve(o),c=1<<u;r[u]=0,s[u]=-1,l[u]=-1,o&=~c}if(null!==el&&0===(24&i)&&el.has(t)&&el.delete(t),t===Rs&&(Ds=Rs=null,Ms=0),1<n.flags?null!==n.lastEffect?(n.lastEffect.nextEffect=n,i=n.firstEffect):i=n:i=n.firstEffect,null!==i){if(r=Ts,Ts|=32,As.current=null,zi=Qe,pi(s=fi())){if("selectionStart"in s)l={start:s.selectionStart,end:s.selectionEnd};else t:if(l=(l=s.ownerDocument)&&l.defaultView||window,(c=l.getSelection&&l.getSelection())&&0!==c.rangeCount){l=c.anchorNode,o=c.anchorOffset,u=c.focusNode,c=c.focusOffset;try{l.nodeType,u.nodeType}catch(E){l=null;break t}var h=0,d=-1,f=-1,p=0,v=0,g=s,y=null;e:for(;;){for(var m;g!==l||0!==o&&3!==g.nodeType||(d=h+o),g!==u||0!==c&&3!==g.nodeType||(f=h+c),3===g.nodeType&&(h+=g.nodeValue.length),null!==(m=g.firstChild);)y=g,g=m;for(;;){if(g===s)break e;if(y===l&&++p===o&&(d=h),y===u&&++v===c&&(f=h),null!==(m=g.nextSibling))break;y=(g=y).parentNode}g=m}l=-1===d||-1===f?null:{start:d,end:f}}else l=null;l=l||{start:0,end:0}}else l=null;Ni={focusedElem:s,selectionRange:l},Qe=!1,sl=null,ll=!1,Xs=i;do{try{Dl()}catch(E){if(null===Xs)throw Error(a(330));Il(Xs,E),Xs=Xs.nextEffect}}while(null!==Xs);sl=null,Xs=i;do{try{for(s=t;null!==Xs;){var _=Xs.flags;if(16&_&&mt(Xs.stateNode,""),128&_){var w=Xs.alternate;if(null!==w){var b=w.ref;null!==b&&("function"===typeof b?b(null):b.current=null)}}switch(1038&_){case 2:_s(Xs),Xs.flags&=-3;break;case 6:_s(Xs),Xs.flags&=-3,xs(Xs.alternate,Xs);break;case 1024:Xs.flags&=-1025;break;case 1028:Xs.flags&=-1025,xs(Xs.alternate,Xs);break;case 4:xs(Xs.alternate,Xs);break;case 8:ks(s,l=Xs);var k=l.alternate;ys(l),null!==k&&ys(k)}Xs=Xs.nextEffect}}catch(E){if(null===Xs)throw Error(a(330));Il(Xs,E),Xs=Xs.nextEffect}}while(null!==Xs);if(b=Ni,w=fi(),_=b.focusedElem,s=b.selectionRange,w!==_&&_&&_.ownerDocument&&di(_.ownerDocument.documentElement,_)){null!==s&&pi(_)&&(w=s.start,void 0===(b=s.end)&&(b=w),"selectionStart"in _?(_.selectionStart=w,_.selectionEnd=Math.min(b,_.value.length)):(b=(w=_.ownerDocument||document)&&w.defaultView||window).getSelection&&(b=b.getSelection(),l=_.textContent.length,k=Math.min(s.start,l),s=void 0===s.end?k:Math.min(s.end,l),!b.extend&&k>s&&(l=s,s=k,k=l),l=hi(_,k),o=hi(_,s),l&&o&&(1!==b.rangeCount||b.anchorNode!==l.node||b.anchorOffset!==l.offset||b.focusNode!==o.node||b.focusOffset!==o.offset)&&((w=w.createRange()).setStart(l.node,l.offset),b.removeAllRanges(),k>s?(b.addRange(w),b.extend(o.node,o.offset)):(w.setEnd(o.node,o.offset),b.addRange(w))))),w=[];for(b=_;b=b.parentNode;)1===b.nodeType&&w.push({element:b,left:b.scrollLeft,top:b.scrollTop});for("function"===typeof _.focus&&_.focus(),_=0;_<w.length;_++)(b=w[_]).element.scrollLeft=b.left,b.element.scrollTop=b.top}Qe=!!zi,Ni=zi=null,t.current=n,Xs=i;do{try{for(_=t;null!==Xs;){var x=Xs.flags;if(36&x&&ps(_,Xs.alternate,Xs),128&x){w=void 0;var C=Xs.ref;if(null!==C){var S=Xs.stateNode;switch(Xs.tag){case 5:w=S;break;default:w=S}"function"===typeof C?C(w):C.current=w}}Xs=Xs.nextEffect}}catch(E){if(null===Xs)throw Error(a(330));Il(Xs,E),Xs=Xs.nextEffect}}while(null!==Xs);Xs=null,Or(),Ts=r}else t.current=n;if(Ys)Ys=!1,Zs=t,$s=e;else for(Xs=i;null!==Xs;)e=Xs.nextEffect,Xs.nextEffect=null,8&Xs.flags&&((x=Xs).sibling=null,x.stateNode=null),Xs=e;if(0===(i=t.pendingLanes)&&(Qs=null),1===i?t===il?nl++:(nl=0,il=t):nl=0,n=n.stateNode,br&&"function"===typeof br.onCommitFiberRoot)try{br.onCommitFiberRoot(wr,n,void 0,64===(64&n.current.flags))}catch(E){}if(fl(t,Ur()),qs)throw qs=!1,t=Ks,Ks=null,t;return 0!==(8&Ts)||Gr(),null}function Dl(){for(;null!==Xs;){var t=Xs.alternate;ll||null===sl||(0!==(8&Xs.flags)?te(Xs,sl)&&(ll=!0):13===Xs.tag&&Ss(t,Xs)&&te(Xs,sl)&&(ll=!0));var e=Xs.flags;0!==(256&e)&&fs(t,Xs),0===(512&e)||Ys||(Ys=!0,Vr(97,(function(){return Ml(),null}))),Xs=Xs.nextEffect}}function Ml(){if(90!==$s){var t=97<$s?97:$s;return $s=90,jr(t,Ol)}return!1}function Ll(t,e){Js.push(e,t),Ys||(Ys=!0,Vr(97,(function(){return Ml(),null})))}function Bl(t,e){tl.push(e,t),Ys||(Ys=!0,Vr(97,(function(){return Ml(),null})))}function Ol(){if(null===Zs)return!1;var t=Zs;if(Zs=null,0!==(48&Ts))throw Error(a(331));var e=Ts;Ts|=32;var n=tl;tl=[];for(var i=0;i<n.length;i+=2){var r=n[i],o=n[i+1],s=r.destroy;if(r.destroy=void 0,"function"===typeof s)try{s()}catch(u){if(null===o)throw Error(a(330));Il(o,u)}}for(n=Js,Js=[],i=0;i<n.length;i+=2){r=n[i],o=n[i+1];try{var l=r.create;r.destroy=l()}catch(u){if(null===o)throw Error(a(330));Il(o,u)}}for(l=t.current.firstEffect;null!==l;)t=l.nextEffect,l.nextEffect=null,8&l.flags&&(l.sibling=null,l.stateNode=null),l=t;return Ts=e,Gr(),!0}function Fl(t,e,n){lo(t,e=us(0,e=as(n,e),1)),e=ul(),null!==(t=dl(t,1))&&(je(t,1,e),fl(t,e))}function Il(t,e){if(3===t.tag)Fl(t,t,e);else for(var n=t.return;null!==n;){if(3===n.tag){Fl(n,t,e);break}if(1===n.tag){var i=n.stateNode;if("function"===typeof n.type.getDerivedStateFromError||"function"===typeof i.componentDidCatch&&(null===Qs||!Qs.has(i))){var r=cs(n,t=as(e,t),1);if(lo(n,r),r=ul(),null!==(n=dl(n,1)))je(n,1,r),fl(n,r);else if("function"===typeof i.componentDidCatch&&(null===Qs||!Qs.has(i)))try{i.componentDidCatch(e,t)}catch(o){}break}}n=n.return}}function zl(t,e,n){var i=t.pingCache;null!==i&&i.delete(e),e=ul(),t.pingedLanes|=t.suspendedLanes&n,Rs===t&&(Ms&n)===n&&(4===Os||3===Os&&(62914560&Ms)===Ms&&500>Ur()-Ws?bl(t,0):Us|=n),fl(t,e)}function Nl(t,e){var n=t.stateNode;null!==n&&n.delete(e),0===(e=0)&&(0===(2&(e=t.mode))?e=1:0===(4&e)?e=99===Hr()?1:2:(0===ol&&(ol=Is),0===(e=He(62914560&~ol))&&(e=4194304))),n=ul(),null!==(t=dl(t,e))&&(je(t,e,n),fl(t,n))}function Ul(t,e,n,i){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.flags=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childLanes=this.lanes=0,this.alternate=null}function Hl(t,e,n,i){return new Ul(t,e,n,i)}function Wl(t){return!(!(t=t.prototype)||!t.isReactComponent)}function jl(t,e){var n=t.alternate;return null===n?((n=Hl(t.tag,e,t.key,t.mode)).elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.nextEffect=null,n.firstEffect=null,n.lastEffect=null),n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Vl(t,e,n,i,r,o){var s=2;if(i=t,"function"===typeof t)Wl(t)&&(s=1);else if("string"===typeof t)s=5;else t:switch(t){case C:return Gl(n.children,r,o,e);case F:s=8,r|=16;break;case S:s=8,r|=1;break;case E:return(t=Hl(12,n,e,8|r)).elementType=E,t.type=E,t.lanes=o,t;case R:return(t=Hl(13,n,e,r)).type=R,t.elementType=R,t.lanes=o,t;case D:return(t=Hl(19,n,e,r)).elementType=D,t.lanes=o,t;case I:return Xl(n,r,o,e);case z:return(t=Hl(24,n,e,r)).elementType=z,t.lanes=o,t;default:if("object"===typeof t&&null!==t)switch(t.$$typeof){case P:s=10;break t;case A:s=9;break t;case T:s=11;break t;case M:s=14;break t;case L:s=16,i=null;break t;case B:s=22;break t}throw Error(a(130,null==t?t:typeof t,""))}return(e=Hl(s,n,e,r)).elementType=t,e.type=i,e.lanes=o,e}function Gl(t,e,n,i){return(t=Hl(7,t,i,e)).lanes=n,t}function Xl(t,e,n,i){return(t=Hl(23,t,i,e)).elementType=I,t.lanes=n,t}function ql(t,e,n){return(t=Hl(6,t,null,e)).lanes=n,t}function Kl(t,e,n){return(e=Hl(4,null!==t.children?t.children:[],t.key,e)).lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Ql(t,e,n){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.pendingContext=this.context=null,this.hydrate=n,this.callbackNode=null,this.callbackPriority=0,this.eventTimes=We(0),this.expirationTimes=We(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=We(0),this.mutableSourceEagerHydrationData=null}function Yl(t,e,n){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:x,key:null==i?null:""+i,children:t,containerInfo:e,implementation:n}}function Zl(t,e,n,i){var r=e.current,o=ul(),s=cl(r);t:if(n){e:{if(Yt(n=n._reactInternals)!==n||1!==n.tag)throw Error(a(170));var l=n;do{switch(l.tag){case 3:l=l.stateNode.context;break e;case 1:if(pr(l.type)){l=l.stateNode.__reactInternalMemoizedMergedChildContext;break e}}l=l.return}while(null!==l);throw Error(a(171))}if(1===n.tag){var u=n.type;if(pr(u)){n=yr(n,u,l);break t}}n=l}else n=ur;return null===e.context?e.context=n:e.pendingContext=n,(e=so(o,s)).payload={element:t},null!==(i=void 0===i?null:i)&&(e.callback=i),lo(r,e),hl(r,s,o),s}function $l(t){if(!(t=t.current).child)return null;switch(t.child.tag){case 5:default:return t.child.stateNode}}function Jl(t,e){if(null!==(t=t.memoizedState)&&null!==t.dehydrated){var n=t.retryLane;t.retryLane=0!==n&&n<e?n:e}}function tu(t,e){Jl(t,e),(t=t.alternate)&&Jl(t,e)}function eu(t,e,n){var i=null!=n&&null!=n.hydrationOptions&&n.hydrationOptions.mutableSources||null;if(n=new Ql(t,e,null!=n&&!0===n.hydrate),e=Hl(3,null,null,2===e?7:1===e?3:0),n.current=e,e.stateNode=n,oo(e),t[Zi]=n.current,Ti(8===t.nodeType?t.parentNode:t),i)for(t=0;t<i.length;t++){var r=(e=i[t])._getVersion;r=r(e._source),null==n.mutableSourceEagerHydrationData?n.mutableSourceEagerHydrationData=[e,r]:n.mutableSourceEagerHydrationData.push(e,r)}this._internalRoot=n}function nu(t){return!(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType&&(8!==t.nodeType||" react-mount-point-unstable "!==t.nodeValue))}function iu(t,e,n,i,r){var o=n._reactRootContainer;if(o){var a=o._internalRoot;if("function"===typeof r){var s=r;r=function(){var t=$l(a);s.call(t)}}Zl(e,a,t,r)}else{if(o=n._reactRootContainer=function(t,e){if(e||(e=!(!(e=t?9===t.nodeType?t.documentElement:t.firstChild:null)||1!==e.nodeType||!e.hasAttribute("data-reactroot"))),!e)for(var n;n=t.lastChild;)t.removeChild(n);return new eu(t,0,e?{hydrate:!0}:void 0)}(n,i),a=o._internalRoot,"function"===typeof r){var l=r;r=function(){var t=$l(a);l.call(t)}}ml((function(){Zl(e,a,t,r)}))}return $l(a)}function ru(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!nu(e))throw Error(a(200));return Yl(t,e,null,n)}Gs=function(t,e,n){var i=e.lanes;if(null!==t)if(t.memoizedProps!==e.pendingProps||hr.current)Ba=!0;else{if(0===(n&i)){switch(Ba=!1,e.tag){case 3:Va(e),Go();break;case 5:Lo(e);break;case 1:pr(e.type)&&mr(e);break;case 4:Do(e,e.stateNode.containerInfo);break;case 10:i=e.memoizedProps.value;var r=e.type._context;lr(Qr,r._currentValue),r._currentValue=i;break;case 13:if(null!==e.memoizedState)return 0!==(n&e.child.childLanes)?Qa(t,e,n):(lr(Oo,1&Oo.current),null!==(e=ns(t,e,n))?e.sibling:null);lr(Oo,1&Oo.current);break;case 19:if(i=0!==(n&e.childLanes),0!==(64&t.flags)){if(i)return es(t,e,n);e.flags|=64}if(null!==(r=e.memoizedState)&&(r.rendering=null,r.tail=null,r.lastEffect=null),lr(Oo,Oo.current),i)break;return null;case 23:case 24:return e.lanes=0,Na(t,e,n)}return ns(t,e,n)}Ba=0!==(16384&t.flags)}else Ba=!1;switch(e.lanes=0,e.tag){case 2:if(i=e.type,null!==t&&(t.alternate=null,e.alternate=null,e.flags|=2),t=e.pendingProps,r=fr(e,cr.current),no(e,n),r=ra(null,e,i,t,r,n),e.flags|=1,"object"===typeof r&&null!==r&&"function"===typeof r.render&&void 0===r.$$typeof){if(e.tag=1,e.memoizedState=null,e.updateQueue=null,pr(i)){var o=!0;mr(e)}else o=!1;e.memoizedState=null!==r.state&&void 0!==r.state?r.state:null,oo(e);var s=i.getDerivedStateFromProps;"function"===typeof s&&po(e,i,s,t),r.updater=vo,e.stateNode=r,r._reactInternals=e,_o(e,i,t,n),e=ja(null,e,i,!0,o,n)}else e.tag=0,Oa(null,e,r,n),e=e.child;return e;case 16:r=e.elementType;t:{switch(null!==t&&(t.alternate=null,e.alternate=null,e.flags|=2),t=e.pendingProps,r=(o=r._init)(r._payload),e.type=r,o=e.tag=function(t){if("function"===typeof t)return Wl(t)?1:0;if(void 0!==t&&null!==t){if((t=t.$$typeof)===T)return 11;if(t===M)return 14}return 2}(r),t=Kr(r,t),o){case 0:e=Ha(null,e,r,t,n);break t;case 1:e=Wa(null,e,r,t,n);break t;case 11:e=Fa(null,e,r,t,n);break t;case 14:e=Ia(null,e,r,Kr(r.type,t),i,n);break t}throw Error(a(306,r,""))}return e;case 0:return i=e.type,r=e.pendingProps,Ha(t,e,i,r=e.elementType===i?r:Kr(i,r),n);case 1:return i=e.type,r=e.pendingProps,Wa(t,e,i,r=e.elementType===i?r:Kr(i,r),n);case 3:if(Va(e),i=e.updateQueue,null===t||null===i)throw Error(a(282));if(i=e.pendingProps,r=null!==(r=e.memoizedState)?r.element:null,ao(t,e),co(e,i,null,n),(i=e.memoizedState.element)===r)Go(),e=ns(t,e,n);else{if((o=(r=e.stateNode).hydrate)&&(zo=Gi(e.stateNode.containerInfo.firstChild),Io=e,o=No=!0),o){if(null!=(t=r.mutableSourceEagerHydrationData))for(r=0;r<t.length;r+=2)(o=t[r])._workInProgressVersionPrimary=t[r+1],Xo.push(o);for(n=So(e,null,i,n),e.child=n;n;)n.flags=-3&n.flags|1024,n=n.sibling}else Oa(t,e,i,n),Go();e=e.child}return e;case 5:return Lo(e),null===t&&Wo(e),i=e.type,r=e.pendingProps,o=null!==t?t.memoizedProps:null,s=r.children,Hi(i,r)?s=null:null!==o&&Hi(i,o)&&(e.flags|=16),Ua(t,e),Oa(t,e,s,n),e.child;case 6:return null===t&&Wo(e),null;case 13:return Qa(t,e,n);case 4:return Do(e,e.stateNode.containerInfo),i=e.pendingProps,null===t?e.child=Co(e,null,i,n):Oa(t,e,i,n),e.child;case 11:return i=e.type,r=e.pendingProps,Fa(t,e,i,r=e.elementType===i?r:Kr(i,r),n);case 7:return Oa(t,e,e.pendingProps,n),e.child;case 8:case 12:return Oa(t,e,e.pendingProps.children,n),e.child;case 10:t:{i=e.type._context,r=e.pendingProps,s=e.memoizedProps,o=r.value;var l=e.type._context;if(lr(Qr,l._currentValue),l._currentValue=o,null!==s)if(l=s.value,0===(o=si(l,o)?0:0|("function"===typeof i._calculateChangedBits?i._calculateChangedBits(l,o):1073741823))){if(s.children===r.children&&!hr.current){e=ns(t,e,n);break t}}else for(null!==(l=e.child)&&(l.return=e);null!==l;){var u=l.dependencies;if(null!==u){s=l.child;for(var c=u.firstContext;null!==c;){if(c.context===i&&0!==(c.observedBits&o)){1===l.tag&&((c=so(-1,n&-n)).tag=2,lo(l,c)),l.lanes|=n,null!==(c=l.alternate)&&(c.lanes|=n),eo(l.return,n),u.lanes|=n;break}c=c.next}}else s=10===l.tag&&l.type===e.type?null:l.child;if(null!==s)s.return=l;else for(s=l;null!==s;){if(s===e){s=null;break}if(null!==(l=s.sibling)){l.return=s.return,s=l;break}s=s.return}l=s}Oa(t,e,r.children,n),e=e.child}return e;case 9:return r=e.type,i=(o=e.pendingProps).children,no(e,n),i=i(r=io(r,o.unstable_observedBits)),e.flags|=1,Oa(t,e,i,n),e.child;case 14:return o=Kr(r=e.type,e.pendingProps),Ia(t,e,r,o=Kr(r.type,o),i,n);case 15:return za(t,e,e.type,e.pendingProps,i,n);case 17:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Kr(i,r),null!==t&&(t.alternate=null,e.alternate=null,e.flags|=2),e.tag=1,pr(i)?(t=!0,mr(e)):t=!1,no(e,n),yo(e,i,r),_o(e,i,r,n),ja(null,e,i,!0,t,n);case 19:return es(t,e,n);case 23:case 24:return Na(t,e,n)}throw Error(a(156,e.tag))},eu.prototype.render=function(t){Zl(t,this._internalRoot,null,null)},eu.prototype.unmount=function(){var t=this._internalRoot,e=t.containerInfo;Zl(null,t,null,(function(){e[Zi]=null}))},ee=function(t){13===t.tag&&(hl(t,4,ul()),tu(t,4))},ne=function(t){13===t.tag&&(hl(t,67108864,ul()),tu(t,67108864))},ie=function(t){if(13===t.tag){var e=ul(),n=cl(t);hl(t,n,e),tu(t,n)}},re=function(t,e){return e()},Pt=function(t,e,n){switch(e){case"input":if(nt(t,n),e=n.name,"radio"===n.type&&null!=e){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var i=n[e];if(i!==t&&i.form===t.form){var r=nr(i);if(!r)throw Error(a(90));Z(i),nt(i,r)}}}break;case"textarea":ut(t,n);break;case"select":null!=(e=n.value)&&at(t,!!n.multiple,e,!1)}},Lt=yl,Bt=function(t,e,n,i,r){var o=Ts;Ts|=4;try{return jr(98,t.bind(null,e,n,i,r))}finally{0===(Ts=o)&&(Vs(),Gr())}},Ot=function(){0===(49&Ts)&&(function(){if(null!==el){var t=el;el=null,t.forEach((function(t){t.expiredLanes|=24&t.pendingLanes,fl(t,Ur())}))}Gr()}(),Ml())},Ft=function(t,e){var n=Ts;Ts|=2;try{return t(e)}finally{0===(Ts=n)&&(Vs(),Gr())}};var ou={Events:[tr,er,nr,Dt,Mt,Ml,{current:!1}]},au={findFiberByHostInstance:Ji,bundleType:0,version:"17.0.2",rendererPackageName:"react-dom"},su={bundleType:au.bundleType,version:au.version,rendererPackageName:au.rendererPackageName,rendererConfig:au.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:b.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return null===(t=Jt(t))?null:t.stateNode},findFiberByHostInstance:au.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var lu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!lu.isDisabled&&lu.supportsFiber)try{wr=lu.inject(su),br=lu}catch(gt){}}e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ou,e.createPortal=ru,e.findDOMNode=function(t){if(null==t)return null;if(1===t.nodeType)return t;var e=t._reactInternals;if(void 0===e){if("function"===typeof t.render)throw Error(a(188));throw Error(a(268,Object.keys(t)))}return t=null===(t=Jt(e))?null:t.stateNode},e.flushSync=function(t,e){var n=Ts;if(0!==(48&n))return t(e);Ts|=1;try{if(t)return jr(99,t.bind(null,e))}finally{Ts=n,Gr()}},e.hydrate=function(t,e,n){if(!nu(e))throw Error(a(200));return iu(null,t,e,!0,n)},e.render=function(t,e,n){if(!nu(e))throw Error(a(200));return iu(null,t,e,!1,n)},e.unmountComponentAtNode=function(t){if(!nu(t))throw Error(a(40));return!!t._reactRootContainer&&(ml((function(){iu(null,null,t,!1,(function(){t._reactRootContainer=null,t[Zi]=null}))})),!0)},e.unstable_batchedUpdates=yl,e.unstable_createPortal=function(t,e){return ru(t,e,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null)},e.unstable_renderSubtreeIntoContainer=function(t,e,n,i){if(!nu(n))throw Error(a(200));if(null==t||void 0===t._reactInternals)throw Error(a(38));return iu(t,e,n,!1,i)},e.version="17.0.2"},function(t,e,n){"use strict";t.exports=n(21)},function(t,e,n){"use strict";var i,r,o,a;if("object"===typeof performance&&"function"===typeof performance.now){var s=performance;e.unstable_now=function(){return s.now()}}else{var l=Date,u=l.now();e.unstable_now=function(){return l.now()-u}}if("undefined"===typeof window||"function"!==typeof MessageChannel){var c=null,h=null,d=function t(){if(null!==c)try{var n=e.unstable_now();c(!0,n),c=null}catch(i){throw setTimeout(t,0),i}};i=function(t){null!==c?setTimeout(i,0,t):(c=t,setTimeout(d,0))},r=function(t,e){h=setTimeout(t,e)},o=function(){clearTimeout(h)},e.unstable_shouldYield=function(){return!1},a=e.unstable_forceFrameRate=function(){}}else{var f=window.setTimeout,p=window.clearTimeout;if("undefined"!==typeof console){var v=window.cancelAnimationFrame;"function"!==typeof window.requestAnimationFrame&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills"),"function"!==typeof v&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills")}var g=!1,y=null,m=-1,_=5,w=0;e.unstable_shouldYield=function(){return e.unstable_now()>=w},a=function(){},e.unstable_forceFrameRate=function(t){0>t||125<t?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<t?Math.floor(1e3/t):5};var b=new MessageChannel,k=b.port2;b.port1.onmessage=function(){if(null!==y){var t=e.unstable_now();w=t+_;try{y(!0,t)?k.postMessage(null):(g=!1,y=null)}catch(n){throw k.postMessage(null),n}}else g=!1},i=function(t){y=t,g||(g=!0,k.postMessage(null))},r=function(t,n){m=f((function(){t(e.unstable_now())}),n)},o=function(){p(m),m=-1}}function x(t,e){var n=t.length;t.push(e);t:for(;;){var i=n-1>>>1,r=t[i];if(!(void 0!==r&&0<E(r,e)))break t;t[i]=e,t[n]=r,n=i}}function C(t){return void 0===(t=t[0])?null:t}function S(t){var e=t[0];if(void 0!==e){var n=t.pop();if(n!==e){t[0]=n;t:for(var i=0,r=t.length;i<r;){var o=2*(i+1)-1,a=t[o],s=o+1,l=t[s];if(void 0!==a&&0>E(a,n))void 0!==l&&0>E(l,a)?(t[i]=l,t[s]=n,i=s):(t[i]=a,t[o]=n,i=o);else{if(!(void 0!==l&&0>E(l,n)))break t;t[i]=l,t[s]=n,i=s}}}return e}return null}function E(t,e){var n=t.sortIndex-e.sortIndex;return 0!==n?n:t.id-e.id}var P=[],A=[],T=1,R=null,D=3,M=!1,L=!1,B=!1;function O(t){for(var e=C(A);null!==e;){if(null===e.callback)S(A);else{if(!(e.startTime<=t))break;S(A),e.sortIndex=e.expirationTime,x(P,e)}e=C(A)}}function F(t){if(B=!1,O(t),!L)if(null!==C(P))L=!0,i(I);else{var e=C(A);null!==e&&r(F,e.startTime-t)}}function I(t,n){L=!1,B&&(B=!1,o()),M=!0;var i=D;try{for(O(n),R=C(P);null!==R&&(!(R.expirationTime>n)||t&&!e.unstable_shouldYield());){var a=R.callback;if("function"===typeof a){R.callback=null,D=R.priorityLevel;var s=a(R.expirationTime<=n);n=e.unstable_now(),"function"===typeof s?R.callback=s:R===C(P)&&S(P),O(n)}else S(P);R=C(P)}if(null!==R)var l=!0;else{var u=C(A);null!==u&&r(F,u.startTime-n),l=!1}return l}finally{R=null,D=i,M=!1}}var z=a;e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(t){t.callback=null},e.unstable_continueExecution=function(){L||M||(L=!0,i(I))},e.unstable_getCurrentPriorityLevel=function(){return D},e.unstable_getFirstCallbackNode=function(){return C(P)},e.unstable_next=function(t){switch(D){case 1:case 2:case 3:var e=3;break;default:e=D}var n=D;D=e;try{return t()}finally{D=n}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=z,e.unstable_runWithPriority=function(t,e){switch(t){case 1:case 2:case 3:case 4:case 5:break;default:t=3}var n=D;D=t;try{return e()}finally{D=n}},e.unstable_scheduleCallback=function(t,n,a){var s=e.unstable_now();switch("object"===typeof a&&null!==a?a="number"===typeof(a=a.delay)&&0<a?s+a:s:a=s,t){case 1:var l=-1;break;case 2:l=250;break;case 5:l=1073741823;break;case 4:l=1e4;break;default:l=5e3}return t={id:T++,callback:n,priorityLevel:t,startTime:a,expirationTime:l=a+l,sortIndex:-1},a>s?(t.sortIndex=a,x(A,t),null===C(P)&&t===C(A)&&(B?o():B=!0,r(F,a-s))):(t.sortIndex=l,x(P,t),L||M||(L=!0,i(I))),t},e.unstable_wrapCallback=function(t){var e=D;return function(){var n=D;D=e;try{return t.apply(this,arguments)}finally{D=n}}}},,function(t,e,n){var i=function(t){"use strict";var e,n=Object.prototype,i=n.hasOwnProperty,r="function"===typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",a=r.asyncIterator||"@@asyncIterator",s=r.toStringTag||"@@toStringTag";function l(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(D){l=function(t,e,n){return t[e]=n}}function u(t,e,n,i){var r=e&&e.prototype instanceof g?e:g,o=Object.create(r.prototype),a=new A(i||[]);return o._invoke=function(t,e,n){var i=h;return function(r,o){if(i===f)throw new Error("Generator is already running");if(i===p){if("throw"===r)throw o;return R()}for(n.method=r,n.arg=o;;){var a=n.delegate;if(a){var s=S(a,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===h)throw i=p,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=f;var l=c(t,e,n);if("normal"===l.type){if(i=n.done?p:d,l.arg===v)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=p,n.method="throw",n.arg=l.arg)}}}(t,n,a),o}function c(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(D){return{type:"throw",arg:D}}}t.wrap=u;var h="suspendedStart",d="suspendedYield",f="executing",p="completed",v={};function g(){}function y(){}function m(){}var _={};_[o]=function(){return this};var w=Object.getPrototypeOf,b=w&&w(w(T([])));b&&b!==n&&i.call(b,o)&&(_=b);var k=m.prototype=g.prototype=Object.create(_);function x(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function C(t,e){function n(r,o,a,s){var l=c(t[r],t,o);if("throw"!==l.type){var u=l.arg,h=u.value;return h&&"object"===typeof h&&i.call(h,"__await")?e.resolve(h.__await).then((function(t){n("next",t,a,s)}),(function(t){n("throw",t,a,s)})):e.resolve(h).then((function(t){u.value=t,a(u)}),(function(t){return n("throw",t,a,s)}))}s(l.arg)}var r;this._invoke=function(t,i){function o(){return new e((function(e,r){n(t,i,e,r)}))}return r=r?r.then(o,o):o()}}function S(t,n){var i=t.iterator[n.method];if(i===e){if(n.delegate=null,"throw"===n.method){if(t.iterator.return&&(n.method="return",n.arg=e,S(t,n),"throw"===n.method))return v;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var r=c(i,t.iterator,n.arg);if("throw"===r.type)return n.method="throw",n.arg=r.arg,n.delegate=null,v;var o=r.arg;return o?o.done?(n[t.resultName]=o.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,v):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function E(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(E,this),this.reset(!0)}function T(t){if(t){var n=t[o];if(n)return n.call(t);if("function"===typeof t.next)return t;if(!isNaN(t.length)){var r=-1,a=function n(){for(;++r<t.length;)if(i.call(t,r))return n.value=t[r],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}return{next:R}}function R(){return{value:e,done:!0}}return y.prototype=k.constructor=m,m.constructor=y,y.displayName=l(m,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"===typeof t&&t.constructor;return!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,m):(t.__proto__=m,l(t,s,"GeneratorFunction")),t.prototype=Object.create(k),t},t.awrap=function(t){return{__await:t}},x(C.prototype),C.prototype[a]=function(){return this},t.AsyncIterator=C,t.async=function(e,n,i,r,o){void 0===o&&(o=Promise);var a=new C(u(e,n,i,r),o);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},x(k),l(k,s,"Generator"),k[o]=function(){return this},k.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var i=e.pop();if(i in t)return n.value=i,n.done=!1,n}return n.done=!0,n}},t.values=T,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(i,r){return s.type="throw",s.arg=t,n.next=i,r&&(n.method="next",n.arg=e),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var l=i.call(a,"catchLoc"),u=i.call(a,"finallyLoc");if(l&&u){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),P(n),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;P(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,i){return this.delegate={iterator:T(t),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=e),v}},t}(t.exports);try{regeneratorRuntime=i}catch(r){Function("r","regeneratorRuntime = r")(i)}},function(t,e){function n(e){return"function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?t.exports=n=function(t){return typeof t}:t.exports=n=function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(e)}t.exports=n},function(t,e,n){var i=n(26);function r(e,n,o){return"undefined"!==typeof Reflect&&Reflect.get?t.exports=r=Reflect.get:t.exports=r=function(t,e,n){var r=i(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}},r(e,n,o||e)}t.exports=r},function(t,e,n){var i=n(12);t.exports=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=i(t)););return t}},function(t,e,n){var i=n(28),r=n(29),o=n(13),a=n(30);t.exports=function(t){return i(t)||r(t)||o(t)||a()}},function(t,e,n){var i=n(16);t.exports=function(t){if(Array.isArray(t))return i(t)}},function(t,e){t.exports=function(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}},function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(t,e,n){var i=n(13);t.exports=function(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=i(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,l=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return s=t.done,t},e:function(t){l=!0,a=t},f:function(){try{s||null==n.return||n.return()}finally{if(l)throw a}}}}},function(t,e,n){var i=n(33),r=n(34),o=n(13),a=n(35);t.exports=function(t,e){return i(t)||r(t,e)||o(t,e)||a()}},function(t,e){t.exports=function(t){if(Array.isArray(t))return t}},function(t,e){t.exports=function(t,e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t)){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(l){r=!0,o=l}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}return n}}},function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(t,e,n){var i=n(37);t.exports=function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&i(t,e)}},function(t,e){function n(e,i){return t.exports=n=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},n(e,i)}t.exports=n},function(t,e,n){var i=n(12),r=n(39),o=n(14);t.exports=function(t){var e=r();return function(){var n,r=i(t);if(e){var a=i(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return o(this,n)}}},function(t,e){t.exports=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}},function(t,e){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},function(t,e){function n(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}t.exports=function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}},,,,,,,,,function(t,e,n){"use strict";n(11);var i=n(6),r=60103;if(e.Fragment=60107,"function"===typeof Symbol&&Symbol.for){var o=Symbol.for;r=o("react.element"),e.Fragment=o("react.fragment")}var a=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s=Object.prototype.hasOwnProperty,l={key:!0,ref:!0,__self:!0,__source:!0};function u(t,e,n){var i,o={},u=null,c=null;for(i in void 0!==n&&(u=""+n),void 0!==e.key&&(u=""+e.key),void 0!==e.ref&&(c=e.ref),e)s.call(e,i)&&!l.hasOwnProperty(i)&&(o[i]=e[i]);if(t&&t.defaultProps)for(i in e=t.defaultProps)void 0===o[i]&&(o[i]=e[i]);return{$$typeof:r,type:t,key:u,ref:c,props:o,_owner:a.current}}e.jsx=u,e.jsxs=u}]]);
//# sourceMappingURL=2.281b0185.chunk.js.map