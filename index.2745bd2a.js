function t(t,e,i,s){Object.defineProperty(t,e,{get:i,set:s,enumerable:!0,configurable:!0})}var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},i={},s={},n=e.parcelRequire17c8;null==n&&((n=function(t){if(t in i)return i[t].exports;if(t in s){var e=s[t];delete s[t];var n={id:t,exports:{}};return i[t]=n,e.call(n.exports,n,n.exports),n.exports}var r=new Error("Cannot find module '"+t+"'");throw r.code="MODULE_NOT_FOUND",r}).register=function(t,e){s[t]=e},e.parcelRequire17c8=n),n.register("bXuNP",(function(e,i){var s,n;t(e.exports,"register",(()=>s),(t=>s=t)),t(e.exports,"resolve",(()=>n),(t=>n=t));var r={};s=function(t){for(var e=Object.keys(t),i=0;i<e.length;i++)r[e[i]]=t[e[i]]},n=function(t){var e=r[t];if(null==e)throw new Error("Could not resolve bundle with id "+t);return e}})),n("bXuNP").register(JSON.parse('{"7tqtW":"index.2745bd2a.js","5xRnk":"bolt.76ca7bfb.png","err8w":"bolt2.ef4d3c46.png","bVXkl":"hero_idle.cb361e5b.png","7e8WY":"Exias_idleV4.e15eeb28.png","fqlo3":"hero_run.f758908e.png","4iSkz":"Exias_runningV2.86f3eff0.png","Hoube":"hero_jump.343c7ba0.png","afZaY":"hero_down.f2ef148f.png","dNGgx":"hero_attack.2a271af3.png","9Njpj":"hero_down_attack.bb735a51.png","8mzxC":"hero_jump_attack.fbcf0b7f.png","jRWgD":"rose.9bb547b2.png","4r9cb":"fox.60c45db3.png","9RtUT":"mirror.2d64f1ff.png","6zuRN":"skeleton_mage.7d7dbc5a.png","aIQ35":"skeleton_warrior.0aece699.png","8xT79":"bubble.51b162af.png","lCQXP":"red_crystal.77cf79a0.png","aSscN":"xiao.e3587499.png","hESKd":"dragon.41e77354.png","lehYa":"kstore.750cbac2.png","2R7ES":"acidpop.9284eb26.png","jcWNy":"shrek.77fe3681.png","vEj6i":"inf1.6a05d2f4.png","807Z1":"inf2.5a5272a4.png","5WcSy":"fox.72111ba0.png","aWvOM":"xiao.8f0e542a.png","azIKW":"dragon.e57e757d.png","d5Ypo":"kstore.bd75826a.png","d56l0":"acidpop.3cd982c4.png","gOIrJ":"shrek.df540846.png","5DmGH":"skeleton.ec6d3d24.png","c2erN":"chest.80dc447b.png","g9Y9O":"sky.ff7e45a3.mp3","DIGfs":"2043.e6fdd21a.wav","2e9fk":"2045.e0788ad1.wav","6yS6A":"firebolt.9f32d4cd.wav","l80cM":"1010100_03_cn.f142cdc4.ogg","49RhT":"1010100_04_cn.594735d6.ogg","b6g9W":"1010100_05_cn.b27b5b9d.ogg","k3kkF":"357_01_en.1f5de25b.ogg","jISjQ":"357_02_en.ba56076f.ogg","2HTCO":"357_03_en.a883cc2c.ogg","cFgcn":"500003_cn.84777074.ogg","jZDvr":"264.0fa074a2.WAV","3u2CA":"268.bc166d8f.WAV","ez2kK":"270.753d0588.WAV","8BzVu":"278.d9dd83c3.WAV","jUlsg":"279.81ab2fcf.WAV","ahHfh":"281.4c33b08a.WAV","4MBij":"282.8e97a3d5.WAV","6xjFi":"283.88ff74a1.WAV","Ewfh9":"transi.a1fb5cb4.wav","9fuZJ":"crystal.180df33b.wav","50sJ5":"boom.0639a307.wav","ftwy4":"hit_light.e635e9a2.wav","gUSUL":"crystalsong.c42f0de1.mp3","c5Pso":"music_army.3edcbdbb.ogg","1wzqC":"music_dragon.3fed4d96.mp3","dM3Kz":"music_soldier.3dacc403.ogg","gxm7S":"music_boss.3d9a8904.mp3","gBGY0":"music_end.8c8d1a87.ogg","kLgAU":"index.599b56a9.css"}'));var r;n.register("cKDSi",(function(e,i){var s,r,o;t(e.exports,"Fragment",(()=>s),(t=>s=t)),t(e.exports,"jsx",(()=>r),(t=>r=t)),t(e.exports,"jsxs",(()=>o),(t=>o=t)),n("iPxqk");var a=n("eCRxs"),l=60103;if(s=60107,"function"==typeof Symbol&&Symbol.for){var h=Symbol.for;l=h("react.element"),s=h("react.fragment")}var c=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,d=Object.prototype.hasOwnProperty,u={key:!0,ref:!0,__self:!0,__source:!0};function p(t,e,i){var s,n={},r=null,o=null;for(s in void 0!==i&&(r=""+i),void 0!==e.key&&(r=""+e.key),void 0!==e.ref&&(o=e.ref),e)d.call(e,s)&&!u.hasOwnProperty(s)&&(n[s]=e[s]);if(t&&t.defaultProps)for(s in e=t.defaultProps)void 0===n[s]&&(n[s]=e[s]);return{$$typeof:l,type:t,key:r,ref:o,props:n,_owner:c.current}}r=p,o=p})),n.register("iPxqk",(function(t,e){var i=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable;function r(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}t.exports=function(){try{if(!Object.assign)return!1;if("abc"[5]="de","5"===Object.getOwnPropertyNames("abc")[0])return!1;for(var t={},e=0;e<10;e++)t["_"+String.fromCharCode(e)]=e;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach((function(t){i[t]=t})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},i)).join("")}catch(t){return!1}}()?Object.assign:function(t,e){for(var o,a,l=r(t),h=1;h<arguments.length;h++){for(var c in o=Object(arguments[h]))s.call(o,c)&&(l[c]=o[c]);if(i){a=i(o);for(var d=0;d<a.length;d++)n.call(o,a[d])&&(l[a[d]]=o[a[d]])}}return l}})),n.register("eCRxs",(function(t,e){t.exports=n("d2Db4")})),n.register("d2Db4",(function(e,i){var s,r,o,a,l,h,c,d,u,p,g,f,m,y,_,w,v,x,b,S,C,E,P,A,k,T,R,M;t(e.exports,"Fragment",(()=>s),(t=>s=t)),t(e.exports,"StrictMode",(()=>r),(t=>r=t)),t(e.exports,"Profiler",(()=>o),(t=>o=t)),t(e.exports,"Suspense",(()=>a),(t=>a=t)),t(e.exports,"Children",(()=>l),(t=>l=t)),t(e.exports,"Component",(()=>h),(t=>h=t)),t(e.exports,"PureComponent",(()=>c),(t=>c=t)),t(e.exports,"__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED",(()=>d),(t=>d=t)),t(e.exports,"cloneElement",(()=>u),(t=>u=t)),t(e.exports,"createContext",(()=>p),(t=>p=t)),t(e.exports,"createElement",(()=>g),(t=>g=t)),t(e.exports,"createFactory",(()=>f),(t=>f=t)),t(e.exports,"createRef",(()=>m),(t=>m=t)),t(e.exports,"forwardRef",(()=>y),(t=>y=t)),t(e.exports,"isValidElement",(()=>_),(t=>_=t)),t(e.exports,"lazy",(()=>w),(t=>w=t)),t(e.exports,"memo",(()=>v),(t=>v=t)),t(e.exports,"useCallback",(()=>x),(t=>x=t)),t(e.exports,"useContext",(()=>b),(t=>b=t)),t(e.exports,"useDebugValue",(()=>S),(t=>S=t)),t(e.exports,"useEffect",(()=>C),(t=>C=t)),t(e.exports,"useImperativeHandle",(()=>E),(t=>E=t)),t(e.exports,"useLayoutEffect",(()=>P),(t=>P=t)),t(e.exports,"useMemo",(()=>A),(t=>A=t)),t(e.exports,"useReducer",(()=>k),(t=>k=t)),t(e.exports,"useRef",(()=>T),(t=>T=t)),t(e.exports,"useState",(()=>R),(t=>R=t)),t(e.exports,"version",(()=>M),(t=>M=t));var D=n("iPxqk"),L=60103,B=60106;s=60107,r=60108,o=60114;var I=60109,F=60110,z=60112;a=60113;var N=60115,O=60116;if("function"==typeof Symbol&&Symbol.for){var U=Symbol.for;L=U("react.element"),B=U("react.portal"),s=U("react.fragment"),r=U("react.strict_mode"),o=U("react.profiler"),I=U("react.provider"),F=U("react.context"),z=U("react.forward_ref"),a=U("react.suspense"),N=U("react.memo"),O=U("react.lazy")}var H="function"==typeof Symbol&&Symbol.iterator;function W(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,i=1;i<arguments.length;i++)e+="&args[]="+encodeURIComponent(arguments[i]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var j={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},V={};function q(t,e,i){this.props=t,this.context=e,this.refs=V,this.updater=i||j}function X(){}function G(t,e,i){this.props=t,this.context=e,this.refs=V,this.updater=i||j}q.prototype.isReactComponent={},q.prototype.setState=function(t,e){if("object"!=typeof t&&"function"!=typeof t&&null!=t)throw Error(W(85));this.updater.enqueueSetState(this,t,e,"setState")},q.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")},X.prototype=q.prototype;var K=G.prototype=new X;K.constructor=G,D(K,q.prototype),K.isPureReactComponent=!0;var Y={current:null},Q=Object.prototype.hasOwnProperty,Z={key:!0,ref:!0,__self:!0,__source:!0};function $(t,e,i){var s,n={},r=null,o=null;if(null!=e)for(s in void 0!==e.ref&&(o=e.ref),void 0!==e.key&&(r=""+e.key),e)Q.call(e,s)&&!Z.hasOwnProperty(s)&&(n[s]=e[s]);var a=arguments.length-2;if(1===a)n.children=i;else if(1<a){for(var l=Array(a),h=0;h<a;h++)l[h]=arguments[h+2];n.children=l}if(t&&t.defaultProps)for(s in a=t.defaultProps)void 0===n[s]&&(n[s]=a[s]);return{$$typeof:L,type:t,key:r,ref:o,props:n,_owner:Y.current}}function J(t){return"object"==typeof t&&null!==t&&t.$$typeof===L}var tt=/\/+/g;function et(t,e){return"object"==typeof t&&null!==t&&null!=t.key?function(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,(function(t){return e[t]}))}(""+t.key):e.toString(36)}function it(t,e,i,s,n){var r=typeof t;"undefined"!==r&&"boolean"!==r||(t=null);var o,a=!1;if(null===t)a=!0;else switch(r){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case L:case B:a=!0}}if(a)return n=n(a=t),t=""===s?"."+et(a,0):s,Array.isArray(n)?(i="",null!=t&&(i=t.replace(tt,"$&/")+"/"),it(n,e,i,"",(function(t){return t}))):null!=n&&(J(n)&&(n=function(t,e){return{$$typeof:L,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}(n,i+(!n.key||a&&a.key===n.key?"":(""+n.key).replace(tt,"$&/")+"/")+t)),e.push(n)),1;if(a=0,s=""===s?".":s+":",Array.isArray(t))for(var l=0;l<t.length;l++){var h=s+et(r=t[l],l);a+=it(r,e,i,h,n)}else if("function"==typeof(h=null===(o=t)||"object"!=typeof o?null:"function"==typeof(o=H&&o[H]||o["@@iterator"])?o:null))for(t=h.call(t),l=0;!(r=t.next()).done;)a+=it(r=r.value,e,i,h=s+et(r,l++),n);else if("object"===r)throw e=""+t,Error(W(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e));return a}function st(t,e,i){if(null==t)return t;var s=[],n=0;return it(t,s,"","",(function(t){return e.call(i,t,n++)})),s}function nt(t){if(-1===t._status){var e=t._result;e=e(),t._status=0,t._result=e,e.then((function(e){0===t._status&&(e=e.default,t._status=1,t._result=e)}),(function(e){0===t._status&&(t._status=2,t._result=e)}))}if(1===t._status)return t._result;throw t._result}var rt={current:null};function ot(){var t=rt.current;if(null===t)throw Error(W(321));return t}l={map:st,forEach:function(t,e,i){st(t,(function(){e.apply(this,arguments)}),i)},count:function(t){var e=0;return st(t,(function(){e++})),e},toArray:function(t){return st(t,(function(t){return t}))||[]},only:function(t){if(!J(t))throw Error(W(143));return t}},h=q,c=G,d={ReactCurrentDispatcher:rt,ReactCurrentBatchConfig:{transition:0},ReactCurrentOwner:Y,IsSomeRendererActing:{current:!1},assign:D},u=function(t,e,i){if(null==t)throw Error(W(267,t));var s=D({},t.props),n=t.key,r=t.ref,o=t._owner;if(null!=e){if(void 0!==e.ref&&(r=e.ref,o=Y.current),void 0!==e.key&&(n=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)Q.call(e,l)&&!Z.hasOwnProperty(l)&&(s[l]=void 0===e[l]&&void 0!==a?a[l]:e[l])}var l=arguments.length-2;if(1===l)s.children=i;else if(1<l){a=Array(l);for(var h=0;h<l;h++)a[h]=arguments[h+2];s.children=a}return{$$typeof:L,type:t.type,key:n,ref:r,props:s,_owner:o}},p=function(t,e){return void 0===e&&(e=null),(t={$$typeof:F,_calculateChangedBits:e,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:I,_context:t},t.Consumer=t},g=$,f=function(t){var e=$.bind(null,t);return e.type=t,e},m=function(){return{current:null}},y=function(t){return{$$typeof:z,render:t}},_=J,w=function(t){return{$$typeof:O,_payload:{_status:-1,_result:t},_init:nt}},v=function(t,e){return{$$typeof:N,type:t,compare:void 0===e?null:e}},x=function(t,e){return ot().useCallback(t,e)},b=function(t,e){return ot().useContext(t,e)},S=function(){},C=function(t,e){return ot().useEffect(t,e)},E=function(t,e,i){return ot().useImperativeHandle(t,e,i)},P=function(t,e){return ot().useLayoutEffect(t,e)},A=function(t,e){return ot().useMemo(t,e)},k=function(t,e,i){return ot().useReducer(t,e,i)},T=function(t){return ot().useRef(t)},R=function(t){return ot().useState(t)},M="17.0.2"})),r=n("cKDSi");var o=n("eCRxs"),a={};!function t(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(t){console.error(t)}}(),n.register("fcJjW",(function(e,i){var s,r,o,a,l,h,c,d,u,p,g;t(e.exports,"__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED",(()=>s),(t=>s=t)),t(e.exports,"createPortal",(()=>r),(t=>r=t)),t(e.exports,"findDOMNode",(()=>o),(t=>o=t)),t(e.exports,"flushSync",(()=>a),(t=>a=t)),t(e.exports,"hydrate",(()=>l),(t=>l=t)),t(e.exports,"render",(()=>h),(t=>h=t)),t(e.exports,"unmountComponentAtNode",(()=>c),(t=>c=t)),t(e.exports,"unstable_batchedUpdates",(()=>d),(t=>d=t)),t(e.exports,"unstable_createPortal",(()=>u),(t=>u=t)),t(e.exports,"unstable_renderSubtreeIntoContainer",(()=>p),(t=>p=t)),t(e.exports,"version",(()=>g),(t=>g=t));var f=n("eCRxs"),m=n("iPxqk"),y=n("1Ughu");function _(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,i=1;i<arguments.length;i++)e+="&args[]="+encodeURIComponent(arguments[i]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}if(!f)throw Error(_(227));var w=new Set,v={};function x(t,e){b(t,e),b(t+"Capture",e)}function b(t,e){for(v[t]=e,t=0;t<e.length;t++)w.add(e[t])}var S=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),C=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,E=Object.prototype.hasOwnProperty,P={},A={};function k(t,e,i,s,n,r,o){this.acceptsBooleans=2===e||3===e||4===e,this.attributeName=s,this.attributeNamespace=n,this.mustUseProperty=i,this.propertyName=t,this.type=e,this.sanitizeURL=r,this.removeEmptyString=o}var T={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(t){T[t]=new k(t,0,!1,t,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(t){var e=t[0];T[e]=new k(e,1,!1,t[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(t){T[t]=new k(t,2,!1,t.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(t){T[t]=new k(t,2,!1,t,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(t){T[t]=new k(t,3,!1,t.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(t){T[t]=new k(t,3,!0,t,null,!1,!1)})),["capture","download"].forEach((function(t){T[t]=new k(t,4,!1,t,null,!1,!1)})),["cols","rows","size","span"].forEach((function(t){T[t]=new k(t,6,!1,t,null,!1,!1)})),["rowSpan","start"].forEach((function(t){T[t]=new k(t,5,!1,t.toLowerCase(),null,!1,!1)}));var R=/[\-:]([a-z])/g;function M(t){return t[1].toUpperCase()}function D(t,e,i,s){var n=T.hasOwnProperty(e)?T[e]:null;(null!==n?0===n.type:!s&&(2<e.length&&("o"===e[0]||"O"===e[0])&&("n"===e[1]||"N"===e[1])))||(function(t,e,i,s){if(null==e||function(t,e,i,s){if(null!==i&&0===i.type)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return!s&&(null!==i?!i.acceptsBooleans:"data-"!==(t=t.toLowerCase().slice(0,5))&&"aria-"!==t);default:return!1}}(t,e,i,s))return!0;if(s)return!1;if(null!==i)switch(i.type){case 3:return!e;case 4:return!1===e;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}(e,i,n,s)&&(i=null),s||null===n?function(t){return!!E.call(A,t)||!E.call(P,t)&&(C.test(t)?A[t]=!0:(P[t]=!0,!1))}(e)&&(null===i?t.removeAttribute(e):t.setAttribute(e,""+i)):n.mustUseProperty?t[n.propertyName]=null===i?3!==n.type&&"":i:(e=n.attributeName,s=n.attributeNamespace,null===i?t.removeAttribute(e):(i=3===(n=n.type)||4===n&&!0===i?"":""+i,s?t.setAttributeNS(s,e,i):t.setAttribute(e,i))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(t){var e=t.replace(R,M);T[e]=new k(e,1,!1,t,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(t){var e=t.replace(R,M);T[e]=new k(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(t){var e=t.replace(R,M);T[e]=new k(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(t){T[t]=new k(t,1,!1,t.toLowerCase(),null,!1,!1)})),T.xlinkHref=new k("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(t){T[t]=new k(t,1,!1,t.toLowerCase(),null,!0,!0)}));var L=f.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,B=60103,I=60106,F=60107,z=60108,N=60114,O=60109,U=60110,H=60112,W=60113,j=60120,V=60115,q=60116,X=60121,G=60128,K=60129,Y=60130,Q=60131;if("function"==typeof Symbol&&Symbol.for){var Z=Symbol.for;B=Z("react.element"),I=Z("react.portal"),F=Z("react.fragment"),z=Z("react.strict_mode"),N=Z("react.profiler"),O=Z("react.provider"),U=Z("react.context"),H=Z("react.forward_ref"),W=Z("react.suspense"),j=Z("react.suspense_list"),V=Z("react.memo"),q=Z("react.lazy"),X=Z("react.block"),Z("react.scope"),G=Z("react.opaque.id"),K=Z("react.debug_trace_mode"),Y=Z("react.offscreen"),Q=Z("react.legacy_hidden")}var $,J="function"==typeof Symbol&&Symbol.iterator;function tt(t){return null===t||"object"!=typeof t?null:"function"==typeof(t=J&&t[J]||t["@@iterator"])?t:null}function et(t){if(void 0===$)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);$=e&&e[1]||""}return"\n"+$+t}var it=!1;function st(t,e){if(!t||it)return"";it=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(e,[])}catch(t){var s=t}Reflect.construct(t,[],e)}else{try{e.call()}catch(t){s=t}t.call(e.prototype)}else{try{throw Error()}catch(t){s=t}t()}}catch(t){if(t&&s&&"string"==typeof t.stack){for(var n=t.stack.split("\n"),r=s.stack.split("\n"),o=n.length-1,a=r.length-1;1<=o&&0<=a&&n[o]!==r[a];)a--;for(;1<=o&&0<=a;o--,a--)if(n[o]!==r[a]){if(1!==o||1!==a)do{if(o--,0>--a||n[o]!==r[a])return"\n"+n[o].replace(" at new "," at ")}while(1<=o&&0<=a);break}}}finally{it=!1,Error.prepareStackTrace=i}return(t=t?t.displayName||t.name:"")?et(t):""}function nt(t){switch(t.tag){case 5:return et(t.type);case 16:return et("Lazy");case 13:return et("Suspense");case 19:return et("SuspenseList");case 0:case 2:case 15:return t=st(t.type,!1);case 11:return t=st(t.type.render,!1);case 22:return t=st(t.type._render,!1);case 1:return t=st(t.type,!0);default:return""}}function rt(t){if(null==t)return null;if("function"==typeof t)return t.displayName||t.name||null;if("string"==typeof t)return t;switch(t){case F:return"Fragment";case I:return"Portal";case N:return"Profiler";case z:return"StrictMode";case W:return"Suspense";case j:return"SuspenseList"}if("object"==typeof t)switch(t.$$typeof){case U:return(t.displayName||"Context")+".Consumer";case O:return(t._context.displayName||"Context")+".Provider";case H:var e=t.render;return e=e.displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case V:return rt(t.type);case X:return rt(t._render);case q:e=t._payload,t=t._init;try{return rt(t(e))}catch(t){}}return null}function ot(t){switch(typeof t){case"boolean":case"number":case"object":case"string":case"undefined":return t;default:return""}}function at(t){var e=t.type;return(t=t.nodeName)&&"input"===t.toLowerCase()&&("checkbox"===e||"radio"===e)}function lt(t){t._valueTracker||(t._valueTracker=function(t){var e=at(t)?"checked":"value",i=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),s=""+t[e];if(!t.hasOwnProperty(e)&&void 0!==i&&"function"==typeof i.get&&"function"==typeof i.set){var n=i.get,r=i.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return n.call(this)},set:function(t){s=""+t,r.call(this,t)}}),Object.defineProperty(t,e,{enumerable:i.enumerable}),{getValue:function(){return s},setValue:function(t){s=""+t},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}(t))}function ht(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var i=e.getValue(),s="";return t&&(s=at(t)?t.checked?"true":"false":t.value),(t=s)!==i&&(e.setValue(t),!0)}function ct(t){if(void 0===(t=t||("undefined"!=typeof document?document:void 0)))return null;try{return t.activeElement||t.body}catch(e){return t.body}}function dt(t,e){var i=e.checked;return m({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=i?i:t._wrapperState.initialChecked})}function ut(t,e){var i=null==e.defaultValue?"":e.defaultValue,s=null!=e.checked?e.checked:e.defaultChecked;i=ot(null!=e.value?e.value:i),t._wrapperState={initialChecked:s,initialValue:i,controlled:"checkbox"===e.type||"radio"===e.type?null!=e.checked:null!=e.value}}function pt(t,e){null!=(e=e.checked)&&D(t,"checked",e,!1)}function gt(t,e){pt(t,e);var i=ot(e.value),s=e.type;if(null!=i)"number"===s?(0===i&&""===t.value||t.value!=i)&&(t.value=""+i):t.value!==""+i&&(t.value=""+i);else if("submit"===s||"reset"===s)return void t.removeAttribute("value");e.hasOwnProperty("value")?mt(t,e.type,i):e.hasOwnProperty("defaultValue")&&mt(t,e.type,ot(e.defaultValue)),null==e.checked&&null!=e.defaultChecked&&(t.defaultChecked=!!e.defaultChecked)}function ft(t,e,i){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var s=e.type;if(!("submit"!==s&&"reset"!==s||void 0!==e.value&&null!==e.value))return;e=""+t._wrapperState.initialValue,i||e===t.value||(t.value=e),t.defaultValue=e}""!==(i=t.name)&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,""!==i&&(t.name=i)}function mt(t,e,i){"number"===e&&ct(t.ownerDocument)===t||(null==i?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+i&&(t.defaultValue=""+i))}function yt(t,e){return t=m({children:void 0},e),(e=function(t){var e="";return f.Children.forEach(t,(function(t){null!=t&&(e+=t)})),e}(e.children))&&(t.children=e),t}function _t(t,e,i,s){if(t=t.options,e){e={};for(var n=0;n<i.length;n++)e["$"+i[n]]=!0;for(i=0;i<t.length;i++)n=e.hasOwnProperty("$"+t[i].value),t[i].selected!==n&&(t[i].selected=n),n&&s&&(t[i].defaultSelected=!0)}else{for(i=""+ot(i),e=null,n=0;n<t.length;n++){if(t[n].value===i)return t[n].selected=!0,void(s&&(t[n].defaultSelected=!0));null!==e||t[n].disabled||(e=t[n])}null!==e&&(e.selected=!0)}}function wt(t,e){if(null!=e.dangerouslySetInnerHTML)throw Error(_(91));return m({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function vt(t,e){var i=e.value;if(null==i){if(i=e.children,e=e.defaultValue,null!=i){if(null!=e)throw Error(_(92));if(Array.isArray(i)){if(!(1>=i.length))throw Error(_(93));i=i[0]}e=i}null==e&&(e=""),i=e}t._wrapperState={initialValue:ot(i)}}function xt(t,e){var i=ot(e.value),s=ot(e.defaultValue);null!=i&&((i=""+i)!==t.value&&(t.value=i),null==e.defaultValue&&t.defaultValue!==i&&(t.defaultValue=i)),null!=s&&(t.defaultValue=""+s)}function bt(t){var e=t.textContent;e===t._wrapperState.initialValue&&""!==e&&null!==e&&(t.value=e)}var St="http://www.w3.org/1999/xhtml",Ct="http://www.w3.org/2000/svg";function Et(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Pt(t,e){return null==t||"http://www.w3.org/1999/xhtml"===t?Et(e):"http://www.w3.org/2000/svg"===t&&"foreignObject"===e?"http://www.w3.org/1999/xhtml":t}var At,kt,Tt=(kt=function(t,e){if(t.namespaceURI!==Ct||"innerHTML"in t)t.innerHTML=e;else{for((At=At||document.createElement("div")).innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=At.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}},"undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction?function(t,e,i,s){MSApp.execUnsafeLocalFunction((function(){return kt(t,e)}))}:kt);function Rt(t,e){if(e){var i=t.firstChild;if(i&&i===t.lastChild&&3===i.nodeType)return void(i.nodeValue=e)}t.textContent=e}var Mt={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Dt=["Webkit","ms","Moz","O"];function Lt(t,e,i){return null==e||"boolean"==typeof e||""===e?"":i||"number"!=typeof e||0===e||Mt.hasOwnProperty(t)&&Mt[t]?(""+e).trim():e+"px"}function Bt(t,e){for(var i in t=t.style,e)if(e.hasOwnProperty(i)){var s=0===i.indexOf("--"),n=Lt(i,e[i],s);"float"===i&&(i="cssFloat"),s?t.setProperty(i,n):t[i]=n}}Object.keys(Mt).forEach((function(t){Dt.forEach((function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Mt[e]=Mt[t]}))}));var It=m({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ft(t,e){if(e){if(It[t]&&(null!=e.children||null!=e.dangerouslySetInnerHTML))throw Error(_(137,t));if(null!=e.dangerouslySetInnerHTML){if(null!=e.children)throw Error(_(60));if("object"!=typeof e.dangerouslySetInnerHTML||!("__html"in e.dangerouslySetInnerHTML))throw Error(_(61))}if(null!=e.style&&"object"!=typeof e.style)throw Error(_(62))}}function zt(t,e){if(-1===t.indexOf("-"))return"string"==typeof e.is;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}function Nt(t){return(t=t.target||t.srcElement||window).correspondingUseElement&&(t=t.correspondingUseElement),3===t.nodeType?t.parentNode:t}var Ot=null,Ut=null,Ht=null;function Wt(t){if(t=fn(t)){if("function"!=typeof Ot)throw Error(_(280));var e=t.stateNode;e&&(e=yn(e),Ot(t.stateNode,t.type,e))}}function jt(t){Ut?Ht?Ht.push(t):Ht=[t]:Ut=t}function Vt(){if(Ut){var t=Ut,e=Ht;if(Ht=Ut=null,Wt(t),e)for(t=0;t<e.length;t++)Wt(e[t])}}function qt(t,e){return t(e)}function Xt(t,e,i,s,n){return t(e,i,s,n)}function Gt(){}var Kt=qt,Yt=!1,Qt=!1;function Zt(){null===Ut&&null===Ht||(Gt(),Vt())}function $t(t,e){var i=t.stateNode;if(null===i)return null;var s=yn(i);if(null===s)return null;i=s[e];t:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(s=!("button"===(t=t.type)||"input"===t||"select"===t||"textarea"===t)),t=!s;break t;default:t=!1}if(t)return null;if(i&&"function"!=typeof i)throw Error(_(231,e,typeof i));return i}var Jt=!1;if(S)try{var te={};Object.defineProperty(te,"passive",{get:function(){Jt=!0}}),window.addEventListener("test",te,te),window.removeEventListener("test",te,te)}catch(t){Jt=!1}function ee(t,e,i,s,n,r,o,a,l){var h=Array.prototype.slice.call(arguments,3);try{e.apply(i,h)}catch(t){this.onError(t)}}var ie=!1,se=null,ne=!1,re=null,oe={onError:function(t){ie=!0,se=t}};function ae(t,e,i,s,n,r,o,a,l){ie=!1,se=null,ee.apply(oe,arguments)}function le(t){var e=t,i=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do{0!=(1026&(e=t).flags)&&(i=e.return),t=e.return}while(t)}return 3===e.tag?i:null}function he(t){if(13===t.tag){var e=t.memoizedState;if(null===e&&(null!==(t=t.alternate)&&(e=t.memoizedState)),null!==e)return e.dehydrated}return null}function ce(t){if(le(t)!==t)throw Error(_(188))}function de(t){if(t=function(t){var e=t.alternate;if(!e){if(null===(e=le(t)))throw Error(_(188));return e!==t?null:t}for(var i=t,s=e;;){var n=i.return;if(null===n)break;var r=n.alternate;if(null===r){if(null!==(s=n.return)){i=s;continue}break}if(n.child===r.child){for(r=n.child;r;){if(r===i)return ce(n),t;if(r===s)return ce(n),e;r=r.sibling}throw Error(_(188))}if(i.return!==s.return)i=n,s=r;else{for(var o=!1,a=n.child;a;){if(a===i){o=!0,i=n,s=r;break}if(a===s){o=!0,s=n,i=r;break}a=a.sibling}if(!o){for(a=r.child;a;){if(a===i){o=!0,i=r,s=n;break}if(a===s){o=!0,s=r,i=n;break}a=a.sibling}if(!o)throw Error(_(189))}}if(i.alternate!==s)throw Error(_(190))}if(3!==i.tag)throw Error(_(188));return i.stateNode.current===i?t:e}(t),!t)return null;for(var e=t;;){if(5===e.tag||6===e.tag)return e;if(e.child)e.child.return=e,e=e.child;else{if(e===t)break;for(;!e.sibling;){if(!e.return||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}}return null}function ue(t,e){for(var i=t.alternate;null!==e;){if(e===t||e===i)return!0;e=e.return}return!1}var pe,ge,fe,me,ye=!1,_e=[],we=null,ve=null,xe=null,be=new Map,Se=new Map,Ce=[],Ee="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Pe(t,e,i,s,n){return{blockedOn:t,domEventName:e,eventSystemFlags:16|i,nativeEvent:n,targetContainers:[s]}}function Ae(t,e){switch(t){case"focusin":case"focusout":we=null;break;case"dragenter":case"dragleave":ve=null;break;case"mouseover":case"mouseout":xe=null;break;case"pointerover":case"pointerout":be.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Se.delete(e.pointerId)}}function ke(t,e,i,s,n,r){return null===t||t.nativeEvent!==r?(t=Pe(e,i,s,n,r),null!==e&&(null!==(e=fn(e))&&ge(e)),t):(t.eventSystemFlags|=s,e=t.targetContainers,null!==n&&-1===e.indexOf(n)&&e.push(n),t)}function Te(t){var e=gn(t.target);if(null!==e){var i=le(e);if(null!==i)if(13===(e=i.tag)){if(null!==(e=he(i)))return t.blockedOn=e,void me(t.lanePriority,(function(){y.unstable_runWithPriority(t.priority,(function(){fe(i)}))}))}else if(3===e&&i.stateNode.hydrate)return void(t.blockedOn=3===i.tag?i.stateNode.containerInfo:null)}t.blockedOn=null}function Re(t){if(null!==t.blockedOn)return!1;for(var e=t.targetContainers;0<e.length;){var i=di(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(null!==i)return null!==(e=fn(i))&&ge(e),t.blockedOn=i,!1;e.shift()}return!0}function Me(t,e,i){Re(t)&&i.delete(e)}function De(){for(ye=!1;0<_e.length;){var t=_e[0];if(null!==t.blockedOn){null!==(t=fn(t.blockedOn))&&pe(t);break}for(var e=t.targetContainers;0<e.length;){var i=di(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(null!==i){t.blockedOn=i;break}e.shift()}null===t.blockedOn&&_e.shift()}null!==we&&Re(we)&&(we=null),null!==ve&&Re(ve)&&(ve=null),null!==xe&&Re(xe)&&(xe=null),be.forEach(Me),Se.forEach(Me)}function Le(t,e){t.blockedOn===e&&(t.blockedOn=null,ye||(ye=!0,y.unstable_scheduleCallback(y.unstable_NormalPriority,De)))}function Be(t){function e(e){return Le(e,t)}if(0<_e.length){Le(_e[0],t);for(var i=1;i<_e.length;i++){var s=_e[i];s.blockedOn===t&&(s.blockedOn=null)}}for(null!==we&&Le(we,t),null!==ve&&Le(ve,t),null!==xe&&Le(xe,t),be.forEach(e),Se.forEach(e),i=0;i<Ce.length;i++)(s=Ce[i]).blockedOn===t&&(s.blockedOn=null);for(;0<Ce.length&&null===(i=Ce[0]).blockedOn;)Te(i),null===i.blockedOn&&Ce.shift()}function Ie(t,e){var i={};return i[t.toLowerCase()]=e.toLowerCase(),i["Webkit"+t]="webkit"+e,i["Moz"+t]="moz"+e,i}var Fe={animationend:Ie("Animation","AnimationEnd"),animationiteration:Ie("Animation","AnimationIteration"),animationstart:Ie("Animation","AnimationStart"),transitionend:Ie("Transition","TransitionEnd")},ze={},Ne={};function Oe(t){if(ze[t])return ze[t];if(!Fe[t])return t;var e,i=Fe[t];for(e in i)if(i.hasOwnProperty(e)&&e in Ne)return ze[t]=i[e];return t}S&&(Ne=document.createElement("div").style,"AnimationEvent"in window||(delete Fe.animationend.animation,delete Fe.animationiteration.animation,delete Fe.animationstart.animation),"TransitionEvent"in window||delete Fe.transitionend.transition);var Ue=Oe("animationend"),He=Oe("animationiteration"),We=Oe("animationstart"),je=Oe("transitionend"),Ve=new Map,qe=new Map,Xe=["abort","abort",Ue,"animationEnd",He,"animationIteration",We,"animationStart","canplay","canPlay","canplaythrough","canPlayThrough","durationchange","durationChange","emptied","emptied","encrypted","encrypted","ended","ended","error","error","gotpointercapture","gotPointerCapture","load","load","loadeddata","loadedData","loadedmetadata","loadedMetadata","loadstart","loadStart","lostpointercapture","lostPointerCapture","playing","playing","progress","progress","seeking","seeking","stalled","stalled","suspend","suspend","timeupdate","timeUpdate",je,"transitionEnd","waiting","waiting"];function Ge(t,e){for(var i=0;i<t.length;i+=2){var s=t[i],n=t[i+1];n="on"+(n[0].toUpperCase()+n.slice(1)),qe.set(s,e),Ve.set(s,n),x(n,[s])}}(0,y.unstable_now)();var Ke=8;function Ye(t){if(0!=(1&t))return Ke=15,1;if(0!=(2&t))return Ke=14,2;if(0!=(4&t))return Ke=13,4;var e=24&t;return 0!==e?(Ke=12,e):0!=(32&t)?(Ke=11,32):0!==(e=192&t)?(Ke=10,e):0!=(256&t)?(Ke=9,256):0!==(e=3584&t)?(Ke=8,e):0!=(4096&t)?(Ke=7,4096):0!==(e=4186112&t)?(Ke=6,e):0!==(e=62914560&t)?(Ke=5,e):67108864&t?(Ke=4,67108864):0!=(134217728&t)?(Ke=3,134217728):0!==(e=805306368&t)?(Ke=2,e):0!=(1073741824&t)?(Ke=1,1073741824):(Ke=8,t)}function Qe(t,e){var i=t.pendingLanes;if(0===i)return Ke=0;var s=0,n=0,r=t.expiredLanes,o=t.suspendedLanes,a=t.pingedLanes;if(0!==r)s=r,n=Ke=15;else if(0!==(r=134217727&i)){var l=r&~o;0!==l?(s=Ye(l),n=Ke):0!==(a&=r)&&(s=Ye(a),n=Ke)}else 0!==(r=i&~o)?(s=Ye(r),n=Ke):0!==a&&(s=Ye(a),n=Ke);if(0===s)return 0;if(s=i&((0>(s=31-ii(s))?0:1<<s)<<1)-1,0!==e&&e!==s&&0==(e&o)){if(Ye(e),n<=Ke)return e;Ke=n}if(0!==(e=t.entangledLanes))for(t=t.entanglements,e&=s;0<e;)n=1<<(i=31-ii(e)),s|=t[i],e&=~n;return s}function Ze(t){return 0!==(t=-1073741825&t.pendingLanes)?t:1073741824&t?1073741824:0}function $e(t,e){switch(t){case 15:return 1;case 14:return 2;case 12:return 0===(t=Je(24&~e))?$e(10,e):t;case 10:return 0===(t=Je(192&~e))?$e(8,e):t;case 8:return 0===(t=Je(3584&~e))&&(0===(t=Je(4186112&~e))&&(t=512)),t;case 2:return 0===(e=Je(805306368&~e))&&(e=268435456),e}throw Error(_(358,t))}function Je(t){return t&-t}function ti(t){for(var e=[],i=0;31>i;i++)e.push(t);return e}function ei(t,e,i){t.pendingLanes|=e;var s=e-1;t.suspendedLanes&=s,t.pingedLanes&=s,(t=t.eventTimes)[e=31-ii(e)]=i}var ii=Math.clz32?Math.clz32:function(t){return 0===t?32:31-(si(t)/ni|0)|0},si=Math.log,ni=Math.LN2;var ri=y.unstable_UserBlockingPriority,oi=y.unstable_runWithPriority,ai=!0;function li(t,e,i,s){Yt||Gt();var n=ci,r=Yt;Yt=!0;try{Xt(n,t,e,i,s)}finally{(Yt=r)||Zt()}}function hi(t,e,i,s){oi(ri,ci.bind(null,t,e,i,s))}function ci(t,e,i,s){var n;if(ai)if((n=0==(4&e))&&0<_e.length&&-1<Ee.indexOf(t))t=Pe(null,t,e,i,s),_e.push(t);else{var r=di(t,e,i,s);if(null===r)n&&Ae(t,s);else{if(n){if(-1<Ee.indexOf(t))return t=Pe(r,t,e,i,s),void _e.push(t);if(function(t,e,i,s,n){switch(e){case"focusin":return we=ke(we,t,e,i,s,n),!0;case"dragenter":return ve=ke(ve,t,e,i,s,n),!0;case"mouseover":return xe=ke(xe,t,e,i,s,n),!0;case"pointerover":var r=n.pointerId;return be.set(r,ke(be.get(r)||null,t,e,i,s,n)),!0;case"gotpointercapture":return r=n.pointerId,Se.set(r,ke(Se.get(r)||null,t,e,i,s,n)),!0}return!1}(r,t,e,i,s))return;Ae(t,s)}Xs(t,e,s,null,i)}}}function di(t,e,i,s){var n=Nt(s);if(null!==(n=gn(n))){var r=le(n);if(null===r)n=null;else{var o=r.tag;if(13===o){if(null!==(n=he(r)))return n;n=null}else if(3===o){if(r.stateNode.hydrate)return 3===r.tag?r.stateNode.containerInfo:null;n=null}else r!==n&&(n=null)}}return Xs(t,e,s,n,i),null}var ui=null,pi=null,gi=null;function fi(){if(gi)return gi;var t,e,i=pi,s=i.length,n="value"in ui?ui.value:ui.textContent,r=n.length;for(t=0;t<s&&i[t]===n[t];t++);var o=s-t;for(e=1;e<=o&&i[s-e]===n[r-e];e++);return gi=n.slice(t,1<e?1-e:void 0)}function mi(t){var e=t.keyCode;return"charCode"in t?0===(t=t.charCode)&&13===e&&(t=13):t=e,10===t&&(t=13),32<=t||13===t?t:0}function yi(){return!0}function _i(){return!1}function wi(t){function e(e,i,s,n,r){for(var o in this._reactName=e,this._targetInst=s,this.type=i,this.nativeEvent=n,this.target=r,this.currentTarget=null,t)t.hasOwnProperty(o)&&(e=t[o],this[o]=e?e(n):n[o]);return this.isDefaultPrevented=(null!=n.defaultPrevented?n.defaultPrevented:!1===n.returnValue)?yi:_i,this.isPropagationStopped=_i,this}return m(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():"unknown"!=typeof t.returnValue&&(t.returnValue=!1),this.isDefaultPrevented=yi)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():"unknown"!=typeof t.cancelBubble&&(t.cancelBubble=!0),this.isPropagationStopped=yi)},persist:function(){},isPersistent:yi}),e}var vi,xi,bi,Si={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ci=wi(Si),Ei=m({},Si,{view:0,detail:0}),Pi=wi(Ei),Ai=m({},Ei,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Oi,button:0,buttons:0,relatedTarget:function(t){return void 0===t.relatedTarget?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==bi&&(bi&&"mousemove"===t.type?(vi=t.screenX-bi.screenX,xi=t.screenY-bi.screenY):xi=vi=0,bi=t),vi)},movementY:function(t){return"movementY"in t?t.movementY:xi}}),ki=wi(Ai),Ti=wi(m({},Ai,{dataTransfer:0})),Ri=wi(m({},Ei,{relatedTarget:0})),Mi=wi(m({},Si,{animationName:0,elapsedTime:0,pseudoElement:0})),Di=m({},Si,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Li=wi(Di),Bi=wi(m({},Si,{data:0})),Ii={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Fi={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},zi={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ni(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):!!(t=zi[t])&&!!e[t]}function Oi(){return Ni}var Ui=m({},Ei,{key:function(t){if(t.key){var e=Ii[t.key]||t.key;if("Unidentified"!==e)return e}return"keypress"===t.type?13===(t=mi(t))?"Enter":String.fromCharCode(t):"keydown"===t.type||"keyup"===t.type?Fi[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Oi,charCode:function(t){return"keypress"===t.type?mi(t):0},keyCode:function(t){return"keydown"===t.type||"keyup"===t.type?t.keyCode:0},which:function(t){return"keypress"===t.type?mi(t):"keydown"===t.type||"keyup"===t.type?t.keyCode:0}}),Hi=wi(Ui),Wi=wi(m({},Ai,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),ji=wi(m({},Ei,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Oi})),Vi=wi(m({},Si,{propertyName:0,elapsedTime:0,pseudoElement:0})),qi=m({},Ai,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Xi=wi(qi),Gi=[9,13,27,32],Ki=S&&"CompositionEvent"in window,Yi=null;S&&"documentMode"in document&&(Yi=document.documentMode);var Qi=S&&"TextEvent"in window&&!Yi,Zi=S&&(!Ki||Yi&&8<Yi&&11>=Yi),$i=String.fromCharCode(32),Ji=!1;function ts(t,e){switch(t){case"keyup":return-1!==Gi.indexOf(e.keyCode);case"keydown":return 229!==e.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function es(t){return"object"==typeof(t=t.detail)&&"data"in t?t.data:null}var is=!1;var ss={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ns(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return"input"===e?!!ss[t.type]:"textarea"===e}function rs(t,e,i,s){jt(s),0<(e=Ks(e,"onChange")).length&&(i=new Ci("onChange","change",null,i,s),t.push({event:i,listeners:e}))}var os=null,as=null;function ls(t){Us(t,0)}function hs(t){if(ht(mn(t)))return t}function cs(t,e){if("change"===t)return e}var ds=!1;if(S){var us;if(S){var ps="oninput"in document;if(!ps){var gs=document.createElement("div");gs.setAttribute("oninput","return;"),ps="function"==typeof gs.oninput}us=ps}else us=!1;ds=us&&(!document.documentMode||9<document.documentMode)}function fs(){os&&(os.detachEvent("onpropertychange",ms),as=os=null)}function ms(t){if("value"===t.propertyName&&hs(as)){var e=[];if(rs(e,as,t,Nt(t)),t=ls,Yt)t(e);else{Yt=!0;try{qt(t,e)}finally{Yt=!1,Zt()}}}}function ys(t,e,i){"focusin"===t?(fs(),as=i,(os=e).attachEvent("onpropertychange",ms)):"focusout"===t&&fs()}function _s(t){if("selectionchange"===t||"keyup"===t||"keydown"===t)return hs(as)}function ws(t,e){if("click"===t)return hs(e)}function vs(t,e){if("input"===t||"change"===t)return hs(e)}var xs="function"==typeof Object.is?Object.is:function(t,e){return t===e&&(0!==t||1/t==1/e)||t!=t&&e!=e},bs=Object.prototype.hasOwnProperty;function Ss(t,e){if(xs(t,e))return!0;if("object"!=typeof t||null===t||"object"!=typeof e||null===e)return!1;var i=Object.keys(t),s=Object.keys(e);if(i.length!==s.length)return!1;for(s=0;s<i.length;s++)if(!bs.call(e,i[s])||!xs(t[i[s]],e[i[s]]))return!1;return!0}function Cs(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Es(t,e){var i,s=Cs(t);for(t=0;s;){if(3===s.nodeType){if(i=t+s.textContent.length,t<=e&&i>=e)return{node:s,offset:e-t};t=i}t:{for(;s;){if(s.nextSibling){s=s.nextSibling;break t}s=s.parentNode}s=void 0}s=Cs(s)}}function Ps(t,e){return!(!t||!e)&&(t===e||(!t||3!==t.nodeType)&&(e&&3===e.nodeType?Ps(t,e.parentNode):"contains"in t?t.contains(e):!!t.compareDocumentPosition&&!!(16&t.compareDocumentPosition(e))))}function As(){for(var t=window,e=ct();e instanceof t.HTMLIFrameElement;){try{var i="string"==typeof e.contentWindow.location.href}catch(t){i=!1}if(!i)break;e=ct((t=e.contentWindow).document)}return e}function ks(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&("input"===e&&("text"===t.type||"search"===t.type||"tel"===t.type||"url"===t.type||"password"===t.type)||"textarea"===e||"true"===t.contentEditable)}var Ts=S&&"documentMode"in document&&11>=document.documentMode,Rs=null,Ms=null,Ds=null,Ls=!1;function Bs(t,e,i){var s=i.window===i?i.document:9===i.nodeType?i:i.ownerDocument;Ls||null==Rs||Rs!==ct(s)||("selectionStart"in(s=Rs)&&ks(s)?s={start:s.selectionStart,end:s.selectionEnd}:s={anchorNode:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset},Ds&&Ss(Ds,s)||(Ds=s,0<(s=Ks(Ms,"onSelect")).length&&(e=new Ci("onSelect","select",null,e,i),t.push({event:e,listeners:s}),e.target=Rs)))}Ge("cancel cancel click click close close contextmenu contextMenu copy copy cut cut auxclick auxClick dblclick doubleClick dragend dragEnd dragstart dragStart drop drop focusin focus focusout blur input input invalid invalid keydown keyDown keypress keyPress keyup keyUp mousedown mouseDown mouseup mouseUp paste paste pause pause play play pointercancel pointerCancel pointerdown pointerDown pointerup pointerUp ratechange rateChange reset reset seeked seeked submit submit touchcancel touchCancel touchend touchEnd touchstart touchStart volumechange volumeChange".split(" "),0),Ge("drag drag dragenter dragEnter dragexit dragExit dragleave dragLeave dragover dragOver mousemove mouseMove mouseout mouseOut mouseover mouseOver pointermove pointerMove pointerout pointerOut pointerover pointerOver scroll scroll toggle toggle touchmove touchMove wheel wheel".split(" "),1),Ge(Xe,2);for(var Is="change selectionchange textInput compositionstart compositionend compositionupdate".split(" "),Fs=0;Fs<Is.length;Fs++)qe.set(Is[Fs],0);b("onMouseEnter",["mouseout","mouseover"]),b("onMouseLeave",["mouseout","mouseover"]),b("onPointerEnter",["pointerout","pointerover"]),b("onPointerLeave",["pointerout","pointerover"]),x("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),x("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),x("onBeforeInput",["compositionend","keypress","textInput","paste"]),x("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),x("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),x("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var zs="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ns=new Set("cancel close invalid load scroll toggle".split(" ").concat(zs));function Os(t,e,i){var s=t.type||"unknown-event";t.currentTarget=i,function(t,e,i,s,n,r,o,a,l){if(ae.apply(this,arguments),ie){if(!ie)throw Error(_(198));var h=se;ie=!1,se=null,ne||(ne=!0,re=h)}}(s,e,void 0,t),t.currentTarget=null}function Us(t,e){e=0!=(4&e);for(var i=0;i<t.length;i++){var s=t[i],n=s.event;s=s.listeners;t:{var r=void 0;if(e)for(var o=s.length-1;0<=o;o--){var a=s[o],l=a.instance,h=a.currentTarget;if(a=a.listener,l!==r&&n.isPropagationStopped())break t;Os(n,a,h),r=l}else for(o=0;o<s.length;o++){if(l=(a=s[o]).instance,h=a.currentTarget,a=a.listener,l!==r&&n.isPropagationStopped())break t;Os(n,a,h),r=l}}}if(ne)throw t=re,ne=!1,re=null,t}function Hs(t,e){var i=_n(e),s=t+"__bubble";i.has(s)||(qs(e,t,2,!1),i.add(s))}var Ws="_reactListening"+Math.random().toString(36).slice(2);function js(t){t[Ws]||(t[Ws]=!0,w.forEach((function(e){Ns.has(e)||Vs(e,!1,t,null),Vs(e,!0,t,null)})))}function Vs(t,e,i,s){var n=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,r=i;if("selectionchange"===t&&9!==i.nodeType&&(r=i.ownerDocument),null!==s&&!e&&Ns.has(t)){if("scroll"!==t)return;n|=2,r=s}var o=_n(r),a=t+"__"+(e?"capture":"bubble");o.has(a)||(e&&(n|=4),qs(r,t,n,e),o.add(a))}function qs(t,e,i,s){var n=qe.get(e);switch(void 0===n?2:n){case 0:n=li;break;case 1:n=hi;break;default:n=ci}i=n.bind(null,e,i,t),n=void 0,!Jt||"touchstart"!==e&&"touchmove"!==e&&"wheel"!==e||(n=!0),s?void 0!==n?t.addEventListener(e,i,{capture:!0,passive:n}):t.addEventListener(e,i,!0):void 0!==n?t.addEventListener(e,i,{passive:n}):t.addEventListener(e,i,!1)}function Xs(t,e,i,s,n){var r=s;if(0==(1&e)&&0==(2&e)&&null!==s)t:for(;;){if(null===s)return;var o=s.tag;if(3===o||4===o){var a=s.stateNode.containerInfo;if(a===n||8===a.nodeType&&a.parentNode===n)break;if(4===o)for(o=s.return;null!==o;){var l=o.tag;if((3===l||4===l)&&((l=o.stateNode.containerInfo)===n||8===l.nodeType&&l.parentNode===n))return;o=o.return}for(;null!==a;){if(null===(o=gn(a)))return;if(5===(l=o.tag)||6===l){s=r=o;continue t}a=a.parentNode}}s=s.return}!function(t,e,i){if(Qt)return t(e,i);Qt=!0;try{Kt(t,e,i)}finally{Qt=!1,Zt()}}((function(){var s=r,n=Nt(i),o=[];t:{var a=Ve.get(t);if(void 0!==a){var l=Ci,h=t;switch(t){case"keypress":if(0===mi(i))break t;case"keydown":case"keyup":l=Hi;break;case"focusin":h="focus",l=Ri;break;case"focusout":h="blur",l=Ri;break;case"beforeblur":case"afterblur":l=Ri;break;case"click":if(2===i.button)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=ki;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=Ti;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=ji;break;case Ue:case He:case We:l=Mi;break;case je:l=Vi;break;case"scroll":l=Pi;break;case"wheel":l=Xi;break;case"copy":case"cut":case"paste":l=Li;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Wi}var c=0!=(4&e),d=!c&&"scroll"===t,u=c?null!==a?a+"Capture":null:a;c=[];for(var p,g=s;null!==g;){var f=(p=g).stateNode;if(5===p.tag&&null!==f&&(p=f,null!==u&&(null!=(f=$t(g,u))&&c.push(Gs(g,f,p)))),d)break;g=g.return}0<c.length&&(a=new l(a,h,null,i,n),o.push({event:a,listeners:c}))}}if(0==(7&e)){if(l="mouseout"===t||"pointerout"===t,(!(a="mouseover"===t||"pointerover"===t)||0!=(16&e)||!(h=i.relatedTarget||i.fromElement)||!gn(h)&&!h[un])&&(l||a)&&(a=n.window===n?n:(a=n.ownerDocument)?a.defaultView||a.parentWindow:window,l?(l=s,null!==(h=(h=i.relatedTarget||i.toElement)?gn(h):null)&&(h!==(d=le(h))||5!==h.tag&&6!==h.tag)&&(h=null)):(l=null,h=s),l!==h)){if(c=ki,f="onMouseLeave",u="onMouseEnter",g="mouse","pointerout"!==t&&"pointerover"!==t||(c=Wi,f="onPointerLeave",u="onPointerEnter",g="pointer"),d=null==l?a:mn(l),p=null==h?a:mn(h),(a=new c(f,g+"leave",l,i,n)).target=d,a.relatedTarget=p,f=null,gn(n)===s&&((c=new c(u,g+"enter",h,i,n)).target=p,c.relatedTarget=d,f=c),d=f,l&&h)t:{for(u=h,g=0,p=c=l;p;p=Ys(p))g++;for(p=0,f=u;f;f=Ys(f))p++;for(;0<g-p;)c=Ys(c),g--;for(;0<p-g;)u=Ys(u),p--;for(;g--;){if(c===u||null!==u&&c===u.alternate)break t;c=Ys(c),u=Ys(u)}c=null}else c=null;null!==l&&Qs(o,a,l,c,!1),null!==h&&null!==d&&Qs(o,d,h,c,!0)}if("select"===(l=(a=s?mn(s):window).nodeName&&a.nodeName.toLowerCase())||"input"===l&&"file"===a.type)var m=cs;else if(ns(a))if(ds)m=vs;else{m=_s;var y=ys}else(l=a.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===a.type||"radio"===a.type)&&(m=ws);switch(m&&(m=m(t,s))?rs(o,m,i,n):(y&&y(t,a,s),"focusout"===t&&(y=a._wrapperState)&&y.controlled&&"number"===a.type&&mt(a,"number",a.value)),y=s?mn(s):window,t){case"focusin":(ns(y)||"true"===y.contentEditable)&&(Rs=y,Ms=s,Ds=null);break;case"focusout":Ds=Ms=Rs=null;break;case"mousedown":Ls=!0;break;case"contextmenu":case"mouseup":case"dragend":Ls=!1,Bs(o,i,n);break;case"selectionchange":if(Ts)break;case"keydown":case"keyup":Bs(o,i,n)}var _;if(Ki)t:{switch(t){case"compositionstart":var w="onCompositionStart";break t;case"compositionend":w="onCompositionEnd";break t;case"compositionupdate":w="onCompositionUpdate";break t}w=void 0}else is?ts(t,i)&&(w="onCompositionEnd"):"keydown"===t&&229===i.keyCode&&(w="onCompositionStart");w&&(Zi&&"ko"!==i.locale&&(is||"onCompositionStart"!==w?"onCompositionEnd"===w&&is&&(_=fi()):(pi="value"in(ui=n)?ui.value:ui.textContent,is=!0)),0<(y=Ks(s,w)).length&&(w=new Bi(w,t,null,i,n),o.push({event:w,listeners:y}),_?w.data=_:null!==(_=es(i))&&(w.data=_))),(_=Qi?function(t,e){switch(t){case"compositionend":return es(e);case"keypress":return 32!==e.which?null:(Ji=!0,$i);case"textInput":return(t=e.data)===$i&&Ji?null:t;default:return null}}(t,i):function(t,e){if(is)return"compositionend"===t||!Ki&&ts(t,e)?(t=fi(),gi=pi=ui=null,is=!1,t):null;switch(t){case"paste":default:return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Zi&&"ko"!==e.locale?null:e.data}}(t,i))&&(0<(s=Ks(s,"onBeforeInput")).length&&(n=new Bi("onBeforeInput","beforeinput",null,i,n),o.push({event:n,listeners:s}),n.data=_))}Us(o,e)}))}function Gs(t,e,i){return{instance:t,listener:e,currentTarget:i}}function Ks(t,e){for(var i=e+"Capture",s=[];null!==t;){var n=t,r=n.stateNode;5===n.tag&&null!==r&&(n=r,null!=(r=$t(t,i))&&s.unshift(Gs(t,r,n)),null!=(r=$t(t,e))&&s.push(Gs(t,r,n))),t=t.return}return s}function Ys(t){if(null===t)return null;do{t=t.return}while(t&&5!==t.tag);return t||null}function Qs(t,e,i,s,n){for(var r=e._reactName,o=[];null!==i&&i!==s;){var a=i,l=a.alternate,h=a.stateNode;if(null!==l&&l===s)break;5===a.tag&&null!==h&&(a=h,n?null!=(l=$t(i,r))&&o.unshift(Gs(i,l,a)):n||null!=(l=$t(i,r))&&o.push(Gs(i,l,a))),i=i.return}0!==o.length&&t.push({event:e,listeners:o})}function Zs(){}var $s=null,Js=null;function tn(t,e){switch(t){case"button":case"input":case"select":case"textarea":return!!e.autoFocus}return!1}function en(t,e){return"textarea"===t||"option"===t||"noscript"===t||"string"==typeof e.children||"number"==typeof e.children||"object"==typeof e.dangerouslySetInnerHTML&&null!==e.dangerouslySetInnerHTML&&null!=e.dangerouslySetInnerHTML.__html}var sn="function"==typeof setTimeout?setTimeout:void 0,nn="function"==typeof clearTimeout?clearTimeout:void 0;function rn(t){1===t.nodeType?t.textContent="":9===t.nodeType&&(null!=(t=t.body)&&(t.textContent=""))}function on(t){for(;null!=t;t=t.nextSibling){var e=t.nodeType;if(1===e||3===e)break}return t}function an(t){t=t.previousSibling;for(var e=0;t;){if(8===t.nodeType){var i=t.data;if("$"===i||"$!"===i||"$?"===i){if(0===e)return t;e--}else"/$"===i&&e++}t=t.previousSibling}return null}var ln=0;var hn=Math.random().toString(36).slice(2),cn="__reactFiber$"+hn,dn="__reactProps$"+hn,un="__reactContainer$"+hn,pn="__reactEvents$"+hn;function gn(t){var e=t[cn];if(e)return e;for(var i=t.parentNode;i;){if(e=i[un]||i[cn]){if(i=e.alternate,null!==e.child||null!==i&&null!==i.child)for(t=an(t);null!==t;){if(i=t[cn])return i;t=an(t)}return e}i=(t=i).parentNode}return null}function fn(t){return!(t=t[cn]||t[un])||5!==t.tag&&6!==t.tag&&13!==t.tag&&3!==t.tag?null:t}function mn(t){if(5===t.tag||6===t.tag)return t.stateNode;throw Error(_(33))}function yn(t){return t[dn]||null}function _n(t){var e=t[pn];return void 0===e&&(e=t[pn]=new Set),e}var wn=[],vn=-1;function xn(t){return{current:t}}function bn(t){0>vn||(t.current=wn[vn],wn[vn]=null,vn--)}function Sn(t,e){vn++,wn[vn]=t.current,t.current=e}var Cn={},En=xn(Cn),Pn=xn(!1),An=Cn;function kn(t,e){var i=t.type.contextTypes;if(!i)return Cn;var s=t.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===e)return s.__reactInternalMemoizedMaskedChildContext;var n,r={};for(n in i)r[n]=e[n];return s&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=r),r}function Tn(t){return null!=(t=t.childContextTypes)}function Rn(){bn(Pn),bn(En)}function Mn(t,e,i){if(En.current!==Cn)throw Error(_(168));Sn(En,e),Sn(Pn,i)}function Dn(t,e,i){var s=t.stateNode;if(t=e.childContextTypes,"function"!=typeof s.getChildContext)return i;for(var n in s=s.getChildContext())if(!(n in t))throw Error(_(108,rt(e)||"Unknown",n));return m({},i,s)}function Ln(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Cn,An=En.current,Sn(En,t),Sn(Pn,Pn.current),!0}function Bn(t,e,i){var s=t.stateNode;if(!s)throw Error(_(169));i?(t=Dn(t,e,An),s.__reactInternalMemoizedMergedChildContext=t,bn(Pn),bn(En),Sn(En,t)):bn(Pn),Sn(Pn,i)}var In=null,Fn=null,zn=y.unstable_runWithPriority,Nn=y.unstable_scheduleCallback,On=y.unstable_cancelCallback,Un=y.unstable_shouldYield,Hn=y.unstable_requestPaint,Wn=y.unstable_now,jn=y.unstable_getCurrentPriorityLevel,Vn=y.unstable_ImmediatePriority,qn=y.unstable_UserBlockingPriority,Xn=y.unstable_NormalPriority,Gn=y.unstable_LowPriority,Kn=y.unstable_IdlePriority,Yn={},Qn=void 0!==Hn?Hn:function(){},Zn=null,$n=null,Jn=!1,tr=Wn(),er=1e4>tr?Wn:function(){return Wn()-tr};function ir(){switch(jn()){case Vn:return 99;case qn:return 98;case Xn:return 97;case Gn:return 96;case Kn:return 95;default:throw Error(_(332))}}function sr(t){switch(t){case 99:return Vn;case 98:return qn;case 97:return Xn;case 96:return Gn;case 95:return Kn;default:throw Error(_(332))}}function nr(t,e){return t=sr(t),zn(t,e)}function rr(t,e,i){return t=sr(t),Nn(t,e,i)}function or(){if(null!==$n){var t=$n;$n=null,On(t)}ar()}function ar(){if(!Jn&&null!==Zn){Jn=!0;var t=0;try{var e=Zn;nr(99,(function(){for(;t<e.length;t++){var i=e[t];do{i=i(!0)}while(null!==i)}})),Zn=null}catch(e){throw null!==Zn&&(Zn=Zn.slice(t+1)),Nn(Vn,or),e}finally{Jn=!1}}}var lr=L.ReactCurrentBatchConfig;function hr(t,e){if(t&&t.defaultProps){for(var i in e=m({},e),t=t.defaultProps)void 0===e[i]&&(e[i]=t[i]);return e}return e}var cr=xn(null),dr=null,ur=null,pr=null;function gr(){pr=ur=dr=null}function fr(t){var e=cr.current;bn(cr),t.type._context._currentValue=e}function mr(t,e){for(;null!==t;){var i=t.alternate;if((t.childLanes&e)===e){if(null===i||(i.childLanes&e)===e)break;i.childLanes|=e}else t.childLanes|=e,null!==i&&(i.childLanes|=e);t=t.return}}function yr(t,e){dr=t,pr=ur=null,null!==(t=t.dependencies)&&null!==t.firstContext&&(0!=(t.lanes&e)&&(Yo=!0),t.firstContext=null)}function _r(t,e){if(pr!==t&&!1!==e&&0!==e)if("number"==typeof e&&1073741823!==e||(pr=t,e=1073741823),e={context:t,observedBits:e,next:null},null===ur){if(null===dr)throw Error(_(308));ur=e,dr.dependencies={lanes:0,firstContext:e,responders:null}}else ur=ur.next=e;return t._currentValue}var wr=!1;function vr(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null},effects:null}}function xr(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function br(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Sr(t,e){if(null!==(t=t.updateQueue)){var i=(t=t.shared).pending;null===i?e.next=e:(e.next=i.next,i.next=e),t.pending=e}}function Cr(t,e){var i=t.updateQueue,s=t.alternate;if(null!==s&&i===(s=s.updateQueue)){var n=null,r=null;if(null!==(i=i.firstBaseUpdate)){do{var o={eventTime:i.eventTime,lane:i.lane,tag:i.tag,payload:i.payload,callback:i.callback,next:null};null===r?n=r=o:r=r.next=o,i=i.next}while(null!==i);null===r?n=r=e:r=r.next=e}else n=r=e;return i={baseState:s.baseState,firstBaseUpdate:n,lastBaseUpdate:r,shared:s.shared,effects:s.effects},void(t.updateQueue=i)}null===(t=i.lastBaseUpdate)?i.firstBaseUpdate=e:t.next=e,i.lastBaseUpdate=e}function Er(t,e,i,s){var n=t.updateQueue;wr=!1;var r=n.firstBaseUpdate,o=n.lastBaseUpdate,a=n.shared.pending;if(null!==a){n.shared.pending=null;var l=a,h=l.next;l.next=null,null===o?r=h:o.next=h,o=l;var c=t.alternate;if(null!==c){var d=(c=c.updateQueue).lastBaseUpdate;d!==o&&(null===d?c.firstBaseUpdate=h:d.next=h,c.lastBaseUpdate=l)}}if(null!==r){for(d=n.baseState,o=0,c=h=l=null;;){a=r.lane;var u=r.eventTime;if((s&a)===a){null!==c&&(c=c.next={eventTime:u,lane:0,tag:r.tag,payload:r.payload,callback:r.callback,next:null});t:{var p=t,g=r;switch(a=e,u=i,g.tag){case 1:if("function"==typeof(p=g.payload)){d=p.call(u,d,a);break t}d=p;break t;case 3:p.flags=-4097&p.flags|64;case 0:if(null==(a="function"==typeof(p=g.payload)?p.call(u,d,a):p))break t;d=m({},d,a);break t;case 2:wr=!0}}null!==r.callback&&(t.flags|=32,null===(a=n.effects)?n.effects=[r]:a.push(r))}else u={eventTime:u,lane:a,tag:r.tag,payload:r.payload,callback:r.callback,next:null},null===c?(h=c=u,l=d):c=c.next=u,o|=a;if(null===(r=r.next)){if(null===(a=n.shared.pending))break;r=a.next,a.next=null,n.lastBaseUpdate=a,n.shared.pending=null}}null===c&&(l=d),n.baseState=l,n.firstBaseUpdate=h,n.lastBaseUpdate=c,Ja|=o,t.lanes=o,t.memoizedState=d}}function Pr(t,e,i){if(t=e.effects,e.effects=null,null!==t)for(e=0;e<t.length;e++){var s=t[e],n=s.callback;if(null!==n){if(s.callback=null,s=i,"function"!=typeof n)throw Error(_(191,n));n.call(s)}}}var Ar=(new f.Component).refs;function kr(t,e,i,s){i=null==(i=i(s,e=t.memoizedState))?e:m({},e,i),t.memoizedState=i,0===t.lanes&&(t.updateQueue.baseState=i)}var Tr={isMounted:function(t){return!!(t=t._reactInternals)&&le(t)===t},enqueueSetState:function(t,e,i){t=t._reactInternals;var s=Cl(),n=El(t),r=br(s,n);r.payload=e,null!=i&&(r.callback=i),Sr(t,r),Pl(t,n,s)},enqueueReplaceState:function(t,e,i){t=t._reactInternals;var s=Cl(),n=El(t),r=br(s,n);r.tag=1,r.payload=e,null!=i&&(r.callback=i),Sr(t,r),Pl(t,n,s)},enqueueForceUpdate:function(t,e){t=t._reactInternals;var i=Cl(),s=El(t),n=br(i,s);n.tag=2,null!=e&&(n.callback=e),Sr(t,n),Pl(t,s,i)}};function Rr(t,e,i,s,n,r,o){return"function"==typeof(t=t.stateNode).shouldComponentUpdate?t.shouldComponentUpdate(s,r,o):!e.prototype||!e.prototype.isPureReactComponent||(!Ss(i,s)||!Ss(n,r))}function Mr(t,e,i){var s=!1,n=Cn,r=e.contextType;return"object"==typeof r&&null!==r?r=_r(r):(n=Tn(e)?An:En.current,r=(s=null!=(s=e.contextTypes))?kn(t,n):Cn),e=new e(i,r),t.memoizedState=null!==e.state&&void 0!==e.state?e.state:null,e.updater=Tr,t.stateNode=e,e._reactInternals=t,s&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=n,t.__reactInternalMemoizedMaskedChildContext=r),e}function Dr(t,e,i,s){t=e.state,"function"==typeof e.componentWillReceiveProps&&e.componentWillReceiveProps(i,s),"function"==typeof e.UNSAFE_componentWillReceiveProps&&e.UNSAFE_componentWillReceiveProps(i,s),e.state!==t&&Tr.enqueueReplaceState(e,e.state,null)}function Lr(t,e,i,s){var n=t.stateNode;n.props=i,n.state=t.memoizedState,n.refs=Ar,vr(t);var r=e.contextType;"object"==typeof r&&null!==r?n.context=_r(r):(r=Tn(e)?An:En.current,n.context=kn(t,r)),Er(t,i,n,s),n.state=t.memoizedState,"function"==typeof(r=e.getDerivedStateFromProps)&&(kr(t,e,r,i),n.state=t.memoizedState),"function"==typeof e.getDerivedStateFromProps||"function"==typeof n.getSnapshotBeforeUpdate||"function"!=typeof n.UNSAFE_componentWillMount&&"function"!=typeof n.componentWillMount||(e=n.state,"function"==typeof n.componentWillMount&&n.componentWillMount(),"function"==typeof n.UNSAFE_componentWillMount&&n.UNSAFE_componentWillMount(),e!==n.state&&Tr.enqueueReplaceState(n,n.state,null),Er(t,i,n,s),n.state=t.memoizedState),"function"==typeof n.componentDidMount&&(t.flags|=4)}var Br=Array.isArray;function Ir(t,e,i){if(null!==(t=i.ref)&&"function"!=typeof t&&"object"!=typeof t){if(i._owner){if(i=i._owner){if(1!==i.tag)throw Error(_(309));var s=i.stateNode}if(!s)throw Error(_(147,t));var n=""+t;return null!==e&&null!==e.ref&&"function"==typeof e.ref&&e.ref._stringRef===n?e.ref:(e=function(t){var e=s.refs;e===Ar&&(e=s.refs={}),null===t?delete e[n]:e[n]=t},e._stringRef=n,e)}if("string"!=typeof t)throw Error(_(284));if(!i._owner)throw Error(_(290,t))}return t}function Fr(t,e){if("textarea"!==t.type)throw Error(_(31,"[object Object]"===Object.prototype.toString.call(e)?"object with keys {"+Object.keys(e).join(", ")+"}":e))}function zr(t){function e(e,i){if(t){var s=e.lastEffect;null!==s?(s.nextEffect=i,e.lastEffect=i):e.firstEffect=e.lastEffect=i,i.nextEffect=null,i.flags=8}}function i(i,s){if(!t)return null;for(;null!==s;)e(i,s),s=s.sibling;return null}function s(t,e){for(t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function n(t,e){return(t=nh(t,e)).index=0,t.sibling=null,t}function r(e,i,s){return e.index=s,t?null!==(s=e.alternate)?(s=s.index)<i?(e.flags=2,i):s:(e.flags=2,i):i}function o(e){return t&&null===e.alternate&&(e.flags=2),e}function a(t,e,i,s){return null===e||6!==e.tag?((e=lh(i,t.mode,s)).return=t,e):((e=n(e,i)).return=t,e)}function l(t,e,i,s){return null!==e&&e.elementType===i.type?((s=n(e,i.props)).ref=Ir(t,e,i),s.return=t,s):((s=rh(i.type,i.key,i.props,null,t.mode,s)).ref=Ir(t,e,i),s.return=t,s)}function h(t,e,i,s){return null===e||4!==e.tag||e.stateNode.containerInfo!==i.containerInfo||e.stateNode.implementation!==i.implementation?((e=hh(i,t.mode,s)).return=t,e):((e=n(e,i.children||[])).return=t,e)}function c(t,e,i,s,r){return null===e||7!==e.tag?((e=oh(i,t.mode,s,r)).return=t,e):((e=n(e,i)).return=t,e)}function d(t,e,i){if("string"==typeof e||"number"==typeof e)return(e=lh(""+e,t.mode,i)).return=t,e;if("object"==typeof e&&null!==e){switch(e.$$typeof){case B:return(i=rh(e.type,e.key,e.props,null,t.mode,i)).ref=Ir(t,null,e),i.return=t,i;case I:return(e=hh(e,t.mode,i)).return=t,e}if(Br(e)||tt(e))return(e=oh(e,t.mode,i,null)).return=t,e;Fr(t,e)}return null}function u(t,e,i,s){var n=null!==e?e.key:null;if("string"==typeof i||"number"==typeof i)return null!==n?null:a(t,e,""+i,s);if("object"==typeof i&&null!==i){switch(i.$$typeof){case B:return i.key===n?i.type===F?c(t,e,i.props.children,s,n):l(t,e,i,s):null;case I:return i.key===n?h(t,e,i,s):null}if(Br(i)||tt(i))return null!==n?null:c(t,e,i,s,null);Fr(t,i)}return null}function p(t,e,i,s,n){if("string"==typeof s||"number"==typeof s)return a(e,t=t.get(i)||null,""+s,n);if("object"==typeof s&&null!==s){switch(s.$$typeof){case B:return t=t.get(null===s.key?i:s.key)||null,s.type===F?c(e,t,s.props.children,n,s.key):l(e,t,s,n);case I:return h(e,t=t.get(null===s.key?i:s.key)||null,s,n)}if(Br(s)||tt(s))return c(e,t=t.get(i)||null,s,n,null);Fr(e,s)}return null}return function(a,l,h,c){var g="object"==typeof h&&null!==h&&h.type===F&&null===h.key;g&&(h=h.props.children);var f="object"==typeof h&&null!==h;if(f)switch(h.$$typeof){case B:t:{for(f=h.key,g=l;null!==g;){if(g.key===f){if(7===g.tag){if(h.type===F){i(a,g.sibling),(l=n(g,h.props.children)).return=a,a=l;break t}}else if(g.elementType===h.type){i(a,g.sibling),(l=n(g,h.props)).ref=Ir(a,g,h),l.return=a,a=l;break t}i(a,g);break}e(a,g),g=g.sibling}h.type===F?((l=oh(h.props.children,a.mode,c,h.key)).return=a,a=l):((c=rh(h.type,h.key,h.props,null,a.mode,c)).ref=Ir(a,l,h),c.return=a,a=c)}return o(a);case I:t:{for(g=h.key;null!==l;){if(l.key===g){if(4===l.tag&&l.stateNode.containerInfo===h.containerInfo&&l.stateNode.implementation===h.implementation){i(a,l.sibling),(l=n(l,h.children||[])).return=a,a=l;break t}i(a,l);break}e(a,l),l=l.sibling}(l=hh(h,a.mode,c)).return=a,a=l}return o(a)}if("string"==typeof h||"number"==typeof h)return h=""+h,null!==l&&6===l.tag?(i(a,l.sibling),(l=n(l,h)).return=a,a=l):(i(a,l),(l=lh(h,a.mode,c)).return=a,a=l),o(a);if(Br(h))return function(n,o,a,l){for(var h=null,c=null,g=o,f=o=0,m=null;null!==g&&f<a.length;f++){g.index>f?(m=g,g=null):m=g.sibling;var y=u(n,g,a[f],l);if(null===y){null===g&&(g=m);break}t&&g&&null===y.alternate&&e(n,g),o=r(y,o,f),null===c?h=y:c.sibling=y,c=y,g=m}if(f===a.length)return i(n,g),h;if(null===g){for(;f<a.length;f++)null!==(g=d(n,a[f],l))&&(o=r(g,o,f),null===c?h=g:c.sibling=g,c=g);return h}for(g=s(n,g);f<a.length;f++)null!==(m=p(g,n,f,a[f],l))&&(t&&null!==m.alternate&&g.delete(null===m.key?f:m.key),o=r(m,o,f),null===c?h=m:c.sibling=m,c=m);return t&&g.forEach((function(t){return e(n,t)})),h}(a,l,h,c);if(tt(h))return function(n,o,a,l){var h=tt(a);if("function"!=typeof h)throw Error(_(150));if(null==(a=h.call(a)))throw Error(_(151));for(var c=h=null,g=o,f=o=0,m=null,y=a.next();null!==g&&!y.done;f++,y=a.next()){g.index>f?(m=g,g=null):m=g.sibling;var w=u(n,g,y.value,l);if(null===w){null===g&&(g=m);break}t&&g&&null===w.alternate&&e(n,g),o=r(w,o,f),null===c?h=w:c.sibling=w,c=w,g=m}if(y.done)return i(n,g),h;if(null===g){for(;!y.done;f++,y=a.next())null!==(y=d(n,y.value,l))&&(o=r(y,o,f),null===c?h=y:c.sibling=y,c=y);return h}for(g=s(n,g);!y.done;f++,y=a.next())null!==(y=p(g,n,f,y.value,l))&&(t&&null!==y.alternate&&g.delete(null===y.key?f:y.key),o=r(y,o,f),null===c?h=y:c.sibling=y,c=y);return t&&g.forEach((function(t){return e(n,t)})),h}(a,l,h,c);if(f&&Fr(a,h),void 0===h&&!g)switch(a.tag){case 1:case 22:case 0:case 11:case 15:throw Error(_(152,rt(a.type)||"Component"))}return i(a,l)}}var Nr=zr(!0),Or=zr(!1),Ur={},Hr=xn(Ur),Wr=xn(Ur),jr=xn(Ur);function Vr(t){if(t===Ur)throw Error(_(174));return t}function qr(t,e){switch(Sn(jr,e),Sn(Wr,t),Sn(Hr,Ur),t=e.nodeType){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Pt(null,"");break;default:e=Pt(e=(t=8===t?e.parentNode:e).namespaceURI||null,t=t.tagName)}bn(Hr),Sn(Hr,e)}function Xr(){bn(Hr),bn(Wr),bn(jr)}function Gr(t){Vr(jr.current);var e=Vr(Hr.current),i=Pt(e,t.type);e!==i&&(Sn(Wr,t),Sn(Hr,i))}function Kr(t){Wr.current===t&&(bn(Hr),bn(Wr))}var Yr=xn(0);function Qr(t){for(var e=t;null!==e;){if(13===e.tag){var i=e.memoizedState;if(null!==i&&(null===(i=i.dehydrated)||"$?"===i.data||"$!"===i.data))return e}else if(19===e.tag&&void 0!==e.memoizedProps.revealOrder){if(0!=(64&e.flags))return e}else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Zr=null,$r=null,Jr=!1;function to(t,e){var i=ih(5,null,null,0);i.elementType="DELETED",i.type="DELETED",i.stateNode=e,i.return=t,i.flags=8,null!==t.lastEffect?(t.lastEffect.nextEffect=i,t.lastEffect=i):t.firstEffect=t.lastEffect=i}function eo(t,e){switch(t.tag){case 5:var i=t.type;return null!==(e=1!==e.nodeType||i.toLowerCase()!==e.nodeName.toLowerCase()?null:e)&&(t.stateNode=e,!0);case 6:return null!==(e=""===t.pendingProps||3!==e.nodeType?null:e)&&(t.stateNode=e,!0);default:return!1}}function io(t){if(Jr){var e=$r;if(e){var i=e;if(!eo(t,e)){if(!(e=on(i.nextSibling))||!eo(t,e))return t.flags=-1025&t.flags|2,Jr=!1,void(Zr=t);to(Zr,i)}Zr=t,$r=on(e.firstChild)}else t.flags=-1025&t.flags|2,Jr=!1,Zr=t}}function so(t){for(t=t.return;null!==t&&5!==t.tag&&3!==t.tag&&13!==t.tag;)t=t.return;Zr=t}function no(t){if(t!==Zr)return!1;if(!Jr)return so(t),Jr=!0,!1;var e=t.type;if(5!==t.tag||"head"!==e&&"body"!==e&&!en(e,t.memoizedProps))for(e=$r;e;)to(t,e),e=on(e.nextSibling);if(so(t),13===t.tag){if(!(t=null!==(t=t.memoizedState)?t.dehydrated:null))throw Error(_(317));t:{for(t=t.nextSibling,e=0;t;){if(8===t.nodeType){var i=t.data;if("/$"===i){if(0===e){$r=on(t.nextSibling);break t}e--}else"$"!==i&&"$!"!==i&&"$?"!==i||e++}t=t.nextSibling}$r=null}}else $r=Zr?on(t.stateNode.nextSibling):null;return!0}function ro(){$r=Zr=null,Jr=!1}var oo=[];function ao(){for(var t=0;t<oo.length;t++)oo[t]._workInProgressVersionPrimary=null;oo.length=0}var lo=L.ReactCurrentDispatcher,ho=L.ReactCurrentBatchConfig,co=0,uo=null,po=null,go=null,fo=!1,mo=!1;function yo(){throw Error(_(321))}function _o(t,e){if(null===e)return!1;for(var i=0;i<e.length&&i<t.length;i++)if(!xs(t[i],e[i]))return!1;return!0}function wo(t,e,i,s,n,r){if(co=r,uo=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,lo.current=null===t||null===t.memoizedState?qo:Xo,t=i(s,n),mo){r=0;do{if(mo=!1,!(25>r))throw Error(_(301));r+=1,go=po=null,e.updateQueue=null,lo.current=Go,t=i(s,n)}while(mo)}if(lo.current=Vo,e=null!==po&&null!==po.next,co=0,go=po=uo=null,fo=!1,e)throw Error(_(300));return t}function vo(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===go?uo.memoizedState=go=t:go=go.next=t,go}function xo(){if(null===po){var t=uo.alternate;t=null!==t?t.memoizedState:null}else t=po.next;var e=null===go?uo.memoizedState:go.next;if(null!==e)go=e,po=t;else{if(null===t)throw Error(_(310));t={memoizedState:(po=t).memoizedState,baseState:po.baseState,baseQueue:po.baseQueue,queue:po.queue,next:null},null===go?uo.memoizedState=go=t:go=go.next=t}return go}function bo(t,e){return"function"==typeof e?e(t):e}function So(t){var e=xo(),i=e.queue;if(null===i)throw Error(_(311));i.lastRenderedReducer=t;var s=po,n=s.baseQueue,r=i.pending;if(null!==r){if(null!==n){var o=n.next;n.next=r.next,r.next=o}s.baseQueue=n=r,i.pending=null}if(null!==n){n=n.next,s=s.baseState;var a=o=r=null,l=n;do{var h=l.lane;if((co&h)===h)null!==a&&(a=a.next={lane:0,action:l.action,eagerReducer:l.eagerReducer,eagerState:l.eagerState,next:null}),s=l.eagerReducer===t?l.eagerState:t(s,l.action);else{var c={lane:h,action:l.action,eagerReducer:l.eagerReducer,eagerState:l.eagerState,next:null};null===a?(o=a=c,r=s):a=a.next=c,uo.lanes|=h,Ja|=h}l=l.next}while(null!==l&&l!==n);null===a?r=s:a.next=o,xs(s,e.memoizedState)||(Yo=!0),e.memoizedState=s,e.baseState=r,e.baseQueue=a,i.lastRenderedState=s}return[e.memoizedState,i.dispatch]}function Co(t){var e=xo(),i=e.queue;if(null===i)throw Error(_(311));i.lastRenderedReducer=t;var s=i.dispatch,n=i.pending,r=e.memoizedState;if(null!==n){i.pending=null;var o=n=n.next;do{r=t(r,o.action),o=o.next}while(o!==n);xs(r,e.memoizedState)||(Yo=!0),e.memoizedState=r,null===e.baseQueue&&(e.baseState=r),i.lastRenderedState=r}return[r,s]}function Eo(t,e,i){var s=e._getVersion;s=s(e._source);var n=e._workInProgressVersionPrimary;if(null!==n?t=n===s:(t=t.mutableReadLanes,(t=(co&t)===t)&&(e._workInProgressVersionPrimary=s,oo.push(e))),t)return i(e._source);throw oo.push(e),Error(_(350))}function Po(t,e,i,s){var n=qa;if(null===n)throw Error(_(349));var r=e._getVersion,o=r(e._source),a=lo.current,l=a.useState((function(){return Eo(n,e,i)})),h=l[1],c=l[0];l=go;var d=t.memoizedState,u=d.refs,p=u.getSnapshot,g=d.source;d=d.subscribe;var f=uo;return t.memoizedState={refs:u,source:e,subscribe:s},a.useEffect((function(){u.getSnapshot=i,u.setSnapshot=h;var t=r(e._source);if(!xs(o,t)){t=i(e._source),xs(c,t)||(h(t),t=El(f),n.mutableReadLanes|=t&n.pendingLanes),t=n.mutableReadLanes,n.entangledLanes|=t;for(var s=n.entanglements,a=t;0<a;){var l=31-ii(a),d=1<<l;s[l]|=t,a&=~d}}}),[i,e,s]),a.useEffect((function(){return s(e._source,(function(){var t=u.getSnapshot,i=u.setSnapshot;try{i(t(e._source));var s=El(f);n.mutableReadLanes|=s&n.pendingLanes}catch(t){i((function(){throw t}))}}))}),[e,s]),xs(p,i)&&xs(g,e)&&xs(d,s)||((t={pending:null,dispatch:null,lastRenderedReducer:bo,lastRenderedState:c}).dispatch=h=jo.bind(null,uo,t),l.queue=t,l.baseQueue=null,c=Eo(n,e,i),l.memoizedState=l.baseState=c),c}function Ao(t,e,i){return Po(xo(),t,e,i)}function ko(t){var e=vo();return"function"==typeof t&&(t=t()),e.memoizedState=e.baseState=t,t=(t=e.queue={pending:null,dispatch:null,lastRenderedReducer:bo,lastRenderedState:t}).dispatch=jo.bind(null,uo,t),[e.memoizedState,t]}function To(t,e,i,s){return t={tag:t,create:e,destroy:i,deps:s,next:null},null===(e=uo.updateQueue)?(e={lastEffect:null},uo.updateQueue=e,e.lastEffect=t.next=t):null===(i=e.lastEffect)?e.lastEffect=t.next=t:(s=i.next,i.next=t,t.next=s,e.lastEffect=t),t}function Ro(t){return t={current:t},vo().memoizedState=t}function Mo(){return xo().memoizedState}function Do(t,e,i,s){var n=vo();uo.flags|=t,n.memoizedState=To(1|e,i,void 0,void 0===s?null:s)}function Lo(t,e,i,s){var n=xo();s=void 0===s?null:s;var r=void 0;if(null!==po){var o=po.memoizedState;if(r=o.destroy,null!==s&&_o(s,o.deps))return void To(e,i,r,s)}uo.flags|=t,n.memoizedState=To(1|e,i,r,s)}function Bo(t,e){return Do(516,4,t,e)}function Io(t,e){return Lo(516,4,t,e)}function Fo(t,e){return Lo(4,2,t,e)}function zo(t,e){return"function"==typeof e?(t=t(),e(t),function(){e(null)}):null!=e?(t=t(),e.current=t,function(){e.current=null}):void 0}function No(t,e,i){return i=null!=i?i.concat([t]):null,Lo(4,2,zo.bind(null,e,t),i)}function Oo(){}function Uo(t,e){var i=xo();e=void 0===e?null:e;var s=i.memoizedState;return null!==s&&null!==e&&_o(e,s[1])?s[0]:(i.memoizedState=[t,e],t)}function Ho(t,e){var i=xo();e=void 0===e?null:e;var s=i.memoizedState;return null!==s&&null!==e&&_o(e,s[1])?s[0]:(t=t(),i.memoizedState=[t,e],t)}function Wo(t,e){var i=ir();nr(98>i?98:i,(function(){t(!0)})),nr(97<i?97:i,(function(){var i=ho.transition;ho.transition=1;try{t(!1),e()}finally{ho.transition=i}}))}function jo(t,e,i){var s=Cl(),n=El(t),r={lane:n,action:i,eagerReducer:null,eagerState:null,next:null},o=e.pending;if(null===o?r.next=r:(r.next=o.next,o.next=r),e.pending=r,o=t.alternate,t===uo||null!==o&&o===uo)mo=fo=!0;else{if(0===t.lanes&&(null===o||0===o.lanes)&&null!==(o=e.lastRenderedReducer))try{var a=e.lastRenderedState,l=o(a,i);if(r.eagerReducer=o,r.eagerState=l,xs(l,a))return}catch(t){}Pl(t,n,s)}}var Vo={readContext:_r,useCallback:yo,useContext:yo,useEffect:yo,useImperativeHandle:yo,useLayoutEffect:yo,useMemo:yo,useReducer:yo,useRef:yo,useState:yo,useDebugValue:yo,useDeferredValue:yo,useTransition:yo,useMutableSource:yo,useOpaqueIdentifier:yo,unstable_isNewReconciler:!1},qo={readContext:_r,useCallback:function(t,e){return vo().memoizedState=[t,void 0===e?null:e],t},useContext:_r,useEffect:Bo,useImperativeHandle:function(t,e,i){return i=null!=i?i.concat([t]):null,Do(4,2,zo.bind(null,e,t),i)},useLayoutEffect:function(t,e){return Do(4,2,t,e)},useMemo:function(t,e){var i=vo();return e=void 0===e?null:e,t=t(),i.memoizedState=[t,e],t},useReducer:function(t,e,i){var s=vo();return e=void 0!==i?i(e):e,s.memoizedState=s.baseState=e,t=(t=s.queue={pending:null,dispatch:null,lastRenderedReducer:t,lastRenderedState:e}).dispatch=jo.bind(null,uo,t),[s.memoizedState,t]},useRef:Ro,useState:ko,useDebugValue:Oo,useDeferredValue:function(t){var e=ko(t),i=e[0],s=e[1];return Bo((function(){var e=ho.transition;ho.transition=1;try{s(t)}finally{ho.transition=e}}),[t]),i},useTransition:function(){var t=ko(!1),e=t[0];return Ro(t=Wo.bind(null,t[1])),[t,e]},useMutableSource:function(t,e,i){var s=vo();return s.memoizedState={refs:{getSnapshot:e,setSnapshot:null},source:t,subscribe:i},Po(s,t,e,i)},useOpaqueIdentifier:function(){if(Jr){var t=!1,e=function(t){return{$$typeof:G,toString:t,valueOf:t}}((function(){throw t||(t=!0,i("r:"+(ln++).toString(36))),Error(_(355))})),i=ko(e)[1];return 0==(2&uo.mode)&&(uo.flags|=516,To(5,(function(){i("r:"+(ln++).toString(36))}),void 0,null)),e}return ko(e="r:"+(ln++).toString(36)),e},unstable_isNewReconciler:!1},Xo={readContext:_r,useCallback:Uo,useContext:_r,useEffect:Io,useImperativeHandle:No,useLayoutEffect:Fo,useMemo:Ho,useReducer:So,useRef:Mo,useState:function(){return So(bo)},useDebugValue:Oo,useDeferredValue:function(t){var e=So(bo),i=e[0],s=e[1];return Io((function(){var e=ho.transition;ho.transition=1;try{s(t)}finally{ho.transition=e}}),[t]),i},useTransition:function(){var t=So(bo)[0];return[Mo().current,t]},useMutableSource:Ao,useOpaqueIdentifier:function(){return So(bo)[0]},unstable_isNewReconciler:!1},Go={readContext:_r,useCallback:Uo,useContext:_r,useEffect:Io,useImperativeHandle:No,useLayoutEffect:Fo,useMemo:Ho,useReducer:Co,useRef:Mo,useState:function(){return Co(bo)},useDebugValue:Oo,useDeferredValue:function(t){var e=Co(bo),i=e[0],s=e[1];return Io((function(){var e=ho.transition;ho.transition=1;try{s(t)}finally{ho.transition=e}}),[t]),i},useTransition:function(){var t=Co(bo)[0];return[Mo().current,t]},useMutableSource:Ao,useOpaqueIdentifier:function(){return Co(bo)[0]},unstable_isNewReconciler:!1},Ko=L.ReactCurrentOwner,Yo=!1;function Qo(t,e,i,s){e.child=null===t?Or(e,null,i,s):Nr(e,t.child,i,s)}function Zo(t,e,i,s,n){i=i.render;var r=e.ref;return yr(e,n),s=wo(t,e,i,s,r,n),null===t||Yo?(e.flags|=1,Qo(t,e,s,n),e.child):(e.updateQueue=t.updateQueue,e.flags&=-517,t.lanes&=~n,ya(t,e,n))}function $o(t,e,i,s,n,r){if(null===t){var o=i.type;return"function"!=typeof o||sh(o)||void 0!==o.defaultProps||null!==i.compare||void 0!==i.defaultProps?((t=rh(i.type,null,s,e,e.mode,r)).ref=e.ref,t.return=e,e.child=t):(e.tag=15,e.type=o,Jo(t,e,o,s,n,r))}return o=t.child,0==(n&r)&&(n=o.memoizedProps,(i=null!==(i=i.compare)?i:Ss)(n,s)&&t.ref===e.ref)?ya(t,e,r):(e.flags|=1,(t=nh(o,s)).ref=e.ref,t.return=e,e.child=t)}function Jo(t,e,i,s,n,r){if(null!==t&&Ss(t.memoizedProps,s)&&t.ref===e.ref){if(Yo=!1,0==(r&n))return e.lanes=t.lanes,ya(t,e,r);0!=(16384&t.flags)&&(Yo=!0)}return ia(t,e,i,s,r)}function ta(t,e,i){var s=e.pendingProps,n=s.children,r=null!==t?t.memoizedState:null;if("hidden"===s.mode||"unstable-defer-without-hiding"===s.mode)if(0==(4&e.mode))e.memoizedState={baseLanes:0},Bl(e,i);else{if(0==(1073741824&i))return t=null!==r?r.baseLanes|i:i,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t},Bl(e,t),null;e.memoizedState={baseLanes:0},Bl(e,null!==r?r.baseLanes:i)}else null!==r?(s=r.baseLanes|i,e.memoizedState=null):s=i,Bl(e,s);return Qo(t,e,n,i),e.child}function ea(t,e){var i=e.ref;(null===t&&null!==i||null!==t&&t.ref!==i)&&(e.flags|=128)}function ia(t,e,i,s,n){var r=Tn(i)?An:En.current;return r=kn(e,r),yr(e,n),i=wo(t,e,i,s,r,n),null===t||Yo?(e.flags|=1,Qo(t,e,i,n),e.child):(e.updateQueue=t.updateQueue,e.flags&=-517,t.lanes&=~n,ya(t,e,n))}function sa(t,e,i,s,n){if(Tn(i)){var r=!0;Ln(e)}else r=!1;if(yr(e,n),null===e.stateNode)null!==t&&(t.alternate=null,e.alternate=null,e.flags|=2),Mr(e,i,s),Lr(e,i,s,n),s=!0;else if(null===t){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,h=i.contextType;"object"==typeof h&&null!==h?h=_r(h):h=kn(e,h=Tn(i)?An:En.current);var c=i.getDerivedStateFromProps,d="function"==typeof c||"function"==typeof o.getSnapshotBeforeUpdate;d||"function"!=typeof o.UNSAFE_componentWillReceiveProps&&"function"!=typeof o.componentWillReceiveProps||(a!==s||l!==h)&&Dr(e,o,s,h),wr=!1;var u=e.memoizedState;o.state=u,Er(e,s,o,n),l=e.memoizedState,a!==s||u!==l||Pn.current||wr?("function"==typeof c&&(kr(e,i,c,s),l=e.memoizedState),(a=wr||Rr(e,i,a,s,u,l,h))?(d||"function"!=typeof o.UNSAFE_componentWillMount&&"function"!=typeof o.componentWillMount||("function"==typeof o.componentWillMount&&o.componentWillMount(),"function"==typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"==typeof o.componentDidMount&&(e.flags|=4)):("function"==typeof o.componentDidMount&&(e.flags|=4),e.memoizedProps=s,e.memoizedState=l),o.props=s,o.state=l,o.context=h,s=a):("function"==typeof o.componentDidMount&&(e.flags|=4),s=!1)}else{o=e.stateNode,xr(t,e),a=e.memoizedProps,h=e.type===e.elementType?a:hr(e.type,a),o.props=h,d=e.pendingProps,u=o.context,"object"==typeof(l=i.contextType)&&null!==l?l=_r(l):l=kn(e,l=Tn(i)?An:En.current);var p=i.getDerivedStateFromProps;(c="function"==typeof p||"function"==typeof o.getSnapshotBeforeUpdate)||"function"!=typeof o.UNSAFE_componentWillReceiveProps&&"function"!=typeof o.componentWillReceiveProps||(a!==d||u!==l)&&Dr(e,o,s,l),wr=!1,u=e.memoizedState,o.state=u,Er(e,s,o,n);var g=e.memoizedState;a!==d||u!==g||Pn.current||wr?("function"==typeof p&&(kr(e,i,p,s),g=e.memoizedState),(h=wr||Rr(e,i,h,s,u,g,l))?(c||"function"!=typeof o.UNSAFE_componentWillUpdate&&"function"!=typeof o.componentWillUpdate||("function"==typeof o.componentWillUpdate&&o.componentWillUpdate(s,g,l),"function"==typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(s,g,l)),"function"==typeof o.componentDidUpdate&&(e.flags|=4),"function"==typeof o.getSnapshotBeforeUpdate&&(e.flags|=256)):("function"!=typeof o.componentDidUpdate||a===t.memoizedProps&&u===t.memoizedState||(e.flags|=4),"function"!=typeof o.getSnapshotBeforeUpdate||a===t.memoizedProps&&u===t.memoizedState||(e.flags|=256),e.memoizedProps=s,e.memoizedState=g),o.props=s,o.state=g,o.context=l,s=h):("function"!=typeof o.componentDidUpdate||a===t.memoizedProps&&u===t.memoizedState||(e.flags|=4),"function"!=typeof o.getSnapshotBeforeUpdate||a===t.memoizedProps&&u===t.memoizedState||(e.flags|=256),s=!1)}return na(t,e,i,s,r,n)}function na(t,e,i,s,n,r){ea(t,e);var o=0!=(64&e.flags);if(!s&&!o)return n&&Bn(e,i,!1),ya(t,e,r);s=e.stateNode,Ko.current=e;var a=o&&"function"!=typeof i.getDerivedStateFromError?null:s.render();return e.flags|=1,null!==t&&o?(e.child=Nr(e,t.child,null,r),e.child=Nr(e,null,a,r)):Qo(t,e,a,r),e.memoizedState=s.state,n&&Bn(e,i,!0),e.child}function ra(t){var e=t.stateNode;e.pendingContext?Mn(0,e.pendingContext,e.pendingContext!==e.context):e.context&&Mn(0,e.context,!1),qr(t,e.containerInfo)}var oa,aa,la,ha={dehydrated:null,retryLane:0};function ca(t,e,i){var s,n=e.pendingProps,r=Yr.current,o=!1;return(s=0!=(64&e.flags))||(s=(null===t||null!==t.memoizedState)&&0!=(2&r)),s?(o=!0,e.flags&=-65):null!==t&&null===t.memoizedState||void 0===n.fallback||!0===n.unstable_avoidThisFallback||(r|=1),Sn(Yr,1&r),null===t?(void 0!==n.fallback&&io(e),t=n.children,r=n.fallback,o?(t=da(e,t,r,i),e.child.memoizedState={baseLanes:i},e.memoizedState=ha,t):"number"==typeof n.unstable_expectedLoadTime?(t=da(e,t,r,i),e.child.memoizedState={baseLanes:i},e.memoizedState=ha,e.lanes=33554432,t):((i=ah({mode:"visible",children:t},e.mode,i,null)).return=e,e.child=i)):(t.memoizedState,o?(n=pa(t,e,n.children,n.fallback,i),o=e.child,r=t.child.memoizedState,o.memoizedState=null===r?{baseLanes:i}:{baseLanes:r.baseLanes|i},o.childLanes=t.childLanes&~i,e.memoizedState=ha,n):(i=ua(t,e,n.children,i),e.memoizedState=null,i))}function da(t,e,i,s){var n=t.mode,r=t.child;return e={mode:"hidden",children:e},0==(2&n)&&null!==r?(r.childLanes=0,r.pendingProps=e):r=ah(e,n,0,null),i=oh(i,n,s,null),r.return=t,i.return=t,r.sibling=i,t.child=r,i}function ua(t,e,i,s){var n=t.child;return t=n.sibling,i=nh(n,{mode:"visible",children:i}),0==(2&e.mode)&&(i.lanes=s),i.return=e,i.sibling=null,null!==t&&(t.nextEffect=null,t.flags=8,e.firstEffect=e.lastEffect=t),e.child=i}function pa(t,e,i,s,n){var r=e.mode,o=t.child;t=o.sibling;var a={mode:"hidden",children:i};return 0==(2&r)&&e.child!==o?((i=e.child).childLanes=0,i.pendingProps=a,null!==(o=i.lastEffect)?(e.firstEffect=i.firstEffect,e.lastEffect=o,o.nextEffect=null):e.firstEffect=e.lastEffect=null):i=nh(o,a),null!==t?s=nh(t,s):(s=oh(s,r,n,null)).flags|=2,s.return=e,i.return=e,i.sibling=s,e.child=i,s}function ga(t,e){t.lanes|=e;var i=t.alternate;null!==i&&(i.lanes|=e),mr(t.return,e)}function fa(t,e,i,s,n,r){var o=t.memoizedState;null===o?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:s,tail:i,tailMode:n,lastEffect:r}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=s,o.tail=i,o.tailMode=n,o.lastEffect=r)}function ma(t,e,i){var s=e.pendingProps,n=s.revealOrder,r=s.tail;if(Qo(t,e,s.children,i),0!=(2&(s=Yr.current)))s=1&s|2,e.flags|=64;else{if(null!==t&&0!=(64&t.flags))t:for(t=e.child;null!==t;){if(13===t.tag)null!==t.memoizedState&&ga(t,i);else if(19===t.tag)ga(t,i);else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break t;for(;null===t.sibling;){if(null===t.return||t.return===e)break t;t=t.return}t.sibling.return=t.return,t=t.sibling}s&=1}if(Sn(Yr,s),0==(2&e.mode))e.memoizedState=null;else switch(n){case"forwards":for(i=e.child,n=null;null!==i;)null!==(t=i.alternate)&&null===Qr(t)&&(n=i),i=i.sibling;null===(i=n)?(n=e.child,e.child=null):(n=i.sibling,i.sibling=null),fa(e,!1,n,i,r,e.lastEffect);break;case"backwards":for(i=null,n=e.child,e.child=null;null!==n;){if(null!==(t=n.alternate)&&null===Qr(t)){e.child=n;break}t=n.sibling,n.sibling=i,i=n,n=t}fa(e,!0,i,null,r,e.lastEffect);break;case"together":fa(e,!1,null,null,void 0,e.lastEffect);break;default:e.memoizedState=null}return e.child}function ya(t,e,i){if(null!==t&&(e.dependencies=t.dependencies),Ja|=e.lanes,0!=(i&e.childLanes)){if(null!==t&&e.child!==t.child)throw Error(_(153));if(null!==e.child){for(i=nh(t=e.child,t.pendingProps),e.child=i,i.return=e;null!==t.sibling;)t=t.sibling,(i=i.sibling=nh(t,t.pendingProps)).return=e;i.sibling=null}return e.child}return null}function _a(t,e){if(!Jr)switch(t.tailMode){case"hidden":e=t.tail;for(var i=null;null!==e;)null!==e.alternate&&(i=e),e=e.sibling;null===i?t.tail=null:i.sibling=null;break;case"collapsed":i=t.tail;for(var s=null;null!==i;)null!==i.alternate&&(s=i),i=i.sibling;null===s?e||null===t.tail?t.tail=null:t.tail.sibling=null:s.sibling=null}}function wa(t,e,i){var s=e.pendingProps;switch(e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:case 17:return Tn(e.type)&&Rn(),null;case 3:return Xr(),bn(Pn),bn(En),ao(),(s=e.stateNode).pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),null!==t&&null!==t.child||(no(e)?e.flags|=4:s.hydrate||(e.flags|=256)),null;case 5:Kr(e);var n=Vr(jr.current);if(i=e.type,null!==t&&null!=e.stateNode)aa(t,e,i,s),t.ref!==e.ref&&(e.flags|=128);else{if(!s){if(null===e.stateNode)throw Error(_(166));return null}if(t=Vr(Hr.current),no(e)){s=e.stateNode,i=e.type;var r=e.memoizedProps;switch(s[cn]=e,s[dn]=r,i){case"dialog":Hs("cancel",s),Hs("close",s);break;case"iframe":case"object":case"embed":Hs("load",s);break;case"video":case"audio":for(t=0;t<zs.length;t++)Hs(zs[t],s);break;case"source":Hs("error",s);break;case"img":case"image":case"link":Hs("error",s),Hs("load",s);break;case"details":Hs("toggle",s);break;case"input":ut(s,r),Hs("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!r.multiple},Hs("invalid",s);break;case"textarea":vt(s,r),Hs("invalid",s)}for(var o in Ft(i,r),t=null,r)r.hasOwnProperty(o)&&(n=r[o],"children"===o?"string"==typeof n?s.textContent!==n&&(t=["children",n]):"number"==typeof n&&s.textContent!==""+n&&(t=["children",""+n]):v.hasOwnProperty(o)&&null!=n&&"onScroll"===o&&Hs("scroll",s));switch(i){case"input":lt(s),ft(s,r,!0);break;case"textarea":lt(s),bt(s);break;case"select":case"option":break;default:"function"==typeof r.onClick&&(s.onclick=Zs)}s=t,e.updateQueue=s,null!==s&&(e.flags|=4)}else{switch(o=9===n.nodeType?n:n.ownerDocument,t===St&&(t=Et(i)),t===St?"script"===i?((t=o.createElement("div")).innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):"string"==typeof s.is?t=o.createElement(i,{is:s.is}):(t=o.createElement(i),"select"===i&&(o=t,s.multiple?o.multiple=!0:s.size&&(o.size=s.size))):t=o.createElementNS(t,i),t[cn]=e,t[dn]=s,oa(t,e),e.stateNode=t,o=zt(i,s),i){case"dialog":Hs("cancel",t),Hs("close",t),n=s;break;case"iframe":case"object":case"embed":Hs("load",t),n=s;break;case"video":case"audio":for(n=0;n<zs.length;n++)Hs(zs[n],t);n=s;break;case"source":Hs("error",t),n=s;break;case"img":case"image":case"link":Hs("error",t),Hs("load",t),n=s;break;case"details":Hs("toggle",t),n=s;break;case"input":ut(t,s),n=dt(t,s),Hs("invalid",t);break;case"option":n=yt(t,s);break;case"select":t._wrapperState={wasMultiple:!!s.multiple},n=m({},s,{value:void 0}),Hs("invalid",t);break;case"textarea":vt(t,s),n=wt(t,s),Hs("invalid",t);break;default:n=s}Ft(i,n);var a=n;for(r in a)if(a.hasOwnProperty(r)){var l=a[r];"style"===r?Bt(t,l):"dangerouslySetInnerHTML"===r?null!=(l=l?l.__html:void 0)&&Tt(t,l):"children"===r?"string"==typeof l?("textarea"!==i||""!==l)&&Rt(t,l):"number"==typeof l&&Rt(t,""+l):"suppressContentEditableWarning"!==r&&"suppressHydrationWarning"!==r&&"autoFocus"!==r&&(v.hasOwnProperty(r)?null!=l&&"onScroll"===r&&Hs("scroll",t):null!=l&&D(t,r,l,o))}switch(i){case"input":lt(t),ft(t,s,!1);break;case"textarea":lt(t),bt(t);break;case"option":null!=s.value&&t.setAttribute("value",""+ot(s.value));break;case"select":t.multiple=!!s.multiple,null!=(r=s.value)?_t(t,!!s.multiple,r,!1):null!=s.defaultValue&&_t(t,!!s.multiple,s.defaultValue,!0);break;default:"function"==typeof n.onClick&&(t.onclick=Zs)}tn(i,s)&&(e.flags|=4)}null!==e.ref&&(e.flags|=128)}return null;case 6:if(t&&null!=e.stateNode)la(0,e,t.memoizedProps,s);else{if("string"!=typeof s&&null===e.stateNode)throw Error(_(166));i=Vr(jr.current),Vr(Hr.current),no(e)?(s=e.stateNode,i=e.memoizedProps,s[cn]=e,s.nodeValue!==i&&(e.flags|=4)):((s=(9===i.nodeType?i:i.ownerDocument).createTextNode(s))[cn]=e,e.stateNode=s)}return null;case 13:return bn(Yr),s=e.memoizedState,0!=(64&e.flags)?(e.lanes=i,e):(s=null!==s,i=!1,null===t?void 0!==e.memoizedProps.fallback&&no(e):i=null!==t.memoizedState,s&&!i&&0!=(2&e.mode)&&(null===t&&!0!==e.memoizedProps.unstable_avoidThisFallback||0!=(1&Yr.current)?0===Qa&&(Qa=3):(0!==Qa&&3!==Qa||(Qa=4),null===qa||0==(134217727&Ja)&&0==(134217727&tl)||Rl(qa,Ga))),(s||i)&&(e.flags|=4),null);case 4:return Xr(),null===t&&js(e.stateNode.containerInfo),null;case 10:return fr(e),null;case 19:if(bn(Yr),null===(s=e.memoizedState))return null;if(r=0!=(64&e.flags),null===(o=s.rendering))if(r)_a(s,!1);else{if(0!==Qa||null!==t&&0!=(64&t.flags))for(t=e.child;null!==t;){if(null!==(o=Qr(t))){for(e.flags|=64,_a(s,!1),null!==(r=o.updateQueue)&&(e.updateQueue=r,e.flags|=4),null===s.lastEffect&&(e.firstEffect=null),e.lastEffect=s.lastEffect,s=i,i=e.child;null!==i;)t=s,(r=i).flags&=2,r.nextEffect=null,r.firstEffect=null,r.lastEffect=null,null===(o=r.alternate)?(r.childLanes=0,r.lanes=t,r.child=null,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=o.childLanes,r.lanes=o.lanes,r.child=o.child,r.memoizedProps=o.memoizedProps,r.memoizedState=o.memoizedState,r.updateQueue=o.updateQueue,r.type=o.type,t=o.dependencies,r.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),i=i.sibling;return Sn(Yr,1&Yr.current|2),e.child}t=t.sibling}null!==s.tail&&er()>nl&&(e.flags|=64,r=!0,_a(s,!1),e.lanes=33554432)}else{if(!r)if(null!==(t=Qr(o))){if(e.flags|=64,r=!0,null!==(i=t.updateQueue)&&(e.updateQueue=i,e.flags|=4),_a(s,!0),null===s.tail&&"hidden"===s.tailMode&&!o.alternate&&!Jr)return null!==(e=e.lastEffect=s.lastEffect)&&(e.nextEffect=null),null}else 2*er()-s.renderingStartTime>nl&&1073741824!==i&&(e.flags|=64,r=!0,_a(s,!1),e.lanes=33554432);s.isBackwards?(o.sibling=e.child,e.child=o):(null!==(i=s.last)?i.sibling=o:e.child=o,s.last=o)}return null!==s.tail?(i=s.tail,s.rendering=i,s.tail=i.sibling,s.lastEffect=e.lastEffect,s.renderingStartTime=er(),i.sibling=null,e=Yr.current,Sn(Yr,r?1&e|2:1&e),i):null;case 23:case 24:return Il(),null!==t&&null!==t.memoizedState!=(null!==e.memoizedState)&&"unstable-defer-without-hiding"!==s.mode&&(e.flags|=4),null}throw Error(_(156,e.tag))}function va(t){switch(t.tag){case 1:Tn(t.type)&&Rn();var e=t.flags;return 4096&e?(t.flags=-4097&e|64,t):null;case 3:if(Xr(),bn(Pn),bn(En),ao(),0!=(64&(e=t.flags)))throw Error(_(285));return t.flags=-4097&e|64,t;case 5:return Kr(t),null;case 13:return bn(Yr),4096&(e=t.flags)?(t.flags=-4097&e|64,t):null;case 19:return bn(Yr),null;case 4:return Xr(),null;case 10:return fr(t),null;case 23:case 24:return Il(),null;default:return null}}function xa(t,e){try{var i="",s=e;do{i+=nt(s),s=s.return}while(s);var n=i}catch(t){n="\nError generating stack: "+t.message+"\n"+t.stack}return{value:t,source:e,stack:n}}function ba(t,e){try{console.error(e.value)}catch(t){setTimeout((function(){throw t}))}}oa=function(t,e){for(var i=e.child;null!==i;){if(5===i.tag||6===i.tag)t.appendChild(i.stateNode);else if(4!==i.tag&&null!==i.child){i.child.return=i,i=i.child;continue}if(i===e)break;for(;null===i.sibling;){if(null===i.return||i.return===e)return;i=i.return}i.sibling.return=i.return,i=i.sibling}},aa=function(t,e,i,s){var n=t.memoizedProps;if(n!==s){t=e.stateNode,Vr(Hr.current);var r,o=null;switch(i){case"input":n=dt(t,n),s=dt(t,s),o=[];break;case"option":n=yt(t,n),s=yt(t,s),o=[];break;case"select":n=m({},n,{value:void 0}),s=m({},s,{value:void 0}),o=[];break;case"textarea":n=wt(t,n),s=wt(t,s),o=[];break;default:"function"!=typeof n.onClick&&"function"==typeof s.onClick&&(t.onclick=Zs)}for(h in Ft(i,s),i=null,n)if(!s.hasOwnProperty(h)&&n.hasOwnProperty(h)&&null!=n[h])if("style"===h){var a=n[h];for(r in a)a.hasOwnProperty(r)&&(i||(i={}),i[r]="")}else"dangerouslySetInnerHTML"!==h&&"children"!==h&&"suppressContentEditableWarning"!==h&&"suppressHydrationWarning"!==h&&"autoFocus"!==h&&(v.hasOwnProperty(h)?o||(o=[]):(o=o||[]).push(h,null));for(h in s){var l=s[h];if(a=null!=n?n[h]:void 0,s.hasOwnProperty(h)&&l!==a&&(null!=l||null!=a))if("style"===h)if(a){for(r in a)!a.hasOwnProperty(r)||l&&l.hasOwnProperty(r)||(i||(i={}),i[r]="");for(r in l)l.hasOwnProperty(r)&&a[r]!==l[r]&&(i||(i={}),i[r]=l[r])}else i||(o||(o=[]),o.push(h,i)),i=l;else"dangerouslySetInnerHTML"===h?(l=l?l.__html:void 0,a=a?a.__html:void 0,null!=l&&a!==l&&(o=o||[]).push(h,l)):"children"===h?"string"!=typeof l&&"number"!=typeof l||(o=o||[]).push(h,""+l):"suppressContentEditableWarning"!==h&&"suppressHydrationWarning"!==h&&(v.hasOwnProperty(h)?(null!=l&&"onScroll"===h&&Hs("scroll",t),o||a===l||(o=[])):"object"==typeof l&&null!==l&&l.$$typeof===G?l.toString():(o=o||[]).push(h,l))}i&&(o=o||[]).push("style",i);var h=o;(e.updateQueue=h)&&(e.flags|=4)}},la=function(t,e,i,s){i!==s&&(e.flags|=4)};var Sa="function"==typeof WeakMap?WeakMap:Map;function Ca(t,e,i){(i=br(-1,i)).tag=3,i.payload={element:null};var s=e.value;return i.callback=function(){ll||(ll=!0,hl=s),ba(0,e)},i}function Ea(t,e,i){(i=br(-1,i)).tag=3;var s=t.type.getDerivedStateFromError;if("function"==typeof s){var n=e.value;i.payload=function(){return ba(0,e),s(n)}}var r=t.stateNode;return null!==r&&"function"==typeof r.componentDidCatch&&(i.callback=function(){"function"!=typeof s&&(null===cl?cl=new Set([this]):cl.add(this),ba(0,e));var t=e.stack;this.componentDidCatch(e.value,{componentStack:null!==t?t:""})}),i}var Pa="function"==typeof WeakSet?WeakSet:Set;function Aa(t){var e=t.ref;if(null!==e)if("function"==typeof e)try{e(null)}catch(e){$l(t,e)}else e.current=null}function ka(t,e){switch(e.tag){case 0:case 11:case 15:case 22:case 5:case 6:case 4:case 17:return;case 1:if(256&e.flags&&null!==t){var i=t.memoizedProps,s=t.memoizedState;e=(t=e.stateNode).getSnapshotBeforeUpdate(e.elementType===e.type?i:hr(e.type,i),s),t.__reactInternalSnapshotBeforeUpdate=e}return;case 3:return void(256&e.flags&&rn(e.stateNode.containerInfo))}throw Error(_(163))}function Ta(t,e,i){switch(i.tag){case 0:case 11:case 15:case 22:if(null!==(e=null!==(e=i.updateQueue)?e.lastEffect:null)){t=e=e.next;do{if(3==(3&t.tag)){var s=t.create;t.destroy=s()}t=t.next}while(t!==e)}if(null!==(e=null!==(e=i.updateQueue)?e.lastEffect:null)){t=e=e.next;do{var n=t;s=n.next,0!=(4&(n=n.tag))&&0!=(1&n)&&(Yl(i,t),Kl(i,t)),t=s}while(t!==e)}return;case 1:return t=i.stateNode,4&i.flags&&(null===e?t.componentDidMount():(s=i.elementType===i.type?e.memoizedProps:hr(i.type,e.memoizedProps),t.componentDidUpdate(s,e.memoizedState,t.__reactInternalSnapshotBeforeUpdate))),void(null!==(e=i.updateQueue)&&Pr(i,e,t));case 3:if(null!==(e=i.updateQueue)){if(t=null,null!==i.child)switch(i.child.tag){case 5:case 1:t=i.child.stateNode}Pr(i,e,t)}return;case 5:return t=i.stateNode,void(null===e&&4&i.flags&&tn(i.type,i.memoizedProps)&&t.focus());case 6:case 4:case 12:case 19:case 17:case 20:case 21:case 23:case 24:return;case 13:return void(null===i.memoizedState&&(i=i.alternate,null!==i&&(i=i.memoizedState,null!==i&&(i=i.dehydrated,null!==i&&Be(i)))))}throw Error(_(163))}function Ra(t,e){for(var i=t;;){if(5===i.tag){var s=i.stateNode;if(e)"function"==typeof(s=s.style).setProperty?s.setProperty("display","none","important"):s.display="none";else{s=i.stateNode;var n=i.memoizedProps.style;n=null!=n&&n.hasOwnProperty("display")?n.display:null,s.style.display=Lt("display",n)}}else if(6===i.tag)i.stateNode.nodeValue=e?"":i.memoizedProps;else if((23!==i.tag&&24!==i.tag||null===i.memoizedState||i===t)&&null!==i.child){i.child.return=i,i=i.child;continue}if(i===t)break;for(;null===i.sibling;){if(null===i.return||i.return===t)return;i=i.return}i.sibling.return=i.return,i=i.sibling}}function Ma(t,e){if(Fn&&"function"==typeof Fn.onCommitFiberUnmount)try{Fn.onCommitFiberUnmount(In,e)}catch(t){}switch(e.tag){case 0:case 11:case 14:case 15:case 22:if(null!==(t=e.updateQueue)&&null!==(t=t.lastEffect)){var i=t=t.next;do{var s=i,n=s.destroy;if(s=s.tag,void 0!==n)if(0!=(4&s))Yl(e,i);else{s=e;try{n()}catch(t){$l(s,t)}}i=i.next}while(i!==t)}break;case 1:if(Aa(e),"function"==typeof(t=e.stateNode).componentWillUnmount)try{t.props=e.memoizedProps,t.state=e.memoizedState,t.componentWillUnmount()}catch(t){$l(e,t)}break;case 5:Aa(e);break;case 4:za(t,e)}}function Da(t){t.alternate=null,t.child=null,t.dependencies=null,t.firstEffect=null,t.lastEffect=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.return=null,t.updateQueue=null}function La(t){return 5===t.tag||3===t.tag||4===t.tag}function Ba(t){t:{for(var e=t.return;null!==e;){if(La(e))break t;e=e.return}throw Error(_(160))}var i=e;switch(e=i.stateNode,i.tag){case 5:var s=!1;break;case 3:case 4:e=e.containerInfo,s=!0;break;default:throw Error(_(161))}16&i.flags&&(Rt(e,""),i.flags&=-17);t:e:for(i=t;;){for(;null===i.sibling;){if(null===i.return||La(i.return)){i=null;break t}i=i.return}for(i.sibling.return=i.return,i=i.sibling;5!==i.tag&&6!==i.tag&&18!==i.tag;){if(2&i.flags)continue e;if(null===i.child||4===i.tag)continue e;i.child.return=i,i=i.child}if(!(2&i.flags)){i=i.stateNode;break t}}s?Ia(t,i,e):Fa(t,i,e)}function Ia(t,e,i){var s=t.tag,n=5===s||6===s;if(n)t=n?t.stateNode:t.stateNode.instance,e?8===i.nodeType?i.parentNode.insertBefore(t,e):i.insertBefore(t,e):(8===i.nodeType?(e=i.parentNode).insertBefore(t,i):(e=i).appendChild(t),null!=(i=i._reactRootContainer)||null!==e.onclick||(e.onclick=Zs));else if(4!==s&&null!==(t=t.child))for(Ia(t,e,i),t=t.sibling;null!==t;)Ia(t,e,i),t=t.sibling}function Fa(t,e,i){var s=t.tag,n=5===s||6===s;if(n)t=n?t.stateNode:t.stateNode.instance,e?i.insertBefore(t,e):i.appendChild(t);else if(4!==s&&null!==(t=t.child))for(Fa(t,e,i),t=t.sibling;null!==t;)Fa(t,e,i),t=t.sibling}function za(t,e){for(var i,s,n=e,r=!1;;){if(!r){r=n.return;t:for(;;){if(null===r)throw Error(_(160));switch(i=r.stateNode,r.tag){case 5:s=!1;break t;case 3:case 4:i=i.containerInfo,s=!0;break t}r=r.return}r=!0}if(5===n.tag||6===n.tag){t:for(var o=t,a=n,l=a;;)if(Ma(o,l),null!==l.child&&4!==l.tag)l.child.return=l,l=l.child;else{if(l===a)break t;for(;null===l.sibling;){if(null===l.return||l.return===a)break t;l=l.return}l.sibling.return=l.return,l=l.sibling}s?(o=i,a=n.stateNode,8===o.nodeType?o.parentNode.removeChild(a):o.removeChild(a)):i.removeChild(n.stateNode)}else if(4===n.tag){if(null!==n.child){i=n.stateNode.containerInfo,s=!0,n.child.return=n,n=n.child;continue}}else if(Ma(t,n),null!==n.child){n.child.return=n,n=n.child;continue}if(n===e)break;for(;null===n.sibling;){if(null===n.return||n.return===e)return;4===(n=n.return).tag&&(r=!1)}n.sibling.return=n.return,n=n.sibling}}function Na(t,e){switch(e.tag){case 0:case 11:case 14:case 15:case 22:var i=e.updateQueue;if(null!==(i=null!==i?i.lastEffect:null)){var s=i=i.next;do{3==(3&s.tag)&&(t=s.destroy,s.destroy=void 0,void 0!==t&&t()),s=s.next}while(s!==i)}return;case 1:case 12:case 17:return;case 5:if(null!=(i=e.stateNode)){s=e.memoizedProps;var n=null!==t?t.memoizedProps:s;t=e.type;var r=e.updateQueue;if(e.updateQueue=null,null!==r){for(i[dn]=s,"input"===t&&"radio"===s.type&&null!=s.name&&pt(i,s),zt(t,n),e=zt(t,s),n=0;n<r.length;n+=2){var o=r[n],a=r[n+1];"style"===o?Bt(i,a):"dangerouslySetInnerHTML"===o?Tt(i,a):"children"===o?Rt(i,a):D(i,o,a,e)}switch(t){case"input":gt(i,s);break;case"textarea":xt(i,s);break;case"select":t=i._wrapperState.wasMultiple,i._wrapperState.wasMultiple=!!s.multiple,null!=(r=s.value)?_t(i,!!s.multiple,r,!1):t!==!!s.multiple&&(null!=s.defaultValue?_t(i,!!s.multiple,s.defaultValue,!0):_t(i,!!s.multiple,s.multiple?[]:"",!1))}}}return;case 6:if(null===e.stateNode)throw Error(_(162));return void(e.stateNode.nodeValue=e.memoizedProps);case 3:return void((i=e.stateNode).hydrate&&(i.hydrate=!1,Be(i.containerInfo)));case 13:return null!==e.memoizedState&&(sl=er(),Ra(e.child,!0)),void Oa(e);case 19:return void Oa(e);case 23:case 24:return void Ra(e,null!==e.memoizedState)}throw Error(_(163))}function Oa(t){var e=t.updateQueue;if(null!==e){t.updateQueue=null;var i=t.stateNode;null===i&&(i=t.stateNode=new Pa),e.forEach((function(e){var s=th.bind(null,t,e);i.has(e)||(i.add(e),e.then(s,s))}))}}function Ua(t,e){return null!==t&&(null===(t=t.memoizedState)||null!==t.dehydrated)&&(null!==(e=e.memoizedState)&&null===e.dehydrated)}var Ha=Math.ceil,Wa=L.ReactCurrentDispatcher,ja=L.ReactCurrentOwner,Va=0,qa=null,Xa=null,Ga=0,Ka=0,Ya=xn(0),Qa=0,Za=null,$a=0,Ja=0,tl=0,el=0,il=null,sl=0,nl=1/0;function rl(){nl=er()+500}var ol,al=null,ll=!1,hl=null,cl=null,dl=!1,ul=null,pl=90,gl=[],fl=[],ml=null,yl=0,_l=null,wl=-1,vl=0,xl=0,bl=null,Sl=!1;function Cl(){return 0!=(48&Va)?er():-1!==wl?wl:wl=er()}function El(t){if(0==(2&(t=t.mode)))return 1;if(0==(4&t))return 99===ir()?1:2;if(0===vl&&(vl=$a),0!==lr.transition){0!==xl&&(xl=null!==il?il.pendingLanes:0),t=vl;var e=4186112&~xl;return 0===(e&=-e)&&(0===(e=(t=4186112&~t)&-t)&&(e=8192)),e}return t=ir(),0!=(4&Va)&&98===t?t=$e(12,vl):t=$e(t=function(t){switch(t){case 99:return 15;case 98:return 10;case 97:case 96:return 8;case 95:return 2;default:return 0}}(t),vl),t}function Pl(t,e,i){if(50<yl)throw yl=0,_l=null,Error(_(185));if(null===(t=Al(t,e)))return null;ei(t,e,i),t===qa&&(tl|=e,4===Qa&&Rl(t,Ga));var s=ir();1===e?0!=(8&Va)&&0==(48&Va)?Ml(t):(kl(t,i),0===Va&&(rl(),or())):(0==(4&Va)||98!==s&&99!==s||(null===ml?ml=new Set([t]):ml.add(t)),kl(t,i)),il=t}function Al(t,e){t.lanes|=e;var i=t.alternate;for(null!==i&&(i.lanes|=e),i=t,t=t.return;null!==t;)t.childLanes|=e,null!==(i=t.alternate)&&(i.childLanes|=e),i=t,t=t.return;return 3===i.tag?i.stateNode:null}function kl(t,e){for(var i=t.callbackNode,s=t.suspendedLanes,n=t.pingedLanes,r=t.expirationTimes,o=t.pendingLanes;0<o;){var a=31-ii(o),l=1<<a,h=r[a];if(-1===h){if(0==(l&s)||0!=(l&n)){h=e,Ye(l);var c=Ke;r[a]=10<=c?h+250:6<=c?h+5e3:-1}}else h<=e&&(t.expiredLanes|=l);o&=~l}if(s=Qe(t,t===qa?Ga:0),e=Ke,0===s)null!==i&&(i!==Yn&&On(i),t.callbackNode=null,t.callbackPriority=0);else{if(null!==i){if(t.callbackPriority===e)return;i!==Yn&&On(i)}15===e?(i=Ml.bind(null,t),null===Zn?(Zn=[i],$n=Nn(Vn,ar)):Zn.push(i),i=Yn):14===e?i=rr(99,Ml.bind(null,t)):(i=function(t){switch(t){case 15:case 14:return 99;case 13:case 12:case 11:case 10:return 98;case 9:case 8:case 7:case 6:case 4:case 5:return 97;case 3:case 2:case 1:return 95;case 0:return 90;default:throw Error(_(358,t))}}(e),i=rr(i,Tl.bind(null,t))),t.callbackPriority=e,t.callbackNode=i}}function Tl(t){if(wl=-1,xl=vl=0,0!=(48&Va))throw Error(_(327));var e=t.callbackNode;if(Gl()&&t.callbackNode!==e)return null;var i=Qe(t,t===qa?Ga:0);if(0===i)return null;var s=i,n=Va;Va|=16;var r=Nl();for(qa===t&&Ga===s||(rl(),Fl(t,s));;)try{Hl();break}catch(e){zl(t,e)}if(gr(),Wa.current=r,Va=n,null!==Xa?s=0:(qa=null,Ga=0,s=Qa),0!=($a&tl))Fl(t,0);else if(0!==s){if(2===s&&(Va|=64,t.hydrate&&(t.hydrate=!1,rn(t.containerInfo)),0!==(i=Ze(t))&&(s=Ol(t,i))),1===s)throw e=Za,Fl(t,0),Rl(t,i),kl(t,er()),e;switch(t.finishedWork=t.current.alternate,t.finishedLanes=i,s){case 0:case 1:throw Error(_(345));case 2:case 5:Vl(t);break;case 3:if(Rl(t,i),(62914560&i)===i&&10<(s=sl+500-er())){if(0!==Qe(t,0))break;if(((n=t.suspendedLanes)&i)!==i){Cl(),t.pingedLanes|=t.suspendedLanes&n;break}t.timeoutHandle=sn(Vl.bind(null,t),s);break}Vl(t);break;case 4:if(Rl(t,i),(4186112&i)===i)break;for(s=t.eventTimes,n=-1;0<i;){var o=31-ii(i);r=1<<o,(o=s[o])>n&&(n=o),i&=~r}if(i=n,10<(i=(120>(i=er()-i)?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*Ha(i/1960))-i)){t.timeoutHandle=sn(Vl.bind(null,t),i);break}Vl(t);break;default:throw Error(_(329))}}return kl(t,er()),t.callbackNode===e?Tl.bind(null,t):null}function Rl(t,e){for(e&=~el,e&=~tl,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var i=31-ii(e),s=1<<i;t[i]=-1,e&=~s}}function Ml(t){if(0!=(48&Va))throw Error(_(327));if(Gl(),t===qa&&0!=(t.expiredLanes&Ga)){var e=Ga,i=Ol(t,e);0!=($a&tl)&&(i=Ol(t,e=Qe(t,e)))}else i=Ol(t,e=Qe(t,0));if(0!==t.tag&&2===i&&(Va|=64,t.hydrate&&(t.hydrate=!1,rn(t.containerInfo)),0!==(e=Ze(t))&&(i=Ol(t,e))),1===i)throw i=Za,Fl(t,0),Rl(t,e),kl(t,er()),i;return t.finishedWork=t.current.alternate,t.finishedLanes=e,Vl(t),kl(t,er()),null}function Dl(t,e){var i=Va;Va|=1;try{return t(e)}finally{0===(Va=i)&&(rl(),or())}}function Ll(t,e){var i=Va;Va&=-2,Va|=8;try{return t(e)}finally{0===(Va=i)&&(rl(),or())}}function Bl(t,e){Sn(Ya,Ka),Ka|=e,$a|=e}function Il(){Ka=Ya.current,bn(Ya)}function Fl(t,e){t.finishedWork=null,t.finishedLanes=0;var i=t.timeoutHandle;if(-1!==i&&(t.timeoutHandle=-1,nn(i)),null!==Xa)for(i=Xa.return;null!==i;){var s=i;switch(s.tag){case 1:null!=(s=s.type.childContextTypes)&&Rn();break;case 3:Xr(),bn(Pn),bn(En),ao();break;case 5:Kr(s);break;case 4:Xr();break;case 13:case 19:bn(Yr);break;case 10:fr(s);break;case 23:case 24:Il()}i=i.return}qa=t,Xa=nh(t.current,null),Ga=Ka=$a=e,Qa=0,Za=null,el=tl=Ja=0}function zl(t,e){for(;;){var i=Xa;try{if(gr(),lo.current=Vo,fo){for(var s=uo.memoizedState;null!==s;){var n=s.queue;null!==n&&(n.pending=null),s=s.next}fo=!1}if(co=0,go=po=uo=null,mo=!1,ja.current=null,null===i||null===i.return){Qa=1,Za=e,Xa=null;break}t:{var r=t,o=i.return,a=i,l=e;if(e=Ga,a.flags|=2048,a.firstEffect=a.lastEffect=null,null!==l&&"object"==typeof l&&"function"==typeof l.then){var h=l;if(0==(2&a.mode)){var c=a.alternate;c?(a.updateQueue=c.updateQueue,a.memoizedState=c.memoizedState,a.lanes=c.lanes):(a.updateQueue=null,a.memoizedState=null)}var d=0!=(1&Yr.current),u=o;do{var p;if(p=13===u.tag){var g=u.memoizedState;if(null!==g)p=null!==g.dehydrated;else{var f=u.memoizedProps;p=void 0!==f.fallback&&(!0!==f.unstable_avoidThisFallback||!d)}}if(p){var m=u.updateQueue;if(null===m){var y=new Set;y.add(h),u.updateQueue=y}else m.add(h);if(0==(2&u.mode)){if(u.flags|=64,a.flags|=16384,a.flags&=-2981,1===a.tag)if(null===a.alternate)a.tag=17;else{var _=br(-1,1);_.tag=2,Sr(a,_)}a.lanes|=1;break t}l=void 0,a=e;var w=r.pingCache;if(null===w?(w=r.pingCache=new Sa,l=new Set,w.set(h,l)):void 0===(l=w.get(h))&&(l=new Set,w.set(h,l)),!l.has(a)){l.add(a);var v=Jl.bind(null,r,h,a);h.then(v,v)}u.flags|=4096,u.lanes=e;break t}u=u.return}while(null!==u);l=Error((rt(a.type)||"A React component")+" suspended while rendering, but no fallback UI was specified.\n\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display.")}5!==Qa&&(Qa=2),l=xa(l,a),u=o;do{switch(u.tag){case 3:r=l,u.flags|=4096,e&=-e,u.lanes|=e,Cr(u,Ca(0,r,e));break t;case 1:r=l;var x=u.type,b=u.stateNode;if(0==(64&u.flags)&&("function"==typeof x.getDerivedStateFromError||null!==b&&"function"==typeof b.componentDidCatch&&(null===cl||!cl.has(b)))){u.flags|=4096,e&=-e,u.lanes|=e,Cr(u,Ea(u,r,e));break t}}u=u.return}while(null!==u)}jl(i)}catch(t){e=t,Xa===i&&null!==i&&(Xa=i=i.return);continue}break}}function Nl(){var t=Wa.current;return Wa.current=Vo,null===t?Vo:t}function Ol(t,e){var i=Va;Va|=16;var s=Nl();for(qa===t&&Ga===e||Fl(t,e);;)try{Ul();break}catch(e){zl(t,e)}if(gr(),Va=i,Wa.current=s,null!==Xa)throw Error(_(261));return qa=null,Ga=0,Qa}function Ul(){for(;null!==Xa;)Wl(Xa)}function Hl(){for(;null!==Xa&&!Un();)Wl(Xa)}function Wl(t){var e=ol(t.alternate,t,Ka);t.memoizedProps=t.pendingProps,null===e?jl(t):Xa=e,ja.current=null}function jl(t){var e=t;do{var i=e.alternate;if(t=e.return,0==(2048&e.flags)){if(null!==(i=wa(i,e,Ka)))return void(Xa=i);if(24!==(i=e).tag&&23!==i.tag||null===i.memoizedState||0!=(1073741824&Ka)||0==(4&i.mode)){for(var s=0,n=i.child;null!==n;)s|=n.lanes|n.childLanes,n=n.sibling;i.childLanes=s}null!==t&&0==(2048&t.flags)&&(null===t.firstEffect&&(t.firstEffect=e.firstEffect),null!==e.lastEffect&&(null!==t.lastEffect&&(t.lastEffect.nextEffect=e.firstEffect),t.lastEffect=e.lastEffect),1<e.flags&&(null!==t.lastEffect?t.lastEffect.nextEffect=e:t.firstEffect=e,t.lastEffect=e))}else{if(null!==(i=va(e)))return i.flags&=2047,void(Xa=i);null!==t&&(t.firstEffect=t.lastEffect=null,t.flags|=2048)}if(null!==(e=e.sibling))return void(Xa=e);Xa=e=t}while(null!==e);0===Qa&&(Qa=5)}function Vl(t){var e=ir();return nr(99,ql.bind(null,t,e)),null}function ql(t,e){do{Gl()}while(null!==ul);if(0!=(48&Va))throw Error(_(327));var i=t.finishedWork;if(null===i)return null;if(t.finishedWork=null,t.finishedLanes=0,i===t.current)throw Error(_(177));t.callbackNode=null;var s=i.lanes|i.childLanes,n=s,r=t.pendingLanes&~n;t.pendingLanes=n,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=n,t.mutableReadLanes&=n,t.entangledLanes&=n,n=t.entanglements;for(var o=t.eventTimes,a=t.expirationTimes;0<r;){var l=31-ii(r),h=1<<l;n[l]=0,o[l]=-1,a[l]=-1,r&=~h}if(null!==ml&&0==(24&s)&&ml.has(t)&&ml.delete(t),t===qa&&(Xa=qa=null,Ga=0),1<i.flags?null!==i.lastEffect?(i.lastEffect.nextEffect=i,s=i.firstEffect):s=i:s=i.firstEffect,null!==s){if(n=Va,Va|=32,ja.current=null,$s=ai,ks(o=As())){if("selectionStart"in o)a={start:o.selectionStart,end:o.selectionEnd};else t:if(a=(a=o.ownerDocument)&&a.defaultView||window,(h=a.getSelection&&a.getSelection())&&0!==h.rangeCount){a=h.anchorNode,r=h.anchorOffset,l=h.focusNode,h=h.focusOffset;try{a.nodeType,l.nodeType}catch(t){a=null;break t}var c=0,d=-1,u=-1,p=0,g=0,f=o,m=null;e:for(;;){for(var y;f!==a||0!==r&&3!==f.nodeType||(d=c+r),f!==l||0!==h&&3!==f.nodeType||(u=c+h),3===f.nodeType&&(c+=f.nodeValue.length),null!==(y=f.firstChild);)m=f,f=y;for(;;){if(f===o)break e;if(m===a&&++p===r&&(d=c),m===l&&++g===h&&(u=c),null!==(y=f.nextSibling))break;m=(f=m).parentNode}f=y}a=-1===d||-1===u?null:{start:d,end:u}}else a=null;a=a||{start:0,end:0}}else a=null;Js={focusedElem:o,selectionRange:a},ai=!1,bl=null,Sl=!1,al=s;do{try{Xl()}catch(t){if(null===al)throw Error(_(330));$l(al,t),al=al.nextEffect}}while(null!==al);bl=null,al=s;do{try{for(o=t;null!==al;){var w=al.flags;if(16&w&&Rt(al.stateNode,""),128&w){var v=al.alternate;if(null!==v){var x=v.ref;null!==x&&("function"==typeof x?x(null):x.current=null)}}switch(1038&w){case 2:Ba(al),al.flags&=-3;break;case 6:Ba(al),al.flags&=-3,Na(al.alternate,al);break;case 1024:al.flags&=-1025;break;case 1028:al.flags&=-1025,Na(al.alternate,al);break;case 4:Na(al.alternate,al);break;case 8:za(o,a=al);var b=a.alternate;Da(a),null!==b&&Da(b)}al=al.nextEffect}}catch(t){if(null===al)throw Error(_(330));$l(al,t),al=al.nextEffect}}while(null!==al);if(x=Js,v=As(),w=x.focusedElem,o=x.selectionRange,v!==w&&w&&w.ownerDocument&&Ps(w.ownerDocument.documentElement,w)){null!==o&&ks(w)&&(v=o.start,void 0===(x=o.end)&&(x=v),"selectionStart"in w?(w.selectionStart=v,w.selectionEnd=Math.min(x,w.value.length)):(x=(v=w.ownerDocument||document)&&v.defaultView||window).getSelection&&(x=x.getSelection(),a=w.textContent.length,b=Math.min(o.start,a),o=void 0===o.end?b:Math.min(o.end,a),!x.extend&&b>o&&(a=o,o=b,b=a),a=Es(w,b),r=Es(w,o),a&&r&&(1!==x.rangeCount||x.anchorNode!==a.node||x.anchorOffset!==a.offset||x.focusNode!==r.node||x.focusOffset!==r.offset)&&((v=v.createRange()).setStart(a.node,a.offset),x.removeAllRanges(),b>o?(x.addRange(v),x.extend(r.node,r.offset)):(v.setEnd(r.node,r.offset),x.addRange(v))))),v=[];for(x=w;x=x.parentNode;)1===x.nodeType&&v.push({element:x,left:x.scrollLeft,top:x.scrollTop});for("function"==typeof w.focus&&w.focus(),w=0;w<v.length;w++)(x=v[w]).element.scrollLeft=x.left,x.element.scrollTop=x.top}ai=!!$s,Js=$s=null,t.current=i,al=s;do{try{for(w=t;null!==al;){var S=al.flags;if(36&S&&Ta(w,al.alternate,al),128&S){v=void 0;var C=al.ref;if(null!==C){var E=al.stateNode;al.tag,v=E,"function"==typeof C?C(v):C.current=v}}al=al.nextEffect}}catch(t){if(null===al)throw Error(_(330));$l(al,t),al=al.nextEffect}}while(null!==al);al=null,Qn(),Va=n}else t.current=i;if(dl)dl=!1,ul=t,pl=e;else for(al=s;null!==al;)e=al.nextEffect,al.nextEffect=null,8&al.flags&&((S=al).sibling=null,S.stateNode=null),al=e;if(0===(s=t.pendingLanes)&&(cl=null),1===s?t===_l?yl++:(yl=0,_l=t):yl=0,i=i.stateNode,Fn&&"function"==typeof Fn.onCommitFiberRoot)try{Fn.onCommitFiberRoot(In,i,void 0,64==(64&i.current.flags))}catch(t){}if(kl(t,er()),ll)throw ll=!1,t=hl,hl=null,t;return 0!=(8&Va)||or(),null}function Xl(){for(;null!==al;){var t=al.alternate;Sl||null===bl||(0!=(8&al.flags)?ue(al,bl)&&(Sl=!0):13===al.tag&&Ua(t,al)&&ue(al,bl)&&(Sl=!0));var e=al.flags;0!=(256&e)&&ka(t,al),0==(512&e)||dl||(dl=!0,rr(97,(function(){return Gl(),null}))),al=al.nextEffect}}function Gl(){if(90!==pl){var t=97<pl?97:pl;return pl=90,nr(t,Ql)}return!1}function Kl(t,e){gl.push(e,t),dl||(dl=!0,rr(97,(function(){return Gl(),null})))}function Yl(t,e){fl.push(e,t),dl||(dl=!0,rr(97,(function(){return Gl(),null})))}function Ql(){if(null===ul)return!1;var t=ul;if(ul=null,0!=(48&Va))throw Error(_(331));var e=Va;Va|=32;var i=fl;fl=[];for(var s=0;s<i.length;s+=2){var n=i[s],r=i[s+1],o=n.destroy;if(n.destroy=void 0,"function"==typeof o)try{o()}catch(t){if(null===r)throw Error(_(330));$l(r,t)}}for(i=gl,gl=[],s=0;s<i.length;s+=2){n=i[s],r=i[s+1];try{var a=n.create;n.destroy=a()}catch(t){if(null===r)throw Error(_(330));$l(r,t)}}for(a=t.current.firstEffect;null!==a;)t=a.nextEffect,a.nextEffect=null,8&a.flags&&(a.sibling=null,a.stateNode=null),a=t;return Va=e,or(),!0}function Zl(t,e,i){Sr(t,e=Ca(0,e=xa(i,e),1)),e=Cl(),null!==(t=Al(t,1))&&(ei(t,1,e),kl(t,e))}function $l(t,e){if(3===t.tag)Zl(t,t,e);else for(var i=t.return;null!==i;){if(3===i.tag){Zl(i,t,e);break}if(1===i.tag){var s=i.stateNode;if("function"==typeof i.type.getDerivedStateFromError||"function"==typeof s.componentDidCatch&&(null===cl||!cl.has(s))){var n=Ea(i,t=xa(e,t),1);if(Sr(i,n),n=Cl(),null!==(i=Al(i,1)))ei(i,1,n),kl(i,n);else if("function"==typeof s.componentDidCatch&&(null===cl||!cl.has(s)))try{s.componentDidCatch(e,t)}catch(t){}break}}i=i.return}}function Jl(t,e,i){var s=t.pingCache;null!==s&&s.delete(e),e=Cl(),t.pingedLanes|=t.suspendedLanes&i,qa===t&&(Ga&i)===i&&(4===Qa||3===Qa&&(62914560&Ga)===Ga&&500>er()-sl?Fl(t,0):el|=i),kl(t,e)}function th(t,e){var i=t.stateNode;null!==i&&i.delete(e),0===(e=0)&&(0==(2&(e=t.mode))?e=1:0==(4&e)?e=99===ir()?1:2:(0===vl&&(vl=$a),0===(e=Je(62914560&~vl))&&(e=4194304))),i=Cl(),null!==(t=Al(t,e))&&(ei(t,e,i),kl(t,i))}function eh(t,e,i,s){this.tag=t,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.flags=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childLanes=this.lanes=0,this.alternate=null}function ih(t,e,i,s){return new eh(t,e,i,s)}function sh(t){return!(!(t=t.prototype)||!t.isReactComponent)}function nh(t,e){var i=t.alternate;return null===i?((i=ih(t.tag,e,t.key,t.mode)).elementType=t.elementType,i.type=t.type,i.stateNode=t.stateNode,i.alternate=t,t.alternate=i):(i.pendingProps=e,i.type=t.type,i.flags=0,i.nextEffect=null,i.firstEffect=null,i.lastEffect=null),i.childLanes=t.childLanes,i.lanes=t.lanes,i.child=t.child,i.memoizedProps=t.memoizedProps,i.memoizedState=t.memoizedState,i.updateQueue=t.updateQueue,e=t.dependencies,i.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext},i.sibling=t.sibling,i.index=t.index,i.ref=t.ref,i}function rh(t,e,i,s,n,r){var o=2;if(s=t,"function"==typeof t)sh(t)&&(o=1);else if("string"==typeof t)o=5;else t:switch(t){case F:return oh(i.children,n,r,e);case K:o=8,n|=16;break;case z:o=8,n|=1;break;case N:return(t=ih(12,i,e,8|n)).elementType=N,t.type=N,t.lanes=r,t;case W:return(t=ih(13,i,e,n)).type=W,t.elementType=W,t.lanes=r,t;case j:return(t=ih(19,i,e,n)).elementType=j,t.lanes=r,t;case Y:return ah(i,n,r,e);case Q:return(t=ih(24,i,e,n)).elementType=Q,t.lanes=r,t;default:if("object"==typeof t&&null!==t)switch(t.$$typeof){case O:o=10;break t;case U:o=9;break t;case H:o=11;break t;case V:o=14;break t;case q:o=16,s=null;break t;case X:o=22;break t}throw Error(_(130,null==t?t:typeof t,""))}return(e=ih(o,i,e,n)).elementType=t,e.type=s,e.lanes=r,e}function oh(t,e,i,s){return(t=ih(7,t,s,e)).lanes=i,t}function ah(t,e,i,s){return(t=ih(23,t,s,e)).elementType=Y,t.lanes=i,t}function lh(t,e,i){return(t=ih(6,t,null,e)).lanes=i,t}function hh(t,e,i){return(e=ih(4,null!==t.children?t.children:[],t.key,e)).lanes=i,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function ch(t,e,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.pendingContext=this.context=null,this.hydrate=i,this.callbackNode=null,this.callbackPriority=0,this.eventTimes=ti(0),this.expirationTimes=ti(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ti(0),this.mutableSourceEagerHydrationData=null}function dh(t,e,i){var s=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:I,key:null==s?null:""+s,children:t,containerInfo:e,implementation:i}}function uh(t,e,i,s){var n=e.current,r=Cl(),o=El(n);t:if(i){e:{if(le(i=i._reactInternals)!==i||1!==i.tag)throw Error(_(170));var a=i;do{switch(a.tag){case 3:a=a.stateNode.context;break e;case 1:if(Tn(a.type)){a=a.stateNode.__reactInternalMemoizedMergedChildContext;break e}}a=a.return}while(null!==a);throw Error(_(171))}if(1===i.tag){var l=i.type;if(Tn(l)){i=Dn(i,l,a);break t}}i=a}else i=Cn;return null===e.context?e.context=i:e.pendingContext=i,(e=br(r,o)).payload={element:t},null!==(s=void 0===s?null:s)&&(e.callback=s),Sr(n,e),Pl(n,o,r),o}function ph(t){return(t=t.current).child?(t.child.tag,t.child.stateNode):null}function gh(t,e){if(null!==(t=t.memoizedState)&&null!==t.dehydrated){var i=t.retryLane;t.retryLane=0!==i&&i<e?i:e}}function fh(t,e){gh(t,e),(t=t.alternate)&&gh(t,e)}function mh(t,e,i){var s=null!=i&&null!=i.hydrationOptions&&i.hydrationOptions.mutableSources||null;if(i=new ch(t,e,null!=i&&!0===i.hydrate),e=ih(3,null,null,2===e?7:1===e?3:0),i.current=e,e.stateNode=i,vr(e),t[un]=i.current,js(8===t.nodeType?t.parentNode:t),s)for(t=0;t<s.length;t++){var n=(e=s[t])._getVersion;n=n(e._source),null==i.mutableSourceEagerHydrationData?i.mutableSourceEagerHydrationData=[e,n]:i.mutableSourceEagerHydrationData.push(e,n)}this._internalRoot=i}function yh(t){return!(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType&&(8!==t.nodeType||" react-mount-point-unstable "!==t.nodeValue))}function _h(t,e,i,s,n){var r=i._reactRootContainer;if(r){var o=r._internalRoot;if("function"==typeof n){var a=n;n=function(){var t=ph(o);a.call(t)}}uh(e,o,t,n)}else{if(r=i._reactRootContainer=function(t,e){if(e||(e=!(!(e=t?9===t.nodeType?t.documentElement:t.firstChild:null)||1!==e.nodeType||!e.hasAttribute("data-reactroot"))),!e)for(var i;i=t.lastChild;)t.removeChild(i);return new mh(t,0,e?{hydrate:!0}:void 0)}(i,s),o=r._internalRoot,"function"==typeof n){var l=n;n=function(){var t=ph(o);l.call(t)}}Ll((function(){uh(e,o,t,n)}))}return ph(o)}function wh(t,e){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!yh(e))throw Error(_(200));return dh(t,e,null,i)}ol=function(t,e,i){var s=e.lanes;if(null!==t)if(t.memoizedProps!==e.pendingProps||Pn.current)Yo=!0;else{if(0==(i&s)){switch(Yo=!1,e.tag){case 3:ra(e),ro();break;case 5:Gr(e);break;case 1:Tn(e.type)&&Ln(e);break;case 4:qr(e,e.stateNode.containerInfo);break;case 10:s=e.memoizedProps.value;var n=e.type._context;Sn(cr,n._currentValue),n._currentValue=s;break;case 13:if(null!==e.memoizedState)return 0!=(i&e.child.childLanes)?ca(t,e,i):(Sn(Yr,1&Yr.current),null!==(e=ya(t,e,i))?e.sibling:null);Sn(Yr,1&Yr.current);break;case 19:if(s=0!=(i&e.childLanes),0!=(64&t.flags)){if(s)return ma(t,e,i);e.flags|=64}if(null!==(n=e.memoizedState)&&(n.rendering=null,n.tail=null,n.lastEffect=null),Sn(Yr,Yr.current),s)break;return null;case 23:case 24:return e.lanes=0,ta(t,e,i)}return ya(t,e,i)}Yo=0!=(16384&t.flags)}else Yo=!1;switch(e.lanes=0,e.tag){case 2:if(s=e.type,null!==t&&(t.alternate=null,e.alternate=null,e.flags|=2),t=e.pendingProps,n=kn(e,En.current),yr(e,i),n=wo(null,e,s,t,n,i),e.flags|=1,"object"==typeof n&&null!==n&&"function"==typeof n.render&&void 0===n.$$typeof){if(e.tag=1,e.memoizedState=null,e.updateQueue=null,Tn(s)){var r=!0;Ln(e)}else r=!1;e.memoizedState=null!==n.state&&void 0!==n.state?n.state:null,vr(e);var o=s.getDerivedStateFromProps;"function"==typeof o&&kr(e,s,o,t),n.updater=Tr,e.stateNode=n,n._reactInternals=e,Lr(e,s,t,i),e=na(null,e,s,!0,r,i)}else e.tag=0,Qo(null,e,n,i),e=e.child;return e;case 16:n=e.elementType;t:{switch(null!==t&&(t.alternate=null,e.alternate=null,e.flags|=2),t=e.pendingProps,n=(r=n._init)(n._payload),e.type=n,r=e.tag=function(t){if("function"==typeof t)return sh(t)?1:0;if(null!=t){if((t=t.$$typeof)===H)return 11;if(t===V)return 14}return 2}(n),t=hr(n,t),r){case 0:e=ia(null,e,n,t,i);break t;case 1:e=sa(null,e,n,t,i);break t;case 11:e=Zo(null,e,n,t,i);break t;case 14:e=$o(null,e,n,hr(n.type,t),s,i);break t}throw Error(_(306,n,""))}return e;case 0:return s=e.type,n=e.pendingProps,ia(t,e,s,n=e.elementType===s?n:hr(s,n),i);case 1:return s=e.type,n=e.pendingProps,sa(t,e,s,n=e.elementType===s?n:hr(s,n),i);case 3:if(ra(e),s=e.updateQueue,null===t||null===s)throw Error(_(282));if(s=e.pendingProps,n=null!==(n=e.memoizedState)?n.element:null,xr(t,e),Er(e,s,null,i),(s=e.memoizedState.element)===n)ro(),e=ya(t,e,i);else{if((r=(n=e.stateNode).hydrate)&&($r=on(e.stateNode.containerInfo.firstChild),Zr=e,r=Jr=!0),r){if(null!=(t=n.mutableSourceEagerHydrationData))for(n=0;n<t.length;n+=2)(r=t[n])._workInProgressVersionPrimary=t[n+1],oo.push(r);for(i=Or(e,null,s,i),e.child=i;i;)i.flags=-3&i.flags|1024,i=i.sibling}else Qo(t,e,s,i),ro();e=e.child}return e;case 5:return Gr(e),null===t&&io(e),s=e.type,n=e.pendingProps,r=null!==t?t.memoizedProps:null,o=n.children,en(s,n)?o=null:null!==r&&en(s,r)&&(e.flags|=16),ea(t,e),Qo(t,e,o,i),e.child;case 6:return null===t&&io(e),null;case 13:return ca(t,e,i);case 4:return qr(e,e.stateNode.containerInfo),s=e.pendingProps,null===t?e.child=Nr(e,null,s,i):Qo(t,e,s,i),e.child;case 11:return s=e.type,n=e.pendingProps,Zo(t,e,s,n=e.elementType===s?n:hr(s,n),i);case 7:return Qo(t,e,e.pendingProps,i),e.child;case 8:case 12:return Qo(t,e,e.pendingProps.children,i),e.child;case 10:t:{s=e.type._context,n=e.pendingProps,o=e.memoizedProps,r=n.value;var a=e.type._context;if(Sn(cr,a._currentValue),a._currentValue=r,null!==o)if(a=o.value,0===(r=xs(a,r)?0:0|("function"==typeof s._calculateChangedBits?s._calculateChangedBits(a,r):1073741823))){if(o.children===n.children&&!Pn.current){e=ya(t,e,i);break t}}else for(null!==(a=e.child)&&(a.return=e);null!==a;){var l=a.dependencies;if(null!==l){o=a.child;for(var h=l.firstContext;null!==h;){if(h.context===s&&0!=(h.observedBits&r)){1===a.tag&&((h=br(-1,i&-i)).tag=2,Sr(a,h)),a.lanes|=i,null!==(h=a.alternate)&&(h.lanes|=i),mr(a.return,i),l.lanes|=i;break}h=h.next}}else o=10===a.tag&&a.type===e.type?null:a.child;if(null!==o)o.return=a;else for(o=a;null!==o;){if(o===e){o=null;break}if(null!==(a=o.sibling)){a.return=o.return,o=a;break}o=o.return}a=o}Qo(t,e,n.children,i),e=e.child}return e;case 9:return n=e.type,s=(r=e.pendingProps).children,yr(e,i),s=s(n=_r(n,r.unstable_observedBits)),e.flags|=1,Qo(t,e,s,i),e.child;case 14:return r=hr(n=e.type,e.pendingProps),$o(t,e,n,r=hr(n.type,r),s,i);case 15:return Jo(t,e,e.type,e.pendingProps,s,i);case 17:return s=e.type,n=e.pendingProps,n=e.elementType===s?n:hr(s,n),null!==t&&(t.alternate=null,e.alternate=null,e.flags|=2),e.tag=1,Tn(s)?(t=!0,Ln(e)):t=!1,yr(e,i),Mr(e,s,n),Lr(e,s,n,i),na(null,e,s,!0,t,i);case 19:return ma(t,e,i);case 23:case 24:return ta(t,e,i)}throw Error(_(156,e.tag))},mh.prototype.render=function(t){uh(t,this._internalRoot,null,null)},mh.prototype.unmount=function(){var t=this._internalRoot,e=t.containerInfo;uh(null,t,null,(function(){e[un]=null}))},pe=function(t){13===t.tag&&(Pl(t,4,Cl()),fh(t,4))},ge=function(t){13===t.tag&&(Pl(t,67108864,Cl()),fh(t,67108864))},fe=function(t){if(13===t.tag){var e=Cl(),i=El(t);Pl(t,i,e),fh(t,i)}},me=function(t,e){return e()},Ot=function(t,e,i){switch(e){case"input":if(gt(t,i),e=i.name,"radio"===i.type&&null!=e){for(i=t;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<i.length;e++){var s=i[e];if(s!==t&&s.form===t.form){var n=yn(s);if(!n)throw Error(_(90));ht(s),gt(s,n)}}}break;case"textarea":xt(t,i);break;case"select":null!=(e=i.value)&&_t(t,!!i.multiple,e,!1)}},qt=Dl,Xt=function(t,e,i,s,n){var r=Va;Va|=4;try{return nr(98,t.bind(null,e,i,s,n))}finally{0===(Va=r)&&(rl(),or())}},Gt=function(){0==(49&Va)&&(function(){if(null!==ml){var t=ml;ml=null,t.forEach((function(t){t.expiredLanes|=24&t.pendingLanes,kl(t,er())}))}or()}(),Gl())},Kt=function(t,e){var i=Va;Va|=2;try{return t(e)}finally{0===(Va=i)&&(rl(),or())}};var vh={Events:[fn,mn,yn,jt,Vt,Gl,{current:!1}]},xh={findFiberByHostInstance:gn,bundleType:0,version:"17.0.2",rendererPackageName:"react-dom"},bh={bundleType:xh.bundleType,version:xh.version,rendererPackageName:xh.rendererPackageName,rendererConfig:xh.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:L.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return null===(t=de(t))?null:t.stateNode},findFiberByHostInstance:xh.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null};if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var Sh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Sh.isDisabled&&Sh.supportsFiber)try{In=Sh.inject(bh),Fn=Sh}catch(kt){}}s=vh,r=wh,o=function(t){if(null==t)return null;if(1===t.nodeType)return t;var e=t._reactInternals;if(void 0===e){if("function"==typeof t.render)throw Error(_(188));throw Error(_(268,Object.keys(t)))}return t=null===(t=de(e))?null:t.stateNode},a=function(t,e){var i=Va;if(0!=(48&i))return t(e);Va|=1;try{if(t)return nr(99,t.bind(null,e))}finally{Va=i,or()}},l=function(t,e,i){if(!yh(e))throw Error(_(200));return _h(null,t,e,!0,i)},h=function(t,e,i){if(!yh(e))throw Error(_(200));return _h(null,t,e,!1,i)},c=function(t){if(!yh(t))throw Error(_(40));return!!t._reactRootContainer&&(Ll((function(){_h(null,null,t,!1,(function(){t._reactRootContainer=null,t[un]=null}))})),!0)},d=Dl,u=function(t,e){return wh(t,e,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null)},p=function(t,e,i,s){if(!yh(i))throw Error(_(200));if(null==t||void 0===t._reactInternals)throw Error(_(38));return _h(t,e,i,!1,s)},g="17.0.2"})),n.register("1Ughu",(function(t,e){t.exports=n("kHcYD")})),n.register("kHcYD",(function(e,i){var s,n,r,o,a,l,h,c,d,u,p,g,f,m,y,_,w,v,x,b,S,C,E;if(t(e.exports,"unstable_now",(()=>s),(t=>s=t)),t(e.exports,"unstable_shouldYield",(()=>n),(t=>n=t)),t(e.exports,"unstable_forceFrameRate",(()=>r),(t=>r=t)),t(e.exports,"unstable_IdlePriority",(()=>o),(t=>o=t)),t(e.exports,"unstable_ImmediatePriority",(()=>a),(t=>a=t)),t(e.exports,"unstable_LowPriority",(()=>l),(t=>l=t)),t(e.exports,"unstable_NormalPriority",(()=>h),(t=>h=t)),t(e.exports,"unstable_Profiling",(()=>c),(t=>c=t)),t(e.exports,"unstable_UserBlockingPriority",(()=>d),(t=>d=t)),t(e.exports,"unstable_cancelCallback",(()=>u),(t=>u=t)),t(e.exports,"unstable_continueExecution",(()=>p),(t=>p=t)),t(e.exports,"unstable_getCurrentPriorityLevel",(()=>g),(t=>g=t)),t(e.exports,"unstable_getFirstCallbackNode",(()=>f),(t=>f=t)),t(e.exports,"unstable_next",(()=>m),(t=>m=t)),t(e.exports,"unstable_pauseExecution",(()=>y),(t=>y=t)),t(e.exports,"unstable_requestPaint",(()=>_),(t=>_=t)),t(e.exports,"unstable_runWithPriority",(()=>w),(t=>w=t)),t(e.exports,"unstable_scheduleCallback",(()=>v),(t=>v=t)),t(e.exports,"unstable_wrapCallback",(()=>x),(t=>x=t)),"object"==typeof performance&&"function"==typeof performance.now){var P=performance;s=function(){return P.now()}}else{var A=Date,k=A.now();s=function(){return A.now()-k}}if("undefined"==typeof window||"function"!=typeof MessageChannel){var T=null,R=null,M=function(){if(null!==T)try{var t=s();T(!0,t),T=null}catch(t){throw setTimeout(M,0),t}};b=function(t){null!==T?setTimeout(b,0,t):(T=t,setTimeout(M,0))},S=function(t,e){R=setTimeout(t,e)},C=function(){clearTimeout(R)},n=function(){return!1},E=r=function(){}}else{var D=window.setTimeout,L=window.clearTimeout;if("undefined"!=typeof console){var B=window.cancelAnimationFrame;"function"!=typeof window.requestAnimationFrame&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills"),"function"!=typeof B&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills")}var I=!1,F=null,z=-1,N=5,O=0;n=function(){return s()>=O},E=function(){},r=function(t){0>t||125<t?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<t?Math.floor(1e3/t):5};var U=new MessageChannel,H=U.port2;U.port1.onmessage=function(){if(null!==F){var t=s();O=t+N;try{F(!0,t)?H.postMessage(null):(I=!1,F=null)}catch(t){throw H.postMessage(null),t}}else I=!1},b=function(t){F=t,I||(I=!0,H.postMessage(null))},S=function(t,e){z=D((function(){t(s())}),e)},C=function(){L(z),z=-1}}function W(t,e){var i=t.length;t.push(e);t:for(;;){var s=i-1>>>1,n=t[s];if(!(void 0!==n&&0<q(n,e)))break t;t[s]=e,t[i]=n,i=s}}function j(t){return void 0===(t=t[0])?null:t}function V(t){var e=t[0];if(void 0!==e){var i=t.pop();if(i!==e){t[0]=i;t:for(var s=0,n=t.length;s<n;){var r=2*(s+1)-1,o=t[r],a=r+1,l=t[a];if(void 0!==o&&0>q(o,i))void 0!==l&&0>q(l,o)?(t[s]=l,t[a]=i,s=a):(t[s]=o,t[r]=i,s=r);else{if(!(void 0!==l&&0>q(l,i)))break t;t[s]=l,t[a]=i,s=a}}}return e}return null}function q(t,e){var i=t.sortIndex-e.sortIndex;return 0!==i?i:t.id-e.id}var X=[],G=[],K=1,Y=null,Q=3,Z=!1,$=!1,J=!1;function tt(t){for(var e=j(G);null!==e;){if(null===e.callback)V(G);else{if(!(e.startTime<=t))break;V(G),e.sortIndex=e.expirationTime,W(X,e)}e=j(G)}}function et(t){if(J=!1,tt(t),!$)if(null!==j(X))$=!0,b(it);else{var e=j(G);null!==e&&S(et,e.startTime-t)}}function it(t,e){$=!1,J&&(J=!1,C()),Z=!0;var i=Q;try{for(tt(e),Y=j(X);null!==Y&&(!(Y.expirationTime>e)||t&&!n());){var r=Y.callback;if("function"==typeof r){Y.callback=null,Q=Y.priorityLevel;var o=r(Y.expirationTime<=e);e=s(),"function"==typeof o?Y.callback=o:Y===j(X)&&V(X),tt(e)}else V(X);Y=j(X)}if(null!==Y)var a=!0;else{var l=j(G);null!==l&&S(et,l.startTime-e),a=!1}return a}finally{Y=null,Q=i,Z=!1}}o=5,a=1,l=4,h=3,c=null,d=2,u=function(t){t.callback=null},p=function(){$||Z||($=!0,b(it))},g=function(){return Q},f=function(){return j(X)},m=function(t){switch(Q){case 1:case 2:case 3:var e=3;break;default:e=Q}var i=Q;Q=e;try{return t()}finally{Q=i}},y=function(){},_=E,w=function(t,e){switch(t){case 1:case 2:case 3:case 4:case 5:break;default:t=3}var i=Q;Q=t;try{return e()}finally{Q=i}},v=function(t,e,i){var n=s();switch("object"==typeof i&&null!==i?i="number"==typeof(i=i.delay)&&0<i?n+i:n:i=n,t){case 1:var r=-1;break;case 2:r=250;break;case 5:r=1073741823;break;case 4:r=1e4;break;default:r=5e3}return t={id:K++,callback:e,priorityLevel:t,startTime:i,expirationTime:r=i+r,sortIndex:-1},i>n?(t.sortIndex=i,W(G,t),null===j(X)&&t===j(G)&&(J?C():J=!0,S(et,i-n))):(t.sortIndex=r,W(X,t),$||Z||($=!0,b(it))),t},x=function(t){var e=Q;return function(){var i=Q;Q=e;try{return t.apply(this,arguments)}finally{Q=i}}}})),a=n("fcJjW");o=n("eCRxs");
/*!
 * excalibur - 0.25.1 - 2021-11-5
 * https://github.com/excaliburjs/Excalibur
 * Copyright (c) 2021 Excalibur.js <https://github.com/excaliburjs/Excalibur/graphs/contributors>
 * Licensed BSD-2-Clause
 * @preserve
 */var l={4662:(t,e,i)=>{i(3430);var s=i(8791);t.exports=s("Array","sort")},8343:(t,e,i)=>{i(4769);var s=i(9276);t.exports=s.Object.keys},7111:(t,e,i)=>{var s=i(6733),n=i(9821);t.exports=function(t){if(s(t))return t;throw TypeError(n(t)+" is not a function")}},1176:(t,e,i)=>{var s=i(5052);t.exports=function(t){if(s(t))return t;throw TypeError(String(t)+" is not an object")}},9540:(t,e,i)=>{var s=i(905),n=i(4237),r=i(3231),o=function(t){return function(e,i,o){var a,l=s(e),h=n(l.length),c=r(o,h);if(t&&i!=i){for(;h>c;)if((a=l[c++])!=a)return!0}else for(;h>c;c++)if((t||c in l)&&l[c]===i)return t||c||0;return!t&&-1}};t.exports={includes:o(!0),indexOf:o(!1)}},6038:(t,e,i)=>{var s=i(4229);t.exports=function(t,e){var i=[][t];return!!i&&s((function(){i.call(null,e||function(){throw 1},1)}))}},3867:t=>{var e=Math.floor,i=function(t,r){var o=t.length,a=e(o/2);return o<8?s(t,r):n(i(t.slice(0,a),r),i(t.slice(a),r),r)},s=function(t,e){for(var i,s,n=t.length,r=1;r<n;){for(s=r,i=t[r];s&&e(t[s-1],i)>0;)t[s]=t[--s];s!==r++&&(t[s]=i)}return t},n=function(t,e,i){for(var s=t.length,n=e.length,r=0,o=0,a=[];r<s||o<n;)r<s&&o<n?a.push(i(t[r],e[o])<=0?t[r++]:e[o++]):a.push(r<s?t[r++]:e[o++]);return a};t.exports=i},7079:t=>{var e={}.toString;t.exports=function(t){return e.call(t).slice(8,-1)}},1589:(t,e,i)=>{var s=i(1601),n=i(6733),r=i(7079),o=i(95)("toStringTag"),a="Arguments"==r(function(){return arguments}());t.exports=s?r:function(t){var e,i,s;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(i=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),o))?i:a?r(e):"Object"==(s=r(e))&&n(e.callee)?"Arguments":s}},7081:(t,e,i)=>{var s=i(816),n=i(4826),r=i(7933),o=i(1787);t.exports=function(t,e){for(var i=n(e),a=o.f,l=r.f,h=0;h<i.length;h++){var c=i[h];s(t,c)||a(t,c,l(e,c))}}},5762:(t,e,i)=>{var s=i(7400),n=i(1787),r=i(5358);t.exports=s?function(t,e,i){return n.f(t,e,r(1,i))}:function(t,e,i){return t[e]=i,t}},5358:t=>{t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},7400:(t,e,i)=>{var s=i(4229);t.exports=!s((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},2635:(t,e,i)=>{var s=i(9859),n=i(5052),r=s.document,o=n(r)&&n(r.createElement);t.exports=function(t){return o?r.createElement(t):{}}},2671:(t,e,i)=>{var s=i(598).match(/firefox\/(\d+)/i);t.exports=!!s&&+s[1]},8506:(t,e,i)=>{var s=i(598);t.exports=/MSIE|Trident/.test(s)},598:(t,e,i)=>{var s=i(1333);t.exports=s("navigator","userAgent")||""},6358:(t,e,i)=>{var s,n,r=i(9859),o=i(598),a=r.process,l=r.Deno,h=a&&a.versions||l&&l.version,c=h&&h.v8;c?n=(s=c.split("."))[0]<4?1:s[0]+s[1]:o&&(!(s=o.match(/Edge\/(\d+)/))||s[1]>=74)&&(s=o.match(/Chrome\/(\d+)/))&&(n=s[1]),t.exports=n&&+n},9811:(t,e,i)=>{var s=i(598).match(/AppleWebKit\/(\d+)\./);t.exports=!!s&&+s[1]},8791:(t,e,i)=>{var s=i(9859),n=i(7636),r=Function.call;t.exports=function(t,e,i){return n(r,s[t].prototype[e],i)}},3837:t=>{t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},3103:(t,e,i)=>{var s=i(9859),n=i(7933).f,r=i(5762),o=i(7487),a=i(2079),l=i(7081),h=i(6541);t.exports=function(t,e){var i,c,d,u,p,g=t.target,f=t.global,m=t.stat;if(i=f?s:m?s[g]||a(g,{}):(s[g]||{}).prototype)for(c in e){if(u=e[c],d=t.noTargetGet?(p=n(i,c))&&p.value:i[c],!h(f?c:g+(m?".":"#")+c,t.forced)&&void 0!==d){if(typeof u==typeof d)continue;l(u,d)}(t.sham||d&&d.sham)&&r(u,"sham",!0),o(i,c,u,t)}}},4229:t=>{t.exports=function(t){try{return!!t()}catch(t){return!0}}},7636:(t,e,i)=>{var s=i(7111);t.exports=function(t,e,i){if(s(t),void 0===e)return t;switch(i){case 0:return function(){return t.call(e)};case 1:return function(i){return t.call(e,i)};case 2:return function(i,s){return t.call(e,i,s)};case 3:return function(i,s,n){return t.call(e,i,s,n)}}return function(){return t.apply(e,arguments)}}},1805:(t,e,i)=>{var s=i(7400),n=i(816),r=Function.prototype,o=s&&Object.getOwnPropertyDescriptor,a=n(r,"name"),l=a&&"something"===function(){}.name,h=a&&(!s||s&&o(r,"name").configurable);t.exports={EXISTS:a,PROPER:l,CONFIGURABLE:h}},1333:(t,e,i)=>{var s=i(9859),n=i(6733),r=function(t){return n(t)?t:void 0};t.exports=function(t,e){return arguments.length<2?r(s[t]):s[t]&&s[t][e]}},5300:(t,e,i)=>{var s=i(7111);t.exports=function(t,e){var i=t[e];return null==i?void 0:s(i)}},9859:(t,e,i)=>{var s=function(t){return t&&t.Math==Math&&t};t.exports=s("object"==typeof globalThis&&globalThis)||s("object"==typeof window&&window)||s("object"==typeof self&&self)||s("object"==typeof i.g&&i.g)||function(){return this}()||Function("return this")()},816:(t,e,i)=>{var s=i(2991),n={}.hasOwnProperty;t.exports=Object.hasOwn||function(t,e){return n.call(s(t),e)}},5977:t=>{t.exports={}},4394:(t,e,i)=>{var s=i(7400),n=i(4229),r=i(2635);t.exports=!s&&!n((function(){return 7!=Object.defineProperty(r("div"),"a",{get:function(){return 7}}).a}))},9337:(t,e,i)=>{var s=i(4229),n=i(7079),r="".split;t.exports=s((function(){return!Object("z").propertyIsEnumerable(0)}))?function(t){return"String"==n(t)?r.call(t,""):Object(t)}:Object},8511:(t,e,i)=>{var s=i(6733),n=i(5353),r=Function.toString;s(n.inspectSource)||(n.inspectSource=function(t){return r.call(t)}),t.exports=n.inspectSource},6407:(t,e,i)=>{var s,n,r,o=i(8694),a=i(9859),l=i(5052),h=i(5762),c=i(816),d=i(5353),u=i(4399),p=i(5977),g="Object already initialized",f=a.WeakMap;if(o||d.state){var m=d.state||(d.state=new f),y=m.get,_=m.has,w=m.set;s=function(t,e){if(_.call(m,t))throw new TypeError(g);return e.facade=t,w.call(m,t,e),e},n=function(t){return y.call(m,t)||{}},r=function(t){return _.call(m,t)}}else{var v=u("state");p[v]=!0,s=function(t,e){if(c(t,v))throw new TypeError(g);return e.facade=t,h(t,v,e),e},n=function(t){return c(t,v)?t[v]:{}},r=function(t){return c(t,v)}}t.exports={set:s,get:n,has:r,enforce:function(t){return r(t)?n(t):s(t,{})},getterFor:function(t){return function(e){var i;if(!l(e)||(i=n(e)).type!==t)throw TypeError("Incompatible receiver, "+t+" required");return i}}}},6733:t=>{t.exports=function(t){return"function"==typeof t}},6541:(t,e,i)=>{var s=i(4229),n=i(6733),r=/#|\.prototype\./,o=function(t,e){var i=l[a(t)];return i==c||i!=h&&(n(e)?s(e):!!e)},a=o.normalize=function(t){return String(t).replace(r,".").toLowerCase()},l=o.data={},h=o.NATIVE="N",c=o.POLYFILL="P";t.exports=o},5052:(t,e,i)=>{var s=i(6733);t.exports=function(t){return"object"==typeof t?null!==t:s(t)}},4231:t=>{t.exports=!1},9395:(t,e,i)=>{var s=i(6733),n=i(1333),r=i(6969);t.exports=r?function(t){return"symbol"==typeof t}:function(t){var e=n("Symbol");return s(e)&&Object(t)instanceof e}},3839:(t,e,i)=>{var s=i(6358),n=i(4229);t.exports=!!Object.getOwnPropertySymbols&&!n((function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&s&&s<41}))},8694:(t,e,i)=>{var s=i(9859),n=i(6733),r=i(8511),o=s.WeakMap;t.exports=n(o)&&/native code/.test(r(o))},1787:(t,e,i)=>{var s=i(7400),n=i(4394),r=i(1176),o=i(9310),a=Object.defineProperty;e.f=s?a:function(t,e,i){if(r(t),e=o(e),r(i),n)try{return a(t,e,i)}catch(t){}if("get"in i||"set"in i)throw TypeError("Accessors not supported");return"value"in i&&(t[e]=i.value),t}},7933:(t,e,i)=>{var s=i(7400),n=i(9195),r=i(5358),o=i(905),a=i(9310),l=i(816),h=i(4394),c=Object.getOwnPropertyDescriptor;e.f=s?c:function(t,e){if(t=o(t),e=a(e),h)try{return c(t,e)}catch(t){}if(l(t,e))return r(!n.f.call(t,e),t[e])}},8151:(t,e,i)=>{var s=i(140),n=i(3837).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return s(t,n)}},894:(t,e)=>{e.f=Object.getOwnPropertySymbols},140:(t,e,i)=>{var s=i(816),n=i(905),r=i(9540).indexOf,o=i(5977);t.exports=function(t,e){var i,a=n(t),l=0,h=[];for(i in a)!s(o,i)&&s(a,i)&&h.push(i);for(;e.length>l;)s(a,i=e[l++])&&(~r(h,i)||h.push(i));return h}},5632:(t,e,i)=>{var s=i(140),n=i(3837);t.exports=Object.keys||function(t){return s(t,n)}},9195:(t,e)=>{var i={}.propertyIsEnumerable,s=Object.getOwnPropertyDescriptor,n=s&&!i.call({1:2},1);e.f=n?function(t){var e=s(this,t);return!!e&&e.enumerable}:i},2914:(t,e,i)=>{var s=i(6733),n=i(5052);t.exports=function(t,e){var i,r;if("string"===e&&s(i=t.toString)&&!n(r=i.call(t)))return r;if(s(i=t.valueOf)&&!n(r=i.call(t)))return r;if("string"!==e&&s(i=t.toString)&&!n(r=i.call(t)))return r;throw TypeError("Can't convert object to primitive value")}},4826:(t,e,i)=>{var s=i(1333),n=i(8151),r=i(894),o=i(1176);t.exports=s("Reflect","ownKeys")||function(t){var e=n.f(o(t)),i=r.f;return i?e.concat(i(t)):e}},9276:(t,e,i)=>{var s=i(9859);t.exports=s},7487:(t,e,i)=>{var s=i(9859),n=i(6733),r=i(816),o=i(5762),a=i(2079),l=i(8511),h=i(6407),c=i(1805).CONFIGURABLE,d=h.get,u=h.enforce,p=String(String).split("String");(t.exports=function(t,e,i,l){var h,d=!!l&&!!l.unsafe,g=!!l&&!!l.enumerable,f=!!l&&!!l.noTargetGet,m=l&&void 0!==l.name?l.name:e;n(i)&&("Symbol("===String(m).slice(0,7)&&(m="["+String(m).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),(!r(i,"name")||c&&i.name!==m)&&o(i,"name",m),(h=u(i)).source||(h.source=p.join("string"==typeof m?m:""))),t!==s?(d?!f&&t[e]&&(g=!0):delete t[e],g?t[e]=i:o(t,e,i)):g?t[e]=i:a(e,i)})(Function.prototype,"toString",(function(){return n(this)&&d(this).source||l(this)}))},8885:t=>{t.exports=function(t){if(null==t)throw TypeError("Can't call method on "+t);return t}},2079:(t,e,i)=>{var s=i(9859);t.exports=function(t,e){try{Object.defineProperty(s,t,{value:e,configurable:!0,writable:!0})}catch(i){s[t]=e}return e}},4399:(t,e,i)=>{var s=i(3036),n=i(1441),r=s("keys");t.exports=function(t){return r[t]||(r[t]=n(t))}},5353:(t,e,i)=>{var s=i(9859),n=i(2079),r="__core-js_shared__",o=s[r]||n(r,{});t.exports=o},3036:(t,e,i)=>{var s=i(4231),n=i(5353);(t.exports=function(t,e){return n[t]||(n[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.18.1",mode:s?"pure":"global",copyright:" 2021 Denis Pushkarev (zloirock.ru)"})},3231:(t,e,i)=>{var s=i(6051),n=Math.max,r=Math.min;t.exports=function(t,e){var i=s(t);return i<0?n(i+e,0):r(i,e)}},905:(t,e,i)=>{var s=i(9337),n=i(8885);t.exports=function(t){return s(n(t))}},6051:t=>{var e=Math.ceil,i=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?i:e)(t)}},4237:(t,e,i)=>{var s=i(6051),n=Math.min;t.exports=function(t){return t>0?n(s(t),9007199254740991):0}},2991:(t,e,i)=>{var s=i(8885);t.exports=function(t){return Object(s(t))}},2066:(t,e,i)=>{var s=i(5052),n=i(9395),r=i(5300),o=i(2914),a=i(95)("toPrimitive");t.exports=function(t,e){if(!s(t)||n(t))return t;var i,l=r(t,a);if(l){if(void 0===e&&(e="default"),i=l.call(t,e),!s(i)||n(i))return i;throw TypeError("Can't convert object to primitive value")}return void 0===e&&(e="number"),o(t,e)}},9310:(t,e,i)=>{var s=i(2066),n=i(9395);t.exports=function(t){var e=s(t,"string");return n(e)?e:String(e)}},1601:(t,e,i)=>{var s={};s[i(95)("toStringTag")]="z",t.exports="[object z]"===String(s)},3326:(t,e,i)=>{var s=i(1589);t.exports=function(t){if("Symbol"===s(t))throw TypeError("Cannot convert a Symbol value to a string");return String(t)}},9821:t=>{t.exports=function(t){try{return String(t)}catch(t){return"Object"}}},1441:t=>{var e=0,i=Math.random();t.exports=function(t){return"Symbol("+String(void 0===t?"":t)+")_"+(++e+i).toString(36)}},6969:(t,e,i)=>{var s=i(3839);t.exports=s&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},95:(t,e,i)=>{var s=i(9859),n=i(3036),r=i(816),o=i(1441),a=i(3839),l=i(6969),h=n("wks"),c=s.Symbol,d=l?c:c&&c.withoutSetter||o;t.exports=function(t){return r(h,t)&&(a||"string"==typeof h[t])||(a&&r(c,t)?h[t]=c[t]:h[t]=d("Symbol."+t)),h[t]}},3430:(t,e,i)=>{var s=i(3103),n=i(7111),r=i(2991),o=i(4237),a=i(3326),l=i(4229),h=i(3867),c=i(6038),d=i(2671),u=i(8506),p=i(6358),g=i(9811),f=[],m=f.sort,y=l((function(){f.sort(void 0)})),_=l((function(){f.sort(null)})),w=c("sort"),v=!l((function(){if(p)return p<70;if(!(d&&d>3)){if(u)return!0;if(g)return g<603;var t,e,i,s,n="";for(t=65;t<76;t++){switch(e=String.fromCharCode(t),t){case 66:case 69:case 70:case 72:i=3;break;case 68:case 71:i=4;break;default:i=2}for(s=0;s<47;s++)f.push({k:e+s,v:i})}for(f.sort((function(t,e){return e.v-t.v})),s=0;s<f.length;s++)e=f[s].k.charAt(0),n.charAt(n.length-1)!==e&&(n+=e);return"DGBEFHACIJK"!==n}}));s({target:"Array",proto:!0,forced:y||!_||!w||!v},{sort:function(t){void 0!==t&&n(t);var e=r(this);if(v)return void 0===t?m.call(e):m.call(e,t);var i,s,l=[],c=o(e.length);for(s=0;s<c;s++)s in e&&l.push(e[s]);for(l=h(l,function(t){return function(e,i){return void 0===i?-1:void 0===e?1:void 0!==t?+t(e,i)||0:a(e)>a(i)?1:-1}}(t)),i=l.length,s=0;s<i;)e[s]=l[s++];for(;s<c;)delete e[s++];return e}})},4769:(t,e,i)=>{var s=i(3103),n=i(2991),r=i(5632);s({target:"Object",stat:!0,forced:i(4229)((function(){r(1)}))},{keys:function(t){return r(n(t))}})},1388:(t,e,i)=>{i.d(e,{Z:()=>a});var s=i(272),n=i.n(s),r=i(2609),o=i.n(r)()(n());o.push([t.id,"/* Buttons styles start */\r\n\r\nbutton#excalibur-play {\r\n  display: inline-block;\r\n  position: relative;\r\n  z-index: 999;\r\n  border-radius: 6px;\r\n  border: none;\r\n  /*border: 3px solid;\r\n    border-color: white;\r\n    box-shadow: 0 0 10px #ccc;*/\r\n  padding: 1rem 1.5rem 1rem 4rem;\r\n  margin: 0;\r\n  text-decoration: none;\r\n  background: #00b233;\r\n  color: #ffffff;\r\n  font-family: sans-serif;\r\n  font-size: 2rem;\r\n  white-space: nowrap;\r\n  line-height: 1;\r\n  cursor: pointer;\r\n  text-align: center;\r\n  transition: background 250ms ease-in-out, transform 150ms ease;\r\n  -webkit-appearance: none;\r\n  -moz-appearance: none;\r\n\r\n  -webkit-animation: excalibur-button-fadein 200ms; /* Safari, Chrome and Opera > 12.1 */\r\n  -moz-animation: excalibur-button-fadein 200ms; /* Firefox < 16 */\r\n  -ms-animation: excalibur-button-fadein 200ms; /* Internet Explorer */\r\n  -o-animation: excalibur-button-fadein 200ms; /* Opera < 12.1 */\r\n  animation: excalibur-button-fadein 200ms;\r\n}\r\n\r\n/*\r\nbutton#excalibur-play {\r\n  display: none;\r\n}*/\r\n\r\nbutton#excalibur-play:after {\r\n  position: absolute;\r\n  content: '';\r\n  border: 8px solid;\r\n  border-color: transparent transparent transparent white;\r\n  left: 35px;\r\n  top: 24px;\r\n  width: 0;\r\n  height: 0;\r\n}\r\n\r\nbutton#excalibur-play:before {\r\n  position: absolute;\r\n  content: '';\r\n  border: 3px solid;\r\n  left: 19px;\r\n  top: 14px;\r\n  border-radius: 20px;\r\n  width: 30px;\r\n  height: 30px;\r\n}\r\n\r\nbutton#excalibur-play:hover,\r\nbutton#excalibur-play:focus {\r\n  background: #00982c;\r\n}\r\n\r\nbutton#excalibur-play:focus {\r\n  outline: 1px solid #fff;\r\n  outline-offset: -4px;\r\n}\r\n\r\nbutton#excalibur-play:active {\r\n  transform: scale(0.99);\r\n}\r\n\r\n@keyframes excalibur-button-fadein {\r\n  from {\r\n    opacity: 0;\r\n  }\r\n  to {\r\n    opacity: 1;\r\n  }\r\n}\r\n\r\n/* Firefox < 16 */\r\n@-moz-keyframes excalibur-button-fadein {\r\n  from {\r\n    opacity: 0;\r\n  }\r\n  to {\r\n    opacity: 1;\r\n  }\r\n}\r\n\r\n/* Safari, Chrome and Opera > 12.1 */\r\n@-webkit-keyframes excalibur-button-fadein {\r\n  from {\r\n    opacity: 0;\r\n  }\r\n  to {\r\n    opacity: 1;\r\n  }\r\n}\r\n\r\n/* Internet Explorer */\r\n@-ms-keyframes excalibur-button-fadein {\r\n  from {\r\n    opacity: 0;\r\n  }\r\n  to {\r\n    opacity: 1;\r\n  }\r\n}\r\n\r\n/* Opera < 12.1 */\r\n@-o-keyframes excalibur-button-fadein {\r\n  from {\r\n    opacity: 0;\r\n  }\r\n  to {\r\n    opacity: 1;\r\n  }\r\n}\r\n","",{version:3,sources:["webpack://./Loader.css"],names:[],mappings:"AAAA,yBAAyB;;AAEzB;EACE,qBAAqB;EACrB,kBAAkB;EAClB,YAAY;EACZ,kBAAkB;EAClB,YAAY;EACZ;;+BAE6B;EAC7B,8BAA8B;EAC9B,SAAS;EACT,qBAAqB;EACrB,mBAAmB;EACnB,cAAc;EACd,uBAAuB;EACvB,eAAe;EACf,mBAAmB;EACnB,cAAc;EACd,eAAe;EACf,kBAAkB;EAClB,8DAA8D;EAC9D,wBAAwB;EACxB,qBAAqB;;EAErB,gDAAgD,EAAE,oCAAoC;EACtF,6CAA6C,EAAE,iBAAiB;EAChE,4CAA4C,EAAE,sBAAsB;EACpE,2CAA2C,EAAE,iBAAiB;EAC9D,wCAAwC;AAC1C;;AAEA;;;EAGE;;AAEF;EACE,kBAAkB;EAClB,WAAW;EACX,iBAAiB;EACjB,uDAAuD;EACvD,UAAU;EACV,SAAS;EACT,QAAQ;EACR,SAAS;AACX;;AAEA;EACE,kBAAkB;EAClB,WAAW;EACX,iBAAiB;EACjB,UAAU;EACV,SAAS;EACT,mBAAmB;EACnB,WAAW;EACX,YAAY;AACd;;AAEA;;EAEE,mBAAmB;AACrB;;AAEA;EACE,uBAAuB;EACvB,oBAAoB;AACtB;;AAEA;EACE,sBAAsB;AACxB;;AAEA;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF;;AAEA,iBAAiB;AACjB;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF;;AAEA,oCAAoC;AACpC;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF;;AAEA,sBAAsB;AACtB;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF;;AAEA,iBAAiB;AACjB;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF",sourcesContent:["/* Buttons styles start */\r\n\r\nbutton#excalibur-play {\r\n  display: inline-block;\r\n  position: relative;\r\n  z-index: 999;\r\n  border-radius: 6px;\r\n  border: none;\r\n  /*border: 3px solid;\r\n    border-color: white;\r\n    box-shadow: 0 0 10px #ccc;*/\r\n  padding: 1rem 1.5rem 1rem 4rem;\r\n  margin: 0;\r\n  text-decoration: none;\r\n  background: #00b233;\r\n  color: #ffffff;\r\n  font-family: sans-serif;\r\n  font-size: 2rem;\r\n  white-space: nowrap;\r\n  line-height: 1;\r\n  cursor: pointer;\r\n  text-align: center;\r\n  transition: background 250ms ease-in-out, transform 150ms ease;\r\n  -webkit-appearance: none;\r\n  -moz-appearance: none;\r\n\r\n  -webkit-animation: excalibur-button-fadein 200ms; /* Safari, Chrome and Opera > 12.1 */\r\n  -moz-animation: excalibur-button-fadein 200ms; /* Firefox < 16 */\r\n  -ms-animation: excalibur-button-fadein 200ms; /* Internet Explorer */\r\n  -o-animation: excalibur-button-fadein 200ms; /* Opera < 12.1 */\r\n  animation: excalibur-button-fadein 200ms;\r\n}\r\n\r\n/*\r\nbutton#excalibur-play {\r\n  display: none;\r\n}*/\r\n\r\nbutton#excalibur-play:after {\r\n  position: absolute;\r\n  content: '';\r\n  border: 8px solid;\r\n  border-color: transparent transparent transparent white;\r\n  left: 35px;\r\n  top: 24px;\r\n  width: 0;\r\n  height: 0;\r\n}\r\n\r\nbutton#excalibur-play:before {\r\n  position: absolute;\r\n  content: '';\r\n  border: 3px solid;\r\n  left: 19px;\r\n  top: 14px;\r\n  border-radius: 20px;\r\n  width: 30px;\r\n  height: 30px;\r\n}\r\n\r\nbutton#excalibur-play:hover,\r\nbutton#excalibur-play:focus {\r\n  background: #00982c;\r\n}\r\n\r\nbutton#excalibur-play:focus {\r\n  outline: 1px solid #fff;\r\n  outline-offset: -4px;\r\n}\r\n\r\nbutton#excalibur-play:active {\r\n  transform: scale(0.99);\r\n}\r\n\r\n@keyframes excalibur-button-fadein {\r\n  from {\r\n    opacity: 0;\r\n  }\r\n  to {\r\n    opacity: 1;\r\n  }\r\n}\r\n\r\n/* Firefox < 16 */\r\n@-moz-keyframes excalibur-button-fadein {\r\n  from {\r\n    opacity: 0;\r\n  }\r\n  to {\r\n    opacity: 1;\r\n  }\r\n}\r\n\r\n/* Safari, Chrome and Opera > 12.1 */\r\n@-webkit-keyframes excalibur-button-fadein {\r\n  from {\r\n    opacity: 0;\r\n  }\r\n  to {\r\n    opacity: 1;\r\n  }\r\n}\r\n\r\n/* Internet Explorer */\r\n@-ms-keyframes excalibur-button-fadein {\r\n  from {\r\n    opacity: 0;\r\n  }\r\n  to {\r\n    opacity: 1;\r\n  }\r\n}\r\n\r\n/* Opera < 12.1 */\r\n@-o-keyframes excalibur-button-fadein {\r\n  from {\r\n    opacity: 0;\r\n  }\r\n  to {\r\n    opacity: 1;\r\n  }\r\n}\r\n"],sourceRoot:""}]);const a=o},2609:t=>{t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var i="",s=void 0!==e[5];return e[4]&&(i+="@supports (".concat(e[4],") {")),e[2]&&(i+="@media ".concat(e[2]," {")),s&&(i+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),i+=t(e),s&&(i+="}"),e[2]&&(i+="}"),e[4]&&(i+="}"),i})).join("")},e.i=function(t,i,s,n,r){"string"==typeof t&&(t=[[null,t,void 0]]);var o={};if(s)for(var a=0;a<this.length;a++){var l=this[a][0];null!=l&&(o[l]=!0)}for(var h=0;h<t.length;h++){var c=[].concat(t[h]);s&&o[c[0]]||(void 0!==r&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=r),i&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=i):c[2]=i),n&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=n):c[4]="".concat(n)),e.push(c))}},e}},272:t=>{t.exports=function(t){var e=t[1],i=t[3];if(!i)return e;if("function"==typeof btoa){var s=btoa(unescape(encodeURIComponent(JSON.stringify(i)))),n="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(s),r="/*# ".concat(n," */"),o=i.sources.map((function(t){return"/*# sourceURL=".concat(i.sourceRoot||"").concat(t," */")}));return[e].concat(o).concat([r]).join("\n")}return[e].join("\n")}}},h={};function c(t){var e=h[t];if(void 0!==e)return e.exports;var i=h[t]={id:t,exports:{}};return l[t](i,i.exports,c),i.exports}c.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return c.d(e,{a:e}),e},c.d=(t,e)=>{for(var i in e)c.o(e,i)&&!c.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},c.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),c.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),c.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var d={};(()=>{c.d(d,{fWn:()=>Ns,Ia8:()=>xs,hLI:()=>Os,yyv:()=>Wn,tX5:()=>le,vtX:()=>Hs,r7K:()=>os,lCh:()=>dn,fwF:()=>Bn,sce:()=>kn,_c7:()=>Rn,KUs:()=>Cn,Ajp:()=>ni,RDh:()=>Vs,_H9:()=>He,Ulf:()=>vo,mxs:()=>Ds,OmD:()=>is,kBf:()=>it,C4F:()=>xi,NQt:()=>Lr,JjN:()=>Br,V1s:()=>nn,Xz7:()=>kt,bLd:()=>Qs,Cdc:()=>ys,FKn:()=>Xi,wTW:()=>oi,ab2:()=>Vi,GfZ:()=>qi,YMS:()=>Hi,oyv:()=>Ji,aUb:()=>Gi,SdD:()=>oe,JUv:()=>Li,jEj:()=>Yr,TFq:()=>Yi,HDU:()=>ne,R_y:()=>se,ydN:()=>wi,_N2:()=>Sn,t50:()=>re,s$$:()=>An,v2G:()=>yi,Ilk:()=>tt,H_9:()=>rr,s9i:()=>or,ksl:()=>jn,wA2:()=>Ai,R_p:()=>Wi,IQ$:()=>ke,I5F:()=>_,X8$:()=>En,FR6:()=>ie,U8o:()=>ee,kbG:()=>Ti,oeJ:()=>ss,iS_:()=>he,cGG:()=>ar,skb:()=>Hn,SLU:()=>Ze,RdJ:()=>ts,gU7:()=>mi,LSk:()=>Is,Nmp:()=>qe,d1Y:()=>ti,xrL:()=>Ni,sRW:()=>Ui,cmV:()=>Po,N0Q:()=>Ms,q8b:()=>vs,ynB:()=>Qi,jT9:()=>tn,wAz:()=>Dn,D4V:()=>Ur,N6H:()=>ue,W1A:()=>de,JHW:()=>cs,v2K:()=>fn,pBf:()=>ge,GMl:()=>Tt,zW2:()=>t,B0K:()=>Zr,Nv7:()=>Fr,C_p:()=>Je,MUA:()=>pe,xqU:()=>ce,peG:()=>a,pTp:()=>Ls,vUK:()=>f,j9l:()=>Fs,Zxw:()=>qr,Hdx:()=>je,Z$d:()=>ze,o$7:()=>lr,Zm$:()=>Mt,$QH:()=>It,i78:()=>Ft,h6u:()=>Kt,hts:()=>Gt,j88:()=>qt,VME:()=>Xt,nt:()=>uo,Ukr:()=>Cr,zsu:()=>Ct,oA6:()=>fs,TVh:()=>In,TwZ:()=>ps,GTT:()=>gs,xxj:()=>On,XdK:()=>$t,cXo:()=>Be,Dm5:()=>ae,IIB:()=>n,zI0:()=>Si,SKZ:()=>Dt,__J:()=>Kr,Dvr:()=>l,Tf9:()=>s,RI$:()=>sn,x12:()=>ji,aNw:()=>gi,xwn:()=>Js,dNK:()=>$s,ini:()=>u,YdH:()=>y,y3G:()=>nt,l57:()=>Z,xn0:()=>Wr,t2V:()=>zs,ZyS:()=>xo,uxB:()=>Di,cpd:()=>bn,fiy:()=>Cs,$XZ:()=>Es,uqK:()=>jr,STE:()=>Vr,y$z:()=>Bi,sOq:()=>Ii,Sqs:()=>mo,hpZ:()=>zn,Vol:()=>Nn,wIZ:()=>Ei,cBi:()=>hr,mgq:()=>yo,YVA:()=>Zi,Kgp:()=>ct,HH$:()=>te,M_d:()=>Ut,rgh:()=>Nt,Ra6:()=>Vt,KhR:()=>Bt,BS5:()=>Wt,xhz:()=>Jt,xOq:()=>Ot,a9j:()=>zt,bHk:()=>jt,CgK:()=>Lt,cuY:()=>Ht,kvE:()=>Fi,JDb:()=>Eo,Cbi:()=>So,AE_:()=>yn,ctO:()=>_n,OLH:()=>en,kky:()=>x,nSF:()=>At,zHn:()=>Oi,zwx:()=>Pn,AeJ:()=>ms,hLz:()=>ls,D9g:()=>pn,wA:()=>bs,jhr:()=>Ss,GVs:()=>ii,_zO:()=>fe,w6$:()=>As,mhV:()=>Ps,MOD:()=>_s,kwd:()=>Ts,Lmr:()=>ks,xsS:()=>nr,lLr:()=>si,Z$r:()=>w,IXb:()=>Ws,SMj:()=>zr,bnF:()=>$i,MFA:()=>b,$XC:()=>wo,$uU:()=>ho,jyi:()=>De,E03:()=>Qe,V6q:()=>Ye,nVo:()=>Zs,F6N:()=>fo,ad3:()=>Yt,xP7:()=>cn,Odq:()=>wn,Zif:()=>ln,ZGJ:()=>ki,xvT:()=>Xr,PHM:()=>Oe,KwO:()=>Ks,B7y:()=>js,SFp:()=>r,Uvn:()=>Mi,OFT:()=>zi,xzN:()=>an,H6j:()=>Qt,ZrN:()=>o,OWs:()=>Y,dF9:()=>Pi,VHo:()=>Zt,R$E:()=>oo,q3I:()=>vn,Pab:()=>M,uZ5:()=>k,McK:()=>m,k0b:()=>us,hnT:()=>Jr,RSJ:()=>so,Mku:()=>eo,h90:()=>ro,rms:()=>no,ErP:()=>$r,aVg:()=>io,lPc:()=>to,Z8E:()=>as,NNA:()=>un,yFn:()=>gn,lNv:()=>hs,MZQ:()=>V,FUM:()=>K,vdf:()=>T,iaL:()=>R,w6H:()=>W,Q4c:()=>X,Uxb:()=>D,Yr5:()=>L,Bhw:()=>Q});var t={};c.r(t),c.d(t,{ActivateEvent:()=>le,CollisionEndEvent:()=>oe,CollisionPostSolveEvent:()=>ne,CollisionPreSolveEvent:()=>se,CollisionStartEvent:()=>re,ContactEndEvent:()=>ie,ContactStartEvent:()=>ee,DeactivateEvent:()=>he,EnterTriggerEvent:()=>ue,EnterViewPortEvent:()=>de,EventTypes:()=>Tt,ExitTriggerEvent:()=>pe,ExitViewPortEvent:()=>ce,GameEvent:()=>Mt,GameStartEvent:()=>It,GameStopEvent:()=>Ft,GamepadAxisEvent:()=>Kt,GamepadButtonEvent:()=>Gt,GamepadConnectEvent:()=>qt,GamepadDisconnectEvent:()=>Xt,HiddenEvent:()=>$t,InitializeEvent:()=>ae,KillEvent:()=>Dt,PostCollisionEvent:()=>te,PostDebugDrawEvent:()=>Ut,PostDrawEvent:()=>Nt,PostFrameEvent:()=>Vt,PostKillEvent:()=>Bt,PostUpdateEvent:()=>Wt,PreCollisionEvent:()=>Jt,PreDebugDrawEvent:()=>Ot,PreDrawEvent:()=>zt,PreFrameEvent:()=>jt,PreKillEvent:()=>Lt,PreUpdateEvent:()=>Ht,SubscribeEvent:()=>Yt,UnsubscribeEvent:()=>Qt,VisibleEvent:()=>Zt});var e={};c.r(e),c.d(e,{Colorize:()=>ve,Darken:()=>be,Desaturate:()=>Ce,Fill:()=>Ee,Grayscale:()=>ye,Invert:()=>_e,Lighten:()=>xe,Opacity:()=>we,Saturate:()=>Se});var i={};c.r(i),c.d(i,{circle:()=>di,line:()=>ai,point:()=>li,roundRect:()=>ci,vector:()=>hi});var s={};c.r(s),c.d(s,{Animation:()=>Fe,CanvasDrawComponent:()=>ds,CanvasDrawingSystem:()=>Un,Effects:()=>e,Polygon:()=>Qr,Sprite:()=>Me,SpriteFont:()=>Ke,SpriteSheet:()=>Ge,Texture:()=>Ae});var n={};c.r(n),c.d(n,{Axes:()=>Mr,Buttons:()=>Tr,Gamepad:()=>kr,Gamepads:()=>Ar,KeyEvent:()=>cr,Keyboard:()=>dr,Keys:()=>qn,NativePointerButton:()=>Zn,Pointer:()=>ur,PointerButton:()=>Jn,PointerCancelEvent:()=>xr,PointerDownEvent:()=>yr,PointerDragEvent:()=>fr,PointerEnterEvent:()=>wr,PointerEvent:()=>pr,PointerEventFactory:()=>gr,PointerLeaveEvent:()=>vr,PointerMoveEvent:()=>_r,PointerScope:()=>Yn,PointerType:()=>Gn,PointerUpEvent:()=>mr,Pointers:()=>Pr,WheelDeltaMode:()=>er,WheelEvent:()=>br,createPointerEventByName:()=>Sr});var r={};c.r(r),c.d(r,{CapturePointer:()=>rs,OffscreenCulling:()=>ns});var o={};c.r(o),c.d(o,{Collection:()=>U,ConsoleAppender:()=>_,DrawUtil:()=>i,EasingFunctions:()=>vs,LogLevel:()=>u,Logger:()=>y,Observable:()=>Bi,ScreenAppender:()=>w,TwoPI:()=>C,addItemToArray:()=>I,base64Encode:()=>P,canonicalizeAngle:()=>M,clamp:()=>k,contains:()=>z,delay:()=>j,extend:()=>E,fail:()=>H,getOppositeSide:()=>N,getPosition:()=>B,getSideFromDirection:()=>O,nullish:()=>A,randomInRange:()=>T,randomIntInRange:()=>R,range:()=>W,removeItemFromArray:()=>F,toDegrees:()=>D,toRadians:()=>L});var a,l,h,u,p;c(4662),c(8343);function g(){if("undefined"==typeof window&&(window={audioContext:function(){}}),"undefined"==typeof window||window.requestAnimationFrame||(window.requestAnimationFrame=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setInterval(t,1e3/60)}),"undefined"==typeof window||window.cancelAnimationFrame||(window.cancelAnimationFrame=window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||function(){}),"undefined"!=typeof window&&!window.AudioContext){if(window.webkitAudioContext){const t=window.webkitAudioContext.prototype.decodeAudioData;window.webkitAudioContext.prototype.decodeAudioData=function(e){return new Promise(((i,s)=>{t.call(this,e,i,s)}))}}window.AudioContext=window.AudioContext||window.webkitAudioContext||window.mozAudioContext||window.msAudioContext||window.oAudioContext}"undefined"==typeof window||window.devicePixelRatio||(window.devicePixelRatio=window.devicePixelRatio||1)}(a||(a={})).WebGL="use-webgl",(h=l||(l={})).Canvas="use-canvas-context",h.LegacyDrawing="use-legacy-drawing";class f{static freeze(){f._FROZEN=!0}static _reset(){f._FROZEN=!1,f._FLAGS={}}static useWebGL(){f.enable(a.WebGL)}static useCanvasGraphicsContext(){f.enable(l.Canvas)}static useLegacyDrawing(){f.enable(l.LegacyDrawing)}static enable(t){if(this._FROZEN)throw Error("Feature flags can only be enabled before Engine constructor time");f._FLAGS[t]=!0}static disable(t){if(this._FROZEN)throw Error("Feature flags can only be disabled before Engine constructor time");f._FLAGS[t]=!1}static isEnabled(t){return!!f._FLAGS[t]}static show(){return Object.keys(f._FLAGS)}}function m(t,e){return{type:t,value:e}}f._FROZEN=!1,f._FLAGS={},(p=u||(u={}))[p.Debug=0]="Debug",p[p.Info=1]="Info",p[p.Warn=2]="Warn",p[p.Error=3]="Error",p[p.Fatal=4]="Fatal";class y{constructor(){if(this._appenders=[],this.defaultLevel=u.Info,y._INSTANCE)throw new Error("Logger is a singleton");return y._INSTANCE=this,y._INSTANCE.addAppender(new _),y._INSTANCE}static getInstance(){return null==y._INSTANCE&&(y._INSTANCE=new y),y._INSTANCE}addAppender(t){this._appenders.push(t)}clearAppenders(){this._appenders.length=0}_log(t,e){null==t&&(t=this.defaultLevel);const i=this._appenders.length;for(let s=0;s<i;s++)t>=this.defaultLevel&&this._appenders[s].log(t,e)}debug(...t){this._log(u.Debug,t)}info(...t){this._log(u.Info,t)}warn(...t){this._log(u.Warn,t)}error(...t){this._log(u.Error,t)}fatal(...t){this._log(u.Fatal,t)}}y._INSTANCE=null;class _{log(t,e){if(!console&&!console.log&&console.warn&&console.error)return;const i=[];i.unshift.apply(i,e),i.unshift("["+u[t]+"] : "),t<u.Warn?console.log.apply?console.log.apply(console,i):console.log(i.join(" ")):t<u.Error?console.warn.apply?console.warn.apply(console,i):console.warn(i.join(" ")):console.error.apply?console.error.apply(console,i):console.error(i.join(" "))}}class w{constructor(t,e){this._messages=[],this._canvas=document.createElement("canvas"),this._canvas.width=t||window.innerWidth,this._canvas.height=e||window.innerHeight,this._canvas.style.position="absolute",this._ctx=this._canvas.getContext("2d"),document.body.appendChild(this._canvas)}log(t,e){const i=e.join(",");this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._messages.unshift("["+u[t]+"] : "+i);let s=10,n=1;for(let t=0;t<this._messages.length;t++)this._ctx.fillStyle="rgba(255,255,255,"+n.toFixed(2)+")",this._ctx.fillText(this._messages[t],200,s),s+=10,n=n>0?n-.05:0}}const v=4294967295;class x{constructor(t){this.seed=t,this._lowerMask=2147483647,this._upperMask=2147483648,this._w=32,this._n=624,this._m=397,this._a=2567483615,this._u=11,this._s=7,this._b=2636928640,this._t=15,this._c=4022730752,this._l=18,this._f=1812433253,this._mt=new Array(this._n),this._mt[0]=(t||Date.now())>>>0;for(let t=1;t<this._n;t++){const e=this._mt[t-1]^this._mt[t-1]>>>this._w-2;this._mt[t]=(this._f*((4294901760&e)>>>16)<<16)+this._f*(65535&e)+t>>>0}this._index=this._n}_twist(){const t=[0,this._a];let e=0,i=0;for(;i<this._n-this._m;i++)e=this._mt[i]&this._upperMask|this._mt[i+1]&this._lowerMask,this._mt[i]=this._mt[i+this._m]^e>>>1^t[1&e]&v;for(;i<this._n-1;i++)e=this._mt[i]&this._upperMask|this._mt[i+1]&this._lowerMask,this._mt[i]=this._mt[i+(this._m-this._n)]^e>>>1^t[1&e]&v;e=this._mt[this._n-1]&this._upperMask|this._mt[0]&this._lowerMask,this._mt[this._n-1]=this._mt[this._m-1]^e>>>1^t[1&e]&v,this._index=0}nextInt(){this._index>=this._n&&this._twist();let t=this._mt[this._index++];return t^=t>>>this._u,t^=t<<this._s&this._b,t^=t<<this._t&this._c,t^=t>>>this._l,t>>>0}next(){return this.nextInt()*(1/4294967296)}floating(t,e){return(e-t)*this.next()+t}integer(t,e){return Math.floor((e-t+1)*this.next()+t)}bool(t=.5){return this.next()<=t}pickOne(t){return t[this.integer(0,t.length-1)]}pickSet(t,e,i=!1){return i?this._pickSetWithDuplicates(t,e):this._pickSetWithoutDuplicates(t,e)}_pickSetWithoutDuplicates(t,e){if(e>t.length||e<0)throw new Error("Invalid number of elements to pick, must pick a value 0 < n <= length");if(e===t.length)return t;const i=new Array(e);let s=0;const n=t.slice(0);for(;s<e;){const t=this.integer(0,n.length-1);i[s++]=n[t],n.splice(t,1)}return i}_pickSetWithDuplicates(t,e){if(e<0)throw new Error("Invalid number of elements to pick, must pick a value 0 <= n < MAX_INT");const i=new Array(e);for(let s=0;s<e;s++)i[s]=this.pickOne(t);return i}shuffle(t){const e=t.slice(0);let i=null;for(let t=0;t<e.length-2;t++){const s=this.integer(t,e.length-1);i=e[t],e[t]=e[s],e[s]=i}return e}range(t,e,i){const s=new Array(t);for(let n=0;n<t;n++)s[n]=this.integer(e,i);return s}d4(){return this.integer(1,4)}d6(){return this.integer(1,6)}d8(){return this.integer(1,8)}d10(){return this.integer(1,10)}d12(){return this.integer(1,12)}d20(){return this.integer(1,20)}}var b,S;(S=b||(b={})).None="None",S.Top="Top",S.Bottom="Bottom",S.Left="Left",S.Right="Right",function(t){t.getOpposite=function(e){return e===t.Top?t.Bottom:e===t.Bottom?t.Top:e===t.Left?t.Right:e===t.Right?t.Left:t.None},t.fromDirection=function(e){const i=[Y.Left,Y.Right,Y.Up,Y.Down],s=[t.Left,t.Right,t.Top,t.Bottom];let n=-Number.MAX_VALUE,r=-1;for(let t=0;t<i.length;t++)i[t].dot(e)>n&&(n=i[t].dot(e),r=t);return s[r]}}(b||(b={}));const C=2*Math.PI;function E(){const t={};let e=!1,i=0;const s=arguments.length;"[object Boolean]"===Object.prototype.toString.call(arguments[0])&&(e=arguments[0],i++);const n="function"==typeof Object.assign;let r=null;for(r=n?Object.assign:function(i){for(const s in i)Object.prototype.hasOwnProperty.call(i,s)&&(e&&"[object Object]"===Object.prototype.toString.call(i[s])?t[s]=E(!0,t[s],i[s]):t[s]=i[s])};i<s;i++){const e=arguments[i];n?r(t,e):r(e)}return t}function P(t){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let i="",s=0;for(;s<t.length;){const n=255&t.charCodeAt(s++),r=255&t.charCodeAt(s++),o=255&t.charCodeAt(s++),a=n>>2,l=(3&n)<<4|r>>4;let h,c;isNaN(r)?h=c=64:(h=(15&r)<<2|o>>6,c=isNaN(o)?64:63&o),i+=e.charAt(a)+e.charAt(l)+e.charAt(h)+e.charAt(c)}return i}function A(t,e){return null!=t?t:e}function k(t,e,i){return Math.min(Math.max(e,t),i)}function T(t,e,i=new x){return i?i.floating(t,e):t+Math.random()*(e-t)}function R(t,e,i=new x){return i?i.integer(t,e):Math.round(T(t,e))}function M(t){let e=t;if(t>C)for(;e>C;)e-=C;if(t<0)for(;e<0;)e+=C;return e}function D(t){return 180/Math.PI*t}function L(t){return t/180*Math.PI}function B(t){let e=0,i=0;const s=t=>{e+=t.offsetLeft,t.offsetParent&&s(t.offsetParent)},n=t=>{i+=t.offsetTop,t.offsetParent&&n(t.offsetParent)};return s(t),n(t),new Y(e,i)}function I(t,e){return-1===e.indexOf(t)&&(e.push(t),!0)}function F(t,e){let i=-1;return(i=e.indexOf(t))>-1&&(e.splice(i,1),!0)}function z(t,e){for(let i=0;i<t.length;i++)if(t[i]===e)return!0;return!1}function N(t){return t===b.Top?b.Bottom:t===b.Bottom?b.Top:t===b.Left?b.Right:t===b.Right?b.Left:b.None}function O(t){const e=[Y.Left,Y.Right,Y.Up,Y.Down],i=[b.Left,b.Right,b.Top,b.Bottom];let s=-Number.MAX_VALUE,n=-1;for(let i=0;i<e.length;i++)e[i].dot(t)>s&&(s=e[i].dot(t),n=i);return i[n]}class U{constructor(t=U.DefaultSize){this._internalArray=null,this._endPointer=0,this._internalArray=new Array(t)}_resize(){const t=2*this._internalArray.length,e=new Array(t),i=this.count();for(let t=0;t<i;t++)e[t]=this._internalArray[t];delete this._internalArray,this._internalArray=e}push(t){return this._endPointer===this._internalArray.length&&this._resize(),this._internalArray[this._endPointer++]=t}pop(){return this._endPointer=this._endPointer-1<0?0:this._endPointer-1,this._internalArray[this._endPointer]}count(){return this._endPointer}clear(){this._endPointer=0}internalSize(){return this._internalArray.length}elementAt(t){if(t>=this.count())throw new Error("Invalid index "+t);return this._internalArray[t]}insert(t,e){return t>=this.count()&&this._resize(),this._internalArray[t]=e}remove(t){const e=this.count();if(0===e)throw new Error("Invalid parameter "+t);const i=this._internalArray[t];for(let i=t;i<e;i++)this._internalArray[i]=this._internalArray[i+1];return this._endPointer--,i}removeElement(t){const e=this._internalArray.indexOf(t);this.remove(e)}toArray(){return this._internalArray.slice(0,this._endPointer)}forEach(t){let e=0;const i=this.count();for(;e<i;e++)t.call(this,this._internalArray[e],e)}map(t){const e=this.count();for(let i=0;i<e;i++)this._internalArray[i]=t.call(this,this._internalArray[i],i)}}function H(t){throw new Error(t)}U.DefaultSize=200;const W=(t,e)=>Array.from(new Array(e-t+1),((e,i)=>i+t));function j(t){return new Promise((e=>{setTimeout((()=>{e()}),t)}))}const V=5,q={},X=()=>{for(const t in q)q[t]=0},G=(t,e)=>{const i=f.isEnabled("suppress-obsolete-message");q[t]<V&&!i&&(y.getInstance().warn(t),console.trace&&e.showStackTrace&&console.trace()),q[t]++};function K(t){return t=E({},{message:"This feature will be removed in future versions of Excalibur.",alternateMethod:null,showStackTrack:!1},t),function(e,i,s){if(s&&"function"!=typeof s.value&&"function"!=typeof s.get&&"function"!=typeof s.set)throw new SyntaxError("Only classes/functions/getters/setters can be marked as obsolete");const n=`${`${e.name||""}${e.name&&i?".":""}${i||""}`} is marked obsolete: ${t.message}`+(t.alternateMethod?` Use ${t.alternateMethod} instead`:"");q[n]||(q[n]=0);const r=s?Object.assign({},s):e;if(!s){class e extends r{constructor(...e){G(n,t),super(...e)}}return e}return s&&s.value?(r.value=function(){return G(n,t),s.value.apply(this,arguments)},r):(s&&s.get&&(r.get=function(){return G(n,t),s.get.apply(this,arguments)}),s&&s.set&&(r.set=function(){return G(n,t),s.set.apply(this,arguments)}),r)}}class Y{constructor(t,e){this._x=0,this._y=0,this._x=t,this._y=e}static get Zero(){return new Y(0,0)}static get One(){return new Y(1,1)}static get Half(){return new Y(.5,.5)}static get Up(){return new Y(0,-1)}static get Down(){return new Y(0,1)}static get Left(){return new Y(-1,0)}static get Right(){return new Y(1,0)}static fromAngle(t){return new Y(Math.cos(t),Math.sin(t))}static isValid(t){return null!=t&&(!isNaN(t.x)&&!isNaN(t.y)&&(t.x!==1/0&&t.y!==1/0&&t.x!==-1/0&&t.y!==-1/0))}static distance(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}get x(){return this._x}set x(t){this._x=t}get y(){return this._y}set y(t){this._y=t}setTo(t,e){this.x=t,this.y=e}equals(t,e=.001){return Math.abs(this.x-t.x)<=e&&Math.abs(this.y-t.y)<=e}distance(t){return t||(t=Y.Zero),Math.sqrt(Math.pow(this.x-t.x,2)+Math.pow(this.y-t.y,2))}squareDistance(t){return t||(t=Y.Zero),Math.pow(this.x-t.x,2)+Math.pow(this.y-t.y,2)}magnitude(){return this.distance()}get size(){return this.distance()}set size(t){const e=this.normalize().scale(t);this.setTo(e.x,e.y)}normalize(){const t=this.distance();return t>0?new Y(this.x/t,this.y/t):new Y(0,1)}average(t){return this.add(t).scale(.5)}scale(t){return t instanceof Y?new Y(this.x*t.x,this.y*t.y):new Y(this.x*t,this.y*t)}add(t){return new Y(this.x+t.x,this.y+t.y)}sub(t){return new Y(this.x-t.x,this.y-t.y)}addEqual(t){return this.setTo(this.x+t.x,this.y+t.y),this}subEqual(t){return this.setTo(this.x-t.x,this.y-t.y),this}scaleEqual(t){return this.setTo(this.x*t,this.y*t),this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return t instanceof Y?this.x*t.y-this.y*t.x:"number"==typeof t?new Y(t*this.y,-t*this.x):void 0}static cross(t,e){return new Y(-t*e.y,t*e.x)}perpendicular(){return new Y(this.y,-this.x)}normal(){return this.perpendicular().normalize()}negate(){return this.scale(-1)}toAngle(){return Math.atan2(this.y,this.x)}rotate(t,e){e||(e=new Y(0,0));const i=Math.sin(t),s=Math.cos(t),n=s*(this.x-e.x)-i*(this.y-e.y)+e.x,r=i*(this.x-e.x)+s*(this.y-e.y)+e.y;return new Y(n,r)}clone(){return new Y(this.x,this.y)}toString(t){return t?`(${this.x.toFixed(t)}, ${this.y.toFixed(t)})`:`(${this.x}, ${this.y})`}}function Q(t,e){return new Y(t,e)}!function(t,e,i,s){var n,r=arguments.length,o=r<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,s);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(o=(r<3?n(o):r>3?n(e,i,o):n(e,i))||o);r>3&&o&&Object.defineProperty(e,i,o)}([K({message:"will be removed in favour of `.size` in version 0.25.0"})],Y.prototype,"magnitude",null);var Z,$,J=function(t,e,i,s){var n,r=arguments.length,o=r<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,s);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(o=(r<3?n(o):r>3?n(e,i,o):n(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};class tt{constructor(t,e,i,s){this.r=t,this.g=e,this.b=i,this.a=null!=s?s:1}static fromRGB(t,e,i,s){return new tt(t,e,i,s)}static fromRGBString(t){let e=null;if(e=t.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\)/i)){const t=parseInt(e[1],10),i=parseInt(e[2],10),s=parseInt(e[3],10);let n=1;return e[4]&&(n=parseFloat(e[4])),new tt(t,i,s,n)}throw new Error("Invalid rgb/a string: "+t)}static fromHex(t){let e=null;if(e=t.match(/^#?([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})?$/i)){const t=parseInt(e[1],16),i=parseInt(e[2],16),s=parseInt(e[3],16);let n=1;return e[4]&&(n=parseInt(e[4],16)/255),new tt(t,i,s,n)}throw new Error("Invalid hex string: "+t)}static fromHSL(t,e,i,s=1){return new et(t,e,i,s).toRGBA()}lighten(t=.1){const e=et.fromRGBA(this.r,this.g,this.b,this.a);return e.l+=(1-e.l)*t,e.toRGBA()}darken(t=.1){const e=et.fromRGBA(this.r,this.g,this.b,this.a);return e.l-=e.l*t,e.toRGBA()}saturate(t=.1){const e=et.fromRGBA(this.r,this.g,this.b,this.a);return e.s+=e.s*t,e.toRGBA()}desaturate(t=.1){const e=et.fromRGBA(this.r,this.g,this.b,this.a);return e.s-=e.s*t,e.toRGBA()}multiply(t){const e=t.r/255*this.r/255*255,i=t.g/255*this.g/255*255,s=t.b/255*this.b/255*255,n=t.a*this.a;return new tt(e,i,s,n)}mulitiply(t){return this.multiply(t)}screen(t){const e=t.invert(),i=t.invert();return e.multiply(i).invert()}invert(){return new tt(255-this.r,255-this.g,255-this.b,1-this.a)}average(t){const e=(t.r+this.r)/2,i=(t.g+this.g)/2,s=(t.b+this.b)/2,n=(t.a+this.a)/2;return new tt(e,i,s,n)}equal(t){return this.toString()===t.toString()}toString(t="rgb"){switch(t){case"rgb":return this.toRGBA();case"hsl":return this.toHSLA();case"hex":return this.toHex();default:throw new Error("Invalid Color format")}}_componentToHex(t){const e=t.toString(16);return 1===e.length?"0"+e:e}toHex(){return"#"+this._componentToHex(this.r)+this._componentToHex(this.g)+this._componentToHex(this.b)}toRGBA(){const t=String(this.r.toFixed(0))+", "+String(this.g.toFixed(0))+", "+String(this.b.toFixed(0));return void 0!==this.a||null!==this.a?"rgba("+t+", "+String(this.a)+")":"rgb("+t+")"}toHSLA(){return et.fromRGBA(this.r,this.g,this.b,this.a).toString()}fillStyle(){return this.toString()}clone(){return new tt(this.r,this.g,this.b,this.a)}static get Black(){return tt.fromHex("#000000")}static get White(){return tt.fromHex("#FFFFFF")}static get Gray(){return tt.fromHex("#808080")}static get LightGray(){return tt.fromHex("#D3D3D3")}static get DarkGray(){return tt.fromHex("#A9A9A9")}static get Yellow(){return tt.fromHex("#FFFF00")}static get Orange(){return tt.fromHex("#FFA500")}static get Red(){return tt.fromHex("#FF0000")}static get Vermilion(){return tt.fromHex("#FF5B31")}static get Vermillion(){return tt.Vermilion}static get Rose(){return tt.fromHex("#FF007F")}static get Magenta(){return tt.fromHex("#FF00FF")}static get Violet(){return tt.fromHex("#7F00FF")}static get Blue(){return tt.fromHex("#0000FF")}static get Azure(){return tt.fromHex("#007FFF")}static get Cyan(){return tt.fromHex("#00FFFF")}static get Viridian(){return tt.fromHex("#59978F")}static get Green(){return tt.fromHex("#00FF00")}static get Chartreuse(){return tt.fromHex("#7FFF00")}static get Transparent(){return tt.fromHex("#FFFFFF00")}static get ExcaliburBlue(){return tt.fromHex("#176BAA")}}J([K({message:"Alias for incorrect spelling used in older versions, use multiply instead, will be removed in v0.25.0"})],tt.prototype,"mulitiply",null),J([K({message:"Alias for incorrect spelling used in older versions",alternateMethod:"Vermilion"})],tt,"Vermillion",null);class et{constructor(t,e,i,s){this.h=t,this.s=e,this.l=i,this.a=s}static hue2rgb(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+6*(e-t)*i:i<.5?e:i<2/3?t+(e-t)*(2/3-i)*6:t}static fromRGBA(t,e,i,s){t/=255,e/=255,i/=255;const n=Math.max(t,e,i),r=Math.min(t,e,i);let o,a;const l=(n+r)/2;if(n===r)o=a=0;else{const s=n-r;switch(a=l>.5?s/(2-n-r):s/(n+r),n){case t:o=(e-i)/s+(e<i?6:0);break;case e:o=(i-t)/s+2;break;case i:o=(t-e)/s+4}o/=6}return new et(o,a,l,s)}toRGBA(){let t,e,i;if(0===this.s)t=e=i=this.l;else{const s=this.l<.5?this.l*(1+this.s):this.l+this.s-this.l*this.s,n=2*this.l-s;t=et.hue2rgb(n,s,this.h+1/3),e=et.hue2rgb(n,s,this.h),i=et.hue2rgb(n,s,this.h-1/3)}return new tt(255*t,255*e,255*i,this.a)}toString(){return`hsla(${this.h.toFixed(0)}, ${this.s.toFixed(0)}, ${this.l.toFixed(0)}, ${this.a.toFixed(0)})`}}class it{constructor(t=0,e=0,i=0,s=0){"object"==typeof t?(this.left=t.left,this.top=t.top,this.right=t.right,this.bottom=t.bottom):"number"==typeof t&&(this.left=t,this.top=e,this.right=i,this.bottom=s)}static getSideFromIntersection(t){return t&&t?Math.abs(t.x)>Math.abs(t.y)?t.x<0?b.Right:b.Left:t.y<0?b.Bottom:b.Top:b.None}static fromPoints(t){let e=1/0,i=1/0,s=-1/0,n=-1/0;for(let r=0;r<t.length;r++)t[r].x<e&&(e=t[r].x),t[r].x>s&&(s=t[r].x),t[r].y<i&&(i=t[r].y),t[r].y>n&&(n=t[r].y);return new it(e,i,s,n)}static fromDimension(t,e,i=Y.Half,s=Y.Zero){return new it(-t*i.x+s.x,-e*i.y+s.y,t-t*i.x+s.x,e-e*i.y+s.y)}get width(){return this.right-this.left}get height(){return this.bottom-this.top}hasZeroDimensions(){return 0===this.width||0===this.height}get center(){return new Y((this.left+this.right)/2,(this.top+this.bottom)/2)}translate(t){return new it(this.left+t.x,this.top+t.y,this.right+t.x,this.bottom+t.y)}rotate(t,e=Y.Zero){const i=this.getPoints().map((i=>i.rotate(t,e)));return it.fromPoints(i)}scale(t,e=Y.Zero){const i=this.translate(e);return new it(i.left*t.x,i.top*t.y,i.right*t.x,i.bottom*t.y)}transform(t){const e=this.getPoints().map((e=>t.multv(e)));return it.fromPoints(e)}getPerimeter(){return 2*(this.width+this.height)}getPoints(){const t=[];return t.push(new Y(this.left,this.top)),t.push(new Y(this.right,this.top)),t.push(new Y(this.right,this.bottom)),t.push(new Y(this.left,this.bottom)),t}rayCast(t,e=1/0){let i=-1/0,s=1/0;const n=0===t.dir.x?Number.MAX_VALUE:1/t.dir.x,r=0===t.dir.y?Number.MAX_VALUE:1/t.dir.y,o=(this.left-t.pos.x)*n,a=(this.right-t.pos.x)*n;i=Math.min(o,a),s=Math.max(o,a);const l=(this.top-t.pos.y)*r,h=(this.bottom-t.pos.y)*r;return i=Math.max(i,Math.min(l,h)),s=Math.min(s,Math.max(l,h)),s>=Math.max(0,i)&&i<e}rayCastTime(t,e=1/0){let i=-1/0,s=1/0;const n=0===t.dir.x?Number.MAX_VALUE:1/t.dir.x,r=0===t.dir.y?Number.MAX_VALUE:1/t.dir.y,o=(this.left-t.pos.x)*n,a=(this.right-t.pos.x)*n;i=Math.min(o,a),s=Math.max(o,a);const l=(this.top-t.pos.y)*r,h=(this.bottom-t.pos.y)*r;return i=Math.max(i,Math.min(l,h)),s=Math.min(s,Math.max(l,h)),s>=Math.max(0,i)&&i<e?i:-1}contains(t){return t instanceof Y?this.left<=t.x&&this.top<=t.y&&this.bottom>=t.y&&this.right>=t.x:t instanceof it&&(this.left<t.left&&this.top<t.top&&t.bottom<this.bottom&&t.right<this.right)}combine(t){return new it(Math.min(this.left,t.left),Math.min(this.top,t.top),Math.max(this.right,t.right),Math.max(this.bottom,t.bottom))}get dimensions(){return new Y(this.width,this.height)}intersect(t){const e=this.combine(t);if(e.width<t.width+this.width&&e.height<t.height+this.height&&!e.dimensions.equals(t.dimensions)&&!e.dimensions.equals(this.dimensions)){let e=0;e=this.right>=t.left&&this.right<=t.right?t.left-this.right:t.right-this.left;let i=0;return i=this.top<=t.bottom&&this.top>=t.top?t.bottom-this.top:t.top-this.bottom,Math.abs(e)<Math.abs(i)?new Y(e,0):new Y(0,i)}if(e.dimensions.equals(t.dimensions)||e.dimensions.equals(this.dimensions)){let e=0;e=this.width-t.width>=0?this.right-t.right<=t.left-this.left?t.left-this.right:t.right-this.left:t.right-this.right<=this.left-t.left?this.left-t.right:this.right-t.left;let i=0;return i=this.height-t.height>=0?this.bottom-t.bottom<=t.top-this.top?t.top-this.bottom:t.bottom-this.top:t.bottom-this.bottom<=this.top-t.top?this.top-t.bottom:this.bottom-t.top,Math.abs(e)<Math.abs(i)?new Y(e,0):new Y(0,i)}return null}intersectWithSide(t){const e=this.intersect(t);return it.getSideFromIntersection(e)}debugDraw(t,e=tt.Yellow){t.strokeStyle=e.toString(),t.strokeRect(this.left,this.top,this.width,this.height)}draw(t,e=tt.Yellow){t.debug.drawRect(this.left,this.top,this.width,this.height,{color:e})}}($=Z||(Z={}))[$.X=12]="X",$[$.Y=13]="Y";const st=t=>0===t?0:t<0?-1:1;class nt{constructor(){this.data=new Float32Array(16),this._scaleSignX=1,this._scaleSignY=1}static ortho(t,e,i,s,n,r){const o=new nt;return o.data[0]=2/(e-t),o.data[1]=0,o.data[2]=0,o.data[3]=0,o.data[4]=0,o.data[5]=2/(s-i),o.data[6]=0,o.data[7]=0,o.data[8]=0,o.data[9]=0,o.data[10]=-2/(r-n),o.data[11]=0,o.data[12]=-(e+t)/(e-t),o.data[13]=-(s+i)/(s-i),o.data[14]=-(r+n)/(r-n),o.data[15]=1,o}clone(){const t=new nt;return t.data[0]=this.data[0],t.data[1]=this.data[1],t.data[2]=this.data[2],t.data[3]=this.data[3],t.data[4]=this.data[4],t.data[5]=this.data[5],t.data[6]=this.data[6],t.data[7]=this.data[7],t.data[8]=this.data[8],t.data[9]=this.data[9],t.data[10]=this.data[10],t.data[11]=this.data[11],t.data[12]=this.data[12],t.data[13]=this.data[13],t.data[14]=this.data[14],t.data[15]=this.data[15],t}static identity(){const t=new nt;return t.data[0]=1,t.data[1]=0,t.data[2]=0,t.data[3]=0,t.data[4]=0,t.data[5]=1,t.data[6]=0,t.data[7]=0,t.data[8]=0,t.data[9]=0,t.data[10]=1,t.data[11]=0,t.data[12]=0,t.data[13]=0,t.data[14]=0,t.data[15]=1,t}static translation(t,e){const i=nt.identity();return i.data[12]=t,i.data[13]=e,i}static scale(t,e){const i=nt.identity();return i.data[0]=t,i.data[5]=e,i.data[10]=1,i.data[15]=1,i}static rotation(t){const e=nt.identity();return e.data[0]=Math.cos(t),e.data[4]=-Math.sin(t),e.data[1]=Math.sin(t),e.data[5]=Math.cos(t),e}multv(t){if(t instanceof Y)return new Y(t.x*this.data[0]+t.y*this.data[4]+0*this.data[6]+1*this.data[12],t.x*this.data[1]+t.y*this.data[5]+0*this.data[9]+1*this.data[13]);return[t[0]*this.data[0]+t[1]*this.data[4]+0*this.data[6]+1*this.data[12],t[0]*this.data[1]+t[1]*this.data[5]+0*this.data[9]+1*this.data[13]]}multm(t){const e=new nt,i=this.data[0],s=this.data[1],n=this.data[2],r=this.data[3],o=this.data[4],a=this.data[5],l=this.data[6],h=this.data[7],c=this.data[8],d=this.data[9],u=this.data[10],p=this.data[11],g=this.data[12],f=this.data[13],m=this.data[14],y=this.data[15],_=t.data[0],w=t.data[1],v=t.data[2],x=t.data[3],b=t.data[4],S=t.data[5],C=t.data[6],E=t.data[7],P=t.data[8],A=t.data[9],k=t.data[10],T=t.data[11],R=t.data[12],M=t.data[13],D=t.data[14],L=t.data[15];e.data[0]=i*_+o*w+c*v+g*x,e.data[1]=s*_+a*w+d*v+f*x,e.data[2]=n*_+l*w+u*v+m*x,e.data[3]=r*_+h*w+p*v+y*x,e.data[4]=i*b+o*S+c*C+g*E,e.data[5]=s*b+a*S+d*C+f*E,e.data[6]=n*b+l*S+u*C+m*E,e.data[7]=r*b+h*S+p*C+y*E,e.data[8]=i*P+o*A+c*k+g*T,e.data[9]=s*P+a*A+d*k+f*T,e.data[10]=n*P+l*A+u*k+m*T,e.data[11]=r*P+h*A+p*k+y*T,e.data[12]=i*R+o*M+c*D+g*L,e.data[13]=s*R+a*M+d*D+f*L,e.data[14]=n*R+l*M+u*D+m*L,e.data[15]=r*R+h*M+p*D+y*L;const B=this.getScale();return e._scaleSignX=st(B.x)*st(e._scaleSignX),e._scaleSignY=st(B.y)*st(e._scaleSignY),e}translate(t,e){const i=this.data[0],s=this.data[1],n=this.data[2],r=this.data[3],o=this.data[4],a=this.data[5],l=this.data[6],h=this.data[7],c=this.data[8],d=this.data[9],u=this.data[10],p=this.data[11],g=this.data[12],f=this.data[13],m=this.data[14],y=this.data[15];return this.data[12]=i*t+o*e+0*c+1*g,this.data[13]=s*t+a*e+0*d+1*f,this.data[14]=n*t+l*e+0*u+1*m,this.data[15]=r*t+h*e+0*p+1*y,this}setPosition(t,e){this.data[12]=t,this.data[13]=e}getPosition(){return Q(this.data[12],this.data[13])}rotate(t){const e=this.data[0],i=this.data[1],s=this.data[2],n=this.data[3],r=this.data[4],o=this.data[5],a=this.data[6],l=this.data[7],h=Math.sin(t),c=Math.cos(t);return this.data[0]=c*e+h*r,this.data[1]=c*i+h*o,this.data[2]=c*s+h*a,this.data[3]=c*n+h*l,this.data[4]=c*r-h*e,this.data[5]=c*o-h*i,this.data[6]=c*a-h*s,this.data[7]=c*l-h*n,this}scale(t,e){const i=this.data[0],s=this.data[1],n=this.data[2],r=this.data[3],o=this.data[4],a=this.data[5],l=this.data[6],h=this.data[7];return this.data[0]=i*t,this.data[1]=s*t,this.data[2]=n*t,this.data[3]=r*t,this.data[4]=o*e,this.data[5]=a*e,this.data[6]=l*e,this.data[7]=h*e,this}setRotation(t){const e=this.getScale(),i=Math.sin(t),s=Math.cos(t);this.data[0]=s*e.x,this.data[1]=i*e.y,this.data[4]=-i*e.x,this.data[5]=s*e.y}getRotation(){return M(Math.atan2(this.data[1]/this.getScaleY(),this.data[0]/this.getScaleX()))}getScaleX(){const t=Q(this.data[0],this.data[4]).size;return this._scaleSignX*t}getScaleY(){const t=Q(this.data[1],this.data[5]).size;return this._scaleSignY*t}getScale(){return Q(this.getScaleX(),this.getScaleY())}setScaleX(t){this._scaleSignX=st(t);const e=Q(this.data[0]*this._scaleSignX,this.data[4]*this._scaleSignX).normalize();this.data[0]=e.x*t,this.data[4]=e.y*t}setScaleY(t){this._scaleSignY=st(t);const e=Q(this.data[1]*this._scaleSignY,this.data[5]*this._scaleSignY).normalize();this.data[1]=e.x*t,this.data[5]=e.y*t}setScale(t){this.setScaleX(t.x),this.setScaleY(t.y)}getBasisDeterminant(){return this.data[0]*this.data[5]-this.data[1]*this.data[4]}getAffineInverse(){const t=1/this.getBasisDeterminant(),e=this.data[0],i=this.data[4],s=this.data[1],n=this.data[5],r=nt.identity();r.data[0]=n*t,r.data[1]=-s*t,r.data[4]=-i*t,r.data[5]=e*t;const o=this.data[12],a=this.data[13];return r.data[12]=-(o*r.data[0]+a*r.data[4]),r.data[13]=-(o*r.data[1]+a*r.data[5]),r}isIdentity(){return 1===this.data[0]&&0===this.data[1]&&0===this.data[2]&&0===this.data[3]&&0===this.data[4]&&1===this.data[5]&&0===this.data[6]&&0===this.data[7]&&0===this.data[8]&&0===this.data[9]&&1===this.data[10]&&0===this.data[11]&&0===this.data[12]&&0===this.data[13]&&0===this.data[14]&&1===this.data[15]}toString(){return`\n[${this.data[0]} ${this.data[4]} ${this.data[8]} ${this.data[12]}]\n[${this.data[1]} ${this.data[5]} ${this.data[9]} ${this.data[13]}]\n[${this.data[2]} ${this.data[6]} ${this.data[10]} ${this.data[14]}]\n[${this.data[3]} ${this.data[7]} ${this.data[11]} ${this.data[15]}]\n`}}class rt{constructor(){this._transforms=[],this._currentTransform=nt.identity()}save(){this._transforms.push(this._currentTransform),this._currentTransform=this._currentTransform.clone()}restore(){this._currentTransform=this._transforms.pop()}translate(t,e){return this._currentTransform.translate(t,e)}rotate(t){return this._currentTransform.rotate(t)}scale(t,e){return this._currentTransform.scale(t,e)}set current(t){this._currentTransform=t}get current(){return this._currentTransform}}class ot{constructor(){this._states=[],this._currentState=this._getDefaultState()}_getDefaultState(){return{opacity:1}}_cloneState(){return{opacity:this._currentState.opacity}}save(){this._states.push(this._currentState),this._currentState=this._cloneState()}restore(){this._currentState=this._states.pop()}get current(){return this._currentState}}class at{constructor(t,e,i){this._gl=t,this._vertexSource=e,this._fragmentSource=i,this.program=null,this.uniforms={},this.attributes={},this.layout=[],this.compile(t)}_createProgram(t,e,i){const s=t.createProgram();if(null===s)throw Error("Could not create graphics shader program");t.attachShader(s,e),t.attachShader(s,i),t.linkProgram(s);if(!t.getProgramParameter(s,t.LINK_STATUS))throw Error(`Could not link the program: [${t.getProgramInfoLog(s)}]`);return s}_compileShader(t,e,i){const s=t.createShader(i);if(null===s)throw Error(`Could not build shader: [${e}]`);t.shaderSource(s,e),t.compileShader(s);if(!t.getShaderParameter(s,t.COMPILE_STATUS))throw Error(`Could not compile shader [${t.getShaderInfoLog(s)}]`);return s}compile(t){const e=this._compileShader(t,this._vertexSource,t.VERTEX_SHADER),i=this._compileShader(t,this._fragmentSource,t.FRAGMENT_SHADER),s=this._createProgram(t,e,i);return this.program=s}addUniformMatrix(t,e){if(!e)throw Error(`Shader Uniform Matrix '${t}' was set to null or undefined`);const i=this._gl;this.uniforms[t]={name:t,type:"matrix",location:i.getUniformLocation(this.program,t),data:e}}addUniformIntegerArray(t,e){if(!e)throw Error(`Shader Uniform Integery Array '${t}' was set to null or undefined`);const i=this._gl;this.uniforms[t]={name:t,type:"numbers",location:i.getUniformLocation(this.program,t),data:e}}addAttribute(t,e,i,s=!1){const n=this._gl.getAttribLocation(this.program,t);this.attributes[t]={name:t,size:e,glType:i,normalized:s,location:n},this.layout.push(this.attributes[t])}get vertexAttributeSize(){let t=0;for(const e of this.layout)t+=e.size;return t}get totalVertexSizeBytes(){let t=0;for(const e of this.layout){let i=1;if(e.glType===this._gl.FLOAT)i=4;else i=1;t+=i*e.size}return t}getAttributeSize(t){let e=1;if(this.attributes[t].glType===this._gl.FLOAT)e=4;else e=1;return e*this.attributes[t].size}use(){const t=this._gl;t.useProgram(this.program);let e=0;for(const i of this.layout)t.vertexAttribPointer(i.location,i.size,i.glType,i.normalized,this.totalVertexSizeBytes,e),t.enableVertexAttribArray(i.location),e+=this.getAttributeSize(i.name);for(const e in this.uniforms){const i=this.uniforms[e];switch(i.type){case"matrix":t.uniformMatrix4fv(i.location,!1,i.data);break;case"numbers":t.uniform1iv(i.location,i.data)}}}}class lt{constructor(t){this.max=t,this._pool=void 0,this.commands=[]}isFull(){return this.commands.length>=this.max}canAdd(){return!this.isFull()}add(t){this.commands.push(t)}dispose(){return this.commands.length=0,this}}class ht{static clear(){ht.DrawCallCount=0,ht.DrawnImagesCount=0}}ht.DrawCallCount=0,ht.DrawnImagesCount=0;class ct{constructor(t,e,i=100){this.builder=t,this.recycler=e,this.maxObjects=i,this.totalAllocations=0,this.index=0,this.objects=[],this._logger=y.getInstance()}using(t){const e=t(this);return e?this.done(...e):this.done()}borrow(t){t(this.get()),this.index--}get(...t){if(this.index===this.maxObjects&&(this._logger.warn("Max pooled objects reached, possible memory leak? Doubling"),this.maxObjects=2*this.maxObjects),this.objects[this.index])return this.recycler(this.objects[this.index++],...t);{this.totalAllocations++;const e=this.objects[this.index++]=this.builder(...t);return e._pool=this,e}}done(...t){this.index=0;for(const e of t){const t=this.objects.indexOf(e);this.objects[t]=this.builder(),this.objects[t]._pool=this,this.totalAllocations++,e._pool=void 0}return t}}class dt{constructor(t){var e,i,s;this.priority=0,this._buffer=null,this._maxCommandsPerBatch=2e3,this._batches=[],this._gl=t.gl;const n=t.command;this._verticesPerCommand=null!==(e=null==t?void 0:t.verticesPerCommand)&&void 0!==e?e:1,this._maxCommandsPerBatch=null!==(i=null==t?void 0:t.maxCommandsPerBatch)&&void 0!==i?i:this._maxCommandsPerBatch;const r=null!==(s=null==t?void 0:t.batchFactory)&&void 0!==s?s:()=>new lt(this._maxCommandsPerBatch);this.commands=new ct((()=>new n),(t=>t.dispose()),this._maxCommandsPerBatch),this._batchPool=new ct(r,(t=>t.dispose()),100)}init(){const t=this._gl;this.shader=this.buildShader(t),this._vertices=new Float32Array(this.shader.vertexAttributeSize*this._verticesPerCommand*this._maxCommandsPerBatch),this._buffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this._buffer),t.bufferData(t.ARRAY_BUFFER,this._vertices,t.DYNAMIC_DRAW)}get vertexSize(){return this.shader.vertexAttributeSize}addCommand(t){0===this._batches.length&&this._batches.push(this._batchPool.get());const e=this._batches[this._batches.length-1];if(e.canAdd())e.add(t);else{const e=this._batchPool.get();e.add(t),this._batches.push(e)}}render(){const t=this._gl;t.bindBuffer(t.ARRAY_BUFFER,this._buffer),this.shader.use();let e=0,i=0;for(const s of this._batches){const n=this.buildBatchVertices(this._vertices,s);t.bufferSubData(t.ARRAY_BUFFER,0,this._vertices),this.renderBatch(t,s,n),i+=s.commands.length,e++}this.commands.done(),this._batchPool.done(),this._batches.length=0,ht.DrawCallCount+=e,ht.DrawnImagesCount+=i}}class ut{constructor(){this.color=tt.Black,this.start=Y.Zero,this.end=Y.Zero}dispose(){return this.color.r=0,this.color.g=0,this.color.b=0,this.color.a=1,this.start.setTo(0,0),this.end.setTo(0,0),this}}class pt extends dt{constructor(t,e){super({gl:t,command:ut,verticesPerCommand:2}),this._contextInfo=e,this.init()}buildShader(t){const e=new at(t,"attribute vec4 a_position;\r\nattribute vec4 a_color;\r\n\r\nvarying lowp vec4 v_color;\r\n\r\nuniform mat4 u_matrix;\r\n\r\n\r\nvoid main() {\r\n   // Set the vertex position using the ortho transform matrix\r\n   gl_Position = u_matrix * a_position;\r\n\r\n   // Passthrough the color\r\n   v_color = a_color;\r\n}","precision mediump float;\r\n\r\n// Color\r\nvarying lowp vec4 v_color;\r\n\r\n\r\nvoid main() {\r\n  gl_FragColor = v_color;\r\n}");return e.addAttribute("a_position",2,t.FLOAT),e.addAttribute("a_color",4,t.FLOAT),e.addUniformMatrix("u_matrix",this._contextInfo.matrix.data),e}addLine(t,e,i){const s=this.commands.get();s.start=this._contextInfo.transform.current.multv(t),s.end=this._contextInfo.transform.current.multv(e),s.color.r=i.r,s.color.g=i.g,s.color.b=i.b,s.color.a=s.color.a*this._contextInfo.state.current.opacity,this.addCommand(s)}buildBatchVertices(t,e){let i=0;for(const s of e.commands)t[i++]=s.start.x,t[i++]=s.start.y,t[i++]=s.color.r/255,t[i++]=s.color.g/255,t[i++]=s.color.b/255,t[i++]=s.color.a,t[i++]=s.end.x,t[i++]=s.end.y,t[i++]=s.color.r/255,t[i++]=s.color.g/255,t[i++]=s.color.b/255,t[i++]=s.color.a;return i/this.vertexSize}renderBatch(t,e,i){t.drawArrays(t.LINES,0,i)}}var gt,ft;(ft=gt||(gt={})).Image="image",ft.Line="line",ft.Rectangle="rectangle",ft.Circle="circle";class mt{constructor(t,e,i,s,n,r,o,a,l){this._pool=void 0,this.snapToPixel=!0,this.type=gt.Image,this.opacity=1,this.width=0,this.height=0,this.dest=[0,0],this.view=[0,0,0,0],this._geom=[[0,0],[0,0],[0,0],[0,0],[0,0],[0,0]],this.init(t,e,i,s,n,r,o,a,l)}init(t,e,i,s,n,r,o,a,l){this.type=gt.Image,this.image=t,this.width=(null==t?void 0:t.width)||s||0,this.height=(null==t?void 0:t.height)||n||0,this.view=[0,0,null!=s?s:null==t?void 0:t.width,null!=n?n:null==t?void 0:t.height],this.dest=[e,i],void 0!==r&&void 0!==o&&void 0!==a&&void 0!==l&&(this.view=[e,i,null!=s?s:null==t?void 0:t.width,null!=n?n:null==t?void 0:t.height],this.dest=[r,o],this.width=a,this.height=l);let h=0;if(this._geom[h++]=[this.dest[0],this.dest[1]],this._geom[h++]=[this.dest[0],this.dest[1]+this.height],this._geom[h++]=[this.dest[0]+this.width,this.dest[1]],this._geom[h++]=[this.dest[0]+this.width,this.dest[1]],this._geom[h++]=[this.dest[0],this.dest[1]+this.height],this._geom[h++]=[this.dest[0]+this.width,this.dest[1]+this.height],this.snapToPixel)for(const t of this._geom)t[0]=~~t[0],t[1]=~~t[1];return this}initRect(t,e,i,s){this.type=gt.Rectangle,this.color=t,this.width=i,this.height=s;let n=0;if(this._geom[n++]=[e.x,e.y],this._geom[n++]=[e.x,e.y+this.height],this._geom[n++]=[e.x+this.width,e.y],this._geom[n++]=[e.x+this.width,e.y],this._geom[n++]=[e.x,e.y+this.height],this._geom[n++]=[e.x+this.width,e.y+this.height],this.snapToPixel)for(const t of this._geom)t[0]=~~t[0],t[1]=~~t[1];return this}initLine(t,e,i,s){this.type=gt.Line,this.color=t;const n=i.sub(e).normalize().perpendicular(),r=s/2,o=n.scale(r).add(e),a=n.scale(-r).add(e),l=n.scale(r).add(i),h=n.scale(-r).add(i);let c=0;if(this._geom[c++]=[o.x,o.y],this._geom[c++]=[l.x,l.y],this._geom[c++]=[a.x,a.y],this._geom[c++]=[a.x,a.y],this._geom[c++]=[l.x,l.y],this._geom[c++]=[h.x,h.y],this.snapToPixel)for(const t of this._geom)t[0]=~~t[0],t[1]=~~t[1];return this}initCircle(t,e,i){this.type=gt.Circle,this.color=i;const s=t.add(Q(-e,-e)),n=t.add(Q(e,-e)),r=t.add(Q(e,e)),o=t.add(Q(-e,e));let a=0;if(this._geom[a++]=[s.x,s.y],this._geom[a++]=[n.x,n.y],this._geom[a++]=[o.x,o.y],this._geom[a++]=[o.x,o.y],this._geom[a++]=[n.x,n.y],this._geom[a++]=[r.x,r.y],this.snapToPixel)for(const t of this._geom)t[0]=~~t[0],t[1]=~~t[1];return this}dispose(){this.image=null,this.width=0,this.height=0,this.view=[0,0,0,0],this.dest=[0,0];let t=0;return this._geom[t++]=[this.dest[0],this.dest[1]],this._geom[t++]=[this.dest[0],this.dest[1]+this.height],this._geom[t++]=[this.dest[0]+this.width,this.dest[1]],this._geom[t++]=[this.dest[0]+this.width,this.dest[1]],this._geom[t++]=[this.dest[0],this.dest[1]+this.height],this._geom[t++]=[this.dest[0]+this.width,this.dest[1]+this.height],this}applyTransform(t,e){if(t)for(let e=0;e<this._geom.length;e++)this._geom[e]=t.multv(this._geom[e]),this.snapToPixel&&(this._geom[e]=[~~this._geom[e][0],~~this._geom[e][1]]);this.opacity=e}get geometry(){return this._geom}}function yt(t){return 0==(t&t-1)}function _t(t){return yt(t)?t:function(t){--t;for(let e=1;e<32;e<<=1)t|=t>>e;return t+1}(t)}class wt{static registerContext(t){wt._GL=t}static get(t){return wt._TEXTURE_MAP.get(t)}static has(t){return wt._TEXTURE_MAP.has(t)}static load(t,e=!1){const i=wt._GL;if(!i)return null;let s=null;if(wt.has(t)&&(s=wt.get(t)),s){if(e){i.bindTexture(i.TEXTURE_2D,s);const e=wt.toPowerOfTwoImage(t);i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,e)}return s}s=i.createTexture();const n=wt.toPowerOfTwoImage(t);return i.bindTexture(i.TEXTURE_2D,s),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.NEAREST),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,n),wt._TEXTURE_MAP.set(t,s),s}static toPowerOfTwoImage(t){const e=wt._POT_CANVAS,i=wt._POT_CTX;return yt(t.width)&&yt(t.height)||(e.width=_t(t.width),e.height=_t(t.height),i.imageSmoothingEnabled=!1,i.clearRect(0,0,e.width,e.height),i.drawImage(t,0,0,t.width,t.height),t=e),t}}wt._POT_CANVAS=document.createElement("canvas"),wt._POT_CTX=wt._POT_CANVAS.getContext("2d"),wt._TEXTURE_MAP=new Map;class vt extends lt{constructor(t,e){super(t),this.maxDraws=t,this.maxTextures=e,this.textures=[],this.commands=[],this._graphicMap={}}isFull(){return this.commands.length>=this.maxDraws||this.textures.length>=this.maxTextures}canAdd(){return!(this.commands.length>=this.maxDraws)&&this.textures.length<this.maxTextures}_isCommandFull(){return this.commands.length>=this.maxDraws}_isTextureFull(){return this.textures.length>=this.maxTextures}_wouldAddTexture(t){return!this._graphicMap[t.image.id]}maybeAdd(t){return(!this._isCommandFull()&&!this._isTextureFull()||!this._wouldAddTexture(t))&&(this.add(t),!0)}add(t){if(t.type===gt.Image){const e=wt.load(t.image);-1===this.textures.indexOf(e)&&this.textures.push(e)}this.commands.push(t)}bindTextures(t){for(let e=0;e<this.maxTextures;e++)t.activeTexture(t.TEXTURE0+e),t.bindTexture(t.TEXTURE_2D,this.textures[e]||this.textures[0])}getBatchTextureId(t){return t.image?this.textures.indexOf(wt.get(t.image)):-1}dispose(){return this.clear(),this}clear(){this.commands.length=0,this.textures.length=0,this._graphicMap={}}}class xt extends dt{constructor(t,e){super({gl:t,command:mt,verticesPerCommand:6,maxCommandsPerBatch:2e3,batchFactory:()=>new vt(2e3,t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS))}),this._contextInfo=e,wt.registerContext(t),this.init()}buildShader(t){const e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),i=new at(t,"attribute vec4 a_position;\r\n\r\n// Opacity \r\nattribute float a_opacity;\r\nvarying float v_opacity;\r\n\r\nattribute vec4 a_color;\r\nvarying vec4 v_color;\r\n\r\n// UV coordinate\r\nattribute vec2 a_texcoord;\r\nvarying vec2 v_texcoord;\r\n\r\n// Texture number\r\nattribute lowp float a_textureIndex;\r\nvarying lowp float v_textureIndex;\r\n\r\nuniform mat4 u_matrix;\r\n\r\n\r\nvoid main() {\r\n   // Set the vertex position using the ortho transform matrix\r\n   gl_Position = u_matrix * a_position;\r\n\r\n   // Pass through the Opacity to the fragment shader\r\n   v_opacity = a_opacity;\r\n   // Pass through the UV coord to the fragment shader\r\n   v_texcoord = a_texcoord;\r\n   // Pass through the texture number to the fragment shader\r\n   v_textureIndex = a_textureIndex;\r\n   // Pass through the color to the fragment shader\r\n   v_color = a_color;\r\n}",this._transformFragmentSource("#ifdef GL_OES_standard_derivatives\r\n#extension GL_OES_standard_derivatives : enable\r\n#endif\r\nprecision mediump float;\r\n\r\n// UV coord\r\nvarying vec2 v_texcoord;\r\n\r\n// Texture index\r\nvarying lowp float v_textureIndex;\r\n\r\n// Color coord to blend with image\r\nvarying lowp vec4 v_color;\r\n\r\n// Opacity\r\nvarying float v_opacity;\r\n\r\nuniform sampler2D u_textures[%%count%%];\r\n\r\nfloat circle(in vec2 st, in float radius) {\r\n  vec2 dist = st - vec2(0.5);\r\n  float r = dot(dist, dist) * 4.0;\r\n  float delta = fwidth(r);\r\n  return 1.0 - smoothstep(radius - delta, radius + delta, r);\r\n}\r\n\r\nvoid main() {\r\n  float r = 0.0, delta = 0.0, alpha = 1.0;\r\n   // In order to support the most efficient sprite batching, we have multiple\r\n   // textures loaded into the gpu (usually 8) this picker logic skips over textures\r\n   // that do not apply to a particular sprite.\r\n\r\n   vec4 color;\r\n   // -1 If there is no texture to sample we are drawing a solid geometry (rectangles)\r\n   if (v_textureIndex == -1.0) {\r\n     color = v_color;\r\n     color.w = color.w * v_opacity;\r\n   // -2 If there is no texture we are drawing a circle\r\n   } else if (v_textureIndex == -2.0) {\r\n     color = v_color;\r\n     color.a = color.a * circle(v_texcoord, .95);\r\n   } else {\r\n     // GLSL is templated out to pick the right texture and set the vec4 color\r\n      %%texture_picker%%\r\n   }\r\n   color.w = color.w * v_opacity;\r\n   gl_FragColor = color;\r\n}",e));return i.addAttribute("a_position",3,t.FLOAT),i.addAttribute("a_texcoord",2,t.FLOAT),i.addAttribute("a_textureIndex",1,t.FLOAT),i.addAttribute("a_opacity",1,t.FLOAT),i.addAttribute("a_color",4,t.FLOAT),i.addUniformMatrix("u_matrix",this._contextInfo.matrix.data),i.addUniformIntegerArray("u_textures",[...Array(e)].map(((t,e)=>e))),i}_transformFragmentSource(t,e){let i=t.replace("%%count%%",e.toString()),s="";for(let t=0;t<e;t++)s+=0===t?`if (v_textureIndex <= ${t}.5) {\n`:`   else if (v_textureIndex <= ${t}.5) {\n`,s+=`      color = texture2D(u_textures[${t}], v_texcoord);\n`,s+="   }\n";return i=i.replace("%%texture_picker%%",s),i}addCircle(t,e,i){const s=this.commands.get().initCircle(t,e,i);s.applyTransform(this._contextInfo.transform.current,this._contextInfo.state.current.opacity),this.addCommand(s)}addRectangle(t,e,i,s){const n=this.commands.get().initRect(t,e,i,s);n.applyTransform(this._contextInfo.transform.current,this._contextInfo.state.current.opacity),this.addCommand(n)}addLine(t,e,i,s=1){const n=this.commands.get().initLine(t,e,i,s);n.applyTransform(this._contextInfo.transform.current,this._contextInfo.state.current.opacity),this.addCommand(n)}addImage(t,e,i,s,n,r,o,a,l){const h=this.commands.get().init(t,e,i,s,n,r,o,a,l);h.applyTransform(this._contextInfo.transform.current,this._contextInfo.state.current.opacity),this.addCommand(h)}renderBatch(t,e,i){e.bindTextures(t),t.drawArrays(t.TRIANGLES,0,i)}buildBatchVertices(t,e){var i,s;let n=0,r=0,o=0,a=0,l=0,h=1,c=1,d=0,u=tt.Transparent;for(const p of e.commands){r=p.view[0],o=p.view[1],a=p.view[2],l=p.view[3],h=_t((null===(i=p.image)||void 0===i?void 0:i.width)||p.width),c=_t((null===(s=p.image)||void 0===s?void 0:s.height)||p.height),d=e.getBatchTextureId(p),p.type!==gt.Line&&p.type!==gt.Rectangle||(d=-1,u=p.color),p.type===gt.Circle&&(d=-2,u=p.color);let g=r/h,f=o/c,m=(r+a)/h,y=(o+l)/c;-2===d&&(g=0,f=0,m=1,y=1),t[n++]=p.geometry[0][0],t[n++]=p.geometry[0][1],t[n++]=0,t[n++]=g,t[n++]=f,t[n++]=d,t[n++]=p.opacity,t[n++]=u.r/255,t[n++]=u.g/255,t[n++]=u.b/255,t[n++]=u.a,t[n++]=p.geometry[1][0],t[n++]=p.geometry[1][1],t[n++]=0,t[n++]=g,t[n++]=y,t[n++]=d,t[n++]=p.opacity,t[n++]=u.r/255,t[n++]=u.g/255,t[n++]=u.b/255,t[n++]=u.a,t[n++]=p.geometry[2][0],t[n++]=p.geometry[2][1],t[n++]=0,t[n++]=m,t[n++]=f,t[n++]=d,t[n++]=p.opacity,t[n++]=u.r/255,t[n++]=u.g/255,t[n++]=u.b/255,t[n++]=u.a,t[n++]=p.geometry[3][0],t[n++]=p.geometry[3][1],t[n++]=0,t[n++]=m,t[n++]=f,t[n++]=d,t[n++]=p.opacity,t[n++]=u.r/255,t[n++]=u.g/255,t[n++]=u.b/255,t[n++]=u.a,t[n++]=p.geometry[4][0],t[n++]=p.geometry[4][1],t[n++]=0,t[n++]=g,t[n++]=y,t[n++]=d,t[n++]=p.opacity,t[n++]=u.r/255,t[n++]=u.g/255,t[n++]=u.b/255,t[n++]=u.a,t[n++]=p.geometry[5][0],t[n++]=p.geometry[5][1],t[n++]=0,t[n++]=m,t[n++]=y,t[n++]=d,t[n++]=p.opacity,t[n++]=u.r/255,t[n++]=u.g/255,t[n++]=u.b/255,t[n++]=u.a}return n/this.vertexSize}}class bt{constructor(){this.point=Y.Zero,this.color=tt.Black,this.size=1}dispose(){return this.point.setTo(0,0),this.color.r=0,this.color.g=0,this.color.b=0,this.color.a=1,this.size=1,this}}class St extends dt{constructor(t,e){super({gl:t,command:bt,verticesPerCommand:1}),this._contextInfo=e,this.init()}buildShader(t){t.getExtension("OES_standard_derivatives");const e=new at(t,"attribute vec4 a_position;\r\nattribute vec4 a_color;\r\nattribute float a_size;\r\nvarying lowp vec4 v_color;\r\nuniform mat4 u_matrix;\r\n\r\nvoid main() {\r\n  gl_Position = u_matrix * a_position;\r\n  gl_PointSize = a_size * 2.0;\r\n  v_color = a_color;\r\n}","#ifdef GL_OES_standard_derivatives\r\n#extension GL_OES_standard_derivatives : enable\r\n#endif\r\n\r\nprecision mediump float;\r\nvarying lowp vec4 v_color;\r\n\r\nvoid main() {\r\n  float r = 0.0, delta = 0.0, alpha = 1.0;\r\n  vec2 cxy = 2.0 * gl_PointCoord - 1.0;\r\n  r = dot(cxy, cxy);\r\n  \r\n#ifdef GL_OES_standard_derivatives\r\n  delta = fwidth(r);\r\n  alpha = 1.0 - smoothstep(1.0 - delta, 1.0 + delta, r);\r\n#else\r\n  if (r > 1.0) {\r\n    discard;\r\n  }\r\n#endif\r\n  gl_FragColor = vec4(v_color.rgb, v_color.a * alpha);\r\n}");return e.addAttribute("a_position",2,t.FLOAT),e.addAttribute("a_color",4,t.FLOAT),e.addAttribute("a_size",1,t.FLOAT),e.addUniformMatrix("u_matrix",this._contextInfo.matrix.data),e}addPoint(t,e,i){const s=this.commands.get();s.point=this._contextInfo.transform.current.multv(t),s.color.r=e.r,s.color.g=e.g,s.color.b=e.b,s.color.a=e.a*this._contextInfo.state.current.opacity,s.size=i*Math.max(this._contextInfo.transform.current.getScaleX(),this._contextInfo.transform.current.getScaleY()),this.addCommand(s)}buildBatchVertices(t,e){let i=0;for(const s of e.commands)t[i++]=s.point.x,t[i++]=s.point.y,t[i++]=s.color.r/255,t[i++]=s.color.g/255,t[i++]=s.color.b/255,t[i++]=s.color.a,t[i++]=s.size;return i/this.vertexSize}renderBatch(t,e,i){t.drawArrays(t.POINTS,0,i)}}class Ct{constructor(t){var e,i,s,n,r,o;this.id=Ct._ID++,this.showDebug=!1,this.flipHorizontal=!1,this.flipVertical=!1,this.rotation=0,this.opacity=1,this.scale=Y.One,this.origin=null,this._width=0,this._height=0,t&&(this.origin=null!==(e=t.origin)&&void 0!==e?e:this.origin,this.flipHorizontal=null!==(i=t.flipHorizontal)&&void 0!==i?i:this.flipHorizontal,this.flipVertical=null!==(s=t.flipVertical)&&void 0!==s?s:this.flipVertical,this.rotation=null!==(n=t.rotation)&&void 0!==n?n:this.rotation,this.opacity=null!==(r=t.opacity)&&void 0!==r?r:this.opacity,this.scale=null!==(o=t.scale)&&void 0!==o?o:this.scale)}cloneGraphicOptions(){return{origin:this.origin?this.origin.clone():null,flipHorizontal:this.flipHorizontal,flipVertical:this.flipVertical,rotation:this.rotation,opacity:this.opacity,scale:this.scale?this.scale.clone():null}}get width(){return Math.abs(this._width*this.scale.x)}get height(){return Math.abs(this._height*this.scale.y)}set width(t){this._width=t}set height(t){this._height=t}get localBounds(){return it.fromDimension(this.width,this.height,Y.Zero)}draw(t,e,i){this._preDraw(t,e,i),this._drawImage(t,0,0),this._postDraw(t)}_preDraw(t,e,i){t.save(),t.translate(e,i),t.scale(Math.abs(this.scale.x),Math.abs(this.scale.y)),this._rotate(t),this._flip(t),t.opacity=t.opacity*this.opacity}_rotate(t){var e;const i=this.scale.x>0?1:-1,s=this.scale.y>0?1:-1,n=null!==(e=this.origin)&&void 0!==e?e:Q(this.width/2,this.height/2);t.translate(n.x,n.y),t.rotate(this.rotation),t.scale(i,s),t.translate(-n.x,-n.y)}_flip(t){this.flipHorizontal&&(t.translate(this.width/this.scale.x,0),t.scale(-1,1)),this.flipVertical&&(t.translate(0,this.height/this.scale.y),t.scale(1,-1))}_postDraw(t){this.showDebug&&t.debug.drawRect(0,0,this.width,this.height),t.restore()}}function Et(t,e){return t&&void 0===t.__isProxy?new Proxy(t,{set:(t,i,s)=>(t[i]!==s&&(t[i]=s,"string"==typeof i&&"_"!==i[0]&&e(t)),!0),get:(t,e)=>"__isProxy"===e||t[e]}):t}function Pt(t,e){return t&&void 0===t.__isProxy?new Proxy(t,{set:(t,i,s)=>(t[i]=s,"string"==typeof i&&"_"!==i[0]&&e(t),!0),get:(t,e)=>"__isProxy"===e||t[e]}):t}Ct._ID=0;class At extends Ct{constructor(t){var e,i,s,n,r,o,a;super(t),this._dirty=!0,this._smoothing=!1,this._color=Et(tt.Black,(()=>this.flagDirty())),this._lineWidth=1,this._lineDash=[],this._padding=0,t&&(this.color=null!==(e=t.color)&&void 0!==e?e:tt.Black,this.strokeColor=null==t?void 0:t.strokeColor,this.smoothing=null!==(i=t.smoothing)&&void 0!==i?i:this.smoothing,this.lineWidth=null!==(s=t.lineWidth)&&void 0!==s?s:this.lineWidth,this.lineDash=null!==(n=t.lineDash)&&void 0!==n?n:this.lineDash,this.padding=null!==(r=t.padding)&&void 0!==r?r:this.padding),this._bitmap=document.createElement("canvas");const l=null!==(o=null==t?void 0:t.width)&&void 0!==o?o:this._bitmap.width,h=null!==(a=null==t?void 0:t.height)&&void 0!==a?a:this._bitmap.height;this.width=_t(l),this.height=_t(h);const c=this._bitmap.getContext("2d");if(!c)throw new Error("Browser does not support 2d canvas drawing, cannot create Raster graphic");this._ctx=c}cloneRasterOptions(){return{color:this.color?this.color.clone():null,strokeColor:this.strokeColor?this.strokeColor.clone():null,smoothing:this.smoothing,lineWidth:this.lineWidth,lineDash:this.lineDash,padding:this.padding}}get dirty(){return this._dirty}flagDirty(){this._dirty=!0}get width(){return this._getTotalWidth()}set width(t){this._bitmap.width=t,this._originalWidth=t,this.flagDirty()}get height(){return this._getTotalHeight()}set height(t){this._bitmap.height=t,this._originalHeight=t,this.flagDirty()}_getTotalWidth(){var t;return(null!==(t=this._originalWidth)&&void 0!==t?t:this._bitmap.width)+2*this.padding}_getTotalHeight(){var t;return(null!==(t=this._originalHeight)&&void 0!==t?t:this._bitmap.height)+2*this.padding}get localBounds(){return it.fromDimension(this._getTotalWidth()*this.scale.x,this._getTotalHeight()*this.scale.y,Y.Zero)}get smoothing(){return this._smoothing}set smoothing(t){this._smoothing=t,this.flagDirty()}get color(){return this._color}set color(t){var e;(null===(e=this._color)||void 0===e?void 0:e.equal(t))||this.flagDirty(),this._color=Et(t,(()=>this.flagDirty()))}get strokeColor(){return this._strokeColor}set strokeColor(t){var e;(null===(e=this._strokeColor)||void 0===e?void 0:e.equal(t))||this.flagDirty(),this._strokeColor=Et(t,(()=>this.flagDirty()))}get lineWidth(){return this._lineWidth}set lineWidth(t){this._lineWidth=t,this.flagDirty()}get lineDash(){return this._lineDash}set lineDash(t){this._lineDash=t,this.flagDirty()}get padding(){return this._padding}set padding(t){this._padding=t,this.flagDirty()}rasterize(){this._dirty=!1,this._ctx.clearRect(0,0,this._getTotalWidth(),this._getTotalHeight()),this._ctx.save(),this._applyRasterProperites(this._ctx),this.execute(this._ctx),this._ctx.restore(),wt.load(this._bitmap,!0)}_applyRasterProperites(t){var e,i,s;this._bitmap.width=this._getTotalWidth(),this._bitmap.height=this._getTotalHeight(),t.translate(this.padding,this.padding),t.imageSmoothingEnabled=this.smoothing,t.lineWidth=this.lineWidth,t.setLineDash(null!==(e=this.lineDash)&&void 0!==e?e:t.getLineDash()),t.strokeStyle=null===(i=this.strokeColor)||void 0===i?void 0:i.toString(),t.fillStyle=null===(s=this.color)||void 0===s?void 0:s.toString()}_drawImage(t,e,i){this._dirty&&this.rasterize(),t.drawImage(this._bitmap,e,i)}}class kt extends At{constructor(t){super(t),this._options=t}get ctx(){return this._ctx}clone(){return new kt(Object.assign(Object.assign(Object.assign({},this._options),this.cloneGraphicOptions()),this.cloneRasterOptions()))}execute(t){var e,i;(null===(e=this._options)||void 0===e?void 0:e.draw)&&(null===(i=this._options)||void 0===i||i.draw(t)),this._options.cache||this.flagDirty()}}var Tt,Rt;(Rt=Tt||(Tt={})).Kill="kill",Rt.PreKill="prekill",Rt.PostKill="postkill",Rt.PreDraw="predraw",Rt.PostDraw="postdraw",Rt.PreDebugDraw="predebugdraw",Rt.PostDebugDraw="postdebugdraw",Rt.PreUpdate="preupdate",Rt.PostUpdate="postupdate",Rt.PreFrame="preframe",Rt.PostFrame="postframe",Rt.PreCollision="precollision",Rt.CollisionStart="collisionstart",Rt.CollisionEnd="collisionend",Rt.PostCollision="postcollision",Rt.Initialize="initialize",Rt.Activate="activate",Rt.Deactivate="deactivate",Rt.ExitViewport="exitviewport",Rt.EnterViewport="enterviewport",Rt.ExitTrigger="exit",Rt.EnterTrigger="enter",Rt.Connect="connect",Rt.Disconnect="disconnect",Rt.Button="button",Rt.Axis="axis",Rt.Subscribe="subscribe",Rt.Unsubscribe="unsubscribe",Rt.Visible="visible",Rt.Hidden="hidden",Rt.Start="start",Rt.Stop="stop",Rt.PointerUp="pointerup",Rt.PointerDown="pointerdown",Rt.PointerMove="pointermove",Rt.PointerEnter="pointerenter",Rt.PointerLeave="pointerleave",Rt.PointerCancel="pointercancel",Rt.PointerWheel="pointerwheel",Rt.Up="up",Rt.Down="down",Rt.Move="move",Rt.Enter="enter",Rt.Leave="leave",Rt.Cancel="cancel",Rt.Wheel="wheel",Rt.Press="press",Rt.Release="release",Rt.Hold="hold",Rt.PointerDragStart="pointerdragstart",Rt.PointerDragEnd="pointerdragend",Rt.PointerDragEnter="pointerdragenter",Rt.PointerDragLeave="pointerdragleave",Rt.PointerDragMove="pointerdragmove";class Mt{constructor(){this._bubbles=!0}get bubbles(){return this._bubbles}set bubbles(t){this._bubbles=t}stopPropagation(){this.bubbles=!1}}class Dt extends Mt{constructor(t){super(),this.target=t}}class Lt extends Mt{constructor(t){super(),this.target=t}}class Bt extends Mt{constructor(t){super(),this.target=t}}class It extends Mt{constructor(t){super(),this.target=t}}class Ft extends Mt{constructor(t){super(),this.target=t}}class zt extends Mt{constructor(t,e,i){super(),this.ctx=t,this.delta=e,this.target=i}}class Nt extends Mt{constructor(t,e,i){super(),this.ctx=t,this.delta=e,this.target=i}}class Ot extends Mt{constructor(t,e){super(),this.ctx=t,this.target=e}}class Ut extends Mt{constructor(t,e){super(),this.ctx=t,this.target=e}}class Ht extends Mt{constructor(t,e,i){super(),this.engine=t,this.delta=e,this.target=i}}class Wt extends Mt{constructor(t,e,i){super(),this.engine=t,this.delta=e,this.target=i}}class jt extends Mt{constructor(t,e){super(),this.engine=t,this.prevStats=e,this.target=t}}class Vt extends Mt{constructor(t,e){super(),this.engine=t,this.stats=e,this.target=t}}class qt extends Mt{constructor(t,e){super(),this.index=t,this.gamepad=e,this.target=e}}class Xt extends Mt{constructor(t,e){super(),this.index=t,this.gamepad=e,this.target=e}}class Gt extends Mt{constructor(t,e,i){super(),this.button=t,this.value=e,this.target=i}}class Kt extends Mt{constructor(t,e,i){super(),this.axis=t,this.value=e,this.target=i}}class Yt extends Mt{constructor(t,e){super(),this.topic=t,this.handler=e}}class Qt extends Mt{constructor(t,e){super(),this.topic=t,this.handler=e}}class Zt extends Mt{constructor(t){super(),this.target=t}}class $t extends Mt{constructor(t){super(),this.target=t}}class Jt extends Mt{constructor(t,e,i,s){super(),this.other=e,this.side=i,this.intersection=s,this.target=t}}class te extends Mt{constructor(t,e,i,s){super(),this.other=e,this.side=i,this.intersection=s,this.target=t}get actor(){return this.target}set actor(t){this.target=t}}class ee{constructor(t,e,i){this.target=t,this.other=e,this.contact=i}}class ie{constructor(t,e){this.target=t,this.other=e}}class se{constructor(t,e,i,s,n){this.target=t,this.other=e,this.side=i,this.intersection=s,this.contact=n}}class ne{constructor(t,e,i,s,n){this.target=t,this.other=e,this.side=i,this.intersection=s,this.contact=n}}class re extends Mt{constructor(t,e,i){super(),this.other=e,this.contact=i,this.target=t}get actor(){return this.target}set actor(t){this.target=t}}class oe extends Mt{constructor(t,e){super(),this.other=e,this.target=t}get actor(){return this.target}set actor(t){this.target=t}}class ae extends Mt{constructor(t,e){super(),this.engine=t,this.target=e}}class le extends Mt{constructor(t,e){super(),this.oldScene=t,this.target=e}}class he extends Mt{constructor(t,e){super(),this.newScene=t,this.target=e}}class ce extends Mt{constructor(t){super(),this.target=t}}class de extends Mt{constructor(t){super(),this.target=t}}class ue extends Mt{constructor(t,e){super(),this.target=t,this.actor=e}}class pe extends Mt{constructor(t,e){super(),this.target=t,this.actor=e}}class ge{constructor(t){this._handlers={},this._wiredEventDispatchers=[],this._target=t}clear(){this._handlers={},this._wiredEventDispatchers=[]}emit(t,e){if(!t)return;t=t.toLowerCase();const i=this._target;e||(e=new Mt);try{e.target||(e.target=i)}catch(t){}let s,n;if(this._handlers[t])for(s=0,n=this._handlers[t].length;s<n;s++)this._handlers[t][s].call(i,e);for(s=0,n=this._wiredEventDispatchers.length;s<n;s++)this._wiredEventDispatchers[s].emit(t,e)}on(t,e){t=t.toLowerCase(),this._handlers[t]||(this._handlers[t]=[]),this._handlers[t].push(e),"unsubscribe"!==t&&"subscribe"!==t&&this.emit("subscribe",new Yt(t,e))}off(t,e){t=t.toLowerCase();const i=this._handlers[t];if(i)if(e){const s=i.indexOf(e);this._handlers[t].splice(s,1)}else this._handlers[t].length=0;"unsubscribe"!==t&&"subscribe"!==t&&this.emit("unsubscribe",new Qt(t,e))}once(t,e){this.on(t,(i=>{const s=i||new Mt;try{s.target=s.target||this._target}catch(t){}this.off(t,e),e.call(s.target,s)}))}wire(t){t._wiredEventDispatchers.push(this)}unwire(t){const e=t._wiredEventDispatchers.indexOf(this);e>-1&&t._wiredEventDispatchers.splice(e,1)}}class fe{constructor(t,e,i=!0){this.path=t,this.responseType=e,this.bustCache=i,this.data=null,this.logger=y.getInstance(),this.events=new ge(this)}isLoaded(){return null!==this.data}_cacheBust(t){return/\?\w*=\w*/.test(t)?t+="&__="+Date.now():t+="?__="+Date.now(),t}load(){return new Promise(((t,e)=>{if(null!==this.data)return this.logger.debug("Already have data for resource",this.path),this.events.emit("complete",this.data),void t(this.data);const i=new XMLHttpRequest;i.open("GET",this.bustCache?this._cacheBust(this.path):this.path,!0),i.responseType=this.responseType,i.addEventListener("loadstart",(t=>this.events.emit("loadstart",t))),i.addEventListener("progress",(t=>this.events.emit("progress",t))),i.addEventListener("error",(t=>this.events.emit("error",t))),i.addEventListener("load",(t=>this.events.emit("load",t))),i.addEventListener("load",(()=>{if(0!==i.status&&200!==i.status)return this.logger.error("Failed to load resource ",this.path," server responded with error code",i.status),this.events.emit("error",i.response),void e(new Error(i.statusText));this.data=i.response,this.events.emit("complete",this.data),this.logger.debug("Completed loading resource",this.path),t(this.data)})),i.send()}))}}var me=function(t,e,i,s){var n,r=arguments.length,o=r<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,s);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(o=(r<3?n(o):r>3?n(e,i,o):n(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};let ye=class{updatePixel(t,e,i){const s=4*(t+e*i.width),n=i.data,r=(n[s+0]+n[s+1]+n[s+2])/3;n[s+0]=r,n[s+1]=r,n[s+2]=r}};ye=me([K({message:"Grayscale will be removed in v0.26.0"})],ye);let _e=class{updatePixel(t,e,i){const s=4*(t+e*i.width),n=i.data;n[s+0]=255-n[s+0],n[s+1]=255-n[s+1],n[s+2]=255-n[s+2]}};_e=me([K({message:"Invert will be removed in v0.26.0"})],_e);let we=class{constructor(t){this.opacity=t}updatePixel(t,e,i){const s=4*(t+e*i.width),n=i.data;0!==n[s+3]&&(n[s+3]=Math.round(this.opacity*n[s+3]))}};we=me([K({message:"Opacity will be removed in v0.26.0"})],we);let ve=class{constructor(t){this.color=t}updatePixel(t,e,i){const s=4*(t+e*i.width),n=i.data;0!==n[s+3]&&(n[s+0]=(n[s+0]+this.color.r)/2,n[s+1]=(n[s+1]+this.color.g)/2,n[s+2]=(n[s+2]+this.color.b)/2)}};ve=me([K({message:"Colorize will be removed in v0.26.0"})],ve);let xe=class{constructor(t=.1){this.factor=t}updatePixel(t,e,i){const s=4*(t+e*i.width),n=i.data,r=tt.fromRGB(n[s+0],n[s+1],n[s+2],n[s+3]).lighten(this.factor);n[s+0]=r.r,n[s+1]=r.g,n[s+2]=r.b,n[s+3]=r.a}};xe=me([K({message:"Lighten will be removed in v0.26.0"})],xe);let be=class{constructor(t=.1){this.factor=t}updatePixel(t,e,i){const s=4*(t+e*i.width),n=i.data,r=tt.fromRGB(n[s+0],n[s+1],n[s+2],n[s+3]).darken(this.factor);n[s+0]=r.r,n[s+1]=r.g,n[s+2]=r.b,n[s+3]=r.a}};be=me([K({message:"Darken will be removed v0.26.0"})],be);let Se=class{constructor(t=.1){this.factor=t}updatePixel(t,e,i){const s=4*(t+e*i.width),n=i.data,r=tt.fromRGB(n[s+0],n[s+1],n[s+2],n[s+3]).saturate(this.factor);n[s+0]=r.r,n[s+1]=r.g,n[s+2]=r.b,n[s+3]=r.a}};Se=me([K({message:"Saturate will be removed in v0.26.0"})],Se);let Ce=class{constructor(t=.1){this.factor=t}updatePixel(t,e,i){const s=4*(t+e*i.width),n=i.data,r=tt.fromRGB(n[s+0],n[s+1],n[s+2],n[s+3]).desaturate(this.factor);n[s+0]=r.r,n[s+1]=r.g,n[s+2]=r.b,n[s+3]=r.a}};Ce=me([K({message:"Desaturate will be removed in v0.26.0"})],Ce);let Ee=class{constructor(t){this.color=t}updatePixel(t,e,i){const s=4*(t+e*i.width),n=i.data;0!==n[s+3]&&(n[s+0]=this.color.r,n[s+1]=this.color.g,n[s+2]=this.color.b)}};Ee=me([K({message:"Fill will be removed in v0.26.0"})],Ee);var Pe=function(t,e,i,s){return new(i||(i=Promise))((function(n,r){function o(t){try{l(s.next(t))}catch(t){r(t)}}function a(t){try{l(s.throw(t))}catch(t){r(t)}}function l(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}l((s=s.apply(t,e||[])).next())}))};class Ae{constructor(t,e=!0){this.path=t,this.bustCache=e,this._sprite=null,this.loaded=new Promise((t=>{this._loadedResolve=t})),this._resource=new fe(t,"blob",e),this._sprite=new Me(this,0,0,0,0)}get image(){return this.data}isLoaded(){return!!this.data}load(){return Pe(this,void 0,void 0,(function*(){try{let t;if(this.path.includes("data:image/"))t=this.path;else{const e=yield this._resource.load();t=URL.createObjectURL(e)}const e=new Image;e.src=t,yield e.decode(),this.data=e,this.width=this._sprite.width=e.naturalWidth,this.height=this._sprite.height=e.naturalHeight,this._sprite=new Me(this,0,0,this.width,this.height)}catch(t){yield Promise.reject("Error loading texture")}return this._loadedResolve(this.data),this.data}))}asSprite(){return this._sprite}}function ke(t){return class extends t{assign(t){for(const e in t)"function"!=typeof this[e]&&(this[e]=t[e])}constructor(...t){super(...t);1!==t.filter((function(t){return void 0!==t})).length||!t[0]||"object"!=typeof t[0]||t[0]instanceof Array||this.assign(t[0])}}}var Te=function(t,e,i,s){return new(i||(i=Promise))((function(n,r){function o(t){try{l(s.next(t))}catch(t){r(t)}}function a(t){try{l(s.throw(t))}catch(t){r(t)}}function l(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}l((s=s.apply(t,e||[])).next())}))};class Re{constructor(t,e,i,s,n){this.x=0,this.y=0,this.rotation=0,this.anchor=Y.Half,this.offset=Y.Zero,this.scale=Y.One,this.drawAroundAnchor=!1,this.logger=y.getInstance(),this.flipVertical=!1,this.flipHorizontal=!1,this.effects=[],this.width=0,this.height=0,this._spriteCanvas=null,this._spriteCtx=null,this._pixelData=null,this._pixelsLoaded=!1,this._dirtyEffect=!0,this._opacity=1;let r=t;if(t&&!(t instanceof Ae)&&(e=0|t.x,i=0|t.y,s=0|t.width,n=0|t.height,r=t.image,!r)){throw new Error("An image texture is required to construct a sprite")}this.x=e||0,this.y=i||0,this.texture=r,this._spriteCanvas=document.createElement("canvas"),this._spriteCanvas.width=s,this._spriteCanvas.height=n,this._spriteCtx=this._spriteCanvas.getContext("2d"),this._initPixelsFromTexture(),this.width=s,this.height=n}get drawWidth(){return Math.abs(this.width*this.scale.x)}get drawHeight(){return Math.abs(this.height*this.scale.y)}_initPixelsFromTexture(){return Te(this,void 0,void 0,(function*(){try{const t=yield this.texture.loaded;this.width=this.width||t.naturalWidth,this.height=this.height||t.naturalHeight,this._spriteCanvas.width=this._spriteCanvas.width||t.naturalWidth,this._spriteCanvas.height=this._spriteCanvas.height||t.naturalHeight,this._loadPixels(),this._dirtyEffect=!0}catch(t){this.logger.error("Error loading texture ",this.texture.path,t)}}))}_loadPixels(){if(this.texture.isLoaded()&&!this._pixelsLoaded){const t=this.texture.image.naturalWidth||0,e=this.texture.image.naturalHeight||0;if(this.width>t&&this.logger.warn(`The sprite width ${this.width} exceeds the width \n                              ${t} of the backing texture ${this.texture.path}`),this.width<=0||t<=0)throw new Error(`The width of a sprite cannot be 0 or negative, sprite width: ${this.width}, original width: ${t}`);if(this.height>e&&this.logger.warn(`The sprite height ${this.height} exceeds the height \n                              ${e} of the backing texture ${this.texture.path}`),this.height<=0||e<=0)throw new Error(`The height of a sprite cannot be 0 or negative, sprite height: ${this.height}, original height: ${e}`);this._flushTexture(),this._pixelsLoaded=!0}}_flushTexture(){const t=this.texture.image.naturalWidth||0,e=this.texture.image.naturalHeight||0;this._spriteCtx.clearRect(0,0,this.width,this.height),this._spriteCtx.drawImage(this.texture.image,k(this.x,0,t),k(this.y,0,e),k(this.width,0,t),k(this.height,0,e),0,0,this.width,this.height)}opacity(t){this._opacity=t}grayscale(){this.addEffect(new ye)}invert(){this.addEffect(new _e)}fill(t){this.addEffect(new Ee(t))}colorize(t){this.addEffect(new ve(t))}lighten(t=.1){this.addEffect(new xe(t))}darken(t=.1){this.addEffect(new be(t))}saturate(t=.1){this.addEffect(new Se(t))}desaturate(t=.1){this.addEffect(new Ce(t))}addEffect(t){this.effects.push(t),this.texture.isLoaded()&&this._pixelsLoaded?this._applyEffects():this._dirtyEffect=!0}removeEffect(t){let e=-1;e="number"==typeof t?t:this.effects.indexOf(t),e<0||e>=this.effects.length||(this.effects.splice(e,1),this.texture.isLoaded()&&this._pixelsLoaded?this._applyEffects():this._dirtyEffect=!0)}_applyEffects(){if(this._flushTexture(),this.effects.length>0){this._pixelData=this._spriteCtx.getImageData(0,0,this.width,this.height);const t=this.effects.length;for(let e=0;e<t;e++)for(let t=0;t<this.height;t++)for(let i=0;i<this.width;i++)this.effects[e].updatePixel(i,t,this._pixelData);this._spriteCtx.clearRect(0,0,this.width,this.height),this._spriteCtx.putImageData(this._pixelData,0,0)}this._dirtyEffect=!1}clearEffects(){this.effects.length=0,this._applyEffects()}reset(){}debugDraw(t,e,i){t.save(),t.translate(e,i),t.rotate(this.rotation);const s=this.drawWidth*this.anchor.x,n=this.drawHeight*this.anchor.y;t.strokeStyle=tt.Black.toString(),t.strokeRect(-s,-n,this.drawWidth,this.drawHeight),t.restore()}draw(t,e,i){t instanceof CanvasRenderingContext2D?this._drawWithOptions({ctx:t,x:e,y:i}):this._drawWithOptions(t)}_drawWithOptions(t){var e,i,s,n,r,o,a,l,h;const{ctx:c,x:d,y:u,rotation:p,drawWidth:g,drawHeight:f,anchor:m,offset:y,opacity:_,flipHorizontal:w,flipVertical:v}=Object.assign(Object.assign({},t),{rotation:null!==(e=t.rotation)&&void 0!==e?e:this.rotation,drawWidth:null!==(i=t.drawWidth)&&void 0!==i?i:this.width,drawHeight:null!==(s=t.drawHeight)&&void 0!==s?s:this.height,flipHorizontal:null!==(n=t.flipHorizontal)&&void 0!==n?n:this.flipHorizontal,flipVertical:null!==(r=t.flipVertical)&&void 0!==r?r:this.flipVertical,anchor:null!==(o=t.anchor)&&void 0!==o?o:this.anchor,offset:null!==(a=t.offset)&&void 0!==a?a:this.offset,opacity:(null!==(l=t.opacity)&&void 0!==l?l:1)*(null!==(h=this._opacity)&&void 0!==h?h:1)});this._dirtyEffect&&this._applyEffects();const x=g*m.x+y.x,b=f*m.y+y.y,S=this.scale.x>0?1:-1,C=this.scale.y>0?1:-1;c.save(),c.translate(d,u),c.scale(Math.abs(this.scale.x),Math.abs(this.scale.y)),this.drawAroundAnchor&&c.translate(-x,-b),c.translate(x,b),c.rotate(p),c.scale(S,C),c.translate(-x,-b),w&&(c.translate(g,0),c.scale(-1,1)),v&&(c.translate(0,f),c.scale(1,-1));const E=c.globalAlpha;c.globalAlpha=_,c.drawImage(this._spriteCanvas,0,0,this.width,this.height,0,0,this.width,this.height),c.globalAlpha=E,c.restore()}clone(){const t=new Me(this.texture,this.x,this.y,this.width,this.height);t.anchor=this.anchor.clone(),t.scale=this.scale.clone(),t.rotation=this.rotation,t.flipHorizontal=this.flipHorizontal,t.flipVertical=this.flipVertical;const e=this.effects.length;for(let i=0;i<e;i++)t.addEffect(this.effects[i]);return t}}let Me=class extends(ke(Re)){constructor(t,e,i,s,n){super(t,e,i,s,n)}};Me=function(t,e,i,s){var n,r=arguments.length,o=r<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,s);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(o=(r<3?n(o):r>3?n(e,i,o):n(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o}([K({message:"Label.clearTextShadow will be removed in v0.26.0",alternateMethod:"Use Label.font.shadow"})],Me);class De extends Ct{constructor(t){var e,i;super(t),this.image=t.image;const{width:s,height:n}=t;this.sourceView=null!==(e=t.sourceView)&&void 0!==e?e:{x:0,y:0,width:null!=s?s:0,height:null!=n?n:0},this.destSize=null!==(i=t.destSize)&&void 0!==i?i:{width:null!=s?s:0,height:null!=n?n:0},this._updateSpriteDimensions(),this.image.ready.then((()=>{this._updateSpriteDimensions()}))}static from(t){return new De({image:t})}_updateSpriteDimensions(){var t,e,i,s,n,r;const{width:o,height:a}=this.image;this.sourceView.width=(null===(t=this.sourceView)||void 0===t?void 0:t.width)||o,this.sourceView.height=(null===(e=this.sourceView)||void 0===e?void 0:e.height)||a,this.destSize.width=(null===(i=this.destSize)||void 0===i?void 0:i.width)||(null===(s=this.sourceView)||void 0===s?void 0:s.width)||o,this.destSize.height=(null===(n=this.destSize)||void 0===n?void 0:n.height)||(null===(r=this.sourceView)||void 0===r?void 0:r.height)||a,this.width=Math.ceil(this.destSize.width),this.height=Math.ceil(this.destSize.height)}_preDraw(t,e,i){this.image.isLoaded()&&this._updateSpriteDimensions(),super._preDraw(t,e,i)}_drawImage(t,e,i){this.image.isLoaded()&&(this._updateSpriteDimensions(),t.drawImage(this.image.image,this.sourceView.x,this.sourceView.y,this.sourceView.width,this.sourceView.height,e,i,this.destSize.width,this.destSize.height))}static fromLegacySprite(t){const e=t.texture,i=Be.fromLegacyTexture(e);return new De({image:i,sourceView:{x:t.x,y:t.y,width:t.width,height:t.height}})}static toLegacySprite(t){const e=t.image,i=new Ae(e.path);return i.data=e.image,new Me(i,t.sourceView.x,t.sourceView.y,t.sourceView.width,t.sourceView.height)}clone(){return new De(Object.assign({image:this.image,sourceView:Object.assign({},this.sourceView),destSize:Object.assign({},this.destSize)},this.cloneGraphicOptions()))}}var Le=function(t,e,i,s){return new(i||(i=Promise))((function(n,r){function o(t){try{l(s.next(t))}catch(t){r(t)}}function a(t){try{l(s.throw(t))}catch(t){r(t)}}function l(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}l((s=s.apply(t,e||[])).next())}))};class Be{constructor(t,e=!1){this.path=t,this._logger=y.getInstance(),this.data=new Image,this._resource=new fe(t,"blob",e),(t.endsWith(".svg")||t.endsWith(".gif"))&&this._logger.warn(`Image type is not fully supported, you may have mixed results ${t}. Fully supported: jpg, bmp, and png`),this.ready=new Promise((t=>{this._loadedResolve=t}))}get width(){return this.image.naturalWidth}get height(){return this.image.naturalHeight}isLoaded(){return!!this.data.src}get image(){return this.data}load(){return Le(this,void 0,void 0,(function*(){if(this.isLoaded())return this.data;try{let t;if(this.path.includes("data:image/"))t=this.path;else{const e=yield this._resource.load();t=URL.createObjectURL(e)}const e=new Image;e.src=t,yield e.decode(),this.data=e}catch(t){throw`Error loading ImageSource from path '${this.path}' with error [${t.message}]`}return this._loadedResolve(this.data),this.data}))}toSprite(){return De.from(this)}static fromLegacyTexture(t){const e=new Be(t.path);return t.isLoaded()?e.data=t.data:t.loaded.then((()=>{e.data=t.data})),e}unload(){this.data=new Image}}class Ie{constructor(t,e,i,s){this.sprites=[],this.currentFrame=0,this._timeLeftInFrame=0,this._idempotencyToken=-1,this.anchor=Y.Zero,this.rotation=0,this.scale=Y.One,this.loop=!0,this.freezeFrame=-1,this.flipVertical=!1,this.flipHorizontal=!1,this.drawWidth=0,this.drawHeight=0,this.width=0,this.height=0,this._opacity=1;let n=t;if(t&&!(t instanceof Ur)){const r=t;n=r.engine,e=r.sprites,i=r.speed,s=r.loop}this.sprites=e,this.speed=i,this._engine=n,this._timeLeftInFrame=this.speed,null!=s&&(this.loop=s),e&&e[0]&&(this.drawHeight=e[0]?e[0].drawHeight:0,this.drawWidth=e[0]?e[0].drawWidth:0,this.width=e[0]?e[0].width:0,this.height=e[0]?e[0].height:0,this.freezeFrame=e.length-1)}opacity(t){this._opacity=t}grayscale(){this.addEffect(new ye)}invert(){this.addEffect(new _e)}fill(t){this.addEffect(new Ee(t))}colorize(t){this.addEffect(new ve(t))}lighten(t=.1){this.addEffect(new xe(t))}darken(t=.1){this.addEffect(new be(t))}saturate(t=.1){this.addEffect(new Se(t))}desaturate(t=.1){this.addEffect(new Ce(t))}addEffect(t){for(const e in this.sprites)this.sprites[e].addEffect(t)}removeEffect(t){for(const e in this.sprites)this.sprites[e].removeEffect(t)}clearEffects(){for(const t in this.sprites)this.sprites[t].clearEffects()}_setAnchor(t){for(const e in this.sprites)this.sprites[e].anchor.setTo(t.x,t.y)}_setRotation(t){for(const e in this.sprites)this.sprites[e].rotation=t}_setScale(t){for(const e in this.sprites)this.sprites[e].scale=t}reset(){this.currentFrame=0}isDone(){return!this.loop&&this.currentFrame>=this.sprites.length}tick(t,e){if(this._idempotencyToken===e)return;this._idempotencyToken=e,this._timeLeftInFrame-=t,this._timeLeftInFrame<=0&&(this.currentFrame=this.loop?(this.currentFrame+1)%this.sprites.length:this.currentFrame+1,this._timeLeftInFrame=this.speed),this._updateValues();const i=this.sprites[this.currentFrame];i&&(this.width=i.width,this.height=i.height,this.drawWidth=i.drawWidth,this.drawHeight=i.drawHeight)}_updateValues(){this._setAnchor(this.anchor),this._setRotation(this.rotation),this._setScale(this.scale)}skip(t){this.currentFrame=(this.currentFrame+t)%this.sprites.length}draw(t,e,i){t instanceof CanvasRenderingContext2D?this._drawWithOptions({ctx:t,x:e,y:i}):this._drawWithOptions(t)}_drawWithOptions(t){var e,i,s,n,r,o,a,l;const h=Object.assign(Object.assign({},t),{rotation:null!==(e=t.rotation)&&void 0!==e?e:this.rotation,drawWidth:null!==(i=t.drawWidth)&&void 0!==i?i:this.drawWidth,drawHeight:null!==(s=t.drawHeight)&&void 0!==s?s:this.drawHeight,flipHorizontal:null!==(n=t.flipHorizontal)&&void 0!==n?n:this.flipHorizontal,flipVertical:null!==(r=t.flipVertical)&&void 0!==r?r:this.flipVertical,anchor:null!==(o=t.anchor)&&void 0!==o?o:this.anchor,opacity:(null!==(a=t.opacity)&&void 0!==a?a:1)*(null!==(l=this._opacity)&&void 0!==l?l:1)});let c;this._updateValues(),this.currentFrame<this.sprites.length&&(c=this.sprites[this.currentFrame],c.draw(h)),-1!==this.freezeFrame&&this.currentFrame>=this.sprites.length&&(c=this.sprites[k(this.freezeFrame,0,this.sprites.length-1)],c.draw(h)),c&&(this.drawWidth=c.drawWidth,this.drawHeight=c.drawHeight)}play(t,e){this.reset(),this._engine.playAnimation(this,t,e)}}let Fe=class extends(ke(Ie)){constructor(t,e,i,s){super(t,e,i,s)}};var ze,Ne,Oe,Ue,He,We,je,Ve,qe,Xe;Fe=function(t,e,i,s){var n,r=arguments.length,o=r<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,s);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(o=(r<3?n(o):r>3?n(e,i,o):n(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o}([K({message:"Animation will be removed in v0.26.0",alternateMethod:"Use Graphics.Animation"})],Fe),(Ne=ze||(ze={})).Em="em",Ne.Rem="rem",Ne.Px="px",Ne.Pt="pt",Ne.Percent="%",(Ue=Oe||(Oe={})).Left="left",Ue.Right="right",Ue.Center="center",Ue.Start="start",Ue.End="end",(We=He||(He={})).Top="top",We.Hanging="hanging",We.Middle="middle",We.Alphabetic="alphabetic",We.Ideographic="ideographic",We.Bottom="bottom",(Ve=je||(je={})).Normal="normal",Ve.Italic="italic",Ve.Oblique="oblique",(Xe=qe||(qe={})).LeftToRight="ltr",Xe.RightToLeft="rtl";class Ge{constructor(t,e,i,s,n,r){this._sprites=[],this._image=null,this._columns=0,this._rows=0,this._spWidth=0,this._spHeight=0,this._spacing=0;let o=!1;if(t instanceof Array?this._sprites=t:(!t||t instanceof Ae?(this._image=t,this._columns=e,this._rows=i,this._spWidth=s,this._spHeight=n,this._spacing=r||0):(this._columns=t.columns,this._rows=t.rows,this._spWidth=t.spWidth,this._spHeight=t.spHeight,this._image=t.image,this._spacing=t.spacing||0),this._sprites=new Array(this._columns*this._rows),o=!0),this.image instanceof Ae){let t=!1,e=!1;if(this.image.isLoaded()){if(t=this.spWidth*this.columns>this.image.image.naturalWidth,e=this.spHeight*this.rows>this.image.image.naturalHeight,t)throw new RangeError(`SpriteSheet specified is wider, ${this.columns} cols x ${this.spWidth} pixels > ${this.image.image.naturalWidth} pixels than image width`);if(e)throw new RangeError(`SpriteSheet specified is taller, ${this.rows} rows x ${this.spHeight} pixels > ${this.image.image.naturalHeight} pixels than image height`)}}if(o){const t=this.getSpacingDimensions();for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this._sprites[i+e*this.columns]=new Me(this.image,i*this.spWidth+t.margin*i+t.left,e*this.spHeight+t.margin*e+t.top,this.spWidth,this.spHeight)}}get spacing(){return this._spacing}get sprites(){return[...this._sprites]}get image(){return this._image}get columns(){return this._columns}get rows(){return this._rows}get spWidth(){return this._spWidth}get spHeight(){return this._spHeight}getSpacingDimensions(){var t,e,i;return"number"==typeof this.spacing?{left:this.spacing,top:this.spacing,margin:this.spacing}:{left:null!==(t=this.spacing.left)&&void 0!==t?t:0,top:null!==(e=this.spacing.top)&&void 0!==e?e:0,margin:null!==(i=this.spacing.margin)&&void 0!==i?i:0}}getAnimationByIndices(t,e,i){let s=e.map((t=>this.sprites[t]));return s=s.map((function(t){return t.clone()})),new Fe(t,s,i)}getAnimationBetween(t,e,i,s){let n=this.sprites.slice(e,i);return n=n.map((function(t){return t.clone()})),new Fe(t,n,s)}getAnimationForAll(t,e){const i=this.sprites.map((function(t){return t.clone()}));return new Fe(t,i,e)}getSprite(t){if(t>=0&&t<this.sprites.length)return this.sprites[t];throw new Error("Invalid index: "+t)}getAnimationByCoords(t,e,i){let s=0,n=0;const r=new Array(e.length);for(let t=0;t<e.length;t++){const i=e[t];i.image=i.image||this.image,s=Math.max(s,i.drawWidth),n=Math.max(n,i.drawHeight),r[t]=new Me(i)}const o=new Fe(t,r,i);return o.drawWidth=s,o.drawHeight=n,o}}let Ke=class extends Ge{constructor(t,e,i,s,n,r,o,a){super(t instanceof Ae?{image:t,spWidth:r,spHeight:o,rows:n,columns:s,spacing:a||0}:t),this._currentColor=tt.Black,this._currentOpacity=1,this._spriteRecord={},this._textShadowOn=!1,this._textShadowDirty=!0,this._textShadowColor=tt.Black,this._textShadowSprites={},this._shadowOffsetX=5,this._shadowOffsetY=5,!t||t instanceof Ae||(e=t.alphabet,i=t.caseInsensitive),this.alphabet=e,this.caseInsensitive=i,this._spriteRecord=this.getTextSprites()}getTextSprites(){const t={};for(let e=0;e<this.alphabet.length;e++){let i=this.alphabet[e];this.caseInsensitive&&(i=i.toLowerCase()),t[i]=this.sprites[e].clone()}return t}setTextShadow(t,e,i){this._textShadowOn=!0,this._shadowOffsetX=t,this._shadowOffsetY=e,this._textShadowColor=i.clone(),this._textShadowDirty=!0;for(const t in this._spriteRecord)this._textShadowSprites[t]=this._spriteRecord[t].clone()}useTextShadow(t){this._textShadowOn=t,t&&this.setTextShadow(5,5,this._textShadowColor)}draw(t,e,i,s,n){if(n=this._parseOptions(n),this._currentColor.toString()!==n.color.toString()||this._currentOpacity!==n.opacity){this._currentOpacity=n.opacity,this._currentColor=n.color;for(const t in this._spriteRecord)this._spriteRecord[t].clearEffects(),this._spriteRecord[t].fill(n.color),this._spriteRecord[t].opacity(n.opacity)}if(this._textShadowOn&&this._textShadowDirty&&this._textShadowColor){for(const t in this._textShadowSprites)this._textShadowSprites[t].clearEffects(),this._textShadowSprites[t].addEffect(new Ee(this._textShadowColor.clone()));this._textShadowDirty=!1}const r=this.sprites[0],o=r.height,a=n.fontSize/o,l=e.length*r.width*a+e.length*n.letterSpacing;let h=i;n.textAlign===Oe.Left||n.textAlign===Oe.Start?h=i:n.textAlign===Oe.Right||n.textAlign===Oe.End?h=i-l:n.textAlign===Oe.Center&&(h=i-l/2);let c=s-o*a;n.baseAlign===He.Top||n.baseAlign===He.Hanging?c=s:n.baseAlign===He.Ideographic||n.baseAlign===He.Bottom||n.baseAlign===He.Alphabetic?c=s-o*a:n.baseAlign===He.Middle&&(c=s-o*a/2);for(let i=0;i<e.length;i++){let s=e[i];this.caseInsensitive&&(s=s.toLowerCase());try{this._textShadowOn&&(this._textShadowSprites[s].drawAroundAnchor=!1,this._textShadowSprites[s].scale=Q(a,a),this._textShadowSprites[s].draw(t,h+this._shadowOffsetX,c+this._shadowOffsetY));const e=this._spriteRecord[s];e.drawAroundAnchor=!1,e.scale=Q(a,a),e.draw(t,h,c),h+=e.drawWidth+n.letterSpacing}catch(t){y.getInstance().error(`SpriteFont Error drawing char ${s}`)}}}_parseOptions(t){return{fontSize:t.fontSize||10,letterSpacing:t.letterSpacing||0,color:t.color||tt.Black,textAlign:(t.textAlign,t.textAlign),baseAlign:(t.baseAlign,t.baseAlign),maxWidth:t.maxWidth||-1,opacity:t.opacity||0}}};Ke=function(t,e,i,s){var n,r=arguments.length,o=r<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,s);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(o=(r<3?n(o):r>3?n(e,i,o):n(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o}([K({message:"SpriteSheet will be removed in v0.26.0",alternateMethod:"Use Graphics.SpriteSheet"})],Ke);class Ye{constructor(t){this._logger=y.getInstance(),this.sprites=[];const{sprites:e,rows:i,columns:s}=t;this.sprites=e,this.rows=null!=i?i:1,this.columns=null!=s?s:this.sprites.length}getSprite(t,e){if(t>=this.columns||t<0)return this._logger.warn(`No sprite exists in the SpriteSheet at (${t}, ${e}), x: ${t} should be between 0 and ${this.columns-1}`),null;if(e>=this.rows||e<0)return this._logger.warn(`No sprite exists in the SpriteSheet at (${t}, ${e}), y: ${e} should be between 0 and ${this.rows-1}`),null;const i=t+e*this.columns;return this.sprites[i]}static fromLegacySpriteSheet(t){const e=t.sprites.map((t=>De.fromLegacySprite(t)));return new Ye({sprites:e})}static toLegacySpriteSheet(t){const e=t.sprites.map((t=>De.toLegacySprite(t)));return new Ge(e)}static fromImageSource(t){var e;const i=[];t.spacing=null!==(e=t.spacing)&&void 0!==e?e:{};const{image:s,grid:{rows:n,columns:r,spriteWidth:o,spriteHeight:a},spacing:{originOffset:l,margin:h}}=t,c=Object.assign({x:0,y:0},l),d=Object.assign({x:0,y:0},h);for(let t=0;t<r;t++)for(let e=0;e<n;e++)i[t+e*r]=new De({image:s,sourceView:{x:t*o+d.x*t+c.x,y:e*a+d.y*e+c.y,width:o,height:a},destSize:{height:a,width:o}});return new Ye({sprites:i,rows:n,columns:r})}}class Qe extends Ct{constructor(t){super(t),this._text="",this._dirty=!0,this.alphabet="",this.shadow=null,this.caseInsensitive=!1,this.spacing=0,this._logger=y.getInstance(),this._sprites=[];const{alphabet:e,spriteSheet:i,caseInsensitive:s,spacing:n,shadow:r}=t;this.alphabet=e,this.spriteSheet=i,this.caseInsensitive=null!=s?s:this.caseInsensitive,this.spacing=null!=n?n:this.spacing,this.shadow=null!=r?r:this.shadow,this.spriteSheet.sprites[0].image.ready.then((()=>{this._updateDimensions()}))}static fromLegacySpriteFont(t){const e=t.sprites.map(De.fromLegacySprite);return new Qe({alphabet:t.alphabet,spacing:0,caseInsensitive:t.caseInsensitive,spriteSheet:new Ye({sprites:e})})}_getCharacterSprites(t){if(!this._dirty)return this._sprites;const e=[],i=this.caseInsensitive?t.toLocaleLowerCase():t,s=this.caseInsensitive?this.alphabet.toLocaleLowerCase():this.alphabet;for(let t=0;t<i.length;t++){const n=i[t];let r=s.indexOf(n);-1===r&&(r=0,this._logger.warn(`SpriteFont - Cannot find letter '${n}' in configured alphabet '${s}'`));const o=this.spriteSheet.sprites[r];o?e.push(o):this._logger.warn(`SpriteFont - Cannot find sprite for '${n}' at index '${r}' in configured SpriteSheet`)}return this._dirty=!1,this._sprites=e}_updateDimensions(){const t=this._getCharacterSprites(this._text);let e=0,i=0;for(const s of t)e+=s.width+this.spacing,i=Math.max(i,s.height);this.width=e,this.height=i}updateText(t){this._text!==t&&(this._dirty=!0,this._text=t,this._updateDimensions())}_preDraw(t,e,i){this._updateDimensions(),super._preDraw(t,e,i)}_drawImage(t,e,i){let s=0;for(const n of this._getCharacterSprites(this._text))n.draw(t,e+s,i),s+=n.width+this.spacing}render(t,e,i,s){this._text!==e&&(this._dirty=!0,this._text=e),this.shadow&&(t.save(),t.translate(this.shadow.offset.x,this.shadow.offset.y),this.draw(t,i,s),t.restore()),this.draw(t,i,s)}clone(){return new Qe({alphabet:this.alphabet,spriteSheet:this.spriteSheet,spacing:this.spacing})}}class Ze{constructor(){this.fontSheet="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAAwCAYAAAD+f6R/AAAAAXNSR0IArs4c6QAABcJJREFUeJztnemu7CgMhGE07//KmT9NhrAFVzkQndQntXRP3/bCZkwCSQhCCCGEEEIIIYQQQog/TRz953Ecx/nDGIe/vdNhlc9tIz605Fk/ZmWfsO1hn9Gxuv1KHbvb3iL/VN+d1WORbyr7yR/5b9M4vjNeqko6jPJHq5wGHU151o9J2Udse9hndCxuv0rH7rY3yD/Wdyf13MrnQeDfkZIUSGKM4ff3cWN82pEZuTyQGX2IxeyR63va//8VNCYCq+1yEkLtWyagXv1P1r1H+110gP3PzT4gT8uW/mdQ8mUG8E9DqOz4MS9ICKGbXpS2BpnIrRzYeS96cll08INlCMl2/glzdcfazuuPqQO03lmqrBHsf272Q6NODXj6zzZIJd/LAHYTg3Mays5gBi7ZR27fOgs0yj8rm36DLMFiPgkAdXHKOwUQeMCQ/adSh/qBQrT/tPxbAwA9+DOZEILPAATSuHMgTv7+Auk/df2lHPCZLvMSLJe34LkEQ9PwXF1SRTllMYgvIaflqyVAjLGbsiCDcOK76jflxZ+sINPyROc5071yKWK5CJTV3dMp6+tBlyCtNlhAq/+XbWoBDcRNXYBMzD4VvQygSuPYC2jGGaSSOxXfy3dTUEsanIvNeepm38N/hssSALTPZnAXfwIYRJn2b7UBcw0FKX+nDdAMpm2j9WVnxrUa7TXaVAca/B+TgaAVh6R/rH0P/5m01dt/RLYViJn+w/bhVX2P7f/duqom5qb02pRLCLGIMgBU1wCEEN9BAUCID6MAIMSHUQAQ4sMoAAjxYRQAhPgwd1uB0fuZ7H3cnn2P+9mr/Pe4B8/eB/fwP4eRtci/0f6OfTCPt/9oHwC6G6y19RHZDumxmwzR4eE/s/2Tte/q/+XLdc9DeJ19diesQc/j7Z8fCe4tAS4CxZ7sp7eiJi7HiZmjmOTGJs+93CbS3nP0XIPH3vW8/qz6QPnX2QdsV/1uw/iZYvg8ACeHd28rpPzfNfhL+7vkw/4Ou9s+Onhbv91elpKZ48Dl6bzpwwibHigRArf+Ptk9+L3Y1Q5OB4LgCeSBw1iuB3GeJh1/HrX/zF0A9Mk+u45zMkc3r4rWPomma5+p/514LB+Zo93MErJ1JHxXPzByGa/licRYVKbpeQCoQ6Q8yxuCwJF9IPsoDkHAo/3Tx26cvA4EtJ/n04w8QOq/mrR7ddfLAC5BYFNlVI/0CnOVUflOpvJUQMx9AIMIW/nWDM67/qw0+95v9goBqD9j+72u/KD9U89IbnQbMIR2Zbneh5zUY7Hdk7XIP3UffVb+r+wDYAZLq+1n1+C7y3/ny2r7p5yeByDEh9HzAIQQJwoAQnwYBQAhPowCgBBjoNu3hNxSFACE6INuKvPajPZ4EFEAEKINcybGYzOd247WEd3TgA2jlmjEyrd+j9hvfVbD2PWQ3ZmGlu2HyO8og8eBuNUvNYWoDgMVpwHTJoLWdz1Y+ZYOy5uF7t6PPruZxANrud1lQXkP0jsGz/Yz+vGGMuygFyhSPcJnc1pMnQZElc+cRnoAlxdTvoDuK7puqF7uCQy+3fyFMiA02/vJQHh7DQDogMPTSGFNA56HTzbZ9yAfBOb1Zyo3qGM3MfMZ3f76huXf6xlmAHknMlLNXsBBBvbljIz9Uyz5Y5TzIBLR/qy/rNyrZ8+L/0BZ0m+tgXD0OK5XZxC/9P7I/g4hVFvzXf1/6i5A7+3AlijMPBLMZfCvuAp7A9rY56ApHitmLQc7c8bOv6ftAxlM9Xp35nkEK7nJetBsaMhtAAAuOLQGXwhh2dXQnn1rZ/a42BI3dL7L+jkFAbQddwdA9Ah35yMKhgEgVT46EFh5D4jz+OgavNKxeBCd1wDSJ/97oR8eoJkLi9t9/BDgDHTJ5NE7Dnzechh914OVv9M1K9PCqsfqb88XVg9qN9lm6nG176UPu+zn17GOxuO0vOWEEC/j+LFKTgghlvEfYJaLS+SA2O0AAAAASUVORK5CYII=",this.size=16,this.load()}load(){return this._imageSource=new Be(this.fontSheet),this._imageSource.load().then((()=>{this._spriteSheet=Ye.fromImageSource({image:this._imageSource,grid:{rows:3,columns:16,spriteWidth:16,spriteHeight:16}}),this._spriteFont=new Qe({alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ,!'&.\"?-()+ ",caseInsensitive:!0,spriteSheet:this._spriteSheet,spacing:-6})}))}write(t,e,i){this._imageSource.isLoaded()&&this._spriteFont.render(t,e,i.x,i.y)}}class $e{constructor(t){this._webglCtx=t,this._debugText=new Ze}drawRect(t,e,i,s,n={color:tt.Black}){this.drawLine(Q(t,e),Q(t+i,e),Object.assign({},n)),this.drawLine(Q(t+i,e),Q(t+i,e+s),Object.assign({},n)),this.drawLine(Q(t+i,e+s),Q(t,e+s),Object.assign({},n)),this.drawLine(Q(t,e+s),Q(t,e),Object.assign({},n))}drawLine(t,e,i={color:tt.Black}){this._webglCtx.__lineRenderer.addLine(t,e,i.color)}drawPoint(t,e={color:tt.Black,size:5}){this._webglCtx.__pointRenderer.addPoint(t,e.color,e.size)}drawText(t,e){this._debugText.write(this._webglCtx,t,e)}}class Je{constructor(t){this._transform=new rt,this._state=new ot,this.snapToPixel=!0,this.smoothing=!1,this.backgroundColor=tt.ExcaliburBlue,this.debug=new $e(this);const{canvasElement:e,enableTransparency:i,smoothing:s,snapToPixel:n,backgroundColor:r}=t;this.__gl=e.getContext("webgl",{antialias:null!=s?s:this.smoothing,premultipliedAlpha:!1,alpha:null==i||i,depth:!0,powerPreference:"high-performance"}),this.snapToPixel=null!=n?n:this.snapToPixel,this.smoothing=null!=s?s:this.smoothing,this.backgroundColor=null!=r?r:this.backgroundColor,this._init()}get opacity(){return this._state.current.opacity}set opacity(t){this._state.current.opacity=t}get width(){return this.__gl.canvas.width}get height(){return this.__gl.canvas.height}checkIfResolutionSupported(t){const e=this.__gl,i=e.getParameter(e.MAX_TEXTURE_SIZE)/4;let s=!0;return(t.width>i||t.height>i)&&(s=!1),s}_init(){const t=this.__gl;this._ortho=nt.ortho(0,t.canvas.width,t.canvas.height,0,400,-400),t.viewport(0,0,t.canvas.width,t.canvas.height),t.clearColor(this.backgroundColor.r/255,this.backgroundColor.g/255,this.backgroundColor.b/255,this.backgroundColor.a),t.clear(t.COLOR_BUFFER_BIT),t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA),this.__pointRenderer=new St(t,{matrix:this._ortho,transform:this._transform,state:this._state}),this.__lineRenderer=new pt(t,{matrix:this._ortho,transform:this._transform,state:this._state}),this.__imageRenderer=new xt(t,{matrix:this._ortho,transform:this._transform,state:this._state}),this._canvas=new kt({width:t.canvas.width,height:t.canvas.height}),this.__ctx=this._canvas.ctx}resetTransform(){this._transform.current=nt.identity()}updateViewport(){const t=this.__gl;this._ortho=this._ortho=nt.ortho(0,t.canvas.width,t.canvas.height,0,400,-400),this.__pointRenderer.shader.addUniformMatrix("u_matrix",this._ortho.data),this.__lineRenderer.shader.addUniformMatrix("u_matrix",this._ortho.data),this.__imageRenderer.shader.addUniformMatrix("u_matrix",this._ortho.data),this._canvas.width=t.canvas.width,this._canvas.height=t.canvas.height}drawImage(t,e,i,s,n,r,o,a,l){if(0!==s&&0!==n&&0!==a&&0!==l&&0!==t.width&&0!==t.height)return t?void this.__imageRenderer.addImage(t,e,i,s,n,r,o,a,l):(y.getInstance().warn("Cannot draw a null or undefined image"),void(console.trace&&console.trace()))}drawLine(t,e,i,s=1){this.__imageRenderer.addLine(i,t,e,s)}drawRectangle(t,e,i,s){this.__imageRenderer.addRectangle(s,t,e,i)}drawCircle(t,e,i){this.__imageRenderer.addCircle(t,e,i)}save(){this._transform.save(),this._state.save()}restore(){this._transform.restore(),this._state.restore()}translate(t,e){this._transform.translate(this.snapToPixel?~~t:t,this.snapToPixel?~~e:e)}rotate(t){this._transform.rotate(t)}scale(t,e){this._transform.scale(t,e)}transform(t){this._transform.current=t}clear(){const t=this.__gl;t.clearColor(this.backgroundColor.r/255,this.backgroundColor.g/255,this.backgroundColor.b/255,this.backgroundColor.a),t.clear(t.COLOR_BUFFER_BIT),ht.clear()}flush(){const t=this.__gl;t.viewport(0,0,t.canvas.width,t.canvas.height),this.__imageRenderer.render(),this.__lineRenderer.render(),this.__pointRenderer.render()}}var ti,ei;(ei=ti||(ti={})).Fixed="Fixed",ei.FitScreen="FitScreen",ei.FillScreen="FillScreen",ei.FitContainer="FitContainer",ei.FillContainer="FillContainer",ei.Position="Position";class ii{static get SVGA(){return{width:800,height:600}}static get Standard(){return{width:1920,height:1080}}static get Atari2600(){return{width:160,height:192}}static get GameBoy(){return{width:160,height:144}}static get GameBoyAdvance(){return{width:240,height:160}}static get NintendoDS(){return{width:256,height:192}}static get NES(){return{width:256,height:224}}static get SNES(){return{width:256,height:244}}}class si{constructor(t){var e,i,s;this._antialiasing=!0,this._resolutionStack=[],this._viewportStack=[],this._pixelRatioOverride=null,this._isFullScreen=!1,this._isDisposed=!1,this._logger=y.getInstance(),this._fullscreenChangeHandler=()=>{this._isFullScreen=!this._isFullScreen,this._logger.debug("Fullscreen Change",this._isFullScreen)},this._pixelRatioChangeHandler=()=>{this._logger.debug("Pixel Ratio Change",window.devicePixelRatio),this._devicePixelRatio=this._calculateDevicePixelRatio(),this.applyResolutionAndViewport()},this._resizeHandler=()=>{const t=this.parent;this._logger.debug("View port resized"),this._setResolutionAndViewportByDisplayMode(t),this.applyResolutionAndViewport()},this._devicePixelRatio=this._calculateDevicePixelRatio(),this._alreadyWarned=!1,this.viewport=t.viewport,this.resolution=null!==(e=t.resolution)&&void 0!==e?e:Object.assign({},this.viewport),this._displayMode=null!==(i=t.displayMode)&&void 0!==i?i:ti.Fixed,this._canvas=t.canvas,this._ctx=t.context,this._antialiasing=null!==(s=t.antialiasing)&&void 0!==s?s:this._antialiasing,this._browser=t.browser,this._position=t.position,this._pixelRatioOverride=t.pixelRatio,this._applyDisplayMode(),this._mediaQueryList=this._browser.window.nativeComponent.matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`),this._mediaQueryList.addEventListener("change",this._pixelRatioChangeHandler),this._canvas.addEventListener("fullscreenchange",this._fullscreenChangeHandler),this.applyResolutionAndViewport()}dispose(){this._isDisposed||(this._isDisposed=!0,this._browser.window.off("resize",this._resizeHandler),this._resizeObserver&&this._resizeObserver.disconnect(),this.parent.removeEventListener("resize",this._resizeHandler),this._mediaQueryList.removeEventListener("change",this._pixelRatioChangeHandler),this._canvas.removeEventListener("fullscreenchange",this._fullscreenChangeHandler))}_calculateDevicePixelRatio(){if(window.devicePixelRatio<1)return 1;return window.devicePixelRatio||1}get pixelRatio(){return this._pixelRatioOverride?this._pixelRatioOverride:this._devicePixelRatio}get isHiDpi(){return 1!==this.pixelRatio}get displayMode(){return this._displayMode}get canvas(){return this._canvas}get parent(){return this.displayMode===ti.FillContainer||this.displayMode===ti.FitContainer?this.canvas.parentElement||document.body:window}get resolution(){return this._resolution}set resolution(t){this._resolution=t}get viewport(){return this._viewport?this._viewport:this._resolution}set viewport(t){this._viewport=t}get aspectRatio(){return this._resolution.width/this._resolution.height}get scaledWidth(){return this._resolution.width*this.pixelRatio}get scaledHeight(){return this._resolution.height*this.pixelRatio}setCurrentCamera(t){this._camera=t}pushResolutionAndViewport(){this._resolutionStack.push(this.resolution),this._viewportStack.push(this.viewport),this.resolution=Object.assign({},this.resolution),this.viewport=Object.assign({},this.viewport)}peekViewport(){return this._viewportStack[this._viewportStack.length-1]}peekResolution(){return this._resolutionStack[this._resolutionStack.length-1]}popResolutionAndViewport(){this.resolution=this._resolutionStack.pop(),this.viewport=this._viewportStack.pop()}applyResolutionAndViewport(){if(this._canvas.width=this.scaledWidth,this._canvas.height=this.scaledHeight,this._ctx instanceof Je){this._ctx.checkIfResolutionSupported({width:this.scaledWidth,height:this.scaledHeight})||this._alreadyWarned||(this._alreadyWarned=!0,this._logger.warn(`The currently configured resolution (${this.resolution.width}x${this.resolution.height}) is too large for the platform WebGL implementation, this may work but cause WebGL rendering to behave oddly. Try reducing the resolution or disabling Hi DPI scaling to avoid this (read more here https://excaliburjs.com/docs/screens#understanding-viewport--resolution).`))}this._antialiasing?this._canvas.style.imageRendering="auto":(this._canvas.style.imageRendering="pixelated",""===this._canvas.style.imageRendering&&(this._canvas.style.imageRendering="crisp-edges")),this._canvas.style.width=this.viewport.width+"px",this._canvas.style.height=this.viewport.height+"px",this._ctx.updateViewport(),this._ctx.resetTransform(),this._ctx.scale(this.pixelRatio,this.pixelRatio),this._ctx.smoothing=this._antialiasing}get antialiasing(){return this._antialiasing}set antialiasing(t){this._antialiasing=t,this._ctx.smoothing=this._antialiasing}get isFullScreen(){return this._isFullScreen}goFullScreen(){return this._canvas.requestFullscreen()}exitFullScreen(){return document.exitFullscreen()}pageToScreenCoordinates(t){let e=t.x,i=t.y;if(this._isFullScreen||(e-=B(this._canvas).x,i-=B(this._canvas).y),this._isFullScreen)if(window.innerWidth/this.aspectRatio<window.innerHeight){const t=window.innerWidth/this.aspectRatio;i=(i-(window.innerHeight-t)/2)/t*this.viewport.height,e=e/window.innerWidth*this.viewport.width}else{const t=window.innerHeight*this.aspectRatio;e=(e-(window.innerWidth-t)/2)/t*this.viewport.width,i=i/window.innerHeight*this.viewport.height}return e=e/this.viewport.width*this.resolution.width,i=i/this.viewport.height*this.resolution.height,new Y(e,i)}screenToPageCoordinates(t){let e=t.x,i=t.y;if(e=e/this.resolution.width*this.viewport.width,i=i/this.resolution.height*this.viewport.height,this._isFullScreen)if(window.innerWidth/this.aspectRatio<window.innerHeight){const t=window.innerWidth/this.aspectRatio,s=(window.innerHeight-t)/2;i=i/this.viewport.height*t+s,e=e/this.viewport.width*window.innerWidth}else{const t=window.innerHeight*this.aspectRatio,s=(window.innerWidth-t)/2;e=e/this.viewport.width*t+s,i=i/this.viewport.height*window.innerHeight}return this._isFullScreen||(e+=B(this._canvas).x,i+=B(this._canvas).y),new Y(e,i)}screenToWorldCoordinates(t){var e,i,s,n;let r=t.x,o=t.y;return r=r/this.resolution.width*this.drawWidth,o=o/this.resolution.height*this.drawHeight,r-=this.halfDrawWidth,o-=this.halfDrawHeight,r+=null!==(i=null===(e=this._camera)||void 0===e?void 0:e.x)&&void 0!==i?i:0,o+=null!==(n=null===(s=this._camera)||void 0===s?void 0:s.y)&&void 0!==n?n:0,new Y(r,o)}worldToScreenCoordinates(t){var e,i,s,n;let r=t.x,o=t.y;return r-=null!==(i=null===(e=this._camera)||void 0===e?void 0:e.x)&&void 0!==i?i:0,o-=null!==(n=null===(s=this._camera)||void 0===s?void 0:s.y)&&void 0!==n?n:0,r+=this.halfDrawWidth,o+=this.halfDrawHeight,r=r/this.drawWidth*this.resolution.width,o=o/this.drawHeight*this.resolution.height,new Y(r,o)}pageToWorldCoordinates(t){const e=this.pageToScreenCoordinates(t);return this.screenToWorldCoordinates(e)}worldToPageCoordinates(t){const e=this.worldToScreenCoordinates(t);return this.screenToPageCoordinates(e)}getWorldBounds(){const t=this.screenToWorldCoordinates(Y.Zero).x,e=this.screenToWorldCoordinates(Y.Zero).y,i=t+this.drawWidth,s=e+this.drawHeight;return new it(t,e,i,s)}get canvasWidth(){return this.canvas.width}get halfCanvasWidth(){return this.canvas.width/2}get canvasHeight(){return this.canvas.height}get halfCanvasHeight(){return this.canvas.height/2}get drawWidth(){return this._camera?this.resolution.width/this._camera.zoom:this.resolution.width}get halfDrawWidth(){return this.drawWidth/2}get drawHeight(){return this._camera?this.resolution.height/this._camera.zoom:this.resolution.height}get halfDrawHeight(){return this.drawHeight/2}get center(){return Q(this.halfDrawWidth,this.halfDrawHeight)}_computeFit(){document.body.style.margin="0px",document.body.style.overflow="hidden";const t=this.aspectRatio;let e=0,i=0;window.innerWidth/t<window.innerHeight?(e=window.innerWidth,i=window.innerWidth/t):(e=window.innerHeight*t,i=window.innerHeight),this.viewport={width:e,height:i}}_computeFitContainer(){const t=this.aspectRatio;let e=0,i=0;const s=this.canvas.parentElement;s.clientWidth/t<s.clientHeight?(e=s.clientWidth,i=s.clientWidth/t):(e=s.clientHeight*t,i=s.clientHeight),this.viewport={width:e,height:i}}_applyDisplayMode(){this.displayMode===ti.Position?this._initializeDisplayModePosition(this._position):(this._setResolutionAndViewportByDisplayMode(this.parent),this.parent instanceof Window?this._browser.window.on("resize",this._resizeHandler):(this._resizeObserver=new ResizeObserver((()=>{this._resizeHandler()})),this._resizeObserver.observe(this.parent)),this.parent.addEventListener("resize",this._resizeHandler))}_setResolutionAndViewportByDisplayMode(t){this.displayMode===ti.FillContainer&&(this.resolution={width:t.clientWidth,height:t.clientHeight},this.viewport=this.resolution),this.displayMode===ti.FillScreen&&(document.body.style.margin="0px",document.body.style.overflow="hidden",this.resolution={width:t.innerWidth,height:t.innerHeight},this.viewport=this.resolution),this.displayMode===ti.FitScreen&&this._computeFit(),this.displayMode===ti.FitContainer&&this._computeFitContainer()}_initializeDisplayModePosition(t){if(!t)throw new Error("DisplayMode of Position was selected but no position option was given");if(this.canvas.style.display="block",this.canvas.style.position="absolute","string"==typeof t){const e=t.split(" ");switch(e[0]){case"top":this.canvas.style.top="0px";break;case"bottom":this.canvas.style.bottom="0px";break;case"middle":this.canvas.style.top="50%";const t=-this.halfDrawHeight;this.canvas.style.marginTop=t.toString();break;default:throw new Error("Invalid Position Given")}if(e[1])switch(e[1]){case"left":this.canvas.style.left="0px";break;case"right":this.canvas.style.right="0px";break;case"center":this.canvas.style.left="50%";const t=-this.halfDrawWidth;this.canvas.style.marginLeft=t.toString();break;default:throw new Error("Invalid Position Given")}}else t.top&&("number"==typeof t.top?this.canvas.style.top=t.top.toString()+"px":this.canvas.style.top=t.top),t.right&&("number"==typeof t.right?this.canvas.style.right=t.right.toString()+"px":this.canvas.style.right=t.right),t.bottom&&("number"==typeof t.bottom?this.canvas.style.bottom=t.bottom.toString()+"px":this.canvas.style.bottom=t.bottom),t.left&&("number"==typeof t.left?this.canvas.style.left=t.left.toString()+"px":this.canvas.style.left=t.left)}}class ni{static create(){return this._INSTANCE||(window.AudioContext||window.webkitAudioContext)&&(this._INSTANCE=new AudioContext),this._INSTANCE}}ni._INSTANCE=null;class ri{static unlock(){return new Promise(((t,e)=>{if(ri._UNLOCKED||!ni.create())return t(!0);const i=setTimeout((()=>{y.getInstance().warn("Excalibur was unable to unlock the audio context, audio probably will not play in this browser."),t(!1)}),200),s=ni.create();s.resume().then((()=>{const e=s.createBuffer(1,1,22050),n=s.createBufferSource();let r=!1;n.buffer=e,n.connect(s.destination),n.onended=()=>r=!0,n.start(0),setTimeout((()=>{!function(t){return!!t.playbackState}(n)?(s.currentTime>0||r)&&(ri._UNLOCKED=!0):n.playbackState!==n.PLAYING_STATE&&n.playbackState!==n.FINISHED_STATE||(ri._UNLOCKED=!0)}),0),clearTimeout(i),t(!0)}),(()=>{e()}))}))}static isUnlocked(){return this._UNLOCKED}}ri._UNLOCKED=!1;class oi{constructor(){this.eventDispatcher=new ge(this)}on(t,e){this.eventDispatcher.on(t,e)}off(t,e){this.eventDispatcher.off(t,e)}emit(t,e){this.eventDispatcher.emit(t,e)}once(t,e){this.eventDispatcher.once(t,e)}}function ai(t,e=tt.Red,i,s,n,r,o=1,a="butt"){t.beginPath(),t.lineWidth=o,t.lineCap=a,t.strokeStyle=e.toString(),t.moveTo(i,s),t.lineTo(n,r),t.closePath(),t.stroke()}function li(t,e=tt.Red,i){t.beginPath(),t.strokeStyle=e.toString(),t.arc(i.x,i.y,5,0,2*Math.PI),t.closePath(),t.stroke()}function hi(t,e,i,s,n=1){const r=e?e.toString():"blue",o=s.scale(n);t.beginPath(),t.strokeStyle=r,t.moveTo(i.x,i.y),t.lineTo(i.x+o.x,i.y+o.y),t.closePath(),t.stroke()}function ci(t,e,i,s,n,r=5,o=tt.White,a=null){let l;if("number"==typeof r)l={tl:r,tr:r,br:r,bl:r};else{const t={tl:0,tr:0,br:0,bl:0};for(const e in t)if(t.hasOwnProperty(e)){const i=e;l[i]=r[i]||t[i]}}t.beginPath(),t.moveTo(e+l.tl,i),t.lineTo(e+s-l.tr,i),t.quadraticCurveTo(e+s,i,e+s,i+l.tr),t.lineTo(e+s,i+n-l.br),t.quadraticCurveTo(e+s,i+n,e+s-l.br,i+n),t.lineTo(e+l.bl,i+n),t.quadraticCurveTo(e,i+n,e,i+n-l.bl),t.lineTo(e,i+l.tl),t.quadraticCurveTo(e,i,e+l.tl,i),t.closePath(),a&&(t.fillStyle=a.toString(),t.fill()),o&&(t.strokeStyle=o.toString(),t.stroke())}function di(t,e,i,s,n=tt.White,r=null){t.beginPath(),t.arc(e,i,s,0,2*Math.PI),t.closePath(),r&&(t.fillStyle=r.toString(),t.fill()),n&&(t.strokeStyle=n.toString(),t.stroke())}var ui=c(1388),pi=function(t,e,i,s){return new(i||(i=Promise))((function(n,r){function o(t){try{l(s.next(t))}catch(t){r(t)}}function a(t){try{l(s.throw(t))}catch(t){r(t)}}function l(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}l((s=s.apply(t,e||[])).next())}))};class gi extends oi{constructor(t){super(),this.canvas=new kt({smoothing:!0,draw:this.draw.bind(this)}),this._resourceList=[],this._index=0,this._playButtonShown=!1,this._resourceCount=0,this._numLoaded=0,this._progressCounts={},this._totalCounts={},this.logo="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAdQAAAB2CAYAAABxhGI9AAAACXBIWXMAAAsSAAALEgHS3X78AAAKnUlEQVR42u3dP2wjSx0H8N8hJIonIRmJjsq0SBR+BQ1dcqKhe0lD77SvSwpKkJKGPulpktfRIMUdEqKIqV57rpAokM4dbSiyq7ONPTP7x39ifz7SFbnEnp3xer47O7uzH15fXwMA6OYHmgAABCoACFQAEKgAgEAFAIEKAAIVAAQqACBQAUCgAoBABQCBCgAIVAAQqAAgUAFAoAIAAhUABCoACFQAEKgAgECFLbmOiNeFf2PbAyz68Pr6qhUgbRwR92v+/zwiJrYHMEKFMmcN///UtgcQqFBk1PD/97U9Qx8VCFSgu4EmAIEKAAIVAAQqACBQ4Z25jojP8eX+0WtNAgIVaOY+Im5j+eKh24h41jQgUIEyZ7F5NaPU7wCBCiwYd/w9cOB+qAlgJ3KLLow0EV198803RWvJfvfddx+0lhEqHKu5JgAjVCBvlhmFzjQRXUekHz9+TP79y8uLRjNChXfvoePvAYEKxNtj1e42/O5JoIJABcrdRMRVLM+X3kTEpaaB988cKuzWg9EobTWdMx0Oly8uN4dqhAoARqgnaN3arHfqu7OyH8ItKLVB/P+CEfMTHyGPY3npx1m8zWGDEeoBfUk/xdti57dr/r1Wv2+6EPow3tZ5rRdS72s1neuF97xvWd+XTH0/V+UMttDWqbI/r2nrxfp+jv2uSjSO7S+OXy/A/3lN+9xX5T5HxEUPZZ0tfB71+w57eJ/HFu+z+jkv1u92YX9fbI/HhX3JA9rp5MPr66tWaG9UfUGbrHIzi7cLUyYFf/tpTady03EEeL8mUJ6i7MKYNvWNqr4Pe2jradXO60LrvPAz2PQ5RPX684ah8dxD+2zantnCgVipSVV+m/tgB9W2DDq2Sx/vM95wcHhZhWVJm8yrv58cSgfTdc70+++/X/r522+/tUKSEepBqo+om4ZLPerMjUwuNnQCtx1GWJtee1FwdD5uWd86xLs8UaVt2aNEO1/saZ/Z5rYMW4zq6v34rGV9Bg3q2eZ9SkeNm9qwyUh30OPIHYFKx5FG03C7znSOqYBq+qW/zpQ3anH037TNHluG6f0WPsPhHvab4QFty7ogOeuxDYcNy2/zu2214WNYWxmBurNO8bGn97pNBOO8xy/9uCorZZ4I2r4C7aJgO7ZV9iE49Dm6NvOWx+pWE9CUq3zbdTp9doz38TbXtzqH9RT5CyWe422OaZoZGeZCabrhPQY9HjwsjpTvCg4YtlE2+Ta/j2bzn8fqrDqgm+6yUHOmAvWUjAtGhbNYvsBknDnqH1Qhc7VmxHgeb/NbudA5j/UXlYwif2p6luhAc9teu1npiHKnDs8if6tCm7JLX3NKpgttXe9ruc9mHMd7a83iwdxF5vt8tutARaCeklRnNK9C8WnNF7geJQ4T4XG3JhSnVdilQrG+yOnrlVHfsEGYzhNBn7Lu6tS7+HJafJQ4EMiNlNqWXZ9WPvVgnVYHG5M1ByDXkT6leX2EgTqJtyt45yv7S2qO3sEZjZhDLXeR+YKdJ0Zdk8QocvH9N732KrNtq+FZ/zzIHABcJrYpd+Xv14lOd5ap76SgrduW/VTQ1qcQpqnbgu4ifZvUMNpd9XuoZmvCtPaQ2Y/BCHVLgbrJTeRPDdVf6pfMKDU2fOkHmVFFfXr3MsouLsnNvV5kRoe5+s431PeuoKPqWnaurY/ZPBEeqwceN4l96iwO6H7Mjq4y7VGPVNe10VaZMzVCPVWpI/Z6FZbcv5fMqGCU+dLfFGzj58jP8+bCdJCo7yzKTwdOF0bu9Ug7V4c+yz7FJfYeGoysUss0HssIdVZwYLDujMqlESoCdTtGsZtbHnJBeNdDSJSs0jTKdMJN1HNX54Wv7bvsU9NkVJVa13dX+/wuArV0X/l5RHyo/lnfF4G6p6DrS0kHdtXhy35TGErDPYZUn2WfWqDOo/lVqdMD2O/hKJhD7S/odukymq9s02QN4EEPR/zbaOumZc+r15zK1Zqznl9jsfiemTM1QmV3HUuTkedlg9HIQzRbUD93dfC+2tpj2fIHEH2+RqCCQH13gZq7hWXTNpVu19OB1fc9nQ0AKOKUb5lU0P1kDyOneoWk0lOZ9cIP0x7qu8+2BhCoR2wYu1+e7DmaXzBSsu5vaX1ne2zrpmUPTmxf7PM1Dm4y/vC7ny7Nif7+z/9ZmtM0Z3panPLtPmra9f16bcK0Dpbnwk43Vd/RHtu6zfNQTy1QBy3aqG2g9nVmxml+BOoJyT3NpWmn9xhfFnu4bvDa+44BXhqqfdf3uUF9+yz77AT31Yue2mjecYQ62NLfgkA9ghHqLNEhNem4H1c6vdyDxhf/bpz5m4coW/c39wi6VH2bPtHlcaV9cvXts+zxCe6rTeqc2ndL7uGd93QwM9bFcAzMoZZ7SgTBbWx+asui61h/iq1+RmjqdbnQXQ3T1DNQ63V/U9ucqm/pMzPb1rePsk/1iTOjgvatR4W3Lc8ULB78pELyrnAfeTcj1NU509/86mfJ33/8+Mf00a05UyPUEw7UVCeWG/WNEiExyHRMt5ltW30izUPk18ytt7lNfc8i//DvtvXto+ySA5BjljsLUF8lPkqMPEtW1JomDsiGBZ9Byb4NAvUITSN9GuwsIj6t6UTOqk7jJREkmzqli8xIs96udSO20sX0H1vW92IL9e1a9rgqVyf91gbPsTy9UD9n9lOkT8k+RfkFR5PMNqxOcdSf32PBvg3vilO+zdxE+okx9Wm0ph36XYsRZCpMF993GOk5qvqB3Dct6jvssb67KvuUNJ3frw92bhr8/STSF0JdRPMLpUCgnsgo9S76PZ246ZFk1wWvK5m3vVoYvW1Sz7nN91jfXbQ1ZQc7TW6HeaoOalypG/8/p/rP1aNAc6ZHzSnfdqPUPhdy2PQw6Nz9gSVhuhiqueUHR3uu7y7K3rdDX4u46ZrPbUa0IFBZ0seKQ3XQTRt2vm3W/a2DbNKys++rvm3ep6+y1x2UdP3bWU9lzra47U1GmlctX/sQ23t+aOlByLTh/4NAPaCRxtcdO5HLSJ/6vNtCwGx67VPmPbvWd1q9frKHtp4kAqRJ2HR9j762JfX3bZ//elPtj13PPDx1+D5tqk/Xi6NO8SHz7MmH19dXrdBNfVFP6T2PT1UHNit87/t4m5+aRH+nQBdvqyhZDKJLfZs8h7XPsqdV2ZOV+tanKB8aln0dyxdAXbV4j4gvt4oMOrbP6vbU73NW7TMlbdTnPrWpfqXfh9HKZ9vke7KuTeZRNtXRSe6+1FV//ce/ln5eXfsXgcqXzr6+9261M3moOoa7E6nvTZTfy7iNsmfb7kjfgXGsvxe0vihsEts9HTquPpt1q1vtahu2TqAiUAEEKj0zhwoARqgAu/OnX/442WH+9xc/Wvr58re/Tr7f41/+ZsRqhAoACFQAEKgAcHjMoQJskJsz/eqrr5Z+vvr7v5fmQFevAl5lztQIFQAQqAAgUAHgIJlDBdhgdQ41N2eKESoAIFABQKACwFEwhwoARqgAIFABQKACAAIVAAQqAAhUABCoAIBABQCBCgACFQAEKgAgUAFAoAKAQAUAgQoACFQAEKgAIFABQKACAAIVAAQqAAhUABCoAIBABQCBCgACFQAQqAAgUAFAoAKAQAUAlvwPcFDns1DsH4sAAAAASUVORK5CYII=",this.logoWidth=468,this.logoHeight=118,this.loadingBarColor=tt.White,this.backgroundColor="#176BAA",this.suppressPlayButton=!1,this._playButtonStyles=ui.Z.toString(),this.playButtonText="Play game",this.startButtonFactory=()=>{let t=document.getElementById("excalibur-play");return t||(t=document.createElement("button")),t.id="excalibur-play",t.textContent=this.playButtonText,t.style.display="none",t},t&&this.addResources(t)}get _image(){return this._imageElement||(this._imageElement=new Image,this._imageElement.src=this.logo),this._imageElement}get playButtonRootElement(){return this._playButtonRootElement}get playButtonElement(){return this._playButtonElement}get _playButton(){const t=document.getElementById("excalibur-play-root");return t&&(this._playButtonRootElement=t),this._playButtonRootElement||(this._playButtonRootElement=document.createElement("div"),this._playButtonRootElement.id="excalibur-play-root",this._playButtonRootElement.style.position="absolute",document.body.appendChild(this._playButtonRootElement)),this._styleBlock||(this._styleBlock=document.createElement("style"),this._styleBlock.textContent=this._playButtonStyles,document.head.appendChild(this._styleBlock)),this._playButtonElement||(this._playButtonElement=this.startButtonFactory(),this._playButtonRootElement.appendChild(this._playButtonElement)),this._playButtonElement}wireEngine(t){this._engine=t,this.canvas.width=this._engine.canvas.width,this.canvas.height=this._engine.canvas.height}addResource(t){const e=this._index++;this._resourceList.push(t),this._progressCounts[e]=0,this._totalCounts[e]=1,this._resourceCount++}addResources(t){let e=0;const i=t.length;for(;e<i;e++)this.addResource(t[e])}isLoaded(){return this._numLoaded===this._resourceCount}showPlayButton(){var t;if(this.suppressPlayButton)return this.hidePlayButton(),Promise.resolve();{const e=()=>{this._positionPlayButton()};(null===(t=this._engine)||void 0===t?void 0:t.browser)&&this._engine.browser.window.on("resize",e),this._playButtonShown=!0,this._playButton.style.display="block",document.body.addEventListener("keyup",(t=>{"Enter"===t.key&&this._playButton.click()}));return new Promise((t=>{const i=i=>{var s;i.stopPropagation(),this.hidePlayButton(),(null===(s=this._engine)||void 0===s?void 0:s.browser)&&this._engine.browser.window.off("resize",e),t()};this._playButton.addEventListener("click",i),this._playButton.addEventListener("touchend",i),this._playButton.addEventListener("pointerup",i)}))}}hidePlayButton(){this._playButtonShown=!1,this._playButton.style.display="none"}dispose(){this._playButtonRootElement.parentElement&&(this._playButtonRootElement.removeChild(this._playButtonElement),document.body.removeChild(this._playButtonRootElement),document.head.removeChild(this._styleBlock),this._playButtonRootElement=null,this._playButtonElement=null,this._styleBlock=null)}update(t,e){}load(){return pi(this,void 0,void 0,(function*(){return yield Promise.all(this._resourceList.map((t=>t.load().finally((()=>{this._numLoaded++}))))),yield j(200),yield this.showPlayButton(),yield ri.unlock(),this.data=this._resourceList}))}markResourceComplete(){this._numLoaded++}get progress(){return this._resourceCount>0?k(this._numLoaded,0,this._resourceCount)/this._resourceCount:1}_positionPlayButton(){const t=this._engine.screen.viewport.height,e=this._engine.screen.viewport.width;if(this._playButtonRootElement){const i=this._engine.canvas.offsetLeft,s=this._engine.canvas.offsetTop,n=this._playButton.clientWidth,r=this._playButton.clientHeight;this.playButtonPosition?(this._playButtonRootElement.style.left=`${this.playButtonPosition.x}px`,this._playButtonRootElement.style.top=`${this.playButtonPosition.y}px`):(this._playButtonRootElement.style.left=i+e/2-n/2+"px",this._playButtonRootElement.style.top=s+t/2-r/2+100+"px")}}draw(t){const e=this._engine.canvasHeight/this._engine.pixelRatio,i=this._engine.canvasWidth/this._engine.pixelRatio;this._positionPlayButton(),t.fillStyle=this.backgroundColor,t.fillRect(0,0,i,e);let s=e/2;const n=Math.min(this.logoWidth,.75*i);let r=i/2-n/2;this.logoPosition&&(r=this.logoPosition.x,s=this.logoPosition.y);const o=Math.floor(n*(this.logoHeight/this.logoWidth)),a=this._engine.getAntialiasing();if(this._engine.setAntialiasing(!0),this.logoPosition?t.drawImage(this._image,0,0,this.logoWidth,this.logoHeight,r,s,n,o):t.drawImage(this._image,0,0,this.logoWidth,this.logoHeight,r,s-o-20,n,o),!this.suppressPlayButton&&this._playButtonShown)return void this._engine.setAntialiasing(a);let l=r,h=s;this.loadingBarPosition&&(l=this.loadingBarPosition.x,h=this.loadingBarPosition.y),t.lineWidth=2,ci(t,l,h,n,20,10,this.loadingBarColor);const c=n*this.progress-10;ci(t,l+5,h+5,c>10?c:10,10,5,null,this.loadingBarColor),this._engine.setAntialiasing(a)}}const fi={webgl:"WebGL",webaudio:"WebAudio",gamepadapi:"Gamepad API"};class mi{constructor(){this._features=null,this.failedTests=[],this._criticalTests={canvasSupport:function(){const t=document.createElement("canvas");return!(!t.getContext||!t.getContext("2d"))},arrayBufferSupport:function(){const t=new XMLHttpRequest;t.open("GET","/");try{t.responseType="arraybuffer"}catch(t){return!1}return"arraybuffer"===t.responseType},dataUrlSupport:function(){return 0===document.createElement("canvas").toDataURL("image/png").indexOf("data:image/png")},objectUrlSupport:function(){return"URL"in window&&"revokeObjectURL"in URL&&"createObjectURL"in URL},rgbaSupport:function(){const t=document.createElement("a").style;return t.cssText="background-color:rgba(150,255,150,.5)",(""+t.backgroundColor).indexOf("rgba")>-1}},this._warningTest={webAudioSupport:function(){return!!(window.AudioContext||window.webkitAudioContext||window.mozAudioContext||window.msAudioContext||window.oAudioContext)},webglSupport:function(){const t=document.createElement("canvas");return!(!t.getContext||!t.getContext("webgl"))}},this._features=this._loadBrowserFeatures()}getBrowserFeatures(){return null===this._features&&(this._features=this._loadBrowserFeatures()),this._features}logBrowserFeatures(){let t="%cSUPPORTED BROWSER FEATURES\n==========================%c\n";const e=["font-weight: bold; color: navy","font-weight: normal; color: inherit"],i=this.getBrowserFeatures();for(const s of Object.keys(fi))i[s]?(t+="(%c%c)",e.push("font-weight: bold; color: green"),e.push("font-weight: normal; color: inherit")):(t+="(%c%c)",e.push("font-weight: bold; color: red"),e.push("font-weight: normal; color: inherit")),t+=" "+fi[s]+"\n";e.unshift(t),console.log.apply(console,e)}_loadBrowserFeatures(){return{canvas:(()=>this._criticalTests.canvasSupport())(),arraybuffer:(()=>this._criticalTests.arrayBufferSupport())(),dataurl:(()=>this._criticalTests.dataUrlSupport())(),objecturl:(()=>this._criticalTests.objectUrlSupport())(),rgba:(()=>this._criticalTests.rgbaSupport())(),webaudio:(()=>this._warningTest.webAudioSupport())(),webgl:(()=>this._warningTest.webglSupport())(),gamepadapi:!!navigator.getGamepads}}test(){let t=!1;for(const e in this._criticalTests)this._criticalTests[e].call(this)||(this.failedTests.push(e),y.getInstance().error("Critical browser feature missing, Excalibur requires:",e),t=!0);if(t)return!1;for(const t in this._warningTest)this._warningTest[t]()||y.getInstance().warn("Warning browser feature missing, Excalibur will have reduced performance:",t);return!0}}var yi,_i;(_i=yi||(yi={})).PreventCollision="PreventCollision",_i.Passive="Passive",_i.Active="Active",_i.Fixed="Fixed";var wi,vi,xi,bi,Si,Ci;(vi=wi||(wi={})).Arcade="arcade",vi.Realistic="realistic",(bi=xi||(xi={}))[bi.DynamicAABBTree=0]="DynamicAABBTree",(Ci=Si||(Si={}))[Ci.Euler=0]="Euler";class Ei{static get gravity(){return Ei.acc}static set gravity(t){Ei.acc=t}static useArcadePhysics(){Ei.collisionResolutionStrategy=wi.Arcade}static useRealisticPhysics(){Ei.collisionResolutionStrategy=wi.Realistic}static get dynamicTreeVelocityMultiplyer(){return Ei.dynamicTreeVelocityMultiplier}static set dynamicTreeVelocityMultiplyer(t){Ei.dynamicTreeVelocityMultiplier=t}}Ei.acc=new Y(0,0),Ei.enabled=!0,Ei.broadphaseStrategy=xi.DynamicAABBTree,Ei.collisionResolutionStrategy=wi.Arcade,Ei.defaultMass=10,Ei.integrator=Si.Euler,Ei.dynamicTreeVelocityMultiplier=2,Ei.boundsPadding=5,Ei.positionIterations=3,Ei.velocityIterations=8,Ei.slop=1,Ei.steeringFactor=.2,Ei.warmStart=!0,Ei.bodiesCanSleepByDefault=!1,Ei.surfaceEpsilon=.1,Ei.sleepEpsilon=.07,Ei.wakeThreshold=3*Ei.sleepEpsilon,Ei.sleepBias=.9,Ei.checkForFastBodies=!0,Ei.disableMinimumSpeedForFastBody=!1,function(t,e,i,s){var n,r=arguments.length,o=r<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,s);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(o=(r<3?n(o):r>3?n(e,i,o):n(e,i))||o);r>3&&o&&Object.defineProperty(e,i,o)}([K({message:"Alias for incorrect spelling used in older versions, will be removed in v0.25.0",alternateMethod:"dynamicTreeVelocityMultiplier"})],Ei,"dynamicTreeVelocityMultiplyer",null);class Pi extends Y{constructor(t){super(0,0),this._getX=t.getX,this._getY=t.getY,this._setX=t.setX,this._setY=t.setY}get x(){return this._x=this._getX()}set x(t){this._setX(t),this._x=t}get y(){return this._y=this._getY()}set y(t){this._setY(t),this._y=t}}class Ai{constructor(){this.owner=null}clone(){const t=new this.constructor;for(const i in this)if(this.hasOwnProperty(i)){const s=this[i];(null==(e=s)?void 0:e.clone)&&"owner"!==i&&"clone"!==i?t[i]=s.clone():t[i]=s}var e;return t}}class ki extends Ai{constructor(t,e){super(),this.type=t,this.value=e}}var Ti,Ri;(Ri=Ti||(Ti={})).World="world",Ri.Screen="screen";class Mi extends Ai{constructor(){super(...arguments),this.type="ex.transform",this._dirty=!1,this.matrix=nt.identity().translate(0,0).rotate(0).scale(1,1),this._position=(t=>{const e=t;return new Pi({setX:t=>{e.data[Z.X]=t},setY:t=>{e.data[Z.Y]=t},getX:()=>e.data[Z.X],getY:()=>e.data[Z.Y]})})(this.matrix),this._rotation=0,this._scale=(t=>{const e=t;return new Pi({setX:t=>{e.setScaleX(t)},setY:t=>{e.setScaleY(t)},getX:()=>e.getScaleX(),getY:()=>e.getScaleY()})})(this.matrix),this.coordPlane=Ti.World,this.z=0}_recalculate(){this._rotation=this.matrix.getRotation(),this._dirty=!1}getGlobalMatrix(){return this.parent?this.parent.getGlobalMatrix().multm(this.matrix):this.matrix}getGlobalTransform(){return{pos:this.globalPos,scale:this.globalScale,rotation:this.globalRotation,z:this.z,coordPlane:this.coordPlane}}get parent(){var t,e;return null===(e=null===(t=null==this?void 0:this.owner)||void 0===t?void 0:t.parent)||void 0===e?void 0:e.get(Mi)}get pos(){return this._dirty&&this._recalculate(),this._position}set pos(t){this.matrix.setPosition(t.x,t.y),this._dirty=!0}get dirty(){var t;if(null===(t=null==this?void 0:this.owner)||void 0===t?void 0:t.parent){return this.parent.dirty||this._dirty}return this._dirty}get globalPos(){const t=this.getGlobalMatrix();return new Pi({getX:()=>t.data[Z.X],getY:()=>t.data[Z.Y],setX:e=>{var i;if(this.parent){const[s]=null===(i=this.parent)||void 0===i?void 0:i.getGlobalMatrix().getAffineInverse().multv([e,t.data[Z.Y]]);this.matrix.data[Z.X]=s}else this.matrix.data[Z.X]=e},setY:e=>{var i;if(this.parent){const[,s]=null===(i=this.parent)||void 0===i?void 0:i.getGlobalMatrix().getAffineInverse().multv([t.data[Z.X],e]);this.matrix.data[Z.Y]=s}else this.matrix.data[Z.Y]=e}})}set globalPos(t){const e=this.parent;this.pos=e?e.getGlobalMatrix().getAffineInverse().multv(t):t}get rotation(){return this._dirty&&this._recalculate(),this._rotation}set rotation(t){this.matrix.setRotation(t),this._dirty=!0}get globalRotation(){return this.getGlobalMatrix().getRotation()}set globalRotation(t){const e=this.parent;this.rotation=e?t-e.globalRotation:t}get scale(){return this._dirty&&this._recalculate(),this._scale}set scale(t){this.matrix.setScale(t),this._dirty=!0}get globalScale(){const t=this.getGlobalMatrix();return new Pi({getX:()=>t.getScaleX(),getY:()=>t.getScaleY(),setX:t=>{if(this.parent){const e=this.parent.globalScale.x;this.matrix.setScaleX(t/e)}else this.matrix.setScaleX(t)},setY:t=>{if(this.parent){const e=this.parent.globalScale.y;this.matrix.setScaleY(t/e)}else this.matrix.setScaleY(t)}})}set globalScale(t){const e=this.parent;this.scale=e?Q(t.x/e.globalScale.x,t.y/e.globalScale.y):t}apply(t){return this.matrix.multv(t)}applyInverse(t){return this.matrix.getAffineInverse().multv(t)}}class Di extends Ai{constructor(){super(...arguments),this.type="ex.motion",this.vel=Y.Zero,this.acc=Y.Zero,this.scaleFactor=Y.Zero,this.angularVelocity=0,this.torque=0,this.inertia=1}}class Li{constructor(t,e,i){this._name=t,this._category=e,this._mask=i}get name(){return this._name}get category(){return this._category}get mask(){return this._mask}canCollide(t){return 0!=(this.category&t.mask)&&0!=(t.category&this.mask)}invert(){return new Li("~("+this.name+")",~this.category,~this.mask)}static combine(t){const e=t.map((t=>t.name)).join("+"),i=t.reduce(((t,e)=>e.category|t),0);return new Li(e,i,~i)}static collidesWith(t){return Li.combine(t).invert()}}Li.All=new Li("Collide with all groups",-1,-1);class Bi{constructor(){this.observers=[],this.subscriptions=[]}register(t){this.observers.push(t)}subscribe(t){this.subscriptions.push(t)}unregister(t){const e=this.observers.indexOf(t);-1!==e&&this.observers.splice(e,1)}unsubscribe(t){const e=this.subscriptions.indexOf(t);-1!==e&&this.subscriptions.splice(e,1)}notifyAll(t){this.observers.forEach((e=>e.notify(t))),this.subscriptions.forEach((e=>e(t)))}clear(){this.observers.length=0,this.subscriptions.length=0}}class Ii{constructor(t,e){this.colliderA=t,this.colliderB=e,this.id=null,this.id=Ii.calculatePairHash(t.id,e.id)}static canCollide(t,e){var i,s;const n=null===(i=null==t?void 0:t.owner)||void 0===i?void 0:i.get(is),r=null===(s=null==e?void 0:e.owner)||void 0===s?void 0:s.get(is);return!(!n||!r)&&(!!n.group.canCollide(r.group)&&((n.collisionType!==yi.Fixed||r.collisionType!==yi.Fixed)&&(r.collisionType!==yi.PreventCollision&&n.collisionType!==yi.PreventCollision&&!(!n.active||!r.active))))}get canCollide(){const t=this.colliderA,e=this.colliderB;return Ii.canCollide(t,e)}collide(){return this.colliderA.collide(this.colliderB)}hasCollider(t){return t===this.colliderA||t===this.colliderB}static calculatePairHash(t,e){return t.value<e.value?`#${t.value}+${e.value}`:`#${e.value}+${t.value}`}}class Fi{constructor(t,e){this.min=t,this.max=e}overlaps(t){return this.max>t.min&&t.max>this.min}getOverlap(t){return this.overlaps(t)?this.max>t.max?t.max-this.min:this.max-t.min:0}}class zi{constructor(t){this.parent=t,this.parent=t||null,this.data=null,this.bounds=new it,this.left=null,this.right=null,this.height=0}isLeaf(){return!this.left&&!this.right}}class Ni{constructor(t=new it(-Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE)){this.worldBounds=t,this.root=null,this.nodes={}}_insert(t){if(null===this.root)return this.root=t,void(this.root.parent=null);const e=t.bounds;let i=this.root;for(;!i.isLeaf();){const t=i.left,s=i.right,n=i.bounds.getPerimeter(),r=i.bounds.combine(e).getPerimeter(),o=2*r,a=2*(r-n);let l=0;const h=e.combine(t.bounds);let c,d;t.isLeaf()?l=h.getPerimeter()+a:(d=t.bounds.getPerimeter(),c=h.getPerimeter(),l=c-d+a);let u=0;const p=e.combine(s.bounds);if(s.isLeaf()?u=p.getPerimeter()+a:(d=s.bounds.getPerimeter(),c=p.getPerimeter(),u=c-d+a),o<l&&o<u)break;i=l<u?t:s}const s=i.parent,n=new zi(s);n.bounds=e.combine(i.bounds),n.height=i.height+1,null!==s?(s.left===i?s.left=n:s.right=n,n.left=i,n.right=t,i.parent=n,t.parent=n):(n.left=i,n.right=t,i.parent=n,t.parent=n,this.root=n);let r=t.parent;for(;r;){if(r=this._balance(r),!r.left)throw new Error("Parent of current leaf cannot have a null left child"+r);if(!r.right)throw new Error("Parent of current leaf cannot have a null right child"+r);r.height=1+Math.max(r.left.height,r.right.height),r.bounds=r.left.bounds.combine(r.right.bounds),r=r.parent}}_remove(t){if(t===this.root)return void(this.root=null);const e=t.parent,i=e.parent;let s;if(s=e.left===t?e.right:e.left,i){i.left===e?i.left=s:i.right=s,s.parent=i;let t=i;for(;t;)t=this._balance(t),t.bounds=t.left.bounds.combine(t.right.bounds),t.height=1+Math.max(t.left.height,t.right.height),t=t.parent}else this.root=s,s.parent=null}trackCollider(t){const e=new zi;e.data=t,e.bounds=t.bounds,e.bounds.left-=2,e.bounds.top-=2,e.bounds.right+=2,e.bounds.bottom+=2,this.nodes[t.id.value]=e,this._insert(e)}updateCollider(t){var e;const i=this.nodes[t.id.value];if(!i)return!1;const s=t.bounds;if(!this.worldBounds.contains(s))return y.getInstance().warn("Collider with id "+t.id.value+" is outside the world bounds and will no longer be tracked for physics"),this.untrackCollider(t),!1;if(i.bounds.contains(s))return!1;if(this._remove(i),s.left-=Ei.boundsPadding,s.top-=Ei.boundsPadding,s.right+=Ei.boundsPadding,s.bottom+=Ei.boundsPadding,t.owner){const i=null===(e=t.owner)||void 0===e?void 0:e.get(is);if(i){const t=32*i.vel.x/1e3*Ei.dynamicTreeVelocityMultiplier,e=32*i.vel.y/1e3*Ei.dynamicTreeVelocityMultiplier;t<0?s.left+=t:s.right+=t,e<0?s.top+=e:s.bottom+=e}}return i.bounds=s,this._insert(i),!0}untrackCollider(t){const e=this.nodes[t.id.value];e&&(this._remove(e),this.nodes[t.id.value]=null,delete this.nodes[t.id.value])}_balance(t){if(null===t)throw new Error("Cannot balance at null node");if(t.isLeaf()||t.height<2)return t;const e=t.left,i=t.right,s=t,n=e,r=i,o=e.left,a=e.right,l=i.left,h=i.right,c=r.height-n.height;if(c>1)return r.left=s,r.parent=s.parent,s.parent=r,r.parent?r.parent.left===s?r.parent.left=r:r.parent.right=r:this.root=r,l.height>h.height?(r.right=l,s.right=h,h.parent=s,s.bounds=n.bounds.combine(h.bounds),r.bounds=s.bounds.combine(l.bounds),s.height=1+Math.max(n.height,h.height),r.height=1+Math.max(s.height,l.height)):(r.right=h,s.right=l,l.parent=s,s.bounds=n.bounds.combine(l.bounds),r.bounds=s.bounds.combine(h.bounds),s.height=1+Math.max(n.height,l.height),r.height=1+Math.max(s.height,h.height)),r;if(c<-1){if(n.left=s,n.parent=s.parent,s.parent=n,n.parent)if(n.parent.left===s)n.parent.left=n;else{if(n.parent.right!==s)throw"Error rotating Dynamic Tree";n.parent.right=n}else this.root=n;return o.height>a.height?(n.right=o,s.left=a,a.parent=s,s.bounds=r.bounds.combine(a.bounds),n.bounds=s.bounds.combine(o.bounds),s.height=1+Math.max(r.height,a.height),n.height=1+Math.max(s.height,o.height)):(n.right=a,s.left=o,o.parent=s,s.bounds=r.bounds.combine(o.bounds),n.bounds=s.bounds.combine(a.bounds),s.height=1+Math.max(r.height,o.height),n.height=1+Math.max(s.height,a.height)),n}return t}getHeight(){return null===this.root?0:this.root.height}query(t,e){const i=t.bounds,s=n=>{if(n&&n.bounds.intersect(i)){if(!n.isLeaf()||n.data===t)return s(n.left)||s(n.right);if(e.call(t,n.data))return!0}return!1};s(this.root)}rayCastQuery(t,e=1/0,i){const s=n=>{if(n&&n.bounds.rayCast(t,e)){if(!n.isLeaf())return s(n.left)||s(n.right);if(i.call(t,n.data))return!0}return!1};s(this.root)}getNodes(){const t=e=>e?[e].concat(t(e.left),t(e.right)):[];return t(this.root)}debug(t){const e=i=>{i&&(i.isLeaf()?i.bounds.draw(t,tt.Green):i.bounds.draw(t,tt.White),i.left&&e(i.left),i.right&&e(i.right))};e(this.root)}}class Oi{constructor(t,e){this.pos=t,this.dir=e.normalize()}intersect(t){const e=t.begin.sub(this.pos);if(0===this.dir.cross(t.getSlope())&&0!==e.cross(this.dir))return-1;const i=this.dir.cross(t.getSlope());if(0===i)return-1;const s=e.cross(t.getSlope())/i;if(s>=0){const n=e.cross(this.dir)/i/t.getLength();if(n>=0&&n<=1)return s}return-1}intersectPoint(t){const e=this.intersect(t);return e<0?null:this.getPoint(e)}getPoint(t){return this.pos.add(this.dir.scale(t))}}class Ui{constructor(){this._dynamicCollisionTree=new Ni,this._collisions=new Set,this._collisionPairCache=[],this._colliders=[]}getColliders(){return this._colliders}track(t){if(t)if(t instanceof Wi){const e=t.getColliders();for(const i of e)i.owner=t.owner,this._colliders.push(i),this._dynamicCollisionTree.trackCollider(i)}else this._colliders.push(t),this._dynamicCollisionTree.trackCollider(t);else y.getInstance().warn("Cannot track null collider")}untrack(t){if(t)if(t instanceof Wi){const e=t.getColliders();for(const t of e){const e=this._colliders.indexOf(t);-1!==e&&this._colliders.splice(e,1),this._dynamicCollisionTree.untrackCollider(t)}}else{const e=this._colliders.indexOf(t);-1!==e&&this._colliders.splice(e,1),this._dynamicCollisionTree.untrackCollider(t)}else y.getInstance().warn("Cannot untrack a null collider")}_shouldGenerateCollisionPair(t,e){if(null!==t.id&&null!==e.id&&t.id===e.id||null!==t.owner&&null!==e.owner&&t.owner===e.owner)return!1;const i=Ii.calculatePairHash(t.id,e.id);return!this._collisions.has(i)&&(!t.localBounds.hasZeroDimensions()&&!e.localBounds.hasZeroDimensions()&&Ii.canCollide(t,e))}broadphase(t,e,i){const s=e/1e3,n=t.filter((t=>{var e,i;const s=null===(e=t.owner)||void 0===e?void 0:e.get(is);return(null===(i=t.owner)||void 0===i?void 0:i.active)&&s.collisionType!==yi.PreventCollision}));let r;this._collisionPairCache=[],this._collisions.clear();for(let t=0,e=n.length;t<e;t++)r=n[t],this._dynamicCollisionTree.query(r,(t=>{if(this._shouldGenerateCollisionPair(r,t)){const e=new Ii(r,t);this._collisions.add(e.id),this._collisionPairCache.push(e)}return!1}));if(i&&(i.physics.pairs=this._collisionPairCache.length),Ei.checkForFastBodies)for(const t of n){const e=t.owner.get(is);if(e.collisionType!==yi.Active)continue;const n=e.vel.size*s+.5*e.acc.size*s*s,r=Math.min(t.bounds.height,t.bounds.width);if(Ei.disableMinimumSpeedForFastBody||n>r/2){i&&i.physics.fastBodies++;const s=e.pos.sub(e.oldPos),r=t.center,o=t.getFurthestPoint(e.vel),a=o.sub(s),l=new Oi(a,e.vel);let h;l.pos=l.pos.add(l.dir.scale(-2*Ei.surfaceEpsilon));let c=new Y(1/0,1/0);if(this._dynamicCollisionTree.rayCastQuery(l,n+2*Ei.surfaceEpsilon,(e=>{if(t!==e&&Ii.canCollide(t,e)){const t=e.rayCast(l,n+10*Ei.surfaceEpsilon);if(t){const i=t.sub(a);i.size<c.size&&(c=i,h=e)}}return!1})),h&&Y.isValid(c)){const s=new Ii(t,h);this._collisions.has(s.id)||(this._collisions.add(s.id),this._collisionPairCache.push(s));const n=r.sub(o);e.pos=a.add(n).add(c).add(l.dir.scale(10*Ei.surfaceEpsilon)),t.update(e.transform),i&&i.physics.fastBodyCollisions++}}}return this._collisionPairCache}narrowphase(t,e){let i=[];for(let s=0;s<t.length;s++){const n=t[s].collide();if(i=i.concat(n),e&&n.length>0)for(const t of n)e.physics.contacts.set(t.id,t)}return e&&(e.physics.collisions+=i.length),i}update(t){let e=0;const i=t.length;for(let s=0;s<i;s++)this._dynamicCollisionTree.updateCollider(t[s])&&e++;return e}debug(t){this._dynamicCollisionTree.debug(t)}}class Hi{constructor(){this.id=m("collider",Hi._ID++),this.events=new ge(this)}touching(t){return!!this.collide(t)}}Hi._ID=0;class Wi extends Hi{constructor(t){super(),this._collisionProcessor=new Ui,this._dynamicAABBTree=new Ni,this._colliders=[];for(const e of t)this.addCollider(e)}clearColliders(){this._colliders=[]}addCollider(t){this.events.wire(t.events),this._colliders.push(t),this._collisionProcessor.track(t),this._dynamicAABBTree.trackCollider(t)}removeCollider(t){this.events.unwire(t.events),F(t,this._colliders),this._collisionProcessor.untrack(t),this._dynamicAABBTree.untrackCollider(t)}getColliders(){return this._colliders}get worldPos(){var t,e;return null!==(e=null===(t=this._transform)||void 0===t?void 0:t.pos)&&void 0!==e?e:Y.Zero}get center(){var t,e;return null!==(e=null===(t=this._transform)||void 0===t?void 0:t.pos)&&void 0!==e?e:Y.Zero}get bounds(){var t,e;const i=this.getColliders();return i.reduce(((t,e)=>t.combine(e.bounds)),null!==(e=null===(t=i[0])||void 0===t?void 0:t.bounds)&&void 0!==e?e:(new it).translate(this.worldPos))}get localBounds(){var t,e;const i=this.getColliders();return i.reduce(((t,e)=>t.combine(e.localBounds)),null!==(e=null===(t=i[0])||void 0===t?void 0:t.localBounds)&&void 0!==e?e:new it)}get axes(){const t=this.getColliders();let e=[];for(const i of t)e=e.concat(i.axes);return e}getFurthestPoint(t){const e=this.getColliders(),i=[];for(const s of e)i.push(s.getFurthestPoint(t));let s=i[0],n=-Number.MAX_VALUE;for(const e of i){const i=e.dot(t);i>n&&(s=e,n=i)}return s}getInertia(t){const e=this.getColliders();let i=0;for(const s of e)i+=s.getInertia(t);return i}collide(t){let e=[t];t instanceof Wi&&(e=t.getColliders());const i=[];for(const t of e)this._dynamicAABBTree.query(t,(e=>(i.push(new Ii(t,e)),!1)));let s=[];for(const t of i)s=s.concat(t.collide());return s}getClosestLineBetween(t){const e=this.getColliders(),i=[];if(t instanceof Wi){const s=t.getColliders();for(const t of e)for(const e of s){const s=t.getClosestLineBetween(e);s&&i.push(s)}}else for(const s of e){const e=t.getClosestLineBetween(s);e&&i.push(e)}if(i.length){let t=i[0].getLength(),e=i[0];for(const s of i){const i=s.getLength();i<t&&(t=i,e=s)}return e}return null}contains(t){const e=this.getColliders();for(const i of e)if(i.contains(t))return!0;return!1}rayCast(t,e){const i=this.getColliders(),s=[];for(const n of i){const i=n.rayCast(t,e);i&&s.push(i)}if(s.length){let e=s[0],i=e.dot(t.dir);for(const n of s){const s=t.dir.dot(n);s<i&&(e=n,i=s)}return e}return null}project(t){const e=this.getColliders(),i=[];for(const s of e){const e=s.project(t);e&&i.push(e)}if(i.length){const t=new Fi(i[0].min,i[0].max);for(const e of i)t.min=Math.min(e.min,t.min),t.max=Math.max(e.max,t.max);return t}return null}update(t){if(t){const e=this.getColliders();for(const i of e)i.owner=this.owner,i.update(t)}}draw(t,e,i){const s=this.getColliders();for(const n of s)n.draw(t,e,i)}debug(t,e){const i=this.getColliders();for(const s of i)s.debug(t,e)}debugDraw(t,e){const i=this.getColliders();for(const s of i)s.draw(t,e)}clone(){return new Wi(this._colliders.map((t=>t.clone())))}}class ji{constructor(t,e){this.begin=t,this.end=e}get slope(){return(this.end.y-this.begin.y)/(this.end.x-this.begin.x)}get intercept(){return this.begin.y-this.slope*this.begin.x}normal(){return this.end.sub(this.begin).normal()}dir(){return this.end.sub(this.begin)}getPoints(){return[this.begin,this.end]}getSlope(){const t=this.begin,e=this.end,i=t.distance(e);return e.sub(t).scale(1/i)}getEdge(){const t=this.begin;return this.end.sub(t)}getLength(){const t=this.begin,e=this.end;return t.distance(e)}get midpoint(){return this.begin.add(this.end).scale(.5)}flip(){return new ji(this.end,this.begin)}below(t){return(this.end.x-this.begin.x)*(t.y-this.begin.y)-(this.end.y-this.begin.y)*(t.x-this.begin.x)>=0}clip(t,e){let i=t;i=i.normalize();const s=i.dot(this.begin)-e,n=i.dot(this.end)-e,r=[];if(s<=0&&r.push(this.begin),n<=0&&r.push(this.end),s*n<0){const t=s/(s-n);r.push(this.begin.add(this.end.sub(this.begin).scale(t)))}return 2!==r.length?null:new ji(r[0],r[1])}distanceToPoint(t,e=!1){const i=t.x,s=t.y,n=this.getLength(),r=((this.end.y-this.begin.y)*i-(this.end.x-this.begin.x)*s+this.end.x*this.begin.y-this.end.y*this.begin.x)/n;return e?r:Math.abs(r)}findVectorToPoint(t){const e=this.begin.sub(t),i=this.getSlope();return e.sub(i.scale(e.dot(i)))}findPoint(t=null,e=null){const i=this.slope,s=this.intercept;if(null!==t)return new Y(t,i*t+s);if(null!==e)return new Y((e-s)/i,e);throw new Error("You must provide an X or a Y value")}hasPoint(){let t,e=0;if("number"==typeof arguments[0]&&"number"==typeof arguments[1])t=new Y(arguments[0],arguments[1]),e=arguments[2]||0;else{if(!(arguments[0]instanceof Y))throw"Could not determine the arguments for Vector.hasPoint";t=arguments[0],e=arguments[1]||0}const i=t.x-this.begin.x,s=t.y-this.begin.y,n=this.end.x-this.begin.x,r=this.end.y-this.begin.y,o=i*r-s*n;return!(Math.abs(o)>e)&&(Math.abs(n)>=Math.abs(r)?n>0?this.begin.x<=t.x&&t.x<=this.end.x:this.end.x<=t.x&&t.x<=this.begin.x:r>0?this.begin.y<=t.y&&t.y<=this.end.y:this.end.y<=t.y&&t.y<=this.begin.y)}}function Vi(t,e,i,s){const n=t.sub(i),r=e.dot(e),o=e.dot(s),a=s.dot(s),l=e.dot(n),h=s.dot(n),c=r*a-o*o;let d=c,u=c;if(0===c||c<=.01){const e=l/o;return new ji(t,i.add(s.scale(e)))}let p=o*h-a*l,g=r*h-o*l;return p<0?(p=0,g=h,u=a):p>d&&(p=d,g=h+o,u=a),g<0?(g=0,-l<0?p=0:-l>r?p=d:(p=-l,d=r)):g>u&&(g=u,-l+o<0?p=0:-l+o>r?p=d:(p=-l+o,d=r)),p=Math.abs(p)<.001?0:p/d,g=Math.abs(g)<.001?0:g/u,new ji(t.add(e.scale(p)),i.add(s.scale(g)))}const qi={PolygonPolygonClosestLine(t,e){const i=e.worldPos,s=i.sub(t.worldPos),n=s.negate(),r=new Oi(t.worldPos,s),o=new Oi(i,n),a=t.rayCast(r).add(r.dir.scale(.1)),l=e.rayCast(o).add(o.dir.scale(.1)),h=t.getClosestFace(a),c=e.getClosestFace(l);return Vi(h.face.begin,h.face.getEdge(),c.face.begin,c.face.getEdge())},PolygonEdgeClosestLine(t,e){const i=e.worldPos.sub(t.worldPos),s=new Oi(t.worldPos,i),n=t.rayCast(s).add(s.dir.scale(.1)),r=t.getClosestFace(n),o=r.face.begin,a=r.face.getEdge(),l=e.asLine();return Vi(o,a,l.begin,l.getEdge())},PolygonCircleClosestLine(t,e){const i=e.worldPos,s=i.sub(t.worldPos),n=new Oi(t.worldPos,s.normalize()),r=t.rayCast(n).add(n.dir.scale(.1)),o=t.getClosestFace(r),a=o.face.begin,l=o.face.getEdge();let h=(l.x*(i.x-a.x)+l.y*(i.y-a.y))/(l.x*l.x+l.y*l.y);h>1?h=1:h<0&&(h=0);const c=Math.sqrt(Math.pow(a.x+l.x*h-i.x,2)+Math.pow(a.y+l.y*h-i.y,2))-e.radius,d=(a.x+l.x*h-i.x)*e.radius/(e.radius+c),u=(a.y+l.y*h-i.y)*e.radius/(e.radius+c);return new ji(l.scale(h).add(a),new Y(i.x+d,i.y+u))},CircleCircleClosestLine(t,e){const i=e.worldPos.sub(t.worldPos),s=t.worldPos.sub(e.worldPos),n=new Oi(t.worldPos,i),r=new Oi(e.worldPos,s),o=t.rayCast(n),a=e.rayCast(r);return new ji(o,a)},CircleEdgeClosestLine(t,e){const i=t.worldPos,s=e.asLine(),n=s.begin,r=s.getEdge();let o=(r.x*(i.x-n.x)+r.y*(i.y-n.y))/(r.x*r.x+r.y*r.y);o>1?o=1:o<0&&(o=0);const a=Math.sqrt(Math.pow(n.x+r.x*o-i.x,2)+Math.pow(n.y+r.y*o-i.y,2))-t.radius,l=(n.x+r.x*o-i.x)*t.radius/(t.radius+a),h=(n.y+r.y*o-i.y)*t.radius/(t.radius+a);return new ji(r.scale(o).add(n),new Y(i.x+l,i.y+h))},EdgeEdgeClosestLine(t,e){const i=t.asLine(),s=i.begin,n=i.getEdge(),r=e.asLine();return Vi(s,n,r.begin,r.getEdge())}};class Xi extends Hi{constructor(t){super(),this.offset=Y.Zero,this.offset=t.offset||Y.Zero,this.radius=t.radius||0}get worldPos(){var t,e;return this.offset.add(null!==(e=null===(t=this._transform)||void 0===t?void 0:t.pos)&&void 0!==e?e:Y.Zero)}clone(){return new Xi({offset:this.offset.clone(),radius:this.radius})}get center(){var t,e;return this.offset.add(null!==(e=null===(t=this._transform)||void 0===t?void 0:t.pos)&&void 0!==e?e:Y.Zero)}contains(t){var e,i;return(null!==(i=null===(e=this._transform)||void 0===e?void 0:e.pos)&&void 0!==i?i:this.offset).distance(t)<=this.radius}rayCast(t,e=1/0){const i=this.center,s=t.dir,n=t.pos,r=Math.sqrt(Math.pow(s.dot(n.sub(i)),2)-Math.pow(n.sub(i).distance(),2)+Math.pow(this.radius,2));if(r<0)return null;{let o=0;if(0===r)return o=-s.dot(n.sub(i)),o>0&&o<e?t.getPoint(o):null;{const o=-s.dot(n.sub(i))+r,a=-s.dot(n.sub(i))-r,l=[];o>=0&&l.push(o),a>=0&&l.push(a);const h=Math.min(...l);return h<=e?t.getPoint(h):null}}}getClosestLineBetween(t){if(t instanceof Xi)return qi.CircleCircleClosestLine(this,t);if(t instanceof Zi)return qi.PolygonCircleClosestLine(t,this).flip();if(t instanceof Qi)return qi.CircleEdgeClosestLine(this,t).flip();throw new Error("Polygon could not collide with unknown CollisionShape "+typeof t)}collide(t){if(t instanceof Xi)return Yi.CollideCircleCircle(this,t);if(t instanceof Zi)return Yi.CollideCirclePolygon(this,t);if(t instanceof Qi)return Yi.CollideCircleEdge(this,t);throw new Error("Circle could not collide with unknown CollisionShape "+typeof t)}getFurthestPoint(t){return this.center.add(t.normalize().scale(this.radius))}getFurthestLocalPoint(t){return t.normalize().scale(this.radius)}get bounds(){var t;const e=this._transform,i=null!==(t=null==e?void 0:e.globalPos)&&void 0!==t?t:Y.Zero;return new it(this.offset.x+i.x-this.radius,this.offset.y+i.y-this.radius,this.offset.x+i.x+this.radius,this.offset.y+i.y+this.radius)}get localBounds(){return new it(this.offset.x-this.radius,this.offset.y-this.radius,this.offset.x+this.radius,this.offset.y+this.radius)}get axes(){return[]}getInertia(t){return t*this.radius*this.radius/2}update(t){this._transform=t}project(t){const e=[],i=this.center.dot(t);return e.push(i),e.push(i+this.radius),e.push(i-this.radius),new Fi(Math.min.apply(Math,e),Math.max.apply(Math,e))}draw(t,e=tt.Green,i=Y.Zero){const s=i.add(this.offset);t.beginPath(),t.fillStyle=e.toString(),t.arc(s.x,s.y,this.radius,0,2*Math.PI),t.closePath(),t.fill()}debug(t,e){const i=this._transform,s=(null==i?void 0:i.globalPos)?null==i?void 0:i.globalPos.add(this.offset):this.offset;t.drawCircle(s,this.radius,e)}debugDraw(t,e=tt.Green){const i=this._transform,s=i?i.pos.add(this.offset):this.offset,n=i?i.rotation:0;t.beginPath(),t.strokeStyle=e.toString(),t.arc(s.x,s.y,this.radius,0,2*Math.PI),t.closePath(),t.stroke(),t.beginPath(),t.moveTo(s.x,s.y),t.lineTo(Math.cos(n)*this.radius+s.x,Math.sin(n)*this.radius+s.y),t.closePath(),t.stroke()}}class Gi{constructor(t,e,i,s,n,r,o,a){this._canceled=!1,this.colliderA=t,this.colliderB=e,this.mtv=i,this.normal=s,this.tangent=n,this.points=r,this.localPoints=o,this.info=a,this.id=Ii.calculatePairHash(t.id,e.id)}matchAwake(){const t=this.colliderA.owner.get(is),e=this.colliderB.owner.get(is);t&&e&&t.sleeping!==e.sleeping&&(t.sleeping&&t.collisionType!==yi.Fixed&&e.sleepMotion>=Ei.wakeThreshold&&t.setSleeping(!1),e.sleeping&&e.collisionType!==yi.Fixed&&t.sleepMotion>=Ei.wakeThreshold&&e.setSleeping(!1))}isCanceled(){return this._canceled}cancel(){this._canceled=!0}}class Ki{static findPolygonPolygonSeparation(t,e){let i=-Number.MAX_VALUE,s=null,n=null,r=-1,o=null;const a=t.getSides(),l=t.getLocalSides();for(let t=0;t<a.length;t++){const l=a[t],h=l.normal(),c=e.getFurthestPoint(h.negate()),d=l.distanceToPoint(c,!0);d>i&&(i=d,s=l,n=h,r=t,o=c)}return{collider:t,separation:n?i:99,axis:n,side:s,localSide:l[r],sideId:r,point:o,localPoint:n?e.getFurthestLocalPoint(n.negate()):null}}static findCirclePolygonSeparation(t,e){const i=e.axes,s=e.center.sub(t.worldPos),n=e.getFurthestPoint(s.negate());i.push(n.sub(t.worldPos).normalize());let r=Number.MAX_VALUE,o=null,a=-1;for(let s=0;s<i.length;s++){const n=e.project(i[s]),l=t.project(i[s]),h=n.getOverlap(l);if(h<=0)return null;h<r&&(r=h,o=i[s],a=s)}return a<0?null:o.normalize().scale(r)}}const Yi={CollideCircleCircle(t,e){const i=t.worldPos,s=e.worldPos,n=t.radius+e.radius,r=i.distance(s);if(r>n)return[];const o=n-r,a=s.sub(i).normalize(),l=a.perpendicular(),h=a.scale(o),c=t.getFurthestPoint(a),d=t.getFurthestLocalPoint(a);return[new Gi(t,e,h,a,l,[c],[d],{collider:t,separation:o,axis:a,point:c})]},CollideCirclePolygon(t,e){var i,s;let n=Ki.findCirclePolygonSeparation(t,e);if(!n)return[];const r=n.dot(e.center.sub(t.center));n=r<0?n.negate():n;const o=t.getFurthestPoint(n),a=(null!==(s=null===(i=t.owner)||void 0===i?void 0:i.get(Mi))&&void 0!==s?s:new Mi).applyInverse(o),l=n.normalize(),h={collider:t,separation:-n.size,axis:l,point:o,localPoint:a,side:e.findSide(l.negate()),localSide:e.findLocalSide(l.negate())};return[new Gi(t,e,n,l,l.perpendicular(),[o],[a],h)]},CollideCircleEdge(t,e){const i=t.center,s=e.asLine(),n=s.end.sub(s.begin),r=n.dot(s.end.sub(i)),o=n.dot(i.sub(s.begin)),a=e.asLine(),l=e.asLocalLine();if(o<=0){const n=s.begin.sub(i),r=n.dot(n);if(r>t.radius*t.radius)return[];const o=n.normalize(),h=t.radius-Math.sqrt(r),c={collider:t,separation:h,axis:o,point:a.begin,side:a,localSide:l};return[new Gi(t,e,o.scale(h),o,o.perpendicular(),[a.begin],[l.begin],c)]}if(r<=0){const n=s.end.sub(i),r=n.dot(n);if(r>t.radius*t.radius)return[];const o=n.normalize(),h=t.radius-Math.sqrt(r),c={collider:t,separation:h,axis:o,point:a.end,side:a,localSide:l};return[new Gi(t,e,o.scale(h),o,o.perpendicular(),[a.end],[l.end],c)]}const h=n.dot(n),c=s.begin.scale(r).add(s.end.scale(o)).scale(1/h),d=i.sub(c),u=d.dot(d);if(u>t.radius*t.radius)return[];let p=n.perpendicular();p.dot(i.sub(s.begin))<0&&(p.x=-p.x,p.y=-p.y),p=p.normalize();const g=t.radius-Math.sqrt(u),f=p.scale(g),m={collider:t,separation:g,axis:p,point:c,side:a,localSide:l};return[new Gi(t,e,f,p.negate(),p.negate().perpendicular(),[c],[c.sub(e.worldPos)],m)]},CollideEdgeEdge:()=>[],CollidePolygonEdge(t,e){var i;const s=t.center,n=e.center.sub(s).normalize(),r=new Zi({points:[e.begin,e.end,e.end.add(n.scale(100)),e.begin.add(n.scale(100))],offset:e.offset});r.owner=e.owner;(null===(i=e.owner)||void 0===i?void 0:i.get(Mi))&&r.update(e.owner.get(Mi));const o=this.CollidePolygonPolygon(t,r);return o.length&&(o[0].colliderB=e,o[0].id=Ii.calculatePairHash(t.id,e.id)),o},CollidePolygonPolygon(t,e){var i,s,n,r;const o=Ki.findPolygonPolygonSeparation(t,e);if(o.separation>0)return[];const a=Ki.findPolygonPolygonSeparation(e,t);if(a.separation>0)return[];const l=o.separation>a.separation?o:a,h=(l.collider===t?e:t).findSide(l.axis.negate()),c=l.side,d=c.dir().normalize(),u=h.clip(d.negate(),-d.dot(c.begin));let p=null;if(u&&(p=u.clip(d,d.dot(c.end))),p){const o=p.getPoints().filter((t=>c.below(t)));let a=l.axis,h=a.perpendicular();e.worldPos.sub(t.worldPos).dot(a)<0&&(a=a.negate(),h=a.perpendicular());let d=[];if(l.collider===t){const t=null!==(s=null===(i=e.owner)||void 0===i?void 0:i.get(Mi))&&void 0!==s?s:new Mi;d=o.map((e=>t.applyInverse(e)))}else{const e=null!==(r=null===(n=t.owner)||void 0===n?void 0:n.get(Mi))&&void 0!==r?r:new Mi;d=o.map((t=>e.applyInverse(t)))}return[new Gi(t,e,a.scale(-l.separation),a,h,o,d,l)]}return[]},FindContactSeparation(t,e){var i,s,n,r;const o=t.colliderA,a=null!==(s=null===(i=t.colliderA.owner)||void 0===i?void 0:i.get(Mi))&&void 0!==s?s:new Mi,l=t.colliderB,h=null!==(r=null===(n=t.colliderB.owner)||void 0===n?void 0:n.get(Mi))&&void 0!==r?r:new Mi;if(o instanceof Xi&&l instanceof Xi){return-(o.radius+l.radius-a.pos.distance(h.pos))}if(o instanceof Zi&&l instanceof Zi&&t.info.localSide){let i,s;return t.info.collider===o?(i=new ji(a.apply(t.info.localSide.begin),a.apply(t.info.localSide.end)),s=h.apply(e)):(i=new ji(h.apply(t.info.localSide.begin),h.apply(t.info.localSide.end)),s=a.apply(e)),i.distanceToPoint(s,!0)}if(o instanceof Zi&&l instanceof Xi||l instanceof Zi&&o instanceof Xi){const i=a.apply(e);if(t.info.side)return t.info.side.distanceToPoint(i,!0)}if(o instanceof Qi&&l instanceof Zi||l instanceof Qi&&o instanceof Zi){let i;if(i=t.info.collider===o?h.apply(e):a.apply(e),t.info.side)return t.info.side.distanceToPoint(i,!0)}if(o instanceof Xi&&l instanceof Qi||l instanceof Xi&&o instanceof Qi){const i=h.apply(e);let s;o instanceof Xi&&(s=o.getFurthestPoint(t.normal));const n=i.distance(s);if(t.info.side)return n>0?-n:0}return 0}};class Qi extends Hi{constructor(t){var e;super(),this.begin=t.begin||Y.Zero,this.end=t.end||Y.Zero,this.offset=null!==(e=t.offset)&&void 0!==e?e:Y.Zero}clone(){return new Qi({begin:this.begin.clone(),end:this.end.clone()})}get worldPos(){var t;const e=this._transform;return null!==(t=null==e?void 0:e.globalPos.add(this.offset))&&void 0!==t?t:this.offset}get center(){return this.begin.average(this.end).add(this._getBodyPos())}_getBodyPos(){var t;const e=this._transform;return null!==(t=null==e?void 0:e.globalPos)&&void 0!==t?t:Y.Zero}_getTransformedBegin(){const t=this._transform,e=t?t.globalRotation:0;return this.begin.rotate(e).add(this._getBodyPos())}_getTransformedEnd(){const t=this._transform,e=t?t.globalRotation:0;return this.end.rotate(e).add(this._getBodyPos())}getSlope(){const t=this._getTransformedBegin(),e=this._getTransformedEnd(),i=t.distance(e);return e.sub(t).scale(1/i)}getLength(){const t=this._getTransformedBegin(),e=this._getTransformedEnd();return t.distance(e)}contains(){return!1}rayCast(t,e=1/0){const i=this._getTransformedBegin().sub(t.pos);if(0===t.dir.cross(this.getSlope())&&0!==i.cross(t.dir))return null;const s=t.dir.cross(this.getSlope());if(0===s)return null;const n=i.cross(this.getSlope())/s;if(n>=0&&n<=e){const e=i.cross(t.dir)/s/this.getLength();if(e>=0&&e<=1)return t.getPoint(n)}return null}getClosestLineBetween(t){if(t instanceof Xi)return qi.CircleEdgeClosestLine(t,this);if(t instanceof Zi)return qi.PolygonEdgeClosestLine(t,this).flip();if(t instanceof Qi)return qi.EdgeEdgeClosestLine(this,t);throw new Error("Polygon could not collide with unknown CollisionShape "+typeof t)}collide(t){if(t instanceof Xi)return Yi.CollideCircleEdge(t,this);if(t instanceof Zi)return Yi.CollidePolygonEdge(t,this);if(t instanceof Qi)return Yi.CollideEdgeEdge();throw new Error("Edge could not collide with unknown CollisionShape "+typeof t)}getFurthestPoint(t){const e=this._getTransformedBegin(),i=this._getTransformedEnd();return t.dot(e)>0?e:i}_boundsFromBeginEnd(t,e,i=10){return new it(Math.min(t.x,e.x)-i,Math.min(t.y,e.y)-i,Math.max(t.x,e.x)+i,Math.max(t.y,e.y)+i)}get bounds(){const t=this._getTransformedBegin(),e=this._getTransformedEnd();return this._boundsFromBeginEnd(t,e)}get localBounds(){return this._boundsFromBeginEnd(this.begin,this.end)}asLine(){return new ji(this._getTransformedBegin(),this._getTransformedEnd())}asLocalLine(){return new ji(this.begin,this.end)}get axes(){const t=this._getTransformedEnd().sub(this._getTransformedBegin()).normal(),e=[];return e.push(t),e.push(t.negate()),e.push(t.normal()),e.push(t.normal().negate()),e}getInertia(t){const e=this.end.sub(this.begin).distance()/2;return t*e*e}update(t){this._transform=t}project(t){const e=[],i=[this._getTransformedBegin(),this._getTransformedEnd()],s=i.length;for(let n=0;n<s;n++)e.push(i[n].dot(t));return new Fi(Math.min.apply(Math,e),Math.max.apply(Math,e))}draw(t,e=tt.Green,i=Y.Zero){const s=this.begin.add(i),n=this.end.add(i);t.strokeStyle=e.toString(),t.beginPath(),t.moveTo(s.x,s.y),t.lineTo(n.x,n.y),t.closePath(),t.stroke()}debug(t,e){const i=this._getTransformedBegin(),s=this._getTransformedEnd();t.drawLine(i,s,e,2),t.drawCircle(i,2,e),t.drawCircle(s,2,e)}debugDraw(t,e=tt.Red){const i=this._getTransformedBegin(),s=this._getTransformedEnd();t.strokeStyle=e.toString(),t.beginPath(),t.moveTo(i.x,i.y),t.lineTo(s.x,s.y),t.closePath(),t.stroke()}}class Zi extends Hi{constructor(t){var e;super(),this._transformedPoints=[],this._axes=[],this._sides=[],this._localSides=[],this.offset=null!==(e=t.offset)&&void 0!==e?e:Y.Zero;const i=!!t.clockwiseWinding;this.points=(i?t.points.reverse():t.points)||[],this._calculateTransformation()}clone(){return new Zi({offset:this.offset.clone(),points:this.points.map((t=>t.clone()))})}get worldPos(){return this._transform?this._transform.pos.add(this.offset):this.offset}get center(){return this.bounds.center}_calculateTransformation(){const t=this._transform,e=t?t.globalPos.add(this.offset):this.offset,i=t?t.globalRotation:0,s=t?t.globalScale:Y.One,n=this.points.length;this._transformedPoints.length=0;for(let t=0;t<n;t++)this._transformedPoints[t]=this.points[t].scale(s).rotate(i).add(e)}getTransformedPoints(){return this._calculateTransformation(),this._transformedPoints}getSides(){if(this._sides.length)return this._sides;const t=[],e=this.getTransformedPoints(),i=e.length;for(let s=0;s<i;s++)t.push(new ji(e[s],e[(s+1)%i]));return this._sides=t,this._sides}getLocalSides(){if(this._localSides.length)return this._localSides;const t=[],e=this.points,i=e.length;for(let s=0;s<i;s++)t.push(new ji(e[s],e[(s+1)%i]));return this._localSides=t,this._localSides}findSide(t){const e=this.getSides();let i=e[0],s=-Number.MAX_VALUE;for(let n=0;n<e.length;n++){const r=e[n],o=r.normal().dot(t);o>s&&(i=r,s=o)}return i}findLocalSide(t){const e=this.getLocalSides();let i=e[0],s=-Number.MAX_VALUE;for(let n=0;n<e.length;n++){const r=e[n],o=r.normal().dot(t);o>s&&(i=r,s=o)}return i}get axes(){if(this._axes.length)return this._axes;const t=this.getSides().map((t=>t.normal()));return this._axes=t,this._axes}update(t){this._transform=t,this._sides.length=0,this._localSides.length=0,this._axes.length=0,this._transformedPoints.length=0,this.getTransformedPoints(),this.getSides(),this.getLocalSides()}contains(t){const e=new Oi(t,new Y(1,0));return this.getSides().reduce((function(t,i){return e.intersect(i)>=0?t+1:t}),0)%2!=0}getClosestLineBetween(t){if(t instanceof Xi)return qi.PolygonCircleClosestLine(this,t);if(t instanceof Zi)return qi.PolygonPolygonClosestLine(this,t);if(t instanceof Qi)return qi.PolygonEdgeClosestLine(this,t);throw new Error("Polygon could not collide with unknown CollisionShape "+typeof t)}collide(t){if(t instanceof Xi)return Yi.CollideCirclePolygon(t,this);if(t instanceof Zi)return Yi.CollidePolygonPolygon(this,t);if(t instanceof Qi)return Yi.CollidePolygonEdge(this,t);throw new Error("Polygon could not collide with unknown CollisionShape "+typeof t)}getFurthestPoint(t){const e=this.getTransformedPoints();let i=null,s=-Number.MAX_VALUE;for(let n=0;n<e.length;n++){const r=t.dot(e[n]);r>s&&(s=r,i=e[n])}return i}getFurthestLocalPoint(t){const e=this.points;let i=e[0],s=-Number.MAX_VALUE;for(let n=0;n<e.length;n++){const r=t.dot(e[n]);r>s&&(s=r,i=e[n])}return i}getClosestFace(t){const e=this.getSides();let i=Number.POSITIVE_INFINITY,s=-1,n=-1;for(let r=0;r<e.length;r++){const o=e[r].distanceToPoint(t);o<i&&(i=o,s=r,n=o)}return-1!==s?{distance:e[s].normal().scale(n),face:e[s]}:null}get bounds(){var t,e,i;const s=this._transform,n=null!==(t=null==s?void 0:s.globalScale)&&void 0!==t?t:Y.One,r=null!==(e=null==s?void 0:s.globalRotation)&&void 0!==e?e:0,o=(null!==(i=null==s?void 0:s.globalPos)&&void 0!==i?i:Y.Zero).add(this.offset);return this.localBounds.scale(n).rotate(r).translate(o)}get localBounds(){return it.fromPoints(this.points)}getInertia(t){let e=0,i=0;for(let t=0;t<this.points.length;t++){const s=(t+1)%this.points.length,n=this.points[s].cross(this.points[t]);e+=n*(this.points[t].dot(this.points[t])+this.points[t].dot(this.points[s])+this.points[s].dot(this.points[s])),i+=n}return t/6*(e/i)}rayCast(t,e=1/0){const i=this.getSides(),s=i.length;let n=Number.MAX_VALUE,r=-1;for(let o=0;o<s;o++){const s=t.intersect(i[o]);s>=0&&s<n&&s<=e&&(n=s,r=o)}return r>=0?t.getPoint(n):null}project(t){const e=this.getTransformedPoints(),i=e.length;let s=Number.MAX_VALUE,n=-Number.MAX_VALUE;for(let r=0;r<i;r++){const i=e[r].dot(t);s=Math.min(s,i),n=Math.max(n,i)}return new Fi(s,n)}draw(t,e=tt.Green,i=Y.Zero){const s=i.add(this.offset);t.beginPath(),t.fillStyle=e.toString();const n=this.points[0].add(s);t.moveTo(n.x,n.y),this.points.map((t=>t.add(s))).forEach((function(e){t.lineTo(e.x,e.y)})),t.lineTo(n.x,n.y),t.closePath(),t.fill()}debug(t,e){const i=this.getTransformedPoints()[0],s=[i,...this.getTransformedPoints(),i];for(let i=0;i<s.length-1;i++)t.drawLine(s[i],s[i+1],e,2),t.drawCircle(s[i],2,e),t.drawCircle(s[i+1],2,e)}debugDraw(t,e=tt.Red){t.beginPath(),t.strokeStyle=e.toString();const i=this.getTransformedPoints()[0];t.moveTo(i.x,i.y),this.getTransformedPoints().forEach((function(e){t.lineTo(e.x,e.y)})),t.lineTo(i.x,i.y),t.closePath(),t.stroke()}}class $i{static Box(t,e,i=Y.Half,s=Y.Zero){return new Zi({points:new it(-t*i.x,-e*i.y,t-t*i.x,e-e*i.y).getPoints(),offset:s})}static Polygon(t,e=!1,i=Y.Zero){return new Zi({points:t,offset:i,clockwiseWinding:e})}static Circle(t,e=Y.Zero){return new Xi({radius:t,offset:e})}static Edge(t,e){return new Qi({begin:t,end:e})}static Capsule(t,e,i=Y.Zero){const s=y.getInstance();t===e&&s.warn("A capsule collider with equal width and height is a circle, consider using a ex.Shape.Circle or ex.CircleCollider");if(e>=t){return new Wi([$i.Circle(t/2,Q(0,-e/2+t/2).add(i)),$i.Box(t,e-t,Y.Half,i),$i.Circle(t/2,Q(0,e/2-t/2).add(i))])}return new Wi([$i.Circle(e/2,Q(-t/2+e/2,0).add(i)),$i.Box(t-e,e,Y.Half,i),$i.Circle(e/2,Q(t/2-e/2,0).add(i))])}}class Ji extends Ai{constructor(t){super(),this.type="ex.collider",this.events=new ge(this),this.$colliderAdded=new Bi,this.$colliderRemoved=new Bi,this.set(t)}get(){return this._collider}set(t){return this.clear(),t&&(this._collider=t,this._collider.owner=this.owner,this.events.wire(t.events),this.$colliderAdded.notifyAll(t),this.update()),t}clear(){this._collider&&(this.events.unwire(this._collider.events),this.$colliderRemoved.notifyAll(this._collider),this._collider.owner=null,this._collider=null)}get bounds(){var t,e;return null!==(e=null===(t=this._collider)||void 0===t?void 0:t.bounds)&&void 0!==e?e:new it}get localBounds(){var t,e;return null!==(e=null===(t=this._collider)||void 0===t?void 0:t.localBounds)&&void 0!==e?e:new it}update(){var t;const e=null===(t=this.owner)||void 0===t?void 0:t.get(Mi);this._collider&&(this._collider.owner=this.owner,e&&this._collider.update(e))}collide(t){let e=this._collider,i=t._collider;if(!e||!i)return[];let s=!1;if(i instanceof Wi&&(e=i,i=this._collider,s=!0),this._collider){const n=e.collide(i);return n?(s&&n.forEach((e=>{e.mtv=e.mtv.negate(),e.normal=e.normal.negate(),e.tangent=e.normal.perpendicular(),e.colliderA=this._collider,e.colliderB=t._collider})),n):[]}return[]}onAdd(t){this._collider&&this.update(),this.events.on("precollision",(e=>{const i=e;t.events.emit("precollision",new Jt(i.target.owner,i.other.owner,i.side,i.intersection))})),this.events.on("postcollision",(e=>{const i=e;t.events.emit("postcollision",new te(i.target.owner,i.other.owner,i.side,i.intersection))})),this.events.on("collisionstart",(e=>{const i=e;t.events.emit("collisionstart",new re(i.target.owner,i.other.owner,i.contact))})),this.events.on("collisionend",(e=>{const i=e;t.events.emit("collisionend",new oe(i.target.owner,i.other.owner))}))}onRemove(){this.events.clear(),this.$colliderRemoved.notifyAll(this._collider)}useBoxCollider(t,e,i=Y.Half,s=Y.Zero){const n=$i.Box(t,e,i,s);return this.set(n)}usePolygonCollider(t,e=Y.Zero){const i=$i.Polygon(t,!1,e);return this.set(i)}useCircleCollider(t,e=Y.Zero){const i=$i.Circle(t,e);return this.set(i)}useEdgeCollider(t,e){const i=$i.Edge(t,e);return this.set(i)}useCompositeCollider(t){return this.set(new Wi(t))}}var ts,es;(es=ts||(ts={})).Rotation="rotation",es.X="x",es.Y="y";class is extends Ai{constructor(t){var e,i,s;super(),this.type="ex.body",this.dependencies=[Mi,Di],this.id=m("body",is._ID++),this.events=new ge(this),this.collisionType=yi.PreventCollision,this.group=Li.All,this.mass=Ei.defaultMass,this.sleepMotion=5*Ei.sleepEpsilon,this.canSleep=Ei.bodiesCanSleepByDefault,this._sleeping=!1,this.bounciness=.2,this.friction=.99,this.useGravity=!0,this.limitDegreeOfFreedom=[],this.oldPos=new Y(0,0),this.oldVel=new Y(0,0),this.oldAcc=Y.Zero,this.oldRotation=0,this.oldScale=Y.One,t&&(this.collisionType=null!==(e=t.type)&&void 0!==e?e:this.collisionType,this.group=null!==(i=t.group)&&void 0!==i?i:this.group,this.useGravity=null!==(s=t.useGravity)&&void 0!==s?s:this.useGravity)}get inverseMass(){return this.collisionType===yi.Fixed?0:1/this.mass}get sleeping(){return this._sleeping}setSleeping(t){this._sleeping=t,t?(this.vel=Y.Zero,this.acc=Y.Zero,this.angularVelocity=0,this.sleepMotion=0):this.sleepMotion=5*Ei.sleepEpsilon}updateMotion(){this._sleeping&&this.setSleeping(!0);const t=this.vel.size*this.vel.size+Math.abs(this.angularVelocity*this.angularVelocity),e=Ei.sleepBias;this.sleepMotion=e*this.sleepMotion+(1-e)*t,this.sleepMotion=k(this.sleepMotion,0,10*Ei.sleepEpsilon),this.canSleep&&this.sleepMotion<Ei.sleepEpsilon&&this.setSleeping(!0)}get inertia(){const t=this.owner.get(Ji);return(null==t?void 0:t.get())?t.get().getInertia(this.mass):0}get inverseInertia(){return this.collisionType===yi.Fixed?0:1/this.inertia}get active(){var t;return!!(null===(t=this.owner)||void 0===t?void 0:t.active)}get center(){return this.pos}get transform(){var t;return null===(t=this.owner)||void 0===t?void 0:t.get(Mi)}get motion(){var t;return null===(t=this.owner)||void 0===t?void 0:t.get(Di)}get pos(){return this.transform.globalPos}set pos(t){this.transform.globalPos=t}get vel(){return this.motion.vel}set vel(t){this.motion.vel=t}get acc(){return this.motion.acc}set acc(t){this.motion.acc=t}get torque(){return this.motion.torque}set torque(t){this.motion.torque=t}get rotation(){return this.transform.globalRotation}set rotation(t){this.transform.globalRotation=t}get scale(){return this.transform.globalScale}set scale(t){this.transform.globalScale=t}get sx(){return this.motion.scaleFactor.x}set sx(t){this.motion.scaleFactor.x=t}get sy(){return this.motion.scaleFactor.y}set sy(t){this.motion.scaleFactor.y=t}get rx(){return this.motion.angularVelocity}set rx(t){this.motion.angularVelocity=t}get angularVelocity(){return this.motion.angularVelocity}set angularVelocity(t){this.motion.angularVelocity=t}applyImpulse(t,e){if(this.collisionType!==yi.Active)return;const i=e.scale(this.inverseMass);if(this.limitDegreeOfFreedom.includes(ts.X)&&(i.x=0),this.limitDegreeOfFreedom.includes(ts.Y)&&(i.y=0),this.vel.addEqual(i),!this.limitDegreeOfFreedom.includes(ts.Rotation)){const i=t.sub(this.pos);this.angularVelocity+=this.inverseInertia*i.cross(e)}}applyLinearImpulse(t){if(this.collisionType!==yi.Active)return;const e=t.scale(this.inverseMass);this.limitDegreeOfFreedom.includes(ts.X)&&(e.x=0),this.limitDegreeOfFreedom.includes(ts.Y)&&(e.y=0),this.vel=this.vel.add(e)}applyAngularImpulse(t,e){if(this.collisionType===yi.Active&&!this.limitDegreeOfFreedom.includes(ts.Rotation)){const i=t.sub(this.pos);this.angularVelocity+=this.inverseInertia*i.cross(e)}}captureOldTransform(){this.oldVel.setTo(this.vel.x,this.vel.y),this.oldPos.setTo(this.pos.x,this.pos.y),this.oldAcc.setTo(this.acc.x,this.acc.y),this.oldScale.setTo(this.scale.x,this.scale.y),this.oldRotation=this.rotation}debugDraw(t){}}is._ID=0;class ss{constructor(){this._topLeft=new Y(0,0),this._topRight=new Y(0,0),this._bottomLeft=new Y(0,0),this._bottomRight=new Y(0,0)}isSpriteOffScreen(t,e){const i=t.currentDrawing.drawWidth,s=t.currentDrawing.drawHeight,n=t.rotation,r=t.center,o=t.getGlobalPos();this._topLeft=Q(o.x-i/2,o.y-s/2),this._topLeft=this._topLeft.rotate(n,r),this._topRight=Q(o.x+i/2,o.y-s/2),this._topRight=this._topRight.rotate(n,r),this._bottomLeft=Q(o.x-i/2,o.y+s/2),this._bottomLeft=this._bottomLeft.rotate(n,r),this._bottomRight=Q(o.x+i/2,o.y+s/2),this._bottomRight=this._bottomRight.rotate(n,r);const a=e.worldToScreenCoordinates(this._topLeft),l=e.worldToScreenCoordinates(this._topRight),h=e.worldToScreenCoordinates(this._bottomLeft),c=e.worldToScreenCoordinates(this._bottomRight);this._xCoords=[],this._yCoords=[],this._xCoords.push(a.x,l.x,h.x,c.x),this._yCoords.push(a.y,l.y,h.y,c.y),this._xMin=Math.min.apply(null,this._xCoords),this._yMin=Math.min.apply(null,this._yCoords),this._xMax=Math.max.apply(null,this._xCoords),this._yMax=Math.max.apply(null,this._yCoords);const d=e.screenToWorldCoordinates(new Y(this._xMin,this._yMin)),u=e.screenToWorldCoordinates(new Y(this._xMax,this._yMax));this._xMinWorld=d.x,this._yMinWorld=d.y,this._xMaxWorld=u.x,this._yMaxWorld=u.y;const p=[new Y(this._xMin,this._yMin),new Y(this._xMax,this._yMin),new Y(this._xMin,this._yMax),new Y(this._xMax,this._yMax)];if(p[0].x<0&&p[1].x>e.canvas.clientWidth&&(p[0].y>0||p[2].y<e.canvas.clientHeight))return!1;if(p[0].y<0&&p[2].y>e.canvas.clientHeight&&(p[1].x>0||p[0].x<e.canvas.clientWidth))return!1;for(let t=0;t<p.length;t++)if(p[t].x>0&&p[t].y>0&&p[t].x<e.canvas.clientWidth&&p[t].y<e.canvas.clientHeight)return!1;return!0}debugDraw(t){t.beginPath(),t.strokeStyle=tt.White.toString(),t.rect(this._xMinWorld,this._yMinWorld,this._xMaxWorld-this._xMinWorld,this._yMaxWorld-this._yMinWorld),t.stroke(),t.fillStyle=tt.Red.toString(),t.beginPath(),t.arc(this._topLeft.x,this._topLeft.y,5,0,2*Math.PI),t.closePath(),t.fill(),t.fillStyle=tt.Green.toString(),t.beginPath(),t.arc(this._topRight.x,this._topRight.y,5,0,2*Math.PI),t.closePath(),t.fill(),t.fillStyle=tt.Blue.toString(),t.beginPath(),t.arc(this._bottomLeft.x,this._bottomLeft.y,5,0,2*Math.PI),t.closePath(),t.fill(),t.fillStyle=tt.Magenta.toString(),t.beginPath(),t.arc(this._bottomRight.x,this._bottomRight.y,5,0,2*Math.PI),t.closePath(),t.fill()}}class ns{constructor(){this.cullingBox=new ss}update(t,e){const i=t.eventDispatcher;let s=!0;null!=t.currentDrawing&&(s=this.cullingBox.isSpriteOffScreen(t,e));let n=!1;e&&e.currentScene&&e.currentScene.camera&&e.currentScene.camera.viewport&&!t.parent&&(n=!e.currentScene.camera.viewport.intersect(t.collider.bounds)),t.isOffScreen?n&&s||(i.emit("enterviewport",new de(t)),t.removeComponent("offscreen")):n&&s&&(i.emit("exitviewport",new ce(t)),t.addComponent(new ki("offscreen")))}}class rs{update(t,e){t.enableCapturePointer&&(t.isKilled()||e.input.pointers.checkAndUpdateActorUnderPointer(t))}}class os{constructor(t){this.data=t,this.type="Component Added"}}function as(t){return!!t&&"Component Added"===t.type}class ls{constructor(t){this.data=t,this.type="Component Removed"}}function hs(t){return!!t&&"Component Removed"===t.type}class cs extends oi{constructor(t,e){if(super(),this.id=cs._ID++,this._name="anonymous",this.active=!0,this._componentsToRemove=[],this._componentTypeToInstance=new Map,this._componentStringToInstance=new Map,this._tagsMemo=[],this._typesMemo=[],this.componentAdded$=new Bi,this.componentRemoved$=new Bi,this._parent=null,this.childrenAdded$=new Bi,this.childrenRemoved$=new Bi,this._children=[],this._isInitialized=!1,this._setName(e),t)for(const e of t)this.addComponent(e)}_setName(t){t&&(this._name=t)}get name(){return this._name}get events(){return this.eventDispatcher}kill(){this.active=!1}isKilled(){return!this.active}get tags(){return this._tagsMemo}hasTag(t){return this.tags.includes(t)}addTag(t){return this.addComponent(new ki(t))}removeTag(t,e=!1){return this.removeComponent(t,e)}get types(){return this._typesMemo}_rebuildMemos(){this._tagsMemo=Array.from(this._componentStringToInstance.values()).filter((t=>t instanceof ki)).map((t=>t.type)),this._typesMemo=Array.from(this._componentStringToInstance.keys())}getComponents(){return Array.from(this._componentStringToInstance.values())}_notifyAddComponent(t){this._rebuildMemos();const e=new os({component:t,entity:this});this.componentAdded$.notifyAll(e)}_notifyRemoveComponent(t){const e=new ls({component:t,entity:this});this.componentRemoved$.notifyAll(e),this._rebuildMemos()}get parent(){return this._parent}get children(){return this._children}unparent(){this._parent&&(this._parent.removeChild(this),this._parent=null)}addChild(t){if(null!==t.parent)throw new Error("Entity already has a parent, cannot add without unparenting");if(this.getAncestors().includes(t))throw new Error("Cycle detected, cannot add entity");return this._children.push(t),t._parent=this,this.childrenAdded$.notifyAll(t),this}removeChild(t){return t.parent===this&&(F(t,this._children),t._parent=null,this.childrenRemoved$.notifyAll(t)),this}removeAllChildren(){return this.children.forEach((t=>{this.removeChild(t)})),this}getAncestors(){const t=[this];let e=this.parent;for(;e;)t.push(e),e=e.parent;return t.reverse()}getDescendants(){let t=[this],e=[this];for(;e.length>0;){const i=e.pop();e=e.concat(i.children),t=t.concat(i.children)}return t}clone(){const t=new cs;for(const e of this.types)t.addComponent(this.get(e).clone());for(const e of this.children)t.addChild(e.clone());return t}addTemplate(t,e=!1){for(const i of t.getComponents())this.addComponent(i.clone(),e);for(const e of t.children)this.addChild(e.clone().addTemplate(e));return this}addComponent(t,e=!1){if(this.has(t.type)){if(!e)return this;this.removeComponent(t)}if(t.dependencies&&t.dependencies.length)for(const e of t.dependencies)this.addComponent(new e);t.owner=this;const i=t.constructor;return this._componentTypeToInstance.set(i,t),this._componentStringToInstance.set(t.type,t),t.onAdd&&t.onAdd(this),this._notifyAddComponent(t),this}removeComponent(t,e=!1){return e?"string"==typeof t?this._removeComponentByType(t):t instanceof Ai&&this._removeComponentByType(t.type):this._componentsToRemove.push(t),this}_removeComponentByType(t){if(this.has(t)){const e=this.get(t);e.owner=null,e.onRemove&&e.onRemove(this);const i=e.constructor;this._componentTypeToInstance.delete(i),this._componentStringToInstance.delete(e.type),this._notifyRemoveComponent(e)}}processComponentRemoval(){for(const t of this._componentsToRemove){const e="string"==typeof t?t:t.type;this._removeComponentByType(e)}this._componentsToRemove.length=0}has(t){return"string"==typeof t?this._componentStringToInstance.has(t):this._componentTypeToInstance.has(t)}get(t){return"string"==typeof t?this._componentStringToInstance.get(t):this._componentTypeToInstance.get(t)}get isInitialized(){return this._isInitialized}_initialize(t){this.isInitialized||(this.onInitialize(t),super.emit("initialize",new ae(t,this)),this._isInitialized=!0)}_preupdate(t,e){this.emit("preupdate",new Ht(t,e,this)),this.onPreUpdate(t,e)}_postupdate(t,e){this.emit("postupdate",new Wt(t,e,this)),this.onPostUpdate(t,e)}onInitialize(t){}onPreUpdate(t,e){}onPostUpdate(t,e){}update(t,e){this._initialize(t),this._preupdate(t,e);for(const i of this.children)i.update(t,e);this._postupdate(t,e)}}cs._ID=0;class ds extends Ai{constructor(t){var e;super(),this.draw=t,this.type="ex.canvas",this.draw=null!==(e=this.draw)&&void 0!==e?e:()=>{}}}function us(t){return!!t.tick}class ps{constructor(t,e){this._options=t,this._graphics=e,this.graphics=[]}get name(){return this._options.name}hide(t){if(t){let e=null;e=t instanceof Ct?t:this._graphics.getGraphic(t),this.graphics=this.graphics.filter((t=>t.graphic!==e))}else this.graphics.length=0}show(t,e){let i;return e=Object.assign({},e),t instanceof Ct?i=this._graphics.copyGraphics?t.clone():t:(i=this._graphics.getGraphic(t),i||y.getInstance().error(`No such graphic added to component named ${t}. These named graphics are available: `,this._graphics.getNames())),i?(this.graphics.push({graphic:i,options:e}),i):null}use(t,e){return e=Object.assign({},e),this.hide(),this.show(t,e)}get order(){return this._options.order}set order(t){this._options.order=t}get offset(){var t;return null!==(t=this._options.offset)&&void 0!==t?t:Y.Zero}set offset(t){this._options.offset=t}get currentKeys(){var t;return null!==(t=this.name)&&void 0!==t?t:"anonymous"}}class gs{constructor(t){this._component=t,this._layers=[],this._layerMap={},this.default=new ps({name:"default",order:0},t),this._maybeAddLayer(this.default)}create(t){const e=new ps(t,this._component);return this._maybeAddLayer(e)}get(t){return t?this._getLayer(t):this._layers}currentKeys(){const t=[];for(const e of this._layers)t.push(e.currentKeys);return t}has(t){return t in this._layerMap}_maybeAddLayer(t){return this._layerMap[t.name]?this._layerMap[t.name]:(this._layerMap[t.name]=t,this._layers.push(t),this._layers.sort(((t,e)=>t.order-e.order)),t)}_getLayer(t){return this._layerMap[t]}}class fs extends Ai{constructor(t){super(),this.type="ex.graphics",this._graphics={},this.visible=!0,this.opacity=1,this.offset=Y.Zero,this.anchor=Y.Half,this.copyGraphics=!1,this._bounds=null,t=Object.assign({visible:this.visible},t);const{current:e,anchor:i,opacity:s,visible:n,graphics:r,offset:o,copyGraphics:a,onPreDraw:l,onPostDraw:h}=t;this._graphics=r||{},this.offset=null!=o?o:this.offset,this.opacity=null!=s?s:this.opacity,this.anchor=null!=i?i:this.anchor,this.copyGraphics=null!=a?a:this.copyGraphics,this.onPreDraw=null!=l?l:this.onPreDraw,this.onPostDraw=null!=h?h:this.onPostDraw,this.visible=!!n,this.layers=new gs(this),e&&this._graphics[e]&&this.show(this._graphics[e])}getGraphic(t){return this._graphics[t]}getNames(){return Object.keys(this._graphics)}get current(){return this.layers.default.graphics}get graphics(){return this._graphics}add(t,e){let i="default",s=null;return"string"==typeof t?(i=t,s=e):s=t,this._graphics[i]=this.copyGraphics?s.clone():s,"default"===i&&this.show("default"),s}show(t,e){return this.layers.default.show(t,e)}use(t,e){return this.layers.default.use(t,e)}hide(t){this.layers.default.hide(t)}set localBounds(t){this._bounds=t}get localBounds(){if(this._bounds)return this._bounds;let t=new it;for(const e of this.layers.get())for(const{graphic:i,options:s}of e.graphics){let n=this.anchor,r=this.offset;(null==s?void 0:s.anchor)&&(n=s.anchor),(null==s?void 0:s.offset)&&(r=s.offset);const o=i.localBounds,a=-o.width*i.scale.x*n.x+r.x,l=-o.height*i.scale.y*n.y+r.y;t=null==i?void 0:i.localBounds.translate(Q(a+e.offset.x,l+e.offset.y)).combine(t)}return t}update(t,e=0){for(const i of this.layers.get())for(const{graphic:s}of i.graphics)us(s)&&(null==s||s.tick(t,e))}}class ms extends At{constructor(t){super(t),this.width=t.width,this.height=t.height,this.rasterize()}clone(){return new ms(Object.assign(Object.assign({width:this.width,height:this.height},this.cloneGraphicOptions()),this.cloneRasterOptions()))}execute(t){this.color&&t.fillRect(0,0,this.width,this.height),this.strokeColor&&t.strokeRect(0,0,this.width,this.height)}}class ys extends At{constructor(t){var e;super(t),this._radius=0,this.padding=null!==(e=t.padding)&&void 0!==e?e:2,this.radius=t.radius,this.rasterize()}get radius(){return this._radius}set radius(t){this._radius=t,this.width=2*this._radius,this.height=2*this._radius,this.flagDirty()}clone(){return new ys(Object.assign(Object.assign({radius:this.radius},this.cloneGraphicOptions()),this.cloneRasterOptions()))}execute(t){this.radius>0&&(t.beginPath(),t.arc(this.radius,this.radius,this.radius,0,2*Math.PI),this.color&&t.fill(),this.strokeColor&&t.stroke())}}var _s,ws;class vs{static CreateReversibleEasingFunction(t){return(e,i,s,n)=>s<i?i-(t(e,s,i,n)-s):t(e,i,s,n)}static CreateReversableEasingFunction(t){return vs.CreateReversibleEasingFunction(t)}static CreateVectorEasingFunction(t){return(e,i,s,n)=>new Y(t(e,i.x,s.x,n),t(e,i.y,s.y,n))}}vs.Linear=vs.CreateReversibleEasingFunction(((t,e,i,s)=>(i-=e)*t/s+e)),vs.EaseInQuad=vs.CreateReversibleEasingFunction(((t,e,i,s)=>(i-=e)*(t/=s)*t+e)),vs.EaseOutQuad=vs.CreateReversibleEasingFunction(((t,e,i,s)=>-(i-=e)*(t/=s)*(t-2)+e)),vs.EaseInOutQuad=vs.CreateReversibleEasingFunction(((t,e,i,s)=>(i-=e,(t/=s/2)<1?i/2*t*t+e:-i/2*(--t*(t-2)-1)+e))),vs.EaseInCubic=vs.CreateReversibleEasingFunction(((t,e,i,s)=>(i-=e)*(t/=s)*t*t+e)),vs.EaseOutCubic=vs.CreateReversibleEasingFunction(((t,e,i,s)=>(t/=s,(i-=e)*(--t*t*t+1)+e))),vs.EaseInOutCubic=vs.CreateReversibleEasingFunction(((t,e,i,s)=>(i-=e,(t/=s/2)<1?i/2*t*t*t+e:i/2*((t-=2)*t*t+2)+e))),function(t,e,i,s){var n,r=arguments.length,o=r<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,s);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(o=(r<3?n(o):r>3?n(e,i,o):n(e,i))||o);r>3&&o&&Object.defineProperty(e,i,o)}([K({message:"Alias for incorrect spelling used in older versions, will be removed in v0.25.0",alternateMethod:"CreateReversibleEasingFunction"})],vs,"CreateReversableEasingFunction",null);class xs{constructor(t){this._actions=[],this._completedActions=[],this._entity=t}add(t){this._actions.push(t)}remove(t){const e=this._actions.indexOf(t);this._actions.splice(e,1)}clearActions(){this._actions.length=0,this._completedActions.length=0,this._currentAction&&this._currentAction.stop()}getActions(){return this._actions.concat(this._completedActions)}hasNext(){return this._actions.length>0}isComplete(){return 0===this._actions.length}reset(){this._actions=this.getActions();const t=this._actions.length;for(let e=0;e<t;e++)this._actions[e].reset();this._completedActions=[]}update(t){this._actions.length>0&&(this._currentAction=this._actions[0],this._currentAction.update(t),this._currentAction.isComplete(this._entity)&&this._completedActions.push(this._actions.shift()))}}class bs{constructor(t,e,i){this._stopped=!1,this._repeatBuilder=e,this._repeatContext=new Ns(t),this._actionQueue=this._repeatContext.getQueue(),this._repeat=i,this._originalRepeat=i,this._repeatBuilder(this._repeatContext),this._repeat--}update(t){this._actionQueue.isComplete()&&(this._actionQueue.clearActions(),this._repeatBuilder(this._repeatContext),this._repeat--),this._actionQueue.update(t)}isComplete(){return this._stopped||this._repeat<=0&&this._actionQueue.isComplete()}stop(){this._stopped=!0}reset(){this._repeat=this._originalRepeat}}class Ss{constructor(t,e){this._stopped=!1,this._repeatBuilder=e,this._repeatContext=new Ns(t),this._actionQueue=this._repeatContext.getQueue(),this._repeatBuilder(this._repeatContext)}update(t){this._stopped||(this._actionQueue.isComplete()&&(this._actionQueue.clearActions(),this._repeatBuilder(this._repeatContext)),this._actionQueue.update(t))}isComplete(){return this._stopped}stop(){this._stopped=!0,this._actionQueue.clearActions()}reset(){}}class Cs{constructor(t,e,i,s){if(this._started=!1,this._stopped=!1,this._entity=t,this._tx=t.get(Mi),this._motion=t.get(Di),this._speed=s,this._offset=new Y(e,i),s<=0)throw y.getInstance().error("Attempted to moveBy with speed less than or equal to zero : "+s),new Error("Speed must be greater than 0 pixels per second")}update(t){this._started||(this._started=!0,this._start=new Y(this._tx.pos.x,this._tx.pos.y),this._end=this._start.add(this._offset),this._distance=this._offset.size,this._dir=this._end.sub(this._start).normalize()),this.isComplete(this._entity)?(this._tx.pos=Q(this._end.x,this._end.y),this._motion.vel=Q(0,0)):this._motion.vel=this._dir.scale(this._speed)}isComplete(t){const e=t.get(Mi);return this._stopped||e.pos.distance(this._start)>=this._distance}stop(){this._motion.vel=Q(0,0),this._stopped=!0}reset(){this._started=!1}}class Es{constructor(t,e,i,s){this.entity=t,this._started=!1,this._stopped=!1,this._tx=t.get(Mi),this._motion=t.get(Di),this._end=new Y(e,i),this._speed=s}update(t){this._started||(this._started=!0,this._start=new Y(this._tx.pos.x,this._tx.pos.y),this._distance=this._start.distance(this._end),this._dir=this._end.sub(this._start).normalize());const e=this._dir.scale(this._speed);this._motion.vel=Q(e.x,e.y),this.isComplete(this.entity)&&(this._tx.pos=Q(this._end.x,this._end.y),this._motion.vel=Q(0,0))}isComplete(t){const e=t.get(Mi);return this._stopped||new Y(e.pos.x,e.pos.y).distance(this._start)>=this._distance}stop(){this._motion.vel=Q(0,0),this._stopped=!0}reset(){this._started=!1}}(ws=_s||(_s={}))[ws.ShortestPath=0]="ShortestPath",ws[ws.LongestPath=1]="LongestPath",ws[ws.Clockwise=2]="Clockwise",ws[ws.CounterClockwise=3]="CounterClockwise";class Ps{constructor(t,e,i,s){this._started=!1,this._stopped=!1,this._tx=t.get(Mi),this._motion=t.get(Di),this._end=e,this._speed=i,this._rotationType=s||_s.ShortestPath}update(t){if(!this._started){this._started=!0,this._start=this._tx.rotation,this._currentNonCannonAngle=this._tx.rotation;const t=Math.abs(this._end-this._start),e=C-t;switch(t>e?(this._shortDistance=e,this._longDistance=t):(this._shortDistance=t,this._longDistance=e),this._shortestPathIsPositive=(this._start-this._end+C)%C>=Math.PI,this._rotationType){case _s.ShortestPath:this._distance=this._shortDistance,this._shortestPathIsPositive?this._direction=1:this._direction=-1;break;case _s.LongestPath:this._distance=this._longDistance,this._shortestPathIsPositive?this._direction=-1:this._direction=1;break;case _s.Clockwise:this._direction=1,this._shortestPathIsPositive?this._distance=this._shortDistance:this._distance=this._longDistance;break;case _s.CounterClockwise:this._direction=-1,this._shortestPathIsPositive?this._distance=this._longDistance:this._distance=this._shortDistance}}this._motion.angularVelocity=this._direction*this._speed,this._currentNonCannonAngle+=this._direction*this._speed*(t/1e3),this.isComplete()&&(this._tx.rotation=this._end,this._motion.angularVelocity=0,this._stopped=!0)}isComplete(){const t=Math.abs(this._currentNonCannonAngle-this._start);return this._stopped||t>=Math.abs(this._distance)}stop(){this._motion.angularVelocity=0,this._stopped=!0}reset(){this._started=!1}}class As{constructor(t,e,i,s){this._started=!1,this._stopped=!1,this._tx=t.get(Mi),this._motion=t.get(Di),this._speed=i,this._offset=e,this._rotationType=s||_s.ShortestPath}update(t){if(!this._started){this._started=!0,this._start=this._tx.rotation,this._currentNonCannonAngle=this._tx.rotation,this._end=this._start+this._offset;const t=Math.abs(this._end-this._start),e=C-t;switch(t>e?(this._shortDistance=e,this._longDistance=t):(this._shortDistance=t,this._longDistance=e),this._shortestPathIsPositive=(this._start-this._end+C)%C>=Math.PI,this._rotationType){case _s.ShortestPath:this._distance=this._shortDistance,this._shortestPathIsPositive?this._direction=1:this._direction=-1;break;case _s.LongestPath:this._distance=this._longDistance,this._shortestPathIsPositive?this._direction=-1:this._direction=1;break;case _s.Clockwise:this._direction=1,this._shortDistance>=0?this._distance=this._shortDistance:this._distance=this._longDistance;break;case _s.CounterClockwise:this._direction=-1,this._shortDistance<=0?this._distance=this._shortDistance:this._distance=this._longDistance}}this._motion.angularVelocity=this._direction*this._speed,this._currentNonCannonAngle+=this._direction*this._speed*(t/1e3),this.isComplete()&&(this._tx.rotation=this._end,this._motion.angularVelocity=0,this._stopped=!0)}isComplete(){const t=Math.abs(this._currentNonCannonAngle-this._start);return this._stopped||t>=Math.abs(this._distance)}stop(){this._motion.angularVelocity=0,this._stopped=!0}reset(){this._started=!1}}class ks{constructor(t,e,i,s,n){this._started=!1,this._stopped=!1,this._tx=t.get(Mi),this._motion=t.get(Di),this._endX=e,this._endY=i,this._speedX=s,this._speedY=n}update(t){if(this._started||(this._started=!0,this._startX=this._tx.scale.x,this._startY=this._tx.scale.y,this._distanceX=Math.abs(this._endX-this._startX),this._distanceY=Math.abs(this._endY-this._startY)),Math.abs(this._tx.scale.x-this._startX)>=this._distanceX)this._motion.scaleFactor.x=0;else{const t=this._endY<this._startY?-1:1;this._motion.scaleFactor.x=this._speedX*t}if(Math.abs(this._tx.scale.y-this._startY)>=this._distanceY)this._motion.scaleFactor.y=0;else{const t=this._endY<this._startY?-1:1;this._motion.scaleFactor.y=this._speedY*t}this.isComplete()&&(this._tx.scale=Q(this._endX,this._endY),this._motion.scaleFactor.x=0,this._motion.scaleFactor.y=0)}isComplete(){return this._stopped||Math.abs(this._tx.scale.y-this._startX)>=this._distanceX&&Math.abs(this._tx.scale.y-this._startY)>=this._distanceY}stop(){this._motion.scaleFactor.x=0,this._motion.scaleFactor.y=0,this._stopped=!0}reset(){this._started=!1}}class Ts{constructor(t,e,i,s){this._started=!1,this._stopped=!1,this._tx=t.get(Mi),this._motion=t.get(Di),this._offset=new Y(e,i),this._speedX=this._speedY=s}update(t){this._started||(this._started=!0,this._startScale=this._tx.scale.clone(),this._endScale=this._startScale.add(this._offset),this._distanceX=Math.abs(this._endScale.x-this._startScale.x),this._distanceY=Math.abs(this._endScale.y-this._startScale.y),this._directionX=this._endScale.x<this._startScale.x?-1:1,this._directionY=this._endScale.y<this._startScale.y?-1:1),this._motion.scaleFactor.x=this._speedX*this._directionX,this._motion.scaleFactor.y=this._speedY*this._directionY,this.isComplete()&&(this._tx.scale=this._endScale,this._motion.scaleFactor.x=0,this._motion.scaleFactor.y=0)}isComplete(){return this._stopped||Math.abs(this._tx.scale.x-this._startScale.x)>=this._distanceX&&Math.abs(this._tx.scale.y-this._startScale.y)>=this._distanceY}stop(){this._motion.scaleFactor.x=0,this._motion.scaleFactor.y=0,this._stopped=!0}reset(){this._started=!1}}class Rs{constructor(t){this._method=null,this._hasBeenCalled=!1,this._method=t}update(t){this._method(),this._hasBeenCalled=!0}isComplete(){return this._hasBeenCalled}reset(){this._hasBeenCalled=!1}stop(){this._hasBeenCalled=!0}}class Ms{constructor(t,e,i,s,n){this.easingFcn=n,this._currentLerpTime=0,this._lerpDuration=1e3,this._lerpStart=new Y(0,0),this._lerpEnd=new Y(0,0),this._initialized=!1,this._stopped=!1,this._distance=0,this._tx=t.get(Mi),this._motion=t.get(Di),this._lerpDuration=s,this._lerpEnd=new Y(e,i)}_initialize(){this._lerpStart=new Y(this._tx.pos.x,this._tx.pos.y),this._currentLerpTime=0,this._distance=this._lerpStart.distance(this._lerpEnd)}update(t){this._initialized||(this._initialize(),this._initialized=!0),this._currentLerpTime+=t;let e=this._tx.pos.x,i=this._tx.pos.y;this._currentLerpTime<this._lerpDuration?(e=this._lerpEnd.x<this._lerpStart.x?this._lerpStart.x-(this.easingFcn(this._currentLerpTime,this._lerpEnd.x,this._lerpStart.x,this._lerpDuration)-this._lerpEnd.x):this.easingFcn(this._currentLerpTime,this._lerpStart.x,this._lerpEnd.x,this._lerpDuration),i=this._lerpEnd.y<this._lerpStart.y?this._lerpStart.y-(this.easingFcn(this._currentLerpTime,this._lerpEnd.y,this._lerpStart.y,this._lerpDuration)-this._lerpEnd.y):this.easingFcn(this._currentLerpTime,this._lerpStart.y,this._lerpEnd.y,this._lerpDuration),this._motion.vel=Q((e-this._tx.pos.x)/(t/1e3),(i-this._tx.pos.y)/(t/1e3))):(this._tx.pos=Q(this._lerpEnd.x,this._lerpEnd.y),this._motion.vel=Y.Zero)}isComplete(t){return this._stopped||new Y(t.pos.x,t.pos.y).distance(this._lerpStart)>=this._distance}reset(){this._initialized=!1}stop(){this._motion.vel=Q(0,0),this._stopped=!0}}class Ds{constructor(t,e,i,s=1){this._timeVisible=0,this._timeNotVisible=0,this._elapsedTime=0,this._totalTime=0,this._stopped=!1,this._started=!1,this._graphics=t.get(fs),this._timeVisible=e,this._timeNotVisible=i,this._duration=(e+i)*s}update(t){this._started||(this._started=!0),this._graphics&&(this._elapsedTime+=t,this._totalTime+=t,this._graphics.visible&&this._elapsedTime>=this._timeVisible&&(this._graphics.visible=!1,this._elapsedTime=0),!this._graphics.visible&&this._elapsedTime>=this._timeNotVisible&&(this._graphics.visible=!0,this._elapsedTime=0),this.isComplete()&&(this._graphics.visible=!0))}isComplete(){return this._stopped||this._totalTime>=this._duration}stop(){this._graphics&&(this._graphics.visible=!0),this._stopped=!0}reset(){this._started=!1,this._elapsedTime=0,this._totalTime=0}}class Ls{constructor(t,e,i){this._multiplier=1,this._started=!1,this._stopped=!1,this._graphics=t.get(fs),this._endOpacity=e,this._speed=i}update(t){this._graphics&&(this._started||(this._started=!0,this._endOpacity<this._graphics.opacity?this._multiplier=-1:this._multiplier=1),this._speed>0&&(this._graphics.opacity+=this._multiplier*(Math.abs(this._graphics.opacity-this._endOpacity)*t)/this._speed),this._speed-=t,this.isComplete()&&(this._graphics.opacity=this._endOpacity),y.getInstance().debug("[Action fade] Actor opacity:",this._graphics.opacity))}isComplete(){return this._stopped||Math.abs(this._graphics.opacity-this._endOpacity)<.05}stop(){this._stopped=!0}reset(){this._started=!1}}class Bs{constructor(t){this._elapsedTime=0,this._started=!1,this._stopped=!1,this._delay=t}update(t){this._started||(this._started=!0),this._elapsedTime+=t}isComplete(){return this._stopped||this._elapsedTime>=this._delay}stop(){this._stopped=!0}reset(){this._elapsedTime=0,this._started=!1}}class Is{constructor(t){this._stopped=!1,this._entity=t}update(t){this._entity.get(Os).clearActions(),this._entity.kill(),this._stopped=!0}isComplete(){return this._stopped}stop(){}reset(){}}class Fs{constructor(t,e,i){this._started=!1,this._stopped=!1,this._tx=t.get(Mi),this._motion=t.get(Di),this._followTx=e.get(Mi),this._followMotion=e.get(Di),this._current=new Y(this._tx.pos.x,this._tx.pos.y),this._end=new Y(this._followTx.pos.x,this._followTx.pos.y),this._maximumDistance=void 0!==i?i:this._current.distance(this._end),this._speed=0}update(t){this._started||(this._started=!0,this._distanceBetween=this._current.distance(this._end),this._dir=this._end.sub(this._current).normalize());const e=Math.sqrt(Math.pow(this._followMotion.vel.x,2)+Math.pow(this._followMotion.vel.y,2));if(0!==e&&(this._speed=e),this._current=Q(this._tx.pos.x,this._tx.pos.y),this._end=Q(this._followTx.pos.x,this._followTx.pos.y),this._distanceBetween=this._current.distance(this._end),this._dir=this._end.sub(this._current).normalize(),this._distanceBetween>=this._maximumDistance){const t=this._dir.scale(this._speed);this._motion.vel=Q(t.x,t.y)}else this._motion.vel=Q(0,0);this.isComplete()&&(this._tx.pos=Q(this._end.x,this._end.y),this._motion.vel=Q(0,0))}stop(){this._motion.vel=Q(0,0),this._stopped=!0}isComplete(){return this._stopped}reset(){this._started=!1}}class zs{constructor(t,e,i){this._started=!1,this._stopped=!1,this._speedWasSpecified=!1,this._tx=t.get(Mi),this._motion=t.get(Di),this._meetTx=e.get(Mi),this._meetMotion=e.get(Di),this._current=new Y(this._tx.pos.x,this._tx.pos.y),this._end=new Y(this._meetTx.pos.x,this._meetTx.pos.y),this._speed=i||0,void 0!==i&&(this._speedWasSpecified=!0)}update(t){this._started||(this._started=!0,this._distanceBetween=this._current.distance(this._end),this._dir=this._end.sub(this._current).normalize());const e=Math.sqrt(Math.pow(this._meetMotion.vel.x,2)+Math.pow(this._meetMotion.vel.y,2));0===e||this._speedWasSpecified||(this._speed=e),this._current=Q(this._tx.pos.x,this._tx.pos.y),this._end=Q(this._meetTx.pos.x,this._meetTx.pos.y),this._distanceBetween=this._current.distance(this._end),this._dir=this._end.sub(this._current).normalize();const i=this._dir.scale(this._speed);this._motion.vel=Q(i.x,i.y),this.isComplete()&&(this._tx.pos=Q(this._end.x,this._end.y),this._motion.vel=Q(0,0))}isComplete(){return this._stopped||this._distanceBetween<=1}stop(){this._motion.vel=Q(0,0),this._stopped=!0}reset(){this._started=!1}}class Ns{constructor(t){this._entity=t,this._queue=new xs(t)}getQueue(){return this._queue}update(t){this._queue.update(t)}clearActions(){this._queue.clearActions()}easeTo(...t){var e,i;let s=0,n=0,r=0,o=vs.Linear;return t[0]instanceof Y?(s=t[0].x,n=t[0].y,r=t[1],o=null!==(e=t[2])&&void 0!==e?e:o):(s=t[0],n=t[1],r=t[2],o=null!==(i=t[3])&&void 0!==i?i:o),this._queue.add(new Ms(this._entity,s,n,r,o)),this}moveTo(t,e,i){let s=0,n=0,r=0;return t instanceof Y?(s=t.x,n=t.y,r=e):(s=t,n=e,r=i),this._queue.add(new Es(this._entity,s,n,r)),this}moveBy(t,e,i){let s=0,n=0,r=0;return t instanceof Y?(s=t.x,n=t.y,r=e):(s=t,n=e,r=i),this._queue.add(new Cs(this._entity,s,n,r)),this}rotateTo(t,e,i){return this._queue.add(new Ps(this._entity,t,e,i)),this}rotateBy(t,e,i){return this._queue.add(new As(this._entity,t,e,i)),this}scaleTo(t,e,i,s){let n=1,r=1,o=0,a=0;return t instanceof Y&&e instanceof Y&&(n=t.x,r=t.y,o=e.x,a=e.y),"number"==typeof t&&"number"==typeof e&&(n=t,r=e,o=i,a=s),this._queue.add(new ks(this._entity,n,r,o,a)),this}scaleBy(t,e,i){let s=1,n=1;return t instanceof Y&&(s=t.x,n=t.y,i=e),"number"==typeof t&&"number"==typeof e&&(s=t,n=e),this._queue.add(new Ts(this._entity,s,n,i)),this}blink(t,e,i=1){return this._queue.add(new Ds(this._entity,t,e,i)),this}fade(t,e){return this._queue.add(new Ls(this._entity,t,e)),this}delay(t){return this._queue.add(new Bs(t)),this}die(){return this._queue.add(new Is(this._entity)),this}callMethod(t){return this._queue.add(new Rs(t)),this}repeat(t,e){return e?(this._queue.add(new bs(this._entity,t,e)),this):(this.repeatForever(t),this)}repeatForever(t){return this._queue.add(new Ss(this._entity,t)),this}follow(t,e){return void 0===e?this._queue.add(new Fs(this._entity,t)):this._queue.add(new Fs(this._entity,t,e)),this}meet(t,e){return void 0===e?this._queue.add(new zs(this._entity,t)):this._queue.add(new zs(this._entity,t,e)),this}asPromise(){return this.toPromise()}toPromise(){return new Promise((t=>{this._queue.add(new Rs((()=>{t()})))}))}}class Os extends Ai{constructor(){super(...arguments),this.type="ex.actions",this.dependencies=[Mi,Di]}onAdd(t){this._ctx=new Ns(t)}onRemove(){this._ctx=null}getQueue(){var t;return null===(t=this._ctx)||void 0===t?void 0:t.getQueue()}update(t){var e;return null===(e=this._ctx)||void 0===e?void 0:e.update(t)}clearActions(){var t;null===(t=this._ctx)||void 0===t||t.clearActions()}easeTo(...t){return this._ctx.easeTo.apply(this._ctx,t)}moveTo(t,e,i){return this._ctx.moveTo.apply(this._ctx,[t,e,i])}moveBy(t,e,i){return this._ctx.moveBy.apply(this._ctx,[t,e,i])}rotateTo(t,e,i){return this._ctx.rotateTo(t,e,i)}rotateBy(t,e,i){return this._ctx.rotateBy(t,e,i)}scaleTo(t,e,i,s){return this._ctx.scaleTo.apply(this._ctx,[t,e,i,s])}scaleBy(t,e,i){return this._ctx.scaleBy.apply(this._ctx,[t,e,i])}blink(t,e,i){return this._ctx.blink(t,e,i)}fade(t,e){return this._ctx.fade(t,e)}delay(t){return this._ctx.delay(t)}die(){return this._ctx.die()}callMethod(t){return this._ctx.callMethod(t)}repeat(t,e){return this._ctx.repeat(t,e)}repeatForever(t){return this._ctx.repeatForever(t)}follow(t,e){return this._ctx.follow(t,e)}meet(t,e){return this._ctx.meet(t,e)}asPromise(){return this.toPromise()}toPromise(){return this._ctx.toPromise()}}var Us=function(t,e,i,s){var n,r=arguments.length,o=r<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,s);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(o=(r<3?n(o):r>3?n(e,i,o):n(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};class Hs extends cs{constructor(t){super(),this._anchor=Et(Y.Half,(t=>this._handleAnchorChange(t))),this.logger=y.getInstance(),this.scene=null,this.frames={},this.currentDrawing=null,this._draggable=!1,this._dragging=!1,this._pointerDragStartHandler=()=>{this._dragging=!0},this._pointerDragEndHandler=()=>{this._dragging=!1},this._pointerDragMoveHandler=t=>{this._dragging&&(this.pos=t.pointer.lastWorldPos)},this._pointerDragLeaveHandler=t=>{this._dragging&&(this.pos=t.pointer.lastWorldPos)},this.traits=[],this.enableCapturePointer=!1,this.capturePointer={captureMoveEvents:!1,captureDragEvents:!1},this._capturePointerEvents=["pointerup","pointerdown","pointermove","pointerenter","pointerleave","pointerdragstart","pointerdragend","pointerdragmove","pointerdragenter","pointerdragleave"],this._captureMoveEvents=["pointermove","pointerenter","pointerleave","pointerdragmove","pointerdragenter","pointerdragleave"],this._captureDragEvents=["pointerdragstart","pointerdragend","pointerdragmove","pointerdragenter","pointerdragleave"];const{name:e,x:i,y:s,pos:n,scale:r,width:o,height:a,radius:h,collider:c,vel:d,acc:u,rotation:p,angularVelocity:g,z:m,color:_,visible:w,anchor:v,collisionType:x,collisionGroup:b}=Object.assign({},t);this._setName(e),this.anchor=null!=v?v:Hs.defaults.anchor.clone(),this.addComponent(new Mi),this.pos=null!=n?n:Q(null!=i?i:0,null!=s?s:0),this.rotation=null!=p?p:0,this.scale=null!=r?r:Q(1,1),this.z=null!=m?m:0,this.addComponent(new fs),this.addComponent(new ds(((t,e)=>this.draw(t,e)))),this.addComponent(new Di),this.vel=null!=d?d:Y.Zero,this.acc=null!=u?u:Y.Zero,this.angularVelocity=null!=g?g:0,this.addComponent(new Os),this.addComponent(new is),this.body.collisionType=null!=x?x:yi.Passive,b&&(this.body.group=b),c?this.addComponent(new Ji(c)):h?this.addComponent(new Ji($i.Circle(h,this.anchor))):o>0&&a>0?this.addComponent(new Ji($i.Box(o,a,this.anchor))):this.addComponent(new Ji),this.graphics.visible=null==w||w,_&&(this.color=_,o&&a?this.graphics.add(new ms({color:_,width:o,height:a})):h&&this.graphics.add(new ys({color:_,radius:h}))),f.isEnabled(l.LegacyDrawing)&&this.traits.push(new ns),this.traits.push(new rs)}get body(){return this.get(is)}get transform(){return this.get(Mi)}get motion(){return this.get(Di)}get graphics(){return this.get(fs)}get collider(){return this.get(Ji)}get actions(){return this.get(Os)}get pos(){return this.transform.pos}set pos(t){this.transform.pos=t.clone()}get oldPos(){return this.body.oldPos}set oldPos(t){this.body.oldPos.setTo(t.x,t.y)}get vel(){return this.motion.vel}set vel(t){this.motion.vel=t.clone()}get oldVel(){return this.body.oldVel}set oldVel(t){this.body.oldVel.setTo(t.x,t.y)}get acc(){return this.motion.acc}set acc(t){this.motion.acc=t.clone()}set oldAcc(t){this.body.oldAcc.setTo(t.x,t.y)}get oldAcc(){return this.body.oldAcc}get rotation(){return this.transform.rotation}set rotation(t){this.transform.rotation=t}get angularVelocity(){return this.motion.angularVelocity}set angularVelocity(t){this.motion.angularVelocity=t}get scale(){return this.get(Mi).scale}set scale(t){this.get(Mi).scale=t}get anchor(){return this._anchor}set anchor(t){this._anchor=Et(t,(t=>this._handleAnchorChange(t))),this._handleAnchorChange(t)}_handleAnchorChange(t){this.graphics&&(this.graphics.anchor=t)}get isOffScreen(){return this.hasTag("offscreen")}get visible(){return this.graphics.visible}set visible(t){this.graphics.visible=t}get opacity(){return this.graphics.opacity}set opacity(t){this.graphics.opacity=t}get draggable(){return this._draggable}set draggable(t){t&&(t&&!this._draggable?(this.on("pointerdragstart",this._pointerDragStartHandler),this.on("pointerdragend",this._pointerDragEndHandler),this.on("pointerdragmove",this._pointerDragMoveHandler),this.on("pointerdragleave",this._pointerDragLeaveHandler)):!t&&this._draggable&&(this.off("pointerdragstart",this._pointerDragStartHandler),this.off("pointerdragend",this._pointerDragEndHandler),this.off("pointerdragmove",this._pointerDragMoveHandler),this.off("pointerdragleave",this._pointerDragLeaveHandler)),this._draggable=t)}get color(){return this._color}set color(t){this._color=t.clone()}onInitialize(t){}_initialize(t){super._initialize(t);for(const e of this.children)e._initialize(t)}_checkForPointerOptIn(t){if(t){const e=t.toLowerCase();-1!==this._capturePointerEvents.indexOf(e)&&(this.enableCapturePointer=!0,-1!==this._captureMoveEvents.indexOf(e)&&(this.capturePointer.captureMoveEvents=!0),-1!==this._captureDragEvents.indexOf(e)&&(this.capturePointer.captureDragEvents=!0))}}on(t,e){this._checkForPointerOptIn(t),super.on(t,e)}once(t,e){this._checkForPointerOptIn(t),super.once(t,e)}off(t,e){super.off(t,e)}_prekill(t){super.emit("prekill",new Lt(this)),this.onPreKill(t)}onPreKill(t){}_postkill(t){super.emit("postkill",new Bt(this)),this.onPostKill(t)}onPostKill(t){}kill(){this.scene?(this._prekill(this.scene),this.emit("kill",new Dt(this)),super.kill(),this._postkill(this.scene)):this.logger.warn("Cannot kill actor, it was never added to the Scene")}unkill(){this.active=!0}isKilled(){return!this.active}setDrawing(t){t=t.toString(),this.currentDrawing!==this.frames[t]&&(null!=this.frames[t]?(this.frames[t].reset(),this.currentDrawing=this.frames[t]):y.getInstance().error(`the specified drawing key ${t} does not exist`)),this.currentDrawing&&this.currentDrawing instanceof Fe&&this.currentDrawing.tick(0)}addDrawing(){2===arguments.length?(this.frames[arguments[0]]=arguments[1],this.currentDrawing||(this.currentDrawing=arguments[1])):(arguments[0]instanceof Me&&this.addDrawing("default",arguments[0]),arguments[0]instanceof Ae&&this.addDrawing("default",arguments[0].asSprite()))}get z(){return this.get(Mi).z}getZIndex(){return this.get(Mi).z}set z(t){this.get(Mi).z=t}setZIndex(t){this.get(Mi).z=t}get center(){return new Y(this.pos.x+this.width/2-this.anchor.x*this.width,this.pos.y+this.height/2-this.anchor.y*this.height)}get width(){return this.collider.localBounds.width*this.getGlobalScale().x}get height(){return this.collider.localBounds.height*this.getGlobalScale().y}getGlobalRotation(){return this.get(Mi).globalRotation}getGlobalPos(){return this.get(Mi).globalPos}getGlobalScale(){return this.get(Mi).globalScale}contains(t,e,i=!1){const s=Q(t,e),n=this.get(Ji);n.update();const r=n.get();if(!r)return!1;const o=r.contains(s);return i?o||this.children.some((i=>i.contains(t,e,!0))):o}within(t,e){const i=this.get(Ji),s=t.get(Ji),n=i.get(),r=s.get();return!(!n||!r)&&n.getClosestLineBetween(r).getLength()<=e}update(t,e){this._initialize(t),this._preupdate(t,e);const i=this.currentDrawing;i&&i instanceof Fe&&i.tick(e,t.stats.currFrame.id);for(const i of this.traits)i.update(this,t,e);this._postupdate(t,e)}onPreUpdate(t,e){}onPostUpdate(t,e){}_preupdate(t,e){this.emit("preupdate",new Ht(t,e,this)),this.onPreUpdate(t,e)}_postupdate(t,e){this.emit("postupdate",new Ht(t,e,this)),this.onPostUpdate(t,e)}draw(t,e){var i;if(t.save(),this.currentDrawing){t.translate(-this.width*this.anchor.x,-this.height*this.anchor.y),this._predraw(t,e);const i=this.currentDrawing,s=(this.width-i.width*i.scale.x)*this.anchor.x,n=(this.height-i.height*i.scale.y)*this.anchor.y;this.currentDrawing.draw({ctx:t,x:s,y:n,opacity:this.graphics.opacity})}else if(this._predraw(t,e),this.color&&this.collider){const e=this.get(Ji);e.update(),e&&!e.bounds.hasZeroDimensions()&&(t.globalAlpha=this.graphics.opacity,null===(i=e.get())||void 0===i||i.draw(t,this.color,Q(0,0)))}t.restore(),this._postdraw(t,e)}onPreDraw(t,e){}onPostDraw(t,e){}_predraw(t,e){this.emit("predraw",new zt(t,e,this)),this.onPreDraw(t,e)}_postdraw(t,e){this.emit("postdraw",new zt(t,e,this)),this.onPostDraw(t,e)}debugDraw(t){}}Hs.defaults={anchor:Y.Half},Us([K({message:"Actor.visible will be removed in v0.26.0",alternateMethod:"Use Actor.graphics.visible"})],Hs.prototype,"visible",null),Us([K({message:"Actor.opacity will be removed in v0.26.0",alternateMethod:"Use Actor.graphics.opacity"})],Hs.prototype,"opacity",null),Us([K({message:"Actor.setDrawing will be removed in v0.26.0",alternateMethod:"Use Actor.graphics.show() or Actor.graphics.use()"})],Hs.prototype,"setDrawing",null),Us([K({message:"Actor.addDrawing will be removed in v0.26.0",alternateMethod:"Use Actor.graphics.add()"})],Hs.prototype,"addDrawing",null),Us([K({message:"Actor.getZIndex will be removed in v0.26.0",alternateMethod:"Use Actor.transform.z or Actor.z"})],Hs.prototype,"getZIndex",null),Us([K({message:"Actor.setZIndex will be removed in v0.26.0",alternateMethod:"Use Actor.transform.z or Actor.z"})],Hs.prototype,"setZIndex",null);class Ws extends Hs{constructor(t){super(Object.assign({},t)),this.get(Mi).coordPlane=Ti.Screen,this.traits=[],this.traits.push(new rs),this.anchor=Q(0,0),this.body.collisionType=yi.PreventCollision,this.collider.useBoxCollider(this.width,this.height,this.anchor),this.enableCapturePointer=!0}_initialize(t){this._engine=t,super._initialize(t)}contains(t,e,i=!0){if(i)return super.contains(t,e);const s=this._engine.worldToScreenCoordinates(new Y(t,e));return super.contains(s.x,s.y)}}class js{constructor(t,e,i,s){if(this._logger=y.getInstance(),this.id=0,this._elapsedTime=0,this._totalTimeAlive=0,this._running=!1,this._numberOfTicks=0,this.interval=10,this.repeats=!1,this.maxNumberOfRepeats=-1,this._complete=!1,this.scene=null,"function"!=typeof t){const n=t;t=n.fcn,e=n.interval,i=n.repeats,s=n.numberOfRepeats}if(s&&s>=0&&(this.maxNumberOfRepeats=s,!i))throw new Error("repeats must be set to true if numberOfRepeats is set");this.id=js._MAX_ID++,this.interval=e||this.interval,this.repeats=i||this.repeats,this._callbacks=[],t&&this.on(t)}get complete(){return this._complete}on(t){this._callbacks.push(t)}off(t){const e=this._callbacks.indexOf(t);this._callbacks.splice(e,1)}update(t){this._running&&(this._totalTimeAlive+=t,this._elapsedTime+=t,this.maxNumberOfRepeats>-1&&this._numberOfTicks>=this.maxNumberOfRepeats&&(this._complete=!0,this._running=!1,this._elapsedTime=0),!this.complete&&this._elapsedTime>=this.interval&&(this._callbacks.forEach((t=>{t.call(this)})),this._numberOfTicks++,this.repeats||(this._complete=!0,this._running=!1),this._elapsedTime=0))}reset(t,e){if(t&&t>=0&&(this.interval=t),this.maxNumberOfRepeats&&this.maxNumberOfRepeats>=0&&(this.maxNumberOfRepeats=e,!this.repeats))throw new Error("repeats must be set to true if numberOfRepeats is set");this._complete=!1,this._elapsedTime=0,this._numberOfTicks=0}get timesRepeated(){return this._numberOfTicks}getTimeRunning(){return this._totalTimeAlive}get timeToNextAction(){return this.complete?0:this.interval-this._elapsedTime}get timeElapsedTowardNextAction(){return this._elapsedTime}get isRunning(){return this._running}pause(){return this._running=!1,this}unpause(){this._running=!0}resume(){return this._running=!0,this}start(){return this.scene||this._logger.warn("Cannot start a timer not part of a scene, timer wont start until added"),this._running=!0,this.complete&&(this._complete=!1,this._elapsedTime=0,this._numberOfTicks=0),this}stop(){return this._running=!1,this._elapsedTime=0,this._numberOfTicks=0,this}cancel(){this.pause(),this.scene&&this.scene.cancelTimer(this)}}js._MAX_ID=0,function(t,e,i,s){var n,r=arguments.length,o=r<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,s);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(o=(r<3?n(o):r>3?n(e,i,o):n(e,i))||o);r>3&&o&&Object.defineProperty(e,i,o)}([K({message:"Will be removed in v0.26.0",alternateMethod:"Use Timer.resume()"})],js.prototype,"unpause",null);var Vs,qs,Xs=function(t,e,i,s){var n,r=arguments.length,o=r<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,s);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(o=(r<3?n(o):r>3?n(e,i,o):n(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};class Gs extends cs{constructor(t,e,i,s,n,r){if(super(),this._token=0,this._onScreenXStart=0,this._onScreenXEnd=9999,this._onScreenYStart=0,this._onScreenYEnd=9999,this._spriteSheets={},this._legacySpriteMap=new Map,this.logger=y.getInstance(),this.data=[],this._rows=[],this._cols=[],this.visible=!0,this.isOffscreen=!1,this._dirty=!0,t&&"object"==typeof t){const o=t;t=o.x,e=o.y,i=o.cellWidth,s=o.cellHeight,n=o.rows,r=o.cols}this.addComponent(new Mi),this.addComponent(new Di),this.addComponent(new is({type:yi.Fixed})),this.addComponent(new ds(((t,e)=>this.draw(t,e)))),this.addComponent(new fs({onPostDraw:(t,e)=>this.draw(t,e)})),this.addComponent(new Ji),this._transform=this.get(Mi),this._motion=this.get(Di),this._collider=this.get(Ji),this._composite=this._collider.useCompositeCollider([]),this.x=t,this.y=e,this.cellWidth=i,this.cellHeight=s,this.rows=n,this.cols=r,this.data=new Array(n*r),this._rows=new Array(n),this._cols=new Array(r);let o=[];for(let a=0;a<r;a++){for(let l=0;l<n;l++){const n=new Qs(a*i+t,l*s+e,i,s,a+l*r);n.map=this,this.data[a+l*r]=n,o.push(n),this._rows[l]||(this._rows[l]=[]),this._rows[l].push(n)}this._cols[a]=o,o=[]}this.get(fs).localBounds=new it({left:0,top:0,right:this.cols*this.cellWidth,bottom:this.rows*this.cellHeight})}flagDirty(){this._dirty=!0}get x(){var t;return null!==(t=this._transform.pos.x)&&void 0!==t?t:0}set x(t){var e;(null===(e=this._transform)||void 0===e?void 0:e.pos)&&(this.get(Mi).pos=Q(t,this.y))}get y(){var t,e;return null!==(e=null===(t=this._transform)||void 0===t?void 0:t.pos.y)&&void 0!==e?e:0}set y(t){var e;(null===(e=this._transform)||void 0===e?void 0:e.pos)&&(this._transform.pos=Q(this.x,t))}get z(){var t;return null!==(t=this._transform.z)&&void 0!==t?t:0}set z(t){this._transform&&(this._transform.z=t)}get rotation(){var t,e;return null!==(e=null===(t=this._transform)||void 0===t?void 0:t.rotation)&&void 0!==e?e:0}set rotation(t){var e;(null===(e=this._transform)||void 0===e?void 0:e.rotation)&&(this._transform.rotation=t)}get scale(){var t,e;return null!==(e=null===(t=this._transform)||void 0===t?void 0:t.scale)&&void 0!==e?e:Y.One}set scale(t){var e;(null===(e=this._transform)||void 0===e?void 0:e.scale)&&(this._transform.scale=t)}get pos(){return this._transform.pos}set pos(t){this._transform.pos=t}get vel(){return this._motion.vel}set vel(t){this._motion.vel=t}on(t,e){super.on(t,e)}_initialize(t){super._initialize(t)}registerSpriteSheet(t,e){this._spriteSheets[t]=e instanceof Ye?e:Ye.fromLegacySpriteSheet(e)}_updateColliders(){this._composite.clearColliders();const t=[];let e;for(let i=0;i<this.cols;i++){for(let s=0;s<this.rows;s++){0===s&&(e=null);const n=this.data[i+s*this.cols];n.solid?e=e?e.combine(n.bounds):n.bounds:(e&&t.push(e),e=null)}if(e){const i=t[t.length-1];i&&i.top===e.top&&i.bottom===e.bottom?t[t.length-1]=i.combine(e):t.push(e)}}this._composite=this._collider.useCompositeCollider([]);for(const e of t){const t=$i.Box(e.width,e.height,Y.Zero,Q(e.left-this.pos.x,e.top-this.pos.y));t.owner=this,this._composite.addCollider(t)}this._collider.update()}getCellByIndex(t){return this.data[t]}getCell(t,e){return t<0||e<0||t>=this.cols||e>=this.rows?null:this.data[t+e*this.cols]}getCellByPoint(t,e){t=Math.floor((t-this.pos.x)/this.cellWidth),e=Math.floor((e-this.pos.y)/this.cellHeight);const i=this.getCell(t,e);return t>=0&&e>=0&&t<this.cols&&e<this.rows&&i?i:null}getRows(){return this._rows}getColumns(){return this._cols}onPreUpdate(t,e){}onPostUpdate(t,e){}update(t,e){this.onPreUpdate(t,e),this.emit("preupdate",new Ht(t,e,this)),this._dirty&&(this._dirty=!1,this._updateColliders()),this._token++;const i=t.getWorldBounds(),s=Q(i.left,i.top),n=Q(i.right,i.bottom);this._onScreenXStart=Math.max(Math.floor((s.x-this.x)/this.cellWidth)-2,0),this._onScreenYStart=Math.max(Math.floor((s.y-this.y)/this.cellHeight)-2,0),this._onScreenXEnd=Math.max(Math.floor((n.x-this.x)/this.cellWidth)+2,0),this._onScreenYEnd=Math.max(Math.floor((n.y-this.y)/this.cellHeight)+2,0),this._transform.pos=Q(this.x,this.y),this.onPostUpdate(t,e),this.emit("postupdate",new Wt(t,e,this))}draw(t,e){this.emit("predraw",new zt(t,e,this));let i=this._onScreenXStart;const s=Math.min(this._onScreenXEnd,this.cols);let n=this._onScreenYStart;const r=Math.min(this._onScreenYEnd,this.rows);let o,a,l;for(;i<s;i++){for(;n<r;n++)for(o=this.getCell(i,n).graphics,a=0,l=o.length;a<l;a++){const s=o[a];s&&(t instanceof CanvasRenderingContext2D?s instanceof De&&(this._legacySpriteMap.has(s)||this._legacySpriteMap.set(s,De.toLegacySprite(s)),this._legacySpriteMap.get(s).draw(t,i*this.cellWidth,n*this.cellHeight)):(us(s)&&(null==s||s.tick(e,this._token)),s.draw(t,i*this.cellWidth,n*this.cellHeight)))}n=this._onScreenYStart}this.emit("postdraw",new Nt(t,e,this))}}Xs([K({message:"No longer used, will be removed in v0.26.0"})],Gs.prototype,"registerSpriteSheet",null);class Ks extends(ke(Gs)){constructor(t,e,i,s,n,r){super(t,e,i,s,n,r)}}class Ys extends cs{constructor(t,e,i,s,n,r=!1,o=[]){if(super(),this._solid=!1,this.graphics=[],this.data=new Map,t&&"object"==typeof t){const a=t;t=a.x,e=a.y,i=a.width,s=a.height,n=a.index,r=a.solid,o=a.sprites}this.x=t,this.y=e,this.width=i,this.height=s,this.index=n,this.solid=r,this.graphics=o,this._bounds=new it(this.x,this.y,this.x+this.width,this.y+this.height)}get solid(){return this._solid}set solid(t){var e;null===(e=this.map)||void 0===e||e.flagDirty(),this._solid=t}get bounds(){return this._bounds}get center(){return new Y(this.x+this.width/2,this.y+this.height/2)}pushSprite(t){this.addGraphic(t)}addGraphic(t){t instanceof Me?this.graphics.push(De.fromLegacySprite(t)):this.graphics.push(t)}removeGraphic(t){F(t,this.graphics)}clearGraphics(){this.graphics.length=0}}Xs([K({message:"Will be removed in v0.26.0",alternateMethod:"addSprite"})],Ys.prototype,"pushSprite",null);class Qs extends(ke(Ys)){constructor(t,e,i,s,n,r,o){super(t,e,i,s,n,r,o)}}class Zs{constructor(t){this.camera=t}lockToActor(t){this.camera.addStrategy(new $s(t))}lockToActorAxis(t,e){this.camera.addStrategy(new Js(t,e))}elasticToActor(t,e,i){this.camera.addStrategy(new tn(t,e,i))}radiusAroundActor(t,e){this.camera.addStrategy(new en(t,e))}limitCameraBounds(t){this.camera.addStrategy(new sn(t))}}(qs=Vs||(Vs={}))[qs.X=0]="X",qs[qs.Y=1]="Y";class $s{constructor(t){this.target=t,this.action=(t,e,i,s)=>t.center}}class Js{constructor(t,e){this.target=t,this.axis=e,this.action=(t,e,i,s)=>{const n=t.center,r=e.getFocus();return this.axis===Vs.X?new Y(n.x,r.y):new Y(r.x,n.y)}}}class tn{constructor(t,e,i){this.target=t,this.cameraElasticity=e,this.cameraFriction=i,this.action=(t,e,i,s)=>{const n=t.center;let r=e.getFocus(),o=e.vel.clone();const a=n.sub(r).scale(this.cameraElasticity);o=o.add(a);const l=o.scale(-1).scale(this.cameraFriction);return o=o.add(l),r=r.add(o),r}}}class en{constructor(t,e){this.target=t,this.radius=e,this.action=(t,e,i,s)=>{const n=t.center,r=e.getFocus(),o=n.sub(r),a=o.size;if(a>=this.radius){const t=a-this.radius;return r.add(o.normalize().scale(t))}return r}}}class sn{constructor(t){this.target=t,this.boundSizeChecked=!1,this.action=(t,e,i,s)=>{const n=e.getFocus();this.boundSizeChecked||((t.bottom-t.top<i.drawHeight||t.right-t.left<i.drawWidth)&&y.getInstance().warn("Camera bounds should not be smaller than the engine viewport"),this.boundSizeChecked=!0);let r=n.x,o=n.y;return n.x<t.left+i.halfDrawWidth?r=t.left+i.halfDrawWidth:n.x>t.right-i.halfDrawWidth&&(r=t.right-i.halfDrawWidth),n.y<t.top+i.halfDrawHeight?o=t.top+i.halfDrawHeight:n.y>t.bottom-i.halfDrawHeight&&(o=t.bottom-i.halfDrawHeight),Q(r,o)}}}class nn extends oi{constructor(){super(...arguments),this._cameraStrategies=[],this.strategy=new Zs(this),this._z=1,this.dz=0,this.az=0,this.rotation=0,this.rx=0,this._posChanged=!1,this._pos=Pt(Y.Zero,(()=>this._posChanged=!0)),this.vel=Y.Zero,this.acc=Y.Zero,this._cameraMoving=!1,this._currentLerpTime=0,this._lerpDuration=1e3,this._lerpStart=null,this._lerpEnd=null,this._isShaking=!1,this._shakeMagnitudeX=0,this._shakeMagnitudeY=0,this._shakeDuration=0,this._elapsedShakeTime=0,this._xShake=0,this._yShake=0,this._isZooming=!1,this._zoomStart=1,this._zoomEnd=1,this._currentZoomTime=0,this._zoomDuration=0,this._zoomEasing=vs.EaseInOutCubic,this._easing=vs.EaseInOutCubic,this._halfWidth=0,this._halfHeight=0,this._viewport=null,this._isInitialized=!1}get zoom(){return this._z}set zoom(t){this._z=t,this._engine&&(this._halfWidth=this._engine.halfDrawWidth,this._halfHeight=this._engine.halfDrawHeight)}get angularVelocity(){return this.rx}set angularVelocity(t){this.rx=t}get pos(){return this._pos}set pos(t){this._pos=Pt(t,(()=>this._posChanged=!0)),this._posChanged=!0}get x(){return this.pos.x}set x(t){this._follow||this._cameraMoving||(this.pos=Q(t,this.pos.y))}get y(){return this.pos.y}set y(t){this._follow||this._cameraMoving||(this.pos=Q(this.pos.x,t))}get dx(){return this.vel.x}set dx(t){this.vel=Q(t,this.vel.y)}get dy(){return this.vel.y}set dy(t){this.vel=Q(this.vel.x,t)}get ax(){return this.acc.x}set ax(t){this.acc=Q(t,this.acc.y)}get ay(){return this.acc.y}set ay(t){this.acc=Q(this.acc.x,t)}getFocus(){return this.pos}move(t,e,i=vs.EaseInOutCubic){if("function"!=typeof i)throw"Please specify an EasingFunction";return this._follow?Promise.reject(t):(this._lerpPromise&&this._lerpResolve&&this._lerpResolve(t),this._lerpPromise=new Promise((t=>{this._lerpResolve=t})),this._lerpStart=this.getFocus().clone(),this._lerpDuration=e,this._lerpEnd=t,this._currentLerpTime=0,this._cameraMoving=!0,this._easing=i,this._lerpPromise)}shake(t,e,i){this._isShaking=!0,this._shakeMagnitudeX=t,this._shakeMagnitudeY=e,this._shakeDuration=i}zoomOverTime(t,e=0,i=vs.EaseInOutCubic){return this._zoomPromise=new Promise((t=>{this._zoomResolve=t})),e?(this._isZooming=!0,this._zoomEasing=i,this._currentZoomTime=0,this._zoomDuration=e,this._zoomStart=this.zoom,this._zoomEnd=t,this._zoomPromise):(this._isZooming=!1,this.zoom=t,Promise.resolve(!0))}get viewport(){return this._viewport?this._viewport:new it(0,0,0,0)}addStrategy(t){this._cameraStrategies.push(t)}removeStrategy(t){F(t,this._cameraStrategies)}clearAllStrategies(){this._cameraStrategies.length=0}_preupdate(t,e){this.emit("preupdate",new Ht(t,e,this)),this.onPreUpdate(t,e)}onPreUpdate(t,e){}_postupdate(t,e){this.emit("postupdate",new Wt(t,e,this)),this.onPostUpdate(t,e)}onPostUpdate(t,e){}get isInitialized(){return this._isInitialized}_initialize(t){if(!this.isInitialized){this._engine=t;const e=this._engine.screen.resolution;let i=Q(e.width/2,e.height/2);if(!this._engine.loadingComplete){const t=this._engine.screen.peekResolution();t&&(i=Q(t.width/2,t.height/2))}this._halfWidth=i.x,this._halfHeight=i.x,this._posChanged||(this.pos=i),this.onInitialize(t),super.emit("initialize",new ae(t,this)),this._isInitialized=!0}}onInitialize(t){}on(t,e){super.on(t,e)}off(t,e){super.off(t,e)}once(t,e){super.once(t,e)}update(t,e){if(this._initialize(t),this._preupdate(t,e),this.pos=this.pos.add(this.vel.scale(e/1e3)),this.zoom+=this.dz*e/1e3,this.vel=this.vel.add(this.acc.scale(e/1e3)),this.dz+=this.az*e/1e3,this.rotation+=this.angularVelocity*e/1e3,this._isZooming)if(this._currentZoomTime<this._zoomDuration){const t=(0,this._zoomEasing)(this._currentZoomTime,this._zoomStart,this._zoomEnd,this._zoomDuration);this.zoom=t,this._currentZoomTime+=e}else this._isZooming=!1,this.zoom=this._zoomEnd,this._currentZoomTime=0,this._zoomResolve(!0);if(this._cameraMoving)if(this._currentLerpTime<this._lerpDuration){const t=vs.CreateVectorEasingFunction(this._easing)(this._currentLerpTime,this._lerpStart,this._lerpEnd,this._lerpDuration);this.pos=t,this._currentLerpTime+=e}else{this.pos=this._lerpEnd;const t=this._lerpEnd.clone();this._lerpStart=null,this._lerpEnd=null,this._currentLerpTime=0,this._cameraMoving=!1,this._lerpResolve(t)}this._isDoneShaking()?(this._isShaking=!1,this._elapsedShakeTime=0,this._shakeMagnitudeX=0,this._shakeMagnitudeY=0,this._shakeDuration=0,this._xShake=0,this._yShake=0):(this._elapsedShakeTime+=e,this._xShake=1+(Math.random()*this._shakeMagnitudeX|0),this._yShake=1+(Math.random()*this._shakeMagnitudeY|0));for(const i of this._cameraStrategies)this.pos=i.action.call(i,i.target,this,t,e);this._viewport=new it(this.x-this._halfWidth,this.y-this._halfHeight,this.x+this._halfWidth,this.y+this._halfHeight),this._postupdate(t,e)}draw(t){let e=0,i=0;t instanceof CanvasRenderingContext2D?(e=t.canvas.width,i=t.canvas.height):(e=t.width,i=t.height);const s=this.getFocus(),n=this._engine?this._engine.pixelRatio:1,r=this.zoom,o=e/r/n,a=i/r/n;t.scale(r,r),t.translate(-s.x+o/2+this._xShake,-s.y+a/2+this._yShake)}debugDraw(t){}_isDoneShaking(){return!this._isShaking||this._elapsedShakeTime>=this._shakeDuration}}function rn(t){return t instanceof Ws}const on={pos:Y.Zero,width:10,height:10,visible:!1,action:()=>{},filter:()=>!0,repeat:-1};class an extends Hs{constructor(t){super({x:t.pos.x,y:t.pos.y,width:t.width,height:t.height}),this.action=()=>{},this.filter=()=>!0,this.repeat=-1,t=E({},on,t),this.filter=t.filter||this.filter,this.repeat=t.repeat||this.repeat,this.action=t.action||this.action,t.target&&(this.target=t.target),this.graphics.visible=t.visible,this.body.collisionType=yi.Passive,this.eventDispatcher=new ge(this),this.events.on("collisionstart",(t=>{this.filter(t.other)&&(this.emit("enter",new ue(this,t.other)),this._dispatchAction(),0===this.repeat&&this.kill())})),this.events.on("collisionend",(t=>{this.filter(t.other)&&this.emit("exit",new pe(this,t.other))}))}set target(t){this._target=t,this.filter=e=>e===t}get target(){return this._target}_initialize(t){super._initialize(t)}_dispatchAction(){0!==this.repeat&&(this.action.call(this),this.repeat--)}debugDraw(t){super.debugDraw(t),t.save(),t.translate(this.pos.x,this.pos.y);const e=this.collider.bounds,i=this.getGlobalPos();e.left=e.left-i.x,e.right=e.right-i.x,e.top=e.top-i.y,e.bottom=e.bottom-i.y,t.fillStyle=tt.Violet.toString(),t.strokeStyle=tt.Violet.toString(),t.fillText("Trigger",10,10),e.debugDraw(t),t.restore()}}var ln,hn;(hn=ln||(ln={})).Update="update",hn.Draw="draw";class cn{constructor(){this.priority=0}notify(t){}}class dn{constructor(t){this.data=t,this.type="Entity Added"}}function un(t){return!!t&&"Entity Added"===t.type}class pn{constructor(t){this.data=t,this.type="Entity Removed"}}function gn(t){return!!t&&"Entity Removed"===t.type}class fn{constructor(t){this._world=t,this.entities=[],this._entityIndex={},this._entitiesToRemove=[]}updateEntities(t,e){for(const i of this.entities)i.update(t.engine,e),i.active||this.removeEntity(i)}findEntitiesForRemoval(){for(const t of this.entities)t.active||this.removeEntity(t)}notify(t){as(t)&&this._world.queryManager.addEntity(t.data.entity),hs(t)&&this._world.queryManager.removeComponent(t.data.entity,t.data.component)}addEntity(t){t.active=!0,t&&!this._entityIndex[t.id]&&(this._entityIndex[t.id]=t,this.entities.push(t),this._world.queryManager.addEntity(t),t.componentAdded$.register(this),t.componentRemoved$.register(this),t.children.forEach((t=>this.addEntity(t))),t.childrenAdded$.register({notify:t=>{this.addEntity(t)}}),t.childrenRemoved$.register({notify:t=>{this.removeEntity(t,!1)}}))}removeEntity(t,e=!0){var i;let s=0;s=t instanceof cs?t.id:t;const n=this._entityIndex[s];n&&n.active&&n.kill(),n&&e?this._entitiesToRemove.push(n):(delete this._entityIndex[s],n&&(F(n,this.entities),this._world.queryManager.removeEntity(n),n.componentAdded$.unregister(this),n.componentRemoved$.unregister(this),n.children.forEach((t=>this.removeEntity(t,e))),n.childrenAdded$.clear(),n.childrenRemoved$.clear(),(null===(i=this._world.context)||void 0===i?void 0:i.engine)&&this._world.context.engine.stats.currFrame.actors.killed++))}processEntityRemovals(){for(const t of this._entitiesToRemove)t.active||this.removeEntity(t,!1)}processComponentRemovals(){for(const t of this.entities)t.processComponentRemoval()}getById(t){return this._entityIndex[t]}getByName(t){return this.entities.filter((e=>e.name===t))}clear(){for(const t of this.entities)this.removeEntity(t)}}const mn=t=>[...t].sort(((t,e)=>t.localeCompare(e))).join("+");class yn extends Bi{constructor(t){super(),this._entities=[],t[0]instanceof Function?this.types=t.map((t=>(new t).type)):this.types=t}get key(){return this._key?this._key:this._key=mn(this.types)}getEntities(t){return t&&this._entities.sort(t),this._entities}addEntity(t){!z(this._entities,t)&&this.matches(t)&&(this._entities.push(t),this.notifyAll(new dn(t)))}removeEntity(t){F(t,this._entities)&&this.notifyAll(new pn(t))}clear(){this._entities.length=0;for(const t of this.observers)this.unregister(t)}matches(t){let e=[];e=t instanceof cs?t.types:t;let i=!0;for(const t of this.types)if(i=i&&e.indexOf(t)>-1,!i)return!1;return i}contain(t){return this.types.indexOf(t)>-1}}class _n{constructor(t){this._world=t,this._queries={}}_addQuery(t){this._queries[mn(t.types)]=t;for(const e of this._world.entityManager.entities)t.addEntity(e)}maybeRemoveQuery(t){0===t.observers.length&&(t.clear(),delete this._queries[mn(t.types)])}addEntity(t){for(const e in this._queries)this._queries[e]&&this._queries[e].addEntity(t)}removeComponent(t,e){for(const i in this._queries)this._queries[i].contain(e.type)&&this._queries[i].removeEntity(t)}removeEntity(t){for(const e in this._queries)this._queries[e].removeEntity(t)}createQuery(t){const e=this.getQuery(t);if(e)return e;const i=new yn(t);return this._addQuery(i),i}getQuery(t){const e=mn(t);return this._queries[e]?this._queries[e]:null}}class wn{constructor(t){this._world=t,this.systems=[],this.initialized=!1}get(t){return this.systems.find((e=>e instanceof t))}addSystem(t){if(!t.types||0===t.types.length)throw new Error("Attempted to add a System without any types");const e=this._world.queryManager.createQuery(t.types);this.systems.push(t),this.systems.sort(((t,e)=>t.priority-e.priority)),e.register(t),this.initialized&&t.initialize&&t.initialize(this._world.context)}removeSystem(t){F(t,this.systems);const e=this._world.queryManager.getQuery(t.types);e&&(e.unregister(t),this._world.queryManager.maybeRemoveQuery(e))}updateSystems(t,e,i){if(!this.initialized){this.initialized=!0;for(const t of this.systems)t.initialize&&t.initialize(this._world.context)}const s=this.systems.filter((e=>e.systemType===t));for(const t of s)t.preupdate&&t.preupdate(e,i);for(const t of s){const s=this._world.queryManager.getQuery(t.types).getEntities(t.sort);if(e instanceof nr)for(const t of s)t._initialize(null==e?void 0:e.engine);t.update(s,i)}for(const t of s)t.postupdate&&t.postupdate(e,i)}clear(){for(const t of this.systems)this.removeSystem(t)}}class vn{constructor(t){this.context=t,this.queryManager=new _n(this),this.entityManager=new fn(this),this.systemManager=new wn(this)}update(t,e){t===ln.Update&&this.entityManager.updateEntities(this.context,e),this.systemManager.updateSystems(t,this.context,e),this.entityManager.findEntitiesForRemoval(),this.entityManager.processComponentRemovals(),this.entityManager.processEntityRemovals()}add(t){t instanceof cs&&this.entityManager.addEntity(t),t instanceof cn&&this.systemManager.addSystem(t)}remove(t,e=!0){t instanceof cs&&this.entityManager.removeEntity(t,e),t instanceof cn&&this.systemManager.removeSystem(t)}clearEntities(){this.entityManager.clear()}clearSystems(){this.systemManager.clear()}}class xn{static integrate(t,e,i,s){const n=s/1e3;e.vel.addEqual(i.scale(n)),t.pos.addEqual(e.vel.scale(n)).addEqual(i.scale(.5*n*n)),e.angularVelocity+=e.torque*(1/e.inertia)*n,t.rotation+=e.angularVelocity*n,t.scale.addEqual(e.scaleFactor.scale(n))}}class bn extends cn{constructor(){super(...arguments),this.types=["ex.transform","ex.motion"],this.systemType=ln.Update,this.priority=-1}update(t,e){let i,s;for(const n of t){i=n.get(Mi),s=n.get(Di);const t=n.get(is);if(null==t?void 0:t.sleeping)continue;const r=s.acc.clone();(null==t?void 0:t.collisionType)===yi.Active&&(null==t?void 0:t.useGravity)&&r.addEqual(Ei.gravity),null==t||t.captureOldTransform(),xn.integrate(i,s,r,e)}}debugDraw(t){}}class Sn{solve(t){return this.preSolve(t),t=t.filter((t=>!t.isCanceled())),this.solveVelocity(t),this.solvePosition(t),this.postSolve(t),t}}class Cn extends Sn{preSolve(t){for(const e of t){const t=b.fromDirection(e.mtv),i=e.mtv.negate();e.colliderA.events.emit("precollision",new Jt(e.colliderA,e.colliderB,t,i)),e.colliderB.events.emit("precollision",new Jt(e.colliderB,e.colliderA,b.getOpposite(t),i.negate()))}}postSolve(t){var e,i;for(const s of t){const t=s.colliderA,n=s.colliderB,r=null===(e=t.owner)||void 0===e?void 0:e.get(is),o=null===(i=n.owner)||void 0===i?void 0:i.get(is);if(r&&o&&(r.collisionType===yi.Passive||o.collisionType===yi.Passive))continue;const a=b.fromDirection(s.mtv),l=s.mtv.negate();s.colliderA.events.emit("postcollision",new te(s.colliderA,s.colliderB,a,l)),s.colliderB.events.emit("postcollision",new te(s.colliderB,s.colliderA,b.getOpposite(a),l.negate()))}}solvePosition(t){var e,i;for(const s of t){let t=s.mtv;const n=s.colliderA,r=s.colliderB,o=null===(e=n.owner)||void 0===e?void 0:e.get(is),a=null===(i=r.owner)||void 0===i?void 0:i.get(is);if(o&&a){if(o.collisionType===yi.Passive||a.collisionType===yi.Passive)continue;o.collisionType===yi.Active&&a.collisionType===yi.Active&&(t=t.scale(.5)),o.collisionType===yi.Active&&(o.pos.x-=t.x,o.pos.y-=t.y),a.collisionType===yi.Active&&(a.pos.x+=t.x,a.pos.y+=t.y)}}}solveVelocity(t){var e,i;for(const s of t){const t=s.colliderA,n=s.colliderB,r=null===(e=t.owner)||void 0===e?void 0:e.get(is),o=null===(i=n.owner)||void 0===i?void 0:i.get(is);if(r&&o){if(r.collisionType===yi.Passive||o.collisionType===yi.Passive)continue;const t=s.normal,e=t.negate();if(r.collisionType===yi.Active){const e=t.scale(t.dot(r.vel.negate()));r.vel=r.vel.add(e)}if(o.collisionType===yi.Active){const t=e.scale(e.dot(o.vel.negate()));o.vel=o.vel.add(t)}}}}}class En{constructor(t,e,i){this.point=t,this.local=e,this.contact=i,this.normalImpulse=0,this.tangentImpulse=0,this.normalMass=0,this.tangentMass=0,this.aToContact=new Y(0,0),this.bToContact=new Y(0,0),this.update()}update(){var t,e;const i=null===(t=this.contact.colliderA.owner)||void 0===t?void 0:t.get(is),s=null===(e=this.contact.colliderB.owner)||void 0===e?void 0:e.get(is);if(i&&s){const t=this.contact.normal,e=this.contact.tangent;this.aToContact=this.point.sub(i.pos),this.bToContact=this.point.sub(s.pos);const n=this.aToContact.cross(t),r=this.bToContact.cross(t);this.normalMass=i.inverseMass+s.inverseMass+i.inverseInertia*n*n+s.inverseInertia*r*r;const o=this.aToContact.cross(e),a=this.bToContact.cross(e);this.tangentMass=i.inverseMass+s.inverseMass+i.inverseInertia*o*o+s.inverseInertia*a*a}return this}getRelativeVelocity(){var t,e;const i=null===(t=this.contact.colliderA.owner)||void 0===t?void 0:t.get(is),s=null===(e=this.contact.colliderB.owner)||void 0===e?void 0:e.get(is);if(i&&s){const t=i.vel.add(Y.cross(i.angularVelocity,this.aToContact));return s.vel.add(Y.cross(s.angularVelocity,this.bToContact)).sub(t)}return Y.Zero}}class Pn extends Sn{constructor(){super(...arguments),this.lastFrameContacts=new Map,this.idToContactConstraint=new Map}getContactConstraints(t){var e;return null!==(e=this.idToContactConstraint.get(t))&&void 0!==e?e:[]}preSolve(t){var e,i,s;for(const e of t){const t=b.fromDirection(e.mtv);e.colliderA.events.emit("precollision",new Jt(e.colliderA,e.colliderB,t,e.mtv)),e.colliderA.events.emit("beforecollisionresolve",new se(e.colliderA,e.colliderB,t,e.mtv,e)),e.colliderB.events.emit("precollision",new Jt(e.colliderB,e.colliderA,b.getOpposite(t),e.mtv.negate())),e.colliderB.events.emit("beforecollisionresolve",new se(e.colliderB,e.colliderA,b.getOpposite(t),e.mtv.negate(),e)),e.matchAwake()}const n=Array.from(this.idToContactConstraint.keys());for(const r of t){const t=n.indexOf(r.id);t>-1&&n.splice(t,1);const o=null!==(e=this.idToContactConstraint.get(r.id))&&void 0!==e?e:[];let a=0;const l=r.colliderA.owner.get(is),h=r.colliderB.owner.get(is);if(l&&h)for(const t of r.points){const e=r.normal,n=r.tangent,c=t.sub(l.pos),d=t.sub(h.pos),u=c.cross(e),p=d.cross(e),g=l.inverseMass+h.inverseMass+l.inverseInertia*u*u+h.inverseInertia*p*p,f=c.cross(n),m=d.cross(n),y=l.inverseMass+h.inverseMass+l.inverseInertia*f*f+h.inverseInertia*m*m;o[a]&&(null===(s=null===(i=o[a])||void 0===i?void 0:i.point)||void 0===s?void 0:s.squareDistance(t))<4?(o[a].point=t,o[a].local=r.localPoints[a]):o[a]=new En(t,r.localPoints[a],r),o[a].aToContact=c,o[a].bToContact=d,o[a].normalMass=g,o[a].tangentMass=y,a++}this.idToContactConstraint.set(r.id,o)}for(const t of n)this.idToContactConstraint.delete(t);if(Ei.warmStart)this.warmStart(t);else for(const e of t){const t=this.getContactConstraints(e.id);for(const e of t)e.normalImpulse=0,e.tangentImpulse=0}}postSolve(t){for(const e of t){const t=e.colliderA.owner.get(is),i=e.colliderB.owner.get(is);if(t&&i){if(t.collisionType===yi.Passive||i.collisionType===yi.Passive)continue;t.updateMotion(),i.updateMotion()}const s=b.fromDirection(e.mtv);e.colliderA.events.emit("postcollision",new te(e.colliderA,e.colliderB,s,e.mtv)),e.colliderA.events.emit("aftercollisionresolve",new ne(e.colliderA,e.colliderB,s,e.mtv,e)),e.colliderB.events.emit("postcollision",new te(e.colliderB,e.colliderA,b.getOpposite(s),e.mtv.negate())),e.colliderB.events.emit("aftercollisionresolve",new ne(e.colliderB,e.colliderA,b.getOpposite(s),e.mtv.negate(),e))}this.lastFrameContacts.clear();for(const e of t)this.lastFrameContacts.set(e.id,e)}warmStart(t){var e,i,s;for(const n of t){const t=null===(e=n.colliderA.owner)||void 0===e?void 0:e.get(is),r=null===(i=n.colliderB.owner)||void 0===i?void 0:i.get(is);if(t&&r){const e=null!==(s=this.idToContactConstraint.get(n.id))&&void 0!==s?s:[];for(const i of e)if(Ei.warmStart){const e=n.normal.scale(i.normalImpulse),s=n.tangent.scale(i.tangentImpulse),o=e.add(s);t.applyImpulse(i.point,o.negate()),r.applyImpulse(i.point,o)}else i.normalImpulse=0,i.tangentImpulse=0}}}solvePosition(t){var e,i,s;for(let n=0;n<Ei.positionIterations;n++)for(const n of t){const t=null===(e=n.colliderA.owner)||void 0===e?void 0:e.get(is),r=null===(i=n.colliderB.owner)||void 0===i?void 0:i.get(is);if(t&&r){if(t.collisionType===yi.Passive||r.collisionType===yi.Passive)continue;const e=null!==(s=this.idToContactConstraint.get(n.id))&&void 0!==s?s:[];for(const i of e){const e=n.normal,s=Yi.FindContactSeparation(n,i.local),o=-5,a=k(Ei.steeringFactor*(s+Ei.slop),o,0),l=e.scale(-a/i.normalMass);t.collisionType===yi.Active&&(t.pos=t.pos.add(l.negate().scale(t.inverseMass)),t.rotation-=i.aToContact.cross(l)*t.inverseInertia),r.collisionType===yi.Active&&(r.pos=r.pos.add(l.scale(r.inverseMass)),r.rotation+=i.bToContact.cross(l)*r.inverseInertia)}}}}solveVelocity(t){var e,i,s;for(let n=0;n<Ei.velocityIterations;n++)for(const n of t){const t=null===(e=n.colliderA.owner)||void 0===e?void 0:e.get(is),r=null===(i=n.colliderB.owner)||void 0===i?void 0:i.get(is);if(t&&r){if(t.collisionType===yi.Passive||r.collisionType===yi.Passive)continue;const e=t.bounciness*r.bounciness,i=Math.min(t.friction,r.friction),o=null!==(s=this.idToContactConstraint.get(n.id))&&void 0!==s?s:[];for(const e of o){let s=-e.getRelativeVelocity().dot(n.tangent)/e.tangentMass;const o=i*e.normalImpulse,a=k(e.tangentImpulse+s,-o,o);s=a-e.tangentImpulse,e.tangentImpulse=a;const l=n.tangent.scale(s);t.applyImpulse(e.point,l.negate()),r.applyImpulse(e.point,l)}for(const i of o){let s=-(1+e)*i.getRelativeVelocity().dot(n.normal)/i.normalMass;const o=Math.max(i.normalImpulse+s,0);s=o-i.normalImpulse,i.normalImpulse=o;const a=n.normal.scale(s);t.applyImpulse(i.point,a.negate()),r.applyImpulse(i.point,a)}}}}}class An extends cn{constructor(){super(...arguments),this.types=["ex.transform","ex.motion","ex.collider"],this.systemType=ln.Update,this.priority=-1,this._realisticSolver=new Pn,this._arcadeSolver=new Cn,this._processor=new Ui,this._lastFrameContacts=new Map,this._currentFrameContacts=new Map,this._trackCollider=t=>this._processor.track(t),this._untrackCollider=t=>this._processor.untrack(t)}notify(t){if(un(t)){const e=t.data.get(Ji);e.$colliderAdded.subscribe(this._trackCollider),e.$colliderRemoved.subscribe(this._untrackCollider);const i=e.get();i&&this._processor.track(i)}else{const e=t.data.get(Ji),i=e.get();e&&i&&this._processor.untrack(i)}}initialize(t){this._engine=t.engine}update(t,e){var i;if(!Ei.enabled)return;let s=[];for(const e of t){const t=e.get(Ji),n=null==t?void 0:t.get();t&&(null===(i=t.owner)||void 0===i?void 0:i.active)&&n&&(t.update(),n instanceof Wi?s=s.concat(n.getColliders()):s.push(n))}this._processor.update(s);const n=this._processor.broadphase(s,e);this._currentFrameContacts.clear();let r=this._processor.narrowphase(n,this._engine.debug.stats.currFrame);r=this.getSolver().solve(r),r.forEach((t=>this._currentFrameContacts.set(t.id,t))),this.runContactStartEnd(),this._lastFrameContacts.clear(),this._lastFrameContacts=new Map(this._currentFrameContacts)}getSolver(){return Ei.collisionResolutionStrategy===wi.Realistic?this._realisticSolver:this._arcadeSolver}debug(t){this._processor.debug(t)}runContactStartEnd(){for(const[t,e]of this._currentFrameContacts)if(!this._lastFrameContacts.has(t)){const t=e.colliderA,i=e.colliderB;t.events.emit("collisionstart",new re(t,i,e)),t.events.emit("contactstart",new ee(t,i,e)),i.events.emit("collisionstart",new re(i,t,e)),i.events.emit("contactstart",new ee(i,t,e))}for(const[t,e]of this._lastFrameContacts)if(!this._currentFrameContacts.has(t)){const t=e.colliderA,i=e.colliderB;t.events.emit("collisionend",new oe(t,i)),t.events.emit("contactend",new ie(t,i)),i.events.emit("collisionend",new oe(i,t)),i.events.emit("contactend",new ie(i,t))}}}var kn,Tn,Rn,Mn,Dn,Ln;(Tn=kn||(kn={})).Forward="forward",Tn.Backward="backward",(Mn=Rn||(Rn={})).End="end",Mn.Loop="loop",Mn.PingPong="pingpong",Mn.Freeze="freeze";class Bn extends Ct{constructor(t){var e,i;super(t),this.events=new ge(this),this.frames=[],this.strategy=Rn.Loop,this.frameDuration=100,this.timeScale=1,this._idempotencyToken=-1,this._firstTick=!0,this._currentFrame=0,this._timeLeftInFrame=0,this._direction=1,this._done=!1,this._playing=!0,this._reversed=!1,this.frames=t.frames,this.strategy=null!==(e=t.strategy)&&void 0!==e?e:this.strategy,this.frameDuration=t.totalDuration?t.totalDuration/this.frames.length:null!==(i=t.frameDuration)&&void 0!==i?i:this.frameDuration,t.reverse&&this.reverse(),this.goToFrame(0)}clone(){return new Bn(Object.assign({frames:this.frames.map((t=>Object.assign({},t))),frameDuration:this.frameDuration,reverse:this._reversed,strategy:this.strategy},this.cloneGraphicOptions()))}static fromSpriteSheet(t,e,i,s=Rn.Loop){const n=t.sprites.length-1,r=e.filter((t=>t<0||t>n));return r.length&&Bn._LOGGER.warn(`Indices into SpriteSheet were provided that don't exist: ${r.join(",")} no frame will be shown`),new Bn({frames:t.sprites.filter(((t,i)=>e.indexOf(i)>-1)).map((t=>({graphic:t,duration:i}))),strategy:s})}static toLegacyAnimation(t,e){const i=e.frames.map((t=>De.toLegacySprite(t.graphic)));return new Fe({sprites:i,loop:e.strategy===Rn.Loop,freezeFrame:e.strategy===Rn.Freeze?i.length-1:void 0,speed:e.frameDuration,engine:t})}get currentFrame(){return this._currentFrame>=0&&this._currentFrame<this.frames.length?this.frames[this._currentFrame]:null}get currentFrameIndex(){return this._currentFrame}get isPlaying(){return this._playing}reverse(){this.frames=this.frames.slice().reverse(),this._reversed=!this._reversed}get direction(){return!(!this._reversed||1!==this._direction)?kn.Backward:kn.Forward}play(){this._playing=!0}pause(){this._playing=!1,this._firstTick=!0}reset(){this._done=!1,this._firstTick=!0,this._currentFrame=0}get canFinish(){switch(this.strategy){case Rn.End:case Rn.Freeze:return!0;default:return!1}}get done(){return this._done}goToFrame(t){var e,i;this._currentFrame=t,this._timeLeftInFrame=this.frameDuration;const s=this.frames[this._currentFrame];s&&!this._done&&(this._timeLeftInFrame=(null==s?void 0:s.duration)||this.frameDuration,this.width=null===(e=s.graphic)||void 0===e?void 0:e.width,this.height=null===(i=s.graphic)||void 0===i?void 0:i.height,this.events.emit("frame",s))}_nextFrame(){const t=this._currentFrame;if(this._done)return t;let e=-1;switch(this.strategy){case Rn.Loop:e=(t+1)%this.frames.length,0===e&&this.events.emit("loop",this);break;case Rn.End:e=t+1,e>=this.frames.length&&(this._done=!0,this._currentFrame=this.frames.length,this.events.emit("end",this));break;case Rn.Freeze:e=k(t+1,0,this.frames.length-1),e>=this.frames.length-1&&(this._done=!0,this.events.emit("end",this));break;case Rn.PingPong:t+this._direction>=this.frames.length&&(this._direction=-1,this.events.emit("loop",this)),t+this._direction<0&&(this._direction=1,this.events.emit("loop",this)),e=t+this._direction%this.frames.length}return e}tick(t,e=0){this._idempotencyToken!==e&&(this._idempotencyToken=e,this._playing&&(this._firstTick&&(this._firstTick=!1,this.events.emit("frame",this.currentFrame)),this._timeLeftInFrame-=t*this.timeScale,this._timeLeftInFrame<=0&&this.goToFrame(this._nextFrame()),this._updateDimensions()))}_updateDimensions(){var t,e;this.currentFrame&&(this.width=null===(t=this.currentFrame.graphic)||void 0===t?void 0:t.width,this.height=null===(e=this.currentFrame.graphic)||void 0===e?void 0:e.height)}_drawImage(t,e,i){this.currentFrame&&this.currentFrame.graphic.draw(t,e,i)}}Bn._LOGGER=y.getInstance();class In extends Ct{constructor(t){super(t),this.members=[],this.members=t.members,this._updateDimensions()}clone(){return new In(Object.assign({members:[...this.members]},this.cloneGraphicOptions()))}_updateDimensions(){let t=new it;for(const{graphic:e,pos:i}of this.members)t=e.localBounds.translate(i).combine(t);return this.width=t.width,this.height=t.height,t}get localBounds(){let t=new it;for(const{graphic:e,pos:i}of this.members)t=e.localBounds.translate(i).combine(t);return t}_isAnimationOrGroup(t){return t instanceof Bn||t instanceof In}tick(t,e){for(const i of this.members){const s=i.graphic;this._isAnimationOrGroup(s)&&s.tick(t,e)}}reset(){for(const t of this.members){const e=t.graphic;this._isAnimationOrGroup(e)&&e.reset()}}_preDraw(t,e,i){this._updateDimensions(),super._preDraw(t,e,i)}_drawImage(t,e,i){for(const s of this.members)t.save(),t.translate(e,i),s.graphic.draw(t,s.pos.x,s.pos.y),this.showDebug&&t.debug.drawRect(0,0,this.width,this.height),t.restore()}}(Ln=Dn||(Dn={}))[Ln.Circle=0]="Circle",Ln[Ln.Rectangle=1]="Rectangle";class Fn extends cs{constructor(t,e,i,s,n,r,o,a,l,h){super(),this.position=new Y(0,0),this.velocity=new Y(0,0),this.acceleration=new Y(0,0),this.particleRotationalVelocity=0,this.currentRotation=0,this.focus=null,this.focusAccel=0,this.opacity=1,this.beginColor=tt.White,this.endColor=tt.White,this.life=300,this.fadeFlag=!1,this._rRate=1,this._gRate=1,this._bRate=1,this._aRate=0,this._currentColor=tt.White,this.emitter=null,this.particleSize=5,this.particleSprite=null,this.sizeRate=0,this.elapsedMultiplier=0,this.visible=!0,this.isOffscreen=!1;let c=t;if(c&&!(t instanceof Nn)){const d=t;c=d.emitter,e=d.life,i=d.opacity,n=d.endColor,s=d.beginColor,r=d.position,o=d.velocity,a=d.acceleration,l=d.startSize,h=d.endSize}this.emitter=c,this.life=e||this.life,this.opacity=i||this.opacity,this.endColor=n||this.endColor.clone(),this.beginColor=s||this.beginColor.clone(),this._currentColor=this.beginColor.clone(),this.position=(r||this.position).add(this.emitter.pos),this.velocity=o||this.velocity,this.acceleration=a||this.acceleration,this._rRate=(this.endColor.r-this.beginColor.r)/this.life,this._gRate=(this.endColor.g-this.beginColor.g)/this.life,this._bRate=(this.endColor.b-this.beginColor.b)/this.life,this._aRate=this.opacity/this.life,this.startSize=l||0,this.endSize=h||0,this.endSize>0&&this.startSize>0&&(this.sizeRate=(this.endSize-this.startSize)/this.life,this.particleSize=this.startSize),this.addComponent(this.transform=new Mi),this.addComponent(new ds((t=>this.draw(t)))),this.addComponent(this.graphics=new fs),this.transform.pos=this.position,this.transform.rotation=this.currentRotation,this.transform.scale=Q(1,1),this.particleSprite?(this.graphics.opacity=this.opacity,this.graphics.use(De.fromLegacySprite(this.particleSprite))):this.graphics.onPostDraw=t=>{t.save(),this.graphics.opacity=this.opacity;const e=this._currentColor.clone();e.a=1,t.debug.drawPoint(Q(0,0),{color:e,size:this.particleSize}),t.restore()}}kill(){this.emitter.removeParticle(this)}update(t,e){if(this.life=this.life-e,this.elapsedMultiplier=this.elapsedMultiplier+e,this.life<0&&this.kill(),this.fadeFlag&&(this.opacity=k(this._aRate*this.life,1e-4,1)),this.startSize>0&&this.endSize>0&&(this.particleSize=k(this.sizeRate*e+this.particleSize,Math.min(this.startSize,this.endSize),Math.max(this.startSize,this.endSize))),this._currentColor.r=k(this._currentColor.r+this._rRate*e,0,255),this._currentColor.g=k(this._currentColor.g+this._gRate*e,0,255),this._currentColor.b=k(this._currentColor.b+this._bRate*e,0,255),this._currentColor.a=k(this.opacity,1e-4,1),this.focus){const t=this.focus.sub(this.position).normalize().scale(this.focusAccel).scale(e/1e3);this.velocity=this.velocity.add(t)}else this.velocity=this.velocity.add(this.acceleration.scale(e/1e3));this.position=this.position.add(this.velocity.scale(e/1e3)),this.particleRotationalVelocity&&(this.currentRotation=(this.currentRotation+this.particleRotationalVelocity*e/1e3)%(2*Math.PI)),this.transform.pos=this.position,this.transform.rotation=this.currentRotation,this.transform.scale=Q(1,1),this.graphics.opacity=this.opacity}draw(t){if(this.particleSprite)return this.particleSprite.opacity(this.opacity),void this.particleSprite.draw(t,0,0);t.save(),this._currentColor.a=k(this.opacity,1e-4,1),t.fillStyle=this._currentColor.toString(),t.beginPath(),t.arc(0,0,this.particleSize,0,2*Math.PI),t.fill(),t.closePath(),t.restore()}}class zn extends(ke(Fn)){constructor(t,e,i,s,n,r,o,a,l,h){super(t,e,i,s,n,r,o,a,l,h)}}class Nn extends Hs{constructor(t){var e,i;super({width:null!==(e=t.width)&&void 0!==e?e:0,height:null!==(i=t.height)&&void 0!==i?i:0}),this._particlesToEmit=0,this.numParticles=0,this.isEmitting=!0,this.particles=[],this.deadParticles=[],this.minVel=0,this.maxVel=0,this.acceleration=new Y(0,0),this.minAngle=0,this.maxAngle=0,this.emitRate=1,this.particleLife=2e3,this.fadeFlag=!1,this.focus=null,this.focusAccel=null,this.startSize=null,this.endSize=null,this.minSize=5,this.maxSize=5,this.beginColor=tt.White,this.endColor=tt.White,this._og=null,this._sprite=null,this.emitterType=Dn.Rectangle,this.radius=0,this.particleRotationalVelocity=0,this.randomRotation=!1;const{x:s,y:n,pos:r,isEmitting:o,minVel:a,maxVel:l,acceleration:h,minAngle:c,maxAngle:d,emitRate:u,particleLife:p,opacity:g,fadeFlag:f,focus:m,focusAccel:y,startSize:_,endSize:w,minSize:v,maxSize:b,beginColor:S,endColor:C,particleSprite:E,emitterType:P,radius:A,particleRotationalVelocity:k,randomRotation:T,random:R}=Object.assign({},t);this.pos=null!=r?r:Q(null!=s?s:0,null!=n?n:0),this.isEmitting=null!=o?o:this.isEmitting,this.minVel=null!=a?a:this.minVel,this.maxVel=null!=l?l:this.maxVel,this.acceleration=null!=h?h:this.acceleration,this.minAngle=null!=c?c:this.minAngle,this.maxAngle=null!=d?d:this.maxAngle,this.emitRate=null!=u?u:this.emitRate,this.particleLife=null!=p?p:this.particleLife,this.opacity=null!=g?g:this.opacity,this.fadeFlag=null!=f?f:this.fadeFlag,this.focus=null!=m?m:this.focus,this.focusAccel=null!=y?y:this.focusAccel,this.startSize=null!=_?_:this.startSize,this.endSize=null!=w?w:this.endSize,this.minSize=null!=v?v:this.minSize,this.maxSize=null!=b?b:this.maxSize,this.beginColor=null!=S?S:this.beginColor,this.endColor=null!=C?C:this.endColor,this.particleSprite=null!=E?E:this.particleSprite,this.emitterType=null!=P?P:this.emitterType,this.radius=null!=A?A:this.radius,this.particleRotationalVelocity=null!=k?k:this.particleRotationalVelocity,this.randomRotation=null!=T?T:this.randomRotation,this.body.collisionType=yi.PreventCollision,this.random=null!=R?R:new x;for(let t=0;t<this.traits.length;t++)this.traits[t]instanceof ns&&this.traits.splice(t,1)}get opacity(){return super.graphics.opacity}set opacity(t){super.graphics.opacity=t}get particleSprite(){return this._og}set particleSprite(t){this._og=t,t&&(this._sprite=De.fromLegacySprite(t))}removeParticle(t){this.deadParticles.push(t)}emitParticles(t){var e;for(let i=0;i<t;i++){const t=this._createParticle();this.particles.push(t),(null===(e=null==this?void 0:this.scene)||void 0===e?void 0:e.world)&&this.scene.world.add(t)}}clearParticles(){this.particles.length=0}_createParticle(){let t=0,e=0;const i=T(this.minAngle,this.maxAngle,this.random),s=T(this.minVel,this.maxVel,this.random),n=this.startSize||T(this.minSize,this.maxSize,this.random),r=s*Math.cos(i),o=s*Math.sin(i);if(this.emitterType===Dn.Rectangle)t=T(0,this.width,this.random),e=T(0,this.height,this.random);else if(this.emitterType===Dn.Circle){const s=T(0,this.radius,this.random);t=s*Math.cos(i),e=s*Math.sin(i)}const a=new zn(this,this.particleLife,this.opacity,this.beginColor,this.endColor,new Y(t,e),new Y(r,o),this.acceleration,this.startSize,this.endSize);return a.fadeFlag=this.fadeFlag,a.particleSize=n,this.particleSprite&&(a.particleSprite=this.particleSprite,a.graphics.opacity=this.opacity,a.graphics.use(this._sprite)),a.particleRotationalVelocity=this.particleRotationalVelocity,this.randomRotation&&(a.currentRotation=T(0,2*Math.PI,this.random)),this.focus&&(a.focus=this.focus.add(new Y(this.pos.x,this.pos.y)),a.focusAccel=this.focusAccel),a}update(t,e){var i;super.update(t,e),this.isEmitting&&(this._particlesToEmit+=this.emitRate*(e/1e3),this._particlesToEmit>1&&(this.emitParticles(Math.floor(this._particlesToEmit)),this._particlesToEmit=this._particlesToEmit-Math.floor(this._particlesToEmit)));for(let t=0;t<this.deadParticles.length;t++)F(this.deadParticles[t],this.particles),(null===(i=null==this?void 0:this.scene)||void 0===i?void 0:i.world)&&this.scene.world.remove(this.deadParticles[t],!1);this.deadParticles.length=0}draw(t){this.particles.forEach((e=>e.draw(t)))}debugDraw(t){super.debugDraw(t),t.fillStyle=tt.Black.toString(),t.fillText("Particles: "+this.particles.length,this.pos.x,this.pos.y+20),this.focus&&(t.fillRect(this.focus.x+this.pos.x,this.focus.y+this.pos.y,3,3),ai(t,tt.Yellow,this.focus.x+this.pos.x,this.focus.y+this.pos.y,this.center.x,this.center.y),t.fillText("Focus",this.focus.x+this.pos.x,this.focus.y+this.pos.y))}}class On extends cn{constructor(){super(...arguments),this.types=["ex.transform","ex.graphics"],this.systemType=ln.Draw,this.priority=0,this._token=0}initialize(t){this._graphicsContext=t.engine.graphicsContext,this._camera=t.camera,this._engine=t.engine}sort(t,e){return t.get(Mi).z-e.get(Mi).z}update(t,e){let i,s;this._clearScreen(),this._token++;for(const n of t){i=n.get(Mi),s=n.get(fs);const t=this._isOffscreen(i,s);if(t&&!n.hasTag("offscreen")&&(n.eventDispatcher.emit("exitviewport",new ce(n)),n.addComponent(new ki("offscreen"))),!t&&n.hasTag("offscreen")&&(n.eventDispatcher.emit("enterviewport",new de(n)),n.removeComponent("offscreen")),t)continue;this._pushCameraTransform(i),this._graphicsContext.save(),s.update(e,this._token),this._applyTransform(n),s.onPreDraw&&s.onPreDraw(this._graphicsContext,e);const r=n instanceof zn?n.opacity:1;this._graphicsContext.opacity=s.opacity*r,this._drawGraphicsComponent(s),s.onPostDraw&&s.onPostDraw(this._graphicsContext,e),this._graphicsContext.restore(),this._popCameraTransform(i)}this._graphicsContext.flush(),this._engine.stats.currFrame.graphics.drawnImages=ht.DrawnImagesCount,this._engine.stats.currFrame.graphics.drawCalls=ht.DrawCallCount}_clearScreen(){this._graphicsContext.clear()}_isOffscreen(t,e){if(t.coordPlane===Ti.World){return!this._camera.viewport.intersect(e.localBounds.transform(t.getGlobalMatrix()))}return!1}_drawGraphicsComponent(t){var e,i;if(t.visible)for(const s of t.layers.get())for(const{graphic:n,options:r}of s.graphics){let o=t.anchor,a=t.offset;(null==r?void 0:r.anchor)&&(o=r.anchor),(null==r?void 0:r.offset)&&(a=r.offset);const l=-n.width*o.x+a.x,h=-n.height*o.y+a.y;if(null==n||n.draw(this._graphicsContext,l+s.offset.x,h+s.offset.y),(null===(e=this._engine)||void 0===e?void 0:e.isDebug)&&this._engine.debug.graphics.showBounds){const t=Q(l+s.offset.x,h+s.offset.y);if(n instanceof In)for(const e of n.members)null===(i=e.graphic)||void 0===i||i.localBounds.translate(t.add(e.pos)).draw(this._graphicsContext,this._engine.debug.graphics.boundsColor);else null==n||n.localBounds.translate(t).draw(this._graphicsContext,this._engine.debug.graphics.boundsColor)}}}_applyTransform(t){const e=t.getAncestors();for(const t of e){const e=null==t?void 0:t.get(Mi);e&&(this._graphicsContext.translate(e.pos.x,e.pos.y),this._graphicsContext.scale(e.scale.x,e.scale.y),this._graphicsContext.rotate(e.rotation))}}_pushCameraTransform(t){t.coordPlane===Ti.World&&(this._graphicsContext.save(),this._camera&&this._camera.draw(this._graphicsContext))}_popCameraTransform(t){t.coordPlane===Ti.World&&this._graphicsContext.restore()}}class Un extends cn{constructor(){super(...arguments),this.types=["ex.transform","ex.canvas"],this.systemType=ln.Draw,this.priority=-1}initialize(t){this._ctx=t.engine.ctx,this._engine=t.engine,this._camera=t.camera}sort(t,e){return t.get(Mi).z-e.get(Mi).z}update(t,e){var i,s,n;let r,o;this._clearScreen();const a=t.length;for(let l=0;l<a;l++){const a=null===(n=null===(s=null===(i=t[l])||void 0===i?void 0:i.graphics)||void 0===s?void 0:s.visible)||void 0===n||n,h=t[l].isOffScreen;a&&!h&&(r=t[l].get(Mi),o=t[l].get(ds),this._ctx.save(),this._pushCameraTransform(r),this._ctx.save(),this._applyTransform(t[l]),o.draw(this._ctx,e),this._ctx.restore(),this._popCameraTransform(r),this._ctx.restore()),this._engine.isDebug&&(this._ctx.save(),this._pushCameraTransform(r),this._ctx.strokeStyle="yellow",t[l].debugDraw(this._ctx),this._popCameraTransform(r),this._ctx.restore())}this._engine.isDebug&&(this._ctx.save(),this._camera.draw(this._ctx),this._camera.debugDraw(this._ctx),this._ctx.restore()),this._engine.stats.currFrame.graphics.drawnImages=ht.DrawnImagesCount,this._engine.stats.currFrame.graphics.drawCalls=ht.DrawCallCount}_applyTransform(t){const e=t.getAncestors();for(const t of e){const e=null==t?void 0:t.get(Mi);e&&(this._ctx.translate(e.pos.x,e.pos.y),this._ctx.rotate(e.rotation),this._ctx.scale(e.scale.x,e.scale.y))}}_clearScreen(){this._ctx.clearRect(0,0,this._ctx.canvas.width,this._ctx.canvas.height),this._ctx.fillStyle=this._engine.backgroundColor.toString(),this._ctx.fillRect(0,0,this._ctx.canvas.width,this._ctx.canvas.height)}_pushCameraTransform(t){t.coordPlane===Ti.World&&(this._ctx.save(),this._camera&&this._camera.draw(this._ctx))}_popCameraTransform(t){t.coordPlane===Ti.World&&this._ctx.restore()}}class Hn extends cn{constructor(){super(...arguments),this.types=["ex.transform"],this.systemType=ln.Draw,this.priority=999}initialize(t){this._graphicsContext=t.engine.graphicsContext,this._camera=t.camera,this._engine=t.engine,this._collisionSystem=t.world.systemManager.get(An)}update(t,e){var i,s;if(!this._engine.isDebug)return;const n=this._engine.debug.filter;let r,o;const a=this._engine.debug.entity;let l;const h=this._engine.debug.transform;let c;const d=this._engine.debug.motion;let u;const p=this._engine.debug.collider,g=this._engine.debug.physics;let f;const m=this._engine.debug.graphics;let y;const _=this._engine.debug.body,w=this._engine.debug.camera;for(const e of t){if(e.hasTag("offscreen"))continue;if(e instanceof zn)continue;if(n.useFilter){if(!(0===n.ids.length||n.ids.includes(e.id)))continue;if(!(""===n.nameQuery||e.name.includes(n.nameQuery)))continue}let t=Y.Zero;const g=Q(0,16);if(r=e.id,o=e.name,l=e.get(Mi),this._pushCameraTransform(l),this._graphicsContext.save(),this._applyTransform(e),l&&((h.showAll||h.showPosition)&&(this._graphicsContext.debug.drawPoint(Y.Zero,{size:2,color:h.positionColor}),this._graphicsContext.debug.drawText(`pos${l.pos.toString(2)}`,t),t=t.add(g)),(a.showAll||a.showId)&&(this._graphicsContext.debug.drawText(`id(${r}) ${l.parent?"child of id("+(null===(s=null===(i=l.parent)||void 0===i?void 0:i.owner)||void 0===s?void 0:s.id)+")":""}`,t),t=t.add(g)),(a.showAll||a.showName)&&(this._graphicsContext.debug.drawText(`name(${o})`,t),t=t.add(g)),(h.showAll||h.showRotation)&&(this._graphicsContext.drawLine(Y.Zero,Y.fromAngle(l.rotation).scale(50).add(Y.Zero),h.rotationColor,2),this._graphicsContext.debug.drawText(`rot deg(${D(l.rotation).toFixed(2)})`,t),t=t.add(g)),(h.showAll||h.showScale)&&this._graphicsContext.drawLine(Y.Zero,l.scale.add(Y.Zero),h.scaleColor,2)),f=e.get(fs),f&&(m.showAll||m.showBounds)){f.localBounds.draw(this._graphicsContext,m.boundsColor)}if(y=e.get(is),y&&((_.showAll||_.showCollisionGroup)&&(this._graphicsContext.debug.drawText(`collision group(${y.group.name})`,t),t=t.add(g)),(_.showAll||_.showCollisionType)&&(this._graphicsContext.debug.drawText(`collision type(${y.collisionType})`,t),t=t.add(g)),(_.showAll||_.showMass)&&(this._graphicsContext.debug.drawText(`mass(${y.mass})`,t),t=t.add(g)),(_.showAll||_.showMotion)&&(this._graphicsContext.debug.drawText(`motion(${y.sleepMotion})`,t),t=t.add(g)),(_.showAll||_.showSleeping)&&(this._graphicsContext.debug.drawText(`sleeping(${y.canSleep?y.sleeping:"cant sleep"})`,t),t=t.add(g))),this._graphicsContext.restore(),c=e.get(Di),c&&((d.showAll||d.showVelocity)&&(this._graphicsContext.debug.drawText(`vel${c.vel.toString(2)}`,t.add(l.globalPos)),this._graphicsContext.drawLine(l.globalPos,l.globalPos.add(c.vel),d.velocityColor,2),t=t.add(g)),(d.showAll||d.showAcceleration)&&this._graphicsContext.drawLine(l.globalPos,l.globalPos.add(c.acc),d.accelerationColor,2)),u=e.get(Ji),u){const t=u.get();if((p.showAll||p.showGeometry)&&t&&t.debug(this._graphicsContext,p.geometryColor),p.showAll||p.showBounds)if(t instanceof Wi){const e=t.getColliders();for(const t of e){const e=t.bounds,i=Q(e.left,e.top);this._graphicsContext.debug.drawRect(i.x,i.y,e.width,e.height,{color:p.boundsColor}),(p.showAll||p.showOwner)&&this._graphicsContext.debug.drawText(`owner id(${t.owner.id})`,i)}u.bounds.draw(this._graphicsContext,p.boundsColor)}else if(t){const t=u.bounds,e=Q(t.left,t.top);this._graphicsContext.debug.drawRect(e.x,e.y,t.width,t.height,{color:p.boundsColor}),(p.showAll||p.showOwner)&&this._graphicsContext.debug.drawText(`owner id(${u.owner.id})`,e)}}this._popCameraTransform(l)}if(this._graphicsContext.save(),this._camera.draw(this._graphicsContext),(g.showAll||g.showBroadphaseSpacePartitionDebug)&&this._collisionSystem.debug(this._graphicsContext),g.showAll||g.showCollisionContacts||g.showCollisionNormals)for(const[t,e]of this._engine.debug.stats.currFrame.physics.contacts){if(g.showAll||g.showCollisionContacts)for(const t of e.points)this._graphicsContext.debug.drawPoint(t,{size:5,color:g.collisionContactColor});if(g.showAll||g.showCollisionNormals)for(const t of e.points)this._graphicsContext.debug.drawLine(t,e.normal.scale(30).add(t),{color:g.collisionNormalColor})}this._graphicsContext.restore(),w&&(this._graphicsContext.save(),this._camera.draw(this._graphicsContext),(w.showAll||w.showFocus)&&this._graphicsContext.drawCircle(this._camera.pos,4,w.focusColor),(w.showAll||w.showZoom)&&this._graphicsContext.debug.drawText(`zoom(${this._camera.zoom})`,this._camera.pos),this._graphicsContext.restore()),this._graphicsContext.flush()}_applyTransform(t){const e=t.getAncestors();for(const t of e){const e=null==t?void 0:t.get(Mi);e&&(this._graphicsContext.translate(e.pos.x,e.pos.y),this._graphicsContext.scale(e.scale.x,e.scale.y),this._graphicsContext.rotate(e.rotation))}}_pushCameraTransform(t){t.coordPlane===Ti.World&&(this._graphicsContext.save(),this._camera&&this._camera.draw(this._graphicsContext))}_popCameraTransform(t){t.coordPlane===Ti.World&&this._graphicsContext.restore()}}class Wn extends cn{constructor(){super(...arguments),this.types=["ex.actions"],this.systemType=ln.Update,this.priority=-1}update(t,e){let i;for(const s of t)i=s.get(Os),i.update(e)}}var jn,Vn,qn,Xn,Gn,Kn,Yn,Qn,Zn,$n,Jn,tr,er,ir,sr=function(t,e,i,s){var n,r=arguments.length,o=r<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,s);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(o=(r<3?n(o):r>3?n(e,i,o):n(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};class nr extends oi{constructor(){super(),this._logger=y.getInstance(),this.camera=new nn,this.world=new vn(this),this._isInitialized=!1,this._timers=[],this._cancelQueue=[],this.world.add(new Wn),this.world.add(new bn),this.world.add(new An),f.isEnabled(l.LegacyDrawing)?this.world.add(new Un):this.world.add(new On),this.world.add(new Hn)}get actors(){return this.world.entityManager.entities.filter((t=>t instanceof Hs))}get entities(){return this.world.entityManager.entities}get triggers(){return this.world.entityManager.entities.filter((t=>t instanceof an))}get tileMaps(){return this.world.entityManager.entities.filter((t=>t instanceof Ks))}get screenElements(){return this.actors.filter((t=>t instanceof Ws))}on(t,e){super.on(t,e)}once(t,e){super.once(t,e)}off(t,e){super.off(t,e)}onInitialize(t){}onActivate(t,e){}onDeactivate(t,e){}onPreUpdate(t,e){}onPostUpdate(t,e){}onPreDraw(t,e){}onPostDraw(t,e){}_initializeChildren(){for(const t of this.entities)t._initialize(this.engine)}get isInitialized(){return this._isInitialized}_initialize(t){this.isInitialized||(this.engine=t,this.camera._initialize(t),this.onInitialize.call(this,t),this._initializeChildren(),this._logger.debug("Scene.onInitialize",this,t),this.eventDispatcher.emit("initialize",new ae(t,this)),this._isInitialized=!0)}_activate(t,e){this._logger.debug("Scene.onActivate",this),this.onActivate(t,e)}_deactivate(t,e){this._logger.debug("Scene.onDeactivate",this),this.onDeactivate(t,e)}_preupdate(t,e){this.emit("preupdate",new Ht(t,e,this)),this.onPreUpdate(t,e)}_postupdate(t,e){this.emit("postupdate",new Wt(t,e,this)),this.onPostUpdate(t,e)}_predraw(t,e){this.emit("predraw",new zt(t,e,this)),this.onPreDraw(t,e)}_postdraw(t,e){this.emit("postdraw",new Nt(t,e,this)),this.onPostDraw(t,e)}update(t,e){let i,s;for(this._preupdate(t,e),this.camera&&this.camera.update(t,e),i=0,s=this._cancelQueue.length;i<s;i++)this.removeTimer(this._cancelQueue[i]);this._cancelQueue.length=0;for(const t of this._timers)t.update(e);this.world.update(ln.Update,e),this._collectActorStats(t),t.input.pointers.dispatchPointerEvents(),this._postupdate(t,e)}draw(t,e){var i;this._predraw(t,e),this.world.update(ln.Draw,e),(null===(i=this.engine)||void 0===i?void 0:i.isDebug)&&this.debugDraw(t),this._postdraw(t,e)}debugDraw(t){this.emit("predebugdraw",new Ot(t,this)),this.emit("postdebugdraw",new Ut(t,this))}contains(t){return this.actors.indexOf(t)>-1}add(t){this.emit("entityadded",{target:t}),this.world.add(t),t.scene=this,t instanceof js&&(z(this._timers,t)||this.addTimer(t))}remove(t){t instanceof cs&&(this.emit("entityremoved",{target:t}),this.world.remove(t)),t instanceof js&&this.removeTimer(t)}addScreenElement(t){this.add(t)}removeScreenElement(t){this.remove(t)}addTileMap(t){this.world.add(t)}removeTileMap(t){this.world.remove(t)}addTimer(t){return this._timers.push(t),t.scene=this,t}removeTimer(t){const e=this._timers.indexOf(t);return-1!==e&&this._timers.splice(e,1),t}cancelTimer(t){return this._cancelQueue.push(t),t}isTimerActive(t){return this._timers.indexOf(t)>-1&&!t.complete}isCurrentScene(){return!!this.engine&&this.engine.currentScene===this}_collectActorStats(t){const e=this.actors.filter((t=>t instanceof Ws));for(const i of e)t.stats.currFrame.actors.ui++;for(const e of this.actors){t.stats.currFrame.actors.alive++;for(const i of e.children)rn(i)?t.stats.currFrame.actors.ui++:t.stats.currFrame.actors.alive++}}}sr([K({message:"Will be removed in excalibur v0.26.0",alternateMethod:"ScreenElements now are normal actors with a Transform Coordinate Plane of Screen"})],nr.prototype,"screenElements",null),sr([K({message:"Will be removed in excalibur v0.26.0",alternateMethod:"Use Scene.add"})],nr.prototype,"addScreenElement",null),sr([K({message:"Will be removed in excalibur v0.26.0",alternateMethod:"Use Scene.remove"})],nr.prototype,"removeScreenElement",null),sr([K({message:"Will be removed in excalibur v0.26.0",alternateMethod:"Use Scene.add"})],nr.prototype,"addTileMap",null),sr([K({message:"Will be removed in excalibur v0.26.0",alternateMethod:"Use Scene.remove"})],nr.prototype,"removeTileMap",null),(Vn=jn||(jn={}))[Vn.Protanope=0]="Protanope",Vn[Vn.Deuteranope=1]="Deuteranope",Vn[Vn.Tritanope=2]="Tritanope";class rr{constructor(t,e=!1,i=jn.Protanope){this.engine=t,this.simulate=e,this.colorMode=i,this._vertexShader="attribute vec2 a_position;attribute vec2 a_texCoord;uniform vec2 u_resolution;varying vec2 v_texCoord;void main() {vec2 zeroToOne = a_position / u_resolution;vec2 zeroToTwo = zeroToOne * 2.0;vec2 clipSpace = zeroToTwo - 1.0;gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);v_texCoord = a_texCoord;}",this._fragmentShader="precision mediump float;uniform sampler2D u_image;varying vec2 v_texCoord;void main() {vec4 o =  texture2D(u_image, v_texCoord);float L = (17.8824 * o.r) + (43.5161 * o.g) + (4.11935 * o.b);float M = (3.45565 * o.r) + (27.1554 * o.g) + (3.86714 * o.b);float S = (0.0299566 * o.r) + (0.184309 * o.g) + (1.46709 * o.b);//MODE CODE//vec4 error;error.r = (0.0809444479 * l) + (-0.130504409 * m) + (0.116721066 * s);error.g = (-0.0102485335 * l) + (0.0540193266 * m) + (-0.113614708 * s);error.b = (-0.000365296938 * l) + (-0.00412161469 * m) + (0.693511405 * s);error.a = 1.0;vec4 diff = o - error;vec4 correction;correction.r = 0.0;correction.g =  (diff.r * 0.7) + (diff.g * 1.0);correction.b =  (diff.r * 0.7) + (diff.b * 1.0);correction = o + correction;correction.a = o.a;//SIMULATE//}",this._internalCanvas=document.createElement("canvas"),this._internalCanvas.width=t.drawWidth,this._internalCanvas.height=t.drawHeight,this._gl=this._internalCanvas.getContext("webgl",{preserveDrawingBuffer:!0}),this._program=this._gl.createProgram();const s=this._getShader("Fragment",this._getFragmentShaderByMode(i)),n=this._getShader("Vertex",this._vertexShader);this._gl.attachShader(this._program,n),this._gl.attachShader(this._program,s),this._gl.linkProgram(this._program),this._gl.getProgramParameter(this._program,this._gl.LINK_STATUS)||y.getInstance().error("Unable to link shader program!"),this._gl.useProgram(this._program)}_getFragmentShaderByMode(t){let e="";return t===jn.Protanope?e="float l = 0.0 * L + 2.02344 * M + -2.52581 * S;float m = 0.0 * L + 1.0 * M + 0.0 * S;float s = 0.0 * L + 0.0 * M + 1.0 * S;":t===jn.Deuteranope?e="float l = 1.0 * L + 0.0 * M + 0.0 * S;float m = 0.494207 * L + 0.0 * M + 1.24827 * S;float s = 0.0 * L + 0.0 * M + 1.0 * S;":t===jn.Tritanope&&(e="float l = 1.0 * L + 0.0 * M + 0.0 * S;float m = 0.0 * L + 1.0 * M + 0.0 * S;float s = -0.395913 * L + 0.801109 * M + 0.0 * S;"),this.simulate?this._fragmentShader=this._fragmentShader.replace("//SIMULATE//","gl_FragColor = error.rgba;"):this._fragmentShader=this._fragmentShader.replace("//SIMULATE//","gl_FragColor = correction.rgba;"),this._fragmentShader.replace("//MODE CODE//",e)}_setRectangle(t,e,i,s){const n=t,r=t+i,o=e,a=e+s;this._gl.bufferData(this._gl.ARRAY_BUFFER,new Float32Array([n,o,r,o,n,a,n,a,r,o,r,a]),this._gl.STATIC_DRAW)}_getShader(t,e){let i;return"Fragment"===t?i=this._gl.createShader(this._gl.FRAGMENT_SHADER):"Vertex"===t?i=this._gl.createShader(this._gl.VERTEX_SHADER):y.getInstance().error("Error unknown shader type",t),this._gl.shaderSource(i,e),this._gl.compileShader(i),this._gl.getShaderParameter(i,this._gl.COMPILE_STATUS)?i:(y.getInstance().error("Unable to compile shader!",this._gl.getShaderInfoLog(i)),null)}process(t,e){const i=this._gl.getAttribLocation(this._program,"a_position"),s=this._gl.getAttribLocation(this._program,"a_texCoord"),n=this._gl.createBuffer();this._gl.bindBuffer(this._gl.ARRAY_BUFFER,n),this._gl.bufferData(this._gl.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),this._gl.STATIC_DRAW),this._gl.enableVertexAttribArray(s),this._gl.vertexAttribPointer(s,2,this._gl.FLOAT,!1,0,0);const r=this._gl.createTexture();this._gl.bindTexture(this._gl.TEXTURE_2D,r),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,this._gl.NEAREST),this._gl.pixelStorei(this._gl.UNPACK_FLIP_Y_WEBGL,1),this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.RGBA,this._gl.RGBA,this._gl.UNSIGNED_BYTE,t);const o=this._gl.getUniformLocation(this._program,"u_resolution");this._gl.uniform2f(o,this._internalCanvas.width,this._internalCanvas.height);const a=this._gl.createBuffer();this._gl.bindBuffer(this._gl.ARRAY_BUFFER,a),this._gl.enableVertexAttribArray(i),this._gl.vertexAttribPointer(i,2,this._gl.FLOAT,!1,0,0),this._setRectangle(0,0,t.width,t.height),this._gl.drawArrays(this._gl.TRIANGLES,0,6);const l=new Uint8Array(t.width*t.height*4);this._gl.readPixels(0,0,t.width,t.height,this._gl.RGBA,this._gl.UNSIGNED_BYTE,l),t.data.set(l),e.putImageData(t,0,0)}}class or{constructor(t){this._engine=t}correct(t){this._engine.postProcessors.push(new rr(this._engine,!1,t))}simulate(t){this._engine.postProcessors.push(new rr(this._engine,!0,t))}}class ar{constructor(t){this.stats={currFrame:new lr,prevFrame:new lr},this.filter={useFilter:!1,nameQuery:"",ids:[]},this.entity={showAll:!1,showId:!0,showName:!1},this.transform={showAll:!1,showPosition:!1,positionColor:tt.Yellow,showScale:!1,scaleColor:tt.Green,showRotation:!1,rotationColor:tt.Blue},this.graphics={showAll:!1,showBounds:!0,boundsColor:tt.Yellow},this.collider={showAll:!1,showBounds:!0,boundsColor:tt.Blue,showOwner:!1,showGeometry:!0,geometryColor:tt.Green},this.physics={showAll:!1,showBroadphaseSpacePartitionDebug:!1,showCollisionNormals:!1,collisionNormalColor:tt.Cyan,showCollisionContacts:!0,collisionContactColor:tt.Red},this.motion={showAll:!1,showVelocity:!1,velocityColor:tt.Yellow,showAcceleration:!1,accelerationColor:tt.Red},this.body={showAll:!1,showCollisionGroup:!1,showCollisionType:!1,showSleeping:!1,showMotion:!1,showMass:!1},this.camera={showAll:!1,showFocus:!1,focusColor:tt.Red,showZoom:!1},this._engine=t,this.colorBlindMode=new or(this._engine)}}class lr{constructor(){this._id=0,this._delta=0,this._fps=0,this._actorStats={alive:0,killed:0,ui:0,get remaining(){return this.alive-this.killed},get total(){return this.remaining+this.ui}},this._durationStats={update:0,draw:0,get total(){return this.update+this.draw}},this._physicsStats=new hr,this._graphicsStats={drawCalls:0,drawnImages:0}}reset(t){t?(this.id=t.id,this.delta=t.delta,this.fps=t.fps,this.actors.alive=t.actors.alive,this.actors.killed=t.actors.killed,this.actors.ui=t.actors.ui,this.duration.update=t.duration.update,this.duration.draw=t.duration.draw,this._physicsStats.reset(t.physics),this.graphics.drawCalls=t.graphics.drawCalls,this.graphics.drawnImages=t.graphics.drawnImages):(this.id=this.delta=this.fps=0,this.actors.alive=this.actors.killed=this.actors.ui=0,this.duration.update=this.duration.draw=0,this._physicsStats.reset(),this.graphics.drawnImages=this.graphics.drawCalls=0)}clone(){const t=new lr;return t.reset(this),t}get id(){return this._id}set id(t){this._id=t}get delta(){return this._delta}set delta(t){this._delta=t}get fps(){return this._fps}set fps(t){this._fps=t}get actors(){return this._actorStats}get duration(){return this._durationStats}get physics(){return this._physicsStats}get graphics(){return this._graphicsStats}}class hr{constructor(){this._pairs=0,this._collisions=0,this._contacts=new Map,this._fastBodies=0,this._fastBodyCollisions=0,this._broadphase=0,this._narrowphase=0}reset(t){t?(this.pairs=t.pairs,this.collisions=t.collisions,this.contacts=t.contacts,this.fastBodies=t.fastBodies,this.fastBodyCollisions=t.fastBodyCollisions,this.broadphase=t.broadphase,this.narrowphase=t.narrowphase):(this.pairs=this.collisions=this.fastBodies=0,this.fastBodyCollisions=this.broadphase=this.narrowphase=0,this.contacts.clear())}clone(){const t=new hr;return t.reset(this),t}get pairs(){return this._pairs}set pairs(t){this._pairs=t}get collisions(){return this._collisions}set collisions(t){this._collisions=t}get contacts(){return this._contacts}set contacts(t){this._contacts=t}get fastBodies(){return this._fastBodies}set fastBodies(t){this._fastBodies=t}get fastBodyCollisions(){return this._fastBodyCollisions}set fastBodyCollisions(t){this._fastBodyCollisions=t}get broadphase(){return this._broadphase}set broadphase(t){this._broadphase=t}get narrowphase(){return this._narrowphase}set narrowphase(t){this._narrowphase=t}}(Xn=qn||(qn={})).Num0="Numpad0",Xn.Num1="Numpad1",Xn.Num2="Numpad2",Xn.Num3="Numpad3",Xn.Num4="Numpad4",Xn.Num5="Numpad5",Xn.Num6="Numpad6",Xn.Num7="Numpad7",Xn.Num8="Numpad8",Xn.Num9="Numpad9",Xn.NumAdd="NumpadAdd",Xn.NumSubtract="NumpadSubtract",Xn.NumMultiply="NumpadMultiply",Xn.NumDivide="NumpadDivide",Xn.NumDecimal="NumpadDecimal",Xn.Numpad0="Numpad0",Xn.Numpad1="Numpad1",Xn.Numpad2="Numpad2",Xn.Numpad3="Numpad3",Xn.Numpad4="Numpad4",Xn.Numpad5="Numpad5",Xn.Numpad6="Numpad6",Xn.Numpad7="Numpad7",Xn.Numpad8="Numpad8",Xn.Numpad9="Numpad9",Xn.NumpadAdd="NumpadAdd",Xn.NumpadSubtract="NumpadSubtract",Xn.NumpadMultiply="NumpadMultiply",Xn.NumpadDivide="NumpadDivide",Xn.NumpadDecimal="NumpadDecimal",Xn.NumLock="NumLock",Xn.ShiftLeft="ShiftLeft",Xn.ShiftRight="ShiftRight",Xn.AltLeft="AltLeft",Xn.AltRight="AltRight",Xn.Key0="Digit0",Xn.Key1="Digit1",Xn.Key2="Digit2",Xn.Key3="Digit3",Xn.Key4="Digit4",Xn.Key5="Digit5",Xn.Key6="Digit6",Xn.Key7="Digit7",Xn.Key8="Digit8",Xn.Key9="Digit9",Xn.Digit0="Digit0",Xn.Digit1="Digit1",Xn.Digit2="Digit2",Xn.Digit3="Digit3",Xn.Digit4="Digit4",Xn.Digit5="Digit5",Xn.Digit6="Digit6",Xn.Digit7="Digit7",Xn.Digit8="Digit8",Xn.Digit9="Digit9",Xn.A="KeyA",Xn.B="KeyB",Xn.C="KeyC",Xn.D="KeyD",Xn.E="KeyE",Xn.F="KeyF",Xn.G="KeyG",Xn.H="KeyH",Xn.I="KeyI",Xn.J="KeyJ",Xn.K="KeyK",Xn.L="KeyL",Xn.M="KeyM",Xn.N="KeyN",Xn.O="KeyO",Xn.P="KeyP",Xn.Q="KeyQ",Xn.R="KeyR",Xn.S="KeyS",Xn.T="KeyT",Xn.U="KeyU",Xn.V="KeyV",Xn.W="KeyW",Xn.X="KeyX",Xn.Y="KeyY",Xn.Z="KeyZ",Xn.KeyA="KeyA",Xn.KeyB="KeyB",Xn.KeyC="KeyC",Xn.KeyD="KeyD",Xn.KeyE="KeyE",Xn.KeyF="KeyF",Xn.KeyG="KeyG",Xn.KeyH="KeyH",Xn.KeyI="KeyI",Xn.KeyJ="KeyJ",Xn.KeyK="KeyK",Xn.KeyL="KeyL",Xn.KeyM="KeyM",Xn.KeyN="KeyN",Xn.KeyO="KeyO",Xn.KeyP="KeyP",Xn.KeyQ="KeyQ",Xn.KeyR="KeyR",Xn.KeyS="KeyS",Xn.KeyT="KeyT",Xn.KeyU="KeyU",Xn.KeyV="KeyV",Xn.KeyW="KeyW",Xn.KeyX="KeyX",Xn.KeyY="KeyY",Xn.KeyZ="KeyZ",Xn.Semicolon="Semicolon",Xn.Quote="Quote",Xn.Comma="Comma",Xn.Minus="Minus",Xn.Period="Period",Xn.Slash="Slash",Xn.Equal="Equal",Xn.BracketLeft="BracketLeft",Xn.Backslash="Backslash",Xn.BracketRight="BracketRight",Xn.Backquote="Backquote",Xn.Up="ArrowUp",Xn.Down="ArrowDown",Xn.Left="ArrowLeft",Xn.Right="ArrowRight",Xn.ArrowUp="ArrowUp",Xn.ArrowDown="ArrowDown",Xn.ArrowLeft="ArrowLeft",Xn.ArrowRight="ArrowRight",Xn.Space="Space",Xn.Esc="Escape",Xn.Escape="Escape";class cr extends Mt{constructor(t,e,i){super(),this.key=t,this.value=e,this.originalEvent=i}}class dr extends oi{constructor(){super(),this._keys=[],this._keysUp=[],this._keysDown=[]}on(t,e){super.on(t,e)}init(t){if(!t)try{const e=()=>{};window.top.addEventListener("blur",e),window.top.removeEventListener("blur",e),t=window.top}catch(e){t=window,y.getInstance().warn("Failed to bind to keyboard events to top frame. If you are trying to embed Excalibur in a cross-origin iframe, keyboard events will not fire.")}t.addEventListener("blur",(()=>{this._keys.length=0})),t.addEventListener("keyup",(t=>{const e=t.code,i=this._keys.indexOf(e);this._keys.splice(i,1),this._keysUp.push(e);const s=new cr(e,t.key,t);this.eventDispatcher.emit("up",s),this.eventDispatcher.emit("release",s)})),t.addEventListener("keydown",(t=>{const e=t.code;if(-1===this._keys.indexOf(e)){this._keys.push(e),this._keysDown.push(e);const i=new cr(e,t.key,t);this.eventDispatcher.emit("down",i),this.eventDispatcher.emit("press",i)}}))}update(){this._keysDown.length=0,this._keysUp.length=0;for(let t=0;t<this._keys.length;t++)this.eventDispatcher.emit("hold",new cr(this._keys[t]))}getKeys(){return this._keys}wasPressed(t){return this._keysDown.indexOf(t)>-1}isHeld(t){return this._keys.indexOf(t)>-1}wasReleased(t){return this._keysUp.indexOf(t)>-1}}(Kn=Gn||(Gn={})).Touch="Touch",Kn.Mouse="Mouse",Kn.Pen="Pen",Kn.Unknown="Unknown",(Qn=Yn||(Yn={})).Canvas="Canvas",Qn.Document="Document";class ur extends oi{constructor(){super(),this.id=ur._MAX_ID++,this._isDown=!1,this._wasDown=!1,this._actorsUnderPointer={length:0},this._actors=[],this._actorsLastFrame=[],this._actorsNoLongerUnderPointer=[],this._actorSortingFcn=(t,e)=>t.z===e.z?e.id-t.id:e.z-t.z,this.lastPagePos=null,this.lastScreenPos=null,this.lastWorldPos=null,this.dragTarget=null,this.on("move",this._onPointerMove),this.on("down",this._onPointerDown),this.on("up",this._onPointerUp)}get isDragging(){return this._isDown}get isDragStart(){return!this._wasDown&&this._isDown}get isDragEnd(){return this._wasDown&&!this._isDown}get hasActorsUnderPointer(){return!!this._actorsUnderPointer.length}on(t,e){super.on(t,e)}once(t,e){super.once(t,e)}off(t,e){super.off(t,e)}update(){this._wasDown&&!this._isDown?this._wasDown=!1:!this._wasDown&&this._isDown&&(this._wasDown=!0),this._actorsLastFrame=[...this._actors],this._actorsNoLongerUnderPointer=[]}addActorUnderPointer(t){this.isActorAliveUnderPointer(t)||(this._actorsUnderPointer[t.id]=t,this._actorsUnderPointer.length+=1,this._actors.push(t)),this._actors.sort(this._actorSortingFcn)}removeActorUnderPointer(t){this.isActorAliveUnderPointer(t)&&(delete this._actorsUnderPointer[t.id],this._actorsUnderPointer.length-=1,F(t,this._actors),this._actorsNoLongerUnderPointer.push(t))}getActorsUnderPointer(){return this._actors}getActorsUnderPointerLastFrame(){return this._actorsLastFrame}getActorsForEvents(){return this._actors.concat(this._actorsLastFrame).filter(((t,e,i)=>i.indexOf(t)===e)).sort(this._actorSortingFcn)}checkActorUnderPointer(t){return!!this.lastWorldPos&&t.contains(this.lastWorldPos.x,this.lastWorldPos.y,!rn(t))}wasActorUnderPointer(t){return this._actorsLastFrame.indexOf(t)>-1}isActorAliveUnderPointer(t){return!(t.isKilled()||!t.scene||!this._actorsUnderPointer.hasOwnProperty(t.id.toString()))}_onPointerMove(t){this.lastPagePos=new Y(t.pagePos.x,t.pagePos.y),this.lastScreenPos=new Y(t.screenPos.x,t.screenPos.y),this.lastWorldPos=new Y(t.worldPos.x,t.worldPos.y)}_onPointerDown(t){this.lastPagePos=new Y(t.pagePos.x,t.pagePos.y),this.lastScreenPos=new Y(t.screenPos.x,t.screenPos.y),this.lastWorldPos=new Y(t.worldPos.x,t.worldPos.y),this._isDown=!0}_onPointerUp(t){this._isDown=!1,this.dragTarget=null}}ur._MAX_ID=0,($n=Zn||(Zn={}))[$n.NoButton=-1]="NoButton",$n[$n.Left=0]="Left",$n[$n.Middle=1]="Middle",$n[$n.Right=2]="Right",$n[$n.Unknown=3]="Unknown",(tr=Jn||(Jn={})).Left="Left",tr.Middle="Middle",tr.Right="Right",tr.Unknown="Unknown",tr.NoButton="NoButton",(ir=er||(er={})).Pixel="Pixel",ir.Line="Line",ir.Page="Page";class pr extends Mt{constructor(t,e,i,s,n,r){super(),this.coordinates=t,this.pointer=e,this.index=i,this.pointerType=s,this.button=n,this.ev=r,this._canceled=!1}get name(){return this._name}get worldPos(){return this.coordinates.worldPos.clone()}get pagePos(){return this.coordinates.pagePos.clone()}get screenPos(){return this.coordinates.screenPos.clone()}get pos(){return this.coordinates.worldPos.clone()}cancel(){this._canceled=!0}isCanceled(){return this._canceled}propagate(t){this.doAction(t),this.bubbles&&!this.isCanceled()&&t.parent&&this.propagate(t.parent)}doAction(t){t&&(this._onActionStart(t),t.emit(this._name,this),this._onActionEnd(t))}_onActionStart(t){}_onActionEnd(t){}}class gr{constructor(t){this._pointerEventType=t}create(t,e,i,s,n,r){return new this._pointerEventType(t,e,i,s,n,r)}}class fr extends pr{}class mr extends pr{constructor(){super(...arguments),this._name="pointerup"}_onActionEnd(t){this.pointer.isDragEnd&&t.capturePointer.captureDragEvents&&t.eventDispatcher.emit("pointerdragend",this)}}class yr extends pr{constructor(){super(...arguments),this._name="pointerdown"}_onActionEnd(t){this.pointer.isDragStart&&t.capturePointer.captureDragEvents&&t.eventDispatcher.emit("pointerdragstart",this)}}class _r extends pr{constructor(){super(...arguments),this._name="pointermove"}propagate(t){this.pointer.isActorAliveUnderPointer(t)&&(this.doAction(t),this.bubbles&&!this.isCanceled()&&t.parent&&this.propagate(t.parent))}_onActionStart(t){t.capturePointer.captureMoveEvents&&this.pointer.isDragging&&t.capturePointer.captureDragEvents&&t.eventDispatcher.emit("pointerdragmove",this)}}class wr extends pr{constructor(){super(...arguments),this._name="pointerenter"}_onActionStart(t){t.capturePointer.captureMoveEvents}_onActionEnd(t){this.pointer.isDragging&&t.capturePointer.captureDragEvents&&t.eventDispatcher.emit("pointerdragenter",this)}}class vr extends pr{constructor(){super(...arguments),this._name="pointerleave"}_onActionStart(t){t.capturePointer.captureMoveEvents}_onActionEnd(t){this.pointer.isDragging&&t.capturePointer.captureDragEvents&&t.eventDispatcher.emit("pointerdragleave",this)}}class xr extends pr{constructor(){super(...arguments),this._name="pointercancel"}}class br extends Mt{constructor(t,e,i,s,n,r,o,a,l,h,c,d){super(),this.x=t,this.y=e,this.pageX=i,this.pageY=s,this.screenX=n,this.screenY=r,this.index=o,this.deltaX=a,this.deltaY=l,this.deltaZ=h,this.deltaMode=c,this.ev=d,this._isCanceled=!1}cancel(){this._isCanceled=!0}isCanceled(){return this._isCanceled}}function Sr(t,e,i,s,n,r,o){let a;switch(t){case"up":a=new gr(mr);break;case"down":a=new gr(yr);break;case"move":a=new gr(_r);break;case"cancel":a=new gr(xr);break;case"enter":a=new gr(wr);break;case"leave":a=new gr(vr)}return a.create(e,i,s,n,r,o)}class Cr{constructor(t,e,i){this.worldPos=t,this.pagePos=e,this.screenPos=i}static fromPagePosition(t,e,i){let s,n,r,o;3===arguments.length?(s=t,n=e,r=new Y(s,n),o=i):(r=t,s=r.x,n=r.y,o=e);const a=o.screen.pageToScreenCoordinates(r),l=o.screen.screenToWorldCoordinates(a);return new Cr(l,r,a)}}const Er=-.025;class Pr extends oi{constructor(t){super(),this._pointerDown=[],this._pointerUp=[],this._pointerMove=[],this._pointerCancel=[],this._wheel=[],this._pointers=[],this._activePointers=[],this._engine=t,this._pointers.push(new ur),this._activePointers=[-1],this.primary=this._pointers[0]}on(t,e){super.on(t,e)}init(t){(t=t||this._engine.canvas).addEventListener("touchstart",this._handleTouchEvent("down",this._pointerDown)),t.addEventListener("touchend",this._handleTouchEvent("up",this._pointerUp)),t.addEventListener("touchmove",this._handleTouchEvent("move",this._pointerMove)),t.addEventListener("touchcancel",this._handleTouchEvent("cancel",this._pointerCancel)),window.PointerEvent?(this._engine.canvas.style.touchAction="none",t.addEventListener("pointerdown",this._handlePointerEvent("down",this._pointerDown)),t.addEventListener("pointerup",this._handlePointerEvent("up",this._pointerUp)),t.addEventListener("pointermove",this._handlePointerEvent("move",this._pointerMove)),t.addEventListener("pointercancel",this._handlePointerEvent("cancel",this._pointerCancel))):window.MSPointerEvent?(this._engine.canvas.style.msTouchAction="none",t.addEventListener("MSPointerDown",this._handlePointerEvent("down",this._pointerDown)),t.addEventListener("MSPointerUp",this._handlePointerEvent("up",this._pointerUp)),t.addEventListener("MSPointerMove",this._handlePointerEvent("move",this._pointerMove)),t.addEventListener("MSPointerCancel",this._handlePointerEvent("cancel",this._pointerCancel))):(t.addEventListener("mousedown",this._handleMouseEvent("down",this._pointerDown)),t.addEventListener("mouseup",this._handleMouseEvent("up",this._pointerUp)),t.addEventListener("mousemove",this._handleMouseEvent("move",this._pointerMove)));const e={passive:!(this._engine.pageScrollPreventionMode===zr.All||this._engine.pageScrollPreventionMode===zr.Canvas)};"onwheel"in document.createElement("div")?t.addEventListener("wheel",this._handleWheelEvent("wheel",this._wheel),e):void 0!==document.onmousewheel?t.addEventListener("mousewheel",this._handleWheelEvent("wheel",this._wheel),e):t.addEventListener("MozMousePixelScroll",this._handleWheelEvent("wheel",this._wheel),e)}triggerEvent(t,e,i=Zn.Left,s="mouse",n=0){let r,o=0,a=0;e instanceof Cr?(o=e.pagePos.x,a=e.pagePos.y,r=e):(o=e.x,a=e.y,r=new Cr(e.clone(),e.clone(),e.clone()));const l={pageX:o,pageY:a,pointerId:n,pointerType:s,button:i,preventDefault:()=>{}};switch(t){case"move":this._handlePointerEvent(t,this._pointerMove,r)(l);break;case"down":this._handlePointerEvent(t,this._pointerDown,r)(l);break;case"up":this._handlePointerEvent(t,this._pointerUp,r)(l);break;case"cancel":this._handlePointerEvent(t,this._pointerCancel,r)(l)}for(const t of this._engine.currentScene.actors){const e=t.traits.filter((t=>t instanceof rs))[0];e&&e.update(t,this._engine,1)}this.dispatchPointerEvents(),this.update()}update(){this._pointerUp.length=0,this._pointerDown.length=0,this._pointerMove.length=0,this._pointerCancel.length=0,this._wheel.length=0;for(let t=0;t<this._pointers.length;t++)this._pointers[t].update()}at(t){if(t>=this._pointers.length)for(let e=this._pointers.length-1,i=t;e<i;e++)this._pointers.push(new ur),this._activePointers.push(-1);return this._pointers[t]}count(){return this._pointers.length}checkAndUpdateActorUnderPointer(t){for(const e of this._pointers)e.checkActorUnderPointer(t)?e.addActorUnderPointer(t):e.removeActorUnderPointer(t)}_dispatchWithBubble(t){for(const e of t)for(const t of e.pointer.getActorsForEvents())if(e.isCanceled()||e.propagate(t),!e.bubbles||e.isCanceled())break}_dispatchPointerLeaveEvents(){const t={},e=[];for(const i of this._pointerMove)for(const s of i.pointer.getActorsForEvents())if(!t[i.pointer.id+"+"+s.id]&&i.pointer.wasActorUnderPointer(s)&&!i.pointer.isActorAliveUnderPointer(s)&&!i.isCanceled()){t[i.pointer.id+"+"+s.id]=i;const n=Sr("leave",new Cr(i.worldPos,i.pagePos,i.screenPos),i.pointer,i.index,i.pointerType,i.button,i.ev);n.propagate(s),e.push(n)}return e}_dispatchPointerEnterEvents(){const t={},e=[];for(const i of this._pointerMove)for(const s of i.pointer.getActorsForEvents())if(!t[i.pointer.id]&&!i.pointer.wasActorUnderPointer(s)&&i.pointer.isActorAliveUnderPointer(s)&&!i.isCanceled()){t[i.pointer.id]=i;const n=Sr("enter",new Cr(i.worldPos,i.pagePos,i.screenPos),i.pointer,i.index,i.pointerType,i.button,i.ev);n.propagate(s),e.push(n),i.pointer.isDragging&&(i.pointer.dragTarget=s)}return e}dispatchPointerEvents(){this._dispatchWithBubble(this._pointerDown),this._dispatchWithBubble(this._pointerUp),this._dispatchWithBubble(this._pointerMove),this._dispatchPointerLeaveEvents(),this._dispatchPointerEnterEvents(),this._dispatchWithBubble(this._pointerCancel);for(const t of this._wheel)for(const e of this._pointers[t.index].getActorsUnderPointer())if(this._propagateWheelPointerEvent(e,t),!t.bubbles||t.isCanceled())break}_propagateWheelPointerEvent(t,e){t.emit("pointerwheel",e),e.bubbles&&!e.isCanceled()&&t.parent&&this._propagateWheelPointerEvent(t.parent,e)}_handleMouseEvent(t,e){return i=>{i.preventDefault();const s=this.at(0),n=Cr.fromPagePosition(i.pageX,i.pageY,this._engine),r=Sr(t,n,s,0,Gn.Mouse,this._nativeButtonToPointerButton(i.button),i);e.push(r),s.eventDispatcher.emit(t,r)}}_handleTouchEvent(t,e){return i=>{i.preventDefault();for(let s=0,n=i.changedTouches.length;s<n;s++){const n=this._pointers.length>1?this._getPointerIndex(i.changedTouches[s].identifier):0;if(-1===n)continue;const r=this.at(n),o=Cr.fromPagePosition(i.changedTouches[s].pageX,i.changedTouches[s].pageY,this._engine),a=Sr(t,o,r,n,Gn.Touch,Jn.Unknown,i);e.push(a),r.eventDispatcher.emit(t,a),this.emit(t,a),this._pointers.length>1&&("up"===t?this._activePointers[n]=-1:"down"===t&&(this._activePointers[n]=i.changedTouches[s].identifier))}}}_handlePointerEvent(t,e,i){return s=>{s.preventDefault();const n=this._pointers.length>1?this._getPointerIndex(s.pointerId):0;if(-1===n)return;const r=this.at(n),o=i||Cr.fromPagePosition(s.pageX,s.pageY,this._engine),a=Sr(t,o,r,n,this._stringToPointerType(s.pointerType),this._nativeButtonToPointerButton(s.button),s);e.push(a),r.eventDispatcher.emit(t,a),this.emit(t,a),this._pointers.length>1&&("up"===t?this._activePointers[n]=-1:"down"===t&&(this._activePointers[n]=s.pointerId))}}_handleWheelEvent(t,e){return i=>{(this._engine.pageScrollPreventionMode===zr.All||this._engine.pageScrollPreventionMode===zr.Canvas&&i.target===this._engine.canvas)&&i.preventDefault();const s=this._engine.screen.pageToScreenCoordinates(Q(i.pageX,i.pageY)),n=this._engine.screen.screenToWorldCoordinates(s),r=i.deltaX||i.wheelDeltaX*Er||0,o=i.deltaY||i.wheelDeltaY*Er||i.wheelDelta*Er||i.detail||0,a=i.deltaZ||0;let l=er.Pixel;i.deltaMode&&(1===i.deltaMode?l=er.Line:2===i.deltaMode&&(l=er.Page));const h=new br(n.x,n.y,i.pageX,i.pageY,s.x,s.y,0,r,o,a,l,i);e.push(h),this.at(0).eventDispatcher.emit(t,h),this.emit(t,h)}}_getPointerIndex(t){let e;if((e=this._activePointers.indexOf(t))>-1)return e;for(let t=0;t<this._activePointers.length;t++)if(-1===this._activePointers[t])return t;return-1}_nativeButtonToPointerButton(t){switch(t){case Zn.NoButton:return Jn.NoButton;case Zn.Left:return Jn.Left;case Zn.Middle:return Jn.Middle;case Zn.Right:return Jn.Right;case Zn.Unknown:return Jn.Unknown;default:return H(t)}}_stringToPointerType(t){switch(t){case"touch":return Gn.Touch;case"mouse":return Gn.Mouse;case"pen":return Gn.Pen;default:return Gn.Unknown}}}class Ar extends oi{constructor(){super(),this.enabled=!1,this.supported=!!navigator.getGamepads,this._gamePadTimeStamps=[0,0,0,0],this._oldPads=[],this._pads=[],this._initSuccess=!1,this._navigator=navigator,this._minimumConfiguration=null}init(){this.supported&&(this._initSuccess||(this._oldPads=this._clonePads(this._navigator.getGamepads()),this._oldPads.length&&this._oldPads[0]&&(this._initSuccess=!0)))}setMinimumGamepadConfiguration(t){this._enableAndUpdate(),this._minimumConfiguration=t}_enableAndUpdate(){this.enabled||(this.enabled=!0,this.update())}_isGamepadValid(t){if(!this._minimumConfiguration)return!0;if(!t)return!1;const e=t.axes.filter((t=>!0)).length,i=t.buttons.filter((t=>!0)).length;return e>=this._minimumConfiguration.axis&&i>=this._minimumConfiguration.buttons&&t.connected}on(t,e){this._enableAndUpdate(),super.on(t,e)}off(t,e){this._enableAndUpdate(),super.off(t,e)}update(){if(!this.enabled||!this.supported)return;this.init();const t=this._navigator.getGamepads();for(let e=0;e<t.length;e++){if(!t[e]){const t=this.at(e);t.connected&&this.eventDispatcher.emit("disconnect",new Xt(e,t)),t.connected=!1;continue}if(!this.at(e).connected&&this._isGamepadValid(t[e])&&this.eventDispatcher.emit("connect",new qt(e,this.at(e))),this.at(e).connected=!0,t[e].timestamp&&t[e].timestamp===this._gamePadTimeStamps[e])continue;let i,s,n,r,o;for(i in this._gamePadTimeStamps[e]=t[e].timestamp,this.at(e).navigatorGamepad=t[e],Tr)s=Tr[i],"number"==typeof s&&t[e].buttons[s]&&(o=t[e].buttons[s].value,o!==this._oldPads[e].getButton(s)&&(t[e].buttons[s].pressed?(this.at(e).updateButton(s,o),this.at(e).eventDispatcher.emit("button",new Gt(s,o,this.at(e)))):this.at(e).updateButton(s,0)));for(n in Mr)r=Mr[n],"number"==typeof r&&(o=t[e].axes[r],o!==this._oldPads[e].getAxes(r)&&(this.at(e).updateAxes(r,o),this.at(e).eventDispatcher.emit("axis",new Kt(r,o,this.at(e)))));this._oldPads[e]=this._clonePad(t[e])}}at(t){if(this._enableAndUpdate(),t>=this._pads.length)for(let e=this._pads.length-1,i=t;e<i;e++)this._pads.push(new kr),this._oldPads.push(new kr);return this._pads[t]}getValidGamepads(){this._enableAndUpdate();const t=[];for(let e=0;e<this._pads.length;e++)this._isGamepadValid(this.at(e).navigatorGamepad)&&this.at(e).connected&&t.push(this.at(e));return t}count(){return this._pads.filter((t=>t.connected)).length}_clonePads(t){const e=[];for(let i=0,s=t.length;i<s;i++)e.push(this._clonePad(t[i]));return e}_clonePad(t){let e,i;const s=new kr;if(!t)return s;for(e=0,i=t.buttons.length;e<i;e++)t.buttons[e]&&s.updateButton(e,t.buttons[e].value);for(e=0,i=t.axes.length;e<i;e++)s.updateAxes(e,t.axes[e]);return s}}Ar.MinAxisMoveThreshold=.05;class kr extends oi{constructor(){super(),this.connected=!1,this._buttons=new Array(16),this._axes=new Array(4);for(let t=0;t<this._buttons.length;t++)this._buttons[t]=0;for(let t=0;t<this._axes.length;t++)this._axes[t]=0}isButtonPressed(t,e=1){return this._buttons[t]>=e}getButton(t){return this._buttons[t]}getAxes(t){const e=this._axes[t];return Math.abs(e)<Ar.MinAxisMoveThreshold?0:e}updateButton(t,e){this._buttons[t]=e}updateAxes(t,e){this._axes[t]=e}}var Tr,Rr,Mr,Dr;(Rr=Tr||(Tr={}))[Rr.Face1=0]="Face1",Rr[Rr.Face2=1]="Face2",Rr[Rr.Face3=2]="Face3",Rr[Rr.Face4=3]="Face4",Rr[Rr.LeftBumper=4]="LeftBumper",Rr[Rr.RightBumper=5]="RightBumper",Rr[Rr.LeftTrigger=6]="LeftTrigger",Rr[Rr.RightTrigger=7]="RightTrigger",Rr[Rr.Select=8]="Select",Rr[Rr.Start=9]="Start",Rr[Rr.LeftStick=10]="LeftStick",Rr[Rr.RightStick=11]="RightStick",Rr[Rr.DpadUp=12]="DpadUp",Rr[Rr.DpadDown=13]="DpadDown",Rr[Rr.DpadLeft=14]="DpadLeft",Rr[Rr.DpadRight=15]="DpadRight",(Dr=Mr||(Mr={}))[Dr.LeftStickX=0]="LeftStickX",Dr[Dr.LeftStickY=1]="LeftStickY",Dr[Dr.RightStickX=2]="RightStickX",Dr[Dr.RightStickY=3]="RightStickY";class Lr{constructor(t){this.nativeComponent=t,this._paused=!1,this._nativeHandlers={}}on(t,e){this._nativeHandlers[t]&&this.off(t,this._nativeHandlers[t]),this._nativeHandlers[t]=this._decorate(e),this.nativeComponent.addEventListener(t,this._nativeHandlers[t])}off(t,e){e||(e=this._nativeHandlers[t]),this.nativeComponent.removeEventListener(t,e),this._nativeHandlers[t]=null}_decorate(t){return e=>{this._paused||t(e)}}pause(){this._paused=!0}resume(){this._paused=!1}clear(){for(const t in this._nativeHandlers)this.off(t)}}class Br{constructor(t,e){this._windowGlobal=t,this._documentGlobal=e,this._windowComponent=new Lr(this._windowGlobal),this._documentComponent=new Lr(this._documentGlobal)}get window(){return this._windowComponent}get document(){return this._documentComponent}pause(){this.window.pause(),this.document.pause()}resume(){this.window.resume(),this.document.resume()}clear(){this.window.clear(),this.document.clear()}}class Ir{constructor(t){this._ex=t,this._debugText=new Ze}drawRect(t,e,i,s){this._ex.__ctx.save(),this._ex.__ctx.strokeStyle="red",this._ex.__ctx.strokeRect(this._ex.snapToPixel?~~t:t,this._ex.snapToPixel?~~e:e,this._ex.snapToPixel?~~i:i,this._ex.snapToPixel?~~s:s),this._ex.__ctx.restore()}drawLine(t,e,i={color:tt.Black}){this._ex.__ctx.save(),this._ex.__ctx.beginPath(),this._ex.__ctx.strokeStyle=i.color.toString(),this._ex.__ctx.moveTo(this._ex.snapToPixel?~~t.x:t.x,this._ex.snapToPixel?~~t.y:t.y),this._ex.__ctx.lineTo(this._ex.snapToPixel?~~e.x:e.x,this._ex.snapToPixel?~~e.y:e.y),this._ex.__ctx.lineWidth=2,this._ex.__ctx.stroke(),this._ex.__ctx.closePath(),this._ex.__ctx.restore()}drawPoint(t,e={color:tt.Black,size:5}){this._ex.__ctx.save(),this._ex.__ctx.beginPath(),this._ex.__ctx.fillStyle=e.color.toString(),this._ex.__ctx.arc(this._ex.snapToPixel?~~t.x:t.x,this._ex.snapToPixel?~~t.y:t.y,e.size,0,2*Math.PI),this._ex.__ctx.fill(),this._ex.__ctx.closePath(),this._ex.__ctx.restore()}drawText(t,e){this._debugText.write(this._ex,t,e)}}class Fr{constructor(t){this.backgroundColor=tt.ExcaliburBlue,this._state=new ot,this.snapToPixel=!0,this.debug=new Ir(this);const{canvasElement:e,enableTransparency:i,snapToPixel:s,smoothing:n,backgroundColor:r}=t;this.__ctx=e.getContext("2d",{alpha:null==i||i}),this.backgroundColor=null!=r?r:this.backgroundColor,this.snapToPixel=null!=s?s:this.snapToPixel,this.smoothing=null!=n?n:this.smoothing}get width(){return this.__ctx.canvas.width}get height(){return this.__ctx.canvas.height}get opacity(){return this._state.current.opacity}set opacity(t){this._state.current.opacity=t}get smoothing(){return this.__ctx.imageSmoothingEnabled}set smoothing(t){this.__ctx.imageSmoothingEnabled=t}resetTransform(){this.__ctx.resetTransform()}updateViewport(){}drawImage(t,e,i,s,n,r,o,a,l){if(0===s||0===n)return;if(0===a||0===l)return;if(0===t.width||0===t.height)return;this.__ctx.globalAlpha=this.opacity;const h=[t,e,i,s,n,r,o,a,l].filter((t=>void 0!==t)).map((t=>"number"==typeof t&&this.snapToPixel?~~t:t));this.__ctx.drawImage.apply(this.__ctx,h),ht.DrawCallCount++,ht.DrawnImagesCount=1}drawLine(t,e,i,s=1){this.__ctx.save(),this.__ctx.beginPath(),this.__ctx.strokeStyle=i.toString(),this.__ctx.moveTo(this.snapToPixel?~~t.x:t.x,this.snapToPixel?~~t.y:t.y),this.__ctx.lineTo(this.snapToPixel?~~e.x:e.x,this.snapToPixel?~~e.y:e.y),this.__ctx.lineWidth=s,this.__ctx.stroke(),this.__ctx.closePath(),this.__ctx.restore()}drawRectangle(t,e,i,s){this.__ctx.save(),this.__ctx.fillStyle=s.toString(),this.__ctx.fillRect(this.snapToPixel?~~t.x:t.x,this.snapToPixel?~~t.y:t.y,this.snapToPixel?~~e:e,this.snapToPixel?~~i:i),this.__ctx.restore()}drawCircle(t,e,i){this.__ctx.save(),this.__ctx.beginPath(),this.__ctx.fillStyle=i.toString(),this.__ctx.arc(this.snapToPixel?~~t.x:t.x,this.snapToPixel?~~t.y:t.y,e,0,2*Math.PI),this.__ctx.fill(),this.__ctx.closePath(),this.__ctx.restore()}save(){this.__ctx.save()}restore(){this.__ctx.restore()}translate(t,e){this.__ctx.translate(this.snapToPixel?~~t:t,this.snapToPixel?~~e:e)}rotate(t){this.__ctx.rotate(t)}scale(t,e){this.__ctx.scale(t,e)}clear(){this.__ctx.clearRect(0,0,this.width,this.height),this.__ctx.fillStyle=this.backgroundColor.toString(),this.__ctx.fillRect(0,0,this.width,this.height),ht.clear()}flush(){}}var zr,Nr,Or=function(t,e,i,s){var n,r=arguments.length,o=r<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,s);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(o=(r<3?n(o):r>3?n(e,i,o):n(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};g(),(Nr=zr||(zr={}))[Nr.None=0]="None",Nr[Nr.Canvas=1]="Canvas",Nr[Nr.All=2]="All";class Ur extends oi{constructor(t){var e,i,s;super(),this._hasStarted=!1,this.postProcessors=[],this.scenes={},this._animations=[],this._suppressPlayButton=!1,this.pauseAudioWhenHidden=!0,this._isDebug=!1,this.debugColor=new tt(255,255,255),this.enableCanvasTransparency=!0,this.onFatalException=t=>{y.getInstance().fatal(t)},this._timescale=1,this._isLoading=!1,this._isInitialized=!1,this._deferredGoTo=null,this._loadingComplete=!1,t=Object.assign(Object.assign({},Ur._DEFAULT_ENGINE_OPTIONS),t),f.freeze(),this.browser=new Br(window,document);const n=new mi;if(!t.suppressMinimumBrowserFeatureDetection&&!(this._compatible=n.test())){const e=document.createElement("div");if(e.innerText="Sorry, your browser does not support all the features needed for Excalibur",document.body.appendChild(e),n.failedTests.forEach((function(t){const e=document.createElement("div");e.innerText="Browser feature missing "+t,document.body.appendChild(e)})),t.canvasElementId){const e=document.getElementById(t.canvasElementId);e&&e.parentElement.removeChild(e)}return}this._compatible=!0,console.log&&!t.suppressConsoleBootMessage&&(console.log(`%cPowered by Excalibur.js (v${Po})`,"background: #176BAA; color: white; border-radius: 5px; padding: 15px; font-size: 1.5em; line-height: 80px;"),console.log("\n\r\n      /| ________________\n\r\nO|===|* >________________>\n\r\n      \\|"),console.log("Visit","http://excaliburjs.com","for more information")),t.suppressPlayButton&&(this._suppressPlayButton=!0),this._logger=y.getInstance(),this._logger.defaultLevel===u.Debug&&n.logBrowserFeatures(),this._logger.debug("Building engine..."),this.canvasElementId=t.canvasElementId,t.canvasElementId?(this._logger.debug("Using Canvas element specified: "+t.canvasElementId),this.canvas=document.getElementById(t.canvasElementId)):t.canvasElement?(this._logger.debug("Using Canvas element specified:",t.canvasElement),this.canvas=t.canvasElement):(this._logger.debug("Using generated canvas element"),this.canvas=document.createElement("canvas"));let r=null!==(e=t.displayMode)&&void 0!==e?e:ti.Fixed;if(t.width&&t.height||t.viewport?(void 0===t.displayMode&&(r=ti.Fixed),this._logger.debug("Engine viewport is size "+t.width+" x "+t.height)):t.displayMode||(this._logger.debug("Engine viewport is fit"),r=ti.FitScreen),f.isEnabled(l.Canvas)){const e=new Fr({canvasElement:this.canvas,enableTransparency:this.enableCanvasTransparency,smoothing:t.antialiasing,backgroundColor:t.backgroundColor,snapToPixel:t.snapToPixel});this.graphicsContext=e,this.ctx=e.__ctx}else{const e=new Je({canvasElement:this.canvas,enableTransparency:this.enableCanvasTransparency,smoothing:t.antialiasing,backgroundColor:t.backgroundColor,snapToPixel:t.snapToPixel});this.graphicsContext=e,this.ctx=e.__ctx}this.screen=new si({canvas:this.canvas,context:this.graphicsContext,antialiasing:null===(i=t.antialiasing)||void 0===i||i,browser:this.browser,viewport:null!==(s=t.viewport)&&void 0!==s?s:t.width&&t.height?{width:t.width,height:t.height}:ii.SVGA,resolution:t.resolution,displayMode:r,position:t.position,pixelRatio:t.suppressHiDPIScaling?1:null}),t.backgroundColor&&(this.backgroundColor=t.backgroundColor.clone()),this.enableCanvasTransparency=t.enableCanvasTransparency,this._loader=new gi,this.debug=new ar(this),this._initialize(t),this.rootScene=this.currentScene=new nr,this.addScene("root",this.rootScene)}get canvasWidth(){return this.screen.canvasWidth}get halfCanvasWidth(){return this.screen.halfCanvasWidth}get canvasHeight(){return this.screen.canvasHeight}get halfCanvasHeight(){return this.screen.halfCanvasHeight}get drawWidth(){return this.screen.drawWidth}get halfDrawWidth(){return this.screen.halfDrawWidth}get drawHeight(){return this.screen.drawHeight}get halfDrawHeight(){return this.screen.halfDrawHeight}get isHiDpi(){return this.screen.isHiDpi}get stats(){return this.debug.stats}get isFullscreen(){return this.screen.isFullScreen}get displayMode(){return this.screen.displayMode}get pixelRatio(){return this.screen.pixelRatio}get isDebug(){return this._isDebug}on(t,e){super.on(t,e)}once(t,e){super.once(t,e)}off(t,e){super.off(t,e)}getWorldBounds(){return this.screen.getWorldBounds()}get timescale(){return this._timescale}set timescale(t){t<=0?y.getInstance().error("Cannot set engine.timescale to a value of 0 or less than 0."):this._timescale=t}playAnimation(t,e,i){this._animations.push(new Hr(t,e,i))}addTileMap(t){this.currentScene.addTileMap(t)}removeTileMap(t){this.currentScene.removeTileMap(t)}addTimer(t){return this.currentScene.addTimer(t)}removeTimer(t){return this.currentScene.removeTimer(t)}addScene(t,e){this.scenes[t]&&this._logger.warn("Scene",t,"already exists overwriting"),this.scenes[t]=e}removeScene(t){if(t instanceof nr)for(const e in this.scenes)this.scenes.hasOwnProperty(e)&&this.scenes[e]===t&&delete this.scenes[e];"string"==typeof t&&delete this.scenes[t]}add(t){2!==arguments.length?this._deferredGoTo&&this.scenes[this._deferredGoTo]?this.scenes[this._deferredGoTo].add(t):this.currentScene.add(t):this.addScene(arguments[0],arguments[1])}remove(t){t instanceof cs&&this.currentScene.remove(t),t instanceof nr&&this.removeScene(t),"string"==typeof t&&this.removeScene(t)}goToScene(t){if(this.isInitialized)if(this.scenes[t]){const e=this.currentScene,i=this.scenes[t];this._logger.debug("Going to scene:",t),this.currentScene.isInitialized&&(this.currentScene._deactivate.apply(this.currentScene,[e,i]),this.currentScene.eventDispatcher.emit("deactivate",new he(i,this.currentScene))),this.currentScene=i,this.screen.setCurrentCamera(i.camera),this.currentScene._initialize(this),this.currentScene._activate.apply(this.currentScene,[e,i]),this.currentScene.eventDispatcher.emit("activate",new le(e,this.currentScene))}else this._logger.error("Scene",t,"does not exist!");else this._deferredGoTo=t}screenToWorldCoordinates(t){return this.screen.screenToWorldCoordinates(t)}worldToScreenCoordinates(t){return this.screen.worldToScreenCoordinates(t)}_initialize(t){let e,i;this.pageScrollPreventionMode=t.scrollPreventionMode,this.input={keyboard:new dr,pointers:new Pr(this),gamepads:new Ar},this.input.keyboard.init(),this.input.pointers.init(t&&t.pointerScope===Yn.Document?document:this.canvas),this.input.gamepads.init(),void 0!==document.hidden?(e="hidden",i="visibilitychange"):"msHidden"in document?(e="msHidden",i="msvisibilitychange"):"webkitHidden"in document&&(e="webkitHidden",i="webkitvisibilitychange"),this.browser.document.on(i,(()=>{document[e]?(this.eventDispatcher.emit("hidden",new $t(this)),this._logger.debug("Window hidden")):(this.eventDispatcher.emit("visible",new Zt(this)),this._logger.debug("Window visible"))})),this.canvasElementId||t.canvasElement||document.body.appendChild(this.canvas)}onInitialize(t){}setAntialiasing(t){this.screen.antialiasing=t}getAntialiasing(){return this.screen.antialiasing}get isInitialized(){return this._isInitialized}_overrideInitialize(t){this.isInitialized||(this.onInitialize(t),super.emit("initialize",new ae(t,this)),this._isInitialized=!0,this._deferredGoTo?this.goToScene(this._deferredGoTo):this.goToScene("root"))}_update(t){if(this._isLoading)return this._loader.update(this,t),this.input.keyboard.update(),this.input.pointers.update(),void this.input.gamepads.update();this._overrideInitialize(this),this._preupdate(t),this.currentScene.update(this,t),this._animations=this._animations.filter((function(t){return!t.animation.isDone()})),this.input.keyboard.update(),this.input.pointers.update(),this.input.gamepads.update(),this._postupdate(t)}_preupdate(t){this.emit("preupdate",new Ht(this,t,this)),this.onPreUpdate(this,t)}onPreUpdate(t,e){}_postupdate(t){this.emit("postupdate",new Wt(this,t,this)),this.onPostUpdate(this,t)}onPostUpdate(t,e){}_draw(t){const e=this.ctx;if(this._predraw(e,t),this._isLoading)return this._loader.canvas.draw(this.graphicsContext,0,0),void this.graphicsContext.flush();this.graphicsContext.backgroundColor=this.backgroundColor,this.currentScene.draw(this.ctx,t);let i=0;const s=this._animations.length;for(;i<s;i++)this._animations[i].animation.draw(e,this._animations[i].x,this._animations[i].y);if(this.isDebug){this.ctx.font="Consolas",this.ctx.fillStyle=this.debugColor.toString();const t=this.input.keyboard.getKeys();for(let e=0;e<t.length;e++)this.ctx.fillText(t[e].toString()+" : "+(qn[t[e]]?qn[t[e]]:"Not Mapped"),100,10*e+10);this.ctx.fillText("FPS:"+this.stats.currFrame.fps.toFixed(2).toString(),10,10)}for(let t=0;t<this.postProcessors.length;t++)this.postProcessors[t].process(this.ctx.getImageData(0,0,this.canvasWidth,this.canvasHeight),this.ctx);this._postdraw(e,t)}_predraw(t,e){this.emit("predraw",new zt(t,e,this)),this.onPreDraw(t,e)}onPreDraw(t,e){}_postdraw(t,e){this.emit("postdraw",new Nt(t,e,this)),this.onPostDraw(t,e)}onPostDraw(t,e){}showDebug(t){this._isDebug=t}toggleDebug(){return this._isDebug=!this._isDebug,this._isDebug}get loadingComplete(){return this._loadingComplete}start(t){if(!this._compatible)return Promise.reject("Excalibur is incompatible with your browser");let e;return this.screen.pushResolutionAndViewport(),this.screen.resolution=this.screen.viewport,this.screen.applyResolutionAndViewport(),this.graphicsContext.updateViewport(),t?(this._loader=t,this._loader.suppressPlayButton=this._suppressPlayButton||this._loader.suppressPlayButton,this._loader.wireEngine(this),e=this.load(this._loader)):e=Promise.resolve(),e.then((()=>{this.screen.popResolutionAndViewport(),this.screen.applyResolutionAndViewport(),this.graphicsContext.updateViewport(),this.emit("start",new It(this)),this._loadingComplete=!0})),this._hasStarted||(this._hasStarted=!0,this._logger.debug("Starting game..."),this.browser.resume(),Ur.createMainLoop(this,window.requestAnimationFrame,Date.now)(),this._logger.debug("Game started")),e}static createMainLoop(t,e,i){let s=i();return function n(){if(t._hasStarted)try{t._requestId=e(n),t.emit("preframe",new jt(t,t.stats.prevFrame));const r=i();let o=Math.floor(r-s)||1;o>200&&(o=1);const a=o*t.timescale,l=t.stats.prevFrame.id+1;t.stats.currFrame.reset(),t.stats.currFrame.id=l,t.stats.currFrame.delta=a,t.stats.currFrame.fps=1/(a/1e3);const h=i();t._update(a);const c=i();t._draw(a);const d=i();t.stats.currFrame.duration.update=c-h,t.stats.currFrame.duration.draw=d-c,s=r,t.emit("postframe",new Vt(t,t.stats.currFrame)),t.stats.prevFrame.reset(t.stats.currFrame)}catch(e){window.cancelAnimationFrame(t._requestId),t.stop(),t.onFatalException(e)}}}stop(){this._hasStarted&&(this.emit("stop",new Ft(this)),this.browser.pause(),this._hasStarted=!1,this._logger.debug("Game stopped"))}isPaused(){return!this._hasStarted}screenshot(){const t=new Image,e=this.canvas.toDataURL("image/png");return t.src=e,t}load(t){return new Promise((e=>{this._isLoading=!0,t.load().then((()=>{this._suppressPlayButton?setTimeout((()=>{this._isLoading=!1,e()}),500):(this._isLoading=!1,e())}))}))}}Ur._DEFAULT_ENGINE_OPTIONS={width:0,height:0,enableCanvasTransparency:!0,canvasElementId:"",canvasElement:void 0,snapToPixel:!1,pointerScope:Yn.Canvas,suppressConsoleBootMessage:null,suppressMinimumBrowserFeatureDetection:null,suppressHiDPIScaling:null,suppressPlayButton:null,scrollPreventionMode:zr.Canvas,backgroundColor:tt.fromHex("#2185d0")},Or([K({message:"Will be removed in excalibur v0.26.0",alternateMethod:"Use Actor.graphics"})],Ur.prototype,"playAnimation",null);let Hr=class{constructor(t,e,i){this.animation=t,this.x=e,this.y=i}};Hr=Or([K({message:"Will be removed in excalibur v0.26.0"})],Hr);class Wr extends Mt{constructor(t,e="MediaEvent"){super(),this.target=t,this._name=e}set bubbles(t){}get bubbles(){return!1}get _path(){return null}set _path(t){}stopPropagation(){}action(){}propagate(){}layPath(t){}}class jr extends Wr{constructor(t,e){super(t,"NativeSoundEvent"),this.track=e}}class Vr extends Wr{constructor(t,e){super(t,"NativeSoundProcessedEvent"),this._processedData=e,this.data=this._processedData}}class qr extends At{constructor(t={}){var e,i,s,n,r,o,a,l,h,c,d,u;super(t),this.quality=2,this.family="sans-serif",this.style=je.Normal,this.bold=!1,this.unit=ze.Px,this.textAlign=Oe.Left,this.baseAlign=He.Alphabetic,this.direction=qe.LeftToRight,this.size=10,this.shadow=null,this._textBounds=new it,this._textWidth=0,this._textHeight=0,this.family=null!==(e=null==t?void 0:t.family)&&void 0!==e?e:this.family,this.style=null!==(i=null==t?void 0:t.style)&&void 0!==i?i:this.style,this.bold=null!==(s=null==t?void 0:t.bold)&&void 0!==s?s:this.bold,this.size=null!==(n=null==t?void 0:t.size)&&void 0!==n?n:this.size,this.unit=null!==(r=null==t?void 0:t.unit)&&void 0!==r?r:this.unit,this.textAlign=null!==(o=null==t?void 0:t.textAlign)&&void 0!==o?o:this.textAlign,this.baseAlign=null!==(a=null==t?void 0:t.baseAlign)&&void 0!==a?a:this.baseAlign,this.direction=null!==(l=null==t?void 0:t.direction)&&void 0!==l?l:this.direction,this.quality=null!==(h=null==t?void 0:t.quality)&&void 0!==h?h:this.quality,(null==t?void 0:t.shadow)&&(this.shadow={},this.shadow.blur=null!==(c=t.shadow.blur)&&void 0!==c?c:this.shadow.blur,this.shadow.offset=null!==(d=t.shadow.offset)&&void 0!==d?d:this.shadow.offset,this.shadow.color=null!==(u=t.shadow.color)&&void 0!==u?u:this.shadow.color),this.flagDirty()}clone(){return new qr(Object.assign(Object.assign(Object.assign({},this.cloneGraphicOptions()),this.cloneRasterOptions()),{size:this.size,unit:this.unit,family:this.family,style:this.style,bold:this.bold,textAlign:this.textAlign,baseAlign:this.baseAlign,direction:this.direction,shadow:this.shadow?{blur:this.shadow.blur,offset:this.shadow.offset,color:this.shadow.color}:null}))}get fontString(){return`${this.style} ${this.bold?"bold":""} ${this.size}${this.unit} ${this.family}`}get width(){return this._textWidth}set width(t){this._textWidth=t}get height(){var t,e;const i=null!==(e=null===(t=this._lines)||void 0===t?void 0:t.length)&&void 0!==e?e:1;return this._textHeight*i}set height(t){var e,i;const s=null!==(i=null===(e=this._lines)||void 0===e?void 0:e.length)&&void 0!==i?i:1;this._textHeight=t/s}get _rasterWidth(){return this._bitmap.width}get _rasterHeight(){return this._bitmap.height}get _halfRasterWidth(){return Math.floor(this._bitmap.width/2)}get _halfRasterHeight(){return Math.floor(this._bitmap.height/2)}get localBounds(){return this._textBounds}_drawImage(t,e,i){this.dirty&&this.rasterize(),t.drawImage(this._bitmap,0,0,this._rasterWidth,this._rasterHeight,e-this._rasterWidth/this.quality/2,i-this._rasterHeight/this.quality/2,this._rasterWidth/this.quality,this._rasterHeight/this.quality)}_rotate(t){var e;const i=null!==(e=this.origin)&&void 0!==e?e:this._textBounds.center;t.translate(i.x,i.y),t.rotate(this.rotation),t.translate(-i.x,-i.y)}_flip(t){this.flipHorizontal&&(t.translate(this._textBounds.width/this.scale.x,0),t.scale(-1,1)),this.flipVertical&&(t.translate(0,-this._textBounds.height/2/this.scale.y),t.scale(1,-1))}updateText(t){this._text!==t&&(this._text=t,this._lines=this._text.split("\n"),this._updateDimensions(),this.flagDirty())}_updateDimensions(){if(this._text){this._applyFont(this._ctx);const t=this._lines.reduce(((t,e)=>t.length>e.length?t:e)),e=this._ctx.measureText(t);this._textWidth=Math.abs(e.actualBoundingBoxLeft)+Math.abs(e.actualBoundingBoxRight),this._textHeight=Math.abs(e.actualBoundingBoxAscent)+Math.abs(e.actualBoundingBoxDescent);const i=this._textHeight*this._lines.length;this._bitmap.width=2*(this._textWidth+2*this.padding)*this.quality,this._bitmap.height=2*(i+2*this.padding)*this.quality;const s=0,n=0,r=i-Math.abs(e.actualBoundingBoxAscent);this._textBounds=new it({left:s-Math.abs(e.actualBoundingBoxLeft)-this.padding,top:n-Math.abs(e.actualBoundingBoxAscent)-this.padding,bottom:n+r+this.padding,right:s+Math.abs(e.actualBoundingBoxRight)+this.padding})}}_preDraw(t,e,i){this.dirty&&this._updateDimensions(),super._preDraw(t,e,i)}_postDraw(t){this.showDebug&&t.debug.drawRect(-this._halfRasterWidth,-this._halfRasterHeight,this._rasterWidth,this._rasterHeight),t.restore()}_applyFont(t){t.translate(this.padding+this._halfRasterWidth,this.padding+this._halfRasterHeight),t.scale(this.quality,this.quality),t.textAlign=this.textAlign,t.textBaseline=this.baseAlign,t.font=this.fontString,t.direction=this.direction,this.shadow&&(t.shadowColor=this.shadow.color.toString(),t.shadowBlur=this.shadow.blur,t.shadowOffsetX=this.shadow.offset.x,t.shadowOffsetY=this.shadow.offset.y)}execute(t){if(this._text){this._applyRasterProperites(t),this._applyFont(t);const e=this._textHeight;for(let i=0;i<this._lines.length;i++){const s=this._lines[i];this.color&&t.fillText(s,0,i*e),this.strokeColor&&t.strokeText(s,0,i*e)}this.showDebug&&(ai(t,tt.Red,-this._halfRasterWidth,0,this._halfRasterWidth,0,2),ai(t,tt.Red,0,-this._halfRasterHeight,0,this._halfRasterHeight,2))}}render(t,e,i,s){this.updateText(e),this.draw(t,i,s)}}class Xr extends Ct{constructor(t){var e,i;super(t),this._text="",this.font=null!==(e=t.font)&&void 0!==e?e:new qr,this.color=null!==(i=t.color)&&void 0!==i?i:this.color,this.text=t.text}clone(){return new Xr({text:this.text.slice(),color:this.color.clone(),font:this.font.clone()})}get text(){return this._text}set text(t){this._text=t,this.font.updateText(t)}get color(){return this.font instanceof qr?this.font.color:tt.Black}set color(t){this.font instanceof qr&&(this.font.color=t)}get font(){return this._font}set font(t){this._font=t instanceof qr?Et(t,(t=>t.flagDirty())):t}get width(){return this.font.width}get height(){return this.font.height}get localBounds(){return this.font.localBounds}_rotate(t){}_flip(t){}_drawImage(t,e,i){this.font instanceof qr&&(this.font.color=this.color),this.font.flipHorizontal=this.flipHorizontal,this.font.flipVertical=this.flipVertical,this.font.scale=this.scale,this.font.rotation=this.rotation,this.font.origin=this.origin,this.font.opacity=this.opacity,this.font.render(t,this._text,e,i)}}var Gr=function(t,e,i,s){var n,r=arguments.length,o=r<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,s);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(o=(r<3?n(o):r>3?n(e,i,o):n(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};class Kr extends Hs{constructor(t){super(t),this.font=new qr,this._text=new Xr({text:"",font:this.font}),this.letterSpacing=0,this.caseInsensitive=!0;const{text:e,pos:i,x:s,y:n,spriteFont:r,font:o,color:a}=t;this.pos=null!=i?i:s&&n?Q(s,n):this.pos,this.text=null!=e?e:this.text,this.spriteFont=null!=r?r:this.spriteFont,this.font=null!=o?o:this.font,this.color=null!=a?a:this.color;const l=this.get(fs);l.anchor=Y.Zero,l.use(this._text)}get text(){return this._text.text}set text(t){this._text.text=t}get color(){return this._text.color}set color(t){this._text.color=t}get opacity(){return this._text.opacity}set opacity(t){this._text.opacity=t}get bold(){return this.font.bold}set bold(t){this.font.bold=t}get fontFamily(){return this.font.family}set fontFamily(t){this.font.family=t}get fontSize(){return this.font.size}set fontSize(t){this.font.size=t}get fontStyle(){return this.font.style}set fontStyle(t){this.font.style=t}get fontUnit(){return this.font.unit}set fontUnit(t){this.font.unit=t}get textAlign(){return this.font.textAlign}set textAlign(t){this.font.textAlign=t}get baseAlign(){return this.font.baseAlign}set baseAlign(t){this.font.baseAlign=t}get spriteFont(){return this._legacySpriteFont}set spriteFont(t){if(t){if(t instanceof Ke)return this._legacySpriteFont=t,this._spriteFont=Qe.fromLegacySpriteFont(t),void(this._text.font=this._spriteFont);this._spriteFont=t,this._text.font=this._spriteFont}}_initialize(t){super._initialize(t),this._graphicsContext=t.graphicsContext}getTextWidth(){return this._text.width}setTextShadow(t,e,i){this.font.shadow={offset:Q(t,e),blur:2,color:i}}useTextShadow(t){this.spriteFont&&this.spriteFont.useTextShadow(t)}clearTextShadow(){this.font.shadow=null}draw(t,e){const i=this._graphicsContext;this._text.draw(i,0,0)}}Gr([K({message:"Label.bold will be removed in v0.26.0",alternateMethod:"Use Label.font.bold"})],Kr.prototype,"bold",null),Gr([K({message:"Label.fontFamily will be removed in v0.26.0",alternateMethod:"Use Label.font.family"})],Kr.prototype,"fontFamily",null),Gr([K({message:"Label.fontSize will be removed in v0.26.0",alternateMethod:"Use Label.font.size"})],Kr.prototype,"fontSize",null),Gr([K({message:"Label.fontStyle will be removed in v0.26.0",alternateMethod:"Use Lable.font.style"})],Kr.prototype,"fontStyle",null),Gr([K({message:"Label.fontUnit will be removed in v0.26.0",alternateMethod:"Use Label.font.unit"})],Kr.prototype,"fontUnit",null),Gr([K({message:"Label.textAlign will be removed in v0.26.0",alternateMethod:"Use Label.font.textAlign"})],Kr.prototype,"textAlign",null),Gr([K({message:"Label.baseAlign will be removed in v0.26.0",alternateMethod:"Use Label.font.baseAlign"})],Kr.prototype,"baseAlign",null),Gr([K()],Kr.prototype,"spriteFont",null),Gr([K({message:"Label.setTextShadow will be removed in v0.26.0",alternateMethod:"Use Label.font.shadow"})],Kr.prototype,"setTextShadow",null),Gr([K({message:"Label.useTextShadow will be removed in v0.26.0",alternateMethod:"Use Label.font.shadow"})],Kr.prototype,"useTextShadow",null),Gr([K({message:"Label.clearTextShadow will be removed in v0.26.0",alternateMethod:"Use Label.font.shadow"})],Kr.prototype,"clearTextShadow",null);class Yr{static create(t,e){if(this._CURRENT_GROUP>this._MAX_GROUPS)throw new Error(`Cannot have more than ${this._MAX_GROUPS} collision groups`);if(this._GROUPS.get(t))throw new Error(`Collision group ${t} already exists`);const i=new Li(t,this._CURRENT_BIT,void 0!==e?e:~this._CURRENT_BIT);return this._CURRENT_BIT=this._CURRENT_BIT<<1|0,this._CURRENT_GROUP++,this._GROUPS.set(t,i),i}static get groups(){return Array.from(this._GROUPS.values())}static groupByName(t){return this._GROUPS.get(t)}static reset(){this._GROUPS=new Map,this._CURRENT_BIT=this._STARTING_BIT,this._CURRENT_GROUP=1}}Yr._STARTING_BIT=1,Yr._MAX_GROUPS=32,Yr._CURRENT_GROUP=1,Yr._CURRENT_BIT=Yr._STARTING_BIT,Yr._GROUPS=new Map;let Qr=class{constructor(t){this.lineWidth=5,this.filled=!1,this._points=[],this.anchor=Y.Zero,this.offset=Y.Zero,this.rotation=0,this.scale=Y.One,this.opacity=1,this._points=t;const e=this._points.reduce(((t,e)=>Math.min(t,e.x)),0),i=this._points.reduce(((t,e)=>Math.max(t,e.x)),0);this.drawWidth=i-e;const s=this._points.reduce(((t,e)=>Math.min(t,e.y)),0),n=this._points.reduce(((t,e)=>Math.max(t,e.y)),0);this.drawHeight=n-s,this.height=this.drawHeight,this.width=this.drawWidth}addEffect(){}removeEffect(){}clearEffects(){}reset(){}draw(t,e,i){t instanceof CanvasRenderingContext2D?this._drawWithOptions({ctx:t,x:e,y:i}):this._drawWithOptions(t)}_drawWithOptions(t){var e,i,s,n,r,o,a,l,h;const{ctx:c,x:d,y:u,rotation:p,drawWidth:g,drawHeight:f,anchor:m,offset:y,opacity:_,flipHorizontal:w,flipVertical:v}=Object.assign(Object.assign({},t),{rotation:null!==(e=t.rotation)&&void 0!==e?e:this.rotation,drawWidth:null!==(i=t.drawWidth)&&void 0!==i?i:this.drawWidth,drawHeight:null!==(s=t.drawHeight)&&void 0!==s?s:this.drawHeight,flipHorizontal:null!==(n=t.flipHorizontal)&&void 0!==n?n:this.flipHorizontal,flipVertical:null!==(r=t.flipVertical)&&void 0!==r?r:this.flipVertical,anchor:null!==(o=t.anchor)&&void 0!==o?o:this.anchor,offset:null!==(a=t.offset)&&void 0!==a?a:this.offset,opacity:(null!==(l=t.opacity)&&void 0!==l?l:1)*(null!==(h=this.opacity)&&void 0!==h?h:1)}),x=g*m.x+y.x+d,b=f*m.y+y.y+u;c.save(),c.translate(x,b),c.scale(this.scale.x,this.scale.y),c.rotate(p),c.beginPath(),c.lineWidth=this.lineWidth;const S=this._points[0];c.moveTo(S.x,S.y);let C=0;const E=this._points.length;for(;C<E;C++)c.lineTo(this._points[C].x,this._points[C].y);c.lineTo(S.x,S.y),c.closePath(),this.filled&&(c.fillStyle=this.fillColor.toString(),c.fill()),c.strokeStyle=this.lineColor.toString(),w&&(c.translate(g,0),c.scale(-1,1)),v&&(c.translate(0,f),c.scale(1,-1));const P=c.globalAlpha;c.globalAlpha=_,c.stroke(),c.globalAlpha=P,c.restore()}};Qr=function(t,e,i,s){var n,r=arguments.length,o=r<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,s);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(o=(r<3?n(o):r>3?n(e,i,o):n(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o}([K({message:"Polygon will be removed in v0.26.0",alternateMethod:"Use Graphics.Polygon"})],Qr);class Zr{}function $r(t){return!!t._initialize}function Jr(t){return!!t.onInitialize}function to(t){return!!t._preupdate}function eo(t){return!!t.onPreUpdate}function io(t){return!!t.onPostUpdate}function so(t){return!!t.onPostUpdate}function no(t){return!!t.onPreDraw}function ro(t){return!!t.onPostDraw}Zr.type={any:"",blob:"blob",json:"json",text:"text",document:"document",arraybuffer:"arraybuffer"};class oo{constructor(t){this._src=t,this._volume=1,this._duration=void 0,this._loop=!1,this._isPlaying=!1,this._isPaused=!1,this._audioContext=ni.create(),this._volumeNode=this._audioContext.createGain(),this._currentOffset=0,this._createNewBufferSource()}set loop(t){this._loop=t,this._instance&&(this._instance.loop=t,this._wireUpOnEnded())}get loop(){return this._loop}set volume(t){t=k(t,0,1),this._volume=t,this._isPlaying&&this._volumeNode.gain.setTargetAtTime?this._volumeNode.gain.setTargetAtTime(t,this._audioContext.currentTime,.1):this._volumeNode.gain.value=t}get volume(){return this._volume}set duration(t){this._duration=t}get duration(){return this._duration}get _playbackRate(){return this._instance?1/(this._instance.playbackRate.value||1):null}isPlaying(){return this._isPlaying}play(t=(()=>{})){return this._isPaused&&(this._resumePlayBack(),t()),this._isPlaying||(this._startPlayBack(),t()),this._playingPromise}pause(){this._isPlaying&&(this._isPaused=!0,this._isPlaying=!1,this._instance.stop(0),this._setPauseOffset())}stop(){this._isPlaying&&(this._isPlaying=!1,this._isPaused=!1,this._currentOffset=0,this._instance.stop(0),this._instance.onended||this._handleOnEnded())}_startPlayBack(){this._isPlaying=!0,this._isPaused=!1,this._playingPromise=new Promise((t=>{this._playingResolve=t})),this._instance||this._createNewBufferSource(),this._rememberStartTime(),this._volumeNode.connect(this._audioContext.destination),this._instance.start(0,0),this._currentOffset=0,this._wireUpOnEnded()}_resumePlayBack(){if(!this._isPaused)return;this._isPaused=!1,this._isPlaying=!0,this._instance.onended=null,this._createNewBufferSource();const t=this._playbackRate*this._src.duration,e=this._currentOffset%t;this._rememberStartTime(-1e3*e),this._instance.start(0,e),this._wireUpOnEnded()}_wireUpOnEnded(){this.loop||(this._instance.onended=()=>this._handleOnEnded())}_handleOnEnded(){this._isPaused||(this._isPlaying=!1,this._playingResolve(!0))}_rememberStartTime(t){this._startTime=(new Date).getTime()+(0|t)}_setPauseOffset(){this._currentOffset=((new Date).getTime()-this._startTime)*this._playbackRate/1e3}_createNewBufferSource(){this._instance=this._audioContext.createBufferSource(),this._instance.buffer=this._src,this._instance.loop=this.loop,this._instance.playbackRate.setValueAtTime(1,0),this._instance.connect(this._volumeNode)}}function ao(t){try{const e=new Audio,i=/.*\.([A-Za-z0-9]+)$/,s=t.match(i)[1];return!!e.canPlayType("audio/"+s)}catch(t){return y.getInstance().warn("Cannot determine audio support, assuming no support for the Audio Tag",t),!1}}var lo=function(t,e,i,s){return new(i||(i=Promise))((function(n,r){function o(t){try{l(s.next(t))}catch(t){r(t)}}function a(t){try{l(s.throw(t))}catch(t){r(t)}}function l(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}l((s=s.apply(t,e||[])).next())}))};class ho extends oi{constructor(...t){super(),this.logger=y.getInstance(),this._loop=!1,this._volume=1,this._duration=void 0,this._isStopped=!1,this._isPaused=!1,this._tracks=[],this._wasPlayingOnHidden=!1,this._audioContext=ni.create(),this._resource=new fe("",Zr.type.arraybuffer);for(const e of t)if(ao(e)){this.path=e;break}this.path||(this.logger.warn("This browser does not support any of the audio files specified:",t.join(", ")),this.logger.warn("Attempting to use",t[0]),this.path=t[0])}set loop(t){this._loop=t;for(const t of this._tracks)t.loop=this._loop;this.logger.debug("Set loop for all instances of sound",this.path,"to",this._loop)}get loop(){return this._loop}set volume(t){this._volume=t;for(const t of this._tracks)t.volume=this._volume;this.emit("volumechange",new jr(this)),this.logger.debug("Set loop for all instances of sound",this.path,"to",this._volume)}get volume(){return this._volume}get duration(){return this._duration}get instances(){return this._tracks}get path(){return this._resource.path}set path(t){this._resource.path=t}isLoaded(){return!!this.data}load(){return lo(this,void 0,void 0,(function*(){if(this.data)return this.data;const t=yield this._resource.load(),e=yield this.decodeAudio(t.slice(0));return this._duration="object"==typeof e?e.duration:void 0,this.emit("processed",new Vr(this,e)),this.data=e}))}decodeAudio(t){return lo(this,void 0,void 0,(function*(){try{return yield this._audioContext.decodeAudioData(t.slice(0))}catch(t){return this.logger.error("Unable to decode  this browser may not fully support this format, or the file may be corrupt, if this is an mp3 try removing id3 tags and album art from the file."),yield Promise.reject()}}))}wireEngine(t){t&&(this._engine=t,this._engine.on("hidden",(()=>{t.pauseAudioWhenHidden&&this.isPlaying()&&(this._wasPlayingOnHidden=!0,this.pause())})),this._engine.on("visible",(()=>{t.pauseAudioWhenHidden&&this._wasPlayingOnHidden&&(this.play(),this._wasPlayingOnHidden=!1)})),this._engine.on("start",(()=>{this._isStopped=!1})),this._engine.on("stop",(()=>{this.stop(),this._isStopped=!0})))}instanceCount(){return this._tracks.length}isPlaying(){return this._tracks.some((t=>t.isPlaying()))}play(t){return this.isLoaded()?this._isStopped?(this.logger.warn("Cannot start playing. Engine is in a stopped state."),Promise.resolve(!1)):(this.volume=t||this.volume,this._isPaused?this._resumePlayback():this._startPlayback()):(this.logger.warn("Cannot start playing. Resource",this.path,"is not loaded yet"),Promise.resolve(!0))}pause(){if(this.isPlaying()){for(const t of this._tracks)t.pause();this._isPaused=!0,this.emit("pause",new jr(this)),this.logger.debug("Paused all instances of sound",this.path)}}stop(){for(const t of this._tracks)t.stop();this.emit("stop",new jr(this)),this._isPaused=!1,this._tracks.length=0,this.logger.debug("Stopped all instances of sound",this.path)}getTrackId(t){return this._tracks.indexOf(t)}_resumePlayback(){return lo(this,void 0,void 0,(function*(){if(this._isPaused){const t=[];for(const e of this._tracks)t.push(e.play());this._isPaused=!1,this.emit("resume",new jr(this)),this.logger.debug("Resuming paused instances for sound",this.path,this._tracks),yield Promise.all(t)}return!0}))}_startPlayback(){return lo(this,void 0,void 0,(function*(){const t=yield this._getTrackInstance(this.data),e=yield t.play((()=>{this.emit("playbackstart",new jr(this,t)),this.logger.debug("Playing new instance for sound",this.path)}));return this.emit("playbackend",new jr(this,t)),this._tracks.splice(this.getTrackId(t),1),e}))}_getTrackInstance(t){const e=new oo(t);return e.loop=this.loop,e.volume=this.volume,e.duration=this.duration,this._tracks.push(e),e}}var co=function(t,e,i,s){return new(i||(i=Promise))((function(n,r){function o(t){try{l(s.next(t))}catch(t){r(t)}}function a(t){try{l(s.throw(t))}catch(t){r(t)}}function l(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}l((s=s.apply(t,e||[])).next())}))};class uo{constructor(t,e=tt.Magenta,i=!0){this.path=t,this.color=e,this.bustCache=i,this._stream=null,this._gif=null,this._textures=[],this._animation=null,this._transparentColor=null,this._resource=new fe(t,"arraybuffer",i),this._transparentColor=e}load(){return co(this,void 0,void 0,(function*(){const t=yield this._resource.load();this._stream=new fo(t),this._gif=new mo(this._stream,this._transparentColor);const e=this._gif.images.map((t=>new Be(t.src,!1)));return yield Promise.all(e.map((t=>t.load()))),this.data=this._textures=e}))}isLoaded(){return!!this.data}toLegacySprite(t=0){return De.toLegacySprite(this.toSprite(t))}toLegacySpriteSheet(){return Ye.toLegacySpriteSheet(this.toSpriteSheet())}toLegacyAnimation(t,e){return Bn.toLegacyAnimation(t,this.toAnimation(e))}toSprite(t=0){return this._textures[t].toSprite()}toSpriteSheet(){const t=this._textures.map((t=>t.toSprite()));return new Ye({sprites:t})}toAnimation(t){const e=this.toSpriteSheet(),i=e.sprites.length;return this._animation=Bn.fromSpriteSheet(e,W(0,i),t),this._animation}get readCheckBytes(){return this._gif.checkBytes}}const po=t=>t.reduce((function(t,e){return 2*t+e}),0),go=t=>{const e=[];for(let i=7;i>=0;i--)e.push(!!(t&1<<i));return e};class fo{constructor(t){if(this.data=null,this.len=0,this.position=0,this.readByte=()=>{if(this.position>=this.data.byteLength)throw new Error("Attempted to read past end of stream.");return this.data[this.position++]},this.readBytes=t=>{const e=[];for(let i=0;i<t;i++)e.push(this.readByte());return e},this.read=t=>{let e="";for(let i=0;i<t;i++)e+=String.fromCharCode(this.readByte());return e},this.readUnsigned=()=>{const t=this.readBytes(2);return(t[1]<<8)+t[0]},this.data=new Uint8Array(t),this.len=this.data.byteLength,0===this.len)throw new Error("No data loaded from file")}}class mo{constructor(t,e=tt.Magenta){this._st=null,this._handler={},this._transparentColor=null,this.frames=[],this.images=[],this.globalColorTable=[],this.checkBytes=[],this.parseColorTable=t=>{const e=[];for(let i=0;i<t;i++){const t="#"+this._st.readBytes(3).map((t=>{const e=t.toString(16);return 1===e.length?"0"+e:e})).join("");e.push(t)}return e},this.readSubBlocks=()=>{let t,e;e="";do{t=this._st.readByte(),e+=this._st.read(t)}while(0!==t);return e},this.parseHeader=()=>{const t={sig:null,ver:null,width:null,height:null,colorRes:null,globalColorTableSize:null,gctFlag:null,sorted:null,globalColorTable:[],bgColor:null,pixelAspectRatio:null};if(t.sig=this._st.read(3),t.ver=this._st.read(3),"GIF"!==t.sig)throw new Error("Not a GIF file.");t.width=this._st.readUnsigned(),t.height=this._st.readUnsigned();const e=go(this._st.readByte());t.gctFlag=e.shift(),t.colorRes=po(e.splice(0,3)),t.sorted=e.shift(),t.globalColorTableSize=po(e.splice(0,3)),t.bgColor=this._st.readByte(),t.pixelAspectRatio=this._st.readByte(),t.gctFlag&&(t.globalColorTable=this.parseColorTable(1<<t.globalColorTableSize+1),this.globalColorTable=t.globalColorTable),this._handler.hdr&&this._handler.hdr(t)&&this.checkBytes.push(this._handler.hdr)},this.parseExt=t=>{const e=t=>{this.checkBytes.push(this._st.readByte());const e=go(this._st.readByte());t.reserved=e.splice(0,3),t.disposalMethod=po(e.splice(0,3)),t.userInput=e.shift(),t.transparencyGiven=e.shift(),t.delayTime=this._st.readUnsigned(),t.transparencyIndex=this._st.readByte(),t.terminator=this._st.readByte(),this._handler.gce&&this._handler.gce(t)&&this.checkBytes.push(this._handler.gce)},i=t=>{t.comment=this.readSubBlocks(),this._handler.com&&this._handler.com(t)&&this.checkBytes.push(this._handler.com)},s=t=>{this.checkBytes.push(this._st.readByte()),t.ptHeader=this._st.readBytes(12),t.ptData=this.readSubBlocks(),this._handler.pte&&this._handler.pte(t)&&this.checkBytes.push(this._handler.pte)},n=t=>{const e=t=>{this.checkBytes.push(this._st.readByte()),t.unknown=this._st.readByte(),t.iterations=this._st.readUnsigned(),t.terminator=this._st.readByte(),this._handler.app&&this._handler.app.NETSCAPE&&this._handler.app.NETSCAPE(t)&&this.checkBytes.push(this._handler.app)},i=t=>{t.appData=this.readSubBlocks(),this._handler.app&&this._handler.app[t.identifier]&&this._handler.app[t.identifier](t)&&this.checkBytes.push(this._handler.app[t.identifier])};if(this.checkBytes.push(this._st.readByte()),t.identifier=this._st.read(8),t.authCode=this._st.read(3),"NETSCAPE"===t.identifier)e(t);else i(t)},r=t=>{t.data=this.readSubBlocks(),this._handler.unknown&&this._handler.unknown(t)&&this.checkBytes.push(this._handler.unknown)};switch(t.label=this._st.readByte(),t.label){case 249:t.extType="gce",e(t);break;case 254:t.extType="com",i(t);break;case 1:t.extType="pte",s(t);break;case 255:t.extType="app",n(t);break;default:t.extType="unknown",r(t)}},this.parseImg=t=>{t.leftPos=this._st.readUnsigned(),t.topPos=this._st.readUnsigned(),t.width=this._st.readUnsigned(),t.height=this._st.readUnsigned();const e=go(this._st.readByte());t.lctFlag=e.shift(),t.interlaced=e.shift(),t.sorted=e.shift(),t.reserved=e.splice(0,2),t.lctSize=po(e.splice(0,3)),t.lctFlag&&(t.lct=this.parseColorTable(1<<t.lctSize+1)),t.lzwMinCodeSize=this._st.readByte();const i=this.readSubBlocks();t.pixels=function(t,e){let i=0;const s=function(t){let s=0;for(let n=0;n<t;n++)e.charCodeAt(i>>3)&1<<(7&i)&&(s|=1<<n),i++;return s},n=[],r=1<<t,o=r+1;let a=t+1,l=[];const h=function(){l=[],a=t+1;for(let t=0;t<r;t++)l[t]=[t];l[r]=[],l[o]=null};let c,d;for(;;)if(d=c,c=s(a),c!==r){if(c===o)break;if(c<l.length)d!==r&&l.push(l[d].concat(l[c][0]));else{if(c!==l.length)throw new Error("Invalid LZW code.");l.push(l[d].concat(l[d][0]))}n.push.apply(n,l[c]),l.length===1<<a&&a<12&&a++}else h();return n}(t.lzwMinCodeSize,i),t.interlaced&&(t.pixels=((t,e)=>{const i=new Array(t.length),s=t.length/e,n=(s,n)=>{const r=t.slice(n*e,(n+1)*e);i.splice.apply(i,[s*e,e].concat(r))},r=[0,4,2,1],o=[8,8,4,2];let a=0;for(let t=0;t<4;t++)for(let e=r[t];e<s;e+=o[t])n(e,a),a++;return i})(t.pixels,t.width)),this.frames.push(t),this.arrayToImage(t),this._handler.img&&this._handler.img(t)&&this.checkBytes.push(this._handler)},this.parseBlock=()=>{const t={sentinel:this._st.readByte(),type:""};switch(String.fromCharCode(t.sentinel)){case"!":t.type="ext",this.parseExt(t);break;case",":t.type="img",this.parseImg(t);break;case";":t.type="eof",this._handler.eof&&this._handler.eof(t)&&this.checkBytes.push(this._handler.eof);break;default:throw new Error("Unknown block: 0x"+t.sentinel.toString(16))}"eof"!==t.type&&this.parseBlock()},this.arrayToImage=t=>{let e=0;const i=document.createElement("canvas");i.id=e.toString(),i.width=t.width,i.height=t.height,e++;const s=i.getContext("2d");let n=0,r=0;for(let e=0;e<t.pixels.length;e++)r%t.width==0&&(n++,r=0),this.globalColorTable[t.pixels[e]]===this._transparentColor.toHex()?s.fillStyle="rgba(0, 0, 0, 0)":s.fillStyle=this.globalColorTable[t.pixels[e]],s.fillRect(r,n,1,1),r++;const o=new Image;o.src=i.toDataURL(),this.images.push(o)},this._st=t,this._handler={},this._transparentColor=e,this.parseHeader(),this.parseBlock()}}class yo extends At{constructor(t){super(t),this.points=t.points,this.rasterize()}get points(){return this._points}set points(t){this._points=t;const e=this.minPoint;this.width=this._points.reduce(((t,e)=>Math.max(e.x,t)),0)-e.x,this.height=this._points.reduce(((t,e)=>Math.max(e.y,t)),0)-e.y,this.flagDirty()}get minPoint(){return Q(this._points.reduce(((t,e)=>Math.min(e.x,t)),1/0),this._points.reduce(((t,e)=>Math.min(e.y,t)),1/0))}clone(){return new yo(Object.assign(Object.assign({points:this.points.map((t=>t.clone()))},this.cloneGraphicOptions()),this.cloneRasterOptions()))}execute(t){if(this.points&&this.points.length){t.beginPath();const e=this.minPoint.negate(),i=this.points[0].add(e);t.moveTo(i.x,i.y),this.points.forEach((i=>{t.lineTo(i.x+e.x,i.y+e.y)})),t.lineTo(i.x,i.y),t.closePath(),this.color&&t.fill(),this.strokeColor&&t.stroke()}}}var _o=function(t,e,i,s){var n,r=arguments.length,o=r<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,s);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(o=(r<3?n(o):r>3?n(e,i,o):n(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};let wo=class{constructor(t){this._getComparable=t}find(t){return this._find(this._root,t)}_find(t,e){return null!=t&&(this._getComparable(e)===t.getKey()?t.getData().indexOf(e)>-1:this._getComparable(e)<t.getKey()?this._find(t.getLeft(),e):this._find(t.getRight(),e))}get(t){return this._get(this._root,t)}_get(t,e){return null==t?[]:e===t.getKey()?t.getData():e<t.getKey()?this._get(t.getLeft(),e):this._get(t.getRight(),e)}add(t){return null==this._root?(this._root=new vo(this._getComparable(t),[t],null,null),!0):this._insert(this._root,t)}_insert(t,e){return null!=t&&(this._getComparable(e)===t.getKey()?!(t.getData().indexOf(e)>-1)&&(t.getData().push(e),!0):this._getComparable(e)<t.getKey()?null==t.getLeft()?(t.setLeft(new vo(this._getComparable(e),[e],null,null)),!0):this._insert(t.getLeft(),e):null==t.getRight()?(t.setRight(new vo(this._getComparable(e),[e],null,null)),!0):this._insert(t.getRight(),e))}removeByComparable(t){this._root=this._remove(this._root,t)}_remove(t,e){if(null==t)return null;if(this._getComparable(e)!==t.getKey())return this._getComparable(e)<t.getKey()?(t.setLeft(this._remove(t.getLeft(),e)),t):(t.setRight(this._remove(t.getRight(),e)),t);{const i=t.getData().indexOf(e);if(i>-1){if(t.getData().splice(i,1),0===t.getData().length){if(null==t.getLeft()&&null==t.getRight())return null;if(null==t.getLeft())return t.getRight();if(null==t.getRight())return t.getLeft();const e=this._findMinNode(t.getRight());return t.setKey(e.getKey()),t.setData(e.getData()),t.setRight(this._cleanup(t.getRight(),e)),t}return t}}return null}_cleanup(t,e){const i=e.getKey();if(null==t)return null;if(i===t.getKey()){if(null==t.getLeft()&&null==t.getRight())return null;if(null==t.getLeft())return t.getRight();if(null==t.getRight())return t.getLeft();const e=this._findMinNode(t.getRight());return t.setKey(e.getKey()),t.setData(e.getData()),t.setRight(this._cleanup(t.getRight(),e)),t}return e.getKey()<t.getKey()?(t.setLeft(this._cleanup(t.getLeft(),e)),t):(t.setRight(this._cleanup(t.getRight(),e)),t)}_findMinNode(t){let e=t;for(;null!=e.getLeft();)e=e.getLeft();return e}list(){const t=new Array;return this._list(this._root,t),t}_list(t,e){null!=t&&(this._list(t.getLeft(),e),t.getData().forEach((t=>{e.push(t)})),this._list(t.getRight(),e))}};wo=_o([K({message:"Will be removed in excalibur v0.26.0",alternateMethod:"Use built in JS array.sort"})],wo);let vo=class{constructor(t,e,i,s){this._key=t,this._data=e,this._left=i,this._right=s}getKey(){return this._key}setKey(t){this._key=t}getData(){return this._data}setData(t){this._data=t}getLeft(){return this._left}setLeft(t){this._left=t}getRight(){return this._right}setRight(t){this._right=t}};vo=_o([K({message:"Will be removed in excalibur v0.26.0"})],vo);class xo{constructor(t){this._key=0,this._key=t}getTheKey(){return this._key}setKey(t){this._key=t}}var bo,So,Co;(Co=So||(So={}))[Co.Resolved=0]="Resolved",Co[Co.Rejected=1]="Rejected",Co[Co.Pending=2]="Pending";let Eo=bo=class{constructor(){this._state=So.Pending,this._successCallbacks=[],this._rejectCallback=()=>{}}static resolve(t){return(new bo).resolve(t)}static reject(t){return(new bo).reject(t)}static join(){let t=[];if(arguments.length>0&&!Array.isArray(arguments[0]))for(let e=0;e<arguments.length;e++)t[e-0]=arguments[e];else 1===arguments.length&&Array.isArray(arguments[0])&&(t=arguments[0]);const e=new bo;if(!t||!t.length)return e.resolve();const i=t.length;let s=0,n=0;const r=[];return t.forEach((t=>{t.then((()=>{s+=1,s===i?e.resolve():s+n+r.length===i&&e.reject(r)}),(()=>{n+=1,s+n+r.length===i&&e.reject(r)})).error((t=>{r.push(t),r.length+s+n===i&&e.reject(r)}))})),e}then(t,e){if(t&&(this._successCallbacks.push(t),this.state()===So.Resolved))try{t.call(this,this._value)}catch(t){this._handleError(t)}if(e&&(this._rejectCallback=e,this.state()===So.Rejected))try{e.call(this,this._value)}catch(t){this._handleError(t)}return this}error(t){return t&&(this._errorCallback=t),this}resolve(t){if(this._state!==So.Pending)throw new Error("Cannot resolve a promise that is not in a pending state!");this._value=t;try{this._state=So.Resolved,this._successCallbacks.forEach((t=>{t.call(this,this._value)}))}catch(t){this._handleError(t)}return this}reject(t){if(this._state!==So.Pending)throw new Error("Cannot reject a promise that is not in a pending state!");this._value=t;try{this._state=So.Rejected,this._rejectCallback.call(this,this._value)}catch(t){this._handleError(t)}return this}state(){return this._state}_handleError(t){if(!this._errorCallback)throw t;this._errorCallback.call(this,t)}};Eo=bo=function(t,e,i,s){var n,r=arguments.length,o=r<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,s);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(o=(r<3?n(o):r>3?n(e,i,o):n(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o}([K({message:"ex.Promises are being replaced by native browser promises in v0.26.0",alternateMethod:"Use browser native promises"})],Eo);const Po="0.25.1";g()})();var u=d.vtX,p=d.fwF,g=d._c7,f=d.v2G,m=d.Ilk,y=d.d1Y,_=d.wAz,w=d.D4V,v=d.cXo,x=d.IIB,b=d.aNw,S=d.Vol,C=d.wIZ,E=d.xsS,P=d.bnF,A=d.MFA,k=d.$uU,T=d.V6q,R=d.B7y,M=d.xzN,D=d.OWs,L=d.Bhw;n.register("akNz5",(function(t,e){t.exports=n("kPq84").getBundleURL("7tqtW")+n("bXuNP").resolve("5xRnk")})),n.register("kPq84",(function(e,i){var s;t(e.exports,"getBundleURL",(()=>s),(t=>s=t));var n={};function r(t){return(""+t).replace(/^((?:https?|file|ftp):\/\/.+)\/[^/]+$/,"$1")+"/"}s=function(t){var e=n[t];return e||(e=function(){try{throw new Error}catch(e){var t=(""+e.stack).match(/(https?|file|ftp):\/\/[^)\n]+/g);if(t)return r(t[2])}return"/"}(),n[t]=e),e}})),n.register("8F4E4",(function(t,e){t.exports=n("kPq84").getBundleURL("7tqtW")+n("bXuNP").resolve("err8w")})),n.register("6Np85",(function(t,e){t.exports=n("kPq84").getBundleURL("7tqtW")+n("bXuNP").resolve("bVXkl")})),n.register("8wan9",(function(t,e){t.exports=n("kPq84").getBundleURL("7tqtW")+n("bXuNP").resolve("7e8WY")})),n.register("7bnnv",(function(t,e){t.exports=n("kPq84").getBundleURL("7tqtW")+n("bXuNP").resolve("fqlo3")})),n.register("92WRv",(function(t,e){t.exports=n("kPq84").getBundleURL("7tqtW")+n("bXuNP").resolve("4iSkz")})),n.register("6ZUwx",(function(t,e){t.exports=n("kPq84").getBundleURL("7tqtW")+n("bXuNP").resolve("Hoube")})),n.register("beMNZ",(function(t,e){t.exports=n("kPq84").getBundleURL("7tqtW")+n("bXuNP").resolve("afZaY")})),n.register("1lX6L",(function(t,e){t.exports=n("kPq84").getBundleURL("7tqtW")+n("bXuNP").resolve("dNGgx")})),n.register("6zP2u",(function(t,e){t.exports=n("kPq84").getBundleURL("7tqtW")+n("bXuNP").resolve("9Njpj")})),n.register("lXkIg",(function(t,e){t.exports=n("kPq84").getBundleURL("7tqtW")+n("bXuNP").resolve("8mzxC")})),n.register("l9TrG",(function(t,e){t.exports=n("kPq84").getBundleURL("7tqtW")+n("bXuNP").resolve("jRWgD")})),n.register("bp9cl",(function(t,e){t.exports=n("kPq84").getBundleURL("7tqtW")+n("bXuNP").resolve("4r9cb")})),n.register("jorgj",(function(t,e){t.exports=n("kPq84").getBundleURL("7tqtW")+n("bXuNP").resolve("9RtUT")})),n.register("fzbb0",(function(t,e){t.exports=n("kPq84").getBundleURL("7tqtW")+n("bXuNP").resolve("6zuRN")})),n.register("3V3ha",(function(t,e){t.exports=n("kPq84").getBundleURL("7tqtW")+n("bXuNP").resolve("aIQ35")})),n.register("hXVzZ",(function(t,e){t.exports=n("kPq84").getBundleURL("7tqtW")+n("bXuNP").resolve("8xT79")})),n.register("9CWae",(function(t,e){t.exports=n("kPq84").getBundleURL("7tqtW")+n("bXuNP").resolve("lCQXP")})),n.register("6glWh",(function(t,e){t.exports=n("kPq84").getBundleURL("7tqtW")+n("bXuNP").resolve("aSscN")})),n.register("b7ojY",(function(t,e){t.exports=n("kPq84").getBundleURL("7tqtW")+n("bXuNP").resolve("hESKd")})),n.register("hFFBc",(function(t,e){t.exports=n("kPq84").getBundleURL("7tqtW")+n("bXuNP").resolve("lehYa")})),n.register("6iAfM",(function(t,e){t.exports=n("kPq84").getBundleURL("7tqtW")+n("bXuNP").resolve("2R7ES")})),n.register("3jAyi",(function(t,e){t.exports=n("kPq84").getBundleURL("7tqtW")+n("bXuNP").resolve("jcWNy")})),n.register("1Tvhe",(function(t,e){t.exports=n("kPq84").getBundleURL("7tqtW")+n("bXuNP").resolve("vEj6i")})),n.register("gJaVV",(function(t,e){t.exports=n("kPq84").getBundleURL("7tqtW")+n("bXuNP").resolve("807Z1")})),n.register("31z3u",(function(t,e){t.exports=n("kPq84").getBundleURL("7tqtW")+n("bXuNP").resolve("5WcSy")})),n.register("98Pzm",(function(t,e){t.exports=n("kPq84").getBundleURL("7tqtW")+n("bXuNP").resolve("aWvOM")})),n.register("aiZkI",(function(t,e){t.exports=n("kPq84").getBundleURL("7tqtW")+n("bXuNP").resolve("azIKW")})),n.register("a4hNv",(function(t,e){t.exports=n("kPq84").getBundleURL("7tqtW")+n("bXuNP").resolve("d5Ypo")})),n.register("iQ6DA",(function(t,e){t.exports=n("kPq84").getBundleURL("7tqtW")+n("bXuNP").resolve("d56l0")})),n.register("5O7TD",(function(t,e){t.exports=n("kPq84").getBundleURL("7tqtW")+n("bXuNP").resolve("gOIrJ")})),n.register("5zgBR",(function(t,e){t.exports=n("kPq84").getBundleURL("7tqtW")+n("bXuNP").resolve("5DmGH")})),n.register("fAFJK",(function(t,e){t.exports=n("kPq84").getBundleURL("7tqtW")+n("bXuNP").resolve("c2erN")}));const B={bolt:new v(n("akNz5")),bolt2:new v(n("8F4E4")),hero_idle:new v(n("6Np85")),heroExias_idle:new v(n("8wan9")),hero_run:new v(n("7bnnv")),heroExias_run:new v(n("92WRv")),hero_jump:new v(n("6ZUwx")),hero_down:new v(n("beMNZ")),hero_attack:new v(n("1lX6L")),hero_attack_down:new v(n("6zP2u")),hero_attack_jump:new v(n("lXkIg")),rose:new v(n("l9TrG")),fox:new v(n("bp9cl")),mirror:new v(n("jorgj")),mage:new v(n("fzbb0")),war:new v(n("3V3ha")),bubble:new v(n("hXVzZ")),crystal:new v(n("9CWae")),xiao:new v(n("6glWh")),dragon:new v(n("b7ojY")),kstore:new v(n("hFFBc")),acidpop:new v(n("6iAfM")),shrek:new v(n("3jAyi")),inf1:new v(n("1Tvhe")),inf2:new v(n("gJaVV")),avatar_fox:new v(n("31z3u")),avatar_xiao:new v(n("98Pzm")),avatar_dragon:new v(n("aiZkI")),avatar_kstore:new v(n("a4hNv")),avatar_acidpop:new v(n("iQ6DA")),avatar_shrek:new v(n("5O7TD")),avatar_skeleton:new v(n("5zgBR")),avatar_chest:new v(n("fAFJK"))};n.register("3OjDo",(function(t,e){t.exports=n("kPq84").getBundleURL("7tqtW")+n("bXuNP").resolve("g9Y9O")})),n.register("3ocmJ",(function(t,e){t.exports=n("kPq84").getBundleURL("7tqtW")+n("bXuNP").resolve("DIGfs")})),n.register("sln3p",(function(t,e){t.exports=n("kPq84").getBundleURL("7tqtW")+n("bXuNP").resolve("2e9fk")})),n.register("ff1Ei",(function(t,e){t.exports=n("kPq84").getBundleURL("7tqtW")+n("bXuNP").resolve("6yS6A")})),n.register("26g01",(function(t,e){t.exports=n("kPq84").getBundleURL("7tqtW")+n("bXuNP").resolve("l80cM")})),n.register("aAHGR",(function(t,e){t.exports=n("kPq84").getBundleURL("7tqtW")+n("bXuNP").resolve("49RhT")})),n.register("4CYau",(function(t,e){t.exports=n("kPq84").getBundleURL("7tqtW")+n("bXuNP").resolve("b6g9W")})),n.register("fMINN",(function(t,e){t.exports=n("kPq84").getBundleURL("7tqtW")+n("bXuNP").resolve("k3kkF")})),n.register("8MjKB",(function(t,e){t.exports=n("kPq84").getBundleURL("7tqtW")+n("bXuNP").resolve("jISjQ")})),n.register("lOxvT",(function(t,e){t.exports=n("kPq84").getBundleURL("7tqtW")+n("bXuNP").resolve("2HTCO")})),n.register("8PV9X",(function(t,e){t.exports=n("kPq84").getBundleURL("7tqtW")+n("bXuNP").resolve("cFgcn")})),n.register("ggEBp",(function(t,e){t.exports=n("kPq84").getBundleURL("7tqtW")+n("bXuNP").resolve("jZDvr")})),n.register("jhQhq",(function(t,e){t.exports=n("kPq84").getBundleURL("7tqtW")+n("bXuNP").resolve("3u2CA")})),n.register("5jhcE",(function(t,e){t.exports=n("kPq84").getBundleURL("7tqtW")+n("bXuNP").resolve("ez2kK")})),n.register("eC1zX",(function(t,e){t.exports=n("kPq84").getBundleURL("7tqtW")+n("bXuNP").resolve("8BzVu")})),n.register("iBGhb",(function(t,e){t.exports=n("kPq84").getBundleURL("7tqtW")+n("bXuNP").resolve("jUlsg")})),n.register("92Q5Y",(function(t,e){t.exports=n("kPq84").getBundleURL("7tqtW")+n("bXuNP").resolve("ahHfh")})),n.register("hYIb4",(function(t,e){t.exports=n("kPq84").getBundleURL("7tqtW")+n("bXuNP").resolve("4MBij")})),n.register("4rCjO",(function(t,e){t.exports=n("kPq84").getBundleURL("7tqtW")+n("bXuNP").resolve("6xjFi")})),n.register("2x7r7",(function(t,e){t.exports=n("kPq84").getBundleURL("7tqtW")+n("bXuNP").resolve("Ewfh9")})),n.register("3W21Z",(function(t,e){t.exports=n("kPq84").getBundleURL("7tqtW")+n("bXuNP").resolve("9fuZJ")})),n.register("7H74Y",(function(t,e){t.exports=n("kPq84").getBundleURL("7tqtW")+n("bXuNP").resolve("50sJ5")})),n.register("kD3yd",(function(t,e){t.exports=n("kPq84").getBundleURL("7tqtW")+n("bXuNP").resolve("ftwy4")})),n.register("5dEOq",(function(t,e){t.exports=n("kPq84").getBundleURL("7tqtW")+n("bXuNP").resolve("gUSUL")})),n.register("8bN9M",(function(t,e){t.exports=n("kPq84").getBundleURL("7tqtW")+n("bXuNP").resolve("c5Pso")})),n.register("5FREI",(function(t,e){t.exports=n("kPq84").getBundleURL("7tqtW")+n("bXuNP").resolve("1wzqC")})),n.register("jGeUF",(function(t,e){t.exports=n("kPq84").getBundleURL("7tqtW")+n("bXuNP").resolve("dM3Kz")})),n.register("8i1H9",(function(t,e){t.exports=n("kPq84").getBundleURL("7tqtW")+n("bXuNP").resolve("gxm7S")})),n.register("6mv04",(function(t,e){t.exports=n("kPq84").getBundleURL("7tqtW")+n("bXuNP").resolve("gBGY0")}));const I={sky:new k(n("3OjDo")),s2043:new k(n("3ocmJ")),s2045:new k(n("sln3p")),firebolt:new k(n("ff1Ei")),jump_0:new k(n("26g01")),jump_1:new k(n("aAHGR")),jump_2:new k(n("4CYau")),fox_1:new k(n("fMINN")),fox_2:new k(n("8MjKB")),fox_3:new k(n("lOxvT")),hero_dead:new k(n("8PV9X")),s264:new k(n("ggEBp")),s268:new k(n("jhQhq")),s270:new k(n("5jhcE")),s278:new k(n("eC1zX")),s279:new k(n("iBGhb")),s281:new k(n("92Q5Y")),s282:new k(n("hYIb4")),s283:new k(n("4rCjO")),transi:new k(n("2x7r7")),crystal:new k(n("3W21Z")),boom:new k(n("7H74Y")),hit_light:new k(n("kD3yd")),music_1:new k(n("5dEOq")),music_army:new k(n("8bN9M")),music_dragon:new k(n("5FREI")),music_soldier:new k(n("jGeUF")),music_boss:new k(n("8i1H9")),music_end:new k(n("6mv04"))},F=(t,e=0,i=0,s=1,n=1)=>T.fromImageSource({image:B[t],grid:{columns:s,rows:n,spriteWidth:e||B[t].width,spriteHeight:i||B[t].height}}),z={columns:1,rows:8,spriteWidth:56,spriteHeight:48},N=(T.fromImageSource({image:B.mage,grid:{columns:7,rows:12,spriteWidth:56,spriteHeight:48}}),T.fromImageSource({image:B.mage,grid:{columns:21,rows:5,spriteWidth:48,spriteHeight:48}})),O=T.fromImageSource({image:B.war,grid:{columns:13,rows:5,spriteWidth:48,spriteHeight:48}}),U=T.fromImageSource({image:B.mirror,grid:{columns:1,rows:7,spriteWidth:64,spriteHeight:128}}),H=T.fromImageSource({image:B.bolt2,grid:{columns:1,rows:5,spriteWidth:32,spriteHeight:32}}),W=T.fromImageSource({image:B.bolt,grid:{columns:1,rows:5,spriteWidth:32,spriteHeight:32}}),j=T.fromImageSource({image:B.hero_attack,grid:{...z,rows:11}}),V=T.fromImageSource({image:B.hero_attack_down,grid:{...z,rows:7}}),q=T.fromImageSource({image:B.hero_attack_jump,grid:{...z,rows:5}}),X=T.fromImageSource({image:B.hero_idle,grid:z}),G=T.fromImageSource({image:B.heroExias_idle,grid:z}),K=T.fromImageSource({image:B.hero_down,grid:z}),Y=T.fromImageSource({image:B.hero_run,grid:z}),Q=T.fromImageSource({image:B.heroExias_run,grid:{...z,rows:9}}),Z=T.fromImageSource({image:B.hero_jump,grid:{...z,rows:12}}),$={bolt:p.fromSpriteSheet(W,[0,1,2,3,4],60),rose:p.fromSpriteSheet(F("rose"),[0],100),fox:p.fromSpriteSheet(F("fox",64,64,1,4),[0,1,2,3],600,g.PingPong),mirror:p.fromSpriteSheet(U,[2,3,4,5,6],100),war_idle:p.fromSpriteSheet(O,[0,1,2,3,4,5,6,7],100),war_attack:p.fromSpriteSheet(O,[16,17,18,19,20,21,22,23],40),war_walk:p.fromSpriteSheet(O,[26,27,28,29,30,31],100),mage_idle:p.fromSpriteSheet(N,[0,1,2,3,4,5,6,7],100),mage_attack:p.fromSpriteSheet(N,[25,26,27,28,29,30,31,32,33,34],40),bubble:p.fromSpriteSheet(F("bubble"),[0],100),crystal_red:p.fromSpriteSheet(F("crystal",64,64,2,4),[0,2,4,6],600),crystal_blue:p.fromSpriteSheet(F("crystal",64,64,2,4),[1,3,5,7],600),inf1:p.fromSpriteSheet(F("inf1"),[0],100),inf2:p.fromSpriteSheet(F("inf2"),[0],100),shrek:p.fromSpriteSheet(F("shrek"),[0],100),acidpop:p.fromSpriteSheet(F("acidpop"),[0],100),kstore:p.fromSpriteSheet(F("kstore"),[0],100),dragon_idle:p.fromSpriteSheet(F("dragon",128,64,1,6),[0,1,2,3,4,5],500)},J=Object.keys($);var tt,et;(et=tt||(tt={}))[et.LEFT=-1]="LEFT",et[et.RIGHT=1]="RIGHT";class it extends u{constructor(t,e){super({name:"bolt",pos:t,radius:10,collisionType:f.Passive}),this.direction=e}sheet(){return W}onPreCollision(t){"mage"===t.other.name&&t.other.collider.bounds.contains(this.collider.bounds)&&(this.kill(),t.other.kill()),"war"===t.other.name&&this.collider.localBounds.getPoints().every((e=>t.other.collider.localBounds.contains(e)))&&(this.kill(),t.other.kill()),"bolt2"===t.other.name&&(this.kill(),t.other.kill())}onInitialize(t){this.anim=p.fromSpriteSheet(this.sheet(),[0,1,2,3,4],60),this.anim.flipHorizontal=this.direction===tt.LEFT,this.graphics.add("bolt",this.anim),this.graphics.use("bolt"),setTimeout((()=>{this.kill()}),800),this.on("collisionstart",(t=>{t.other.name.includes("floor")&&this.kill()})),this.on("precollision",(t=>{this.onPreCollision(t)}))}onPreUpdate(t,e){this.vel.x=600*this.direction,this.vel.y=0}}n.register("eIxhF",(function(t,e){t.exports=JSON.parse('{"name":"Rve","music":"music_1","entities":[{"type":"floor","x":0,"y":-1000,"width":32,"height":5000,"color":"000000"},{"type":"floor","x":-1000,"y":600,"width":8000,"height":32},{"type":"event","event":"start","x":400,"y":-800,"width":64,"height":64},{"type":"npc","x":520,"y":440,"width":64,"height":64,"animation":"fox","name":"fox"},{"type":"event","x":16,"y":440,"width":104,"height":184,"event":"dialog","data1":"fox2"},{"type":"event","x":328,"y":496,"width":264,"height":128,"event":"dialog","data1":"fox1","data2":"2000"},{"type":"floor","x":1152,"y":512,"width":64,"height":120},{"type":"floor","x":1200,"y":496,"width":64,"height":64},{"type":"floor","x":1248,"y":504,"width":72,"height":16},{"type":"floor","x":1104,"y":584,"width":64,"height":40},{"type":"event","x":1024,"y":416,"width":64,"height":232,"event":"dialog","data1":"fox3"},{"type":"floor","x":1424,"y":544,"width":40,"height":216},{"type":"floor","x":1440,"y":584,"width":64,"height":64},{"type":"floor","x":1504,"y":88,"width":32,"height":224},{"type":"floor","x":1576,"y":-64,"width":24,"height":320},{"type":"floor","x":1760,"y":528,"width":64,"height":80},{"type":"floor","x":1816,"y":488,"width":40,"height":96},{"type":"floor","x":1832,"y":480,"width":192,"height":64},{"type":"floor","x":1912,"y":360,"width":200,"height":72},{"type":"floor","x":2008,"y":240,"width":64,"height":136},{"type":"floor","x":1968,"y":200,"width":32,"height":184},{"type":"floor","x":2120,"y":312,"width":64,"height":200},{"type":"floor","x":2080,"y":288,"width":32,"height":64},{"type":"event","x":1816,"y":344,"width":112,"height":192,"event":"dialog","data1":"fox4"},{"type":"floor","x":2336,"y":304,"width":240,"height":16,"move":{"y":200},"color":"#b1aaaa"},{"type":"floor","x":2256,"y":552,"width":24,"height":64},{"type":"floor","x":2584,"y":296,"width":64,"height":296},{"type":"floor","x":2632,"y":520,"width":48,"height":64},{"type":"floor","x":2688,"y":520,"width":40,"height":80},{"type":"floor","x":2656,"y":448,"width":80,"height":64},{"type":"floor","x":2632,"y":416,"width":80,"height":24},{"type":"floor","x":2840,"y":-56,"width":24,"height":216},{"type":"floor","x":2656,"y":392,"width":88,"height":16},{"type":"floor","x":2752,"y":360,"width":320,"height":96},{"type":"event","x":5952,"y":352,"width":112,"height":360,"event":"dialog","data1":"level1_fox_end"},{"type":"event","x":2200,"y":424,"width":80,"height":192,"event":"dialog","data1":"level1_fox5"},{"type":"npc","x":2712,"y":176,"width":64,"height":64,"animation":"fox","dialogs":[""],"name":"fox"},{"type":"floor","x":3048,"y":440,"width":360,"height":160},{"type":"floor","x":2792,"y":416,"width":344,"height":64},{"type":"floor","x":2833,"y":500,"width":24,"height":16},{"type":"floor","x":2928,"y":496,"width":40,"height":40},{"type":"floor","x":2792,"y":568,"width":200,"height":16},{"type":"floor","x":2776,"y":552,"width":16,"height":16},{"type":"floor","x":2992,"y":544,"width":24,"height":24},{"type":"floor","x":3344,"y":576,"width":832,"height":48},{"type":"foe","x":3216,"y":344,"width":96,"height":96,"name":"Spawn"},{"type":"floor","x":3408,"y":392,"width":64,"height":208},{"type":"floor","x":3447,"y":336,"width":64,"height":272},{"type":"floor","x":3480,"y":264,"width":64,"height":176},{"type":"floor","x":3584,"y":264,"width":64,"height":16,"move":{"y":0,"x":300,"speed":100}},{"type":"floor","x":3968,"y":256,"width":144,"height":112},{"type":"floor","x":4024,"y":304,"width":24,"height":272},{"type":"foe","x":3512,"y":504,"width":512,"height":72,"name":"DeadlyArea"},{"type":"event","x":328,"y":536,"width":264,"height":88,"event":"shake","data1":"10","data2":"10","data3":"500","data4":"boom"},{"type":"floor","x":4040,"y":344,"width":112,"height":240},{"type":"foe","x":4136,"y":504,"width":472,"height":96,"name":"DeadlyArea"},{"type":"floor","x":4600,"y":432,"width":264,"height":176},{"type":"floor","x":4232,"y":400,"width":104,"height":48},{"type":"floor","x":4424,"y":408,"width":104,"height":40},{"type":"floor","x":4840,"y":472,"width":160,"height":128},{"type":"floor","x":4952,"y":208,"width":64,"height":208},{"type":"floor","x":4992,"y":136,"width":48,"height":232},{"type":"floor","x":4920,"y":87,"width":64,"height":232},{"type":"floor","x":4992,"y":360,"width":216,"height":40},{"type":"npc","x":4624,"y":248,"width":64,"height":64,"animation":"fox","dialogs":[""],"name":"fox"},{"type":"floor","x":5400,"y":408,"width":64,"height":112},{"type":"floor","x":5800,"y":400,"width":64,"height":256},{"type":"floor","x":5824,"y":496,"width":152,"height":144},{"type":"floor","x":6368,"y":544,"width":408,"height":96},{"type":"floor","x":7186,"y":400,"width":64,"height":248},{"type":"floor","x":6944,"y":504,"width":72,"height":144},{"type":"floor","x":6720,"y":560,"width":240,"height":64},{"type":"floor","x":5328,"y":408,"width":64,"height":24,"move":{"y":100,"x":0,"speed":0}},{"type":"npc","x":7040,"y":368,"width":64,"height":64,"animation":"fox","dialogs":[""],"name":"fox"},{"type":"event","x":3088,"y":184,"width":104,"height":296,"event":"dialog","data1":"level1_fox6"},{"type":"event","x":4796,"y":152,"width":64,"height":312,"event":"dialog","data1":"level1_fox7"},{"type":"foe","x":5464,"y":464,"width":56,"height":136,"name":"Block"},{"type":"floor","x":5648,"y":560,"width":160,"height":64},{"type":"floor","x":5224,"y":560,"width":64,"height":64},{"type":"floor","x":3040,"y":184,"width":360,"height":64},{"type":"floor","x":3040,"y":80,"width":64,"height":112},{"type":"floor","x":2856,"y":96,"width":376,"height":64},{"type":"floor","x":3176,"y":200,"width":192,"height":64}]}')})),n.register("9tt2b",(function(t,e){t.exports=JSON.parse('{"name":"Kstore & Acidpop","music":"music_army","entities":[{"type":"floor","x":0,"y":-1000,"width":32,"height":5000,"color":"000000"},{"type":"floor","x":-1000,"y":600,"width":8000,"height":32},{"type":"event","event":"start","x":400,"y":-1000,"width":64,"height":64},{"type":"event","x":384,"y":536,"width":144,"height":88,"event":"shake","data1":"10","data2":"10","data3":"500","data4":"boom"},{"type":"event","x":5160,"y":448,"width":64,"height":184,"event":"unlock_firebolt"},{"type":"floor","x":680,"y":424,"width":984,"height":40},{"type":"floor","x":208,"y":608,"width":56,"height":216},{"type":"floor","x":680,"y":240,"width":64,"height":184},{"type":"floor","x":744,"y":240,"width":928,"height":40},{"type":"floor","x":264,"y":784,"width":2336,"height":40},{"type":"foe","x":756,"y":328,"width":96,"height":96,"name":"War"},{"type":"foe","x":912,"y":328,"width":96,"height":96,"name":"War"},{"type":"foe","x":1104,"y":328,"width":96,"height":96,"name":"War"},{"type":"foe","x":296,"y":688,"width":96,"height":96,"name":"War"},{"type":"foe","x":504,"y":688,"width":96,"height":96,"name":"War"},{"type":"foe","x":776,"y":688,"width":96,"height":96,"name":"War"},{"type":"foe","x":1016,"y":688,"width":96,"height":96,"name":"War"},{"type":"foe","x":1160,"y":688,"width":96,"height":96,"name":"War"},{"type":"foe","x":1344,"y":688,"width":96,"height":96,"name":"War"},{"type":"foe","x":1552,"y":688,"width":96,"height":96,"name":"War"},{"type":"foe","x":1792,"y":688,"width":96,"height":96,"name":"War"},{"type":"foe","x":1296,"y":328,"width":96,"height":96,"name":"War"},{"type":"floor","x":1632,"y":288,"width":32,"height":192},{"type":"floor","x":1616,"y":168,"width":64,"height":64},{"type":"foe","x":1496,"y":296,"width":128,"height":128,"name":"Mirror"},{"type":"foe","x":2008,"y":656,"width":128,"height":128,"name":"Mirror"},{"type":"floor","x":2511,"y":552,"width":40,"height":528},{"type":"foe","x":2160,"y":688,"width":96,"height":96,"name":"War"},{"type":"foe","x":2360,"y":688,"width":96,"height":96,"name":"War"},{"type":"floor","x":112,"y":968,"width":2520,"height":64},{"type":"floor","x":96,"y":798,"width":40,"height":320},{"type":"foe","x":184,"y":872,"width":96,"height":96,"name":"War"},{"type":"foe","x":376,"y":872,"width":96,"height":96,"name":"War"},{"type":"foe","x":560,"y":872,"width":96,"height":96,"name":"War"},{"type":"foe","x":784,"y":872,"width":96,"height":96,"name":"War"},{"type":"foe","x":960,"y":872,"width":96,"height":96,"name":"War"},{"type":"foe","x":1128,"y":872,"width":96,"height":96,"name":"War"},{"type":"foe","x":1336,"y":872,"width":96,"height":96,"name":"War"},{"type":"foe","x":1536,"y":872,"width":96,"height":96,"name":"War"},{"type":"foe","x":1720,"y":872,"width":96,"height":96,"name":"War"},{"type":"foe","x":1936,"y":872,"width":96,"height":96,"name":"War"},{"type":"foe","x":2160,"y":872,"width":96,"height":96,"name":"War"},{"type":"foe","x":1472,"y":144,"width":96,"height":96,"name":"War"},{"type":"foe","x":1272,"y":144,"width":96,"height":96,"name":"War"},{"type":"foe","x":1096,"y":144,"width":96,"height":96,"name":"War"},{"type":"foe","x":912,"y":144,"width":96,"height":96,"name":"War"},{"type":"floor","x":680,"y":168,"width":32,"height":64},{"type":"floor","x":788,"y":542,"width":64,"height":64},{"type":"floor","x":1800,"y":520,"width":192,"height":24,"move":{"y":-200,"x":0,"speed":0}},{"type":"floor","x":2040,"y":320,"width":40,"height":304},{"type":"npc","x":2064,"y":440,"width":96,"height":96,"animation":"kstore","dialogs":[""],"name":"kstore"},{"type":"floor","x":2200,"y":360,"width":256,"height":104},{"type":"floor","x":2248,"y":96,"width":48,"height":288},{"type":"floor","x":2448,"y":280,"width":48,"height":200},{"type":"foe","x":2320,"y":264,"width":96,"height":96,"name":"War"},{"type":"foe","x":2192,"y":504,"width":96,"height":96,"name":"War"},{"type":"foe","x":2008,"y":200,"width":96,"height":96,"name":"Spawn"},{"type":"floor","x":2000,"y":296,"width":112,"height":32},{"type":"floor","x":2080,"y":536,"width":64,"height":64},{"type":"floor","x":2496,"y":328,"width":104,"height":64},{"type":"floor","x":2544,"y":504,"width":88,"height":96},{"type":"floor","x":2880,"y":464,"width":64,"height":56},{"type":"floor","x":2912,"y":496,"width":288,"height":24},{"type":"foe","x":2880,"y":520,"width":112,"height":80,"name":"DeadlyArea"},{"type":"foe","x":2504,"y":232,"width":96,"height":96,"name":"Spawner"},{"type":"floor","x":2272,"y":440,"width":64,"height":72},{"type":"floor","x":2392,"y":552,"width":136,"height":64},{"type":"floor","x":3200,"y":408,"width":64,"height":192},{"type":"floor","x":3352,"y":408,"width":216,"height":64},{"type":"floor","x":3656,"y":400,"width":144,"height":208},{"type":"floor","x":3400,"y":200,"width":96,"height":40},{"type":"foe","x":3400,"y":104,"width":96,"height":96,"name":"Spawner"},{"type":"foe","x":3256,"y":512,"width":400,"height":96,"name":"DeadlyArea"},{"type":"foe","x":3680,"y":304,"width":96,"height":96,"name":"Spawn"},{"type":"foe","x":4328,"y":472,"width":128,"height":128,"name":"Mirror","data2":"1"},{"type":"foe","x":4176,"y":192,"width":128,"height":128,"name":"Mirror","data1":"1"},{"type":"floor","x":4200,"y":320,"width":376,"height":32},{"type":"foe","x":3976,"y":504,"width":96,"height":96,"name":"War"},{"type":"floor","x":4552,"y":232,"width":64,"height":384},{"type":"floor","x":4848,"y":280,"width":48,"height":48},{"type":"floor","x":4800,"y":304,"width":392,"height":56},{"type":"npc","x":2160,"y":288,"width":64,"height":64,"animation":"fox","dialogs":[""],"name":"fox"},{"type":"npc","x":4832,"y":440,"width":64,"height":64,"animation":"fox","dialogs":[""],"name":"fox"},{"type":"npc","x":4616,"y":536,"width":64,"height":64,"animation":"acidpop","dialogs":[""],"name":"acidpop"},{"type":"npc","x":4664,"y":504,"width":96,"height":96,"animation":"kstore","dialogs":[""],"name":"kstore"},{"type":"floor","x":5152,"y":80,"width":64,"height":424},{"type":"floor","x":5232,"y":584,"width":64,"height":32},{"type":"floor","x":5184,"y":440,"width":520,"height":64},{"type":"floor","x":5704,"y":584,"width":64,"height":168},{"type":"floor","x":5656,"y":616,"width":64,"height":112},{"type":"floor","x":5600,"y":616,"width":64,"height":64},{"type":"foe","x":5304,"y":504,"width":96,"height":96,"name":"War"},{"type":"foe","x":3408,"y":312,"width":96,"height":96,"name":"Mage"},{"type":"foe","x":6112,"y":504,"width":96,"height":96,"name":"Mage"},{"type":"floor","x":5824,"y":528,"width":64,"height":128},{"type":"floor","x":5992,"y":440,"width":464,"height":64},{"type":"floor","x":5992,"y":264,"width":64,"height":184},{"type":"floor","x":5640,"y":256,"width":64,"height":184},{"type":"floor","x":5728,"y":288,"width":64,"height":64},{"type":"floor","x":5816,"y":288,"width":64,"height":64},{"type":"floor","x":5904,"y":288,"width":64,"height":64},{"type":"floor","x":5584,"y":352,"width":520,"height":16},{"type":"foe","x":6304,"y":504,"width":96,"height":96,"name":"Mage"},{"type":"floor","x":6784,"y":552,"width":64,"height":56},{"type":"floor","x":6832,"y":480,"width":168,"height":160},{"type":"floor","x":7113,"y":304,"width":64,"height":416},{"type":"npc","x":6936,"y":416,"width":64,"height":64,"animation":"acidpop","dialogs":[""],"name":"acidpop"},{"type":"npc","x":6840,"y":384,"width":96,"height":96,"animation":"kstore","dialogs":[""],"name":"kstore"},{"type":"npc","x":7024,"y":296,"width":64,"height":64,"animation":"fox","dialogs":[""],"name":"fox"},{"type":"floor","x":6696,"y":520,"width":104,"height":104},{"type":"floor","x":6640,"y":552,"width":104,"height":64},{"type":"floor","x":5608,"y":256,"width":488,"height":24},{"type":"floor","x":5640,"y":192,"width":1032,"height":32},{"type":"floor","x":6576,"y":152,"width":32,"height":456},{"type":"floor","x":6512,"y":552,"width":64,"height":24,"move":{"y":-100,"x":0,"speed":0}},{"type":"foe","x":6120,"y":312,"width":128,"height":128,"name":"Mirror","data2":"5","data1":"4"},{"type":"foe","x":5416,"y":312,"width":128,"height":128,"name":"Mirror","data1":"5","data2":"4"},{"type":"floor","x":5248,"y":408,"width":64,"height":64},{"type":"foe","x":5232,"y":312,"width":96,"height":96,"name":"Mage","data2":"132"},{"type":"foe","x":5808,"y":432,"width":96,"height":96,"name":"Spawn"},{"type":"floor","x":5856,"y":144,"width":64,"height":64},{"type":"foe","x":6120,"y":96,"width":96,"height":96,"name":"War"},{"type":"foe","x":6288,"y":96,"width":96,"height":96,"name":"War"},{"type":"foe","x":4968,"y":208,"width":96,"height":96,"name":"War"},{"type":"floor","x":6592,"y":376,"width":64,"height":296},{"type":"floor","x":6568,"y":608,"width":352,"height":56},{"type":"floor","x":7160,"y":328,"width":64,"height":304},{"type":"floor","x":7216,"y":504,"width":152,"height":64},{"type":"floor","x":7208,"y":136,"width":64,"height":376},{"type":"npc","x":7272,"y":376,"width":128,"height":128,"animation":"shrek","dialogs":[""],"name":"shrek"},{"type":"floor","x":4488,"y":272,"width":64,"height":64},{"type":"floor","x":4568,"y":192,"width":176,"height":40},{"type":"floor","x":4136,"y":320,"width":64,"height":64},{"type":"floor","x":3784,"y":504,"width":64,"height":144},{"type":"floor","x":4496,"y":440,"width":64,"height":216},{"type":"floor","x":2936,"y":440,"width":272,"height":64},{"type":"floor","x":2992,"y":376,"width":64,"height":80},{"type":"event","x":680,"y":448,"width":64,"height":176,"event":"dialog","data1":"l2_1"},{"type":"floor","x":5000,"y":488,"width":64,"height":128},{"type":"floor","x":4896,"y":544,"width":64,"height":72},{"type":"event","x":1911,"y":135,"width":136,"height":192,"event":"dialog","data1":"l2_2"},{"type":"event","x":2320,"y":440,"width":120,"height":176,"event":"dialog","data1":"l2_3"},{"type":"event","x":3736,"y":184,"width":64,"height":240,"event":"dialog","data1":"l2_4"},{"type":"event","x":4576,"y":304,"width":232,"height":56,"event":"dialog","data1":"l2_5"},{"type":"event","x":5656,"y":8,"width":64,"height":192,"event":"dialog","data1":"l2_6"},{"type":"floor","x":6768,"y":24,"width":64,"height":120},{"type":"floor","x":6812,"y":80,"width":32,"height":120},{"type":"floor","x":1706,"y":566,"width":64,"height":64},{"type":"floor","x":6456,"y":584,"width":48,"height":64}]}')})),n.register("c7VN9",(function(t,e){t.exports=JSON.parse('{"name":"Le Dragon","music":"music_dragon","entities":[{"type":"floor","x":0,"y":-1000,"width":32,"height":5000,"color":"000000"},{"type":"floor","x":-1000,"y":600,"width":10000,"height":32},{"type":"event","event":"start","x":400,"y":-1000,"width":64,"height":64},{"type":"event","x":384,"y":536,"width":144,"height":88,"event":"shake","data1":"10","data2":"10","data3":"500","data4":"boom"},{"type":"floor","x":784,"y":432,"width":424,"height":40},{"type":"floor","x":664,"y":320,"width":200,"height":40},{"type":"floor","x":760,"y":176,"width":248,"height":152},{"type":"floor","x":872,"y":136,"width":520,"height":48},{"type":"floor","x":1064,"y":-128,"width":64,"height":344},{"type":"floor","x":1200,"y":376,"width":64,"height":96},{"type":"floor","x":1624,"y":344,"width":64,"height":64},{"type":"floor","x":1680,"y":192,"width":64,"height":328},{"type":"floor","x":1744,"y":192,"width":528,"height":64},{"type":"floor","x":3200,"y":528,"width":280,"height":72},{"type":"npc","x":3224,"y":272,"width":256,"height":256,"animation":"dragon_idle","dialogs":[""],"name":"dragon_idle"},{"type":"floor","x":2184,"y":152,"width":1720,"height":64},{"type":"floor","x":4224,"y":120,"width":1072,"height":64},{"type":"floor","x":7320,"y":224,"width":64,"height":176},{"type":"floor","x":7368,"y":304,"width":928,"height":72},{"type":"floor","x":8160,"y":288,"width":64,"height":408},{"type":"floor","x":8232,"y":384,"width":64,"height":64},{"type":"floor","x":8232,"y":456,"width":64,"height":64},{"type":"floor","x":8232,"y":528,"width":64,"height":64},{"type":"floor","x":9048,"y":416,"width":64,"height":64},{"type":"floor","x":9072,"y":320,"width":64,"height":280},{"type":"floor","x":8928,"y":520,"width":64,"height":128},{"type":"floor","x":8880,"y":480,"width":64,"height":232},{"type":"foe","x":3712,"y":56,"width":96,"height":96,"name":"Spawn"},{"type":"foe","x":3888,"y":400,"width":368,"height":144,"name":"DeadlyArea"},{"type":"floor","x":7584,"y":552,"width":224,"height":64},{"type":"npc","x":7632,"y":424,"width":128,"height":128,"animation":"rose","dialogs":[""],"name":"rose"},{"type":"floor","x":8680,"y":544,"width":216,"height":64},{"type":"floor","x":9136,"y":536,"width":408,"height":64},{"type":"floor","x":9120,"y":480,"width":64,"height":64},{"type":"floor","x":7800,"y":336,"width":64,"height":136},{"type":"floor","x":7824,"y":448,"width":64,"height":200},{"type":"floor","x":7944,"y":504,"width":64,"height":24},{"type":"floor","x":7944,"y":440,"width":64,"height":24},{"type":"floor","x":8008,"y":456,"width":16,"height":64},{"type":"floor","x":8024,"y":440,"width":64,"height":24},{"type":"floor","x":8024,"y":504,"width":64,"height":24},{"type":"floor","x":8088,"y":456,"width":16,"height":64},{"type":"floor","x":7928,"y":456,"width":24,"height":64},{"type":"foe","x":7928,"y":504,"width":96,"height":96,"name":"War"},{"type":"npc","x":9192,"y":280,"width":256,"height":256,"animation":"dragon_idle","dialogs":[""],"name":"dragon_idle"},{"type":"npc","x":8864,"y":384,"width":96,"height":96,"animation":"kstore","dialogs":[""],"name":"kstore"},{"type":"npc","x":8808,"y":480,"width":64,"height":64,"animation":"acidpop","dialogs":[""],"name":"acidpop"},{"type":"npc","x":9024,"y":232,"width":64,"height":64,"animation":"fox","dialogs":[""],"name":"fox"},{"type":"floor","x":9144,"y":592,"width":64,"height":136},{"type":"floor","x":9168,"y":696,"width":200,"height":64},{"type":"npc","x":9208,"y":568,"width":128,"height":128,"animation":"shrek","dialogs":[""],"name":"shrek"},{"type":"floor","x":6520,"y":80,"width":400,"height":40},{"type":"floor","x":7104,"y":160,"width":40,"height":64},{"type":"floor","x":5504,"y":448,"width":168,"height":152},{"type":"floor","x":5224,"y":464,"width":72,"height":152},{"type":"foe","x":5536,"y":352,"width":96,"height":96,"name":"Spawn"},{"type":"floor","x":4312,"y":528,"width":64,"height":136},{"type":"floor","x":4440,"y":456,"width":352,"height":48},{"type":"floor","x":4944,"y":344,"width":64,"height":256},{"type":"floor","x":6128,"y":528,"width":224,"height":24},{"type":"floor","x":6872,"y":528,"width":64,"height":72},{"type":"floor","x":6128,"y":496,"width":56,"height":32},{"type":"floor","x":6352,"y":480,"width":48,"height":72},{"type":"floor","x":6752,"y":496,"width":40,"height":40},{"type":"floor","x":6232,"y":120,"width":312,"height":24},{"type":"floor","x":6960,"y":408,"width":64,"height":64},{"type":"floor","x":6912,"y":312,"width":64,"height":288},{"type":"floor","x":6752,"y":312,"width":160,"height":64},{"type":"foe","x":6320,"y":336,"width":32,"height":192,"name":"Block"},{"type":"foe","x":6720,"y":312,"width":32,"height":216,"name":"Block"},{"type":"floor","x":5800,"y":392,"width":216,"height":24},{"type":"floor","x":5656,"y":520,"width":64,"height":88},{"type":"floor","x":6448,"y":560,"width":40,"height":48},{"type":"floor","x":6536,"y":528,"width":256,"height":24},{"type":"floor","x":6536,"y":488,"width":56,"height":40},{"type":"floor","x":6424,"y":328,"width":64,"height":32},{"type":"foe","x":6408,"y":232,"width":96,"height":96,"name":"Mage"},{"type":"foe","x":5840,"y":504,"width":96,"height":96,"name":"War"},{"type":"foe","x":6752,"y":216,"width":96,"height":96,"name":"Mage"},{"type":"floor","x":600,"y":584,"width":176,"height":64},{"type":"floor","x":1464,"y":520,"width":64,"height":112},{"type":"foe","x":896,"y":504,"width":96,"height":96,"name":"War"},{"type":"foe","x":1120,"y":504,"width":96,"height":96,"name":"War"},{"type":"foe","x":2080,"y":480,"width":96,"height":96,"name":"Mage"},{"type":"foe","x":2080,"y":408,"width":96,"height":96,"name":"Mage"},{"type":"foe","x":2080,"y":336,"width":96,"height":96,"name":"Mage"},{"type":"floor","x":1288,"y":560,"width":112,"height":64},{"type":"floor","x":2112,"y":576,"width":64,"height":48},{"type":"floor","x":1400,"y":560,"width":64,"height":64},{"type":"foe","x":648,"y":488,"width":96,"height":96,"name":"Spawn"},{"type":"foe","x":2080,"y":256,"width":96,"height":96,"name":"Mage"},{"type":"floor","x":2176,"y":488,"width":64,"height":120},{"type":"floor","x":2240,"y":456,"width":208,"height":152},{"type":"floor","x":2435,"y":200,"width":64,"height":400},{"type":"floor","x":2488,"y":424,"width":152,"height":176},{"type":"foe","x":2288,"y":328,"width":128,"height":128,"name":"Mirror","data1":"2","data2":"1"},{"type":"foe","x":2512,"y":296,"width":128,"height":128,"name":"Mirror","data1":"1","data2":"2"},{"type":"floor","x":2672,"y":520,"width":64,"height":88},{"type":"floor","x":2616,"y":544,"width":64,"height":64},{"type":"floor","x":2728,"y":544,"width":104,"height":64},{"type":"floor","x":2823,"y":566,"width":392,"height":64},{"type":"floor","x":2704,"y":184,"width":64,"height":64},{"type":"floor","x":2752,"y":208,"width":336,"height":64},{"type":"floor","x":3064,"y":184,"width":64,"height":64},{"type":"floor","x":3464,"y":544,"width":64,"height":64},{"type":"floor","x":3504,"y":560,"width":64,"height":64},{"type":"floor","x":2880,"y":472,"width":48,"height":112},{"type":"floor","x":2968,"y":240,"width":32,"height":96},{"type":"floor","x":3560,"y":472,"width":32,"height":136},{"type":"floor","x":3592,"y":544,"width":72,"height":64},{"type":"floor","x":3664,"y":544,"width":64,"height":64},{"type":"foe","x":3616,"y":448,"width":96,"height":96,"name":"Spawn"},{"type":"floor","x":3864,"y":328,"width":32,"height":136},{"type":"floor","x":4232,"y":312,"width":40,"height":128},{"type":"floor","x":3976,"y":360,"width":32,"height":64},{"type":"floor","x":4120,"y":352,"width":32,"height":64},{"type":"floor","x":4592,"y":88,"width":104,"height":64},{"type":"floor","x":5032,"y":80,"width":120,"height":64},{"type":"foe","x":4720,"y":24,"width":96,"height":96,"name":"War"},{"type":"foe","x":4480,"y":24,"width":96,"height":96,"name":"Spawner"},{"type":"foe","x":5184,"y":24,"width":96,"height":96,"name":"Spawner"},{"type":"floor","x":5400,"y":80,"width":520,"height":64},{"type":"floor","x":5864,"y":104,"width":120,"height":64},{"type":"foe","x":6368,"y":24,"width":96,"height":96,"name":"Spawn"},{"type":"foe","x":6976,"y":480,"width":136,"height":120,"name":"DeadlyArea"},{"type":"foe","x":5296,"y":472,"width":216,"height":128,"name":"DeadlyArea"},{"type":"floor","x":4904,"y":512,"width":64,"height":88},{"type":"floor","x":4840,"y":336,"width":192,"height":32},{"type":"floor","x":4616,"y":184,"width":40,"height":296},{"type":"floor","x":4624,"y":352,"width":64,"height":64},{"type":"foe","x":4600,"y":504,"width":96,"height":96,"name":"War"},{"type":"foe","x":4840,"y":240,"width":96,"height":96,"name":"Mage"},{"type":"foe","x":4936,"y":240,"width":96,"height":96,"name":"Mage"},{"type":"foe","x":5008,"y":512,"width":216,"height":88,"name":"DeadlyArea"},{"type":"foe","x":4456,"y":328,"width":128,"height":128,"name":"Mirror","data2":"1"},{"type":"foe","x":1888,"y":504,"width":96,"height":96,"name":"War"},{"type":"floor","x":2816,"y":240,"width":24,"height":64},{"type":"floor","x":3016,"y":232,"width":24,"height":64},{"type":"floor","x":8304,"y":384,"width":64,"height":64},{"type":"floor","x":8376,"y":384,"width":64,"height":64},{"type":"floor","x":8304,"y":528,"width":64,"height":64},{"type":"floor","x":8376,"y":528,"width":64,"height":64},{"type":"floor","x":8376,"y":456,"width":64,"height":64},{"type":"floor","x":8448,"y":384,"width":64,"height":64},{"type":"floor","x":8520,"y":384,"width":64,"height":64},{"type":"floor","x":8520,"y":456,"width":64,"height":64},{"type":"floor","x":8520,"y":528,"width":64,"height":64},{"type":"floor","x":8448,"y":528,"width":64,"height":64},{"type":"floor","x":8504,"y":280,"width":40,"height":120},{"type":"floor","x":8488,"y":352,"width":64,"height":64},{"type":"floor","x":7360,"y":256,"width":64,"height":64},{"type":"foe","x":7952,"y":208,"width":96,"height":96,"name":"Mage"},{"type":"floor","x":9128,"y":16,"width":32,"height":464},{"type":"floor","x":1784,"y":160,"width":128,"height":64},{"type":"foe","x":1920,"y":96,"width":96,"height":96,"name":"War"},{"type":"foe","x":2480,"y":88,"width":256,"height":64,"name":"DeadlyArea"},{"type":"floor","x":2392,"y":120,"width":88,"height":64},{"type":"floor","x":2736,"y":72,"width":96,"height":80},{"type":"floor","x":2416,"y":80,"width":64,"height":64},{"type":"floor","x":3384,"y":72,"width":64,"height":96},{"type":"floor","x":3352,"y":16,"width":64,"height":152},{"type":"floor","x":5632,"y":-80,"width":64,"height":256},{"type":"foe","x":5520,"y":-16,"width":96,"height":96,"name":"Mage"},{"type":"floor","x":32,"y":136,"width":112,"height":24},{"type":"floor","x":56,"y":472,"width":40,"height":288},{"type":"floor","x":0,"y":504,"width":80,"height":40},{"type":"floor","x":80,"y":16,"width":40,"height":160},{"type":"floor","x":5912,"y":168,"width":32,"height":224},{"type":"floor","x":7112,"y":480,"width":64,"height":120},{"type":"floor","x":7216,"y":552,"width":64,"height":64},{"type":"floor","x":4984,"y":432,"width":88,"height":56},{"type":"floor","x":6000,"y":552,"width":64,"height":64},{"type":"floor","x":5976,"y":416,"width":64,"height":24},{"type":"event","x":616,"y":360,"width":64,"height":224,"event":"dialog","data1":"l3_1"},{"type":"event","x":7488,"y":-216,"width":144,"height":536,"event":"dialog","data1":"l3_3"},{"type":"event","x":2560,"y":192,"width":120,"height":296,"event":"dialog","data1":"l3_2"}]}')})),n.register("bcWEF",(function(t,e){t.exports=JSON.parse('{"name":"Cadeau","music":"music_1","entities":[{"type":"floor","x":0,"y":-1000,"width":32,"height":5000,"color":"000000"},{"type":"floor","x":-1000,"y":600,"width":5000,"height":32},{"type":"event","event":"start","x":400,"y":-1000,"width":64,"height":64},{"type":"event","x":384,"y":536,"width":144,"height":88,"event":"shake","data1":"10","data2":"10","data3":"500","data4":"boom"},{"type":"event","x":1632,"y":-344,"width":136,"height":584,"event":"unlock_speed"},{"type":"floor","x":3888,"y":496,"width":128,"height":176},{"type":"floor","x":3920,"y":416,"width":64,"height":280},{"type":"floor","x":3384,"y":392,"width":120,"height":208},{"type":"floor","x":3344,"y":440,"width":248,"height":216},{"type":"floor","x":2692,"y":456,"width":24,"height":152},{"type":"floor","x":4184,"y":344,"width":40,"height":376},{"type":"floor","x":4144,"y":264,"width":64,"height":272},{"type":"floor","x":4096,"y":288,"width":216,"height":64},{"type":"floor","x":4272,"y":256,"width":64,"height":128},{"type":"floor","x":4192,"y":496,"width":64,"height":64},{"type":"floor","x":2496,"y":414,"width":200,"height":192},{"type":"floor","x":1552,"y":520,"width":232,"height":64},{"type":"floor","x":1760,"y":464,"width":64,"height":144},{"type":"floor","x":1592,"y":440,"width":64,"height":176},{"type":"floor","x":1648,"y":480,"width":64,"height":64},{"type":"floor","x":2440,"y":472,"width":64,"height":128},{"type":"foe","x":2712,"y":504,"width":632,"height":96,"name":"DeadlyArea"},{"type":"floor","x":656,"y":536,"width":176,"height":64},{"type":"floor","x":1736,"y":192,"width":248,"height":64},{"type":"floor","x":1968,"y":208,"width":144,"height":64},{"type":"floor","x":2192,"y":440,"width":160,"height":16,"move":{"y":-300,"x":0,"speed":0}},{"type":"npc","x":504,"y":472,"width":128,"height":128,"animation":"shrek","dialogs":[""],"name":"shrek"},{"type":"npc","x":1472,"y":96,"width":128,"height":128,"animation":"shrek","dialogs":[""],"name":"shrek"},{"type":"floor","x":1440,"y":224,"width":376,"height":32},{"type":"floor","x":1536,"y":552,"width":64,"height":64},{"type":"npc","x":3920,"y":352,"width":64,"height":64,"animation":"acidpop","dialogs":[""],"name":"acidpop"},{"type":"npc","x":3824,"y":400,"width":96,"height":96,"animation":"kstore","dialogs":[""],"name":"kstore"},{"type":"npc","x":4112,"y":136,"width":128,"height":128,"animation":"shrek","dialogs":[""],"name":"shrek"},{"type":"npc","x":4256,"y":384,"width":256,"height":256,"animation":"dragon_idle","dialogs":[""],"name":"dragon_idle"},{"type":"floor","x":4224,"y":640,"width":296,"height":64},{"type":"floor","x":3776,"y":496,"width":136,"height":112},{"type":"floor","x":3728,"y":552,"width":64,"height":64},{"type":"floor","x":3400,"y":296,"width":48,"height":112},{"type":"floor","x":1808,"y":552,"width":64,"height":64},{"type":"floor","x":1132,"y":112,"width":40,"height":496},{"type":"floor","x":792,"y":152,"width":40,"height":448},{"type":"floor","x":896,"y":400,"width":240,"height":40},{"type":"floor","x":816,"y":200,"width":512,"height":48},{"type":"floor","x":1392,"y":-120,"width":64,"height":664},{"type":"floor","x":1160,"y":384,"width":320,"height":64},{"type":"foe","x":968,"y":272,"width":128,"height":128,"name":"Mirror","data1":"4"},{"type":"foe","x":1184,"y":256,"width":128,"height":128,"name":"Mirror","data2":"456","data1":"8"},{"type":"foe","x":1176,"y":72,"width":128,"height":128,"name":"Mirror","data2":"2"},{"type":"foe","x":952,"y":72,"width":128,"height":128,"name":"Mirror","data2":"1"},{"type":"foe","x":960,"y":472,"width":128,"height":128,"name":"Mirror","data1":"56","data2":"45"},{"type":"foe","x":1192,"y":472,"width":128,"height":128,"name":"Mirror","data1":"1"},{"type":"foe","x":656,"y":408,"width":128,"height":128,"name":"Mirror","data1":"2","data2":"4"},{"type":"floor","x":1360,"y":344,"width":64,"height":64},{"type":"floor","x":776,"y":624,"width":64,"height":272},{"type":"floor","x":712,"y":888,"width":976,"height":64},{"type":"floor","x":1494,"y":624,"width":64,"height":288},{"type":"foe","x":888,"y":760,"width":128,"height":128,"name":"Mirror","data2":"8"},{"type":"foe","x":1104,"y":760,"width":128,"height":128,"name":"Mirror","data2":"56"},{"type":"foe","x":1296,"y":760,"width":128,"height":128,"name":"Mirror","data1":"45"},{"type":"foe","x":1904,"y":504,"width":96,"height":96,"name":"War"},{"type":"foe","x":2544,"y":320,"width":96,"height":96,"name":"Spawn"},{"type":"floor","x":648,"y":200,"width":168,"height":64},{"type":"npc","x":656,"y":72,"width":128,"height":128,"animation":"rose","dialogs":[""],"name":"rose"},{"type":"floor","x":3541,"y":507,"width":64,"height":104},{"type":"npc","x":3992,"y":248,"width":64,"height":64,"animation":"fox","dialogs":[""],"name":"fox"},{"type":"event","x":424,"y":296,"width":232,"height":408,"event":"dialog","data1":"l4_1"},{"type":"npc","x":560,"y":376,"width":64,"height":64,"animation":"fox","dialogs":[""],"name":"fox"},{"type":"event","x":1920,"y":240,"width":64,"height":408,"event":"dialog","data1":"l4_2"},{"type":"event","x":1696,"y":-232,"width":64,"height":512,"event":"dialog","data1":"l4_3"},{"type":"event","x":3384,"y":-8,"width":120,"height":328,"event":"dialog","data1":"l4_4"}]}')})),n.register("3B8ub",(function(t,e){t.exports=JSON.parse('{"name":"Army","music":"music_soldier","entities":[{"type":"floor","x":0,"y":-1000,"width":32,"height":5000,"color":"000000"},{"type":"floor","x":-1000,"y":600,"width":1984,"height":56},{"type":"event","event":"start","x":400,"y":-800,"width":64,"height":64},{"type":"event","x":384,"y":528,"width":144,"height":88,"event":"shake","data1":"10","data2":"10","data3":"500","data4":"boom"},{"type":"floor","x":696,"y":544,"width":232,"height":168},{"type":"floor","x":592,"y":576,"width":176,"height":64},{"type":"floor","x":136,"y":560,"width":128,"height":104},{"type":"floor","x":96,"y":584,"width":64,"height":64},{"type":"floor","x":736,"y":656,"width":160,"height":600},{"type":"floor","x":816,"y":1136,"width":64,"height":832},{"type":"floor","x":800,"y":1792,"width":8856,"height":64},{"type":"floor","x":9584,"y":616,"width":184,"height":176},{"type":"floor","x":9656,"y":640,"width":64,"height":1232},{"type":"foe","x":880,"y":1688,"width":8776,"height":104,"name":"DeadlyArea"},{"type":"floor","x":608,"y":640,"width":24,"height":96},{"type":"floor","x":328,"y":632,"width":24,"height":64},{"type":"floor","x":936,"y":560,"width":64,"height":136},{"type":"floor","x":1016,"y":416,"width":168,"height":56,"move":{"y":1000,"x":0,"speed":300,"hero":false}},{"type":"floor","x":694,"y":1243,"width":256,"height":64},{"type":"foe","x":776,"y":448,"width":96,"height":96,"name":"Spawn"},{"type":"floor","x":1360,"y":1144,"width":312,"height":24},{"type":"floor","x":1520,"y":1176,"width":24,"height":200},{"type":"floor","x":1680,"y":1008,"width":40,"height":216},{"type":"floor","x":1552,"y":1176,"width":64,"height":64},{"type":"floor","x":1480,"y":1176,"width":32,"height":32},{"type":"floor","x":1376,"y":976,"width":200,"height":32},{"type":"foe","x":1360,"y":880,"width":96,"height":96,"name":"Mage"},{"type":"foe","x":1360,"y":1048,"width":96,"height":96,"name":"Mage"},{"type":"floor","x":1488,"y":816,"width":32,"height":328},{"type":"floor","x":1360,"y":792,"width":160,"height":24},{"type":"floor","x":1040,"y":1456,"width":232,"height":32,"move":{"y":0,"x":800,"speed":300}},{"type":"foe","x":1368,"y":696,"width":96,"height":96,"name":"Mage"},{"type":"foe","x":1600,"y":1304,"width":128,"height":128,"name":"Mirror","data1":"1","data2":"2"},{"type":"foe","x":1736,"y":1304,"width":128,"height":128,"name":"Mirror","data3":"56","data1":"3","data2":"4"},{"type":"foe","x":1872,"y":1304,"width":128,"height":128,"name":"Mirror","data1":"2","data2":"1"},{"type":"foe","x":1872,"y":200,"width":128,"height":128,"name":"Mirror","data1":"4"},{"type":"floor","x":1840,"y":328,"width":344,"height":16},{"type":"floor","x":1832,"y":256,"width":24,"height":224},{"type":"floor","x":1976,"y":352,"width":208,"height":64},{"type":"floor","x":2376,"y":320,"width":16,"height":64},{"type":"foe","x":2072,"y":232,"width":96,"height":96,"name":"Spawn"},{"type":"floor","x":1800,"y":832,"width":1184,"height":24},{"type":"floor","x":1792,"y":712,"width":64,"height":216},{"type":"floor","x":2960,"y":696,"width":64,"height":240},{"type":"foe","x":1896,"y":736,"width":96,"height":96,"name":"War"},{"type":"foe","x":2000,"y":736,"width":96,"height":96,"name":"War"},{"type":"foe","x":2120,"y":736,"width":96,"height":96,"name":"War"},{"type":"foe","x":2256,"y":736,"width":96,"height":96,"name":"War"},{"type":"foe","x":2376,"y":736,"width":96,"height":96,"name":"War"},{"type":"foe","x":2496,"y":736,"width":96,"height":96,"name":"War"},{"type":"foe","x":2616,"y":736,"width":96,"height":96,"name":"War"},{"type":"foe","x":2744,"y":736,"width":96,"height":96,"name":"War"},{"type":"foe","x":2848,"y":736,"width":96,"height":96,"name":"War"},{"type":"floor","x":1800,"y":352,"width":16,"height":368},{"type":"floor","x":1816,"y":912,"width":24,"height":360},{"type":"floor","x":1784,"y":1120,"width":32,"height":160},{"type":"floor","x":1760,"y":1624,"width":72,"height":40},{"type":"floor","x":1456,"y":1304,"width":64,"height":80},{"type":"foe","x":1432,"y":1208,"width":96,"height":96,"name":"Mage"},{"type":"floor","x":1368,"y":616,"width":152,"height":40},{"type":"foe","x":1392,"y":520,"width":96,"height":96,"name":"Mage"},{"type":"floor","x":3080,"y":96,"width":64,"height":880},{"type":"floor","x":2376,"y":288,"width":64,"height":24},{"type":"floor","x":3088,"y":1240,"width":64,"height":64},{"type":"floor","x":2296,"y":1160,"width":256,"height":40,"move":{"y":0,"x":1000,"speed":200}},{"type":"floor","x":1984,"y":984,"width":1160,"height":40},{"type":"floor","x":1840,"y":1248,"width":848,"height":24},{"type":"floor","x":1984,"y":952,"width":64,"height":24},{"type":"floor","x":2368,"y":944,"width":64,"height":32},{"type":"foe","x":2056,"y":888,"width":96,"height":96,"name":"War"},{"type":"foe","x":2208,"y":888,"width":96,"height":96,"name":"War"},{"type":"foe","x":2632,"y":888,"width":96,"height":96,"name":"War"},{"type":"floor","x":3104,"y":1296,"width":32,"height":288},{"type":"floor","x":3064,"y":1584,"width":112,"height":16},{"type":"floor","x":3392,"y":1248,"width":320,"height":64},{"type":"floor","x":3720,"y":1248,"width":64,"height":64,"move":{"y":-1000,"x":0,"speed":0}},{"type":"floor","x":3320,"y":1248,"width":64,"height":64,"move":{"y":-1000,"x":0,"speed":0}},{"type":"foe","x":1992,"y":1152,"width":96,"height":96,"name":"Mage"},{"type":"foe","x":1992,"y":1080,"width":96,"height":96,"name":"Mage"},{"type":"foe","x":1992,"y":1024,"width":96,"height":96,"name":"Mage"},{"type":"floor","x":3376,"y":296,"width":304,"height":32,"move":{"y":0,"x":0,"speed":0}},{"type":"foe","x":3384,"y":168,"width":128,"height":128,"name":"Mirror","data2":"8"},{"type":"foe","x":3544,"y":168,"width":128,"height":128,"name":"Mirror","data2":"9"},{"type":"floor","x":3984,"y":-88,"width":24,"height":1704},{"type":"floor","x":3865,"y":496,"width":256,"height":24},{"type":"floor","x":3840,"y":448,"width":312,"height":40},{"type":"floor","x":3896,"y":208,"width":192,"height":64},{"type":"floor","x":3520,"y":960,"width":64,"height":64},{"type":"floor","x":3520,"y":832,"width":64,"height":64},{"type":"floor","x":3520,"y":704,"width":64,"height":64},{"type":"floor","x":3192,"y":896,"width":64,"height":64},{"type":"floor","x":3848,"y":904,"width":64,"height":64},{"type":"floor","x":3848,"y":760,"width":64,"height":64},{"type":"floor","x":3192,"y":760,"width":64,"height":64},{"type":"floor","x":3192,"y":624,"width":64,"height":64},{"type":"floor","x":3848,"y":600,"width":64,"height":64},{"type":"floor","x":3192,"y":480,"width":64,"height":64},{"type":"floor","x":3520,"y":568,"width":64,"height":64},{"type":"foe","x":3832,"y":664,"width":96,"height":96,"name":"Mage"},{"type":"foe","x":3832,"y":808,"width":96,"height":96,"name":"Mage"},{"type":"foe","x":3176,"y":800,"width":96,"height":96,"name":"Mage","data1":"","data2":"zda"},{"type":"foe","x":3176,"y":664,"width":96,"height":96,"name":"Mage","data1":"","data2":"azdazd"},{"type":"foe","x":3176,"y":528,"width":96,"height":96,"name":"Mage","data1":"","data2":"azdadzad"},{"type":"foe","x":3176,"y":392,"width":96,"height":96,"name":"Mage","data2":"azdadzad"},{"type":"foe","x":3504,"y":1152,"width":96,"height":96,"name":"Spawn"},{"type":"foe","x":3840,"y":352,"width":96,"height":96,"name":"Mage"},{"type":"floor","x":9192,"y":725,"width":424,"height":32},{"type":"floor","x":9272,"y":744,"width":408,"height":176},{"type":"floor","x":9360,"y":912,"width":328,"height":64},{"type":"floor","x":9448,"y":680,"width":160,"height":64},{"type":"floor","x":4504,"y":688,"width":264,"height":32},{"type":"foe","x":4320,"y":224,"width":128,"height":128,"name":"Mirror","data1":"8"},{"type":"foe","x":4488,"y":224,"width":128,"height":128,"name":"Mirror","data1":"9"},{"type":"floor","x":4864,"y":336,"width":24,"height":456},{"type":"floor","x":4512,"y":880,"width":376,"height":64},{"type":"floor","x":4896,"y":880,"width":64,"height":64},{"type":"floor","x":4960,"y":952,"width":64,"height":64},{"type":"floor","x":4440,"y":952,"width":64,"height":64},{"type":"floor","x":4888,"y":1024,"width":64,"height":64},{"type":"floor","x":4512,"y":1024,"width":64,"height":64},{"type":"floor","x":5032,"y":1024,"width":64,"height":64},{"type":"floor","x":4296,"y":952,"width":64,"height":64},{"type":"floor","x":5032,"y":888,"width":64,"height":64},{"type":"floor","x":4224,"y":1024,"width":64,"height":64},{"type":"floor","x":4824,"y":952,"width":64,"height":64},{"type":"floor","x":4296,"y":1096,"width":64,"height":64},{"type":"floor","x":4368,"y":1024,"width":64,"height":64},{"type":"floor","x":4440,"y":1096,"width":64,"height":64},{"type":"floor","x":5104,"y":952,"width":64,"height":64},{"type":"npc","x":2480,"y":32,"width":128,"height":128,"animation":"inf1","dialogs":[""],"name":"inf1"},{"type":"npc","x":488,"y":864,"width":128,"height":128,"animation":"inf1","dialogs":[""],"name":"inf1"},{"type":"npc","x":968,"y":1888,"width":128,"height":128,"animation":"inf1","dialogs":[""],"name":"inf1"},{"type":"npc","x":2536,"y":1528,"width":128,"height":128,"animation":"inf1","dialogs":[""],"name":"inf1"},{"type":"npc","x":4112,"y":832,"width":128,"height":128,"animation":"inf1","dialogs":[""],"name":"inf1"},{"type":"npc","x":5552,"y":472,"width":128,"height":128,"animation":"inf2","dialogs":[""],"name":"inf2"},{"type":"floor","x":5304,"y":976,"width":240,"height":40,"move":{"y":0,"x":800,"speed":0}},{"type":"event","x":4840,"y":792,"width":64,"height":96,"event":"camera_back"},{"type":"foe","x":4656,"y":784,"width":96,"height":96,"name":"Spawn"},{"type":"foe","x":4152,"y":655,"width":344,"height":96,"name":"DeadlyArea"},{"type":"floor","x":6056,"y":1408,"width":1600,"height":32},{"type":"floor","x":6280,"y":992,"width":64,"height":304},{"type":"event","x":6280,"y":1296,"width":64,"height":112,"event":"camera_zoom"},{"type":"floor","x":6256,"y":1096,"width":232,"height":40},{"type":"floor","x":6412,"y":600,"width":24,"height":552},{"type":"floor","x":7800,"y":720,"width":48,"height":760},{"type":"floor","x":6736,"y":960,"width":232,"height":112},{"type":"floor","x":6688,"y":848,"width":64,"height":104},{"type":"foe","x":6936,"y":1088,"width":240,"height":96,"name":"DeadlyArea"},{"type":"floor","x":6520,"y":1328,"width":64,"height":160},{"type":"floor","x":7176,"y":1160,"width":120,"height":56},{"type":"foe","x":6656,"y":1080,"width":80,"height":184,"name":"Block"},{"type":"floor","x":7528,"y":1032,"width":296,"height":64},{"type":"floor","x":6848,"y":648,"width":208,"height":64},{"type":"floor","x":6872,"y":616,"width":24,"height":24},{"type":"foe","x":6952,"y":464,"width":104,"height":184,"name":"Block"},{"type":"foe","x":6776,"y":864,"width":96,"height":96,"name":"Spawner"},{"type":"floor","x":7728,"y":848,"width":96,"height":64},{"type":"floor","x":7840,"y":752,"width":368,"height":64},{"type":"floor","x":6776,"y":680,"width":64,"height":32},{"type":"floor","x":6640,"y":984,"width":88,"height":64},{"type":"floor","x":7032,"y":1104,"width":32,"height":64},{"type":"floor","x":6640,"y":1264,"width":920,"height":24},{"type":"floor","x":7424,"y":280,"width":24,"height":808},{"type":"floor","x":7904,"y":848,"width":64,"height":64},{"type":"floor","x":6632,"y":1240,"width":16,"height":16},{"type":"foe","x":7872,"y":656,"width":96,"height":96,"name":"Spawn"},{"type":"floor","x":8088,"y":816,"width":1240,"height":64},{"type":"foe","x":8240,"y":720,"width":96,"height":96,"name":"War"},{"type":"foe","x":8424,"y":720,"width":96,"height":96,"name":"War"},{"type":"foe","x":8656,"y":720,"width":96,"height":96,"name":"War"},{"type":"foe","x":8824,"y":720,"width":96,"height":96,"name":"War"},{"type":"foe","x":9016,"y":720,"width":96,"height":96,"name":"War"},{"type":"floor","x":8024,"y":552,"width":48,"height":240},{"type":"foe","x":9208,"y":632,"width":96,"height":96,"name":"Mage"},{"type":"foe","x":9448,"y":584,"width":96,"height":96,"name":"Mage"},{"type":"foe","x":9592,"y":520,"width":96,"height":96,"name":"Mage"},{"type":"floor","x":9880,"y":120,"width":64,"height":1176},{"type":"event","x":528,"y":224,"width":272,"height":392,"event":"dialog","data1":"l5_1"},{"type":"event","x":7920,"y":248,"width":312,"height":360,"event":"dialog","data1":"l5_2"},{"type":"event","x":4832,"y":736,"width":128,"height":192,"event":"dialog","data1":"l5_4"},{"type":"event","x":2056,"y":72,"width":432,"height":400,"event":"dialog","data1":"l5_3"}]}')})),n.register("g8Fgw",(function(t,e){t.exports=JSON.parse('{"name":"Escamort","music":"music_boss","entities":[{"type":"floor","x":0,"y":-1000,"width":32,"height":5000,"color":"000000"},{"type":"floor","x":-1000,"y":600,"width":7768,"height":32},{"type":"event","event":"start","x":400,"y":-1000,"width":64,"height":64},{"type":"event","x":384,"y":536,"width":144,"height":88,"event":"shake","data1":"10","data2":"10","data3":"500","data4":"boom"},{"type":"floor","x":792,"y":480,"width":712,"height":32},{"type":"foe","x":1216,"y":504,"width":96,"height":96,"name":"Mage","data2":"","data1":"2000"},{"type":"floor","x":792,"y":-304,"width":64,"height":776},{"type":"floor","x":680,"y":440,"width":64,"height":160},{"type":"foe","x":576,"y":352,"width":96,"height":96,"name":"Spawn"},{"type":"foe","x":2600,"y":504,"width":96,"height":96,"name":"Mage","data2":"","data1":"1500"},{"type":"floor","x":1696,"y":384,"width":64,"height":224},{"type":"floor","x":1632,"y":536,"width":64,"height":64},{"type":"floor","x":1744,"y":448,"width":128,"height":160},{"type":"floor","x":2000,"y":432,"width":704,"height":40},{"type":"floor","x":1984,"y":376,"width":64,"height":128},{"type":"floor","x":2000,"y":216,"width":32,"height":184},{"type":"floor","x":2912,"y":440,"width":64,"height":64},{"type":"floor","x":2840,"y":440,"width":64,"height":64},{"type":"floor","x":2984,"y":440,"width":64,"height":64},{"type":"floor","x":2712,"y":440,"width":120,"height":64},{"type":"floor","x":3056,"y":440,"width":64,"height":64},{"type":"floor","x":3272,"y":320,"width":64,"height":280},{"type":"floor","x":3216,"y":544,"width":64,"height":64},{"type":"floor","x":3576,"y":280,"width":64,"height":192},{"type":"floor","x":3496,"y":432,"width":880,"height":32},{"type":"foe","x":4296,"y":464,"width":96,"height":96,"name":"Mage","data2":"","data1":"1200"},{"type":"floor","x":4520,"y":392,"width":64,"height":208},{"type":"floor","x":4480,"y":536,"width":64,"height":64},{"type":"floor","x":4568,"y":416,"width":424,"height":64},{"type":"floor","x":4560,"y":472,"width":536,"height":64},{"type":"floor","x":4560,"y":520,"width":608,"height":96},{"type":"floor","x":5515,"y":583,"width":240,"height":200},{"type":"floor","x":5160,"y":624,"width":64,"height":64},{"type":"floor","x":5552,"y":536,"width":64,"height":64},{"type":"floor","x":6592,"y":568,"width":64,"height":64},{"type":"floor","x":6144,"y":584,"width":456,"height":64},{"type":"floor","x":6891,"y":304,"width":64,"height":480},{"type":"floor","x":7008,"y":-64,"width":64,"height":352},{"type":"floor","x":6872,"y":264,"width":160,"height":136},{"type":"floor","x":1232,"y":320,"width":504,"height":64},{"type":"floor","x":1160,"y":240,"width":64,"height":168},{"type":"floor","x":1088,"y":360,"width":64,"height":64},{"type":"floor","x":840,"y":320,"width":96,"height":64},{"type":"floor","x":1080,"y":208,"width":64,"height":40},{"type":"floor","x":1160,"y":160,"width":64,"height":64},{"type":"floor","x":1232,"y":200,"width":64,"height":64},{"type":"floor","x":1344,"y":-560,"width":16,"height":808},{"type":"floor","x":1888,"y":-104,"width":120,"height":336},{"type":"foe","x":1408,"y":224,"width":96,"height":96,"name":"War"},{"type":"foe","x":1520,"y":224,"width":96,"height":96,"name":"War"},{"type":"foe","x":1632,"y":224,"width":96,"height":96,"name":"War"},{"type":"foe","x":2360,"y":336,"width":96,"height":96,"name":"War"},{"type":"floor","x":2864,"y":248,"width":472,"height":64},{"type":"floor","x":2568,"y":72,"width":32,"height":312},{"type":"floor","x":2608,"y":248,"width":248,"height":64},{"type":"floor","x":2304,"y":216,"width":256,"height":64},{"type":"floor","x":2272,"y":176,"width":24,"height":184},{"type":"floor","x":2032,"y":368,"width":64,"height":64},{"type":"floor","x":2008,"y":256,"width":64,"height":64},{"type":"npc","x":2736,"y":376,"width":64,"height":64,"animation":"acidpop","dialogs":[""],"name":"acidpop"},{"type":"npc","x":1152,"y":64,"width":96,"height":96,"animation":"kstore","dialogs":[""],"name":"kstore"},{"type":"foe","x":1776,"y":352,"width":96,"height":96,"name":"Spawn"},{"type":"npc","x":2304,"y":-40,"width":256,"height":256,"animation":"dragon_idle","dialogs":[""],"name":"dragon_idle"},{"type":"floor","x":1728,"y":256,"width":32,"height":128},{"type":"floor","x":3624,"y":16,"width":64,"height":456},{"type":"foe","x":3216,"y":152,"width":96,"height":96,"name":"Spawn"},{"type":"floor","x":3344,"y":288,"width":104,"height":72},{"type":"floor","x":4264,"y":560,"width":120,"height":48},{"type":"floor","x":3656,"y":568,"width":64,"height":64},{"type":"floor","x":3808,"y":432,"width":64,"height":64},{"type":"floor","x":4000,"y":568,"width":64,"height":64},{"type":"floor","x":3400,"y":568,"width":64,"height":64},{"type":"floor","x":4496,"y":344,"width":64,"height":64},{"type":"floor","x":4896,"y":288,"width":104,"height":64},{"type":"floor","x":4528,"y":136,"width":344,"height":64},{"type":"foe","x":5912,"y":192,"width":96,"height":96,"name":"Mage","data2":"","data1":"1800"},{"type":"floor","x":4328,"y":272,"width":200,"height":64},{"type":"floor","x":4464,"y":120,"width":64,"height":64},{"type":"floor","x":4288,"y":248,"width":64,"height":64},{"type":"floor","x":4048,"y":288,"width":288,"height":64},{"type":"floor","x":3784,"y":281,"width":304,"height":64},{"type":"npc","x":3792,"y":152,"width":128,"height":128,"animation":"shrek","dialogs":[""],"name":"shrek"},{"type":"npc","x":4240,"y":112,"width":64,"height":64,"animation":"fox","dialogs":[""],"name":"fox"},{"type":"floor","x":4352,"y":160,"width":40,"height":136},{"type":"floor","x":4728,"y":-288,"width":24,"height":496},{"type":"floor","x":4736,"y":352,"width":40,"height":64},{"type":"floor","x":5368,"y":8,"width":64,"height":208},{"type":"floor","x":5384,"y":466,"width":704,"height":64},{"type":"floor","x":4984,"y":136,"width":184,"height":64},{"type":"floor","x":5384,"y":288,"width":632,"height":64},{"type":"floor","x":5352,"y":352,"width":112,"height":64},{"type":"floor","x":5224,"y":136,"width":160,"height":64},{"type":"floor","x":5496,"y":152,"width":64,"height":64},{"type":"floor","x":5424,"y":88,"width":240,"height":64},{"type":"floor","x":5624,"y":128,"width":400,"height":64},{"type":"floor","x":5776,"y":144,"width":64,"height":64},{"type":"floor","x":5776,"y":264,"width":64,"height":64},{"type":"floor","x":6008,"y":312,"width":64,"height":304},{"type":"floor","x":5840,"y":80,"width":240,"height":64},{"type":"floor","x":6088,"y":336,"width":64,"height":64},{"type":"floor","x":6168,"y":352,"width":64,"height":64},{"type":"floor","x":6248,"y":376,"width":64,"height":64},{"type":"floor","x":6328,"y":400,"width":64,"height":64},{"type":"floor","x":6408,"y":424,"width":64,"height":64},{"type":"floor","x":6488,"y":448,"width":64,"height":64},{"type":"floor","x":6568,"y":472,"width":64,"height":64},{"type":"floor","x":6648,"y":496,"width":64,"height":64},{"type":"floor","x":6728,"y":520,"width":64,"height":64},{"type":"floor","x":552,"y":448,"width":136,"height":64},{"type":"floor","x":688,"y":272,"width":112,"height":64},{"type":"floor","x":752,"y":232,"width":64,"height":64},{"type":"floor","x":592,"y":456,"width":16,"height":200},{"type":"floor","x":232,"y":384,"width":64,"height":264},{"type":"floor","x":16,"y":400,"width":248,"height":64},{"type":"floor","x":8,"y":72,"width":64,"height":472},{"type":"floor","x":48,"y":288,"width":64,"height":136},{"type":"foe","x":4136,"y":192,"width":96,"height":96,"name":"Spawn"},{"type":"floor","x":2136,"y":576,"width":456,"height":40},{"type":"floor","x":6080,"y":268,"width":712,"height":56},{"type":"floor","x":6744,"y":320,"width":32,"height":200},{"type":"foe","x":2032,"y":504,"width":96,"height":96,"name":"War"},{"type":"foe","x":872,"y":504,"width":96,"height":96,"name":"War"},{"type":"foe","x":984,"y":504,"width":96,"height":96,"name":"War"},{"type":"foe","x":1096,"y":504,"width":96,"height":96,"name":"War"},{"type":"foe","x":3776,"y":504,"width":96,"height":96,"name":"War"},{"type":"foe","x":4120,"y":504,"width":96,"height":96,"name":"War"},{"type":"floor","x":4520,"y":312,"width":184,"height":64},{"type":"floor","x":5072,"y":288,"width":232,"height":64},{"type":"floor","x":4992,"y":320,"width":112,"height":64},{"type":"floor","x":4696,"y":288,"width":112,"height":64},{"type":"floor","x":4792,"y":312,"width":128,"height":64},{"type":"floor","x":4720,"y":152,"width":64,"height":64},{"type":"floor","x":6155,"y":145,"width":40,"height":128},{"type":"floor","x":5288,"y":312,"width":128,"height":64},{"type":"floor","x":624,"y":0,"width":1288,"height":24},{"type":"event","x":632,"y":248,"width":64,"height":208,"event":"dialog","data1":"l6_0"},{"type":"event","x":1328,"y":480,"width":64,"height":144,"event":"dialog","data1":"l6_1"},{"type":"event","x":2728,"y":448,"width":64,"height":192,"event":"dialog","data1":"l6_2"},{"type":"event","x":3904,"y":320,"width":64,"height":128,"event":"dialog","data1":"l6_3"},{"type":"event","x":6064,"y":-112,"width":216,"height":408,"event":"dialog","data1":"l6_4"}]}')})),n.register("hUwx1",(function(t,e){t.exports=JSON.parse('{"name":"Rveil","full":true,"entities":[{"type":"floor","x":0,"y":-1000,"width":32,"height":5000,"color":"000000"},{"type":"floor","x":0,"y":3864,"width":1016,"height":32},{"type":"event","event":"start","x":80,"y":3456,"width":64,"height":64},{"type":"floor","x":1016,"y":3864,"width":688,"height":64,"move":{"y":-5000,"x":0,"speed":50,"hero":true}},{"type":"event","x":992,"y":3640,"width":792,"height":64,"event":"play_music","data1":"music_end"},{"type":"event","x":1040,"y":3840,"width":648,"height":48,"event":"shake","data1":"10","data2":"10","data3":"1000","data4":"boom"},{"type":"floor","x":992,"y":-168,"width":24,"height":3928,"color":"#ffffff"},{"type":"floor","x":1704,"y":-112,"width":24,"height":4040,"color":"#ffffff"},{"type":"event","x":992,"y":3544,"width":776,"height":80,"event":"dialog","data1":"end"},{"type":"event","x":856,"y":608,"width":1000,"height":64,"event":"the_end"},{"type":"floor","x":816,"y":3168,"width":176,"height":64},{"type":"npc","x":904,"y":3080,"width":64,"height":64,"animation":"fox","dialogs":[""],"name":"fox"},{"type":"floor","x":760,"y":2408,"width":232,"height":48},{"type":"npc","x":888,"y":2312,"width":96,"height":96,"animation":"kstore","dialogs":[""],"name":"kstore"},{"type":"npc","x":808,"y":2344,"width":64,"height":64,"animation":"acidpop","dialogs":[""],"name":"acidpop"},{"type":"npc","x":1744,"y":2016,"width":128,"height":128,"animation":"shrek","dialogs":[""],"name":"shrek"},{"type":"npc","x":1728,"y":1256,"width":256,"height":256,"animation":"dragon_idle","dialogs":[""],"name":"dragon_idle"},{"type":"floor","x":1712,"y":1512,"width":344,"height":64},{"type":"floor","x":1704,"y":1552,"width":64,"height":64},{"type":"floor","x":1728,"y":2144,"width":216,"height":16},{"type":"floor","x":872,"y":2440,"width":64,"height":104},{"type":"floor","x":920,"y":2504,"width":72,"height":40},{"type":"floor","x":1904,"y":2120,"width":64,"height":64}]}')}));const st=[n("eIxhF"),n("9tt2b"),n("c7VN9"),n("bcWEF"),n("3B8ub"),n("g8Fgw"),n("hUwx1")],nt={levels:st,hero:0,keybinds:{sit:[x.Keys.S,x.Keys.Down,x.Keys.ShiftLeft],left:[x.Keys.A,x.Keys.Q,x.Keys.Left],up:[x.Keys.Up,x.Keys.W,x.Keys.Z],down:[x.Keys.Down,x.Keys.S],right:[x.Keys.D,x.Keys.Right],jump:[x.Keys.Up,x.Keys.Space,x.Keys.Z,x.Keys.W],fire:[x.Keys.E]},hair_color:0,music:.5,sound:.5,currentLevel:0,canFirebolt:!1,canDoubleJump:!1,canSpeed:!1,dragonRose:!1,roses:[0,0,0,0,0,0,0,0],count_dead:[-1,-1,-1,-1,-1,-1,-1],timers:[-1,-1,-1,-1,-1,-1,-1]};if(localStorage.getItem("$config"))try{const t=JSON.parse(localStorage.getItem("$config")||"{}");"4"!==localStorage.getItem("GameState")&&delete t.levels,Object.assign(nt,t),console.log("config::load config loader")}catch(t){console.log("config::load error bad format"),localStorage.removeItem("$config")}const rt=t=>{Object.assign(nt,t),localStorage.setItem("$config",JSON.stringify(nt))};window.config_set=rt;class ot{constructor(t){this.engine=t}isHeld(t){return nt.keybinds[t].some((t=>this.engine.input.keyboard.isHeld(t)))}wasPressed(t){return nt.keybinds[t].some((t=>this.engine.input.keyboard.wasPressed(t)))}}class at extends u{constructor(t,e){super({collider:t,collisionType:f.Passive}),this.side=e,this.on("precollision",(t=>{t.other?.name.includes("floor")&&t.side===this.side&&(this.contact=t.other.name)})),this.on("collisionend",(t=>{t.other?.name===this.contact&&(this.contact="")})),this.contact=""}}const lt=new class{toggleVolume(){this.volume>0?this.setVolume(0):this.setVolume(.5)}setVolume(t){console.log("audio::set_volume",t),this.volume=t,rt({sound:t})}toggleMusicVolume(){this.volumeMusic?this.setMusicVolume(0):this.setMusicVolume(.5)}setMusicVolume(t){console.log("audio::set_music_volume",t),this.volumeMusic=t,rt({music:t}),this.currentMusic&&(this.currentMusic.volume=this.volumeMusic)}playMusic(t,e=!0){if(this.currentMusic){if(this.currentMusic.path===I[t].path)return;this.currentMusic.stop()}this.currentMusic=I[t],this.currentMusic.play(this.volumeMusic),this.currentMusic.volume=this.volumeMusic,this.currentMusic.loop=e}play(t){I[t]&&(I[t].play(this.volume),I[t].volume=this.volume)}random(...t){const e=this,i=t.map((t=>I[t]));return{play(){const t=(s=i.length,Math.floor(Math.random()*s));var s;i[t].play(e.volume),i[t].volume=e.volume}}}stop(){this.currentMusic&&this.currentMusic.stop()}constructor(){this.volume=nt.sound,this.volumeMusic=nt.music}};class ht{constructor(t){this.actor=t,this.vel_default=L(0,0)}update(){this.actor.vel.x+=this.vel_default.x,this.actor.vel.y+=this.vel_default.y,this.vel_default=L(0,0)}}class ct extends u{watch_actors(){this.on("precollision",(t=>{this.watch_list.includes(t.other.name)&&this.actors.push(t.other)}))}move_y(t){for(const e of this.actors)e.floor.vel_default.y+=t}move_x(t){for(const e of this.actors)e.floor.vel_default.x+=t}constructor(...t){super(...t),this.actors=[],this.watch_list=[ut.NAME,"mirror","mage","war"]}}class dt extends ct{constructor(t){super({name:"floor",pos:L(t.x+t.width/2,t.y+t.height/2),collider:P.Box(t.width,t.height),collisionType:t.physic?f.Active:f.Fixed,color:m.fromHex(t.color||"ffffff"),width:t.width,height:t.height}),this.e=t,this.dir=-1,this.pos_initial=L(t.x+t.width/2,t.y+t.height/2)}get pos_with_origin(){return L(this.pos.x+this.e.width/2,this.pos.y+this.e.height/2)}onInitialize(t){super.onInitialize(t),(this.e.move?.x||this.e.move?.y)&&this.watch_actors()}onPreUpdate(t,e){this.e.move&&(this.e.move.y&&(this.e.move.y>0?(this.pos_with_origin.y<=this.pos_initial.y&&(this.dir=1),this.pos_with_origin.y>=this.pos_initial.y+this.e.move.y&&(this.dir=-1)):(this.pos_with_origin.y<=this.pos_initial.y+this.e.move.y&&(this.dir=1),this.pos_with_origin.y>=this.pos_initial.y&&(this.dir=-1)),this.e.move.hero&&!this.actors.length||(this.vel.y=(this.e.move.speed||100)*this.dir),this.vel.y>0&&this.move_y((this.e.move.speed||100)*this.dir)),this.e.move.x&&(this.e.move.x>0?(this.pos_with_origin.x<=this.pos_initial.x&&(this.dir=1),this.pos_with_origin.x>=this.pos_initial.x+this.e.move.x&&(this.dir=-1)):(this.pos_with_origin.x<=this.pos_initial.x+this.e.move.x&&(this.dir=1),this.pos_with_origin.x>=this.pos_initial.x&&(this.dir=-1)),this.vel.x=(this.e.move.speed||100)*this.dir,this.move_x((this.e.move.speed||100)*this.dir)),this.actors=[])}}class ut extends u{constructor(t,e=48,i=56){super({width:i,height:e,color:m.Cyan,name:ut.NAME,pos:t,collider:P.Box(i-16,2*e-32,D.Half,L(0,16)),collisionType:f.Active}),this._height=e,this._width=i,this.direction=tt.RIGHT,this.doubleJump=!1,this.sit=!1,this.cooldownFire=!1,this.animSitLock=!1,this.wasOnGround=!1,this.audio_jump=lt.random("jump_0","jump_1","jump_2"),this.vel_default=L(0,0),this.floor=new ht(this),this.smash=null,this.onFloor=!1,this.spawn=t,this.hitboxHead=new at(P.Box(i-16-4,2*e-32-32,D.Half,L(0,-4)),A.Bottom),this.addChild(this.hitboxHead),this.updateBoxCollider()}get onGround(){return 0===this.vel.y&&this.onFloor}onInitialize(t){const e=[0,1,2,3,4,5,6,7],i=new D(2,2);this.animAttack=p.fromSpriteSheet(j,[0,1,2,3,4,5,6,7,8,9,10],40),this.animAttack.scale=i,this.animAttackDown=p.fromSpriteSheet(V,[0,1,2,3,4,5,6],70),this.animAttackDown.scale=i,this.animAttackJump=p.fromSpriteSheet(q,[0,1,2,3,4],80),this.animAttackJump.scale=i,this.animJumpDown=p.fromSpriteSheet(Z,[5,6,7],500),this.animJumpDown.scale=i,this.animJumpTop=p.fromSpriteSheet(Z,[1,2,3,4],500),this.animJumpTop.scale=i,this.animSit=p.fromSpriteSheet(K,[6,7],80),this.animSit.scale=i,this.animIdle=p.fromSpriteSheet(X,e,80),this.animIdle.scale=i,this.animRunLeft=p.fromSpriteSheet(Y,e,80),this.animRunLeft.scale=i,this.animRunLeft.flipHorizontal=!0,this.animRunRight=p.fromSpriteSheet(Y,e,80),this.animRunRight.scale=i,this.register();const s=["mage","war"];this.on("precollision",(t=>{t.side===A.Bottom&&s.includes(t.other.name)&&(this.smash=t.other),t.side===A.Bottom&&(this.onFloor=!0)}))}register(){this.graphics.add("idle",this.animIdle),this.graphics.add("left",this.animRunLeft),this.graphics.add("right",this.animRunRight),this.graphics.add("jump_up",this.animJumpTop),this.graphics.add("jump_down",this.animJumpDown),this.graphics.add("attack",this.animAttack)}updateBoxCollider(t=32){this.collider.useBoxCollider(this._width-16,2*this._height-t,D.Half,L(0,t/2))}flip(t){t===tt.RIGHT&&(this.animIdle.flipHorizontal=!1,this.animJumpTop.flipHorizontal=!1,this.animJumpDown.flipHorizontal=!1,this.animSit.flipHorizontal=!1,this.animAttack.flipHorizontal=!1,this.animAttackDown.flipHorizontal=!1,this.animAttackJump.flipHorizontal=!1,this.direction=tt.RIGHT),t===tt.LEFT&&(this.animIdle.flipHorizontal=!0,this.animJumpTop.flipHorizontal=!0,this.animJumpDown.flipHorizontal=!0,this.animSit.flipHorizontal=!0,this.animAttack.flipHorizontal=!0,this.animAttackDown.flipHorizontal=!0,this.animAttackJump.flipHorizontal=!0,this.direction=tt.LEFT)}onPreUpdate(t,e){const i=new ot(t);return this.pos.y>4e3&&Bt.end_of_level(),this.pos.y<-2e3&&Bt.end_of_level(),this.vel.x=0,!this.wasOnGround&&this.onGround&&(this.wasOnGround=!0,i.isHeld("down")&&(lt.play("hit_light"),Bt.engine.currentScene.camera.shake(10,10,200),this.smash&&this.smash.kill())),this.smash=null,t.input.keyboard.isHeld(x.Keys.Escape)&&Bt.stop(),t.input.keyboard.isHeld(x.Keys.O)&&(Bt.engine.currentScene.camera.angularVelocity=2e4),this.handleSit(i,1)?this.end():(this.handleFire(i),this.handleLeftRight(i,1),this.animSitLock?this.end():(this.handleJump(i,1),this.handleFall(i),this.handleIdle(),void this.end()))}end(){this.vel.x+=this.vel_default.x,this.vel.y+=this.vel_default.y,this.floor.update(),this.wasOnGround=this.onGround,this.onFloor=!1,this.vel_default=L(0,0)}handleFall(t){this.onGround||t.isHeld("down")&&(this.vel.y+=40)}handleSit(t,e){if(t.isHeld("sit")?this.onGround&&(this.sit||(this.sit=!0)):this.sit&&(this.hitboxHead.contact||(this.sit=!1)),this.sit||this.hitboxHead.contact&&this.onGround)return this.updateBoxCollider(52),this.animSitLock||this.graphics.use(this.animSit),t.wasPressed("fire")&&!this.cooldownFire&&nt.canFirebolt&&(this.scene.engine.add(new it(new D(this.pos.x,this.pos.y+this._height/2+6),this.direction)),this.graphics.use(this.animAttackDown),this.cooldownFire=!0,this.animSitLock=!0,lt.play("firebolt"),setTimeout((()=>{this.animSitLock=!1,this.animAttackDown.reset()}),440),setTimeout((()=>{this.cooldownFire=!1}),ut.COOLDOWN_FIRE)),t.isHeld("left")&&(this.vel.x=-50*e,this.flip(tt.LEFT)),t.isHeld("right")&&(this.vel.x=50*e,this.flip(tt.RIGHT)),!0;this.updateBoxCollider()}handleFire(t){if(t.wasPressed("fire")&&!this.cooldownFire&&nt.canFirebolt){this.scene.engine.add(new it(new D(this.pos.x,this.pos.y+this._height/2-13),this.direction));const t=this.onGround?this.animAttack:this.animAttackJump;return this.graphics.use(t),this.animSitLock=!0,this.cooldownFire=!0,lt.play("firebolt"),setTimeout((()=>{this.animSitLock=!1,t.reset()}),440),setTimeout((()=>{this.cooldownFire=!1}),ut.COOLDOWN_FIRE),!0}}handleLeftRight(t,e){const i=nt.canSpeed?400:250;t.isHeld("left")&&(this.vel.x=-i*e,this.flip(tt.LEFT),this.animSitLock||this.graphics.use("left")),t.isHeld("right")&&(this.vel.x=i*e,this.flip(tt.RIGHT),this.animSitLock||this.graphics.use("right"))}handleJump(t,e){t.wasPressed("jump")&&(this.onGround?(this.audio_jump.play(),this.vel.y=-420*e,this.doubleJump=!0):this.doubleJump&&nt.canDoubleJump&&(this.audio_jump.play(),this.vel.y=-420*e,this.doubleJump=!1))}handleIdle(){0===this.vel.x&&this.graphics.use("idle"),this.vel.y<0&&this.graphics.use(this.animJumpTop),this.vel.y>0&&this.graphics.use(this.animJumpDown)}dead(){Bt.current_count_dead+=1,this.pos=this.spawn,lt.play("hero_dead"),this.scene.camera.shake(20,20,1e3),this.vel=new D(0,0)}}ut.NAME="hero",ut.COOLDOWN_FIRE=700;const pt=t=>({icon:"avatar_fox",sound:"s278",author:"Renard",content:t}),gt=t=>({icon:"avatar_shrek",sound:"s279",author:"Shrek",content:t}),ft=t=>({icon:"avatar_acidpop",sound:"s270",author:"Acidpop",content:t}),mt=t=>({icon:"avatar_kstore",sound:"s268",author:"Kstore",content:t}),yt=t=>({icon:"avatar_dragon",sound:"s283",author:"Sindragoseur",content:t}),_t=t=>({icon:"avatar_skeleton",sound:"s281",author:"Escamort",content:t}),wt=t=>({icon:"avatar_chest",sound:"s2045",author:"~ ! ~",content:t}),vt={test:[pt("Je suis Renard & ceci est un test !"),gt("Je suis Shrek & ceci est un test !"),ft("Je suis Acidpop & ceci est un test !"),mt("Je suis Kstore & ceci est un test !"),yt("Je suis Sindragoseur & ceci est un test !"),_t("Je suis Escamort & ceci est un test !"),wt("Vous venez de terminer le test !")],fox1:[pt("C'est rare de voir quelqu'un tomber ici."),pt("Essaye d'aller  droite avec la touche D pour voir ?")],fox2:[pt("Non, je t'ai dit d'aller  droite, pas  gauche.")],fox3:[pt("Peut tre que tu te demandes o tu es ?"),pt("Avant a, utilise Z pour sauter les obstacles.")],fox4:[pt("Tu peux aussi t'accroupir avec la touche S.")],level1_fox5:[pt("Tu es dans tes rves mais tu ne peux pas te rveiller"),pt("Pas de panique, il y a un ascenceur onirique  ct.")],level1_fox6:[pt("Un crystal ! Tu reviendras ici si tu fais une btise.")],level1_fox7:[pt("L'ascenceur est juste en face. Bouge la caisse rouge pour passer.")],level1_fox_end:[pt("Je comprends pas. L'ascenseur devait tre ici !"),pt("Il est peut tre un peu plus bas. On va devoir sauter.")],l2_1:[pt("Qu'est ce qui c'est pass ici ?!? Ce n'est pas normal."),mt("A l'aide !"),pt("Vite, quelqu'un appel  l'aide.")],l2_2:[mt("Ah, vous tombez  pic. Un mort-vivant me bloque."),pt("Ecrase le monstre en sautant dessus avec la touche S enfonce."),mt("Oui, saute d'en haut et appuie bien sur S.")],l2_3:[mt("Merci. Je cherchais ma soeur mais un squelette m'a attaqu."),pt("On va la retrouver. Mais, pourquoi il y a des squelettes partout ?"),mt("Escamort, c'est lui derrire cette arme. Il est entrain de dtruire les rves.")],l2_4:[mt("Les miroirs peuvent te tlporter si tu restes devant. Attention."),pt("Je dteste les miroirs.")],l2_5:[ft("Kstore! J'avais si peur. Qui sont les gens avec toi ?"),pt("Je suis Renard et voici Rveuse, elle vient de tomber du ciel."),mt("Merci  vous, prenez ce parchemin et sortez nous de l.")],l2_6:[pt("Nous cherchons l'ascenseur onirique pour rveiller la rveuse."),ft("Escamort l'a vol. Il veut l'utiliser pour son arme."),mt("C'est pour a qu'on doit le vaincre, mais il est trop fort pour nous."),pt("Oh, mais j'ai un ami qui peut faire a. Il habite juste en bas."),mt("Allons-y.")],l3_1:[pt("J'ai un ami dragon, il rside pas loin d'ici."),mt("Un dragon ?!?"),pt("Tous les dragons ne sont pas mchants, madame.")],l3_2:[yt("Renard... Fripouille. Que viens-tu faire ici avec tes amis ?"),pt("Nous avons besoin de toi. Escamort fabrique une arme pour dtruire les rves."),yt("Qui est la jeune fille avec toi ?"),pt("Rveuse, elle dort trop profondment pour se rveiller."),yt("Une rveuse, parfait. Allez me cherche une rose des rves et je vous aiderai.")],l3_3:[mt("Il y a encore un pallier avant d'tre chez Escamort."),gt("Vous voulez un cadeau ?"),pt("Qui vient de parler ?"),gt("Shrek, cadeau ?")],l3_loot:[wt("Vous obtenez une rose des rves."),yt("Parfait, reviens me donner la rose."),ft("Pourquoi une rose ?"),pt("Je ne sais pas, il va nous expliquer.")],l3_loot_after:[yt("Ah... merci. Je voulais voir une dernire fois une rose de rve."),yt("Rveuse, je suis vieux, je vais bientt partir, mais je peux encore t'aider."),wt("Vous obtenez des ailes de dragon. Vous pouvez sauter 2 fois de suite."),yt("Avec mes ailes, tu pourras atteindre des nouveaux endroits."),mt("Mais on fait comment pour Escamort ? Nous avions besoin de vous."),yt("La rveuse va s'en charger. Je vais veiller sur elle le temps qu'il me reste."),pt("C'est de la folie, Sindra.")],l4_1:[gt("Shrek, content. Shrek, cadeau."),pt("Mais, on ne veut pas de tes cadeaux !"),ft("Peut tre qu'on devrait accepter son cadeau."),gt("Cadeaux...")],l4_2:[pt("Oh non, on ne peut pas traverser, Rveuse ne va pas assez vite.")],l4_3:[gt("Shrek content, Shrek cadeau"),ft("Mais c'est trop bien."),pt("Peut tre qu'on peut accepter ses cadeaux du moment qu'il nous drange pas.")],l4_4:[yt("Les amis, le repre d'Escamort est juste en dessous."),mt("Nous sommes tous prt."),gt("Shrek, cadeau.")],l5_1:[_t("Misrable, pathtique. Je vais vous spoiler la fin. Vous allez tous mourir."),pt("Il a l'air en colre."),_t("La secte du symbol infini est trop forte. Vous ne pouvez rien faire.")],l5_3:[_t("L'infini est la seule solution, l'ternit est la seule approche !")],l5_4:[_t("Gloire au symbol infini, les rves n'ont pas de fin !"),pt("Tout  une fin Escamort, la tienne arrive bientt.")],l5_2:[_t("Non, mais c'est impossible. Comment avez vous pu atteindre cet endroit ?"),pt("En sautant peut tre ?"),_t("Je dois battre en retraite."),mt("Suivons le !")],l6_0:[_t("VOUS NE PASSEREZ PAS !")],l6_1:[mt("C'tait lui ? Mais il est nul."),_t("AHAH, ET BIEN NON. MISERABLE.")],l6_2:[ft("Cette fois ci, c'tait bien lui."),_t("AHAH, JE SUIS INFINI. PATHETIQUE.")],l6_3:[gt("Escamort cadeau mort."),_t("AHAH, NON, JE M'EN BRANLE DE TES CADEAUX.")],l6_4:[_t("Je ne .... aaaarrrrrrgghhhhhhhh."),yt("C'est termin. C'est le moment de dire une phrase cliche que vous aimez."),pt("Jen ai pas spcialement de phrase que jaime bien.")],end:[pt("Nous y sommes... enfin."),pt("Arriv en haut, tu pourras te rveiller."),pt("Quand a nous, il ne reste plus qu' se dire aurevoir."),ft("Aurevoir rveuse !"),mt("Aurevoir."),pt("Ce n'est pas un adieu, on restera dans ta tte."),pt("Mais pour combien de temps ?"),gt("Et mes cadeaux..."),yt("Je les brle tes cadeaux !"),gt("Aurevoir rveuse..."),yt("Bon reveil."),pt("Reviens vite.")],loot_firebolt:wt("Vous obtenez un parchemin de boule de feu. Appuyez sur E pour lancer des flammes."),loot_doublejump:wt("Vous obtenez des ailes de dragon. Vous pouvez sauter 2 fois de suite."),loot_speed:wt("Vous obtenez des chaussures de sport Balancica. Vous courrez maintenant plus vite.")},xt=async t=>await new Promise((e=>setTimeout(e,t))),bt={camera_back:async t=>{await t.scene.camera.zoomOverTime(.5,2e3)},camera_zoom:async t=>{await t.scene.camera.zoomOverTime(1,2e3)},start:async t=>{},set_hair_color:async t=>{},play_music:async t=>{t.config.data1&&lt.playMusic(t.config.data1,!1)},dialog:async t=>{t.config.data2&&await xt(Number(t.config.data2));const e=t.config.data1;e&&vt[e]&&vt[e].forEach((t=>Bt.add_message(t)))},unlock_doublejump:async()=>{rt({canDoubleJump:!0}),Bt.add_message(vt.loot_doublejump)},unlock_firebolt:async()=>{rt({canFirebolt:!0}),Bt.add_message(vt.loot_firebolt)},unlock_speed:async()=>{rt({canSpeed:!0}),Bt.add_message(vt.loot_speed)},shake:async t=>{t.config.data1&&t.config.data2&&t.config.data3&&(Bt.engine.currentScene.camera.shake(Number(t.config.data1),Number(t.config.data2),Number(t.config.data3)),t.config.data4&&lt.play(t.config.data4))},the_end:async()=>{console.log("trigger",window.document.querySelector(".Level_white")),window.document.querySelector(".Level_white")?.classList.add("enabled"),setTimeout((()=>{Bt.levelId=0,Bt.engine.stop(),Bt.state=Dt.END}),8e3)}},St=Object.keys(bt);class Ct extends M{constructor(t){super({pos:L(t.x+t.width/2,t.y+t.height/2),width:t.width,height:t.height,repeat:t.repeat||1,filter:t=>t?.name===ut.NAME,action:()=>bt[t.event](this)}),this.config=t}}class Et extends u{constructor(t){super({pos:L(t.x+t.width/2,t.y+t.height/2),width:t.width,height:t.height,collisionType:f.Passive}),this.e=t}onInitialize(t){super.onInitialize(t);let e=!1;this.e.messages&&this.on("precollision",(t=>{"hero"!==t.other.name||e||(e=!0,this.e.messages.forEach((t=>Bt.add_message(t))))})),"rose"===this.e.animation&&this.on("precollision",(t=>{this.collider.bounds.contains(t.other.collider.bounds)&&(nt.dragonRose||2!==Bt.levelId||(vt.l3_loot.forEach((t=>Bt.add_message(t))),rt({dragonRose:!0})),this.kill())})),"dragon_idle"===this.e.animation&&2===Bt.levelId&&this.on("precollision",(t=>{this.collider.bounds.contains(t.other.collider.bounds)&&nt.dragonRose&&(vt.l3_loot_after.forEach((t=>Bt.add_message(t))),rt({canDoubleJump:!0,dragonRose:!1}))})),this.e.animation&&("dragon_idle"===this.e.animation?$[this.e.animation].scale=L(4,4):"shrek"===this.e.animation?$[this.e.animation].scale=L(2,2):"kstore"===this.e.animation&&($[this.e.animation].scale=L(1.5,1.5)),this.graphics.add("default",$[this.e.animation]),this.graphics.use("default"))}}class Pt extends ut{onInitialize(t){const e=[0,1,2,3,4,5,6,7],i=new D(2,2);this.animAttack=p.fromSpriteSheet(j,[0,1,2,3,4,5,6,7,8,9,10],40),this.animAttack.scale=i,this.animAttackDown=p.fromSpriteSheet(V,[0,1,2,3,4,5,6],70),this.animAttackDown.scale=i,this.animAttackJump=p.fromSpriteSheet(q,[0,1,2,3,4],80),this.animAttackJump.scale=i,this.animJumpDown=p.fromSpriteSheet(Z,[5,6,7],500),this.animJumpDown.scale=i,this.animJumpTop=p.fromSpriteSheet(Z,[1,2,3,4],500),this.animJumpTop.scale=i,this.animSit=p.fromSpriteSheet(K,[5,6,7,8],80),this.animSit.scale=i,this.animIdle=p.fromSpriteSheet(G,e,120),this.animIdle.scale=i,this.animRunLeft=p.fromSpriteSheet(Q,e,80),this.animRunLeft.scale=i,this.animRunLeft.flipHorizontal=!0,this.animRunRight=p.fromSpriteSheet(Q,e,80),this.animRunRight.scale=i,this.register()}}class At extends it{sheet(){return H}onPreCollision(t){"hero"===t.other.name&&(this.kill(),t.other.dead())}onInitialize(t){this.anim=p.fromSpriteSheet(this.sheet(),[0,1,2,3,4],60),this.anim.flipHorizontal=this.direction===tt.LEFT,this.graphics.add("bolt",this.anim),this.graphics.use("bolt"),setTimeout((()=>{this.kill()}),4e3),this.on("collisionstart",(t=>{t.other.name.includes("floor")&&this.kill()})),this.on("precollision",(t=>{this.onPreCollision(t)}))}onPreUpdate(t,e){this.vel.x=400*this.direction,this.vel.y=0}}class kt extends ct{constructor(t){super({name:"war",pos:L(t.x+t.width/2,t.y+t.height/2),width:t.width,height:t.height,collisionType:f.Active,collider:P.Box(t.width-48,t.height-32,D.Half,L(10,6))}),this.e=t,this.floor=new ht(this),this.direction=0,this.lock=!1,this.target=!1,this.watch_list=[ut.NAME],this.timeout=null}onInitialize(t){super.onInitialize(t),this.direction=this.e.data2?tt.RIGHT:tt.LEFT;const e=$.war_idle.clone(),i=$.war_walk.clone(),s=$.war_attack.clone();i.scale=L(2,2),e.scale=L(2,2),s.scale=L(2,2),e.flipHorizontal=this.direction!==tt.RIGHT,i.flipHorizontal=this.direction!==tt.RIGHT,s.flipHorizontal=this.direction!==tt.RIGHT,this.graphics.add("idle",e),this.graphics.add("walk",i),this.graphics.add("attack",s),this.graphics.use("idle"),this.on("precollision",(t=>{if(t.side===A.Left||t.side===A.Right){["floor","mage","war"].includes(t.other.name)&&(this.direction=this.direction===tt.RIGHT?tt.LEFT:tt.RIGHT,e.flipHorizontal=this.direction!==tt.RIGHT,i.flipHorizontal=this.direction!==tt.RIGHT,s.flipHorizontal=this.direction!==tt.RIGHT),"hero"!==t.other.name||this.lock||(t.side===A.Left&&this.direction===tt.LEFT||t.side===A.Right&&this.direction===tt.RIGHT)&&(this.target&&(this.target=!1,t.other.dead()),this.lock=!0,this.graphics.use("attack"),this.timeout=setTimeout((()=>{this.timeout=null,this.target&&t.other.dead(),this.target=!0,this.lock=!1}),500))}else t.side===A.Top&&this.watch_list.includes(t.other.name)&&this.actors.push(t.other)}))}onPreKill(t){super.onPreKill(t),clearTimeout(this.timeout)}onPreUpdate(t,e){super.onPreUpdate(t,e),this.pos.y>1e4&&this.kill(),this.pos.y<-2e3&&this.kill(),this.vel.x=0;const i=this.e.data1?Number(this.e.data1):100*this.direction;this.vel.x+=i,this.move_x(i),this.lock||(this.vel.x>0||this.vel.x<0?this.graphics.use("walk"):this.graphics.use("idle")),this.actors=[],this.floor.update()}}const Tt={Mage:class extends u{constructor(t){super({name:"mage",pos:L(t.x+t.width/2,t.y+t.height/2),width:t.width,height:t.height,collisionType:f.Active,collider:P.Box(t.width-48,t.height-32,D.Half,L(10,6))}),this.e=t,this.floor=new ht(this),this.lock=!1,this.direction=0}onInitialize(t){super.onInitialize(t),this.direction=this.e.data2?tt.RIGHT:tt.LEFT;const e=$.mage_idle.clone();e.scale=L(2,2),e.flipHorizontal=this.direction!==tt.RIGHT,this.graphics.add("idle",e),this.attack=$.mage_attack.clone(),this.attack.scale=L(2,2),this.attack.flipHorizontal=this.direction!==tt.RIGHT,this.graphics.add("attack",this.attack),this.graphics.use("idle"),this.clock=setInterval((()=>{this.fire()}),this.e.data1?Number(this.e.data1):4e3)}fire(){this.lock=!0,this.scene.engine.add(new At(new D(this.pos.x,this.pos.y),this.direction)),this.graphics.use(this.attack),setTimeout((()=>{this.lock=!1,this.attack.reset()}),500)}onPreKill(t){super.onPreKill(t),clearInterval(this.clock)}onPreUpdate(t,e){super.onPreUpdate(t,e),this.pos.y>1e4&&this.kill(),this.pos.y<-2e3&&this.kill(),this.lock||(this.graphics.use("idle"),this.vel.x=0,this.floor.update())}},Mirror:class extends u{constructor(t){super({name:"mirror",pos:L(t.x+t.width/2,t.y+t.height/2),width:t.width,height:t.height,collisionType:f.Passive,collider:P.Box(t.width/2+8,t.height-12,D.Half,L(0,8))}),this.e=t,this.floor=new ht(this)}onInitialize(t){super.onInitialize(t),this.graphics.add("idle",$.mirror),this.graphics.use("idle");const e=[ut.NAME,"bolt","mage","war"];this.on("precollision",(i=>{if(e.includes(i.other.name)&&!i.other.$lock&&this.collider.bounds.contains(i.other.collider.bounds)&&this.e.data2){const e=t.currentScene.actors.find((t=>"mirror"===t.name&&t.e.data1===this.e.data2));e&&(i.other.$lock=!0,setTimeout((()=>{i.other.$lock=!1}),1e3),i.other.pos=e.pos)}}))}onPreUpdate(t,e){super.onPreUpdate(t,e),this.vel.x=0,this.floor.update()}},War:kt,Spawn:class extends u{constructor(t){super({name:"spawn",pos:L(t.x+t.width/2,t.y+t.height/2),width:t.width,height:t.height,collisionType:f.Passive,collider:P.Box(t.width+16,t.height+16,D.Half,L(0,0))}),this.e=t}onInitialize(t){super.onInitialize(t),this.graphics.add("disabled",$.crystal_red),this.graphics.add("enabled",$.crystal_blue),this.graphics.use("disabled");const e=[ut.NAME];this.on("precollision",(t=>{if(e.includes(t.other.name)&&this.collider.bounds.contains(t.other.collider.bounds)){t.other.spawn.equals(this.pos)||(t.other.spawn=this.pos,lt.play("crystal"),this.graphics.use("enabled"))}}))}},DeadlyArea:class extends u{constructor(t){super({name:"deadly_area",pos:L(t.x+t.width/2,t.y+t.height/2),width:t.width,height:t.height}),this.e=t;const e=new S({x:t.x,y:t.y,width:this.e.width,height:this.e.height});e.emitterType=_.Rectangle,e.radius=5,e.minVel=10,e.maxVel=30,e.minAngle=5.5,e.maxAngle=3.5,e.isEmitting=!0,e.emitRate=400,e.opacity=.8,e.fadeFlag=!1,e.particleLife=1e3,e.maxSize=10,e.minSize=1,e.startSize=0,e.endSize=20,e.acceleration=new D(0,0),e.beginColor=m.Azure,e.endColor=m.Cyan,this.emitter=e,this.emitter.transform.z=-100}onInitialize(t){super.onInitialize(t);const e=[ut.NAME,"mage","war"];t.currentScene.add(this.emitter),this.on("precollision",(t=>{e.includes(t.other.name)&&("hero"===t.other.name?t.other.dead():t.other.kill())}))}onPreUpdate(t,e){super.onPreUpdate(t,e),this.emitter._preupdate(t,e)}},Block:class extends u{constructor(t){super({name:"floor",pos:L(t.x+t.width/2,t.y+t.height/2),collisionType:f.Active,color:m.Red,width:t.width,height:t.height}),this.e=t}},Spawner:class extends u{constructor(t){super({name:"spawner",pos:L(t.x+t.width/2,t.y+t.height/2-16),collisionType:f.Passive,color:m.Transparent,width:t.width,height:t.height}),this.e=t,this.clock=null}onInitialize(t){super.onInitialize(t),this.graphics.add("idle",$.mirror),this.graphics.use("idle"),this.timer=new R({repeats:!0,interval:this.e.data1?Number(this.e.data1):4e3,fcn:()=>{this.scene.engine.add(new kt({...this.e}))}}),this.timer.start(),t.currentScene.add(this.timer)}onPreKill(t){super.onPreKill(t),this.timer.stop(),clearInterval(this.clock)}}},Rt=Object.keys(Tt);class Mt extends E{build(t){console.log("level::build",t);let e=null;for(const i of t.entities){if("floor"===i.type){const t=new dt(i);this.add(t)}if("event"===i.type){"start"===i.event&&(e=0===nt.hero?new ut(L(i.x+32,i.y)):new Pt(L(i.x+32,i.y)));const t=new Ct(i);this.add(t)}"npc"===i.type&&this.add(new Et(i)),"foe"===i.type&&this.add(new Tt[i.name](i))}if(e){const i=new S({x:-1e3,y:0,width:t.full?4e3:1e4,height:t.full?1e4:1e3});i.emitterType=_.Rectangle,i.radius=5,i.minVel=0,i.maxVel=10,i.minAngle=0,i.maxAngle=6.2,i.isEmitting=!0,i.emitRate=300,i.opacity=.8,i.fadeFlag=!0,i.particleLife=2376,i.maxSize=10,i.minSize=1,i.startSize=0,i.endSize=25,i.acceleration=new D(1,1),i.beginColor=m.Transparent,i.endColor=m.Transparent,this.add(i),this.add(e)}this.camera.clearAllStrategies(),e&&this.camera.strategy.elasticToActor(e,.05,.1),this.camera.zoom=.1,this.camera.zoomOverTime(1,2e3),t.music&&lt.playMusic(t.music,!0)}onInitialize(t){console.log("level::onInitialize",t),this.build(Bt.level)}onActivate(t,e){super.onActivate(t,e),console.log("level::onActivate",t,e)}onDeactivate(t,e){super.onDeactivate(t,e),console.log("level::onDeactivate",t,e)}clear(){console.log("level::clear entities"),this.entities.forEach((t=>this.remove(t))),this.actors.forEach((t=>this.contains(t)&&this.remove(t))),this.triggers.forEach((t=>this.remove(t)))}}var Dt,Lt;(Lt=Dt||(Dt={}))[Lt.INTRO=0]="INTRO",Lt[Lt.TITLE=1]="TITLE",Lt[Lt.CONTINUE=2]="CONTINUE",Lt[Lt.LEVEL=3]="LEVEL",Lt[Lt.EDITOR=4]="EDITOR",Lt[Lt.END=5]="END",Lt[Lt.SETTINGS=6]="SETTINGS",Lt[Lt.BEGIN=7]="BEGIN";const Bt=window.game=new class{constructor(){this.messages=[],this.callbacksChangeState=[],this.callbacksChangeLevel=[],this.callbacksOnMessage=[],this.levelId=localStorage.GameLevel?Number(localStorage.GameLevel):0,this.preview=!1,this.loader=new b,this.engine=new w({displayMode:y.FillScreen,backgroundColor:m.Black,suppressPlayButton:!0,suppressConsoleBootMessage:!0,antialiasing:!0,canvasElementId:"game"}),this.internalState=localStorage.GameState?Number(localStorage.GameState):Dt.INTRO,this.message_timer=null,this.message_delay_default=5e3,this.current_count_dead=0,this.current_startAt=0,this.callbackIsReady=()=>0,this.configure(),this.loader.playButtonText="",this.loader.backgroundColor="#ffffff",this.loader.logo="",this.loader.loadingBarColor=m.fromHex("#666666");for(const t in B)this.loader.addResource(B[t]);for(const t in I)this.loader.addResource(I[t]);nt.levels.forEach(((t,e)=>{this.engine.addScene("level"+e,new Mt)})),this.engine.addScene("level",new Mt)}get state(){return this.internalState}set state(t){this.internalState===Dt.LEVEL&&t!==Dt.LEVEL&&this.stop_messages(),this.internalState=t,this.callbacksChangeState.forEach((e=>e(t)))}get level(){return nt.levels[this.levelId]}configure(){console.log("game::configure"),C.acc=new D(0,800)}async initialize(){console.log("game::initialize"),await this.engine.start(this.loader),console.log("game::initialize START=OK"),this.callbackIsReady&&this.callbackIsReady()}onChangeLevel(t){this.callbacksChangeLevel.push(t)}onChangeState(t){this.callbacksChangeState.push(t)}test(t,e){console.log("game::test",t,e),nt.levels[t].entities=e,this.next(t),this.preview=!0,this.engine.start(this.loader),this.engine.goToScene("level"),this.engine.goToScene("level"+t),this.state=Dt.LEVEL}editor(){this.state=Dt.EDITOR}end_of_level(){const t=Date.now(),e=this.levelId,i=nt.count_dead[e],s=nt.timers[e],n=this.current_count_dead,r=(t-this.current_startAt)/1e3;if(-1===i||i>n){const t=nt.count_dead;t[e]=n,rt({count_dead:t})}if(-1===s||s>r){const t=nt.timers;t[e]=r,rt({timers:t})}this.current_count_dead=0,this.current_startAt=0,this.next()}next(t=-1){if(this.current_count_dead=0,this.stop_messages(),lt.stop(),console.log("game::next_level"),this.preview)return console.log("game::next_level as preview: abort & back to editor"),this.preview=!1,this.engine.currentScene.entities.forEach((t=>this.engine.currentScene.remove(t))),this.engine.currentScene.actors.forEach((t=>this.engine.currentScene.contains(t)&&this.engine.currentScene.remove(t))),this.engine.currentScene.triggers.forEach((t=>this.engine.currentScene.remove(t))),this.engine.stop(),void(this.state=Dt.EDITOR);t>-1?(console.log("game::next_level (set one)"),this.levelId=t):(nt.roses[this.levelId]=1,rt(nt),console.log("game::next_level (inc +1)"),this.levelId+=1,this.engine.currentScene.entities.forEach((t=>this.engine.currentScene.remove(t))),this.engine.currentScene.actors.forEach((t=>this.engine.currentScene.contains(t)&&this.engine.currentScene.remove(t))),this.engine.currentScene.triggers.forEach((t=>this.engine.currentScene.remove(t))),this.engine.goToScene("level"+this.levelId)),this.levelId===nt.levels.length?(nt.roses[this.levelId]=1,rt(nt),console.log("game::next_level game is over"),this.levelId=0,this.engine.stop(),this.state=Dt.END):(this.current_startAt=Date.now(),console.log("game::next_level notify"),this.callbacksChangeLevel.forEach((t=>t(this.level))))}start(t=0){this.next(t),this.engine.goToScene("level"+t),this.engine.start(),this.state=Dt.LEVEL}stop(){this.preview?window.location.reload():(this.preview=!1,this.engine.currentScene.clear(),this.engine.stop(),lt.stop(),this.state=Dt.TITLE)}stop_messages(){console.log("game::clear_messages"),clearTimeout(this.message_timer),this.message_timer=null,this.messages=[],this.callbacksOnMessage.forEach((t=>t()))}next_message(){if(console.log("game::next_message"),clearTimeout(this.message_timer),this.message_timer=null,!this.messages.length)return console.log("game::next_message callbacksOnMessage empty"),void this.callbacksOnMessage.forEach((t=>t()));const t=this.messages[0];console.log("game::next_message broadcast",t),this.callbacksOnMessage.forEach((e=>e(t))),this.messages.shift(),t.sound&&lt.play(t.sound),this.message_timer=setTimeout((()=>{console.log("game::next_message auto-next delay"),this.next_message(),this.message_timer=null}),this.message_delay_default)}add_message(t){console.log("game::add_message",t),this.messages.push(t),this.message_timer||this.next_message()}onMessage(t){this.callbacksOnMessage.push(t)}onReady(t){this.callbackIsReady=t,this.loader.isLoaded()&&t()}};o=n("eCRxs");class It extends o.Component{async componentDidMount(){setTimeout((()=>{Bt.onReady((()=>{this.setState({loading:!1})})),this.setState({opacity:1})}),1e3),this.interval=setInterval((()=>{this.setState({progress:100*Bt.loader.progress})}),500);try{await Bt.initialize()}catch(t){console.log(t)}}render(){const t="A Fox and Roses";return r.jsx("div",{className:"Intro",onClick:this.next,children:r.jsxs("div",{className:"title"+(this.state.opacity?" then":""),style:{opacity:this.state.opacity},children:[r.jsxs("div",{id:"container",children:[r.jsx("h1",{children:t}),r.jsx("h1",{children:t}),r.jsx("h1",{children:t})]}),r.jsxs("div",{className:"loading",style:{marginTop:32},children:[this.state.loading&&r.jsxs("span",{children:[Math.floor(this.state.progress)," %"]}),!this.state.loading&&r.jsx("span",{children:"Cliquez n'importe o pour continuer."})]})]})})}constructor(...t){super(...t),this.state={opacity:0,loading:!0,progress:0},this.leaving=!1,this.next=()=>{this.state.loading||this.leaving||(this.leaving=!0,I.s2045.play(),setTimeout((()=>{Bt.state=Dt.TITLE}),1e3),clearInterval(this.interval),this.setState({opacity:0}))}}}o=n("eCRxs");class Ft extends o.Component{componentDidMount(){setTimeout((()=>{this.setState({opacity:1})}),500),lt.playMusic("sky")}new_game(){lt.stop(),lt.play("s2045"),Bt.state=Dt.BEGIN}continue(){Bt.state=Dt.CONTINUE}editor(){lt.stop(),lt.play("s2045"),Bt.editor()}settings(){Bt.state=Dt.SETTINGS}render(){return r.jsxs("div",{className:"Title",style:{opacity:this.state.opacity},children:[r.jsx("div",{id:"stars"}),r.jsx("div",{id:"stars2"}),r.jsx("div",{id:"stars3"}),r.jsxs("div",{className:"Title_menu",id:"title",children:[r.jsx("button",{onClick:()=>this.new_game(),children:"Nouvelle Partie"}),r.jsx("button",{onClick:()=>{this.continue()},children:"Continuer"}),r.jsx("button",{onClick:()=>this.editor(),children:"Editeur"})]})]})}constructor(...t){super(...t),this.state={opacity:0}}}o=n("eCRxs");const zt=Object.keys({floor:{},event:{},npc:{},foe:{}});class Nt extends o.Component{componentDidMount(){localStorage.setItem("GameState","4")}componentWillUnmount(){}createState(){return{current:Bt.levelId,level:nt.levels[Bt.levelId],entities:this.copy(nt.levels[Bt.levelId].entities),type:zt[0],type_event:St[0],type_npc:J[0],type_foe:Rt[0],selected:void 0}}copy(t){return JSON.parse(JSON.stringify(t))}saveHistory(){this.history.unshift(JSON.stringify(this.state.entities))}stopEvent(t){t.stopPropagation(),t.preventDefault()}deleteEntity(t){const e=this.state.entities.indexOf(t);e>-1&&(this.state.entities.splice(e,1),this.forceUpdate())}render(){return r.jsxs("div",{className:"Editor",onMouseUp:this.mouseUp,onMouseMove:this.mouseMove,children:[r.jsx("style",{children:"body { overflow: auto !important }"}),r.jsx("div",{onDoubleClick:this.onDoubleClick,className:"Editor_area",children:this.state.entities.map(((t,e)=>r.jsxs("div",{onDoubleClick:this.action((()=>{this.state.selected===t?this.setState({selected:void 0}):this.setState({selected:t})})),onMouseDown:this.mouseDownEntity(t),onClick:this.stopEvent,className:"Editor_entity "+(this.state.selected===t?"selected":""),style:{zIndex:this.state.selected===t?9999:e,left:t.x,top:t.y,color:"white",width:t.width,height:t.height,backgroundColor:"event"===t.type?"rgba(255,255,255,0.1)":"rgba(255,255,255,0.8)"},children:["floor"===t.type&&"floor","event"===t.type&&t.event,"npc"===t.type&&t.animation,"foe"===t.type&&t.name,r.jsx("div",{className:"border top",onMouseDown:this.mouseDownBorder(t,"top")}),r.jsx("div",{className:"border bottom",onMouseDown:this.mouseDownBorder(t,"bottom")}),r.jsx("div",{className:"border left",onMouseDown:this.mouseDownBorder(t,"left")}),r.jsx("div",{className:"border right",onMouseDown:this.mouseDownBorder(t,"right")})]},e)))}),r.jsxs("div",{className:"Editor_toolbar",children:[r.jsx("select",{value:Bt.levelId,onChange:t=>{localStorage.setItem("GameLevel",t.target.value),localStorage.setItem("GameState","4"),window.location.reload()},children:nt.levels.map(((t,e)=>r.jsxs("option",{value:String(e),children:["L",e+1]},e)))})," | ",r.jsx("button",{onClick:()=>{const t={...this.state.level,entities:this.state.entities},e=nt.levels;e[Bt.levelId]=t,rt({levels:e}),navigator.clipboard.writeText(JSON.stringify(t,null,"  ")),Bt.test(this.state.current,this.state.entities)},children:" Test"})," | ",r.jsx("button",{onClick:()=>{const t={...this.state.level,entities:this.state.entities},e=nt.levels;e[Bt.levelId]=t,rt({levels:e}),navigator.clipboard.writeText(JSON.stringify(t,null,"  "))},children:" Save"})," | ",r.jsx("button",{onClick:()=>{localStorage.removeItem("GameState"),localStorage.removeItem("GameLevel"),localStorage.removeItem("$config"),window.location.reload()},children:" Reset & Quit"})," | ",r.jsx("button",{onClick:()=>{this.history.length&&(this.setState({entities:JSON.parse(this.history[0])}),this.history.splice(0,1))},children:" Cancel"})," | ",r.jsx("select",{onChange:this.$("type"),children:zt.map((t=>r.jsx("option",{value:t,children:t.toUpperCase()},t)))}),"event"===this.state.type&&r.jsx("select",{onChange:this.$("type_event"),children:St.map((t=>r.jsx("option",{value:t,children:t.toUpperCase()},t)))}),"npc"===this.state.type&&r.jsx("select",{onChange:this.$("type_npc"),children:J.map((t=>r.jsx("option",{value:t,children:t.toUpperCase()},t)))}),"foe"===this.state.type&&r.jsx("select",{onChange:this.$("type_foe"),children:Object.keys(Tt).map((t=>r.jsx("option",{value:t,children:t.toUpperCase()},t)))})]}),this.state.selected&&r.jsxs("div",{className:"Editor_toolbar_entity",children:["(w:",this.state.selected.width,") (h:",this.state.selected.height,") (x:",this.state.selected.x,") (y:",this.state.selected.y,")",r.jsx("button",{onClick:this.action((()=>{this.deleteEntity(this.state.selected),this.setState({selected:void 0})})),children:" Delete"}),"floor"===this.state.selected.type&&r.jsxs(r.Fragment,{children:[r.jsx("input",{value:this.state.selected?.move?.y||0,onChange:t=>{const e=this.state.selected;if(e&&"floor"===e.type){const i=t.target.value;e.move=e.move||{y:0,x:0,speed:0},e.move.y=Number(i),this.forceUpdate()}}}),r.jsx("input",{value:this.state.selected?.move?.x||0,onChange:t=>{const e=this.state.selected;if(e&&"floor"===e.type){const i=t.target.value;e.move=e.move||{y:0,x:0,speed:0},e.move.x=Number(i),this.forceUpdate()}}}),r.jsx("input",{value:this.state.selected?.move?.speed||0,onChange:t=>{const e=this.state.selected;if(e&&"floor"===e.type){const i=t.target.value;e.move=e.move||{y:0,x:0,speed:0},e.move.speed=Number(i),this.forceUpdate()}}}),r.jsx("input",{type:"color",value:this.state.selected.color||"#ffffff",onChange:t=>{const e=this.state.selected;if(e&&"floor"===e.type){const i=t.target.value;i?(e.color=i,this.forceUpdate()):delete e.color}}}),r.jsx("input",{type:"checkbox",value:String(this.state.selected.move?.hero||!1),onChange:t=>{const e=this.state.selected;e&&"floor"===e.type&&(e.move=e.move||{y:0,x:0,speed:0},e.move.hero=t.target.checked,this.forceUpdate())}})]}),"event"===this.state.selected.type&&r.jsx(r.Fragment,{children:r.jsx("select",{onChange:t=>{const e=this.state.selected;e&&"event"===e.type&&(e.event=t.target.value,this.forceUpdate())},children:St.map((t=>r.jsx("option",{value:t,children:t.toUpperCase()},t)))})}),"npc"===this.state.selected.type&&r.jsx("input",{value:this.state.selected.animation,onChange:t=>{if(this.state.selected&&"npc"===this.state.selected.type){const e=this.state.selected;e.animation=t.target.value,this.setState({selected:e})}}}),("foe"===this.state.selected.type||"event"===this.state.selected.type)&&r.jsxs(r.Fragment,{children:[r.jsx("input",{placeholder:"data1",value:this.state.selected.data1||"",onChange:t=>{const e=this.state.selected;!e||"foe"!==e.type&&"event"!==e.type||(e.data1=t.target.value,this.setState({selected:e}))}}),r.jsx("input",{placeholder:"data2",value:this.state.selected.data2||"",onChange:t=>{const e=this.state.selected;!e||"foe"!==e.type&&"event"!==e.type||(e.data2=t.target.value,this.setState({selected:e}))}}),r.jsx("input",{placeholder:"data3",value:this.state.selected.data3||"",onChange:t=>{const e=this.state.selected;!e||"foe"!==e.type&&"event"!==e.type||(e.data3=t.target.value,this.setState({selected:e}))}}),r.jsx("input",{placeholder:"data3",value:this.state.selected.data4||"",onChange:t=>{const e=this.state.selected;!e||"foe"!==e.type&&"event"!==e.type||(e.data4=t.target.value,this.setState({selected:e}))}})]})]})]})}constructor(...t){super(...t),this.state=this.createState(),this.drag="",this.x=0,this.y=0,this.w=0,this.h=0,this.history=[],this.changeLevel=()=>{this.setState(this.createState())},this.mouseDownEntity=t=>e=>{this.drag="entity",this.e=t,this.x=e.pageX-t.x,this.y=e.pageY-t.y,this.saveHistory()},this.mouseDownBorder=(t,e="")=>i=>{i.stopPropagation(),i.preventDefault(),this.drag="border_"+e,this.x=i.pageX,this.y=i.pageY,this.w=t.width,this.h=t.height,this.e=t,this.saveHistory()},this.mouseUp=()=>{this.drag=""},this.mouseMove=t=>{const e=t=>t-t%8;"border_right"===this.drag&&(this.e.width=e(this.w+t.pageX-this.x),this.forceUpdate()),"border_left"===this.drag&&(this.e.x=e(t.pageX),this.e.width=e(this.w+(this.x-t.pageX)),this.forceUpdate()),"border_top"===this.drag&&(this.e.y=e(t.pageY),this.e.height=e(this.h+(this.y-t.pageY)),this.forceUpdate()),"border_bottom"===this.drag&&(this.e.height=e(this.h+t.pageY-this.y),this.forceUpdate()),"entity"===this.drag&&(this.e.x=e(t.pageX-this.x),this.e.y=e(t.pageY-this.y),this.forceUpdate())},this.action=(t,e=!0)=>i=>{this.stopEvent(i),e&&this.saveHistory();try{t(i)}catch(t){console.error(t)}},this.$=t=>e=>{this.setState({[t]:String(e.target.value)})},this.onDoubleClick=t=>{this.saveHistory(),console.log(t);let e=64;if("npc"===this.state.type){e={acidpop:64,kstore:96,dragon_idle:256,shrek:128}[this.state.type_npc]||$[this.state.type_npc].height||128}"foe"===this.state.type&&(e=96,"Mirror"===this.state.type_foe&&(e=128));const i={type:this.state.type,x:t.pageX-e/2,y:t.pageY-e/2,width:e,height:e};"event"===i.type&&(i.event=this.state.type_event),"npc"===i.type&&(i.animation=this.state.type_npc,i.dialogs=[""],i.name=this.state.type_npc),"foe"===this.state.type&&(i.name=this.state.type_foe),this.state.entities.push(i),this.forceUpdate()}}}o=n("eCRxs");class Ot extends o.Component{async componentDidMount(){await xt(1e3),await this.show("Aprs une longue & aventureuse nuit. Notre rveuse se rveilla au chaud chez elle. Le sourire aux lvres."),await this.show("Kstore et Acidpop continurent leurs explorations dans les rves,  la recherche de nouveaux compagnons."),await this.show("Shrek dcida d'offrir des cadeaux aux morts-vivants restant, esprant les rendre gentils."),await this.show("Sindragoseur s'est endormi une dernire fois, la rose des rves  ses cts."),await this.show("Quant  Renard, il resta au mme endroit. Esprant revoir la rveuse une nouvelle fois."),this.setState({opacity:1,message:"Fin"}),await xt(12e3),Bt.state=Dt.TITLE}async show(t){this.setState({opacity:1,message:t}),await xt(12e3),this.setState({opacity:0}),await xt(4e3)}render(){return r.jsx("div",{className:"End",children:r.jsx("div",{className:"text",style:{opacity:this.state.opacity},children:this.state.message})})}constructor(...t){super(...t),this.state={opacity:0,message:""}}}o=n("eCRxs"),o=n("eCRxs");class Ut extends o.Component{componentDidMount(){this.timer()}timer(){this.clock=setInterval((()=>{this.tick()}),32)}tick(){""!==this.props.content&&(this.props.content!==this.content_to_display?(this.content_to_display=this.props.content,this.content_it=1,this.setState({content_parts:this.content_to_display.slice(0,this.content_it)})):(this.content_it+=1,this.setState({content_parts:this.content_to_display.slice(0,this.content_it)})))}componentWillUnmount(){clearInterval(this.clock)}render(){return r.jsx("span",{className:"text",children:this.state.content_parts})}constructor(...t){super(...t),this.content_it=0,this.content_to_display="",this.state={content_parts:""},this.clock=null}}class Ht extends o.Component{componentDidMount(){document.getElementById("game").style.opacity="1"}render(){return r.jsxs("div",{className:"Level",children:[r.jsx("div",{className:"Level_white"}),r.jsxs("div",{className:"Level_bar",children:[r.jsxs("div",{className:"Level_bar_left",children:[r.jsx("button",{onClick:()=>{Bt.engine.toggleDebug()},children:"debug"}),r.jsx("button",{onClick:()=>{window.location.reload()},children:"menu"})]}),r.jsxs("div",{className:"Level_bar_middle",children:["Chapitre ",Bt.levelId+1," - ",Bt.level.name]}),r.jsxs("div",{className:"Level_bar_right",children:[r.jsxs("button",{onClick:()=>{lt.toggleVolume(),this.forceUpdate()},children:["Sound ",lt.volume?"ON":"OFF"]}),r.jsxs("button",{onClick:()=>{lt.toggleMusicVolume(),this.forceUpdate()},children:["Music ",lt.volumeMusic?"ON":"OFF"]})]})]}),r.jsx("div",{className:"Level_overlay overlay"}),r.jsxs("div",{onClick:()=>{Bt.levelId},className:"Level_dialog "+(this.props.message?" visible":""),children:[r.jsx("div",{className:"Level_avatar",children:this.props.message&&B[this.props.message?.icon]&&r.jsx("img",{src:B[this.props.message?.icon].image.src,alt:"icon"})}),r.jsxs("div",{className:"Level_dialog_content ",children:[r.jsx("div",{className:"Level_dialog_author",children:this.props.message?.author||" "}),r.jsx("div",{className:"Level_dialog_message",children:r.jsx(Ut,{content:this.props.message?.content||" "})})]})]})]})}constructor(...t){super(...t),this.state={}}}o=n("eCRxs");class Wt extends o.Component{render(){return r.jsxs("div",{children:[r.jsx("button",{disabled:0===this.state.hero,onClick:()=>{this.setState({hero:0}),nt.hero=0},children:"Cara"}),r.jsx("button",{disabled:1===this.state.hero,onClick:()=>{this.setState({hero:1}),nt.hero=1},children:"Exias"})," ",r.jsx("button",{onClick:()=>Bt.state=Dt.TITLE,children:"Back"})]})}constructor(...t){super(...t),this.state={hero:nt.hero}}}o=n("eCRxs");class jt extends o.Component{render(){return r.jsxs("div",{className:"Continue",children:[st.map(((t,e)=>r.jsxs("button",{className:"select",onClick:()=>{lt.stop(),lt.play("s2045"),Bt.start(e)},children:[r.jsxs("span",{className:"left",children:["Chapitre ",e+1," - ",t.name]}),r.jsxs("span",{className:"right",children:[6*nt.roses[e]," / 6"]})]},t.name))),r.jsx("button",{onClick:()=>Bt.state=Dt.TITLE,children:"Back"})]})}constructor(...t){super(...t),this.state={}}}o=n("eCRxs");class Vt extends o.Component{async componentDidMount(){rt({canFirebolt:!1,canDoubleJump:!1,canSpeed:!1}),await xt(1e3),this.setState({opacity:1}),await xt(1e3),lt.play("s264"),this.setState({message:"Mais o est-ce que je suis ?"}),await xt(4e3),lt.play("s268"),this.setState({message:"Il y a quelqu'un ?"}),await xt(2e3),lt.play("s270"),this.setState({message:"Je suis entrain de tomber ?"}),await xt(2e3),this.setState({opacity:0}),await xt(1e3),Bt.start()}render(){return r.jsx("div",{className:"Begin",children:r.jsx(Ut,{content:this.state.message})})}constructor(...t){super(...t),this.state={opacity:0,message:""}}}class qt extends o.Component{componentDidMount(){Bt.onChangeLevel((t=>{this.setState({level:t})})),Bt.onChangeState((t=>{this.setState({gameState:t})})),Bt.onMessage((t=>{this.setState({message:t})}))}render(){const t=this.state.gameState;return t===Dt.LEVEL?r.jsx(Ht,{level:this.state.level,message:this.state.message,onNext:()=>{Bt.next_message()}}):t===Dt.EDITOR?r.jsx(Nt,{}):r.jsxs("div",{className:"overlay",children:[t===Dt.INTRO&&r.jsx(It,{}),t===Dt.TITLE&&r.jsx(Ft,{}),t===Dt.END&&r.jsx(Ot,{}),t===Dt.SETTINGS&&r.jsx(Wt,{}),t===Dt.CONTINUE&&r.jsx(jt,{}),t===Dt.BEGIN&&r.jsx(Vt,{})]})}constructor(...t){super(...t),this.state={overlay:!0,gameState:Bt.state,level:Bt.level}}}var Xt=qt;a.render(r.jsx(o.StrictMode,{children:r.jsx(Xt,{})}),document.getElementById("root"));
//# sourceMappingURL=index.2745bd2a.js.map
